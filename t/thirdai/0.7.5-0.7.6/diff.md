# Comparing `tmp/thirdai-0.7.5-cp39-cp39-win_amd64.whl.zip` & `tmp/thirdai-0.7.6-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,72 +1,72 @@
-Zip file size: 4114638 bytes, number of entries: 70
--rw-rw-rw-  2.0 fat      136 b- defN 23-Jun-06 16:38 thirdai/bolt_v2.py
--rw-rw-rw-  2.0 fat      145 b- defN 23-Jun-06 16:38 thirdai/deployment.py
--rw-rw-rw-  2.0 fat      139 b- defN 23-Jun-06 16:38 thirdai/distributed_bolt.py
--rw-rw-rw-  2.0 fat     1312 b- defN 23-Jun-06 16:38 thirdai/embeddings.py
--rw-rw-rw-  2.0 fat      136 b- defN 23-Jun-06 16:38 thirdai/hashing.py
--rw-rw-rw-  2.0 fat      195 b- defN 23-Jun-06 16:38 thirdai/licensing.py
--rw-rw-rw-  2.0 fat     1277 b- defN 23-Jun-06 16:38 thirdai/search.py
--rw-rw-rw-  2.0 fat     1308 b- defN 23-Jun-06 16:38 thirdai/_download.py
--rw-rw-rw-  2.0 fat 10029568 b- defN 23-Jun-06 16:38 thirdai/_thirdai.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat     2762 b- defN 23-Jun-06 16:38 thirdai/__init__.py
--rw-rw-rw-  2.0 fat     9515 b- defN 23-Jun-06 16:38 thirdai/bolt/udt_docs.py
--rw-rw-rw-  2.0 fat     5576 b- defN 23-Jun-06 16:38 thirdai/bolt/udt_modifications.py
--rw-rw-rw-  2.0 fat      262 b- defN 23-Jun-06 16:38 thirdai/bolt/__init__.py
--rw-rw-rw-  2.0 fat     1962 b- defN 23-Jun-06 16:38 thirdai/data/column_map_utils.py
--rw-rw-rw-  2.0 fat     2474 b- defN 23-Jun-06 16:38 thirdai/data/get_udt_columns.py
--rw-rw-rw-  2.0 fat     5748 b- defN 23-Jun-06 16:38 thirdai/data/type_inference.py
--rw-rw-rw-  2.0 fat      525 b- defN 23-Jun-06 16:38 thirdai/data/__init__.py
--rw-rw-rw-  2.0 fat     3803 b- defN 23-Jun-06 16:38 thirdai/dataset/csv_data_source.py
--rw-rw-rw-  2.0 fat     2047 b- defN 23-Jun-06 16:38 thirdai/dataset/parquet_data_source.py
--rw-rw-rw-  2.0 fat      245 b- defN 23-Jun-06 16:38 thirdai/dataset/__init__.py
--rw-rw-rw-  2.0 fat     1619 b- defN 23-Jun-06 16:38 thirdai/demos/beir_download_utils.py
--rw-rw-rw-  2.0 fat    24086 b- defN 23-Jun-06 16:38 thirdai/demos/download_datasets.py
--rw-rw-rw-  2.0 fat      486 b- defN 23-Jun-06 16:38 thirdai/demos/download_tokenizer_vocabs.py
--rw-rw-rw-  2.0 fat       76 b- defN 23-Jun-06 16:38 thirdai/demos/__init__.py
--rw-rw-rw-  2.0 fat     5263 b- defN 23-Jun-06 16:38 thirdai/telemetry/telemetry_daemon.py
--rw-rw-rw-  2.0 fat     5939 b- defN 23-Jun-06 16:38 thirdai/telemetry/telemetry_start_and_stop.py
--rw-rw-rw-  2.0 fat       51 b- defN 23-Jun-06 16:38 thirdai/telemetry/__init__.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_deps/__init__.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/__init__.py
--rw-rw-rw-  2.0 fat     2118 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertconfig/base_config.py
--rw-rw-rw-  2.0 fat      314 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertconfig/config.py
--rw-rw-rw-  2.0 fat     2321 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertconfig/core_config.py
--rw-rw-rw-  2.0 fat     3887 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertconfig/settings.py
--rw-rw-rw-  2.0 fat       48 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertconfig/__init__.py
--rw-rw-rw-  2.0 fat     1268 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/base_colbert.py
--rw-rw-rw-  2.0 fat     1418 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/checkpoint.py
--rw-rw-rw-  2.0 fat     2277 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/colbert.py
--rw-rw-rw-  2.0 fat     2175 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/hf_colbert.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/__init__.py
--rw-rw-rw-  2.0 fat     2064 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/tokenization/doc_tokenization.py
--rw-rw-rw-  2.0 fat     3295 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/tokenization/query_tokenization.py
--rw-rw-rw-  2.0 fat      168 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertmodeling/tokenization/__init__.py
--rw-rw-rw-  2.0 fat      319 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertutils/utils.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_deps/ColBERT/colbertutils/__init__.py
--rw-rw-rw-  2.0 fat    11133 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/dataset_loaders.py
--rw-rw-rw-  2.0 fat    25799 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/distributed.py
--rw-rw-rw-  2.0 fat     2061 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/distributed_v2.py
--rw-rw-rw-  2.0 fat     3070 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/utils.py
--rw-rw-rw-  2.0 fat      663 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/__init__.py
--rw-rw-rw-  2.0 fat     3682 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/primary_worker.py
--rw-rw-rw-  2.0 fat     2117 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/replica_worker.py
--rw-rw-rw-  2.0 fat     8375 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/train_state_manager.py
--rw-rw-rw-  2.0 fat    10258 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/worker.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/__init__.py
--rw-rw-rw-  2.0 fat     6770 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/communication/circular.py
--rw-rw-rw-  2.0 fat     1205 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/communication/gloo.py
--rw-rw-rw-  2.0 fat     1297 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/communication/linear.py
--rw-rw-rw-  2.0 fat      162 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/backend/communication/__init__.py
--rw-rw-rw-  2.0 fat     1387 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/ray_trainer/bolt_checkpoint.py
--rw-rw-rw-  2.0 fat     3346 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/ray_trainer/bolt_trainer.py
--rw-rw-rw-  2.0 fat     1862 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/ray_trainer/config.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-06 16:38 thirdai/_distributed_bolt/ray_trainer/__init__.py
--rw-rw-rw-  2.0 fat      394 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/DELVEWHEEL
--rw-rw-rw-  2.0 fat    16919 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/LICENSE.txt
--rw-rw-rw-  2.0 fat     2006 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/METADATA
--rw-rw-rw-  2.0 fat     6685 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/RECORD
--rw-rw-rw-  2.0 fat        8 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/top_level.txt
--rw-rw-rw-  2.0 fat      100 b- defN 23-Jun-06 16:38 thirdai-0.7.5.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       54 b- defN 23-Jun-06 16:38 thirdai.libs/.load-order-thirdai-0.7.5
+Zip file size: 4117285 bytes, number of entries: 70
+-rw-rw-rw-  2.0 fat      136 b- defN 23-Jun-14 06:24 thirdai/bolt_v2.py
+-rw-rw-rw-  2.0 fat      145 b- defN 23-Jun-14 06:24 thirdai/deployment.py
+-rw-rw-rw-  2.0 fat      139 b- defN 23-Jun-14 06:24 thirdai/distributed_bolt.py
+-rw-rw-rw-  2.0 fat     1312 b- defN 23-Jun-14 06:24 thirdai/embeddings.py
+-rw-rw-rw-  2.0 fat      136 b- defN 23-Jun-14 06:24 thirdai/hashing.py
+-rw-rw-rw-  2.0 fat      195 b- defN 23-Jun-14 06:24 thirdai/licensing.py
+-rw-rw-rw-  2.0 fat     1277 b- defN 23-Jun-14 06:24 thirdai/search.py
+-rw-rw-rw-  2.0 fat     1308 b- defN 23-Jun-14 06:24 thirdai/_download.py
+-rw-rw-rw-  2.0 fat 10040320 b- defN 23-Jun-14 06:24 thirdai/_thirdai.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat     2762 b- defN 23-Jun-14 06:24 thirdai/__init__.py
+-rw-rw-rw-  2.0 fat     9515 b- defN 23-Jun-14 06:24 thirdai/bolt/udt_docs.py
+-rw-rw-rw-  2.0 fat     6621 b- defN 23-Jun-14 06:24 thirdai/bolt/udt_modifications.py
+-rw-rw-rw-  2.0 fat      262 b- defN 23-Jun-14 06:24 thirdai/bolt/__init__.py
+-rw-rw-rw-  2.0 fat     1962 b- defN 23-Jun-14 06:24 thirdai/data/column_map_utils.py
+-rw-rw-rw-  2.0 fat     2474 b- defN 23-Jun-14 06:24 thirdai/data/get_udt_columns.py
+-rw-rw-rw-  2.0 fat     5748 b- defN 23-Jun-14 06:24 thirdai/data/type_inference.py
+-rw-rw-rw-  2.0 fat      525 b- defN 23-Jun-14 06:24 thirdai/data/__init__.py
+-rw-rw-rw-  2.0 fat     3803 b- defN 23-Jun-14 06:24 thirdai/dataset/csv_data_source.py
+-rw-rw-rw-  2.0 fat     2047 b- defN 23-Jun-14 06:24 thirdai/dataset/parquet_data_source.py
+-rw-rw-rw-  2.0 fat      245 b- defN 23-Jun-14 06:24 thirdai/dataset/__init__.py
+-rw-rw-rw-  2.0 fat     1619 b- defN 23-Jun-14 06:24 thirdai/demos/beir_download_utils.py
+-rw-rw-rw-  2.0 fat    24346 b- defN 23-Jun-14 06:24 thirdai/demos/download_datasets.py
+-rw-rw-rw-  2.0 fat      486 b- defN 23-Jun-14 06:24 thirdai/demos/download_tokenizer_vocabs.py
+-rw-rw-rw-  2.0 fat       76 b- defN 23-Jun-14 06:24 thirdai/demos/__init__.py
+-rw-rw-rw-  2.0 fat     5263 b- defN 23-Jun-14 06:24 thirdai/telemetry/telemetry_daemon.py
+-rw-rw-rw-  2.0 fat     5939 b- defN 23-Jun-14 06:24 thirdai/telemetry/telemetry_start_and_stop.py
+-rw-rw-rw-  2.0 fat       51 b- defN 23-Jun-14 06:24 thirdai/telemetry/__init__.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_deps/__init__.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/__init__.py
+-rw-rw-rw-  2.0 fat     2118 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertconfig/base_config.py
+-rw-rw-rw-  2.0 fat      314 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertconfig/config.py
+-rw-rw-rw-  2.0 fat     2321 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertconfig/core_config.py
+-rw-rw-rw-  2.0 fat     3887 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertconfig/settings.py
+-rw-rw-rw-  2.0 fat       48 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertconfig/__init__.py
+-rw-rw-rw-  2.0 fat     1268 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/base_colbert.py
+-rw-rw-rw-  2.0 fat     1418 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/checkpoint.py
+-rw-rw-rw-  2.0 fat     2277 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/colbert.py
+-rw-rw-rw-  2.0 fat     2175 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/hf_colbert.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/__init__.py
+-rw-rw-rw-  2.0 fat     2064 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/tokenization/doc_tokenization.py
+-rw-rw-rw-  2.0 fat     3295 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/tokenization/query_tokenization.py
+-rw-rw-rw-  2.0 fat      168 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertmodeling/tokenization/__init__.py
+-rw-rw-rw-  2.0 fat      319 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertutils/utils.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_deps/ColBERT/colbertutils/__init__.py
+-rw-rw-rw-  2.0 fat    11133 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/dataset_loaders.py
+-rw-rw-rw-  2.0 fat    25732 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/distributed.py
+-rw-rw-rw-  2.0 fat     2061 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/distributed_v2.py
+-rw-rw-rw-  2.0 fat     3070 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/utils.py
+-rw-rw-rw-  2.0 fat      663 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/__init__.py
+-rw-rw-rw-  2.0 fat     3682 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/primary_worker.py
+-rw-rw-rw-  2.0 fat     2117 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/replica_worker.py
+-rw-rw-rw-  2.0 fat     8375 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/train_state_manager.py
+-rw-rw-rw-  2.0 fat    10258 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/worker.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/__init__.py
+-rw-rw-rw-  2.0 fat     6770 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/communication/circular.py
+-rw-rw-rw-  2.0 fat     1205 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/communication/gloo.py
+-rw-rw-rw-  2.0 fat     1297 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/communication/linear.py
+-rw-rw-rw-  2.0 fat      162 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/backend/communication/__init__.py
+-rw-rw-rw-  2.0 fat     1387 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/ray_trainer/bolt_checkpoint.py
+-rw-rw-rw-  2.0 fat     3346 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/ray_trainer/bolt_trainer.py
+-rw-rw-rw-  2.0 fat     1862 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/ray_trainer/config.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jun-14 06:24 thirdai/_distributed_bolt/ray_trainer/__init__.py
+-rw-rw-rw-  2.0 fat      394 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/DELVEWHEEL
+-rw-rw-rw-  2.0 fat    16919 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/LICENSE.txt
+-rw-rw-rw-  2.0 fat     2006 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/METADATA
+-rw-rw-rw-  2.0 fat     6685 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/RECORD
+-rw-rw-rw-  2.0 fat        8 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/top_level.txt
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jun-14 06:24 thirdai-0.7.6.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       54 b- defN 23-Jun-14 06:24 thirdai.libs/.load-order-thirdai-0.7.6
 -rw-rw-rw-  2.0 fat   769984 b- defN 23-May-10 07:01 thirdai.libs/libomp140.x86_64-42976b4e098c4359687d7a6781850c8b.dll
-70 files, 11007664 bytes uncompressed, 4103730 bytes compressed:  62.7%
+70 files, 11019654 bytes uncompressed, 4106377 bytes compressed:  62.7%
```

## zipnote {}

```diff
@@ -180,32 +180,32 @@
 
 Filename: thirdai/_distributed_bolt/ray_trainer/config.py
 Comment: 
 
 Filename: thirdai/_distributed_bolt/ray_trainer/__init__.py
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/DELVEWHEEL
+Filename: thirdai-0.7.6.dist-info/DELVEWHEEL
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/LICENSE.txt
+Filename: thirdai-0.7.6.dist-info/LICENSE.txt
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/METADATA
+Filename: thirdai-0.7.6.dist-info/METADATA
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/RECORD
+Filename: thirdai-0.7.6.dist-info/RECORD
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/top_level.txt
+Filename: thirdai-0.7.6.dist-info/top_level.txt
 Comment: 
 
-Filename: thirdai-0.7.5.dist-info/WHEEL
+Filename: thirdai-0.7.6.dist-info/WHEEL
 Comment: 
 
-Filename: thirdai.libs/.load-order-thirdai-0.7.5
+Filename: thirdai.libs/.load-order-thirdai-0.7.6
 Comment: 
 
 Filename: thirdai.libs/libomp140.x86_64-42976b4e098c4359687d7a6781850c8b.dll
 Comment: 
 
 Zip file comment:
```

## thirdai/__init__.py

```diff
@@ -9,17 +9,17 @@
     import sys
     libs_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), os.pardir, 'thirdai.libs'))
     is_conda_cpython = platform.python_implementation() == 'CPython' and (hasattr(ctypes.pythonapi, 'Anaconda_GetVersion') or 'packaged by conda-forge' in sys.version)
     if sys.version_info[:2] >= (3, 8) and not is_conda_cpython or sys.version_info[:2] >= (3, 10):
         if os.path.isdir(libs_dir):
             os.add_dll_directory(libs_dir)
     else:
-        load_order_filepath = os.path.join(libs_dir, '.load-order-thirdai-0.7.5')
+        load_order_filepath = os.path.join(libs_dir, '.load-order-thirdai-0.7.6')
         if os.path.isfile(load_order_filepath):
-            with open(os.path.join(libs_dir, '.load-order-thirdai-0.7.5')) as file:
+            with open(os.path.join(libs_dir, '.load-order-thirdai-0.7.6')) as file:
                 load_order = file.read().split()
             for lib in load_order:
                 lib_path = os.path.join(os.path.join(libs_dir, lib))
                 if os.path.isfile(lib_path) and not ctypes.windll.kernel32.LoadLibraryExW(ctypes.c_wchar_p(lib_path), None, 0x00000008):
                     raise OSError('Error loading {}; {}'.format(lib, ctypes.FormatError()))
```

## thirdai/bolt/udt_modifications.py

```diff
@@ -29,24 +29,43 @@
         return thirdai.dataset.CSVDataSource(
             storage_path=path,
         )
 
     return thirdai.dataset.FileDataSource(path)
 
 
+def _process_validation_and_options(
+    validation: Optional[bolt.Validation],
+    batch_size: Optional[int],
+    max_in_memory_batches: Optional[int],
+    verbose: bool,
+    logging_interval: Optional[int],
+):
+    train_options = bolt.TrainOptions()
+
+    train_options.batch_size = batch_size
+    train_options.max_in_memory_batches = max_in_memory_batches
+    train_options.verbose = verbose
+    train_options.logging_interval = logging_interval
+
+    if validation:
+        val_data = _create_data_source(validation.filename)
+        train_options.steps_per_validation = validation.steps_per_validation
+        train_options.sparse_validation = validation.sparse_validation
+
+        return val_data, validation.metrics, train_options
+
+    return None, [], train_options
+
+
 def modify_udt():
     original_train = bolt.UniversalDeepTransformer.train
     original_evaluate = bolt.UniversalDeepTransformer.evaluate
     original_cold_start = bolt.UniversalDeepTransformer.cold_start
 
-    def _convert_validation(validation: Optional[bolt.Validation]) -> None:
-        if validation is not None:
-            return (_create_data_source(validation.filename()), validation.args())
-        return None
-
     def wrapped_train(
         self,
         filename: str,
         learning_rate: float = 0.001,
         epochs: int = 3,
         validation: Optional[bolt.Validation] = None,
         batch_size: Optional[int] = None,
@@ -54,28 +73,32 @@
         verbose: bool = True,
         callbacks: List[bolt.callbacks.Callback] = [],
         metrics: List[str] = [],
         logging_interval: Optional[int] = None,
     ):
         data_source = _create_data_source(filename)
 
-        validation = _convert_validation(validation)
+        val_data, val_metrics, train_options = _process_validation_and_options(
+            validation=validation,
+            batch_size=batch_size,
+            max_in_memory_batches=max_in_memory_batches,
+            verbose=verbose,
+            logging_interval=logging_interval,
+        )
 
         return original_train(
             self,
             data=data_source,
             learning_rate=learning_rate,
             epochs=epochs,
-            validation=validation,
-            batch_size=batch_size,
-            max_in_memory_batches=max_in_memory_batches,
-            metrics=metrics,
+            train_metrics=metrics,
+            val_data=val_data,
+            val_metrics=val_metrics,
             callbacks=callbacks,
-            verbose=verbose,
-            logging_interval=logging_interval,
+            options=train_options,
         )
 
     def wrapped_evaluate(
         self,
         filename: str,
         metrics: List[str] = [],
         use_sparse_inference: bool = False,
@@ -96,36 +119,44 @@
     def wrapped_cold_start(
         self,
         filename: str,
         strong_column_names: List[str],
         weak_column_names: List[str],
         learning_rate: float = 0.001,
         epochs: int = 5,
+        batch_size: int = None,
         metrics: List[str] = [],
         validation: Optional[bolt.Validation] = None,
         callbacks: List[bolt.callbacks.Callback] = [],
         max_in_memory_batches: Optional[int] = None,
         verbose: bool = True,
+        logging_interval: Optional[int] = None,
     ):
         data_source = _create_data_source(filename)
 
-        validation = _convert_validation(validation)
+        val_data, val_metrics, train_options = _process_validation_and_options(
+            validation=validation,
+            batch_size=batch_size,
+            max_in_memory_batches=max_in_memory_batches,
+            verbose=verbose,
+            logging_interval=logging_interval,
+        )
 
         return original_cold_start(
             self,
             data=data_source,
             strong_column_names=strong_column_names,
             weak_column_names=weak_column_names,
             learning_rate=learning_rate,
             epochs=epochs,
-            metrics=metrics,
-            validation=validation,
+            train_metrics=metrics,
+            val_data=val_data,
+            val_metrics=val_metrics,
             callbacks=callbacks,
-            max_in_memory_batches=max_in_memory_batches,
-            verbose=verbose,
+            options=train_options,
         )
 
     delattr(bolt.UniversalDeepTransformer, "train")
     delattr(bolt.UniversalDeepTransformer, "evaluate")
     delattr(bolt.UniversalDeepTransformer, "cold_start")
 
     bolt.UniversalDeepTransformer.train = wrapped_train
```

## thirdai/demos/download_datasets.py

```diff
@@ -207,18 +207,26 @@
     )
 
     return train_filename, test_filename, inference_batch
 
 
 def download_census_income(num_inference_samples=5, return_labels=False):
     CENSUS_INCOME_BASE_DOWNLOAD_URL = (
-        "https://archive.ics.uci.edu/ml/machine-learning-databases/adult/"
+        "https://archive.ics.uci.edu/static/public/2/adult.zip"
     )
+    CENSUS_INCOME_ZIP = "./adult.zip"
+    CENSUS_INCOME_DIR = "./adult"
     TRAIN_FILE = "./census_income_train.csv"
     TEST_FILE = "./census_income_test.csv"
+    _download_dataset(
+        url=CENSUS_INCOME_BASE_DOWNLOAD_URL,
+        zip_file=CENSUS_INCOME_ZIP,
+        check_existence=["./adult/adult.data", "./adult/adult.test"],
+        output_dir=CENSUS_INCOME_DIR,
+    )
     COLUMN_NAMES = [
         "age",
         "workclass",
         "fnlwgt",
         "education",
         "education-num",
         "marital-status",
@@ -229,35 +237,29 @@
         "capital-gain",
         "capital-loss",
         "hours-per-week",
         "native-country",
         "label",
     ]
     if not os.path.exists(TRAIN_FILE):
-        os.system(
-            f"curl {CENSUS_INCOME_BASE_DOWNLOAD_URL}adult.data --output {TRAIN_FILE}"
-        )
         # reformat the train file
-        with open(TRAIN_FILE, "r") as file:
+        with open("./adult/adult.data", "r") as file:
             data = file.read().splitlines(True)
         with open(TRAIN_FILE, "w") as file:
             # Write header
             file.write(",".join(COLUMN_NAMES) + "\n")
             # Convert ", " delimiters to ",".
             # loop through data[1:] since the first line is bogus
             lines = [line.replace(", ", ",") for line in data[1:]]
             # Strip empty lines
             file.writelines([line for line in lines if len(line.strip()) > 0])
 
     if not os.path.exists(TEST_FILE):
-        os.system(
-            f"curl {CENSUS_INCOME_BASE_DOWNLOAD_URL}adult.test --output {TEST_FILE}"
-        )
         # reformat the test file
-        with open(TEST_FILE, "r") as file:
+        with open("./adult/adult.test", "r") as file:
             data = file.read().splitlines(True)
         with open(TEST_FILE, "w") as file:
             # Write header
             file.write(",".join(COLUMN_NAMES) + "\n")
             # Convert ", " delimiters to ",".
             # Additionally, for some reason each of the labels end with a "." in the test set
             # loop through data[1:] since the first line is bogus
@@ -408,15 +410,15 @@
         inference_batch,
     )
 
 
 def download_clinc_dataset(
     num_training_files=1, clinc_small=False, file_prefix="clinc"
 ):
-    CLINC_URL = "https://archive.ics.uci.edu/ml/machine-learning-databases/00570/clinc150_uci.zip"
+    CLINC_URL = "https://archive.ics.uci.edu/static/public/570/clinc150.zip"
     CLINC_ZIP = "./clinc150_uci.zip"
     CLINC_DIR = "./clinc"
     MAIN_FILE = CLINC_DIR + "/clinc150_uci/data_full.json"
     SMALL_FILE = CLINC_DIR + "/clinc150_uci/data_small.json"
     TRAIN_FILE = f"./{file_prefix}_train.csv"
     TEST_FILE = f"./{file_prefix}_test.csv"
     TRAIN_FILES = []
@@ -505,26 +507,31 @@
 
     return TRAIN_FILE, TEST_FILE, inference_samples
 
 
 def download_internet_ads_dataset(seed=42):
     random.seed(seed)
 
-    INTERNET_ADS_URL = (
-        "https://archive.ics.uci.edu/ml/machine-learning-databases/internet_ads/ad.data"
+    INTERNET_ADS_DOWNLOAD_URL = (
+        "https://archive.ics.uci.edu/static/public/51/internet+advertisements.zip"
     )
-    INTERNET_ADS_FILE = "./internet_ads.data"
+    INTERNET_ADS_ZIP = "./internet+advertisements.zip"
+    INTERNET_ADS_DIR = "./internet+advertisements"
+    _download_dataset(
+        url=INTERNET_ADS_DOWNLOAD_URL,
+        zip_file=INTERNET_ADS_ZIP,
+        check_existence=["./internet+advertisements/ad.data"],
+        output_dir=INTERNET_ADS_DIR,
+    )
+    INTERNET_ADS_FILE = "./internet+advertisements/ad.data"
     TRAIN_FILE = "./internet_ads_train.csv"
     TEST_FILE = "./internet_ads_test.csv"
 
     column_names = [str(i) for i in range(1558)] + ["label"]
 
-    if not os.path.exists(INTERNET_ADS_FILE):
-        os.system(f"curl {INTERNET_ADS_URL} --output {INTERNET_ADS_FILE}")
-
     if not os.path.exists(TRAIN_FILE) or not os.path.exists(TEST_FILE):
         header = ",".join(column_names) + "\n"
 
         with open(INTERNET_ADS_FILE, "r") as data_file:
             lines = data_file.readlines()
         for i, line in enumerate(lines):
             cols = line.strip().split(",")
```

## thirdai/_distributed_bolt/distributed.py

```diff
@@ -144,26 +144,24 @@
             )
             for file in filenames
         ]
 
         validation_context = None
         if validation != None:
             validation_source = DistributedUDTDatasetLoader(
-                train_file=validation.filename(),
+                train_file=validation.filename,
                 batch_size=batch_size_per_node(batch_size, cluster_config),
                 data_processor=self.get_data_processor(),
             )
 
-            validation_args = validation.args()
-
             validation_context = ValidationContext(
                 validation_source,
-                validation_args.metrics,
-                validation_args.sparse_inference,
-                validation_args.steps_per_validation,
+                validation.metrics,
+                validation.sparse_validation,
+                validation.steps_per_validation,
             )
 
         return train_with_data_sources(
             self,
             learning_rate,
             epochs,
             verbose,
```

## Comparing `thirdai-0.7.5.dist-info/LICENSE.txt` & `thirdai-0.7.6.dist-info/LICENSE.txt`

 * *Files identical despite different names*

## Comparing `thirdai-0.7.5.dist-info/METADATA` & `thirdai-0.7.6.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: thirdai
-Version: 0.7.5
+Version: 0.7.6
 Summary: A faster cpu machine learning library
 Author: ThirdAI
 Author-email: contact@thirdai.com
 License: proprietary
 License-File: LICENSE.txt
 Requires-Dist: numpy
 Requires-Dist: typing-extensions
```

## Comparing `thirdai-0.7.5.dist-info/RECORD` & `thirdai-0.7.6.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -2,28 +2,28 @@
 thirdai/deployment.py,sha256=e_06MzSrth4S8Gs2dpEzfnLPaZsDcGhcJav8qfxEczY,145
 thirdai/distributed_bolt.py,sha256=MwUmwd8Q2v-ZAMtuGPBAocrQxO7ZRZZruWhlAuZzJos,139
 thirdai/embeddings.py,sha256=Afq5qcejw2NUpC_jImB5D70YLWB4ZHWROZPL7GdT44E,1312
 thirdai/hashing.py,sha256=MttqG8D0RnrPW2U-9Tf9LekMJjwnVS8I8jQAaNlucu4,136
 thirdai/licensing.py,sha256=oLmHWRqfqq6jpTTdauTyQHrY6LO_ukdTTdhgWotOPUQ,195
 thirdai/search.py,sha256=8HTl393Vt3g-OweibrR5UTYTCDCoF6Rk6WvWYRv30rM,1277
 thirdai/_download.py,sha256=16FZSiv34ZTi-u7qSM5V9pINi8Cke2qYoflLfs7YeEI,1308
-thirdai/_thirdai.cp39-win_amd64.pyd,sha256=yT3iWv3TXBVsGihElVSE88dRDduQwjKv9mhkR2BmZQo,10029568
-thirdai/__init__.py,sha256=3bgVhKdkOMGqECIa2E5z5JQnEST5Dc8cgxe2N8q5IJ0,2762
+thirdai/_thirdai.cp39-win_amd64.pyd,sha256=6vXtp5Nw3I4kTd375-ufy4qOpaY7g64hSBGW488MZCQ,10040320
+thirdai/__init__.py,sha256=9nzGBjqeciCGi9SCx4969EgylJHBLicb6F0rXn9ZHMo,2762
 thirdai/bolt/udt_docs.py,sha256=jC40F00qaynfyBWnzY05OOM0r9EFZjzDzc_9ImHmWck,9515
-thirdai/bolt/udt_modifications.py,sha256=1wZtjUbMOs1dt8bNlwLjVnVPDijAwPsNyBEQutxln0I,5576
+thirdai/bolt/udt_modifications.py,sha256=CU7pOjdOq2TFVPk061ep2aucn-iR_CEzl3Y9XhMCmhQ,6621
 thirdai/bolt/__init__.py,sha256=I-_6s4PC8zPoCNDyw2KUKzsKgF8wPgHNnBTz1HnWJys,262
 thirdai/data/column_map_utils.py,sha256=cGvuxK7t2JOss25ImX28nMVnDjC0oXxSQBr5D2fdixU,1962
 thirdai/data/get_udt_columns.py,sha256=isYKw8MDHkGbmmnCfwbcS4d0RMaRhmbKtUKTZL2a93s,2474
 thirdai/data/type_inference.py,sha256=gzwd7eCEq6hfmzZRfm0XW99699FcsRXXYBAMTVsFLRQ,5748
 thirdai/data/__init__.py,sha256=ClztQDn5cxQRgjLEwIpep7_8EkXXTSStns3JpUlf2x0,525
 thirdai/dataset/csv_data_source.py,sha256=9zlHaMcclVfoWa3RQkBgE20YGv1kbU8Q5CPGJjJfms8,3803
 thirdai/dataset/parquet_data_source.py,sha256=esxhsLt2G2rxmb_fBRTUOdyGlFPaFzN0KX1q8rBuIdM,2047
 thirdai/dataset/__init__.py,sha256=xxR8lQkYyH10KtSvyp4cpqQTMDocl-PlXJgrn6yUOmI,245
 thirdai/demos/beir_download_utils.py,sha256=nXMAeoc18d1GFG0F6tNmU3GzmieIz_uUC_V1hKHC520,1619
-thirdai/demos/download_datasets.py,sha256=BLI3MdX1OXnT1nnBvkMn-Sg15WvhZ5IG9eGPrSU8iQw,24086
+thirdai/demos/download_datasets.py,sha256=-lnfWBN_Knopn8zn-IDoDVhbhTMHpQmLHg78-xamuJA,24346
 thirdai/demos/download_tokenizer_vocabs.py,sha256=MYpyesUvcvxcrMefuwWwowFmz0Y5EzD6ppqAGbCyQvA,486
 thirdai/demos/__init__.py,sha256=IgkhMJRpY1kIkJ86TnqgyqLzlOEKfx-0VNCDuIG6eew,76
 thirdai/telemetry/telemetry_daemon.py,sha256=Vx5yf-IN17TGNSe1Hy3Szqu_1kudiAl3ics-nBcdHHM,5263
 thirdai/telemetry/telemetry_start_and_stop.py,sha256=Dbw2KsFyOfjQcnrSXnwMNBLNlj62aRFcje6RfRzJJfo,5939
 thirdai/telemetry/__init__.py,sha256=cxKYgX1QWTCuYwg64_1RgBNvKL2iqtssdcc25eF4-NI,51
 thirdai/_deps/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 thirdai/_deps/ColBERT/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
@@ -39,15 +39,15 @@
 thirdai/_deps/ColBERT/colbertmodeling/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 thirdai/_deps/ColBERT/colbertmodeling/tokenization/doc_tokenization.py,sha256=wTj2V-nAAludCX7V9dwaETvnwyBAKCtsYQ6pegxK--M,2064
 thirdai/_deps/ColBERT/colbertmodeling/tokenization/query_tokenization.py,sha256=pr4oYC__9BzE-eabPPoFOlz9X9PyVtDE8232Z3Bam3s,3295
 thirdai/_deps/ColBERT/colbertmodeling/tokenization/__init__.py,sha256=7Rwy_hl_63cv9GnOParV2deBNvY1HkC6lZQm76r--wE,168
 thirdai/_deps/ColBERT/colbertutils/utils.py,sha256=TsQ71Ufd5Bu5QC1wWxQPvnSAEwjft8KLq8mUgcugf7Q,319
 thirdai/_deps/ColBERT/colbertutils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 thirdai/_distributed_bolt/dataset_loaders.py,sha256=vBpv7QYXCkq71Sz4DLeNJ0vbAckb4Lx6g4YN30x2rMU,11133
-thirdai/_distributed_bolt/distributed.py,sha256=gQFy8-W1dK4N7Z75Y7y3HQp_iEs54Wi1yskVfUyRMzY,25799
+thirdai/_distributed_bolt/distributed.py,sha256=IYVH2kfAGHGz5Sej5o6ANJ1Y4BRbp64vbe3RFU2NfkE,25732
 thirdai/_distributed_bolt/distributed_v2.py,sha256=NDB0GMP6zXQVXM15w2CbEoVt4agh53qG3pF_XOEqEnA,2061
 thirdai/_distributed_bolt/utils.py,sha256=1hCS1KXDulFxsmJkZUYE_VqM0-HOkCUfCe9i6gz1xME,3070
 thirdai/_distributed_bolt/__init__.py,sha256=6YIdPYuGhbarUhos1F_USp-088bqVsNuNWBRGrgipeU,663
 thirdai/_distributed_bolt/backend/primary_worker.py,sha256=pL_cYeWpXP1djCW0bo0G76F9_ptOtd23kjBgi9ZBumc,3682
 thirdai/_distributed_bolt/backend/replica_worker.py,sha256=ianxNsLKAsAkl3P4-6_GtWytVPPnxPOWINYul4Vse2o,2117
 thirdai/_distributed_bolt/backend/train_state_manager.py,sha256=i0Lhe5Zrp79YbRjmI7W9XFa3UYHvgdRup3Rpll9lYJs,8375
 thirdai/_distributed_bolt/backend/worker.py,sha256=bJzG4BPqFWRpfwCHKJ3BpVKkFcGjiq8JJmpbrFf9BYQ,10258
@@ -56,15 +56,15 @@
 thirdai/_distributed_bolt/backend/communication/gloo.py,sha256=caO-6pSbwpblugfBeM2FEcynAnuzYcD4X96kdNnsnYg,1205
 thirdai/_distributed_bolt/backend/communication/linear.py,sha256=AzrQsUpl75YKYFsMB4R94a4UYARqGTSdg05guTxMDnM,1297
 thirdai/_distributed_bolt/backend/communication/__init__.py,sha256=HyoGy-fQvPpitxXjHPpJkUL6JmRgjGhMBALY6MUDUUk,162
 thirdai/_distributed_bolt/ray_trainer/bolt_checkpoint.py,sha256=5Xds4N62ZnL5afKqrc4XHpzj2ddrKK-zSwcvFhFUK0I,1387
 thirdai/_distributed_bolt/ray_trainer/bolt_trainer.py,sha256=vViFj_G6zRHcrDc7xFBaBKY8JF_obL0j2APDuhBvqVg,3346
 thirdai/_distributed_bolt/ray_trainer/config.py,sha256=LDo1y1dVvM1LFE_2bdvpvg-Jo3IIparZt3VBIqDOA1U,1862
 thirdai/_distributed_bolt/ray_trainer/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-thirdai-0.7.5.dist-info/DELVEWHEEL,sha256=dYRNjQbj1NV2FFhXQ6IjbElKk7u19r7W5C_Ot_H5GHU,394
-thirdai-0.7.5.dist-info/LICENSE.txt,sha256=agSIzKgTDMipzr2SjcOEG_GTJJkwtt-4wrcVAY03gPo,16919
-thirdai-0.7.5.dist-info/METADATA,sha256=Gy7s6Tn69kzA1RdTIAfiBtoTn-bJllRLaKn7riIsZdo,2006
-thirdai-0.7.5.dist-info/RECORD,,
-thirdai-0.7.5.dist-info/top_level.txt,sha256=yBixDeDldyBUN70Yfq9rnKJYCNICw3ae7uow_BdZysA,8
-thirdai-0.7.5.dist-info/WHEEL,sha256=fVcVlLzi8CGi_Ul8vjMdn8gER25dn5GBg9E6k9z41-Y,100
-thirdai.libs/.load-order-thirdai-0.7.5,sha256=6K6n9kc8u0J8jVvqCEl0NPIbbj6Mnq_fT6-YSCevf0Q,54
+thirdai-0.7.6.dist-info/DELVEWHEEL,sha256=Vu152rlMUb2C7sh8jWrGycwFicO_EKsNMZpyNmkQGVU,394
+thirdai-0.7.6.dist-info/LICENSE.txt,sha256=agSIzKgTDMipzr2SjcOEG_GTJJkwtt-4wrcVAY03gPo,16919
+thirdai-0.7.6.dist-info/METADATA,sha256=C54Ui5gsY-QEwbl_YjyU-g9jd_XH2GxCW0pClnWbGkI,2006
+thirdai-0.7.6.dist-info/RECORD,,
+thirdai-0.7.6.dist-info/top_level.txt,sha256=yBixDeDldyBUN70Yfq9rnKJYCNICw3ae7uow_BdZysA,8
+thirdai-0.7.6.dist-info/WHEEL,sha256=fVcVlLzi8CGi_Ul8vjMdn8gER25dn5GBg9E6k9z41-Y,100
+thirdai.libs/.load-order-thirdai-0.7.6,sha256=6K6n9kc8u0J8jVvqCEl0NPIbbj6Mnq_fT6-YSCevf0Q,54
 thirdai.libs/libomp140.x86_64-42976b4e098c4359687d7a6781850c8b.dll,sha256=IIP0uY1ppSqiU7wjgB6hQu3Kjwl0kiWjqn5Swow5hgI,769984
```

