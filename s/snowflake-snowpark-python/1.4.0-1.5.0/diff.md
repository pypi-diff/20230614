# Comparing `tmp/snowflake-snowpark-python-1.4.0.tar.gz` & `tmp/snowflake-snowpark-python-1.5.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "snowflake-snowpark-python-1.4.0.tar", last modified: Mon Apr 24 22:22:29 2023, max compression
+gzip compressed data, was "snowflake-snowpark-python-1.5.0.tar", last modified: Tue Jun 13 23:22:15 2023, max compression
```

## Comparing `snowflake-snowpark-python-1.4.0.tar` & `snowflake-snowpark-python-1.5.0.tar`

### file list

```diff
@@ -1,73 +1,73 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/
--rw-r--r--   0 runner    (1001) docker     (123)    29338 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/CHANGELOG.md
--rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)      242 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)    35891 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     4772 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/README.md
--rw-r--r--   0 runner    (1001) docker     (123)       38 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     3864 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.108605 snowflake-snowpark-python-1.4.0/src/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.108605 snowflake-snowpark-python-1.4.0/src/snowflake/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.116605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/
--rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.116605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/
--rw-r--r--   0 runner    (1001) docker     (123)       76 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    28487 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py
--rw-r--r--   0 runner    (1001) docker     (123)    35117 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     6322 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
--rw-r--r--   0 runner    (1001) docker     (123)    11178 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/expression.py
--rw-r--r--   0 runner    (1001) docker     (123)      986 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
--rw-r--r--   0 runner    (1001) docker     (123)     3485 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    41037 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py
--rw-r--r--   0 runner    (1001) docker     (123)    39377 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
--rw-r--r--   0 runner    (1001) docker     (123)     4599 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3418 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)     3152 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
--rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py
--rw-r--r--   0 runner    (1001) docker     (123)    26725 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/code_generation.py
--rw-r--r--   0 runner    (1001) docker     (123)    16036 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/error_message.py
--rw-r--r--   0 runner    (1001) docker     (123)    26038 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/server_connection.py
--rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/telemetry.py
--rw-r--r--   0 runner    (1001) docker     (123)    20932 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/type_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    27070 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/udf_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    23650 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)    16167 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/async_job.py
--rw-r--r--   0 runner    (1001) docker     (123)    32981 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/column.py
--rw-r--r--   0 runner    (1001) docker     (123)      550 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/context.py
--rw-r--r--   0 runner    (1001) docker     (123)   147089 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    23447 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_na_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    25795 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_reader.py
--rw-r--r--   0 runner    (1001) docker     (123)    11120 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_stat_functions.py
--rw-r--r--   0 runner    (1001) docker     (123)    14434 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_writer.py
--rw-r--r--   0 runner    (1001) docker     (123)     6357 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/exceptions.py
--rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/file_operation.py
--rw-r--r--   0 runner    (1001) docker     (123)     6169 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/files.py
--rw-r--r--   0 runner    (1001) docker     (123)   262369 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/functions.py
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/py.typed
--rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/query_history.py
--rw-r--r--   0 runner    (1001) docker     (123)    12582 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/relational_grouped_dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    12072 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/row.py
--rw-r--r--   0 runner    (1001) docker     (123)    89764 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/session.py
--rw-r--r--   0 runner    (1001) docker     (123)    37131 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/stored_procedure.py
--rw-r--r--   0 runner    (1001) docker     (123)    29569 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table.py
--rw-r--r--   0 runner    (1001) docker     (123)    11516 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table_function.py
--rw-r--r--   0 runner    (1001) docker     (123)    10501 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/types.py
--rw-r--r--   0 runner    (1001) docker     (123)    45757 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udf.py
--rw-r--r--   0 runner    (1001) docker     (123)    35687 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udtf.py
--rw-r--r--   0 runner    (1001) docker     (123)      151 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/version.py
--rw-r--r--   0 runner    (1001) docker     (123)     9474 2023-04-24 22:22:16.000000 snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/window.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-04-24 22:22:29.120605 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)    35891 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     2876 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-04-24 22:22:28.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (123)      341 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)       10 2023-04-24 22:22:29.000000 snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.360362 snowflake-snowpark-python-1.5.0/
+-rw-r--r--   0 runner    (1001) docker     (123)    30994 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/CHANGELOG.md
+-rw-r--r--   0 runner    (1001) docker     (123)    11365 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      242 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)    37602 2023-06-13 23:22:15.360362 snowflake-snowpark-python-1.5.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     4772 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-06-13 23:22:15.360362 snowflake-snowpark-python-1.5.0/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     3918 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.336362 snowflake-snowpark-python-1.5.0/src/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.336362 snowflake-snowpark-python-1.5.0/src/snowflake/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.352362 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/
+-rw-r--r--   0 runner    (1001) docker     (123)     1838 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.352362 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.356362 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/
+-rw-r--r--   0 runner    (1001) docker     (123)       76 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    38350 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/analyzer.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35327 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2053 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3742 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6427 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11336 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)      986 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3550 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    42766 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py
+-rw-r--r--   0 runner    (1001) docker     (123)    40138 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4591 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1198 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3441 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2305 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2112 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3152 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2970 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26737 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/code_generation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16330 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/error_message.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26038 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/server_connection.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11337 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/telemetry.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21752 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/type_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27689 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/udf_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26286 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16167 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/async_job.py
+-rw-r--r--   0 runner    (1001) docker     (123)    34333 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/column.py
+-rw-r--r--   0 runner    (1001) docker     (123)      550 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/context.py
+-rw-r--r--   0 runner    (1001) docker     (123)   150984 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23490 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_na_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28130 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_reader.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11143 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_stat_functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14687 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_writer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6357 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/exceptions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17528 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/file_operation.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8301 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/files.py
+-rw-r--r--   0 runner    (1001) docker     (123)   269192 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/functions.py
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/py.typed
+-rw-r--r--   0 runner    (1001) docker     (123)     1023 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/query_history.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12315 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/relational_grouped_dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12095 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/row.py
+-rw-r--r--   0 runner    (1001) docker     (123)    93056 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/session.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39467 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/stored_procedure.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29592 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/table.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11516 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/table_function.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12660 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    45769 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/udf.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35699 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/udtf.py
+-rw-r--r--   0 runner    (1001) docker     (123)      151 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/version.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9486 2023-06-13 23:22:02.000000 snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/window.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-13 23:22:15.360362 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)    37602 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     2876 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/namespace_packages.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (123)      341 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       10 2023-06-13 23:22:15.000000 snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/top_level.txt
```

### Comparing `snowflake-snowpark-python-1.4.0/CHANGELOG.md` & `snowflake-snowpark-python-1.5.0/CHANGELOG.md`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,38 @@
 # Release History
 
+## 1.5.0 (2023-06-09)
+
+### Behavior Changes
+
+- Aggregation results, from functions such as `DataFrame.agg` and `DataFrame.describe`, no longer strip away non-printing characters from column names.
+
+### New Features
+
+- Added support for the Python 3.9 runtime environment.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `array_generate_range`
+  - `array_unique_agg`
+  - `collect_set`
+  - `sequence`
+- Added support for registering and calling stored procedures with `TABLE` return type.
+- Added support for parameter `length` in `StringType()` to specify the maximum number of characters that can be stored by the column.
+- Added the alias `functions.element_at()` for `functions.get()`.
+- Added the alias `Column.contains` for `functions.contains`.
+- Added experimental feature `DataFrame.alias`.
+- Added support for querying metadata columns from stage when creating `DataFrame` using `DataFrameReader`.
+- Added support for `StructType.add` to append more fields to existing `StructType` objects.
+- Added support for parameter `execute_as` in `StoredProcedureRegistration.register_from_file()` to specify stored procedure caller rights.
+
+### Bug Fixes
+
+- Fixed a bug where the `Dataframe.join_table_function` did not run all of the necessary queries to set up the join table function when SQL simplifier was enabled.
+- Fixed type hint declaration for custom types - `ColumnOrName`, `ColumnOrLiteralStr`, `ColumnOrSqlExpr`, `LiteralType` and `ColumnOrLiteral` that were breaking `mypy` checks.
+- Fixed a bug where `DataFrameWriter.save_as_table` and `DataFrame.copy_into_table` failed to parse fully qualified table names.
+
 ## 1.4.0 (2023-04-24)
 
 ### New Features
 
 - Added support for `session.getOrCreate`.
 - Added support for alias `Column.getField`.
 - Added support for new functions in `snowflake.snowpark.functions`:
@@ -13,15 +42,15 @@
   - `array_distinct`.
   - `regexp_extract`.
   - `struct`.
   - `format_number`.
   - `bround`.
   - `substring_index`
 - Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
-- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Added support for `DataFrameWriter.save_as_table` method to take table names that contain dots.
 - Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
 - Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
 - Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
 
 ### Bug Fixes
 
 - Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
```

### Comparing `snowflake-snowpark-python-1.4.0/LICENSE.txt` & `snowflake-snowpark-python-1.5.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/PKG-INFO` & `snowflake-snowpark-python-1.5.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.4.0
+Version: 1.5.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -19,21 +19,22 @@
 Classifier: Intended Audience :: Information Technology
 Classifier: Intended Audience :: System Administrators
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: SQL
 Classifier: Programming Language :: Python :: 3 :: Only
 Classifier: Programming Language :: Python :: 3.8
+Classifier: Programming Language :: Python :: 3.9
 Classifier: Topic :: Database
 Classifier: Topic :: Software Development
 Classifier: Topic :: Software Development :: Libraries
 Classifier: Topic :: Software Development :: Libraries :: Application Frameworks
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Scientific/Engineering :: Information Analysis
-Requires-Python: ==3.8.*
+Requires-Python: >=3.8, <3.10
 Description-Content-Type: text/markdown
 Provides-Extra: pandas
 Provides-Extra: secure-local-storage
 Provides-Extra: development
 License-File: LICENSE.txt
 
 # Snowflake Snowpark Python API
@@ -130,14 +131,43 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.5.0 (2023-06-09)
+
+### Behavior Changes
+
+- Aggregation results, from functions such as `DataFrame.agg` and `DataFrame.describe`, no longer strip away non-printing characters from column names.
+
+### New Features
+
+- Added support for the Python 3.9 runtime environment.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `array_generate_range`
+  - `array_unique_agg`
+  - `collect_set`
+  - `sequence`
+- Added support for registering and calling stored procedures with `TABLE` return type.
+- Added support for parameter `length` in `StringType()` to specify the maximum number of characters that can be stored by the column.
+- Added the alias `functions.element_at()` for `functions.get()`.
+- Added the alias `Column.contains` for `functions.contains`.
+- Added experimental feature `DataFrame.alias`.
+- Added support for querying metadata columns from stage when creating `DataFrame` using `DataFrameReader`.
+- Added support for `StructType.add` to append more fields to existing `StructType` objects.
+- Added support for parameter `execute_as` in `StoredProcedureRegistration.register_from_file()` to specify stored procedure caller rights.
+
+### Bug Fixes
+
+- Fixed a bug where the `Dataframe.join_table_function` did not run all of the necessary queries to set up the join table function when SQL simplifier was enabled.
+- Fixed type hint declaration for custom types - `ColumnOrName`, `ColumnOrLiteralStr`, `ColumnOrSqlExpr`, `LiteralType` and `ColumnOrLiteral` that were breaking `mypy` checks.
+- Fixed a bug where `DataFrameWriter.save_as_table` and `DataFrame.copy_into_table` failed to parse fully qualified table names.
+
 ## 1.4.0 (2023-04-24)
 
 ### New Features
 
 - Added support for `session.getOrCreate`.
 - Added support for alias `Column.getField`.
 - Added support for new functions in `snowflake.snowpark.functions`:
@@ -147,15 +177,15 @@
   - `array_distinct`.
   - `regexp_extract`.
   - `struct`.
   - `format_number`.
   - `bround`.
   - `substring_index`
 - Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
-- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Added support for `DataFrameWriter.save_as_table` method to take table names that contain dots.
 - Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
 - Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
 - Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
 
 ### Bug Fixes
 
 - Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
```

### Comparing `snowflake-snowpark-python-1.4.0/README.md` & `snowflake-snowpark-python-1.5.0/README.md`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/setup.py` & `snowflake-snowpark-python-1.5.0/setup.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 
 from setuptools import setup
 
 THIS_DIR = os.path.dirname(os.path.realpath(__file__))
 SRC_DIR = os.path.join(THIS_DIR, "src")
 SNOWPARK_SRC_DIR = os.path.join(SRC_DIR, "snowflake", "snowpark")
 CONNECTOR_DEPENDENCY_VERSION = ">=2.7.12, <4.0.0"
-REQUIRED_PYTHON_VERSION = "==3.8.*"
+REQUIRED_PYTHON_VERSION = ">=3.8, <3.10"
 if os.getenv("SNOWFLAKE_IS_PYTHON_RUNTIME_TEST", False):
     REQUIRED_PYTHON_VERSION = ">=3.8"
 
 # read the version
 VERSION = ()
 with open(os.path.join(SNOWPARK_SRC_DIR, "version.py"), encoding="utf-8") as f:
     exec(f.read())
@@ -90,14 +90,15 @@
         "Intended Audience :: Information Technology",
         "Intended Audience :: System Administrators",
         "License :: OSI Approved :: Apache Software License",
         "Operating System :: OS Independent",
         "Programming Language :: SQL",
         "Programming Language :: Python :: 3 :: Only",
         "Programming Language :: Python :: 3.8",
+        "Programming Language :: Python :: 3.9",
         "Topic :: Database",
         "Topic :: Software Development",
         "Topic :: Software Development :: Libraries",
         "Topic :: Software Development :: Libraries :: Application Frameworks",
         "Topic :: Software Development :: Libraries :: Python Modules",
         "Topic :: Scientific/Engineering :: Information Analysis",
     ],
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/__init__.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/__init__.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/analyzer_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,13 +1,14 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import re
+import sys
 import typing
 from typing import Any, Dict, List, Optional, Tuple, Union
 
 from snowflake.snowpark._internal.analyzer.binary_plan_node import (
     Except,
     Intersect,
     JoinType,
@@ -31,17 +32,17 @@
 )
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.types import DataType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 LEFT_PARENTHESIS = "("
 RIGHT_PARENTHESIS = ")"
 LEFT_BRACKET = "["
 RIGHT_BRACKET = "]"
 AS = " AS "
@@ -93,14 +94,15 @@
 SEQ8 = " SEQ8() "
 ROW_NUMBER = " ROW_NUMBER() "
 ONE = " 1 "
 GENERATOR = "GENERATOR"
 ROW_COUNT = "ROWCOUNT"
 RIGHT_ARROW = " => "
 NUMBER = " NUMBER "
+STRING = " STRING "
 UNSAT_FILTER = " 1 = 0 "
 BETWEEN = " BETWEEN "
 FOLLOWING = " FOLLOWING "
 PRECEDING = " PRECEDING "
 DOLLAR = "$"
 DOUBLE_COLON = "::"
 DROP = " DROP "
@@ -1294,14 +1296,20 @@
         + str(precision)
         + COMMA
         + str(scale)
         + RIGHT_PARENTHESIS
     )
 
 
+def string(length: Optional[int] = None) -> str:
+    if length:
+        return STRING + LEFT_PARENTHESIS + str(length) + RIGHT_PARENTHESIS
+    return STRING.strip()
+
+
 def get_file_format_spec(
     file_format_type: str, format_type_options: typing.Dict[str, Any]
 ) -> str:
     file_format_name = format_type_options.get("FORMAT_NAME")
     file_format_str = FILE_FORMAT + EQUALS + LEFT_PARENTHESIS
     if file_format_name is None:
         file_format_str += TYPE + EQUALS + file_format_type
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/binary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/binary_plan_node.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/datatype_mapper.py`

 * *Files 2% similar despite different names*

```diff
@@ -59,28 +59,28 @@
         if value is None:
             return "NULL :: INT"
     if isinstance(datatype, _FractionalType):
         if value is None:
             return "NULL :: FLOAT"
     if isinstance(datatype, StringType):
         if value is None:
-            return "NULL :: STRING"
+            return f"NULL :: {analyzer_utils.string(datatype.length)}"
     if isinstance(datatype, BooleanType):
         if value is None:
             return "NULL :: BOOLEAN"
     if value is None:
         return "NULL"
 
     # Not nulls
     if isinstance(value, str) and isinstance(datatype, StringType):
         # If this is used in a values statement (e.g., create_dataframe),
         # the sql value has to be casted to make sure the varchar length
         # will not be limited.
         return (
-            f"{str_to_sql(value)} :: STRING"
+            f"{str_to_sql(value)} :: {analyzer_utils.string(datatype.length)}"
             if from_values_statement
             else str_to_sql(value)
         )
 
     if isinstance(datatype, _IntegralType):
         return f"{value} :: INT"
 
@@ -149,15 +149,15 @@
         if isinstance(data_type, VariantType):
             return "PARSE_JSON('NULL') :: VARIANT"
         return "NULL :: " + convert_sp_to_sf_type(data_type)
 
     if isinstance(data_type, _NumericType):
         return "0 :: " + convert_sp_to_sf_type(data_type)
     if isinstance(data_type, StringType):
-        return "'a' :: STRING"
+        return f"'a' :: {analyzer_utils.string(data_type.length)}"
     if isinstance(data_type, BinaryType):
         return "to_binary(hex_encode(1))"
     if isinstance(data_type, DateType):
         return "date('2020-9-16')"
     if isinstance(data_type, BooleanType):
         return "true"
     if isinstance(data_type, TimeType):
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/expression.py`

 * *Files 1% similar despite different names*

```diff
@@ -151,25 +151,31 @@
         return self.name
 
     def dependent_column_names(self) -> Optional[Set[str]]:
         return {self.name}
 
 
 class Star(Expression):
-    def __init__(self, expressions: List[Attribute]) -> None:
+    def __init__(
+        self, expressions: List[Attribute], df_alias: Optional[str] = None
+    ) -> None:
         super().__init__()
         self.expressions = expressions
+        self.df_alias = df_alias
 
     def dependent_column_names(self) -> Optional[Set[str]]:
         return derive_dependent_columns(*self.expressions)
 
 
 class UnresolvedAttribute(Expression, NamedExpression):
-    def __init__(self, name: str, is_sql_text: bool = False) -> None:
+    def __init__(
+        self, name: str, is_sql_text: bool = False, df_alias: Optional[str] = None
+    ) -> None:
         super().__init__()
+        self.df_alias = df_alias
         self.name = name
         self.is_sql_text = is_sql_text
         if "$" in name:
             # $n refers to a column by index. We don't consider column index yet.
             # even though "$" isn't necessarily used to refer to a column by index. We're conservative here.
             self._dependent_column_names = COLUMN_DEPENDENCY_DOLLAR
         else:
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/grouping_set.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/schema_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -80,17 +80,19 @@
         return convert_result_meta_to_attribute(session._conn._cursor.description)
 
     return session._get_result_attributes(sql)
 
 
 def convert_result_meta_to_attribute(meta: List[ResultMetadata]) -> List[Attribute]:
     attributes = []
-    for column_name, type_value, _, _, precision, scale, nullable in meta:
+    for column_name, type_value, _, internal_size, precision, scale, nullable in meta:
         quoted_name = quote_name_without_upper_casing(column_name)
         attributes.append(
             Attribute(
                 quoted_name,
-                convert_sf_to_sp_type(FIELD_ID_TO_NAME[type_value], precision, scale),
+                convert_sf_to_sp_type(
+                    FIELD_ID_TO_NAME[type_value], precision, scale, internal_size
+                ),
                 nullable,
             )
         )
     return attributes
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/select_statement.py`

 * *Files 4% similar despite different names*

```diff
@@ -2,27 +2,39 @@
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 from abc import ABC, abstractmethod
 from collections import UserDict
 from copy import copy
 from enum import Enum
-from typing import TYPE_CHECKING, Any, Dict, List, Optional, Sequence, Set, Union
+from typing import (
+    TYPE_CHECKING,
+    Any,
+    DefaultDict,
+    Dict,
+    List,
+    Optional,
+    Sequence,
+    Set,
+    Union,
+)
 
 from snowflake.snowpark._internal.analyzer.table_function import (
     TableFunctionExpression,
     TableFunctionJoin,
     TableFunctionRelation,
 )
 
 if TYPE_CHECKING:
     from snowflake.snowpark._internal.analyzer.analyzer import (
         Analyzer,
     )  # pragma: no cover
 
+import sys
+
 from snowflake.snowpark._internal.analyzer import analyzer_utils
 from snowflake.snowpark._internal.analyzer.analyzer_utils import result_scan_statement
 from snowflake.snowpark._internal.analyzer.binary_expression import And
 from snowflake.snowpark._internal.analyzer.expression import (
     COLUMN_DEPENDENCY_ALL,
     COLUMN_DEPENDENCY_DOLLAR,
     COLUMN_DEPENDENCY_EMPTY,
@@ -40,17 +52,17 @@
     UnresolvedAlias,
 )
 from snowflake.snowpark._internal.utils import is_sql_select_statement
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 SET_UNION = analyzer_utils.UNION
 SET_UNION_ALL = analyzer_utils.UNION_ALL
 SET_INTERSECT = analyzer_utils.INTERSECT
 SET_EXCEPT = analyzer_utils.EXCEPT
 
@@ -159,14 +171,15 @@
         self.analyzer = analyzer
         self.pre_actions: Optional[List["Query"]] = None
         self.post_actions: Optional[List["Query"]] = None
         self.flatten_disabled: bool = False
         self._column_states: Optional[ColumnStateDict] = None
         self._snowflake_plan: Optional[SnowflakePlan] = None
         self.expr_to_alias = {}
+        self.df_aliased_col_name_to_real_col_name: DefaultDict[str, Dict[str, str]] = {}
         self._api_calls = api_calls.copy() if api_calls is not None else None
 
     @property
     @abstractmethod
     def sql_query(self) -> str:
         """Returns the sql query of this Selectable logical plan."""
         pass
@@ -211,14 +224,15 @@
             queries = [*self.pre_actions, query] if self.pre_actions else [query]
             self._snowflake_plan = SnowflakePlan(
                 queries,
                 self.schema_query,
                 post_actions=self.post_actions,
                 session=self.analyzer.session,
                 expr_to_alias=self.expr_to_alias,
+                df_aliased_col_name_to_real_col_name=self.df_aliased_col_name_to_real_col_name,
                 source_plan=self,
             )
             # set api_calls to self._snowflake_plan outside of the above constructor
             # because the constructor copy api_calls.
             # We want Selectable and SnowflakePlan to share the same api_calls.
             self._snowflake_plan.api_calls = self.api_calls
         return self._snowflake_plan
@@ -226,15 +240,17 @@
     @property
     def column_states(self) -> ColumnStateDict:
         """A dictionary that contains the column states of a query.
         Refer to class ColumnStateDict.
         """
         if self._column_states is None:
             self._column_states = initiate_column_states(
-                self.snowflake_plan.attributes, self.analyzer
+                self.snowflake_plan.attributes,
+                self.analyzer,
+                self.df_aliased_col_name_to_real_col_name,
             )
         return self._column_states
 
 
 class SelectableEntity(Selectable):
     """Query from a table, view, or any other Snowflake objects.
     Mainly used by session.table().
@@ -329,14 +345,18 @@
         super().__init__(analyzer)
         self._snowflake_plan = (
             snowflake_plan
             if isinstance(snowflake_plan, SnowflakePlan)
             else analyzer.resolve(snowflake_plan)
         )
         self.expr_to_alias.update(self._snowflake_plan.expr_to_alias)
+        self.df_aliased_col_name_to_real_col_name.update(
+            self._snowflake_plan.df_aliased_col_name_to_real_col_name
+        )
+
         self.pre_actions = self._snowflake_plan.queries[:-1]
         self.post_actions = self._snowflake_plan.post_actions
         self._api_calls = self._snowflake_plan.api_calls
         self._query_params = []
         for query in self._snowflake_plan.queries:
             if query.params:
                 self._query_params.extend(query.params)
@@ -362,15 +382,15 @@
     """The main logic plan to be used by a DataFrame.
     It structurally has the parts of a query and uses the ColumnState to decide whether a query can be flattened."""
 
     def __init__(
         self,
         *,
         projection: Optional[List[Expression]] = None,
-        from_: Optional["Selectable"] = None,
+        from_: Optional[Union[LogicalPlan, Selectable]] = None,
         where: Optional[Expression] = None,
         order_by: Optional[List[Expression]] = None,
         limit_: Optional[int] = None,
         offset: Optional[int] = None,
         analyzer: "Analyzer",
     ) -> None:
         super().__init__(analyzer)
@@ -383,14 +403,17 @@
         self.pre_actions = self.from_.pre_actions
         self.post_actions = self.from_.post_actions
         self._sql_query = None
         self._schema_query = None
         self._projection_in_str = None
         self._query_params = None
         self.expr_to_alias.update(self.from_.expr_to_alias)
+        self.df_aliased_col_name_to_real_col_name.update(
+            self.from_.df_aliased_col_name_to_real_col_name
+        )
         self.api_calls = (
             self.from_.api_calls.copy() if self.from_.api_calls is not None else None
         )  # will be replaced by new api calls if any operation.
 
     def __copy__(self):
         new = SelectStatement(
             projection=self.projection,
@@ -405,14 +428,18 @@
         # to avoid problems.
         new._projection_in_str = None
         new._schema_query = None
         new._column_states = None
         new._snowflake_plan = None
         new.flatten_disabled = False  # by default a SelectStatement can be flattened.
         new._api_calls = self._api_calls.copy() if self._api_calls is not None else None
+        new.df_aliased_col_name_to_real_col_name = (
+            self.df_aliased_col_name_to_real_col_name
+        )
+
         return new
 
     @property
     def column_states(self) -> ColumnStateDict:
         if self._column_states is None:
             if not self.projection and not self.has_clause:
                 self._column_states = self.from_.column_states
@@ -434,15 +461,16 @@
         return self.has_clause_using_columns or self.limit_ is not None
 
     @property
     def projection_in_str(self) -> str:
         if not self._projection_in_str:
             self._projection_in_str = (
                 analyzer_utils.COMMA.join(
-                    self.analyzer.analyze(x) for x in self.projection
+                    self.analyzer.analyze(x, self.df_aliased_col_name_to_real_col_name)
+                    for x in self.projection
                 )
                 if self.projection
                 else analyzer_utils.STAR
             )
         return self._projection_in_str
 
     @property
@@ -450,20 +478,20 @@
         if self._sql_query:
             return self._sql_query
         if not self.has_clause and not self.projection:
             self._sql_query = self.from_.sql_query
             return self._sql_query
         from_clause = self.from_.sql_in_subquery
         where_clause = (
-            f"{analyzer_utils.WHERE}{self.analyzer.analyze(self.where)}"
+            f"{analyzer_utils.WHERE}{self.analyzer.analyze(self.where, self.df_aliased_col_name_to_real_col_name)}"
             if self.where is not None
             else analyzer_utils.EMPTY_STRING
         )
         order_by_clause = (
-            f"{analyzer_utils.ORDER_BY}{analyzer_utils.COMMA.join(self.analyzer.analyze(x) for x in self.order_by)}"
+            f"{analyzer_utils.ORDER_BY}{analyzer_utils.COMMA.join(self.analyzer.analyze(x, self.df_aliased_col_name_to_real_col_name) for x in self.order_by)}"
             if self.order_by
             else analyzer_utils.EMPTY_STRING
         )
         limit_clause = (
             f"{analyzer_utils.LIMIT}{self.limit_}"
             if self.limit_ is not None
             else analyzer_utils.EMPTY_STRING
@@ -725,14 +753,16 @@
         self.func_expr = func_expr
         if other_plan:
             self._snowflake_plan = analyzer.resolve(
                 TableFunctionJoin(other_plan, func_expr)
             )
         else:
             self._snowflake_plan = analyzer.resolve(TableFunctionRelation(func_expr))
+        self.pre_actions = self._snowflake_plan.queries[:-1]
+        self.post_actions = self._snowflake_plan.post_actions
         self._api_calls = self._snowflake_plan.api_calls
 
     @property
     def snowflake_plan(self):
         return self._snowflake_plan
 
     @property
@@ -784,15 +814,17 @@
         Refer to https://docs.snowflake.com/en/sql-reference/operators-query.html#general-usage-notes"""
         return self.set_operands[0].selectable.schema_query
 
     @property
     def column_states(self) -> Optional[ColumnStateDict]:
         if not self._column_states:
             self._column_states = initiate_column_states(
-                self.set_operands[0].selectable.column_states.projection, self.analyzer
+                self.set_operands[0].selectable.column_states.projection,
+                self.analyzer,
+                self.df_aliased_col_name_to_real_col_name,
             )
         return self._column_states
 
     @property
     def query_params(self) -> Optional[Sequence[Any]]:
         query_params = None
         for operand in self.set_operands:
@@ -803,31 +835,39 @@
         return query_params
 
 
 class DeriveColumnDependencyError(Exception):
     """When deriving column dependencies from the subquery."""
 
 
-def parse_column_name(column: Expression, analyzer: "Analyzer") -> Optional[str]:
+def parse_column_name(
+    column: Expression,
+    analyzer: "Analyzer",
+    df_aliased_col_name_to_real_col_name: DefaultDict[str, Dict[str, str]],
+) -> Optional[str]:
     if isinstance(column, Expression):
         if isinstance(column, Attribute):
             # Use analyze for the case of
             #     df1 = session.create_dataframe([[1]], schema=["a"])
             #     df2 = df1.select(df1["a"].alias("b"))
             #     df3 = df2.select(df1["a"])  # df1["a"] converted to column name "b" instead of "a"
             #     df3.show()
             # some expressions converted to SQL text with extra preceeding and trailing spaces.
             # Snowflake SQL removes the spaces in the returned column names.
             # So we remove it at the client too.
-            return analyzer.analyze(column, parse_local_name=True).strip(" ")
+            return analyzer.analyze(
+                column, df_aliased_col_name_to_real_col_name, parse_local_name=True
+            ).strip(" ")
         if isinstance(column, UnresolvedAttribute):
             if not column.is_sql_text:
                 return column.name
         if isinstance(column, UnresolvedAlias):
-            return analyzer.analyze(column, parse_local_name=True).strip(" ")
+            return analyzer.analyze(
+                column, df_aliased_col_name_to_real_col_name, parse_local_name=True
+            ).strip(" ")
         if isinstance(column, Alias):
             return column.name
     # We can parse column name from a column's SQL expression in the future.
     # When parsing column name isn't possible, the SelectStatement.select won't flatten and
     # disables the next level SelectStatement to flatten
     return None
 
@@ -913,20 +953,24 @@
                     # We can inspect whether the referenced new column uses window function. Here we are being
                     # conservative for now to not flatten the SQL.
                     return False
     return True
 
 
 def initiate_column_states(
-    column_attrs: List[Attribute], analyzer: "Analyzer"
+    column_attrs: List[Attribute],
+    analyzer: "Analyzer",
+    df_aliased_col_name_to_real_col_name: Dict[str, str],
 ) -> ColumnStateDict:
     column_states = ColumnStateDict()
     for attr in column_attrs:
         # review later. should use parse_column_name
-        name = analyzer.analyze(attr, parse_local_name=True).strip(" ")
+        name = analyzer.analyze(
+            attr, df_aliased_col_name_to_real_col_name, parse_local_name=True
+        ).strip(" ")
         column_states[name] = ColumnState(
             name,
             change_state=ColumnChangeState.UNCHANGED_EXP,
             expression=attr,
             dependent_columns=COLUMN_DEPENDENCY_EMPTY,
             depend_on_same_level=False,
             referenced_by_same_level_columns=COLUMN_DEPENDENCY_EMPTY,
@@ -969,30 +1013,40 @@
     for c in cols:
         if isinstance(c, UnresolvedAlias) and isinstance(c.child, Star):
             if c.child.expressions:
                 # df.select(df["*"]) will have child expressions. df.select("*") doesn't.
                 columns_from_star = [copy(e) for e in c.child.expressions]
             else:
                 columns_from_star = [copy(e) for e in from_.column_states.projection]
-            column_states.update(initiate_column_states(columns_from_star, analyzer))
+            column_states.update(
+                initiate_column_states(
+                    columns_from_star,
+                    analyzer,
+                    from_.df_aliased_col_name_to_real_col_name,
+                )
+            )
             column_states.projection.extend(columns_from_star)
             continue
-        c_name = parse_column_name(c, analyzer)
+        c_name = parse_column_name(
+            c, analyzer, from_.df_aliased_col_name_to_real_col_name
+        )
         if c_name is None:
             return None
         quoted_c_name = analyzer_utils.quote_name(c_name)
         # if c is not an Attribute object, we will only care about the column name,
         # so we can build a dummy Attribute with the column name
         column_states.projection.append(
             c if isinstance(c, Attribute) else Attribute(quoted_c_name)
         )
         from_c_state = from_.column_states.get(quoted_c_name)
         if from_c_state and from_c_state.change_state != ColumnChangeState.DROPPED:
             # review later. should use parse_column_name
-            if c_name != analyzer.analyze(c, parse_local_name=True).strip(" "):
+            if c_name != analyzer.analyze(
+                c, from_.df_aliased_col_name_to_real_col_name, parse_local_name=True
+            ).strip(" "):
                 column_states[quoted_c_name] = ColumnState(
                     quoted_c_name,
                     ColumnChangeState.CHANGED_EXP,
                     c,
                     state_dict=column_states,
                 )
             else:
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan.py`

 * *Files 3% similar despite different names*

```diff
@@ -2,25 +2,26 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import re
 import sys
 import uuid
+from collections import defaultdict
 from functools import cached_property
 from typing import (
     TYPE_CHECKING,
     Any,
     Callable,
+    DefaultDict,
     Dict,
     List,
     Optional,
     Sequence,
     Tuple,
-    Union,
 )
 
 from snowflake.snowpark._internal.analyzer.table_function import GeneratorTableFunction
 
 if TYPE_CHECKING:
     from snowflake.snowpark._internal.analyzer.select_statement import (
         Selectable,
@@ -85,17 +86,17 @@
 )
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.types import StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class SnowflakePlan(LogicalPlan):
     class Decorator:
         __wrap_exception_regex_match = re.compile(
             r"""(?s).*invalid identifier '"?([^'"]*)"?'.*"""
@@ -186,27 +187,37 @@
         schema_query: str,
         post_actions: Optional[List["Query"]] = None,
         expr_to_alias: Optional[Dict[uuid.UUID, str]] = None,
         session: Optional["snowflake.snowpark.session.Session"] = None,
         source_plan: Optional[LogicalPlan] = None,
         is_ddl_on_temp_object: bool = False,
         api_calls: Optional[List[Dict]] = None,
+        df_aliased_col_name_to_real_col_name: Optional[
+            DefaultDict[str, Dict[str, str]]
+        ] = None,
     ) -> None:
         super().__init__()
         self.queries = queries
         self.schema_query = schema_query
         self.post_actions = post_actions if post_actions else []
         self.expr_to_alias = expr_to_alias if expr_to_alias else {}
         self.session = session
         self.source_plan = source_plan
         self.is_ddl_on_temp_object = is_ddl_on_temp_object
         # We need to copy this list since we don't want to change it for the
         # previous SnowflakePlan objects
         self.api_calls = api_calls.copy() if api_calls else []
         self._output_dict = None
+        # Used for dataframe alias
+        if df_aliased_col_name_to_real_col_name:
+            self.df_aliased_col_name_to_real_col_name = (
+                df_aliased_col_name_to_real_col_name
+            )
+        else:
+            self.df_aliased_col_name_to_real_col_name = defaultdict(dict)
 
     def with_subqueries(self, subquery_plans: List["SnowflakePlan"]) -> "SnowflakePlan":
         pre_queries = self.queries[:-1]
         new_schema_query = self.schema_query
         new_post_actions = [*self.post_actions]
         api_calls = [*self.api_calls]
 
@@ -226,14 +237,15 @@
             pre_queries + [self.queries[-1]],
             new_schema_query,
             post_actions=new_post_actions,
             expr_to_alias=self.expr_to_alias,
             session=self.session,
             source_plan=self.source_plan,
             api_calls=api_calls,
+            df_aliased_col_name_to_real_col_name=self.df_aliased_col_name_to_real_col_name,
         )
 
     @cached_property
     def attributes(self) -> List[Attribute]:
         output = analyze_attributes(self.schema_query, self.session)
         self.schema_query = schema_value_statement(output)
         return output
@@ -256,14 +268,15 @@
             self.schema_query,
             self.post_actions.copy() if self.post_actions else None,
             dict(self.expr_to_alias) if self.expr_to_alias else None,
             self.session,
             self.source_plan,
             self.is_ddl_on_temp_object,
             self.api_calls.copy() if self.api_calls else None,
+            self.df_aliased_col_name_to_real_col_name,
         )
 
     def add_aliases(self, to_add: Dict) -> None:
         self.expr_to_alias = {**self.expr_to_alias, **to_add}
 
 
 class SnowflakePlanBuilder:
@@ -297,14 +310,15 @@
             new_schema_query,
             select_child.post_actions,
             select_child.expr_to_alias,
             self.session,
             source_plan,
             is_ddl_on_temp_object,
             api_calls=select_child.api_calls,
+            df_aliased_col_name_to_real_col_name=child.df_aliased_col_name_to_real_col_name,
         )
 
     @SnowflakePlan.Decorator.wrap_exception
     def build_from_multiple_queries(
         self,
         multi_sql_generator: Callable[["Query"], List["Query"]],
         child: SnowflakePlan,
@@ -535,23 +549,21 @@
             left,
             right,
             source_plan,
         )
 
     def save_as_table(
         self,
-        table_name: Union[str, Iterable[str]],
+        table_name: Iterable[str],
         column_names: Optional[Iterable[str]],
         mode: SaveMode,
         table_type: str,
         child: SnowflakePlan,
     ) -> SnowflakePlan:
-        full_table_name = (
-            table_name if isinstance(table_name, str) else ".".join(table_name)
-        )
+        full_table_name = ".".join(table_name)
         if mode == SaveMode.APPEND:
             if self.session._table_exists(table_name):
                 return self.build(
                     lambda x: insert_into_statement(
                         table_name=full_table_name,
                         child=x,
                         column_names=column_names,
@@ -747,14 +759,15 @@
         path: str,
         format: str,
         options: Dict[str, str],
         fully_qualified_schema: str,
         schema: List[Attribute],
         schema_to_cast: Optional[List[Tuple[str, str]]] = None,
         transformations: Optional[List[str]] = None,
+        metadata_project: Optional[List[str]] = None,
     ):
         format_type_options, copy_options = get_copy_into_table_options(options)
         pattern = options.get("PATTERN", None)
         # Can only infer the schema for parquet, orc and avro
         infer_schema = (
             options.get("INFER_SCHEMA", True)
             if format in INFER_SCHEMA_FORMAT_TYPES
@@ -793,20 +806,24 @@
                         drop_file_format_if_exists_statement(format_name),
                         is_ddl_on_temp_object=True,
                     )
                 )
             else:
                 format_name = options["FORMAT_NAME"]
 
+            schema_project = (
+                schema_cast_named(schema_to_cast)
+                if infer_schema
+                else schema_cast_seq(schema)
+            )
+            metadata_project = [] if metadata_project is None else metadata_project
             queries.append(
                 Query(
                     select_from_path_with_format_statement(
-                        schema_cast_named(schema_to_cast)
-                        if infer_schema
-                        else schema_cast_seq(schema),
+                        metadata_project + schema_project,
                         path,
                         format_name,
                         pattern,
                     )
                 )
             )
             return SnowflakePlan(
@@ -892,15 +909,15 @@
                 self.session,
                 None,
             )
 
     def copy_into_table(
         self,
         file_format: str,
-        table_name: Union[str, Iterable[str]],
+        table_name: Iterable[str],
         path: Optional[str] = None,
         files: Optional[str] = None,
         pattern: Optional[str] = None,
         format_type_options: Optional[Dict[str, Any]] = None,
         copy_options: Optional[Dict[str, Any]] = None,
         validation_mode: Optional[str] = None,
         column_names: Optional[List[str]] = None,
@@ -908,17 +925,15 @@
         user_schema: Optional[StructType] = None,
         create_table_from_infer_schema: bool = False,
     ) -> SnowflakePlan:
         # tracking usage of pattern, will refactor this function in future
         if pattern:
             self.session._conn._telemetry_client.send_copy_pattern_telemetry()
 
-        full_table_name = (
-            table_name if isinstance(table_name, str) else ".".join(table_name)
-        )
+        full_table_name = ".".join(table_name)
         copy_command = copy_into_table(
             table_name=full_table_name,
             file_path=path,
             files=files,
             file_format_type=file_format,
             format_type_options=format_type_options,
             copy_options=copy_options,
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/snowflake_plan_node.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,26 +1,27 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from enum import Enum
-from typing import Any, Dict, List, Optional, Union
+from typing import Any, Dict, List, Optional
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.expression import Attribute, Expression
 from snowflake.snowpark.row import Row
 from snowflake.snowpark.types import StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class LogicalPlan:
     def __init__(self) -> None:
         self.children = []
 
@@ -59,15 +60,15 @@
     ERROR_IF_EXISTS = "errorifexists"
     IGNORE = "ignore"
 
 
 class SnowflakeCreateTable(LogicalPlan):
     def __init__(
         self,
-        table_name: Union[str, Iterable[str]],
+        table_name: Iterable[str],
         column_names: Optional[Iterable[str]],
         mode: SaveMode,
         query: Optional[LogicalPlan],
         table_type: str = "",
     ) -> None:
         super().__init__()
         self.table_name = table_name
@@ -88,15 +89,15 @@
         self.child = child
         self.children.append(child)
 
 
 class CopyIntoTableNode(LeafNode):
     def __init__(
         self,
-        table_name: Union[str, Iterable[str]],
+        table_name: Iterable[str],
         *,
         file_path: Optional[str] = None,
         files: Optional[str] = None,
         pattern: Optional[str] = None,
         file_format: Optional[str] = None,
         format_type_options: Optional[Dict[str, Any]],
         column_names: Optional[List[str]] = None,
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/sort_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_function.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/table_function.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,23 +1,24 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Dict, List, Optional
 
 from snowflake.snowpark._internal.analyzer.expression import Expression
 from snowflake.snowpark._internal.analyzer.snowflake_plan_node import LogicalPlan
 from snowflake.snowpark._internal.analyzer.sort_expression import SortOrder
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class TableFunctionPartitionSpecDefinition(Expression):
     def __init__(
         self,
         over: bool = False,
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/table_merge_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/unary_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/unary_plan_node.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/analyzer/window_expression.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/code_generation.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/code_generation.py`

 * *Files 1% similar despite different names*

```diff
@@ -16,17 +16,17 @@
 from typing import Any, Dict, List, Set, Tuple, Union
 
 import opcode
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 logger = getLogger(__name__)
 
 STORE_GLOBAL = opcode.opmap["STORE_GLOBAL"]
 DELETE_GLOBAL = opcode.opmap["DELETE_GLOBAL"]
 LOAD_GLOBAL = opcode.opmap["LOAD_GLOBAL"]
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/error_message.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/error_message.py`

 * *Files 2% similar despite different names*

```diff
@@ -233,14 +233,21 @@
         return SnowparkCreateDynamicTableException(
             "Your dataframe may include DDL or DML operations. Creating a dynamic table from "
             "this DataFrame is currently not supported.",
             "1207",
         )
 
     @staticmethod
+    def DF_ALIAS_NOT_RECOGNIZED(alias: str) -> SnowparkDataframeException:
+        return SnowparkDataframeException(
+            f"DataFrame alias unrecognized. A subset of columns corresponding to Dataframe alias '{alias}' can not be found. "
+            "1208",
+        )
+
+    @staticmethod
     def PLAN_CREATE_DYNAMIC_TABLE_FROM_SELECT_ONLY() -> SnowparkCreateDynamicTableException:
         return SnowparkCreateDynamicTableException(
             "Creating dynamic tables from SELECT queries supported only.", "1208"
         )
 
     # SQL Execution error codes 03XX
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/server_connection.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/server_connection.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/telemetry.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/telemetry.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/type_utils.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/type_utils.py`

 * *Files 6% similar despite different names*

```diff
@@ -72,15 +72,15 @@
         PandasDataFrameType,
         PandasSeries,
         PandasSeriesType,
     )
 
 
 def convert_sf_to_sp_type(
-    column_type_name: str, precision: int, scale: int
+    column_type_name: str, precision: int, scale: int, internal_size: int
 ) -> DataType:
     """Convert the Snowflake logical type to the Snowpark type."""
     if column_type_name == "ARRAY":
         return ArrayType(StringType())
     if column_type_name == "VARIANT":
         return VariantType()
     if column_type_name == "OBJECT":
@@ -88,15 +88,19 @@
     if column_type_name == "GEOGRAPHY":
         return GeographyType()
     if column_type_name == "BOOLEAN":
         return BooleanType()
     if column_type_name == "BINARY":
         return BinaryType()
     if column_type_name == "TEXT":
-        return StringType()
+        if internal_size > 0:
+            return StringType(internal_size)
+        elif internal_size == 0:
+            return StringType()
+        raise ValueError(f"Negative value is not a valid input for StringType")
     if column_type_name == "TIME":
         return TimeType()
     if column_type_name in (
         "TIMESTAMP",
         "TIMESTAMP_LTZ",
         "TIMESTAMP_TZ",
         "TIMESTAMP_NTZ",
@@ -141,15 +145,19 @@
         return "BIGINT"
     if isinstance(datatype, FloatType):
         return "FLOAT"
     if isinstance(datatype, DoubleType):
         return "DOUBLE"
     # We regard NullType as String, which is required when creating
     # a dataframe from local data with all None values
-    if isinstance(datatype, (StringType, NullType)):
+    if isinstance(datatype, StringType):
+        if datatype.length:
+            return f"STRING({datatype.length})"
+        return "STRING"
+    if isinstance(datatype, NullType):
         return "STRING"
     if isinstance(datatype, BooleanType):
         return "BOOLEAN"
     if isinstance(datatype, DateType):
         return "DATE"
     if isinstance(datatype, TimeType):
         return "TIME"
@@ -391,14 +399,15 @@
         return eval(tp_str)
 
 
 def python_type_to_snow_type(tp: Union[str, Type]) -> Tuple[DataType, bool]:
     """Converts a Python type or a Python type string to a Snowpark type.
     Returns a Snowpark type and whether it's nullable.
     """
+    from snowflake.snowpark.dataframe import DataFrame
     # convert a type string to a type object
     if isinstance(tp, str):
         tp = python_type_str_to_object(tp)
 
     if tp is decimal.Decimal:
         return DecimalType(38, 18), False
     elif tp in PYTHON_TO_SNOW_TYPE_MAPPINGS:
@@ -453,14 +462,17 @@
                     [python_type_to_snow_type(tp_arg)[0] for tp_arg in tp_args]
                     if tp_args
                     else ()
                 ),
                 False,
             )
 
+    if tp == DataFrame:
+        return StructType(), False
+
     if tp == Variant:
         return VariantType(), False
 
     if tp == Geography:
         return GeographyType(), False
 
     raise TypeError(f"invalid type {tp}")
@@ -470,23 +482,26 @@
     if isinstance(
         snow_type,
         (
             BinaryType,
             BooleanType,
             FloatType,
             DoubleType,
-            StringType,
             DateType,
             TimestampType,
             TimeType,
             GeographyType,
             VariantType,
         ),
     ):
         return snow_type.__class__.__name__[:-4].lower()
+    if isinstance(snow_type, StringType):
+        if snow_type.length:
+            return f"string({snow_type.length})"
+        return "string"
     if isinstance(snow_type, ByteType):
         return "tinyint"
     if isinstance(snow_type, ShortType):
         return "smallint"
     if isinstance(snow_type, IntegerType):
         return "int"
     if isinstance(snow_type, LongType):
@@ -598,38 +613,46 @@
 DATA_TYPE_STRING_OBJECT_MAPPINGS["array"] = ArrayType
 
 DECIMAL_RE = re.compile(
     r"^\s*(numeric|number|decimal)\s*\(\s*(\s*)(\d*)\s*,\s*(\d*)\s*\)\s*$"
 )
 # support type string format like "  decimal  (  2  ,  1  )  "
 
+STRING_RE = re.compile(
+    r"^\s*(varchar|string|text)\s*\(\s*(\d*)\s*\)\s*$"
+)
+# support type string format like "  string  (  23  )  "
+
 
 def get_number_precision_scale(type_str: str) -> Optional[Tuple[int, int]]:
     decimal_matches = DECIMAL_RE.match(type_str)
     if decimal_matches:
         return int(decimal_matches.group(3)), int(decimal_matches.group(4))
 
 
+def get_string_length(type_str: str) -> Optional[int]:
+    string_matches = STRING_RE.match(type_str)
+    if string_matches:
+        return int(string_matches.group(2))
+
+
 def type_string_to_type_object(type_str: str) -> DataType:
     precision_scale = get_number_precision_scale(type_str)
     if precision_scale:
         return DecimalType(*precision_scale)
+    length = get_string_length(type_str)
+    if length:
+        return StringType(length)
     type_str = type_str.replace(" ", "")
     type_str = type_str.lower()
     try:
         return DATA_TYPE_STRING_OBJECT_MAPPINGS[type_str]()
     except KeyError:
         raise ValueError(f"'{type_str}' is not a supported type")
 
 
 # Type hints
-ColumnOrName = NewType("ColumnOrName", Union["snowflake.snowpark.column.Column", str])
-ColumnOrLiteralStr = NewType(
-    "ColumnOrLiteralStr", Union["snowflake.snowpark.column.Column", str]
-)
-ColumnOrSqlExpr = NewType(
-    "ColumnOrSqlExpr", Union["snowflake.snowpark.column.Column", str]
-)
-LiteralType = NewType("LiteralType", Union[VALID_PYTHON_TYPES_FOR_LITERAL_VALUE])
-ColumnOrLiteral = NewType(
-    "ColumnOrLiteral", Union["snowflake.snowpark.column.Column", LiteralType]
-)
+ColumnOrName = Union["snowflake.snowpark.column.Column", str]
+ColumnOrLiteralStr = Union["snowflake.snowpark.column.Column", str]
+ColumnOrSqlExpr = Union["snowflake.snowpark.column.Column", str]
+LiteralType = Union[VALID_PYTHON_TYPES_FOR_LITERAL_VALUE]
+ColumnOrLiteral = Union["snowflake.snowpark.column.Column", LiteralType]
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/udf_utils.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/udf_utils.py`

 * *Files 5% similar despite different names*

```diff
@@ -51,17 +51,17 @@
     PandasSeriesType,
     StructType,
 )
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 logger = getLogger(__name__)
 
 # the default handler name for generated udf python file
 _DEFAULT_HANDLER_NAME = "compute"
 
@@ -69,14 +69,16 @@
 # Current number is the same as scala. We might have the potential to make it larger but that requires further benchmark
 # because zip compression ratio is quite high.
 _MAX_INLINE_CLOSURE_SIZE_BYTES = 8192
 
 # Every table function handler class must define the process method.
 TABLE_FUNCTION_PROCESS_METHOD = "process"
 
+EXECUTE_AS_WHITELIST = frozenset(["owner", "caller"])
+
 
 class UDFColumn(NamedTuple):
     datatype: DataType
     name: str
 
 
 def is_local_python_file(file_path: str) -> bool:
@@ -169,14 +171,25 @@
 
     if parallel < 1 or parallel > 99:
         raise ValueError(
             "Supported values of parallel are from 1 to 99, " f"but got {parallel}"
         )
 
 
+def check_execute_as_arg(execute_as: typing.Literal["caller", "owner"]):
+    if (
+        not isinstance(execute_as, str)
+        or execute_as.lower() not in EXECUTE_AS_WHITELIST
+    ):
+        raise TypeError(
+            f"'execute_as' value '{execute_as}' is invalid, choose from "
+            f"{', '.join(EXECUTE_AS_WHITELIST, )}"
+        )
+
+
 def process_file_path(file_path: str) -> str:
     file_path = file_path.strip()
     if not file_path.startswith(STAGE_PREFIX) and not os.path.exists(file_path):
         raise ValueError(f"file_path {file_path} does not exist")
     return file_path
 
 
@@ -599,15 +612,15 @@
                     dest_filename=udf_file_name,
                     dest_prefix=dest_prefix,
                     parallel=parallel,
                     source_compression="DEFLATE",
                     compress_data=False,
                     overwrite=True,
                     is_in_udf=True,
-                    skip_upload_on_content_match=skip_upload_on_content_match
+                    skip_upload_on_content_match=skip_upload_on_content_match,
                 )
             all_urls.append(upload_file_stage_location)
             inline_code = None
             handler = f"{udf_file_name_base}.{_DEFAULT_HANDLER_NAME}"
         else:
             inline_code = code
             upload_file_stage_location = None
@@ -725,15 +738,18 @@
     handler: str,
     object_name: str,
     all_imports: str,
     all_packages: str,
     inline_python_code: Optional[str] = None,
     strict: bool = False,
 ):
-    return_sql = f"RETURNS {convert_sp_to_sf_type(return_type)}"
+    if isinstance(return_type, StructType):
+        return_sql = f'RETURNS TABLE ({",".join(f"{field.name} {convert_sp_to_sf_type(field.datatype)}" for field in return_type.fields)})'
+    else:
+        return_sql = f"RETURNS {convert_sp_to_sf_type(return_type)}"
     input_sql_types = [convert_sp_to_sf_type(arg.datatype) for arg in input_args]
     sql_func_args = ",".join(
         [f"{a.name} {t}" for a, t in zip(input_args, input_sql_types)]
     )
     imports_in_sql = f"IMPORTS=({all_imports})" if all_imports else ""
     packages_in_sql = f"PACKAGES=({all_packages})" if all_packages else ""
     inline_python_code_in_sql = (
@@ -762,11 +778,11 @@
 
 def generate_call_python_sp_sql(
     session: "snowflake.snowpark.Session", sproc_name: str, *args: Any
 ) -> str:
     sql_args = []
     for arg in args:
         if isinstance(arg, snowflake.snowpark.Column):
-            sql_args.append(session._analyzer.analyze(arg._expression))
+            sql_args.append(session._analyzer.analyze(arg._expression, {}))
         else:
             sql_args.append(to_sql(arg, infer_type(arg)))
     return f"CALL {sproc_name}({', '.join(sql_args)})"
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/_internal/utils.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/_internal/utils.py`

 * *Files 4% similar despite different names*

```diff
@@ -699,7 +699,66 @@
     # escape double quotes, e.g. users pass """a.b""" as table name:
     # df.write.save_as_table('"""a.b"""', mode="append")
     # and we should call SHOW TABLES LIKE '"a.b"'
     table_name = table_name.replace('""', '"')
 
     # if table_name == '"a.b"', then we should call SHOW TABLES LIKE 'a.b'
     return table_name[1:-1] if table_name[0] == table_name[-1] == '"' else table_name
+
+
+def parse_table_name(table_name: str) -> List[str]:
+    """
+    This function implements the algorithm to parse a table name.
+
+    We parse the table name according to the following rules:
+    https://docs.snowflake.com/en/sql-reference/identifiers-syntax
+
+    - Unquoted object identifiers:
+        - Start with a letter (A-Z, a-z) or an underscore (_).
+        - Contain only letters, underscores, decimal digits (0-9), and dollar signs ($).
+        - Are stored and resolved as uppercase characters (e.g. id is stored and resolved as ID).
+
+    - If you put double quotes around an identifier (e.g. My identifier with blanks and punctuation.),
+        the following rules apply:
+        - The case of the identifier is preserved when storing and resolving the identifier (e.g. "id" is
+            stored and resolved as id).
+        - The identifier can contain and start with ASCII, extended ASCII, and non-ASCII characters.
+    """
+    validate_object_name(table_name)
+    str_len = len(table_name)
+    ret = []
+
+    in_double_quotes = False
+    i = 0
+    cur_word_start_idx = 0
+
+    while i < str_len:
+        cur_char = table_name[i]
+        if cur_char == '"':
+            if in_double_quotes:
+                # we have to check whether this `"` is the ending of a double-quoted identifier
+                # or it's an escaping double quote
+                # to achieve this, we need to preload one more char
+                if i < str_len - 1 and table_name[i + 1] == '"':
+                    # two consecutive '"', this is an escaping double quotes
+                    # the pointer just keeps moving forward
+                    i += 1
+                else:
+                    # the double quotes indicates the ending of an identifier
+                    in_double_quotes = False
+                    # it should be followed by a '.' for splitting, or it should reach the end of the str
+            else:
+                # this is the beginning of another double-quoted identifier
+                in_double_quotes = True
+        elif cur_char == ".":
+            if not in_double_quotes:
+                # this dot is to split db.schema.database
+                # we concatenate the processed chars into a string
+                # and append the string to the return list, and set our cur_word_start_idx to position after the dot
+                ret.append(table_name[cur_word_start_idx:i])
+                cur_word_start_idx = i + 1
+            # else dot is part of the table name
+        # else cur_char is part of the name
+        i += 1
+
+    ret.append(table_name[cur_word_start_idx:i])
+    return ret
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/async_job.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/async_job.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/column.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/column.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Optional, Union
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.analyzer_utils import quote_name
 from snowflake.snowpark._internal.analyzer.binary_expression import (
     Add,
     And,
@@ -73,17 +74,17 @@
 from snowflake.snowpark._internal.utils import parse_positional_args_to_list
 from snowflake.snowpark.types import DataType
 from snowflake.snowpark.window import Window, WindowSpec
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 def _to_col_if_lit(
     col: Union[ColumnOrLiteral, "snowflake.snowpark.DataFrame"], func_name: str
 ) -> "Column":
     if isinstance(col, (Column, snowflake.snowpark.DataFrame, list, tuple, set)):
@@ -215,22 +216,36 @@
         >>> # The next line converts JSON literal to a string
         >>> df_with_semi_data.select(df_with_semi_data["object_column"]["k1"].cast(StringType()).alias("k1_value"), df_with_semi_data["array_column"][0].cast(StringType()).alias("a0_value"), df_with_semi_data["array_column"][1].cast(IntegerType()).alias("a1_value")).collect()
         [Row(K1_VALUE='v1', A0_VALUE='a0', A1_VALUE=1)]
 
     This class has methods for the most frequently used column transformations and operators. Module :mod:`snowflake.snowpark.functions` defines many functions to transform columns.
     """
 
-    def __init__(self, expr: Union[str, Expression]) -> None:
-        if isinstance(expr, str):
-            if expr == "*":
+    def __init__(
+        self, expr1: Union[str, Expression], expr2: Optional[str] = None
+    ) -> None:
+        if expr2 is not None:
+            if isinstance(expr1, str) and isinstance(expr2, str):
+                if expr2 == "*":
+                    self._expression = Star([], df_alias=expr1)
+                else:
+                    self._expression = UnresolvedAttribute(
+                        quote_name(expr2), df_alias=expr1
+                    )
+            else:
+                raise ValueError(
+                    "When Column constructor gets two arguments, both need to be <str>"
+                )
+        elif isinstance(expr1, str):
+            if expr1 == "*":
                 self._expression = Star([])
             else:
-                self._expression = UnresolvedAttribute(quote_name(expr))
-        elif isinstance(expr, Expression):
-            self._expression = expr
+                self._expression = UnresolvedAttribute(quote_name(expr1))
+        elif isinstance(expr1, Expression):
+            self._expression = expr1
         else:  # pragma: no cover
             raise TypeError("Column constructor only accepts str or expression.")
 
     def __getitem__(self, field: Union[str, int]) -> "Column":
         """Accesses an element of ARRAY column by ordinal position, or an element of OBJECT column by key."""
         if isinstance(field, str):
             return Column(SubfieldString(self._expression, field))
@@ -599,14 +614,22 @@
         property, rather than the original collation specification property.
 
         For details, see the Snowflake documentation on
         `collation specifications <https://docs.snowflake.com/en/sql-reference/collation.html#label-collation-specification>`_.
         """
         return Column(Collate(self._expression, collation_spec))
 
+    def contains(self, string: ColumnOrName) -> "Column":
+        """Returns true if the column contains `string` for each row.
+
+        Args:
+            string: the string to search for in this column.
+        """
+        return snowflake.snowpark.functions.contains(self, string)
+
     def get_name(self) -> Optional[str]:
         """Returns the column name (if the column has a name)."""
         return (
             self._expression.name
             if isinstance(self._expression, NamedExpression)
             else None
         )
@@ -790,7 +813,16 @@
 
         :meth:`else_` is an alias of :meth:`otherwise`.
         """
         return CaseExpr(CaseWhen(self._branches, Column._to_expr(value)))
 
     # This alias is to sync with snowpark scala
     else_ = otherwise
+
+
+# We support the metadata columns below based on https://docs.snowflake.com/en/user-guide/querying-metadata
+# If the list changes, we will have to add support for new columns
+METADATA_FILE_ROW_NUMBER = Column("METADATA$FILE_ROW_NUMBER")
+METADATA_FILE_CONTENT_KEY = Column("METADATA$FILE_CONTENT_KEY")
+METADATA_FILE_LAST_MODIFIED = Column("METADATA$FILE_LAST_MODIFIED")
+METADATA_START_SCAN_TIME = Column("METADATA$START_SCAN_TIME")
+METADATA_FILENAME = Column("METADATA$FILENAME")
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/context.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/context.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,14 +2,15 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import copy
 import itertools
 import re
+import sys
 from collections import Counter
 from functools import cached_property
 from logging import getLogger
 from typing import (
     TYPE_CHECKING,
     Any,
     Dict,
@@ -42,14 +43,15 @@
 )
 from snowflake.snowpark._internal.analyzer.expression import (
     Attribute,
     Expression,
     Literal,
     NamedExpression,
     Star,
+    UnresolvedAttribute,
 )
 from snowflake.snowpark._internal.analyzer.select_statement import (
     SET_EXCEPT,
     SET_INTERSECT,
     SET_UNION,
     SET_UNION_ALL,
     SelectSnowflakePlan,
@@ -102,20 +104,22 @@
     SKIP_LEVELS_THREE,
     SKIP_LEVELS_TWO,
     TempObjectType,
     check_is_pandas_dataframe_in_to_pandas,
     column_to_bool,
     create_or_update_statement_params_with_query_tag,
     deprecated,
+    experimental,
     generate_random_alphanumeric,
     get_copy_into_table_options,
     is_snowflake_quoted_id_case_insensitive,
     is_snowflake_unquoted_suffix_case_insensitive,
     is_sql_select_statement,
     parse_positional_args_to_list,
+    parse_table_name,
     private_preview,
     random_name_for_temp_object,
     validate_object_name,
 )
 from snowflake.snowpark.async_job import AsyncJob, _AsyncResultType
 from snowflake.snowpark.column import Column, _to_col_if_sql_expr, _to_col_if_str
 from snowflake.snowpark.dataframe_na_functions import DataFrameNaFunctions
@@ -145,17 +149,17 @@
     _get_cols_after_join_table,
 )
 from snowflake.snowpark.types import StringType, StructType, _NumericType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 if TYPE_CHECKING:
     from table import Table  # pragma: no cover
 
 _logger = getLogger(__name__)
 
@@ -203,15 +207,15 @@
         return col.alias(f'"{unquoted_col_name}"')
 
 
 def _disambiguate(
     lhs: "DataFrame",
     rhs: "DataFrame",
     join_type: JoinType,
-    using_columns: List[str],
+    using_columns: Iterable[str],
     *,
     lsuffix: str = "",
     rsuffix: str = "",
 ) -> Tuple["DataFrame", "DataFrame"]:
     if lsuffix == rsuffix and lsuffix:
         raise ValueError(
             f"'lsuffix' and 'rsuffix' must be different if they're not empty. You set {lsuffix!r} to both."
@@ -230,14 +234,16 @@
         if n in set(rhs_names) and n not in normalized_using_columns
     ]
 
     if common_col_names:
         # We use the session of the LHS DataFrame to report this telemetry
         lhs._session._conn._telemetry_client.send_alias_in_join_telemetry()
 
+    lsuffix = lsuffix or lhs._alias
+    rsuffix = rsuffix or rhs._alias
     suffix_provided = lsuffix or rsuffix
     lhs_prefix = _generate_prefix("l") if not suffix_provided else ""
     rhs_prefix = _generate_prefix("r") if not suffix_provided else ""
 
     lhs_remapped = lhs.select(
         [
             _alias_if_needed(
@@ -500,14 +506,17 @@
         is_cached: bool = False,
     ) -> None:
         self._session = session
         self._plan = self._session._analyzer.resolve(plan)
         if isinstance(plan, SelectStatement):
             self._select_statement = plan
             plan.expr_to_alias.update(self._plan.expr_to_alias)
+            plan.df_aliased_col_name_to_real_col_name.update(
+                self._plan.df_aliased_col_name_to_real_col_name
+            )
         else:
             self._select_statement = None
         self._statement_params = None
         self.is_cached: bool = is_cached  #: Whether the dataframe is cached.
 
         self._reader: Optional["snowflake.snowpark.DataFrameReader"] = None
         self._writer = DataFrameWriter(self)
@@ -520,14 +529,16 @@
         self.sampleBy = self.sample_by = self._stat.sample_by
 
         self._na = DataFrameNaFunctions(self)
         self.dropna = self._na.drop
         self.fillna = self._na.fill
         self.replace = self._na.replace
 
+        self._alias: Optional[str] = None
+
     @property
     def stat(self) -> DataFrameStatFunctions:
         return self._stat
 
     @overload
     def collect(
         self,
@@ -1102,14 +1113,24 @@
                 names.append(c)
             elif isinstance(c, Column) and isinstance(c._expression, Attribute):
                 names.append(
                     self._plan.expr_to_alias.get(
                         c._expression.expr_id, c._expression.name
                     )
                 )
+            elif (
+                isinstance(c, Column)
+                and isinstance(c._expression, UnresolvedAttribute)
+                and c._expression.df_alias
+            ):
+                names.append(
+                    self._plan.df_aliased_col_name_to_real_col_name.get(
+                        c._expression.name, c._expression.name
+                    )
+                )
             elif isinstance(c, Column) and isinstance(c._expression, NamedExpression):
                 names.append(c._expression.name)
             else:
                 raise SnowparkClientExceptionMessages.DF_CANNOT_DROP_COLUMN_NAME(str(c))
 
         normalized_names = {quote_name(n) for n in names}
         existing_names = [attr.name for attr in self._output]
@@ -1242,14 +1263,59 @@
                     SortOrder(exprs[idx], orders[idx] if orders else Ascending())
                 )
 
         if self._select_statement:
             return self._with_plan(self._select_statement.sort(sort_exprs))
         return self._with_plan(Sort(sort_exprs, self._plan))
 
+    @experimental(version="1.5.0")
+    def alias(self, name: str):
+        """Returns an aliased dataframe in which the columns can now be referenced to using `col(<df alias>, <column name>)`.
+
+        Examples::
+            >>> from snowflake.snowpark.functions import col
+            >>> df1 = session.create_dataframe([[1, 6], [3, 8], [7, 7]], schema=["col1", "col2"])
+            >>> df2 = session.create_dataframe([[1, 2], [3, 4], [5, 5]], schema=["col1", "col2"])
+
+            Join two dataframes with duplicate column names
+            >>> df1.alias("L").join(df2.alias("R"), col("L", "col1") == col("R", "col1")).select(col("L", "col1"), col("R", "col2")).show()
+            ---------------------
+            |"COL1L"  |"COL2R"  |
+            ---------------------
+            |1        |2        |
+            |3        |4        |
+            ---------------------
+            <BLANKLINE>
+
+            Self join:
+            >>> df1.alias("L").join(df1.alias("R"), on="col1").select(col("L", "col1"), col("R", "col2")).show()
+            --------------------
+            |"COL1"  |"COL2R"  |
+            --------------------
+            |1       |6        |
+            |3       |8        |
+            |7       |7        |
+            --------------------
+            <BLANKLINE>
+
+        Args:
+            name: The alias as :class:`str`.
+        """
+        _copy = copy.copy(self)
+        _copy._alias = name
+        for attr in self._plan.attributes:
+            if _copy._select_statement:
+                _copy._select_statement.df_aliased_col_name_to_real_col_name[name][
+                    attr.name
+                ] = attr.name  # attr is quoted already
+            _copy._plan.df_aliased_col_name_to_real_col_name[name][
+                attr.name
+            ] = attr.name
+        return _copy
+
     @df_api_usage
     def agg(
         self,
         *exprs: Union[Column, Tuple[ColumnOrName, str], Dict[str, str]],
     ) -> "DataFrame":
         """Aggregate the data in the DataFrame. Use this method if you don't need to
         group the data (:func:`group_by`).
@@ -1803,15 +1869,18 @@
         Args:
             other: the other :class:`DataFrame` that contains the rows to use for the
                 intersection.
         """
         if self._select_statement:
             return self._with_plan(
                 self._select_statement.set_operator(
-                    other._select_statement or SelectSnowflakePlan(other._plan),
+                    other._select_statement
+                    or SelectSnowflakePlan(
+                        other._plan, analyzer=self._session._analyzer
+                    ),
                     operator=SET_INTERSECT,
                 )
             )
         return self._with_plan(Intersect(self._plan, other._plan))
 
     @df_api_usage
     def except_(self, other: "DataFrame") -> "DataFrame":
@@ -1834,15 +1903,18 @@
 
         Args:
             other: The :class:`DataFrame` that contains the rows to exclude.
         """
         if self._select_statement:
             return self._with_plan(
                 self._select_statement.set_operator(
-                    other._select_statement or SelectSnowflakePlan(other._plan),
+                    other._select_statement
+                    or SelectSnowflakePlan(
+                        other._plan, analyzer=self._session._analyzer
+                    ),
                     operator=SET_EXCEPT,
                 )
             )
         return self._with_plan(Except(self._plan, other._plan))
 
     @df_api_usage
     def natural_join(
@@ -1903,15 +1975,15 @@
             return self._with_plan(select_plan)
         return self._with_plan(join_plan)
 
     @df_api_usage
     def join(
         self,
         right: "DataFrame",
-        on: Optional[Union[ColumnOrName, Iterable[ColumnOrName]]] = None,
+        on: Optional[Union[ColumnOrName, Iterable[str]]] = None,
         how: Optional[str] = None,
         *,
         lsuffix: str = "",
         rsuffix: str = "",
         **kwargs,
     ) -> "DataFrame":
         """Performs a join of the specified type (``how``) with the current
@@ -2056,15 +2128,29 @@
             # Parse using_columns arg
             if column_to_bool(using_columns) is False:
                 using_columns = []
             elif isinstance(using_columns, str):
                 using_columns = [using_columns]
             elif isinstance(using_columns, Column):
                 using_columns = using_columns
-            elif not isinstance(using_columns, list):
+            elif (
+                isinstance(using_columns, Iterable)
+                and len(using_columns) > 0
+                and not all([isinstance(col, str) for col in using_columns])
+            ):
+                bad_idx, bad_col = next(
+                    (idx, col)
+                    for idx, col in enumerate(using_columns)
+                    if not isinstance(col, str)
+                )
+                raise TypeError(
+                    f"All list elements for 'on' or 'using_columns' must be string type. "
+                    f"Got: '{type(bad_col)}' at index {bad_idx}"
+                )
+            elif not isinstance(using_columns, Iterable):
                 raise TypeError(
                     f"Invalid input type for join column: {type(using_columns)}"
                 )
 
             return self._join_dataframes(
                 right,
                 using_columns,
@@ -2262,15 +2348,15 @@
             lsuffix=lsuffix,
             rsuffix=rsuffix,
         )
 
     def _join_dataframes(
         self,
         right: "DataFrame",
-        using_columns: Union[Column, List[str]],
+        using_columns: Union[Column, Iterable[str]],
         join_type: JoinType,
         *,
         lsuffix: str = "",
         rsuffix: str = "",
     ) -> "DataFrame":
         if isinstance(using_columns, Column):
             return self._join_dataframes_internal(
@@ -2635,14 +2721,17 @@
                 f"Number of column names provided to copy into does not match the number of transformations provided. Number of column names: {len(target_columns)}, number of transformations: {len(transformations)}"
             )
 
         full_table_name = (
             table_name if isinstance(table_name, str) else ".".join(table_name)
         )
         validate_object_name(full_table_name)
+        table_name = (
+            parse_table_name(table_name) if isinstance(table_name, str) else table_name
+        )
         pattern = pattern or self._reader._cur_options.get("PATTERN")
         reader_format_type_options, reader_copy_options = get_copy_into_table_options(
             self._reader._cur_options
         )
         format_type_options = format_type_options or reader_format_type_options
         target_columns = target_columns or self._reader._cur_options.get(
             "TARGET_COLUMNS"
@@ -3301,14 +3390,21 @@
         new_quoted_name = quote_name(new)
         if isinstance(existing, str):
             old_name = quote_name(existing)
         elif isinstance(existing, Column):
             if isinstance(existing._expression, Attribute):
                 att = existing._expression
                 old_name = self._plan.expr_to_alias.get(att.expr_id, att.name)
+            elif (
+                isinstance(existing._expression, UnresolvedAttribute)
+                and existing._expression.df_alias
+            ):
+                old_name = self._plan.df_aliased_col_name_to_real_col_name.get(
+                    existing._expression.name, existing._expression.name
+                )
             elif isinstance(existing._expression, NamedExpression):
                 old_name = existing._expression.name
             else:
                 raise ValueError(
                     f"Unable to rename column {existing} because it doesn't exist."
                 )
         else:
@@ -3545,16 +3641,18 @@
     def dtypes(self) -> List[Tuple[str, str]]:
         dtypes = [
             (name, snow_type_to_dtype_str(field.datatype))
             for name, field in zip(self.schema.names, self.schema.fields)
         ]
         return dtypes
 
-    def _with_plan(self, plan):
-        return DataFrame(self._session, plan)
+    def _with_plan(self, plan) -> "DataFrame":
+        df = DataFrame(self._session, plan)
+        df._statement_params = self._statement_params
+        return df
 
     def _convert_cols_to_exprs(
         self,
         calling_method: str,
         *cols: Union[ColumnOrName, Iterable[ColumnOrName]],
     ) -> List[Expression]:
         """Convert a string or a Column, or a list of string and Column objects to expression(s)."""
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_na_functions.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_na_functions.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,13 +1,14 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 import copy
+import sys
 from logging import getLogger
 from typing import Dict, Optional, Union
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.analyzer_utils import quote_name
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import add_api_call, adjust_api_subcalls
@@ -24,17 +25,17 @@
     IntegerType,
     LongType,
 )
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 _logger = getLogger(__name__)
 
 
 def _is_value_type_matching_for_na_function(
     value: LiteralType, datatype: DataType
@@ -379,15 +380,15 @@
     def replace(
         self,
         to_replace: Union[
             LiteralType,
             Iterable[LiteralType],
             Dict[LiteralType, LiteralType],
         ],
-        value: Optional[Iterable[LiteralType]] = None,
+        value: Optional[Union[LiteralType, Iterable[LiteralType]]] = None,
         subset: Optional[Iterable[str]] = None,
     ) -> "snowflake.snowpark.dataframe.DataFrame":
         """
         Returns a new DataFrame that replaces values in the specified columns.
 
         Args:
             to_replace: A scalar value, or a list of values or a ``dict`` that associates
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_reader.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_reader.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Any, Dict, List, Optional, Union
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.analyzer_utils import (
     create_file_format_statement,
     drop_file_format_if_exists_statement,
     infer_schema_statement,
@@ -14,32 +15,33 @@
 from snowflake.snowpark._internal.analyzer.expression import Attribute
 from snowflake.snowpark._internal.analyzer.select_statement import (
     SelectSnowflakePlan,
     SelectStatement,
 )
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import set_api_call_source
-from snowflake.snowpark._internal.type_utils import convert_sf_to_sp_type
+from snowflake.snowpark._internal.type_utils import ColumnOrName, convert_sf_to_sp_type
 from snowflake.snowpark._internal.utils import (
     INFER_SCHEMA_FORMAT_TYPES,
     TempObjectType,
     get_copy_into_table_options,
     random_name_for_temp_object,
 )
+from snowflake.snowpark.column import _to_col_if_str
 from snowflake.snowpark.dataframe import DataFrame
 from snowflake.snowpark.functions import sql_expr
 from snowflake.snowpark.table import Table
 from snowflake.snowpark.types import StructType, VariantType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class DataFrameReader:
     """Provides methods to load data in various supported formats from a Snowflake
     stage to a :class:`DataFrame`. The paths provided to the DataFrameReader must refer
     to Snowflake stages.
@@ -220,32 +222,47 @@
             |</test>            |
             ---------------------
             <BLANKLINE>
 
     Example 10:
         Loading a CSV file with an already existing FILE_FORMAT:
             >>> from snowflake.snowpark.types import StructType, StructField, IntegerType, StringType
-            >>> _ = session.sql("create file format csv_format type=csv skip_header=1 null_if='none';").collect()
+            >>> _ = session.sql("create file format if not exists csv_format type=csv skip_header=1 null_if='none';").collect()
             >>> _ = session.file.put("tests/resources/testCSVspecialFormat.csv", "@mystage", auto_compress=False)
             >>> # Define the schema for the data in the CSV files.
             >>> schema = StructType([StructField("ID", IntegerType()),StructField("USERNAME", StringType()),StructField("FIRSTNAME", StringType()),StructField("LASTNAME", StringType())])
             >>> # Create a DataFrame that is configured to load data from the CSV files in the stage.
             >>> df = session.read.schema(schema).option("format_name", "csv_format").csv("@mystage/testCSVspecialFormat.csv")
             >>> # Load the data into the DataFrame and return an array of rows containing the results.
             >>> df.collect()
             [Row(ID=0, USERNAME='admin', FIRSTNAME=None, LASTNAME=None), Row(ID=1, USERNAME='test_user', FIRSTNAME='test', LASTNAME='user')]
 
+    Example 11:
+        Querying metadata for staged files:
+            >>> from snowflake.snowpark.column import METADATA_FILENAME, METADATA_FILE_ROW_NUMBER
+            >>> df = session.read.with_metadata(METADATA_FILENAME, METADATA_FILE_ROW_NUMBER.as_("ROW NUMBER")).schema(user_schema).csv("@mystage/testCSV.csv")
+            >>> # Load the data into the DataFrame and return an array of rows containing the results.
+            >>> df.show()
+            --------------------------------------------------------
+            |"METADATA$FILENAME"  |"ROW NUMBER"  |"A"  |"B"  |"C"  |
+            --------------------------------------------------------
+            |testCSV.csv          |1             |1    |one  |1.2  |
+            |testCSV.csv          |2             |2    |two  |2.2  |
+            --------------------------------------------------------
+            <BLANKLINE>
+
     """
 
     def __init__(self, session: "snowflake.snowpark.session.Session") -> None:
         self._session = session
         self._user_schema: Optional[StructType] = None
         self._cur_options: dict[str, Any] = {}
         self._file_path: Optional[str] = None
         self._file_type: Optional[str] = None
+        self._metadata_cols: Optional[Iterable[ColumnOrName]] = None
         # Infer schema information
         self._infer_schema = False
         self._infer_schema_transformations: Optional[
             List["snowflake.snowpark.column.Column"]
         ] = None
         self._infer_schema_target_columns: Optional[List[str]] = None
 
@@ -267,14 +284,31 @@
 
         Returns:
             a :class:`DataFrameReader` instance with the specified schema configuration for the data to be read.
         """
         self._user_schema = schema
         return self
 
+    def with_metadata(
+        self, *metadata_cols: Iterable[ColumnOrName]
+    ) -> "DataFrameReader":
+        """Define the metadata columns that need to be selected from stage files.
+
+        Returns:
+            a :class:`DataFrameReader` instance with metadata columns to read.
+
+        See Also:
+            https://docs.snowflake.com/en/user-guide/querying-metadata
+        """
+        self._metadata_cols = [
+            _to_col_if_str(col, "DataFrameReader.with_metadata")
+            for col in metadata_cols
+        ]
+        return self
+
     def csv(self, path: str) -> DataFrame:
         """Specify the path of the CSV file(s) to load.
 
         Args:
             path: The stage location of a CSV file, or a stage location that has CSV files.
 
         Returns:
@@ -282,25 +316,34 @@
         """
         if not self._user_schema:
             raise SnowparkClientExceptionMessages.DF_MUST_PROVIDE_SCHEMA_FOR_READING_FILE()
 
         self._file_path = path
         self._file_type = "csv"
 
+        if self._metadata_cols:
+            metadata_project = [
+                self._session._analyzer.analyze(col._expression, {})
+                for col in self._metadata_cols
+            ]
+        else:
+            metadata_project = []
+
         if self._session.sql_simplifier_enabled:
             df = DataFrame(
                 self._session,
                 SelectStatement(
                     from_=SelectSnowflakePlan(
                         self._session._plan_builder.read_file(
                             path,
                             self._file_type,
                             self._cur_options,
                             self._session.get_fully_qualified_current_schema(),
                             self._user_schema._to_attributes(),
+                            metadata_project=metadata_project,
                         ),
                         analyzer=self._session._analyzer,
                     ),
                     analyzer=self._session._analyzer,
                 ),
             )
         else:
@@ -308,14 +351,15 @@
                 self._session,
                 self._session._plan_builder.read_file(
                     path,
                     self._file_type,
                     self._cur_options,
                     self._session.get_fully_qualified_current_schema(),
                     self._user_schema._to_attributes(),
+                    metadata_project=metadata_project,
                 ),
             )
         df._reader = self
         set_api_call_source(df, "DataFrameReader.csv")
         return df
 
     def json(self, path: str) -> DataFrame:
@@ -485,15 +529,15 @@
                     else:
                         data_type = data_type_parts[0]
                         precision = int(data_type_parts[1].split(",")[0])
                         scale = int(data_type_parts[1].split(",")[1][:-1])
                     new_schema.append(
                         Attribute(
                             name,
-                            convert_sf_to_sp_type(data_type, precision, scale),
+                            convert_sf_to_sp_type(data_type, precision, scale, 0),
                             r[2],
                         )
                     )
                     identifier = f"$1:{name}::{r[1]}"
                     schema_to_cast.append((identifier, r[0]))
                     transformations.append(sql_expr(identifier))
                 schema = new_schema
@@ -505,27 +549,36 @@
             finally:
                 # Clean up the file format we created
                 if drop_tmp_file_format_if_exists_query is not None:
                     self._session._conn.run_query(
                         drop_tmp_file_format_if_exists_query, is_ddl_on_temp_object=True
                     )
 
+        if self._metadata_cols:
+            metadata_project = [
+                self._session._analyzer.analyze(col._expression, {})
+                for col in self._metadata_cols
+            ]
+        else:
+            metadata_project = []
+
         if self._session.sql_simplifier_enabled:
             df = DataFrame(
                 self._session,
                 SelectStatement(
                     from_=SelectSnowflakePlan(
                         self._session._plan_builder.read_file(
                             path,
                             format,
                             self._cur_options,
                             self._session.get_fully_qualified_current_schema(),
                             schema,
                             schema_to_cast=schema_to_cast,
                             transformations=read_file_transformations,
+                            metadata_project=metadata_project,
                         ),
                         analyzer=self._session._analyzer,
                     ),
                     analyzer=self._session._analyzer,
                 ),
             )
         else:
@@ -535,12 +588,13 @@
                     path,
                     format,
                     self._cur_options,
                     self._session.get_fully_qualified_current_schema(),
                     schema,
                     schema_to_cast=schema_to_cast,
                     transformations=read_file_transformations,
+                    metadata_project=metadata_project,
                 ),
             )
         df._reader = self
         set_api_call_source(df, f"DataFrameReader.{format.lower()}")
         return df
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_stat_functions.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_stat_functions.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from functools import reduce
 from typing import Dict, List, Optional, Union
 
 import snowflake.snowpark
 from snowflake.snowpark import Column
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import adjust_api_subcalls
@@ -19,17 +20,17 @@
     count_distinct,
     covar_samp,
 )
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 _MAX_COLUMNS_PER_TABLE = 1000
 
 
 class DataFrameStatFunctions:
     """Provides computed statistical functions for DataFrames.
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/dataframe_writer.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/dataframe_writer.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Dict, List, Literal, Optional, Union, overload
 
 import snowflake.snowpark  # for forward references of type hints
 from snowflake.snowpark._internal.analyzer.snowflake_plan_node import (
     CopyIntoLocationNode,
     SaveMode,
     SnowflakeCreateTable,
@@ -14,29 +15,30 @@
     add_api_call,
     dfw_collect_api_telemetry,
 )
 from snowflake.snowpark._internal.type_utils import ColumnOrSqlExpr
 from snowflake.snowpark._internal.utils import (
     SUPPORTED_TABLE_TYPES,
     normalize_remote_file_or_dir,
+    parse_table_name,
     str_to_enum,
     validate_object_name,
     warning,
 )
 from snowflake.snowpark.async_job import AsyncJob, _AsyncResultType
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.functions import sql_expr
 from snowflake.snowpark.row import Row
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class DataFrameWriter:
     """Provides methods for writing data from a :class:`DataFrame` to supported output destinations.
 
     To use this object:
@@ -162,14 +164,17 @@
         save_mode = (
             str_to_enum(mode.lower(), SaveMode, "'mode'") if mode else self._save_mode
         )
         full_table_name = (
             table_name if isinstance(table_name, str) else ".".join(table_name)
         )
         validate_object_name(full_table_name)
+        table_name = (
+            parse_table_name(table_name) if isinstance(table_name, str) else table_name
+        )
         if column_order is None or column_order.lower() not in ("name", "index"):
             raise ValueError("'column_order' must be either 'name' or 'index'")
         column_names = (
             self._dataframe.columns if column_order.lower() == "name" else None
         )
 
         if create_temp_table:
@@ -192,15 +197,15 @@
             self._dataframe._plan,
             table_type,
         )
         session = self._dataframe._session
         snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
         result = session._conn.execute(
             snowflake_plan,
-            _statement_params=statement_params,
+            _statement_params=statement_params or self._dataframe._statement_params,
             block=block,
             data_type=_AsyncResultType.NO_RESULT,
         )
         return result if not block else None
 
     @overload
     def copy_into_location(
@@ -307,11 +312,12 @@
                 format_type_options=format_type_options,
                 copy_options=copy_options,
                 header=header,
             )
         )
         add_api_call(df, "DataFrameWriter.copy_into_location")
         return df._internal_collect_with_tag(
-            statement_params=statement_params, block=block
+            statement_params=statement_params or self._dataframe._statement_params,
+            block=block,
         )
 
     saveAsTable = save_as_table
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/exceptions.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/exceptions.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/file_operation.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/file_operation.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/files.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/files.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,39 +1,46 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
-"""SnowflakeFile for UDFs in Snowpark."""
+"""
+SnowflakeFile for UDFs and stored procedures in Snowpark.
+
+This class is intended for usage within stored procedures and UDFs and many methods do not work locally.
+"""
 from __future__ import annotations
 
 import array
 import io
+import sys
 from io import RawIOBase
 
 from snowflake.snowpark._internal.utils import private_preview
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 _DEFER_IMPLEMENTATION_ERR_MSG = "SnowflakeFile currently only works in UDF and Stored Procedures. It doesn't work locally yet."
 
 
 class SnowflakeFile(RawIOBase):
     """
     SnowflakeFile provides an interface to operate on files as Python IOBase-like objects in UDFs and stored procedures.
     SnowflakeFile supports most operations supported by Python IOBase objects.
     A SnowflakeFile object can be used as a Python IOBase object.
 
     The constructor of this class is not supposed to be called directly. Call :meth:`~snowflake.snowpark.file.SnowflakeFile.open` to create a SnowflakeFile object.
+
+    This class is intended for usage within UDFs and stored procedures and many methods do not work locally.
     """
 
     def __init__(
         self,
         file_location: str,
         mode: str = "r",
         is_owner_file: bool = False,
@@ -75,76 +82,135 @@
         to provide URLs that may be only accessible by the UDF owner.
 
         is_owner_file is marked for deprecation. For Snowflake release 7.8 and onwards please use require_scoped_url instead.
 
         Args:
             file_location: scoped URL, file URL, or string path for files located in a stage
             mode: A string used to mark the type of an IO stream.
-            is_owner_file: A boolean value, if True, the API is intended to access owner's files and all url/uri are allowed. If False, the API is intended to access files passed into the function by the caller and only scoped url is allowed.
+            is_owner_file: (Deprecated) A boolean value, if True, the API is intended to access owner's files and all URI/URL are allowed. If False, the API is intended to access files passed into the function by the caller and only scoped URL is allowed.
             require_scoped_url: A boolean value, if True, file_location must be a scoped URL. A scoped URL ensures that the caller cannot access the UDF owners files that the caller does not have access to.
         """
         return cls(
             file_location, mode, is_owner_file, require_scoped_url=require_scoped_url
         )
 
     def close(self) -> None:
         """
         In UDF and Stored Procedures, the close func closes the IO Stream included in the SnowflakeFile.
         """
         return
 
     def detach(self) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+
+        See https://docs.python.org/3/library/io.html#io.BufferedIOBase.detach
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def fileno(self) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.fileno
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def flush(self) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def isatty(self) -> None:
+        """
+        Returns false, file streams in stored procedures and UDFs are never interactive in Snowflake.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def read(self, size: int = -1) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.RawIOBase.read
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def read1(self, size: int = -1) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.BufferedIOBase.read1
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readline(self, size: int = -1) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.readline
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readable(self) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.readable
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readall(self) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.RawIOBase.readall
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readinto(self, b: bytes | bytearray | array.array) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.readinto
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readinto1(self, b: bytes | bytearray | array.array) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.BufferedIOBase.readinto1
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def readlines(self, hint: int = -1) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.readlines
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def seek(self, offset: int, whence: int = io.SEEK_SET) -> int:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.seek
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def seekable(self) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.seekable
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def tell(self) -> None:
+        """
+        See https://docs.python.org/3/library/io.html#io.IOBase.tell
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def truncate(self, size: int | None = None) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def write(self, b: bytes | bytearray | array.array) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def writable(self) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
 
     def writelines(self, lines: Iterable[str] | list[str]) -> None:
+        """
+        Not yet supported in UDF and Stored Procedures.
+        """
         raise NotImplementedError(_DEFER_IMPLEMENTATION_ERR_MSG)
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/functions.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/functions.py`

 * *Files 1% similar despite different names*

```diff
@@ -436,15964 +436,16390 @@
 00001b30: 7c4c 6573 7320 7468 616e 2032 2020 2020  |Less than 2    
 00001b40: 2020 207c 0a20 2020 207c 4772 6561 7465     |.    |Greate
 00001b50: 7220 7468 616e 2032 2020 2020 7c0a 2020  r than 2    |.  
 00001b60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
 00001b70: 2d2d 2d2d 2d2d 0a20 2020 203c 424c 414e  ------.    <BLAN
 00001b80: 4b4c 494e 453e 0a22 2222 0a69 6d70 6f72  KLINE>.""".impor
 00001b90: 7420 6675 6e63 746f 6f6c 730a 696d 706f  t functools.impo
-00001ba0: 7274 2074 7970 696e 670a 6672 6f6d 2072  rt typing.from r
-00001bb0: 616e 646f 6d20 696d 706f 7274 2072 616e  andom import ran
-00001bc0: 6469 6e74 0a66 726f 6d20 7479 7065 7320  dint.from types 
-00001bd0: 696d 706f 7274 204d 6f64 756c 6554 7970  import ModuleTyp
-00001be0: 650a 6672 6f6d 2074 7970 696e 6720 696d  e.from typing im
-00001bf0: 706f 7274 2043 616c 6c61 626c 652c 2044  port Callable, D
-00001c00: 6963 742c 204c 6973 742c 204f 7074 696f  ict, List, Optio
-00001c10: 6e61 6c2c 2054 7570 6c65 2c20 556e 696f  nal, Tuple, Unio
-00001c20: 6e2c 206f 7665 726c 6f61 640a 0a69 6d70  n, overload..imp
-00001c30: 6f72 7420 736e 6f77 666c 616b 652e 736e  ort snowflake.sn
-00001c40: 6f77 7061 726b 0a69 6d70 6f72 7420 736e  owpark.import sn
-00001c50: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00001c60: 2e74 6162 6c65 5f66 756e 6374 696f 6e0a  .table_function.
-00001c70: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00001c80: 6e6f 7770 6172 6b2e 5f69 6e74 6572 6e61  nowpark._interna
-00001c90: 6c2e 616e 616c 797a 6572 2e65 7870 7265  l.analyzer.expre
-00001ca0: 7373 696f 6e20 696d 706f 7274 2028 0a20  ssion import (. 
-00001cb0: 2020 2043 6173 6557 6865 6e2c 0a20 2020     CaseWhen,.   
-00001cc0: 2046 756e 6374 696f 6e45 7870 7265 7373   FunctionExpress
-00001cd0: 696f 6e2c 0a20 2020 204c 6973 7441 6767  ion,.    ListAgg
-00001ce0: 2c0a 2020 2020 4c69 7465 7261 6c2c 0a20  ,.    Literal,. 
-00001cf0: 2020 204d 756c 7469 706c 6545 7870 7265     MultipleExpre
-00001d00: 7373 696f 6e2c 0a20 2020 2053 7461 722c  ssion,.    Star,
-00001d10: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001d20: 652e 736e 6f77 7061 726b 2e5f 696e 7465  e.snowpark._inte
-00001d30: 726e 616c 2e61 6e61 6c79 7a65 722e 756e  rnal.analyzer.un
-00001d40: 6172 795f 6578 7072 6573 7369 6f6e 2069  ary_expression i
-00001d50: 6d70 6f72 7420 416c 6961 730a 6672 6f6d  mport Alias.from
-00001d60: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00001d70: 6172 6b2e 5f69 6e74 6572 6e61 6c2e 616e  ark._internal.an
-00001d80: 616c 797a 6572 2e77 696e 646f 775f 6578  alyzer.window_ex
-00001d90: 7072 6573 7369 6f6e 2069 6d70 6f72 7420  pression import 
-00001da0: 280a 2020 2020 4669 7273 7456 616c 7565  (.    FirstValue
-00001db0: 2c0a 2020 2020 4c61 672c 0a20 2020 204c  ,.    Lag,.    L
-00001dc0: 6173 7456 616c 7565 2c0a 2020 2020 4c65  astValue,.    Le
-00001dd0: 6164 2c0a 290a 6672 6f6d 2073 6e6f 7766  ad,.).from snowf
-00001de0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5f69  lake.snowpark._i
-00001df0: 6e74 6572 6e61 6c2e 7479 7065 5f75 7469  nternal.type_uti
-00001e00: 6c73 2069 6d70 6f72 7420 280a 2020 2020  ls import (.    
-00001e10: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c2c  ColumnOrLiteral,
-00001e20: 0a20 2020 2043 6f6c 756d 6e4f 724c 6974  .    ColumnOrLit
-00001e30: 6572 616c 5374 722c 0a20 2020 2043 6f6c  eralStr,.    Col
-00001e40: 756d 6e4f 724e 616d 652c 0a20 2020 2043  umnOrName,.    C
-00001e50: 6f6c 756d 6e4f 7253 716c 4578 7072 2c0a  olumnOrSqlExpr,.
-00001e60: 2020 2020 4c69 7465 7261 6c54 7970 652c      LiteralType,
-00001e70: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001e80: 652e 736e 6f77 7061 726b 2e5f 696e 7465  e.snowpark._inte
-00001e90: 726e 616c 2e75 7469 6c73 2069 6d70 6f72  rnal.utils impor
-00001ea0: 7420 280a 2020 2020 7061 7273 655f 706f  t (.    parse_po
-00001eb0: 7369 7469 6f6e 616c 5f61 7267 735f 746f  sitional_args_to
-00001ec0: 5f6c 6973 742c 0a20 2020 2076 616c 6964  _list,.    valid
-00001ed0: 6174 655f 6f62 6a65 6374 5f6e 616d 652c  ate_object_name,
-00001ee0: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001ef0: 652e 736e 6f77 7061 726b 2e63 6f6c 756d  e.snowpark.colum
-00001f00: 6e20 696d 706f 7274 2028 0a20 2020 2043  n import (.    C
-00001f10: 6173 6545 7870 722c 0a20 2020 2043 6f6c  aseExpr,.    Col
-00001f20: 756d 6e2c 0a20 2020 205f 746f 5f63 6f6c  umn,.    _to_col
-00001f30: 5f69 665f 6c69 742c 0a20 2020 205f 746f  _if_lit,.    _to
-00001f40: 5f63 6f6c 5f69 665f 7371 6c5f 6578 7072  _col_if_sql_expr
-00001f50: 2c0a 2020 2020 5f74 6f5f 636f 6c5f 6966  ,.    _to_col_if
-00001f60: 5f73 7472 2c0a 2020 2020 5f74 6f5f 636f  _str,.    _to_co
-00001f70: 6c5f 6966 5f73 7472 5f6f 725f 696e 742c  l_if_str_or_int,
-00001f80: 0a29 0a66 726f 6d20 736e 6f77 666c 616b  .).from snowflak
-00001f90: 652e 736e 6f77 7061 726b 2e73 746f 7265  e.snowpark.store
-00001fa0: 645f 7072 6f63 6564 7572 6520 696d 706f  d_procedure impo
-00001fb0: 7274 2053 746f 7265 6450 726f 6365 6475  rt StoredProcedu
-00001fc0: 7265 0a66 726f 6d20 736e 6f77 666c 616b  re.from snowflak
-00001fd0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00001fe0: 2069 6d70 6f72 7420 4461 7461 5479 7065   import DataType
-00001ff0: 2c20 466c 6f61 7454 7970 652c 2053 7472  , FloatType, Str
-00002000: 696e 6754 7970 652c 2053 7472 7563 7454  ingType, StructT
-00002010: 7970 650a 6672 6f6d 2073 6e6f 7766 6c61  ype.from snowfla
-00002020: 6b65 2e73 6e6f 7770 6172 6b2e 7564 6620  ke.snowpark.udf 
-00002030: 696d 706f 7274 2055 7365 7244 6566 696e  import UserDefin
-00002040: 6564 4675 6e63 7469 6f6e 0a66 726f 6d20  edFunction.from 
-00002050: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00002060: 726b 2e75 6474 6620 696d 706f 7274 2055  rk.udtf import U
-00002070: 7365 7244 6566 696e 6564 5461 626c 6546  serDefinedTableF
-00002080: 756e 6374 696f 6e0a 0a23 2050 7974 686f  unction..# Pytho
-00002090: 6e20 332e 3820 6e65 6564 7320 746f 2075  n 3.8 needs to u
-000020a0: 7365 2074 7970 696e 672e 4974 6572 6162  se typing.Iterab
-000020b0: 6c65 2062 6563 6175 7365 2063 6f6c 6c65  le because colle
-000020c0: 6374 696f 6e73 2e61 6263 2e49 7465 7261  ctions.abc.Itera
-000020d0: 626c 6520 6973 206e 6f74 2073 7562 7363  ble is not subsc
-000020e0: 7269 7074 6162 6c65 0a23 2050 7974 686f  riptable.# Pytho
-000020f0: 6e20 332e 3920 6361 6e20 7573 6520 626f  n 3.9 can use bo
-00002100: 7468 0a23 2050 7974 686f 6e20 332e 3130  th.# Python 3.10
-00002110: 206e 6565 6473 2074 6f20 7573 6520 636f   needs to use co
-00002120: 6c6c 6563 7469 6f6e 732e 6162 632e 4974  llections.abc.It
-00002130: 6572 6162 6c65 2062 6563 6175 7365 2074  erable because t
-00002140: 7970 696e 672e 4974 6572 6162 6c65 2069  yping.Iterable i
-00002150: 7320 7265 6d6f 7665 640a 7472 793a 0a20  s removed.try:. 
-00002160: 2020 2066 726f 6d20 7479 7069 6e67 2069     from typing i
-00002170: 6d70 6f72 7420 4974 6572 6162 6c65 0a65  mport Iterable.e
-00002180: 7863 6570 7420 496d 706f 7274 4572 726f  xcept ImportErro
-00002190: 723a 0a20 2020 2066 726f 6d20 636f 6c6c  r:.    from coll
-000021a0: 6563 7469 6f6e 732e 6162 6320 696d 706f  ections.abc impo
-000021b0: 7274 2049 7465 7261 626c 650a 0a0a 6465  rt Iterable...de
-000021c0: 6620 636f 6c28 636f 6c5f 6e61 6d65 3a20  f col(col_name: 
-000021d0: 7374 7229 202d 3e20 436f 6c75 6d6e 3a0a  str) -> Column:.
-000021e0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-000021f0: 6865 203a 636c 6173 733a 607e 736e 6f77  he :class:`~snow
-00002200: 666c 616b 652e 736e 6f77 7061 726b 2e43  flake.snowpark.C
-00002210: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
-00002220: 7370 6563 6966 6965 6420 6e61 6d65 2e0a  specified name..
-00002230: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00002240: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00002250: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-00002260: 6563 7420 3120 6173 2061 2229 0a20 2020  ect 1 as a").   
-00002270: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00002280: 6374 2863 6f6c 2822 6122 2929 2e63 6f6c  ct(col("a")).col
-00002290: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000022a0: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
-000022b0: 220a 2020 2020 7265 7475 726e 2043 6f6c  ".    return Col
-000022c0: 756d 6e28 636f 6c5f 6e61 6d65 290a 0a0a  umn(col_name)...
-000022d0: 6465 6620 636f 6c75 6d6e 2863 6f6c 5f6e  def column(col_n
-000022e0: 616d 653a 2073 7472 2920 2d3e 2043 6f6c  ame: str) -> Col
-000022f0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00002300: 726e 7320 6120 3a63 6c61 7373 3a60 7e73  rns a :class:`~s
-00002310: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00002320: 6b2e 436f 6c75 6d6e 6020 7769 7468 2074  k.Column` with t
-00002330: 6865 2073 7065 6369 6669 6564 206e 616d  he specified nam
-00002340: 652e 2041 6c69 6173 2066 6f72 2063 6f6c  e. Alias for col
-00002350: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00002360: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00002370: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-00002380: 656c 6563 7420 3120 6173 2061 2229 0a20  elect 1 as a"). 
-00002390: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-000023a0: 6c65 6374 2863 6f6c 756d 6e28 2261 2229  lect(column("a")
-000023b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-000023c0: 2020 2020 5b52 6f77 2841 3d31 295d 0a20      [Row(A=1)]. 
-000023d0: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-000023e0: 6e20 436f 6c75 6d6e 2863 6f6c 5f6e 616d  n Column(col_nam
-000023f0: 6529 0a0a 0a64 6566 206c 6974 286c 6974  e)...def lit(lit
-00002400: 6572 616c 3a20 4c69 7465 7261 6c54 7970  eral: LiteralTyp
-00002410: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00002420: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-00002430: 7320 6120 3a63 6c61 7373 3a60 7e73 6e6f  s a :class:`~sno
-00002440: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00002450: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
-00002460: 6f6e 2066 6f72 2061 206c 6974 6572 616c  on for a literal
-00002470: 2076 616c 7565 2e0a 2020 2020 4974 2073   value..    It s
-00002480: 7570 706f 7274 7320 6261 7369 6320 5079  upports basic Py
-00002490: 7468 6f6e 2064 6174 6120 7479 7065 732c  thon data types,
-000024a0: 2069 6e63 6c75 6469 6e67 2060 6069 6e74   including ``int
-000024b0: 6060 2c20 6060 666c 6f61 7460 602c 2060  ``, ``float``, `
-000024c0: 6073 7472 6060 2c0a 2020 2020 6060 626f  `str``,.    ``bo
-000024d0: 6f6c 6060 2c20 6060 6279 7465 7360 602c  ol``, ``bytes``,
-000024e0: 2060 6062 7974 6561 7272 6179 6060 2c20   ``bytearray``, 
-000024f0: 6060 6461 7465 7469 6d65 2e74 696d 6560  ``datetime.time`
-00002500: 602c 2060 6064 6174 6574 696d 652e 6461  `, ``datetime.da
-00002510: 7465 6060 2c0a 2020 2020 6060 6461 7465  te``,.    ``date
-00002520: 7469 6d65 2e64 6174 6574 696d 6560 6020  time.datetime`` 
-00002530: 616e 6420 6060 6465 6369 6d61 6c2e 4465  and ``decimal.De
-00002540: 6369 6d61 6c60 602e 2041 6c73 6f2c 2069  cimal``. Also, i
-00002550: 7420 7375 7070 6f72 7473 2050 7974 686f  t supports Pytho
-00002560: 6e20 7374 7275 6374 7572 6564 2064 6174  n structured dat
-00002570: 6120 7479 7065 732c 0a20 2020 2069 6e63  a types,.    inc
-00002580: 6c75 6469 6e67 2060 606c 6973 7460 602c  luding ``list``,
-00002590: 2060 6074 7570 6c65 6060 2061 6e64 2060   ``tuple`` and `
-000025a0: 6064 6963 7460 602c 2062 7574 2074 6869  `dict``, but thi
-000025b0: 7320 636f 6e74 6169 6e65 7220 6d75 7374  s container must
-000025c0: 0a20 2020 2062 6520 4a53 4f4e 2073 6572  .    be JSON ser
-000025d0: 6961 6c69 7a61 626c 652e 0a0a 2020 2020  ializable...    
-000025e0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000025f0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00002600: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-00002610: 3e3e 2063 6f6c 756d 6e73 203d 205b 6c69  >> columns = [li
-00002620: 7428 3129 2c20 6c69 7428 2231 2229 2c20  t(1), lit("1"), 
-00002630: 6c69 7428 312e 3029 2c20 6c69 7428 5472  lit(1.0), lit(Tr
-00002640: 7565 292c 206c 6974 2862 2773 6e6f 7727  ue), lit(b'snow'
-00002650: 292c 206c 6974 2864 6174 6574 696d 652e  ), lit(datetime.
-00002660: 6461 7465 2832 3032 332c 2032 2c20 3229  date(2023, 2, 2)
-00002670: 292c 206c 6974 285b 312c 2032 5d29 2c20  ), lit([1, 2]), 
-00002680: 6c69 7428 7b22 736e 6f77 223a 2022 666c  lit({"snow": "fl
-00002690: 616b 6522 7d29 5d0a 2020 2020 2020 2020  ake"})].        
-000026a0: 3e3e 3e20 7365 7373 696f 6e2e 6372 6561  >>> session.crea
-000026b0: 7465 5f64 6174 6166 7261 6d65 285b 5b5d  te_dataframe([[]
-000026c0: 5d29 2e73 656c 6563 7428 5b63 2e61 735f  ]).select([c.as_
-000026d0: 2873 7472 2869 2929 2066 6f72 2069 2c20  (str(i)) for i, 
-000026e0: 6320 696e 2065 6e75 6d65 7261 7465 2863  c in enumerate(c
-000026f0: 6f6c 756d 6e73 295d 292e 7368 6f77 2829  olumns)]).show()
-00002700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00002710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002760: 0a20 2020 2020 2020 207c 2230 2220 207c  .        |"0"  |
-00002770: 2231 2220 207c 2232 2220 207c 2233 2220  "1"  |"2"  |"3" 
-00002780: 2020 7c22 3422 2020 2020 2020 2020 2020    |"4"          
-00002790: 2020 2020 2020 207c 2235 2220 2020 2020         |"5"     
-000027a0: 2020 2020 7c22 3622 2020 207c 2237 2220      |"6"   |"7" 
-000027b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000027c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000027d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000027e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000027f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002820: 0a20 2020 2020 2020 207c 3120 2020 207c  .        |1    |
-00002830: 3120 2020 207c 312e 3020 207c 5472 7565  1    |1.0  |True
-00002840: 2020 7c62 7974 6561 7272 6179 2862 2773    |bytearray(b's
-00002850: 6e6f 7727 2920 207c 3230 3233 2d30 322d  now')  |2023-02-
-00002860: 3032 2020 7c5b 2020 2020 207c 7b20 2020  02  |[     |{   
-00002870: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00002880: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-00002890: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
-000028a0: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
-000028b0: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-000028c0: 2020 2020 7c20 2031 2c20 207c 2020 2273      |  1,  |  "s
-000028d0: 6e6f 7722 3a20 2266 6c61 6b65 2220 207c  now": "flake"  |
-000028e0: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-000028f0: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
-00002900: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
-00002910: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-00002920: 2020 2020 7c20 2032 2020 207c 7d20 2020      |  2   |}   
-00002930: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00002940: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
-00002950: 2020 2020 207c 2020 2020 207c 2020 2020       |     |    
-00002960: 2020 7c20 2020 2020 2020 2020 2020 2020    |             
-00002970: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-00002980: 2020 2020 7c5d 2020 2020 207c 2020 2020      |]     |    
-00002990: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000029a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000029b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002a00: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00002a10: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00002a20: 2072 6574 7572 6e20 6c69 7465 7261 6c20   return literal 
-00002a30: 6966 2069 7369 6e73 7461 6e63 6528 6c69  if isinstance(li
-00002a40: 7465 7261 6c2c 2043 6f6c 756d 6e29 2065  teral, Column) e
-00002a50: 6c73 6520 436f 6c75 6d6e 284c 6974 6572  lse Column(Liter
-00002a60: 616c 286c 6974 6572 616c 2929 0a0a 0a64  al(literal))...d
-00002a70: 6566 2073 716c 5f65 7870 7228 7371 6c3a  ef sql_expr(sql:
-00002a80: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
-00002a90: 0a20 2020 2022 2222 4372 6561 7465 7320  .    """Creates 
-00002aa0: 6120 3a63 6c61 7373 3a60 7e73 6e6f 7766  a :class:`~snowf
-00002ab0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 436f  lake.snowpark.Co
-00002ac0: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
-00002ad0: 2066 726f 6d20 7261 7720 5351 4c20 7465   from raw SQL te
-00002ae0: 7874 2e0a 2020 2020 4e6f 7465 2074 6861  xt..    Note tha
-00002af0: 7420 7468 6520 6675 6e63 7469 6f6e 2064  t the function d
-00002b00: 6f65 7320 6e6f 7420 696e 7465 7270 7265  oes not interpre
-00002b10: 7420 6f72 2063 6865 636b 2074 6865 2053  t or check the S
-00002b20: 514c 2074 6578 742e 0a0a 2020 2020 4578  QL text...    Ex
-00002b30: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00002b40: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00002b50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00002b60: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
-00002b70: 5d5d 2c20 7363 6865 6d61 3d5b 2241 222c  ]], schema=["A",
-00002b80: 2022 4222 5d29 0a20 2020 2020 2020 203e   "B"]).        >
-00002b90: 3e3e 2064 662e 6669 6c74 6572 2822 6120  >> df.filter("a 
-00002ba0: 3e20 3122 292e 636f 6c6c 6563 7428 2920  > 1").collect() 
-00002bb0: 2023 2075 7365 2053 514c 2065 7870 7265   # use SQL expre
-00002bc0: 7373 696f 6e0a 2020 2020 2020 2020 5b52  ssion.        [R
-00002bd0: 6f77 2841 3d33 2c20 423d 3429 5d0a 2020  ow(A=3, B=4)].  
-00002be0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00002bf0: 2043 6f6c 756d 6e2e 5f65 7870 7228 7371   Column._expr(sq
-00002c00: 6c29 0a0a 0a64 6566 2063 7572 7265 6e74  l)...def current
-00002c10: 5f73 6573 7369 6f6e 2829 202d 3e20 436f  _session() -> Co
-00002c20: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00002c30: 2020 5265 7475 726e 7320 6120 756e 6971    Returns a uniq
-00002c40: 7565 2073 7973 7465 6d20 6964 656e 7469  ue system identi
-00002c50: 6669 6572 2066 6f72 2074 6865 2053 6e6f  fier for the Sno
-00002c60: 7766 6c61 6b65 2073 6573 7369 6f6e 2063  wflake session c
-00002c70: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00002c80: 7468 6520 7072 6573 656e 7420 636f 6e6e  the present conn
-00002c90: 6563 7469 6f6e 2e0a 2020 2020 5468 6973  ection..    This
-00002ca0: 2077 696c 6c20 6765 6e65 7261 6c6c 7920   will generally 
-00002cb0: 6265 2061 2073 7973 7465 6d2d 6765 6e65  be a system-gene
-00002cc0: 7261 7465 6420 616c 7068 616e 756d 6572  rated alphanumer
-00002cd0: 6963 2073 7472 696e 672e 2049 7420 6973  ic string. It is
-00002ce0: 204e 4f54 2064 6572 6976 6564 2066 726f   NOT derived fro
-00002cf0: 6d20 7468 6520 7573 6572 206e 616d 6520  m the user name 
-00002d00: 6f72 2075 7365 7220 6163 636f 756e 742e  or user account.
-00002d10: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
-00002d20: 2020 2020 2020 203e 3e3e 2023 2052 6574         >>> # Ret
-00002d30: 7572 6e20 7265 7375 6c74 2069 7320 7469  urn result is ti
-00002d40: 6564 2074 6f20 7365 7373 696f 6e2c 2073  ed to session, s
-00002d50: 6f20 7765 206f 6e6c 7920 7465 7374 2069  o we only test i
-00002d60: 6620 7468 6520 7265 7375 6c74 2065 7869  f the result exi
-00002d70: 7374 730a 2020 2020 2020 2020 3e3e 3e20  sts.        >>> 
-00002d80: 7265 7375 6c74 203d 2073 6573 7369 6f6e  result = session
-00002d90: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00002da0: 6528 5b31 5d29 2e73 656c 6563 7428 6375  e([1]).select(cu
-00002db0: 7272 656e 745f 7365 7373 696f 6e28 2929  rrent_session())
-00002dc0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00002dd0: 2020 203e 3e3e 2061 7373 6572 7420 7265     >>> assert re
-00002de0: 7375 6c74 5b30 5d5b 2743 5552 5245 4e54  sult[0]['CURRENT
-00002df0: 5f53 4553 5349 4f4e 2829 275d 2069 7320  _SESSION()'] is 
-00002e00: 6e6f 7420 4e6f 6e65 0a20 2020 2022 2222  not None.    """
-00002e10: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00002e20: 7469 6e28 2263 7572 7265 6e74 5f73 6573  tin("current_ses
-00002e30: 7369 6f6e 2229 2829 0a0a 0a64 6566 2063  sion")()...def c
-00002e40: 7572 7265 6e74 5f73 7461 7465 6d65 6e74  urrent_statement
-00002e50: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00002e60: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-00002e70: 7320 7468 6520 5351 4c20 7465 7874 206f  s the SQL text o
-00002e80: 6620 7468 6520 7374 6174 656d 656e 7420  f the statement 
-00002e90: 7468 6174 2069 7320 6375 7272 656e 746c  that is currentl
-00002ea0: 7920 6578 6563 7574 696e 672e 0a0a 2020  y executing...  
-00002eb0: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00002ec0: 2020 203e 3e3e 2023 2052 6574 7572 6e20     >>> # Return 
-00002ed0: 7265 7375 6c74 2069 7320 7469 6564 2074  result is tied t
-00002ee0: 6f20 7365 7373 696f 6e2c 2073 6f20 7765  o session, so we
-00002ef0: 206f 6e6c 7920 7465 7374 2069 6620 7468   only test if th
-00002f00: 6520 7265 7375 6c74 2065 7869 7374 730a  e result exists.
-00002f10: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
-00002f20: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00002f30: 7261 6d65 285b 315d 292e 7365 6c65 6374  rame([1]).select
-00002f40: 2863 7572 7265 6e74 5f73 7461 7465 6d65  (current_stateme
-00002f50: 6e74 2829 292e 636f 6c6c 6563 7428 290a  nt()).collect().
-00002f60: 2020 2020 2020 2020 5b52 6f77 2843 5552          [Row(CUR
-00002f70: 5245 4e54 5f53 5441 5445 4d45 4e54 2829  RENT_STATEMENT()
-00002f80: 3d27 5345 4c45 4354 2063 7572 7265 6e74  ='SELECT current
-00002f90: 5f73 7461 7465 6d65 6e74 2829 2046 524f  _statement() FRO
-00002fa0: 4d20 2820 5345 4c45 4354 2022 5f31 2220  M ( SELECT "_1" 
-00002fb0: 4652 4f4d 2028 2053 454c 4543 5420 2431  FROM ( SELECT $1
-00002fc0: 2041 5320 225f 3122 2046 524f 4d20 2056   AS "_1" FROM  V
-00002fd0: 414c 5545 5320 2831 203a 3a20 494e 5429  ALUES (1 :: INT)
-00002fe0: 2929 2729 5d0a 2020 2020 2222 220a 2020  ))')].    """.  
-00002ff0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00003000: 2822 6375 7272 656e 745f 7374 6174 656d  ("current_statem
-00003010: 656e 7422 2928 290a 0a0a 6465 6620 6375  ent")()...def cu
-00003020: 7272 656e 745f 7573 6572 2829 202d 3e20  rrent_user() -> 
-00003030: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00003040: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-00003050: 6e61 6d65 206f 6620 7468 6520 7573 6572  name of the user
-00003060: 2063 7572 7265 6e74 6c79 206c 6f67 6765   currently logge
-00003070: 6420 696e 746f 2074 6865 2073 7973 7465  d into the syste
-00003080: 6d2e 0a0a 2020 2020 4578 616d 706c 653a  m...    Example:
-00003090: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-000030a0: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-000030b0: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-000030c0: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-000030d0: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-000030e0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-000030f0: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
-00003100: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00003110: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
-00003120: 6375 7272 656e 745f 7573 6572 2829 292e  current_user()).
-00003130: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00003140: 2020 3e3e 3e20 6173 7365 7274 2072 6573    >>> assert res
-00003150: 756c 745b 305d 5b27 4355 5252 454e 545f  ult[0]['CURRENT_
-00003160: 5553 4552 2829 275d 2069 7320 6e6f 7420  USER()'] is not 
-00003170: 4e6f 6e65 0a20 2020 2022 2222 0a20 2020  None.    """.   
-00003180: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00003190: 2263 7572 7265 6e74 5f75 7365 7222 2928  "current_user")(
-000031a0: 290a 0a0a 6465 6620 6375 7272 656e 745f  )...def current_
-000031b0: 7665 7273 696f 6e28 2920 2d3e 2043 6f6c  version() -> Col
-000031c0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-000031d0: 2052 6574 7572 6e73 2074 6865 2063 7572   Returns the cur
-000031e0: 7265 6e74 2053 6e6f 7766 6c61 6b65 2076  rent Snowflake v
-000031f0: 6572 7369 6f6e 2e0a 0a20 2020 2045 7861  ersion...    Exa
-00003200: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00003210: 3e20 2320 5265 7475 726e 2072 6573 756c  > # Return resul
-00003220: 7420 6973 2074 6965 6420 746f 2073 6573  t is tied to ses
-00003230: 7369 6f6e 2c20 736f 2077 6520 6f6e 6c79  sion, so we only
-00003240: 2074 6573 7420 6966 2074 6865 2072 6573   test if the res
-00003250: 756c 7420 6578 6973 7473 0a20 2020 2020  ult exists.     
-00003260: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
-00003270: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00003280: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
-00003290: 6c65 6374 2863 7572 7265 6e74 5f76 6572  lect(current_ver
-000032a0: 7369 6f6e 2829 292e 636f 6c6c 6563 7428  sion()).collect(
-000032b0: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
-000032c0: 7365 7274 2072 6573 756c 745b 305d 5b27  sert result[0]['
-000032d0: 4355 5252 454e 545f 5645 5253 494f 4e28  CURRENT_VERSION(
-000032e0: 2927 5d20 6973 206e 6f74 204e 6f6e 650a  )'] is not None.
-000032f0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
-00003300: 726e 2062 7569 6c74 696e 2822 6375 7272  rn builtin("curr
-00003310: 656e 745f 7665 7273 696f 6e22 2928 290a  ent_version")().
-00003320: 0a0a 6465 6620 6375 7272 656e 745f 7761  ..def current_wa
-00003330: 7265 686f 7573 6528 2920 2d3e 2043 6f6c  rehouse() -> Col
-00003340: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00003350: 2052 6574 7572 6e73 2074 6865 206e 616d   Returns the nam
-00003360: 6520 6f66 2074 6865 2077 6172 6568 6f75  e of the warehou
-00003370: 7365 2069 6e20 7573 6520 666f 7220 7468  se in use for th
-00003380: 6520 6375 7272 656e 7420 7365 7373 696f  e current sessio
-00003390: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
-000033a0: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-000033b0: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-000033c0: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-000033d0: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-000033e0: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-000033f0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-00003400: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
-00003410: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00003420: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
-00003430: 6375 7272 656e 745f 7761 7265 686f 7573  current_warehous
-00003440: 6528 2929 2e63 6f6c 6c65 6374 2829 0a20  e()).collect(). 
-00003450: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
-00003460: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
-00003470: 5245 4e54 5f57 4152 4548 4f55 5345 2829  RENT_WAREHOUSE()
-00003480: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
-00003490: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-000034a0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
-000034b0: 6e74 5f77 6172 6568 6f75 7365 2229 2829  nt_warehouse")()
-000034c0: 0a0a 0a64 6566 2063 7572 7265 6e74 5f64  ...def current_d
-000034d0: 6174 6162 6173 6528 2920 2d3e 2043 6f6c  atabase() -> Col
-000034e0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000034f0: 726e 7320 7468 6520 6e61 6d65 206f 6620  rns the name of 
-00003500: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
-00003510: 7573 6520 666f 7220 7468 6520 6375 7272  use for the curr
-00003520: 656e 7420 7365 7373 696f 6e2e 0a0a 2020  ent session...  
-00003530: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00003540: 2020 203e 3e3e 2023 2052 6574 7572 6e20     >>> # Return 
-00003550: 7265 7375 6c74 2069 7320 7469 6564 2074  result is tied t
-00003560: 6f20 7365 7373 696f 6e2c 2073 6f20 7765  o session, so we
-00003570: 206f 6e6c 7920 7465 7374 2069 6620 7468   only test if th
-00003580: 6520 7265 7375 6c74 2065 7869 7374 730a  e result exists.
-00003590: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
-000035a0: 6c74 203d 2073 6573 7369 6f6e 2e63 7265  lt = session.cre
-000035b0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-000035c0: 5d29 2e73 656c 6563 7428 6375 7272 656e  ]).select(curren
-000035d0: 745f 6461 7461 6261 7365 2829 292e 636f  t_database()).co
-000035e0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000035f0: 3e3e 3e20 6173 7365 7274 2072 6573 756c  >>> assert resul
-00003600: 745b 305d 5b27 4355 5252 454e 545f 4441  t[0]['CURRENT_DA
-00003610: 5441 4241 5345 2829 275d 2069 7320 6e6f  TABASE()'] is no
-00003620: 7420 4e6f 6e65 0a20 2020 2022 2222 0a20  t None.    """. 
-00003630: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00003640: 6e28 2263 7572 7265 6e74 5f64 6174 6162  n("current_datab
-00003650: 6173 6522 2928 290a 0a0a 6465 6620 6375  ase")()...def cu
-00003660: 7272 656e 745f 726f 6c65 2829 202d 3e20  rrent_role() -> 
-00003670: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00003680: 6574 7572 6e73 2074 6865 206e 616d 6520  eturns the name 
-00003690: 6f66 2074 6865 2072 6f6c 6520 696e 2075  of the role in u
-000036a0: 7365 2066 6f72 2074 6865 2063 7572 7265  se for the curre
-000036b0: 6e74 2073 6573 7369 6f6e 2e0a 0a20 2020  nt session...   
-000036c0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-000036d0: 2020 3e3e 3e20 2320 5265 7475 726e 2072    >>> # Return r
-000036e0: 6573 756c 7420 6973 2074 6965 6420 746f  esult is tied to
-000036f0: 2073 6573 7369 6f6e 2c20 736f 2077 6520   session, so we 
-00003700: 6f6e 6c79 2074 6573 7420 6966 2074 6865  only test if the
-00003710: 2072 6573 756c 7420 6578 6973 7473 0a20   result exists. 
-00003720: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-00003730: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
-00003740: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
-00003750: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
-00003760: 5f72 6f6c 6528 2929 2e63 6f6c 6c65 6374  _role()).collect
-00003770: 2829 0a20 2020 2020 2020 203e 3e3e 2061  ().        >>> a
-00003780: 7373 6572 7420 7265 7375 6c74 5b30 5d5b  ssert result[0][
-00003790: 2743 5552 5245 4e54 5f52 4f4c 4528 2927  'CURRENT_ROLE()'
-000037a0: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
-000037b0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-000037c0: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
-000037d0: 745f 726f 6c65 2229 2829 0a0a 0a64 6566  t_role")()...def
-000037e0: 2063 7572 7265 6e74 5f73 6368 656d 6128   current_schema(
-000037f0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00003800: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00003810: 6e61 6d65 206f 6620 7468 6520 7363 6865  name of the sche
-00003820: 6d61 2069 6e20 7573 6520 666f 7220 7468  ma in use for th
-00003830: 6520 6375 7272 656e 7420 7365 7373 696f  e current sessio
-00003840: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
-00003850: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
-00003860: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
-00003870: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
-00003880: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
-00003890: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
-000038a0: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
-000038b0: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
-000038c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000038d0: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
-000038e0: 6375 7272 656e 745f 7363 6865 6d61 2829  current_schema()
-000038f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00003900: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
-00003910: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
-00003920: 545f 5343 4845 4d41 2829 275d 2069 7320  T_SCHEMA()'] is 
-00003930: 6e6f 7420 4e6f 6e65 0a20 2020 2022 2222  not None.    """
-00003940: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00003950: 7469 6e28 2263 7572 7265 6e74 5f73 6368  tin("current_sch
-00003960: 656d 6122 2928 290a 0a0a 6465 6620 6375  ema")()...def cu
-00003970: 7272 656e 745f 7363 6865 6d61 7328 2920  rrent_schemas() 
-00003980: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00003990: 2222 5265 7475 726e 7320 6163 7469 7665  ""Returns active
-000039a0: 2073 6561 7263 6820 7061 7468 2073 6368   search path sch
-000039b0: 656d 6173 2e0a 0a20 2020 2045 7861 6d70  emas...    Examp
-000039c0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-000039d0: 2320 5265 7475 726e 2072 6573 756c 7420  # Return result 
-000039e0: 6973 2074 6965 6420 746f 2073 6573 7369  is tied to sessi
-000039f0: 6f6e 2c20 736f 2077 6520 6f6e 6c79 2074  on, so we only t
-00003a00: 6573 7420 6966 2074 6865 2072 6573 756c  est if the resul
-00003a10: 7420 6578 6973 7473 0a20 2020 2020 2020  t exists.       
-00003a20: 203e 3e3e 2072 6573 756c 7420 3d20 7365   >>> result = se
-00003a30: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00003a40: 6166 7261 6d65 285b 315d 292e 7365 6c65  aframe([1]).sele
-00003a50: 6374 2863 7572 7265 6e74 5f73 6368 656d  ct(current_schem
-00003a60: 6173 2829 292e 636f 6c6c 6563 7428 290a  as()).collect().
-00003a70: 2020 2020 2020 2020 3e3e 3e20 6173 7365          >>> asse
-00003a80: 7274 2072 6573 756c 745b 305d 5b27 4355  rt result[0]['CU
-00003a90: 5252 454e 545f 5343 4845 4d41 5328 2927  RRENT_SCHEMAS()'
-00003aa0: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
-00003ab0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00003ac0: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
-00003ad0: 745f 7363 6865 6d61 7322 2928 290a 0a0a  t_schemas")()...
-00003ae0: 6465 6620 6375 7272 656e 745f 7265 6769  def current_regi
-00003af0: 6f6e 2829 202d 3e20 436f 6c75 6d6e 3a0a  on() -> Column:.
-00003b00: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00003b10: 6865 206e 616d 6520 6f66 2074 6865 2072  he name of the r
-00003b20: 6567 696f 6e20 666f 7220 7468 6520 6163  egion for the ac
-00003b30: 636f 756e 7420 7768 6572 6520 7468 6520  count where the 
-00003b40: 6375 7272 656e 7420 7573 6572 2069 7320  current user is 
-00003b50: 6c6f 6767 6564 2069 6e2e 0a0a 2020 2020  logged in...    
-00003b60: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-00003b70: 203e 3e3e 2023 2052 6574 7572 6e20 7265   >>> # Return re
-00003b80: 7375 6c74 2069 7320 7469 6564 2074 6f20  sult is tied to 
-00003b90: 7365 7373 696f 6e2c 2073 6f20 7765 206f  session, so we o
-00003ba0: 6e6c 7920 7465 7374 2069 6620 7468 6520  nly test if the 
-00003bb0: 7265 7375 6c74 2065 7869 7374 730a 2020  result exists.  
-00003bc0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
-00003bd0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00003be0: 655f 6461 7461 6672 616d 6528 5b31 5d29  e_dataframe([1])
-00003bf0: 2e73 656c 6563 7428 6375 7272 656e 745f  .select(current_
-00003c00: 7265 6769 6f6e 2829 292e 636f 6c6c 6563  region()).collec
-00003c10: 7428 290a 2020 2020 2020 2020 3e3e 3e20  t().        >>> 
-00003c20: 6173 7365 7274 2072 6573 756c 745b 305d  assert result[0]
-00003c30: 5b27 4355 5252 454e 545f 5245 4749 4f4e  ['CURRENT_REGION
-00003c40: 2829 275d 2069 7320 6e6f 7420 4e6f 6e65  ()'] is not None
-00003c50: 0a20 2020 2022 2222 0a20 2020 2072 6574  .    """.    ret
-00003c60: 7572 6e20 6275 696c 7469 6e28 2263 7572  urn builtin("cur
-00003c70: 7265 6e74 5f72 6567 696f 6e22 2928 290a  rent_region")().
-00003c80: 0a0a 6465 6620 6375 7272 656e 745f 6176  ..def current_av
-00003c90: 6169 6c61 626c 655f 726f 6c65 7328 2920  ailable_roles() 
-00003ca0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00003cb0: 2222 5265 7475 726e 7320 6120 4a53 4f4e  ""Returns a JSON
-00003cc0: 2073 7472 696e 6720 7468 6174 206c 6973   string that lis
-00003cd0: 7473 2061 6c6c 2072 6f6c 6573 2067 7261  ts all roles gra
-00003ce0: 6e74 6564 2074 6f20 7468 6520 6375 7272  nted to the curr
-00003cf0: 656e 7420 7573 6572 2e0a 0a20 2020 2045  ent user...    E
-00003d00: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00003d10: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
-00003d20: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
-00003d30: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
-00003d40: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
-00003d50: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
-00003d60: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
-00003d70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00003d80: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
-00003d90: 7365 6c65 6374 2863 7572 7265 6e74 5f61  select(current_a
-00003da0: 7661 696c 6162 6c65 5f72 6f6c 6573 2829  vailable_roles()
-00003db0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00003dc0: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
-00003dd0: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
-00003de0: 545f 4156 4149 4c41 424c 455f 524f 4c45  T_AVAILABLE_ROLE
-00003df0: 5328 2927 5d20 6973 206e 6f74 204e 6f6e  S()'] is not Non
-00003e00: 650a 2020 2020 2222 220a 2020 2020 7265  e.    """.    re
-00003e10: 7475 726e 2062 7569 6c74 696e 2822 6375  turn builtin("cu
-00003e20: 7272 656e 745f 6176 6169 6c61 626c 655f  rrent_available_
-00003e30: 726f 6c65 7322 2928 290a 0a0a 6465 6620  roles")()...def 
-00003e40: 6164 645f 6d6f 6e74 6873 280a 2020 2020  add_months(.    
-00003e50: 6461 7465 5f6f 725f 7469 6d65 7374 616d  date_or_timestam
-00003e60: 703a 2043 6f6c 756d 6e4f 724e 616d 652c  p: ColumnOrName,
-00003e70: 206e 756d 6265 725f 6f66 5f6d 6f6e 7468   number_of_month
-00003e80: 733a 2055 6e69 6f6e 5b43 6f6c 756d 6e2c  s: Union[Column,
-00003e90: 2069 6e74 5d0a 2920 2d3e 2043 6f6c 756d   int].) -> Colum
-00003ea0: 6e3a 0a20 2020 2022 2222 4164 6473 206f  n:.    """Adds o
-00003eb0: 7220 7375 6274 7261 6374 7320 6120 7370  r subtracts a sp
-00003ec0: 6563 6966 6965 6420 6e75 6d62 6572 206f  ecified number o
-00003ed0: 6620 6d6f 6e74 6873 2074 6f20 6120 6461  f months to a da
-00003ee0: 7465 206f 7220 7469 6d65 7374 616d 702c  te or timestamp,
-00003ef0: 2070 7265 7365 7276 696e 6720 7468 6520   preserving the 
-00003f00: 656e 642d 6f66 2d6d 6f6e 7468 2069 6e66  end-of-month inf
-00003f10: 6f72 6d61 7469 6f6e 2e0a 0a20 2020 2045  ormation...    E
-00003f20: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00003f30: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
-00003f40: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
-00003f50: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00003f60: 6174 655f 6461 7461 6672 616d 6528 5b64  ate_dataframe([d
-00003f70: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-00003f80: 322c 2034 2c20 3629 5d2c 2073 6368 656d  2, 4, 6)], schem
-00003f90: 613d 5b22 6422 5d29 0a20 2020 2020 2020  a=["d"]).       
-00003fa0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-00003fb0: 6464 5f6d 6f6e 7468 7328 2264 222c 2034  dd_months("d", 4
-00003fc0: 2929 2e63 6f6c 6c65 6374 2829 5b30 5d5b  )).collect()[0][
-00003fd0: 305d 0a20 2020 2020 2020 2064 6174 6574  0].        datet
-00003fe0: 696d 652e 6461 7465 2832 3032 322c 2038  ime.date(2022, 8
-00003ff0: 2c20 3629 0a20 2020 2022 2222 0a20 2020  , 6).    """.   
-00004000: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00004010: 7374 7228 6461 7465 5f6f 725f 7469 6d65  str(date_or_time
-00004020: 7374 616d 702c 2022 6164 645f 6d6f 6e74  stamp, "add_mont
-00004030: 6873 2229 0a20 2020 2072 6574 7572 6e20  hs").    return 
-00004040: 6275 696c 7469 6e28 2261 6464 5f6d 6f6e  builtin("add_mon
-00004050: 7468 7322 2928 632c 206e 756d 6265 725f  ths")(c, number_
-00004060: 6f66 5f6d 6f6e 7468 7329 0a0a 0a64 6566  of_months)...def
-00004070: 2061 6e79 5f76 616c 7565 2865 3a20 436f   any_value(e: Co
-00004080: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00004090: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-000040a0: 7475 726e 7320 6120 6e6f 6e2d 6465 7465  turns a non-dete
-000040b0: 726d 696e 6973 7469 6320 616e 7920 7661  rministic any va
-000040c0: 6c75 6520 666f 7220 7468 6520 7370 6563  lue for the spec
-000040d0: 6966 6965 6420 636f 6c75 6d6e 2e0a 2020  ified column..  
-000040e0: 2020 5468 6973 2069 7320 616e 2061 6767    This is an agg
-000040f0: 7265 6761 7465 2061 6e64 2077 696e 646f  regate and windo
-00004100: 7720 6675 6e63 7469 6f6e 2e0a 0a20 2020  w function...   
-00004110: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-00004120: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00004130: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00004140: 616d 6528 5b5b 312c 2032 5d2c 205b 332c  ame([[1, 2], [3,
-00004150: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
-00004160: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-00004170: 203e 3e3e 2072 6573 756c 7420 3d20 6466   >>> result = df
-00004180: 2e73 656c 6563 7428 616e 795f 7661 6c75  .select(any_valu
-00004190: 6528 2261 2229 292e 636f 6c6c 6563 7428  e("a")).collect(
-000041a0: 290a 2020 2020 2020 2020 3e3e 3e20 6173  ).        >>> as
-000041b0: 7365 7274 206c 656e 2872 6573 756c 7429  sert len(result)
-000041c0: 203d 3d20 3120 2023 206e 6f6e 2d64 6574   == 1  # non-det
-000041d0: 6572 6d69 6e69 7374 6963 2076 616c 7565  erministic value
-000041e0: 2069 6e20 7265 7375 6c74 2e0a 2020 2020   in result..    
-000041f0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00004200: 636f 6c5f 6966 5f73 7472 2865 2c20 2261  col_if_str(e, "a
-00004210: 6e79 5f76 616c 7565 2229 0a20 2020 2072  ny_value").    r
-00004220: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
-00004230: 696e 2822 616e 795f 7661 6c75 6522 2c20  in("any_value", 
-00004240: 6329 0a0a 0a64 6566 2062 6974 6e6f 7428  c)...def bitnot(
-00004250: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-00004260: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00004270: 2222 2252 6574 7572 6e73 2074 6865 2062  """Returns the b
-00004280: 6974 7769 7365 206e 6567 6174 696f 6e20  itwise negation 
-00004290: 6f66 2061 206e 756d 6572 6963 2065 7870  of a numeric exp
-000042a0: 7265 7373 696f 6e2e 0a0a 2020 2020 4578  ression...    Ex
-000042b0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-000042c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000042d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000042e0: 285b 315d 2c20 7363 6865 6d61 3d5b 2261  ([1], schema=["a
-000042f0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00004300: 6466 2e73 656c 6563 7428 6269 746e 6f74  df.select(bitnot
-00004310: 2822 6122 2929 2e63 6f6c 6c65 6374 2829  ("a")).collect()
-00004320: 5b30 5d5b 305d 0a20 2020 2020 2020 202d  [0][0].        -
-00004330: 320a 2020 2020 2222 220a 2020 2020 6320  2.    """.    c 
-00004340: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00004350: 2865 2c20 2262 6974 6e6f 7422 290a 2020  (e, "bitnot").  
-00004360: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
-00004370: 696c 7469 6e28 2262 6974 6e6f 7422 2c20  iltin("bitnot", 
-00004380: 6329 0a0a 0a64 6566 2062 6974 7368 6966  c)...def bitshif
-00004390: 746c 6566 7428 746f 5f73 6869 6674 5f63  tleft(to_shift_c
-000043a0: 6f6c 756d 6e3a 2043 6f6c 756d 6e4f 724e  olumn: ColumnOrN
-000043b0: 616d 652c 206e 3a20 556e 696f 6e5b 436f  ame, n: Union[Co
-000043c0: 6c75 6d6e 2c20 696e 745d 2920 2d3e 2043  lumn, int]) -> C
-000043d0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-000043e0: 7475 726e 7320 7468 6520 6269 7477 6973  turns the bitwis
-000043f0: 6520 6e65 6761 7469 6f6e 206f 6620 6120  e negation of a 
-00004400: 6e75 6d65 7269 6320 6578 7072 6573 7369  numeric expressi
-00004410: 6f6e 2e0a 0a20 2020 2045 7861 6d70 6c65  on...    Example
-00004420: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-00004430: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00004440: 655f 6461 7461 6672 616d 6528 5b32 5d2c  e_dataframe([2],
-00004450: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00004460: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00004470: 6c65 6374 2862 6974 7368 6966 746c 6566  lect(bitshiftlef
-00004480: 7428 2261 222c 2031 2929 2e63 6f6c 6c65  t("a", 1)).colle
-00004490: 6374 2829 5b30 5d5b 305d 0a20 2020 2020  ct()[0][0].     
-000044a0: 2020 2034 0a20 2020 2022 2222 0a20 2020     4.    """.   
-000044b0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000044c0: 7374 7228 746f 5f73 6869 6674 5f63 6f6c  str(to_shift_col
-000044d0: 756d 6e2c 2022 6269 7473 6869 6674 6c65  umn, "bitshiftle
-000044e0: 6674 2229 0a20 2020 2072 6574 7572 6e20  ft").    return 
-000044f0: 6361 6c6c 5f62 7569 6c74 696e 2822 6269  call_builtin("bi
-00004500: 7473 6869 6674 6c65 6674 222c 2063 2c20  tshiftleft", c, 
-00004510: 6e29 0a0a 0a64 6566 2062 6974 7368 6966  n)...def bitshif
-00004520: 7472 6967 6874 2874 6f5f 7368 6966 745f  tright(to_shift_
-00004530: 636f 6c75 6d6e 3a20 436f 6c75 6d6e 4f72  column: ColumnOr
-00004540: 4e61 6d65 2c20 6e3a 2055 6e69 6f6e 5b43  Name, n: Union[C
-00004550: 6f6c 756d 6e2c 2069 6e74 5d29 202d 3e20  olumn, int]) -> 
-00004560: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00004570: 6574 7572 6e73 2074 6865 2062 6974 7769  eturns the bitwi
-00004580: 7365 206e 6567 6174 696f 6e20 6f66 2061  se negation of a
-00004590: 206e 756d 6572 6963 2065 7870 7265 7373   numeric express
-000045a0: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
-000045b0: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
-000045c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000045d0: 7465 5f64 6174 6166 7261 6d65 285b 325d  te_dataframe([2]
-000045e0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-000045f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00004600: 656c 6563 7428 6269 7473 6869 6674 7269  elect(bitshiftri
-00004610: 6768 7428 2261 222c 2031 2929 2e63 6f6c  ght("a", 1)).col
-00004620: 6c65 6374 2829 5b30 5d5b 305d 0a20 2020  lect()[0][0].   
-00004630: 2020 2020 2031 0a20 2020 2022 2222 0a20       1.    """. 
-00004640: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00004650: 665f 7374 7228 746f 5f73 6869 6674 5f63  f_str(to_shift_c
-00004660: 6f6c 756d 6e2c 2022 6269 7473 6869 6674  olumn, "bitshift
-00004670: 7269 6768 7422 290a 2020 2020 7265 7475  right").    retu
-00004680: 726e 2063 616c 6c5f 6275 696c 7469 6e28  rn call_builtin(
-00004690: 2262 6974 7368 6966 7472 6967 6874 222c  "bitshiftright",
-000046a0: 2063 2c20 6e29 0a0a 0a64 6566 2062 726f   c, n)...def bro
-000046b0: 756e 6428 636f 6c3a 2043 6f6c 756d 6e4f  und(col: ColumnO
-000046c0: 724e 616d 652c 2073 6361 6c65 3a20 556e  rName, scale: Un
-000046d0: 696f 6e5b 436f 6c75 6d6e 2c20 696e 745d  ion[Column, int]
-000046e0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000046f0: 2022 2222 0a20 2020 2052 6f75 6e64 7320   """.    Rounds 
-00004700: 7468 6520 6e75 6d62 6572 2075 7369 6e67  the number using
-00004710: 2060 4841 4c46 5f54 4f5f 4556 454e 6020   `HALF_TO_EVEN` 
-00004720: 6f70 7469 6f6e 2e20 5468 6520 6048 414c  option. The `HAL
-00004730: 465f 544f 5f45 5645 4e60 2072 6f75 6e64  F_TO_EVEN` round
-00004740: 696e 6720 6d6f 6465 2072 6f75 6e64 7320  ing mode rounds 
-00004750: 7468 6520 6769 7665 6e20 6465 6369 6d61  the given decima
-00004760: 6c20 7661 6c75 6520 746f 2074 6865 2073  l value to the s
-00004770: 7065 6369 6669 6564 2073 6361 6c65 2028  pecified scale (
-00004780: 6e75 6d62 6572 206f 6620 6465 6369 6d61  number of decima
-00004790: 6c20 706c 6163 6573 2920 6173 2066 6f6c  l places) as fol
-000047a0: 6c6f 7773 3a0a 2020 2020 2a20 4966 2073  lows:.    * If s
-000047b0: 6361 6c65 2069 7320 6772 6561 7465 7220  cale is greater 
-000047c0: 7468 616e 206f 7220 6571 7561 6c20 746f  than or equal to
-000047d0: 2030 2c20 726f 756e 6420 746f 2074 6865   0, round to the
-000047e0: 2073 7065 6369 6669 6564 206e 756d 6265   specified numbe
-000047f0: 7220 6f66 2064 6563 696d 616c 2070 6c61  r of decimal pla
-00004800: 6365 7320 7573 696e 6720 6861 6c66 2d65  ces using half-e
-00004810: 7665 6e20 726f 756e 6469 6e67 2e20 5468  ven rounding. Th
-00004820: 6973 2072 6f75 6e64 7320 746f 7761 7264  is rounds toward
-00004830: 7320 7468 6520 6e65 6172 6573 7420 7661  s the nearest va
-00004840: 6c75 6520 7769 7468 2074 6965 7320 2865  lue with ties (e
-00004850: 7175 616c 6c79 2063 6c6f 7365 2076 616c  qually close val
-00004860: 7565 7329 2072 6f75 6e64 696e 6720 746f  ues) rounding to
-00004870: 2074 6865 206e 6561 7265 7374 2065 7665   the nearest eve
-00004880: 6e20 6469 6769 742e 0a20 2020 202a 2049  n digit..    * I
-00004890: 6620 7363 616c 6520 6973 206c 6573 7320  f scale is less 
-000048a0: 7468 616e 2030 2c20 726f 756e 6420 746f  than 0, round to
-000048b0: 2074 6865 2069 6e74 6567 7261 6c20 7061   the integral pa
-000048c0: 7274 206f 6620 7468 6520 6465 6369 6d61  rt of the decima
-000048d0: 6c2e 2054 6869 7320 726f 756e 6473 2074  l. This rounds t
-000048e0: 6f77 6172 6473 2030 2061 6e64 2074 7275  owards 0 and tru
-000048f0: 6e63 6174 6573 2074 6865 2064 6563 696d  ncates the decim
-00004900: 616c 2070 6c61 6365 732e 0a0a 2020 2020  al places...    
-00004910: 4e6f 7465 3a0a 0a20 2020 2020 2020 2031  Note:..        1
-00004920: 2e20 5468 6520 6461 7461 2074 7970 6520  . The data type 
-00004930: 6f66 2074 6865 2065 7870 7265 7373 696f  of the expressio
-00004940: 6e20 6d75 7374 2062 6520 6f6e 6520 6f66  n must be one of
-00004950: 2074 6865 2060 6461 7461 2074 7970 6573   the `data types
-00004960: 2066 6f72 2061 2066 6978 6564 2d70 6f69   for a fixed-poi
-00004970: 6e74 206e 756d 6265 720a 2020 2020 2020  nt number.      
-00004980: 2020 3c68 7474 7073 3a2f 2f64 6f63 732e    <https://docs.
-00004990: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
-000049a0: 2f73 716c 2d72 6566 6572 656e 6365 2f64  /sql-reference/d
-000049b0: 6174 612d 7479 7065 732d 6e75 6d65 7269  ata-types-numeri
-000049c0: 632e 6874 6d6c 236c 6162 656c 2d64 6174  c.html#label-dat
-000049d0: 612d 7479 7065 732d 666f 722d 6669 7865  a-types-for-fixe
-000049e0: 642d 706f 696e 742d 6e75 6d62 6572 733e  d-point-numbers>
-000049f0: 605f 2e0a 0a20 2020 2020 2020 2032 2e20  `_...        2. 
-00004a00: 4461 7461 2074 7970 6573 2066 6f72 2066  Data types for f
-00004a10: 6c6f 6174 696e 6720 706f 696e 7420 6e75  loating point nu
-00004a20: 6d62 6572 7320 2865 2e67 2e20 464c 4f41  mbers (e.g. FLOA
-00004a30: 5429 2061 7265 206e 6f74 2073 7570 706f  T) are not suppo
-00004a40: 7274 6564 2077 6974 6820 7468 6973 2061  rted with this a
-00004a50: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
-00004a60: 2020 332e 2049 6620 7468 6520 6578 7072    3. If the expr
-00004a70: 6573 7369 6f6e 2064 6174 6120 7479 7065  ession data type
-00004a80: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
-00004a90: 642c 2074 6865 2065 7870 7265 7373 696f  d, the expressio
-00004aa0: 6e20 6d75 7374 2062 6520 6578 706c 6963  n must be explic
-00004ab0: 6974 6c79 2063 6173 7420 746f 2064 6563  itly cast to dec
-00004ac0: 696d 616c 2062 6566 6f72 6520 6361 6c6c  imal before call
-00004ad0: 696e 672e 0a0a 2020 2020 4578 616d 706c  ing...    Exampl
-00004ae0: 653a 0a20 2020 2020 2020 203e 3e3e 2069  e:.        >>> i
-00004af0: 6d70 6f72 7420 6465 6369 6d61 6c0a 2020  mport decimal.  
-00004b00: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00004b10: 205b 2864 6563 696d 616c 2e44 6563 696d   [(decimal.Decim
-00004b20: 616c 2831 2e32 3335 2929 2c28 6465 6369  al(1.235)),(deci
-00004b30: 6d61 6c2e 4465 6369 6d61 6c28 332e 3529  mal.Decimal(3.5)
-00004b40: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
-00004b50: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00004b60: 7465 4461 7461 4672 616d 6528 6461 7461  teDataFrame(data
-00004b70: 2c20 5b22 7661 6c75 6522 5d29 0a20 2020  , ["value"]).   
-00004b80: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00004b90: 6374 2862 726f 756e 6428 2756 414c 5545  ct(bround('VALUE
-00004ba0: 272c 3129 2e61 6c69 6173 2822 5641 4c55  ',1).alias("VALU
-00004bb0: 4522 2929 2e73 686f 7728 2920 2320 526f  E")).show() # Ro
-00004bc0: 756e 6473 2074 6f20 3120 6465 6369 6d61  unds to 1 decima
-00004bd0: 6c20 706c 6163 650a 2020 2020 2020 2020  l place.        
-00004be0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00004bf0: 2020 2020 7c22 5641 4c55 4522 2020 7c0a      |"VALUE"  |.
-00004c00: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00004c10: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e32  ---.        |1.2
-00004c20: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00004c30: 7c33 2e35 2020 2020 2020 7c0a 2020 2020  |3.5      |.    
-00004c40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a      -----------.
-00004c50: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00004c60: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
-00004c70: 6466 2e73 656c 6563 7428 6272 6f75 6e64  df.select(bround
-00004c80: 2827 5641 4c55 4527 2c30 292e 616c 6961  ('VALUE',0).alia
-00004c90: 7328 2256 414c 5545 2229 292e 7368 6f77  s("VALUE")).show
-00004ca0: 2829 2023 2052 6f75 6e64 7320 746f 2031  () # Rounds to 1
-00004cb0: 2064 6563 696d 616c 2070 6c61 6365 0a20   decimal place. 
-00004cc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00004cd0: 2d2d 0a20 2020 2020 2020 207c 2256 414c  --.        |"VAL
-00004ce0: 5545 2220 207c 0a20 2020 2020 2020 202d  UE"  |.        -
-00004cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00004d00: 2020 207c 3120 2020 2020 2020 207c 0a20     |1        |. 
-00004d10: 2020 2020 2020 207c 3420 2020 2020 2020         |4       
-00004d20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00004d30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00004d40: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00004d50: 2222 0a20 2020 2063 6f6c 203d 205f 746f  "".    col = _to
-00004d60: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
-00004d70: 2022 6272 6f75 6e64 2229 0a20 2020 2073   "bround").    s
-00004d80: 6361 6c65 203d 205f 746f 5f63 6f6c 5f69  cale = _to_col_i
-00004d90: 665f 6c69 7428 7363 616c 652c 2022 6272  f_lit(scale, "br
-00004da0: 6f75 6e64 2229 0a20 2020 2072 6574 7572  ound").    retur
-00004db0: 6e20 6361 6c6c 5f62 7569 6c74 696e 2822  n call_builtin("
-00004dc0: 524f 554e 4422 2c20 636f 6c2c 2073 6361  ROUND", col, sca
-00004dd0: 6c65 2c20 6c69 7428 2248 414c 465f 544f  le, lit("HALF_TO
-00004de0: 5f45 5645 4e22 2929 0a0a 0a64 6566 2063  _EVEN"))...def c
-00004df0: 6f6e 7665 7274 5f74 696d 657a 6f6e 6528  onvert_timezone(
-00004e00: 0a20 2020 2074 6172 6765 745f 7469 6d65  .    target_time
-00004e10: 7a6f 6e65 3a20 436f 6c75 6d6e 4f72 4e61  zone: ColumnOrNa
-00004e20: 6d65 2c0a 2020 2020 736f 7572 6365 5f74  me,.    source_t
-00004e30: 696d 653a 2043 6f6c 756d 6e4f 724e 616d  ime: ColumnOrNam
-00004e40: 652c 0a20 2020 2073 6f75 7263 655f 7469  e,.    source_ti
-00004e50: 6d65 7a6f 6e65 3a20 4f70 7469 6f6e 616c  mezone: Optional
-00004e60: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
-00004e70: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
-00004e80: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
-00004e90: 7274 7320 7468 6520 6769 7665 6e20 736f  rts the given so
-00004ea0: 7572 6365 5f74 696d 6520 746f 2074 6865  urce_time to the
-00004eb0: 2074 6172 6765 7420 7469 6d65 7a6f 6e65   target timezone
-00004ec0: 2e0a 0a20 2020 2046 6f72 2074 696d 657a  ...    For timez
-00004ed0: 6f6e 6520 696e 666f 726d 6174 696f 6e2c  one information,
-00004ee0: 2072 6566 6572 2074 6f20 7468 6520 6053   refer to the `S
-00004ef0: 6e6f 7766 6c61 6b65 2053 514c 2063 6f6e  nowflake SQL con
-00004f00: 7665 7274 5f74 696d 657a 6f6e 6520 6e6f  vert_timezone no
-00004f10: 7465 7320 3c68 7474 7073 3a2f 2f64 6f63  tes <https://doc
-00004f20: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
-00004f30: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
-00004f40: 2f66 756e 6374 696f 6e73 2f63 6f6e 7665  /functions/conve
-00004f50: 7274 5f74 696d 657a 6f6e 652e 6874 6d6c  rt_timezone.html
-00004f60: 2375 7361 6765 2d6e 6f74 6573 3e60 5f0a  #usage-notes>`_.
-00004f70: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00004f80: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00004f90: 745f 7469 6d65 7a6f 6e65 3a20 5468 6520  t_timezone: The 
-00004fa0: 7469 6d65 207a 6f6e 6520 746f 2077 6869  time zone to whi
-00004fb0: 6368 2074 6865 2069 6e70 7574 2074 696d  ch the input tim
-00004fc0: 6573 7461 6d70 2073 686f 756c 6420 6265  estamp should be
-00004fd0: 2063 6f6e 7665 7274 6564 2e3d 0a20 2020   converted.=.   
-00004fe0: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
-00004ff0: 7469 6d65 3a20 5468 6520 7469 6d65 7374  time: The timest
-00005000: 616d 7020 746f 2063 6f6e 7665 7274 2e20  amp to convert. 
-00005010: 5768 656e 2069 7427 7320 6120 5449 4d45  When it's a TIME
-00005020: 5354 414d 505f 4c54 5a2c 2075 7365 2060  STAMP_LTZ, use `
-00005030: 604e 6f6e 6560 6020 666f 7220 6060 736f  `None`` for ``so
-00005040: 7572 6365 5f74 696d 657a 6f6e 6560 602e  urce_timezone``.
-00005050: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00005060: 7263 655f 7469 6d65 7a6f 6e65 3a20 5468  rce_timezone: Th
-00005070: 6520 7469 6d65 207a 6f6e 6520 666f 7220  e time zone for 
-00005080: 7468 6520 6060 736f 7572 6365 5f74 696d  the ``source_tim
-00005090: 6560 602e 2052 6571 7569 7265 6420 666f  e``. Required fo
-000050a0: 7220 7469 6d65 7374 616d 7073 2077 6974  r timestamps wit
-000050b0: 6820 6e6f 2074 696d 6520 7a6f 6e65 2028  h no time zone (
-000050c0: 692e 652e 2054 494d 4553 5441 4d50 5f4e  i.e. TIMESTAMP_N
-000050d0: 545a 292e 2055 7365 2060 604e 6f6e 6560  TZ). Use ``None`
-000050e0: 6020 6966 2074 6865 2074 696d 6573 7461  ` if the timesta
-000050f0: 6d70 7320 6861 7665 2061 2074 696d 6520  mps have a time 
-00005100: 7a6f 6e65 2028 692e 652e 2054 494d 4553  zone (i.e. TIMES
-00005110: 5441 4d50 5f4c 545a 292e 2044 6566 6175  TAMP_LTZ). Defau
-00005120: 6c74 2069 7320 6060 4e6f 6e65 6060 2e0a  lt is ``None``..
-00005130: 0a20 2020 2020 2020 204e 6f74 653a 0a20  .        Note:. 
-00005140: 2020 2020 2020 2020 2020 2054 6865 2073             The s
-00005150: 6571 7565 6e63 6520 6f66 2074 6865 2033  equence of the 3
-00005160: 2070 6172 616d 7320 6973 2064 6966 6665   params is diffe
-00005170: 7265 6e74 2066 726f 6d20 7468 6520 5351  rent from the SQ
-00005180: 4c20 6675 6e63 7469 6f6e 2c20 7768 6963  L function, whic
-00005190: 6820 7477 6f20 6f76 6572 6c6f 6164 733a  h two overloads:
-000051a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000051b0: 2d20 6060 434f 4e56 4552 545f 5449 4d45  - ``CONVERT_TIME
-000051c0: 5a4f 4e45 2820 3c73 6f75 7263 655f 747a  ZONE( <source_tz
-000051d0: 3e20 2c20 3c74 6172 6765 745f 747a 3e20  > , <target_tz> 
-000051e0: 2c20 3c73 6f75 7263 655f 7469 6d65 7374  , <source_timest
-000051f0: 616d 705f 6e74 7a3e 2029 6060 0a20 2020  amp_ntz> )``.   
-00005200: 2020 2020 2020 2020 2020 202d 2060 6043             - ``C
-00005210: 4f4e 5645 5254 5f54 494d 455a 4f4e 4528  ONVERT_TIMEZONE(
-00005220: 203c 7461 7267 6574 5f74 7a3e 202c 203c   <target_tz> , <
-00005230: 736f 7572 6365 5f74 696d 6573 7461 6d70  source_timestamp
-00005240: 3e20 2960 600a 0a20 2020 2020 2020 2020  > )``..         
-00005250: 2020 2054 6865 2066 6972 7374 2070 6172     The first par
-00005260: 616d 6574 6572 2060 6073 6f75 7263 655f  ameter ``source_
-00005270: 747a 6060 2069 7320 6f70 7469 6f6e 616c  tz`` is optional
-00005280: 2e20 4275 7420 696e 2050 7974 686f 6e20  . But in Python 
-00005290: 616e 206f 7074 696f 6e61 6c20 6172 6775  an optional argu
-000052a0: 6d65 6e74 2073 686f 756c 646e 2774 2062  ment shouldn't b
-000052b0: 6520 706c 6163 6564 2061 7420 7468 6520  e placed at the 
-000052c0: 6669 7273 742e 0a20 2020 2020 2020 2020  first..         
-000052d0: 2020 2053 6f20 6060 736f 7572 6365 5f74     So ``source_t
-000052e0: 696d 657a 6f6e 6560 6020 6973 2061 6674  imezone`` is aft
-000052f0: 6572 2060 6073 6f75 7263 655f 7469 6d65  er ``source_time
-00005300: 6060 2e0a 0a20 2020 2020 2020 2045 7861  ``...        Exa
-00005310: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-00005320: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-00005330: 6574 696d 650a 2020 2020 2020 2020 2020  etime.          
-00005340: 2020 3e3e 3e20 6672 6f6d 2064 6174 6575    >>> from dateu
-00005350: 7469 6c20 696d 706f 7274 2074 7a0a 2020  til import tz.  
-00005360: 2020 2020 2020 2020 2020 3e3e 3e20 6461            >>> da
-00005370: 7465 7469 6d65 5f77 6974 685f 747a 203d  tetime_with_tz =
-00005380: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-00005390: 6d65 2832 3032 322c 2034 2c20 362c 2039  me(2022, 4, 6, 9
-000053a0: 2c20 302c 2030 2c20 747a 696e 666f 3d74  , 0, 0, tzinfo=t
-000053b0: 7a2e 747a 6f66 6673 6574 2822 6d79 7a6f  z.tzoffset("myzo
-000053c0: 6e65 222c 202d 3336 3030 2a37 2929 0a20  ne", -3600*7)). 
-000053d0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
-000053e0: 6174 6574 696d 655f 7769 7468 5f6e 6f5f  atetime_with_no_
-000053f0: 747a 203d 2064 6174 6574 696d 652e 6461  tz = datetime.da
-00005400: 7465 7469 6d65 2832 3032 322c 2034 2c20  tetime(2022, 4, 
-00005410: 362c 2039 2c20 302c 2030 290a 2020 2020  6, 9, 0, 0).    
-00005420: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00005430: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00005440: 6461 7461 6672 616d 6528 5b5b 6461 7465  dataframe([[date
-00005450: 7469 6d65 5f77 6974 685f 747a 2c20 6461  time_with_tz, da
-00005460: 7465 7469 6d65 5f77 6974 685f 6e6f 5f74  tetime_with_no_t
-00005470: 7a5d 5d2c 2073 6368 656d 613d 5b22 6122  z]], schema=["a"
-00005480: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-00005490: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
-000054a0: 2064 662e 7365 6c65 6374 2863 6f6e 7665   df.select(conve
-000054b0: 7274 5f74 696d 657a 6f6e 6528 6c69 7428  rt_timezone(lit(
-000054c0: 2255 5443 2229 2c20 636f 6c28 2261 2229  "UTC"), col("a")
-000054d0: 292c 2063 6f6e 7665 7274 5f74 696d 657a  ), convert_timez
-000054e0: 6f6e 6528 6c69 7428 2255 5443 2229 2c20  one(lit("UTC"), 
-000054f0: 636f 6c28 2262 2229 2c20 6c69 7428 2241  col("b"), lit("A
-00005500: 7369 612f 5368 616e 6768 6169 2229 2929  sia/Shanghai")))
-00005510: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00005520: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
-00005530: 745b 305d 5b30 5d0a 2020 2020 2020 2020  t[0][0].        
-00005540: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
-00005550: 6574 696d 6528 3230 3232 2c20 342c 2036  etime(2022, 4, 6
-00005560: 2c20 3136 2c20 302c 2074 7a69 6e66 6f3d  , 16, 0, tzinfo=
-00005570: 3c55 5443 3e29 0a20 2020 2020 2020 2020  <UTC>).         
-00005580: 2020 203e 3e3e 2072 6573 756c 745b 305d     >>> result[0]
-00005590: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-000055a0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-000055b0: 6528 3230 3232 2c20 342c 2036 2c20 312c  e(2022, 4, 6, 1,
-000055c0: 2030 290a 2020 2020 2222 220a 2020 2020   0).    """.    
-000055d0: 736f 7572 6365 5f74 7a20 3d20 280a 2020  source_tz = (.  
-000055e0: 2020 2020 2020 5f74 6f5f 636f 6c5f 6966        _to_col_if
-000055f0: 5f73 7472 2873 6f75 7263 655f 7469 6d65  _str(source_time
-00005600: 7a6f 6e65 2c20 2263 6f6e 7665 7274 5f74  zone, "convert_t
-00005610: 696d 657a 6f6e 6522 290a 2020 2020 2020  imezone").      
-00005620: 2020 6966 2073 6f75 7263 655f 7469 6d65    if source_time
-00005630: 7a6f 6e65 2069 7320 6e6f 7420 4e6f 6e65  zone is not None
-00005640: 0a20 2020 2020 2020 2065 6c73 6520 4e6f  .        else No
-00005650: 6e65 0a20 2020 2029 0a20 2020 2074 6172  ne.    ).    tar
-00005660: 6765 745f 747a 203d 205f 746f 5f63 6f6c  get_tz = _to_col
-00005670: 5f69 665f 7374 7228 7461 7267 6574 5f74  _if_str(target_t
-00005680: 696d 657a 6f6e 652c 2022 636f 6e76 6572  imezone, "conver
-00005690: 745f 7469 6d65 7a6f 6e65 2229 0a20 2020  t_timezone").   
-000056a0: 2073 6f75 7263 655f 7469 6d65 5f74 6f5f   source_time_to_
-000056b0: 636f 6e76 6572 7420 3d20 5f74 6f5f 636f  convert = _to_co
-000056c0: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
-000056d0: 7469 6d65 2c20 2263 6f6e 7665 7274 5f74  time, "convert_t
-000056e0: 696d 657a 6f6e 6522 290a 0a20 2020 2069  imezone")..    i
-000056f0: 6620 736f 7572 6365 5f74 696d 657a 6f6e  f source_timezon
-00005700: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00005710: 2020 2072 6574 7572 6e20 6361 6c6c 5f62     return call_b
-00005720: 7569 6c74 696e 2822 636f 6e76 6572 745f  uiltin("convert_
-00005730: 7469 6d65 7a6f 6e65 222c 2074 6172 6765  timezone", targe
-00005740: 745f 747a 2c20 736f 7572 6365 5f74 696d  t_tz, source_tim
-00005750: 655f 746f 5f63 6f6e 7665 7274 290a 2020  e_to_convert).  
-00005760: 2020 7265 7475 726e 2063 616c 6c5f 6275    return call_bu
-00005770: 696c 7469 6e28 0a20 2020 2020 2020 2022  iltin(.        "
-00005780: 636f 6e76 6572 745f 7469 6d65 7a6f 6e65  convert_timezone
-00005790: 222c 2073 6f75 7263 655f 747a 2c20 7461  ", source_tz, ta
-000057a0: 7267 6574 5f74 7a2c 2073 6f75 7263 655f  rget_tz, source_
-000057b0: 7469 6d65 5f74 6f5f 636f 6e76 6572 740a  time_to_convert.
-000057c0: 2020 2020 290a 0a0a 6465 6620 6170 7072      )...def appr
-000057d0: 6f78 5f63 6f75 6e74 5f64 6973 7469 6e63  ox_count_distinc
-000057e0: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
-000057f0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00005800: 2020 2222 2255 7365 7320 4879 7065 724c    """Uses HyperL
-00005810: 6f67 4c6f 6720 746f 2072 6574 7572 6e20  ogLog to return 
-00005820: 616e 2061 7070 726f 7869 6d61 7469 6f6e  an approximation
-00005830: 206f 6620 7468 6520 6469 7374 696e 6374   of the distinct
-00005840: 2063 6172 6469 6e61 6c69 7479 206f 6620   cardinality of 
-00005850: 7468 6520 696e 7075 7420 2869 2e65 2e20  the input (i.e. 
-00005860: 484c 4c28 636f 6c31 2c20 636f 6c32 2c20  HLL(col1, col2, 
-00005870: 2e2e 2e20 290a 2020 2020 7265 7475 726e  ... ).    return
-00005880: 7320 616e 2061 7070 726f 7869 6d61 7469  s an approximati
-00005890: 6f6e 206f 6620 434f 554e 5428 4449 5354  on of COUNT(DIST
-000058a0: 494e 4354 2063 6f6c 312c 2063 6f6c 322c  INCT col1, col2,
-000058b0: 202e 2e2e 2029 292e 0a0a 2020 2020 4578   ... ))...    Ex
-000058c0: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-000058d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-000058e0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-000058f0: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
-00005900: 5d2c 205b 352c 2036 5d5d 2c20 7363 6865  ], [5, 6]], sche
-00005910: 6d61 3d5b 2261 222c 2022 6222 5d29 0a20  ma=["a", "b"]). 
-00005920: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00005930: 6c65 6374 2861 7070 726f 785f 636f 756e  lect(approx_coun
-00005940: 745f 6469 7374 696e 6374 2822 6122 292e  t_distinct("a").
-00005950: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00005960: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00005970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00005980: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00005990: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-000059a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-000059b0: 3320 2020 2020 2020 2020 7c0a 2020 2020  3         |.    
-000059c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000059d0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-000059e0: 494e 453e 0a0a 2020 2020 2222 220a 2020  INE>..    """.  
-000059f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00005a00: 5f73 7472 2865 2c20 2261 7070 726f 785f  _str(e, "approx_
-00005a10: 636f 756e 745f 6469 7374 696e 6374 2229  count_distinct")
-00005a20: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00005a30: 7469 6e28 2261 7070 726f 785f 636f 756e  tin("approx_coun
-00005a40: 745f 6469 7374 696e 6374 2229 2863 290a  t_distinct")(c).
-00005a50: 0a0a 6465 6620 6176 6728 653a 2043 6f6c  ..def avg(e: Col
-00005a60: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00005a70: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00005a80: 7572 6e73 2074 6865 2061 7665 7261 6765  urns the average
-00005a90: 206f 6620 6e6f 6e2d 4e55 4c4c 2072 6563   of non-NULL rec
-00005aa0: 6f72 6473 2e20 4966 2061 6c6c 2072 6563  ords. If all rec
-00005ab0: 6f72 6473 2069 6e73 6964 6520 6120 6772  ords inside a gr
-00005ac0: 6f75 7020 6172 6520 4e55 4c4c 2c0a 2020  oup are NULL,.  
-00005ad0: 2020 7468 6520 6675 6e63 7469 6f6e 2072    the function r
-00005ae0: 6574 7572 6e73 204e 554c 4c2e 0a0a 2020  eturns NULL...  
-00005af0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-00005b00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00005b10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00005b20: 6672 616d 6528 5b5b 315d 2c20 5b32 5d2c  frame([[1], [2],
-00005b30: 205b 325d 5d2c 2073 6368 656d 613d 5b22   [2]], schema=["
-00005b40: 6422 5d29 0a20 2020 2020 2020 203e 3e3e  d"]).        >>>
-00005b50: 2064 662e 7365 6c65 6374 2861 7667 2864   df.select(avg(d
-00005b60: 662e 6429 2e61 6c69 6173 2822 7265 7375  f.d).alias("resu
-00005b70: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00005b80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00005b90: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00005ba0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00005bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00005bc0: 2020 2020 7c31 2e36 3636 3636 3720 207c      |1.666667  |
-00005bd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005be0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-00005bf0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-00005c00: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00005c10: 6c5f 6966 5f73 7472 2865 2c20 2261 7667  l_if_str(e, "avg
-00005c20: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00005c30: 696c 7469 6e28 2261 7667 2229 2863 290a  iltin("avg")(c).
-00005c40: 0a0a 6465 6620 636f 7272 2863 6f6c 756d  ..def corr(colum
-00005c50: 6e31 3a20 436f 6c75 6d6e 4f72 4e61 6d65  n1: ColumnOrName
-00005c60: 2c20 636f 6c75 6d6e 323a 2043 6f6c 756d  , column2: Colum
-00005c70: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00005c80: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00005c90: 6e73 2074 6865 2063 6f72 7265 6c61 7469  ns the correlati
-00005ca0: 6f6e 2063 6f65 6666 6963 6965 6e74 2066  on coefficient f
-00005cb0: 6f72 206e 6f6e 2d6e 756c 6c20 7061 6972  or non-null pair
-00005cc0: 7320 696e 2061 2067 726f 7570 2e0a 0a20  s in a group... 
-00005cd0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00005ce0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00005cf0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00005d00: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
-00005d10: 312c 2032 5d2c 205b 342c 2035 5d2c 205b  1, 2], [4, 5], [
-00005d20: 322c 2033 5d2c 205b 332c 204e 6f6e 655d  2, 3], [3, None]
-00005d30: 2c20 5b34 2c20 4e6f 6e65 5d2c 205b 362c  , [4, None], [6,
-00005d40: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
-00005d50: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-00005d60: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
-00005d70: 7272 2863 6f6c 2822 6122 292c 2063 6f6c  rr(col("a"), col
-00005d80: 2822 6222 2929 2e61 6c69 6173 2822 7265  ("b")).alias("re
-00005d90: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-00005da0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00005db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00005dc0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00005dd0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00005de0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00005df0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005e00: 207c 302e 3831 3336 3831 3530 3833 3238   |0.813681508328
-00005e10: 3830 3920 207c 0a20 2020 2020 2020 202d  809  |.        -
-00005e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005e30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00005e40: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00005e50: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
-00005e60: 6c5f 6966 5f73 7472 2863 6f6c 756d 6e31  l_if_str(column1
-00005e70: 2c20 2263 6f72 7222 290a 2020 2020 6332  , "corr").    c2
-00005e80: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00005e90: 7228 636f 6c75 6d6e 322c 2022 636f 7272  r(column2, "corr
-00005ea0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00005eb0: 696c 7469 6e28 2263 6f72 7222 2928 6331  iltin("corr")(c1
-00005ec0: 2c20 6332 290a 0a0a 6465 6620 636f 756e  , c2)...def coun
-00005ed0: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
-00005ee0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00005ef0: 2020 2222 2252 6574 7572 6e73 2065 6974    """Returns eit
-00005f00: 6865 7220 7468 6520 6e75 6d62 6572 206f  her the number o
-00005f10: 6620 6e6f 6e2d 4e55 4c4c 2072 6563 6f72  f non-NULL recor
-00005f20: 6473 2066 6f72 2074 6865 2073 7065 6369  ds for the speci
-00005f30: 6669 6564 2063 6f6c 756d 6e73 2c20 6f72  fied columns, or
-00005f40: 2074 6865 0a20 2020 2074 6f74 616c 206e   the.    total n
-00005f50: 756d 6265 7220 6f66 2072 6563 6f72 6473  umber of records
-00005f60: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-00005f70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00005f80: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00005f90: 6461 7461 6672 616d 6528 5b5b 315d 2c20  dataframe([[1], 
-00005fa0: 5b4e 6f6e 655d 2c20 5b33 5d2c 205b 345d  [None], [3], [4]
-00005fb0: 2c20 5b4e 6f6e 655d 5d2c 2073 6368 656d  , [None]], schem
-00005fc0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00005fd0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-00005fe0: 6f75 6e74 2863 6f6c 2822 6122 2929 2e61  ount(col("a")).a
-00005ff0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00006000: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00006010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00006020: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00006030: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00006040: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c33  -----.        |3
-00006050: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00006060: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00006070: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-00006080: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
-00006090: 6466 2e73 656c 6563 7428 636f 756e 7428  df.select(count(
-000060a0: 222a 2229 2e61 6c69 6173 2822 7265 7375  "*").alias("resu
-000060b0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-000060c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000060d0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-000060e0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-000060f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00006100: 2020 2020 7c35 2020 2020 2020 2020 207c      |5         |
-00006110: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00006120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-00006130: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-00006140: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00006150: 6c5f 6966 5f73 7472 2865 2c20 2263 6f75  l_if_str(e, "cou
-00006160: 6e74 2229 0a20 2020 2072 6574 7572 6e20  nt").    return 
-00006170: 280a 2020 2020 2020 2020 6275 696c 7469  (.        builti
-00006180: 6e28 2263 6f75 6e74 2229 284c 6974 6572  n("count")(Liter
-00006190: 616c 2831 2929 0a20 2020 2020 2020 2069  al(1)).        i
-000061a0: 6620 6973 696e 7374 616e 6365 2863 2e5f  f isinstance(c._
-000061b0: 6578 7072 6573 7369 6f6e 2c20 5374 6172  expression, Star
-000061c0: 290a 2020 2020 2020 2020 656c 7365 2062  ).        else b
-000061d0: 7569 6c74 696e 2822 636f 756e 7422 2928  uiltin("count")(
-000061e0: 632e 5f65 7870 7265 7373 696f 6e29 0a20  c._expression). 
-000061f0: 2020 2029 0a0a 0a64 6566 2063 6f75 6e74     )...def count
-00006200: 5f64 6973 7469 6e63 7428 2a63 6f6c 733a  _distinct(*cols:
-00006210: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00006220: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00006230: 2252 6574 7572 6e73 2065 6974 6865 7220  "Returns either 
-00006240: 7468 6520 6e75 6d62 6572 206f 6620 6e6f  the number of no
-00006250: 6e2d 4e55 4c4c 2064 6973 7469 6e63 7420  n-NULL distinct 
-00006260: 7265 636f 7264 7320 666f 7220 7468 6520  records for the 
-00006270: 7370 6563 6966 6965 6420 636f 6c75 6d6e  specified column
-00006280: 732c 0a20 2020 206f 7220 7468 6520 746f  s,.    or the to
-00006290: 7461 6c20 6e75 6d62 6572 206f 6620 7468  tal number of th
-000062a0: 6520 6469 7374 696e 6374 2072 6563 6f72  e distinct recor
-000062b0: 6473 2e0a 0a20 2020 2045 7861 6d70 6c65  ds...    Example
-000062c0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-000062d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000062e0: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
-000062f0: 2c20 325d 2c20 5b31 2c20 325d 2c20 5b33  , 2], [1, 2], [3
-00006300: 2c20 4e6f 6e65 5d2c 205b 322c 2033 5d2c  , None], [2, 3],
-00006310: 205b 332c 204e 6f6e 655d 2c20 5b34 2c20   [3, None], [4, 
-00006320: 4e6f 6e65 5d5d 2c20 7363 6865 6d61 3d5b  None]], schema=[
-00006330: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-00006340: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00006350: 2863 6f75 6e74 5f64 6973 7469 6e63 7428  (count_distinct(
-00006360: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
-00006370: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-00006380: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00006390: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000063a0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-000063b0: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-000063c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000063d0: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
-000063e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000063f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00006400: 414e 4b4c 494e 453e 0a20 2020 2020 2020  ANKLINE>.       
-00006410: 203e 3e3e 2023 2020 5468 6520 7265 7375   >>> #  The resu
-00006420: 6c74 2073 686f 756c 6420 6265 2032 2066  lt should be 2 f
-00006430: 6f72 207b 5b31 2c32 5d2c 5b32 2c33 5d7d  or {[1,2],[2,3]}
-00006440: 2073 696e 6365 2074 6865 2072 6573 7420   since the rest 
-00006450: 6172 6520 6569 7468 6572 2064 7570 6c69  are either dupli
-00006460: 6361 7465 206f 7220 4e55 4c4c 2072 6563  cate or NULL rec
-00006470: 6f72 6473 0a20 2020 2022 2222 0a20 2020  ords.    """.   
-00006480: 2063 7320 3d20 5b5f 746f 5f63 6f6c 5f69   cs = [_to_col_i
-00006490: 665f 7374 7228 632c 2022 636f 756e 745f  f_str(c, "count_
-000064a0: 6469 7374 696e 6374 2229 2066 6f72 2063  distinct") for c
-000064b0: 2069 6e20 636f 6c73 5d0a 2020 2020 7265   in cols].    re
-000064c0: 7475 726e 2043 6f6c 756d 6e28 0a20 2020  turn Column(.   
-000064d0: 2020 2020 2046 756e 6374 696f 6e45 7870       FunctionExp
-000064e0: 7265 7373 696f 6e28 2263 6f75 6e74 222c  ression("count",
-000064f0: 205b 632e 5f65 7870 7265 7373 696f 6e20   [c._expression 
-00006500: 666f 7220 6320 696e 2063 735d 2c20 6973  for c in cs], is
-00006510: 5f64 6973 7469 6e63 743d 5472 7565 290a  _distinct=True).
-00006520: 2020 2020 290a 0a0a 6465 6620 636f 7661      )...def cova
-00006530: 725f 706f 7028 636f 6c75 6d6e 313a 2043  r_pop(column1: C
-00006540: 6f6c 756d 6e4f 724e 616d 652c 2063 6f6c  olumnOrName, col
-00006550: 756d 6e32 3a20 436f 6c75 6d6e 4f72 4e61  umn2: ColumnOrNa
-00006560: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00006570: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-00006580: 6520 706f 7075 6c61 7469 6f6e 2063 6f76  e population cov
-00006590: 6172 6961 6e63 6520 666f 7220 6e6f 6e2d  ariance for non-
-000065a0: 6e75 6c6c 2070 6169 7273 2069 6e20 6120  null pairs in a 
-000065b0: 6772 6f75 702e 0a0a 2020 2020 4578 616d  group...    Exam
-000065c0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-000065d0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-000065e0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-000065f0: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
-00006600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-00006610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00006620: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
-00006630: 2032 5d2c 205b 312c 2032 5d2c 205b 342c   2], [1, 2], [4,
-00006640: 2035 5d2c 205b 322c 2033 5d2c 205b 332c   5], [2, 3], [3,
-00006650: 204e 6f6e 655d 2c20 5b34 2c20 4e6f 6e65   None], [4, None
-00006660: 5d2c 205b 362c 345d 5d2c 2073 6368 656d  ], [6,4]], schem
-00006670: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
-00006680: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00006690: 6563 7428 636f 7661 725f 706f 7028 636f  ect(covar_pop(co
-000066a0: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
-000066b0: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
-000066c0: 7065 2873 6361 6c65 3d33 2929 2e61 6c69  pe(scale=3)).ali
-000066d0: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-000066e0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-000066f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00006700: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-00006710: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00006720: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e38  ---.        |1.8
-00006730: 3430 2020 2020 207c 0a20 2020 2020 2020  40     |.       
-00006740: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-00006750: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00006760: 3e0a 2020 2020 2222 220a 2020 2020 636f  >.    """.    co
-00006770: 6c31 203d 205f 746f 5f63 6f6c 5f69 665f  l1 = _to_col_if_
-00006780: 7374 7228 636f 6c75 6d6e 312c 2022 636f  str(column1, "co
-00006790: 7661 725f 706f 7022 290a 2020 2020 636f  var_pop").    co
-000067a0: 6c32 203d 205f 746f 5f63 6f6c 5f69 665f  l2 = _to_col_if_
-000067b0: 7374 7228 636f 6c75 6d6e 322c 2022 636f  str(column2, "co
-000067c0: 7661 725f 706f 7022 290a 2020 2020 7265  var_pop").    re
-000067d0: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
-000067e0: 7661 725f 706f 7022 2928 636f 6c31 2c20  var_pop")(col1, 
-000067f0: 636f 6c32 290a 0a0a 6465 6620 636f 7661  col2)...def cova
-00006800: 725f 7361 6d70 2863 6f6c 756d 6e31 3a20  r_samp(column1: 
-00006810: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 636f  ColumnOrName, co
-00006820: 6c75 6d6e 323a 2043 6f6c 756d 6e4f 724e  lumn2: ColumnOrN
-00006830: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00006840: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00006850: 6865 2073 616d 706c 6520 636f 7661 7269  he sample covari
-00006860: 616e 6365 2066 6f72 206e 6f6e 2d6e 756c  ance for non-nul
-00006870: 6c20 7061 6972 7320 696e 2061 2067 726f  l pairs in a gro
-00006880: 7570 2e0a 0a20 2020 2045 7861 6d70 6c65  up...    Example
-00006890: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-000068a0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-000068b0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-000068c0: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
-000068d0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000068e0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000068f0: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
-00006900: 2c20 5b31 2c20 325d 2c20 5b34 2c20 355d  , [1, 2], [4, 5]
-00006910: 2c20 5b32 2c20 335d 2c20 5b33 2c20 4e6f  , [2, 3], [3, No
-00006920: 6e65 5d2c 205b 342c 204e 6f6e 655d 2c20  ne], [4, None], 
-00006930: 5b36 2c34 5d5d 2c20 7363 6865 6d61 3d5b  [6,4]], schema=[
-00006940: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-00006950: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00006960: 2863 6f76 6172 5f73 616d 7028 636f 6c28  (covar_samp(col(
-00006970: 2261 2229 2c20 636f 6c28 2262 2229 292e  "a"), col("b")).
-00006980: 6361 7374 2844 6563 696d 616c 5479 7065  cast(DecimalType
-00006990: 2873 6361 6c65 3d33 2929 2e61 6c69 6173  (scale=3)).alias
-000069a0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-000069b0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-000069c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000069d0: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-000069e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000069f0: 2d0a 2020 2020 2020 2020 7c32 2e33 3030  -.        |2.300
-00006a00: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00006a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00006a20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00006a30: 2020 2020 2222 220a 2020 2020 636f 6c31      """.    col1
-00006a40: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00006a50: 7228 636f 6c75 6d6e 312c 2022 636f 7661  r(column1, "cova
-00006a60: 725f 7361 6d70 2229 0a20 2020 2063 6f6c  r_samp").    col
-00006a70: 3220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  2 = _to_col_if_s
-00006a80: 7472 2863 6f6c 756d 6e32 2c20 2263 6f76  tr(column2, "cov
-00006a90: 6172 5f73 616d 7022 290a 2020 2020 7265  ar_samp").    re
-00006aa0: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
-00006ab0: 7661 725f 7361 6d70 2229 2863 6f6c 312c  var_samp")(col1,
-00006ac0: 2063 6f6c 3229 0a0a 0a64 6566 206b 7572   col2)...def kur
-00006ad0: 746f 7369 7328 653a 2043 6f6c 756d 6e4f  tosis(e: ColumnO
-00006ae0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00006af0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00006b00: 7475 726e 7320 7468 6520 706f 7075 6c61  turns the popula
-00006b10: 7469 6f6e 2065 7863 6573 7320 6b75 7274  tion excess kurt
-00006b20: 6f73 6973 206f 6620 6e6f 6e2d 4e55 4c4c  osis of non-NULL
-00006b30: 2072 6563 6f72 6473 2e20 4966 2061 6c6c   records. If all
-00006b40: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
-00006b50: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
-00006b60: 4e55 4c4c 2c20 7468 6520 6675 6e63 7469  NULL, the functi
-00006b70: 6f6e 2072 6574 7572 6e73 204e 554c 4c2e  on returns NULL.
-00006b80: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00006b90: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00006ba0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00006bb0: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
-00006bc0: 6d70 6f72 7420 6b75 7274 6f73 6973 0a20  mport kurtosis. 
-00006bd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00006be0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00006bf0: 6174 6166 7261 6d65 285b 312c 2033 2c20  ataframe([1, 3, 
-00006c00: 3130 2c20 312c 2033 5d2c 2073 6368 656d  10, 1, 3], schem
-00006c10: 613d 5b22 7822 5d29 0a20 2020 2020 2020  a=["x"]).       
-00006c20: 203e 3e3e 2064 662e 7365 6c65 6374 286b   >>> df.select(k
-00006c30: 7572 746f 7369 7328 2278 2229 2e61 735f  urtosis("x").as_
-00006c40: 2822 7822 2929 2e63 6f6c 6c65 6374 2829  ("x")).collect()
-00006c50: 0a20 2020 2020 2020 205b 526f 7728 583d  .        [Row(X=
-00006c60: 4465 6369 6d61 6c28 2733 2e36 3133 3733  Decimal('3.61373
-00006c70: 3636 3039 3935 3627 2929 5d0a 2020 2020  6609956'))].    
-00006c80: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00006c90: 636f 6c5f 6966 5f73 7472 2865 2c20 226b  col_if_str(e, "k
-00006ca0: 7572 746f 7369 7322 290a 2020 2020 7265  urtosis").    re
-00006cb0: 7475 726e 2062 7569 6c74 696e 2822 6b75  turn builtin("ku
-00006cc0: 7274 6f73 6973 2229 2863 290a 0a0a 6465  rtosis")(c)...de
-00006cd0: 6620 6d61 7828 653a 2043 6f6c 756d 6e4f  f max(e: ColumnO
-00006ce0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00006cf0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00006d00: 7475 726e 7320 7468 6520 6d61 7869 6d75  turns the maximu
-00006d10: 6d20 7661 6c75 6520 666f 7220 7468 6520  m value for the 
-00006d20: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
-00006d30: 7570 2e20 4e55 4c4c 2076 616c 7565 7320  up. NULL values 
-00006d40: 6172 6520 6967 6e6f 7265 640a 2020 2020  are ignored.    
-00006d50: 756e 6c65 7373 2061 6c6c 2074 6865 2072  unless all the r
-00006d60: 6563 6f72 6473 2061 7265 204e 554c 4c2c  ecords are NULL,
-00006d70: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
-00006d80: 204e 554c 4c20 7661 6c75 6520 6973 2072   NULL value is r
-00006d90: 6574 7572 6e65 642e 0a0a 2020 2020 4578  eturned...    Ex
-00006da0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00006db0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00006dc0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00006dd0: 6d65 285b 312c 2033 2c20 3130 2c20 312c  me([1, 3, 10, 1,
-00006de0: 2033 5d2c 2073 6368 656d 613d 5b22 7822   3], schema=["x"
-00006df0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00006e00: 662e 7365 6c65 6374 286d 6178 2822 7822  f.select(max("x"
-00006e10: 292e 6173 5f28 2278 2229 292e 636f 6c6c  ).as_("x")).coll
-00006e20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00006e30: 6f77 2858 3d31 3029 5d0a 2020 2020 2222  ow(X=10)].    ""
-00006e40: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00006e50: 6c5f 6966 5f73 7472 2865 2c20 226d 6178  l_if_str(e, "max
-00006e60: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00006e70: 696c 7469 6e28 226d 6178 2229 2863 290a  iltin("max")(c).
-00006e80: 0a0a 6465 6620 6d65 616e 2865 3a20 436f  ..def mean(e: Co
-00006e90: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00006ea0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00006eb0: 2020 2052 6574 7572 6e20 7468 6520 6176     Return the av
-00006ec0: 6572 6167 6520 666f 7220 7468 6520 7370  erage for the sp
-00006ed0: 6563 6966 6963 206e 756d 6572 6963 2063  ecific numeric c
-00006ee0: 6f6c 756d 6e73 2e20 416c 6961 7320 6f66  olumns. Alias of
-00006ef0: 203a 6675 6e63 3a60 6176 6760 2e0a 0a20   :func:`avg`... 
-00006f00: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00006f10: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00006f20: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00006f30: 7461 6672 616d 6528 5b31 2c20 332c 2031  taframe([1, 3, 1
-00006f40: 302c 2031 2c20 335d 2c20 7363 6865 6d61  0, 1, 3], schema
-00006f50: 3d5b 2278 225d 290a 2020 2020 2020 2020  =["x"]).        
-00006f60: 3e3e 3e20 6466 2e73 656c 6563 7428 6d65  >>> df.select(me
-00006f70: 616e 2822 7822 292e 6173 5f28 2278 2229  an("x").as_("x")
-00006f80: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00006f90: 2020 2020 5b52 6f77 2858 3d44 6563 696d      [Row(X=Decim
-00006fa0: 616c 2827 332e 3630 3030 3030 2729 295d  al('3.600000'))]
-00006fb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00006fc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00006fd0: 652c 2022 6d65 616e 2229 0a20 2020 2072  e, "mean").    r
-00006fe0: 6574 7572 6e20 6176 6728 6329 0a0a 0a64  eturn avg(c)...d
-00006ff0: 6566 206d 6564 6961 6e28 653a 2043 6f6c  ef median(e: Col
-00007000: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00007010: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00007020: 2020 5265 7475 726e 7320 7468 6520 6d65    Returns the me
-00007030: 6469 616e 2076 616c 7565 2066 6f72 2074  dian value for t
-00007040: 6865 2072 6563 6f72 6473 2069 6e20 6120  he records in a 
-00007050: 6772 6f75 702e 204e 554c 4c20 7661 6c75  group. NULL valu
-00007060: 6573 2061 7265 2069 676e 6f72 6564 0a20  es are ignored. 
-00007070: 2020 2075 6e6c 6573 7320 616c 6c20 7468     unless all th
-00007080: 6520 7265 636f 7264 7320 6172 6520 4e55  e records are NU
-00007090: 4c4c 2c20 696e 2077 6869 6368 2063 6173  LL, in which cas
-000070a0: 6520 6120 4e55 4c4c 2076 616c 7565 2069  e a NULL value i
-000070b0: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
-000070c0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-000070d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-000070e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000070f0: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
-00007100: 2031 2c20 335d 2c20 7363 6865 6d61 3d5b   1, 3], schema=[
-00007110: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
-00007120: 3e20 6466 2e73 656c 6563 7428 6d65 6469  > df.select(medi
-00007130: 616e 2822 7822 292e 6173 5f28 2278 2229  an("x").as_("x")
-00007140: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00007150: 2020 2020 5b52 6f77 2858 3d44 6563 696d      [Row(X=Decim
-00007160: 616c 2827 332e 3030 3027 2929 5d0a 2020  al('3.000'))].  
-00007170: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00007180: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00007190: 226d 6564 6961 6e22 290a 2020 2020 7265  "median").    re
-000071a0: 7475 726e 2062 7569 6c74 696e 2822 6d65  turn builtin("me
-000071b0: 6469 616e 2229 2863 290a 0a0a 6465 6620  dian")(c)...def 
-000071c0: 6d69 6e28 653a 2043 6f6c 756d 6e4f 724e  min(e: ColumnOrN
-000071d0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-000071e0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-000071f0: 726e 7320 7468 6520 6d69 6e69 6d75 6d20  rns the minimum 
-00007200: 7661 6c75 6520 666f 7220 7468 6520 7265  value for the re
-00007210: 636f 7264 7320 696e 2061 2067 726f 7570  cords in a group
-00007220: 2e20 4e55 4c4c 2076 616c 7565 7320 6172  . NULL values ar
-00007230: 6520 6967 6e6f 7265 640a 2020 2020 756e  e ignored.    un
-00007240: 6c65 7373 2061 6c6c 2074 6865 2072 6563  less all the rec
-00007250: 6f72 6473 2061 7265 204e 554c 4c2c 2069  ords are NULL, i
-00007260: 6e20 7768 6963 6820 6361 7365 2061 204e  n which case a N
-00007270: 554c 4c20 7661 6c75 6520 6973 2072 6574  ULL value is ret
-00007280: 7572 6e65 642e 0a0a 2020 2020 4578 616d  urned...    Exam
-00007290: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-000072a0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000072b0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000072c0: 285b 312c 2033 2c20 3130 2c20 312c 2033  ([1, 3, 10, 1, 3
-000072d0: 5d2c 2073 6368 656d 613d 5b22 7822 5d29  ], schema=["x"])
-000072e0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000072f0: 7365 6c65 6374 286d 696e 2822 7822 292e  select(min("x").
-00007300: 6173 5f28 2278 2229 292e 636f 6c6c 6563  as_("x")).collec
-00007310: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00007320: 2858 3d31 295d 0a20 2020 2022 2222 0a20  (X=1)].    """. 
-00007330: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00007340: 665f 7374 7228 652c 2022 6d69 6e22 290a  f_str(e, "min").
-00007350: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00007360: 696e 2822 6d69 6e22 2928 6329 0a0a 0a64  in("min")(c)...d
-00007370: 6566 206d 6f64 6528 653a 2043 6f6c 756d  ef mode(e: Colum
-00007380: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00007390: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000073a0: 5265 7475 726e 7320 7468 6520 6d6f 7374  Returns the most
-000073b0: 2066 7265 7175 656e 7420 7661 6c75 6520   frequent value 
-000073c0: 666f 7220 7468 6520 7265 636f 7264 7320  for the records 
-000073d0: 696e 2061 2067 726f 7570 2e20 4e55 4c4c  in a group. NULL
-000073e0: 2076 616c 7565 7320 6172 6520 6967 6e6f   values are igno
-000073f0: 7265 642e 0a20 2020 2049 6620 616c 6c20  red..    If all 
-00007400: 7468 6520 7661 6c75 6573 2061 7265 204e  the values are N
-00007410: 554c 4c2c 206f 7220 7468 6572 6520 6172  ULL, or there ar
-00007420: 6520 3020 726f 7773 2c20 7468 656e 2074  e 0 rows, then t
-00007430: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
-00007440: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
-00007450: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00007460: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00007470: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00007480: 616d 6528 5b31 2c20 332c 2031 302c 2031  ame([1, 3, 10, 1
-00007490: 2c20 345d 2c20 7363 6865 6d61 3d5b 2278  , 4], schema=["x
-000074a0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000074b0: 6466 2e73 656c 6563 7428 6d6f 6465 2822  df.select(mode("
-000074c0: 7822 292e 6173 5f28 2278 2229 292e 636f  x").as_("x")).co
-000074d0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000074e0: 5b52 6f77 2858 3d31 295d 0a20 2020 2022  [Row(X=1)].    "
-000074f0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00007500: 6f6c 5f69 665f 7374 7228 652c 2022 6d6f  ol_if_str(e, "mo
-00007510: 6465 2229 0a20 2020 2072 6574 7572 6e20  de").    return 
-00007520: 6275 696c 7469 6e28 226d 6f64 6522 2928  builtin("mode")(
-00007530: 6329 0a0a 0a64 6566 2073 6b65 7728 653a  c)...def skew(e:
-00007540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00007550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00007560: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
-00007570: 706c 6520 736b 6577 6e65 7373 206f 6620  ple skewness of 
-00007580: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
-00007590: 2e20 4966 2061 6c6c 2072 6563 6f72 6473  . If all records
-000075a0: 2069 6e73 6964 6520 6120 6772 6f75 700a   inside a group.
-000075b0: 2020 2020 6172 6520 4e55 4c4c 2c20 7468      are NULL, th
-000075c0: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
-000075d0: 6e73 204e 554c 4c2e 0a0a 2020 2020 4578  ns NULL...    Ex
-000075e0: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-000075f0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00007600: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-00007610: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
-00007620: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-00007630: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00007640: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00007650: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00007660: 5b31 302c 2031 302c 2032 302c 2032 352c  [10, 10, 20, 25,
-00007670: 2033 305d 2c0a 2020 2020 2020 2020 2e2e   30],.        ..
-00007680: 2e20 2020 2020 7363 6865 6d61 3d5b 2261  .     schema=["a
-00007690: 225d 0a20 2020 2020 2020 202e 2e2e 2029  "].        ... )
-000076a0: 2e73 656c 6563 7428 736b 6577 2822 6122  .select(skew("a"
-000076b0: 292e 6361 7374 2844 6563 696d 616c 5479  ).cast(DecimalTy
-000076c0: 7065 2873 6361 6c65 3d34 2929 290a 2020  pe(scale=4))).  
-000076d0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
-000076e0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000076f0: 526f 7728 4341 5354 2028 534b 4557 2822  Row(CAST (SKEW("
-00007700: 4122 2920 4153 204e 554d 4245 5228 3338  A") AS NUMBER(38
-00007710: 2c20 3429 293d 4465 6369 6d61 6c28 2730  , 4))=Decimal('0
-00007720: 2e30 3532 3427 2929 5d0a 2020 2020 2222  .0524'))].    ""
-00007730: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00007740: 6c5f 6966 5f73 7472 2865 2c20 2273 6b65  l_if_str(e, "ske
-00007750: 7722 290a 2020 2020 7265 7475 726e 2062  w").    return b
-00007760: 7569 6c74 696e 2822 736b 6577 2229 2863  uiltin("skew")(c
-00007770: 290a 0a0a 6465 6620 7374 6464 6576 2865  )...def stddev(e
-00007780: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00007790: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-000077a0: 2222 5265 7475 726e 7320 7468 6520 7361  ""Returns the sa
-000077b0: 6d70 6c65 2073 7461 6e64 6172 6420 6465  mple standard de
-000077c0: 7669 6174 696f 6e20 2873 7175 6172 6520  viation (square 
-000077d0: 726f 6f74 206f 6620 7361 6d70 6c65 2076  root of sample v
-000077e0: 6172 6961 6e63 6529 206f 660a 2020 2020  ariance) of.    
-000077f0: 6e6f 6e2d 4e55 4c4c 2076 616c 7565 732e  non-NULL values.
-00007800: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
-00007810: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
-00007820: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
-00007830: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
-00007840: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00007850: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-00007860: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-00007870: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
-00007880: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-00007890: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000078a0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-000078b0: 2020 2020 2020 2e2e 2e20 2020 2020 5b34        ...     [4
-000078c0: 2c20 395d 2c0a 2020 2020 2020 2020 2e2e  , 9],.        ..
-000078d0: 2e20 2020 2020 7363 6865 6d61 3d5b 224e  .     schema=["N
-000078e0: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
-000078f0: 292e 7365 6c65 6374 2873 7464 6465 7628  ).select(stddev(
-00007900: 636f 6c28 224e 2229 292e 6361 7374 2844  col("N")).cast(D
-00007910: 6563 696d 616c 5479 7065 2873 6361 6c65  ecimalType(scale
-00007920: 3d34 2929 290a 2020 2020 2020 2020 3e3e  =4))).        >>
-00007930: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
-00007940: 2020 2020 2020 205b 526f 7728 4341 5354         [Row(CAST
-00007950: 2028 5354 4444 4556 2822 4e22 2920 4153   (STDDEV("N") AS
-00007960: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
-00007970: 4465 6369 6d61 6c28 2733 2e35 3335 3527  Decimal('3.5355'
-00007980: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-00007990: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000079a0: 7472 2865 2c20 2273 7464 6465 7622 290a  tr(e, "stddev").
-000079b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000079c0: 696e 2822 7374 6464 6576 2229 2863 290a  in("stddev")(c).
-000079d0: 0a0a 6465 6620 7374 6464 6576 5f73 616d  ..def stddev_sam
-000079e0: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
-000079f0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00007a00: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00007a10: 2073 616d 706c 6520 7374 616e 6461 7264   sample standard
-00007a20: 2064 6576 6961 7469 6f6e 2028 7371 7561   deviation (squa
-00007a30: 7265 2072 6f6f 7420 6f66 2073 616d 706c  re root of sampl
-00007a40: 6520 7661 7269 616e 6365 2920 6f66 0a20  e variance) of. 
-00007a50: 2020 206e 6f6e 2d4e 554c 4c20 7661 6c75     non-NULL valu
-00007a60: 6573 2e20 4966 2061 6c6c 2072 6563 6f72  es. If all recor
-00007a70: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
-00007a80: 7020 6172 6520 4e55 4c4c 2c20 7265 7475  p are NULL, retu
-00007a90: 726e 7320 4e55 4c4c 2e20 416c 6961 7320  rns NULL. Alias 
-00007aa0: 6f66 0a20 2020 203a 6675 6e63 3a60 7374  of.    :func:`st
-00007ab0: 6464 6576 602e 0a0a 2020 2020 4578 616d  ddev`...    Exam
-00007ac0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00007ad0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-00007ae0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-00007af0: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
-00007b00: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-00007b10: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00007b20: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-00007b30: 2020 2020 2020 2e2e 2e20 2020 2020 5b34        ...     [4
-00007b40: 2c20 395d 2c0a 2020 2020 2020 2020 2e2e  , 9],.        ..
-00007b50: 2e20 2020 2020 7363 6865 6d61 3d5b 224e  .     schema=["N
-00007b60: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
-00007b70: 292e 7365 6c65 6374 2873 7464 6465 765f  ).select(stddev_
-00007b80: 7361 6d70 2863 6f6c 2822 4e22 2929 2e63  samp(col("N")).c
-00007b90: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
-00007ba0: 7363 616c 653d 3429 2929 0a20 2020 2020  scale=4))).     
-00007bb0: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
-00007bc0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00007bd0: 2843 4153 5420 2853 5444 4445 565f 5341  (CAST (STDDEV_SA
-00007be0: 4d50 2822 4e22 2920 4153 204e 554d 4245  MP("N") AS NUMBE
-00007bf0: 5228 3338 2c20 3429 293d 4465 6369 6d61  R(38, 4))=Decima
-00007c00: 6c28 2733 2e35 3335 3527 2929 5d0a 2020  l('3.5355'))].  
-00007c10: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00007c20: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00007c30: 2273 7464 6465 765f 7361 6d70 2229 0a20  "stddev_samp"). 
-00007c40: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00007c50: 6e28 2273 7464 6465 765f 7361 6d70 2229  n("stddev_samp")
-00007c60: 2863 290a 0a0a 6465 6620 7374 6464 6576  (c)...def stddev
-00007c70: 5f70 6f70 2865 3a20 436f 6c75 6d6e 4f72  _pop(e: ColumnOr
-00007c80: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-00007c90: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00007ca0: 7468 6520 706f 7075 6c61 7469 6f6e 2073  the population s
-00007cb0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
-00007cc0: 6e20 2873 7175 6172 6520 726f 6f74 206f  n (square root o
-00007cd0: 6620 7661 7269 616e 6365 2920 6f66 206e  f variance) of n
-00007ce0: 6f6e 2d4e 554c 4c0a 2020 2020 7661 6c75  on-NULL.    valu
-00007cf0: 6573 2e20 4966 2061 6c6c 2072 6563 6f72  es. If all recor
-00007d00: 6473 2069 6e73 6964 6520 6120 6772 6f75  ds inside a grou
-00007d10: 7020 6172 6520 4e55 4c4c 2c20 7265 7475  p are NULL, retu
-00007d20: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
-00007d30: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00007d40: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00007d50: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00007d60: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
-00007d70: 2020 2020 5b34 2c20 395d 2c0a 2020 2020      [4, 9],.    
-00007d80: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-00007d90: 6d61 3d5b 224e 225d 2c0a 2020 2020 2020  ma=["N"],.      
-00007da0: 2020 2e2e 2e20 292e 7365 6c65 6374 2873    ... ).select(s
-00007db0: 7464 6465 765f 706f 7028 636f 6c28 224e  tddev_pop(col("N
-00007dc0: 2229 2929 0a20 2020 2020 2020 203e 3e3e  "))).        >>>
-00007dd0: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
-00007de0: 2020 2020 2020 5b52 6f77 2853 5444 4445        [Row(STDDE
-00007df0: 565f 504f 5028 224e 2229 3d32 2e35 295d  V_POP("N")=2.5)]
-00007e00: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00007e10: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00007e20: 652c 2022 7374 6464 6576 5f70 6f70 2229  e, "stddev_pop")
-00007e30: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00007e40: 7469 6e28 2273 7464 6465 765f 706f 7022  tin("stddev_pop"
-00007e50: 2928 6329 0a0a 0a64 6566 2073 756d 2865  )(c)...def sum(e
-00007e60: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00007e70: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00007e80: 2222 5265 7475 726e 7320 7468 6520 7375  ""Returns the su
-00007e90: 6d20 6f66 206e 6f6e 2d4e 554c 4c20 7265  m of non-NULL re
-00007ea0: 636f 7264 7320 696e 2061 2067 726f 7570  cords in a group
-00007eb0: 2e20 596f 7520 6361 6e20 7573 6520 7468  . You can use th
-00007ec0: 6520 4449 5354 494e 4354 206b 6579 776f  e DISTINCT keywo
-00007ed0: 7264 0a20 2020 2074 6f20 636f 6d70 7574  rd.    to comput
-00007ee0: 6520 7468 6520 7375 6d20 6f66 2075 6e69  e the sum of uni
-00007ef0: 7175 6520 6e6f 6e2d 6e75 6c6c 2076 616c  que non-null val
-00007f00: 7565 732e 2049 6620 616c 6c20 7265 636f  ues. If all reco
-00007f10: 7264 7320 696e 7369 6465 2061 2067 726f  rds inside a gro
-00007f20: 7570 2061 7265 0a20 2020 204e 554c 4c2c  up are.    NULL,
-00007f30: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-00007f40: 7475 726e 7320 4e55 4c4c 2e0a 0a20 2020  turns NULL...   
-00007f50: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-00007f60: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00007f70: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00007f80: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00007f90: 2e20 2020 2020 5b34 2c20 395d 2c0a 2020  .     [4, 9],.  
-00007fa0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-00007fb0: 6865 6d61 3d5b 224e 225d 2c0a 2020 2020  hema=["N"],.    
-00007fc0: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
-00007fd0: 2873 756d 2863 6f6c 2822 4e22 2929 290a  (sum(col("N"))).
-00007fe0: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
-00007ff0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00008000: 205b 526f 7728 5355 4d28 224e 2229 3d31   [Row(SUM("N")=1
-00008010: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
-00008020: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00008030: 7472 2865 2c20 2273 756d 2229 0a20 2020  tr(e, "sum").   
-00008040: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00008050: 2273 756d 2229 2863 290a 0a0a 6465 6620  "sum")(c)...def 
-00008060: 7375 6d5f 6469 7374 696e 6374 2865 3a20  sum_distinct(e: 
-00008070: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00008080: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00008090: 5265 7475 726e 7320 7468 6520 7375 6d20  Returns the sum 
-000080a0: 6f66 206e 6f6e 2d4e 554c 4c20 6469 7374  of non-NULL dist
-000080b0: 696e 6374 2072 6563 6f72 6473 2069 6e20  inct records in 
-000080c0: 6120 6772 6f75 702e 2059 6f75 2063 616e  a group. You can
-000080d0: 2075 7365 2074 6865 0a20 2020 2044 4953   use the.    DIS
-000080e0: 5449 4e43 5420 6b65 7977 6f72 6420 746f  TINCT keyword to
-000080f0: 2063 6f6d 7075 7465 2074 6865 2073 756d   compute the sum
-00008100: 206f 6620 756e 6971 7565 206e 6f6e 2d6e   of unique non-n
-00008110: 756c 6c20 7661 6c75 6573 2e20 4966 2061  ull values. If a
-00008120: 6c6c 2072 6563 6f72 6473 0a20 2020 2069  ll records.    i
-00008130: 6e73 6964 6520 6120 6772 6f75 7020 6172  nside a group ar
-00008140: 6520 4e55 4c4c 2c20 7468 6520 6675 6e63  e NULL, the func
-00008150: 7469 6f6e 2072 6574 7572 6e73 204e 554c  tion returns NUL
-00008160: 4c2e 0a0a 2020 2020 4578 616d 706c 653a  L...    Example:
-00008170: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-00008180: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00008190: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
-000081a0: 2020 2020 202e 2e2e 2020 2020 205b 312c       ...     [1,
-000081b0: 2032 2c20 4e6f 6e65 2c20 335d 2c0a 2020   2, None, 3],.  
-000081c0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-000081d0: 6865 6d61 3d5b 224e 225d 2c0a 2020 2020  hema=["N"],.    
-000081e0: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
-000081f0: 2873 756d 5f64 6973 7469 6e63 7428 636f  (sum_distinct(co
-00008200: 6c28 224e 2229 2929 0a20 2020 2020 2020  l("N"))).       
-00008210: 203e 3e3e 2064 662e 636f 6c6c 6563 7428   >>> df.collect(
-00008220: 290a 2020 2020 2020 2020 5b52 6f77 2853  ).        [Row(S
-00008230: 554d 2820 4449 5354 494e 4354 2022 4e22  UM( DISTINCT "N"
-00008240: 293d 3629 5d0a 2020 2020 2222 220a 2020  )=6)].    """.  
-00008250: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00008260: 5f73 7472 2865 2c20 2273 756d 5f64 6973  _str(e, "sum_dis
-00008270: 7469 6e63 7422 290a 2020 2020 7265 7475  tinct").    retu
-00008280: 726e 205f 6361 6c6c 5f66 756e 6374 696f  rn _call_functio
-00008290: 6e28 2273 756d 222c 2054 7275 652c 2063  n("sum", True, c
-000082a0: 290a 0a0a 6465 6620 7661 7269 616e 6365  )...def variance
-000082b0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-000082c0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000082d0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-000082e0: 7361 6d70 6c65 2076 6172 6961 6e63 6520  sample variance 
-000082f0: 6f66 206e 6f6e 2d4e 554c 4c20 7265 636f  of non-NULL reco
-00008300: 7264 7320 696e 2061 2067 726f 7570 2e20  rds in a group. 
-00008310: 4966 2061 6c6c 2072 6563 6f72 6473 0a20  If all records. 
-00008320: 2020 2069 6e73 6964 6520 6120 6772 6f75     inside a grou
-00008330: 7020 6172 6520 4e55 4c4c 2c20 6120 4e55  p are NULL, a NU
-00008340: 4c4c 2069 7320 7265 7475 726e 6564 2e20  LL is returned. 
-00008350: 466f 7220 6120 7369 6e67 6c65 2072 6f77  For a single row
-00008360: 2c20 4e55 4c4c 2069 7320 7265 7475 726e  , NULL is return
-00008370: 6564 2061 7320 7361 6d70 6c65 2076 6172  ed as sample var
-00008380: 6961 6e63 652e 0a0a 2020 2020 4578 616d  iance...    Exam
-00008390: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-000083a0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000083b0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000083c0: 285b 312c 202d 312c 2031 2c20 2d31 2c20  ([1, -1, 1, -1, 
-000083d0: 2d31 5d2c 2073 6368 656d 613d 5b22 6122  -1], schema=["a"
-000083e0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-000083f0: 662e 7365 6c65 6374 2876 6172 6961 6e63  f.select(varianc
-00008400: 6528 636f 6c28 2261 2229 2929 2e63 6f6c  e(col("a"))).col
-00008410: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00008420: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
-00008430: 293d 4465 6369 6d61 6c28 2731 2e32 3030  )=Decimal('1.200
-00008440: 3030 3027 2929 5d0a 0a20 2020 2020 2020  000'))]..       
-00008450: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00008460: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00008470: 6d65 285b 312c 204e 6f6e 652c 2032 2c20  me([1, None, 2, 
-00008480: 332c 204e 6f6e 652c 2035 2c20 365d 2c20  3, None, 5, 6], 
-00008490: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-000084a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-000084b0: 6563 7428 7661 7269 616e 6365 2863 6f6c  ect(variance(col
-000084c0: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-000084d0: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-000084e0: 4152 4941 4e43 4528 2241 2229 3d44 6563  ARIANCE("A")=Dec
-000084f0: 696d 616c 2827 342e 3330 3030 3030 2729  imal('4.300000')
-00008500: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-00008510: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00008520: 6174 655f 6461 7461 6672 616d 6528 5b4e  ate_dataframe([N
-00008530: 6f6e 652c 204e 6f6e 652c 204e 6f6e 655d  one, None, None]
-00008540: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00008550: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00008560: 656c 6563 7428 7661 7269 616e 6365 2863  elect(variance(c
-00008570: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
-00008580: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00008590: 2856 4152 4941 4e43 4528 2241 2229 3d4e  (VARIANCE("A")=N
-000085a0: 6f6e 6529 5d0a 0a20 2020 2020 2020 203e  one)]..        >
-000085b0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000085c0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000085d0: 285b 3432 5d2c 2073 6368 656d 613d 5b22  ([42], schema=["
-000085e0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-000085f0: 2064 662e 7365 6c65 6374 2876 6172 6961   df.select(varia
-00008600: 6e63 6528 636f 6c28 2261 2229 2929 2e63  nce(col("a"))).c
-00008610: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00008620: 205b 526f 7728 5641 5249 414e 4345 2822   [Row(VARIANCE("
-00008630: 4122 293d 4e6f 6e65 295d 0a0a 2020 2020  A")=None)]..    
-00008640: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00008650: 636f 6c5f 6966 5f73 7472 2865 2c20 2276  col_if_str(e, "v
-00008660: 6172 6961 6e63 6522 290a 2020 2020 7265  ariance").    re
-00008670: 7475 726e 2062 7569 6c74 696e 2822 7661  turn builtin("va
-00008680: 7269 616e 6365 2229 2863 290a 0a0a 6465  riance")(c)...de
-00008690: 6620 7661 725f 7361 6d70 2865 3a20 436f  f var_samp(e: Co
-000086a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-000086b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-000086c0: 7475 726e 7320 7468 6520 7361 6d70 6c65  turns the sample
-000086d0: 2076 6172 6961 6e63 6520 6f66 206e 6f6e   variance of non
-000086e0: 2d4e 554c 4c20 7265 636f 7264 7320 696e  -NULL records in
-000086f0: 2061 2067 726f 7570 2e20 4966 2061 6c6c   a group. If all
-00008700: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
-00008710: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
-00008720: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
-00008730: 7265 7475 726e 6564 2e20 466f 7220 6120  returned. For a 
-00008740: 7369 6e67 6c65 2072 6f77 2c20 4e55 4c4c  single row, NULL
-00008750: 2069 7320 7265 7475 726e 6564 2061 7320   is returned as 
-00008760: 7361 6d70 6c65 2076 6172 6961 6e63 652e  sample variance.
-00008770: 0a20 2020 2041 6c69 6173 206f 6620 3a66  .    Alias of :f
-00008780: 756e 633a 6076 6172 6961 6e63 6560 0a0a  unc:`variance`..
-00008790: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000087a0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000087b0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000087c0: 6174 6166 7261 6d65 285b 312c 202d 312c  ataframe([1, -1,
-000087d0: 2031 2c20 2d31 2c20 2d31 5d2c 2073 6368   1, -1, -1], sch
-000087e0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-000087f0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00008800: 2876 6172 5f73 616d 7028 636f 6c28 2261  (var_samp(col("a
-00008810: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00008820: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
-00008830: 414e 4345 2822 4122 293d 4465 6369 6d61  ANCE("A")=Decima
-00008840: 6c28 2731 2e32 3030 3030 3027 2929 5d0a  l('1.200000'))].
-00008850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00008860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00008870: 5f64 6174 6166 7261 6d65 285b 312c 204e  _dataframe([1, N
-00008880: 6f6e 652c 2032 2c20 332c 204e 6f6e 652c  one, 2, 3, None,
-00008890: 2035 2c20 365d 2c20 7363 6865 6d61 3d5b   5, 6], schema=[
-000088a0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-000088b0: 3e20 6466 2e73 656c 6563 7428 7661 725f  > df.select(var_
-000088c0: 7361 6d70 2863 6f6c 2822 6122 2929 292e  samp(col("a"))).
-000088d0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000088e0: 2020 5b52 6f77 2856 4152 4941 4e43 4528    [Row(VARIANCE(
-000088f0: 2241 2229 3d44 6563 696d 616c 2827 342e  "A")=Decimal('4.
-00008900: 3330 3030 3030 2729 295d 0a0a 2020 2020  300000'))]..    
-00008910: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00008920: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00008930: 6672 616d 6528 5b4e 6f6e 652c 204e 6f6e  frame([None, Non
-00008940: 652c 204e 6f6e 655d 2c20 7363 6865 6d61  e, None], schema
-00008950: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00008960: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
-00008970: 725f 7361 6d70 2863 6f6c 2822 6122 2929  r_samp(col("a"))
-00008980: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00008990: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
-000089a0: 4528 2241 2229 3d4e 6f6e 6529 5d0a 0a20  E("A")=None)].. 
-000089b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000089c0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000089d0: 6174 6166 7261 6d65 285b 3432 5d2c 2073  ataframe([42], s
-000089e0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-000089f0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00008a00: 6374 2876 6172 5f73 616d 7028 636f 6c28  ct(var_samp(col(
-00008a10: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-00008a20: 0a20 2020 2020 2020 205b 526f 7728 5641  .        [Row(VA
-00008a30: 5249 414e 4345 2822 4122 293d 4e6f 6e65  RIANCE("A")=None
-00008a40: 295d 0a0a 2020 2020 2222 220a 2020 2020  )]..    """.    
-00008a50: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00008a60: 7472 2865 2c20 2276 6172 5f73 616d 7022  tr(e, "var_samp"
-00008a70: 290a 2020 2020 7265 7475 726e 2076 6172  ).    return var
-00008a80: 6961 6e63 6528 6329 0a0a 0a64 6566 2076  iance(c)...def v
-00008a90: 6172 5f70 6f70 2865 3a20 436f 6c75 6d6e  ar_pop(e: Column
-00008aa0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00008ab0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00008ac0: 7320 7468 6520 706f 7075 6c61 7469 6f6e  s the population
-00008ad0: 2076 6172 6961 6e63 6520 6f66 206e 6f6e   variance of non
-00008ae0: 2d4e 554c 4c20 7265 636f 7264 7320 696e  -NULL records in
-00008af0: 2061 2067 726f 7570 2e20 4966 2061 6c6c   a group. If all
-00008b00: 2072 6563 6f72 6473 0a20 2020 2069 6e73   records.    ins
-00008b10: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
-00008b20: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
-00008b30: 7265 7475 726e 6564 2e20 5468 6520 706f  returned. The po
-00008b40: 7075 6c61 7469 6f6e 2076 6172 6961 6e63  pulation varianc
-00008b50: 6520 6f66 2061 2073 696e 676c 6520 726f  e of a single ro
-00008b60: 7720 6973 2030 2e30 2e0a 0a20 2020 2045  w is 0.0...    E
-00008b70: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00008b80: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00008b90: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00008ba0: 616d 6528 5b31 2c20 2d31 2c20 312c 202d  ame([1, -1, 1, -
-00008bb0: 312c 202d 315d 2c20 7363 6865 6d61 3d5b  1, -1], schema=[
-00008bc0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00008bd0: 3e20 6466 2e73 656c 6563 7428 7661 725f  > df.select(var_
-00008be0: 706f 7028 636f 6c28 2261 2229 2929 2e63  pop(col("a"))).c
-00008bf0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00008c00: 205b 526f 7728 5641 525f 504f 5028 2241   [Row(VAR_POP("A
-00008c10: 2229 3d44 6563 696d 616c 2827 302e 3936  ")=Decimal('0.96
-00008c20: 3030 3030 2729 295d 0a0a 2020 2020 2020  0000'))]..      
-00008c30: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00008c40: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00008c50: 616d 6528 5b31 2c20 4e6f 6e65 2c20 322c  ame([1, None, 2,
-00008c60: 2033 2c20 4e6f 6e65 2c20 352c 2036 5d2c   3, None, 5, 6],
-00008c70: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00008c80: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00008c90: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
-00008ca0: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00008cb0: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-00008cc0: 4152 5f50 4f50 2822 4122 293d 4465 6369  AR_POP("A")=Deci
-00008cd0: 6d61 6c28 2733 2e34 3430 3030 3027 2929  mal('3.440000'))
-00008ce0: 5d0a 0a20 2020 2020 2020 203e 3e3e 2064  ]..        >>> d
-00008cf0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00008d00: 7465 5f64 6174 6166 7261 6d65 285b 4e6f  te_dataframe([No
-00008d10: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c  ne, None, None],
-00008d20: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00008d30: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00008d40: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
-00008d50: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
-00008d60: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
-00008d70: 4152 5f50 4f50 2822 4122 293d 4e6f 6e65  AR_POP("A")=None
-00008d80: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-00008d90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00008da0: 6174 655f 6461 7461 6672 616d 6528 5b34  ate_dataframe([4
-00008db0: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
-00008dc0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00008dd0: 2e73 656c 6563 7428 7661 725f 706f 7028  .select(var_pop(
-00008de0: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
-00008df0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00008e00: 7728 5641 525f 504f 5028 2241 2229 3d44  w(VAR_POP("A")=D
-00008e10: 6563 696d 616c 2827 302e 3030 3030 3030  ecimal('0.000000
-00008e20: 2729 295d 0a0a 2020 2020 2222 220a 2020  '))]..    """.  
-00008e30: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00008e40: 5f73 7472 2865 2c20 2276 6172 5f70 6f70  _str(e, "var_pop
-00008e50: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00008e60: 696c 7469 6e28 2276 6172 5f70 6f70 2229  iltin("var_pop")
-00008e70: 2863 290a 0a0a 6465 6620 6170 7072 6f78  (c)...def approx
-00008e80: 5f70 6572 6365 6e74 696c 6528 636f 6c3a  _percentile(col:
-00008e90: 2043 6f6c 756d 6e4f 724e 616d 652c 2070   ColumnOrName, p
-00008ea0: 6572 6365 6e74 696c 653a 2066 6c6f 6174  ercentile: float
-00008eb0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00008ec0: 2022 2222 5265 7475 726e 7320 616e 2061   """Returns an a
-00008ed0: 7070 726f 7869 6d61 7465 6420 7661 6c75  pproximated valu
-00008ee0: 6520 666f 7220 7468 6520 6465 7369 7265  e for the desire
-00008ef0: 6420 7065 7263 656e 7469 6c65 2e20 5468  d percentile. Th
-00008f00: 6973 2066 756e 6374 696f 6e20 7573 6573  is function uses
-00008f10: 2074 6865 2074 2d44 6967 6573 7420 616c   the t-Digest al
-00008f20: 676f 7269 7468 6d2e 0a0a 2020 2020 4578  gorithm...    Ex
-00008f30: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00008f40: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00008f50: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00008f60: 6528 5b30 2c31 2c32 2c33 2c34 2c35 2c36  e([0,1,2,3,4,5,6
-00008f70: 2c37 2c38 2c39 5d2c 2073 6368 656d 613d  ,7,8,9], schema=
-00008f80: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-00008f90: 3e3e 2064 662e 7365 6c65 6374 2861 7070  >> df.select(app
-00008fa0: 726f 785f 7065 7263 656e 7469 6c65 2822  rox_percentile("
-00008fb0: 6122 2c20 302e 3529 2e61 6c69 6173 2822  a", 0.5).alias("
-00008fc0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00008fd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00008fe0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00008ff0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-00009000: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00009010: 2020 2020 2020 2020 7c34 2e35 2020 2020          |4.5    
-00009020: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00009030: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00009040: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00009050: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00009060: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-00009070: 2c20 2261 7070 726f 785f 7065 7263 656e  , "approx_percen
-00009080: 7469 6c65 2229 0a20 2020 2072 6574 7572  tile").    retur
-00009090: 6e20 6275 696c 7469 6e28 2261 7070 726f  n builtin("appro
-000090a0: 785f 7065 7263 656e 7469 6c65 2229 2863  x_percentile")(c
-000090b0: 2c20 6c69 7428 7065 7263 656e 7469 6c65  , lit(percentile
-000090c0: 2929 0a0a 0a64 6566 2061 7070 726f 785f  ))...def approx_
-000090d0: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
-000090e0: 756c 6174 6528 636f 6c3a 2043 6f6c 756d  ulate(col: Colum
-000090f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00009100: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00009110: 6e73 2074 6865 2069 6e74 6572 6e61 6c20  ns the internal 
-00009120: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
-00009130: 6620 7468 6520 742d 4469 6765 7374 2073  f the t-Digest s
-00009140: 7461 7465 2028 6173 2061 204a 534f 4e20  tate (as a JSON 
-00009150: 6f62 6a65 6374 2920 6174 2074 6865 2065  object) at the e
-00009160: 6e64 206f 6620 6167 6772 6567 6174 696f  nd of aggregatio
-00009170: 6e2e 0a20 2020 2054 6869 7320 6675 6e63  n..    This func
-00009180: 7469 6f6e 2075 7365 7320 7468 6520 742d  tion uses the t-
-00009190: 4469 6765 7374 2061 6c67 6f72 6974 686d  Digest algorithm
-000091a0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00001ba0: 7274 2073 7973 0a69 6d70 6f72 7420 7479  rt sys.import ty
+00001bb0: 7069 6e67 0a66 726f 6d20 7261 6e64 6f6d  ping.from random
+00001bc0: 2069 6d70 6f72 7420 7261 6e64 696e 740a   import randint.
+00001bd0: 6672 6f6d 2074 7970 6573 2069 6d70 6f72  from types impor
+00001be0: 7420 4d6f 6475 6c65 5479 7065 0a66 726f  t ModuleType.fro
+00001bf0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+00001c00: 4361 6c6c 6162 6c65 2c20 4469 6374 2c20  Callable, Dict, 
+00001c10: 4c69 7374 2c20 4f70 7469 6f6e 616c 2c20  List, Optional, 
+00001c20: 5475 706c 652c 2055 6e69 6f6e 2c20 6f76  Tuple, Union, ov
+00001c30: 6572 6c6f 6164 0a0a 696d 706f 7274 2073  erload..import s
+00001c40: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00001c50: 6b0a 696d 706f 7274 2073 6e6f 7766 6c61  k.import snowfla
+00001c60: 6b65 2e73 6e6f 7770 6172 6b2e 7461 626c  ke.snowpark.tabl
+00001c70: 655f 6675 6e63 7469 6f6e 0a66 726f 6d20  e_function.from 
+00001c80: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00001c90: 726b 2e5f 696e 7465 726e 616c 2e61 6e61  rk._internal.ana
+00001ca0: 6c79 7a65 722e 6578 7072 6573 7369 6f6e  lyzer.expression
+00001cb0: 2069 6d70 6f72 7420 280a 2020 2020 4361   import (.    Ca
+00001cc0: 7365 5768 656e 2c0a 2020 2020 4675 6e63  seWhen,.    Func
+00001cd0: 7469 6f6e 4578 7072 6573 7369 6f6e 2c0a  tionExpression,.
+00001ce0: 2020 2020 4c69 7374 4167 672c 0a20 2020      ListAgg,.   
+00001cf0: 204c 6974 6572 616c 2c0a 2020 2020 4d75   Literal,.    Mu
+00001d00: 6c74 6970 6c65 4578 7072 6573 7369 6f6e  ltipleExpression
+00001d10: 2c0a 2020 2020 5374 6172 2c0a 290a 6672  ,.    Star,.).fr
+00001d20: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00001d30: 7770 6172 6b2e 5f69 6e74 6572 6e61 6c2e  wpark._internal.
+00001d40: 616e 616c 797a 6572 2e75 6e61 7279 5f65  analyzer.unary_e
+00001d50: 7870 7265 7373 696f 6e20 696d 706f 7274  xpression import
+00001d60: 2041 6c69 6173 0a66 726f 6d20 736e 6f77   Alias.from snow
+00001d70: 666c 616b 652e 736e 6f77 7061 726b 2e5f  flake.snowpark._
+00001d80: 696e 7465 726e 616c 2e61 6e61 6c79 7a65  internal.analyze
+00001d90: 722e 7769 6e64 6f77 5f65 7870 7265 7373  r.window_express
+00001da0: 696f 6e20 696d 706f 7274 2028 0a20 2020  ion import (.   
+00001db0: 2046 6972 7374 5661 6c75 652c 0a20 2020   FirstValue,.   
+00001dc0: 204c 6167 2c0a 2020 2020 4c61 7374 5661   Lag,.    LastVa
+00001dd0: 6c75 652c 0a20 2020 204c 6561 642c 0a29  lue,.    Lead,.)
+00001de0: 0a66 726f 6d20 736e 6f77 666c 616b 652e  .from snowflake.
+00001df0: 736e 6f77 7061 726b 2e5f 696e 7465 726e  snowpark._intern
+00001e00: 616c 2e74 7970 655f 7574 696c 7320 696d  al.type_utils im
+00001e10: 706f 7274 2028 0a20 2020 2043 6f6c 756d  port (.    Colum
+00001e20: 6e4f 724c 6974 6572 616c 2c0a 2020 2020  nOrLiteral,.    
+00001e30: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
+00001e40: 7472 2c0a 2020 2020 436f 6c75 6d6e 4f72  tr,.    ColumnOr
+00001e50: 4e61 6d65 2c0a 2020 2020 436f 6c75 6d6e  Name,.    Column
+00001e60: 4f72 5371 6c45 7870 722c 0a20 2020 204c  OrSqlExpr,.    L
+00001e70: 6974 6572 616c 5479 7065 2c0a 290a 6672  iteralType,.).fr
+00001e80: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00001e90: 7770 6172 6b2e 5f69 6e74 6572 6e61 6c2e  wpark._internal.
+00001ea0: 7574 696c 7320 696d 706f 7274 2028 0a20  utils import (. 
+00001eb0: 2020 2070 6172 7365 5f70 6f73 6974 696f     parse_positio
+00001ec0: 6e61 6c5f 6172 6773 5f74 6f5f 6c69 7374  nal_args_to_list
+00001ed0: 2c0a 2020 2020 7661 6c69 6461 7465 5f6f  ,.    validate_o
+00001ee0: 626a 6563 745f 6e61 6d65 2c0a 290a 6672  bject_name,.).fr
+00001ef0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00001f00: 7770 6172 6b2e 636f 6c75 6d6e 2069 6d70  wpark.column imp
+00001f10: 6f72 7420 280a 2020 2020 4361 7365 4578  ort (.    CaseEx
+00001f20: 7072 2c0a 2020 2020 436f 6c75 6d6e 2c0a  pr,.    Column,.
+00001f30: 2020 2020 5f74 6f5f 636f 6c5f 6966 5f6c      _to_col_if_l
+00001f40: 6974 2c0a 2020 2020 5f74 6f5f 636f 6c5f  it,.    _to_col_
+00001f50: 6966 5f73 716c 5f65 7870 722c 0a20 2020  if_sql_expr,.   
+00001f60: 205f 746f 5f63 6f6c 5f69 665f 7374 722c   _to_col_if_str,
+00001f70: 0a20 2020 205f 746f 5f63 6f6c 5f69 665f  .    _to_col_if_
+00001f80: 7374 725f 6f72 5f69 6e74 2c0a 290a 6672  str_or_int,.).fr
+00001f90: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00001fa0: 7770 6172 6b2e 7374 6f72 6564 5f70 726f  wpark.stored_pro
+00001fb0: 6365 6475 7265 2069 6d70 6f72 7420 5374  cedure import St
+00001fc0: 6f72 6564 5072 6f63 6564 7572 650a 6672  oredProcedure.fr
+00001fd0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00001fe0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00001ff0: 7274 2044 6174 6154 7970 652c 2046 6c6f  rt DataType, Flo
+00002000: 6174 5479 7065 2c20 5374 7269 6e67 5479  atType, StringTy
+00002010: 7065 2c20 5374 7275 6374 5479 7065 0a66  pe, StructType.f
+00002020: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00002030: 6f77 7061 726b 2e75 6466 2069 6d70 6f72  owpark.udf impor
+00002040: 7420 5573 6572 4465 6669 6e65 6446 756e  t UserDefinedFun
+00002050: 6374 696f 6e0a 6672 6f6d 2073 6e6f 7766  ction.from snowf
+00002060: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7564  lake.snowpark.ud
+00002070: 7466 2069 6d70 6f72 7420 5573 6572 4465  tf import UserDe
+00002080: 6669 6e65 6454 6162 6c65 4675 6e63 7469  finedTableFuncti
+00002090: 6f6e 0a0a 2320 5079 7468 6f6e 2033 2e38  on..# Python 3.8
+000020a0: 206e 6565 6473 2074 6f20 7573 6520 7479   needs to use ty
+000020b0: 7069 6e67 2e49 7465 7261 626c 6520 6265  ping.Iterable be
+000020c0: 6361 7573 6520 636f 6c6c 6563 7469 6f6e  cause collection
+000020d0: 732e 6162 632e 4974 6572 6162 6c65 2069  s.abc.Iterable i
+000020e0: 7320 6e6f 7420 7375 6273 6372 6970 7461  s not subscripta
+000020f0: 626c 650a 2320 5079 7468 6f6e 2033 2e39  ble.# Python 3.9
+00002100: 2063 616e 2075 7365 2062 6f74 680a 2320   can use both.# 
+00002110: 5079 7468 6f6e 2033 2e31 3020 6e65 6564  Python 3.10 need
+00002120: 7320 746f 2075 7365 2063 6f6c 6c65 6374  s to use collect
+00002130: 696f 6e73 2e61 6263 2e49 7465 7261 626c  ions.abc.Iterabl
+00002140: 6520 6265 6361 7573 6520 7479 7069 6e67  e because typing
+00002150: 2e49 7465 7261 626c 6520 6973 2072 656d  .Iterable is rem
+00002160: 6f76 6564 0a69 6620 7379 732e 7665 7273  oved.if sys.vers
+00002170: 696f 6e5f 696e 666f 203c 3d20 2833 2c20  ion_info <= (3, 
+00002180: 3929 3a0a 2020 2020 6672 6f6d 2074 7970  9):.    from typ
+00002190: 696e 6720 696d 706f 7274 2049 7465 7261  ing import Itera
+000021a0: 626c 650a 656c 7365 3a0a 2020 2020 6672  ble.else:.    fr
+000021b0: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2e61  om collections.a
+000021c0: 6263 2069 6d70 6f72 7420 4974 6572 6162  bc import Iterab
+000021d0: 6c65 0a0a 0a40 6f76 6572 6c6f 6164 0a64  le...@overload.d
+000021e0: 6566 2063 6f6c 2863 6f6c 5f6e 616d 653a  ef col(col_name:
+000021f0: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
+00002200: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00002210: 7468 6520 3a63 6c61 7373 3a60 7e73 6e6f  the :class:`~sno
+00002220: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00002230: 436f 6c75 6d6e 6020 7769 7468 2074 6865  Column` with the
+00002240: 2073 7065 6369 6669 6564 206e 616d 652e   specified name.
+00002250: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00002260: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00002270: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
+00002280: 6c65 6374 2031 2061 7320 6122 290a 2020  lect 1 as a").  
+00002290: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000022a0: 6563 7428 636f 6c28 2261 2229 292e 636f  ect(col("a")).co
+000022b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000022c0: 5b52 6f77 2841 3d31 295d 0a20 2020 2022  [Row(A=1)].    "
+000022d0: 2222 0a20 2020 202e 2e2e 2020 2320 7072  "".    ...  # pr
+000022e0: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a0a  agma: no cover..
+000022f0: 0a40 6f76 6572 6c6f 6164 0a64 6566 2063  .@overload.def c
+00002300: 6f6c 2864 665f 616c 6961 733a 2073 7472  ol(df_alias: str
+00002310: 2c20 636f 6c5f 6e61 6d65 3a20 7374 7229  , col_name: str)
+00002320: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00002330: 2222 2252 6574 7572 6e73 2074 6865 203a  """Returns the :
+00002340: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00002350: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
+00002360: 6e60 2077 6974 6820 7468 6520 7370 6563  n` with the spec
+00002370: 6966 6965 6420 6461 7461 6672 616d 6520  ified dataframe 
+00002380: 616c 6961 7320 616e 6420 636f 6c75 6d6e  alias and column
+00002390: 206e 616d 652e 0a0a 2020 2020 4578 616d   name...    Exam
+000023a0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+000023b0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+000023c0: 716c 2822 7365 6c65 6374 2031 2061 7320  ql("select 1 as 
+000023d0: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
+000023e0: 6466 2e61 6c69 6173 2822 6466 2229 2e73  df.alias("df").s
+000023f0: 656c 6563 7428 636f 6c28 2264 6622 2c20  elect(col("df", 
+00002400: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
+00002410: 2020 2020 2020 2020 5b52 6f77 2841 3d31          [Row(A=1
+00002420: 295d 0a20 2020 2022 2222 0a20 2020 202e  )].    """.    .
+00002430: 2e2e 2020 2320 7072 6167 6d61 3a20 6e6f  ..  # pragma: no
+00002440: 2063 6f76 6572 0a0a 0a64 6566 2063 6f6c   cover...def col
+00002450: 286e 616d 6531 3a20 7374 722c 206e 616d  (name1: str, nam
+00002460: 6532 3a20 4f70 7469 6f6e 616c 5b73 7472  e2: Optional[str
+00002470: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
+00002480: 756d 6e3a 0a20 2020 2069 6620 6e61 6d65  umn:.    if name
+00002490: 3220 6973 204e 6f6e 653a 0a20 2020 2020  2 is None:.     
+000024a0: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
+000024b0: 286e 616d 6531 290a 2020 2020 656c 7365  (name1).    else
+000024c0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000024d0: 2043 6f6c 756d 6e28 6e61 6d65 312c 206e   Column(name1, n
+000024e0: 616d 6532 290a 0a0a 406f 7665 726c 6f61  ame2)...@overloa
+000024f0: 640a 6465 6620 636f 6c75 6d6e 2863 6f6c  d.def column(col
+00002500: 5f6e 616d 653a 2073 7472 2920 2d3e 2043  _name: str) -> C
+00002510: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00002520: 7475 726e 7320 6120 3a63 6c61 7373 3a60  turns a :class:`
+00002530: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
+00002540: 6172 6b2e 436f 6c75 6d6e 6020 7769 7468  ark.Column` with
+00002550: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
+00002560: 616d 652e 2041 6c69 6173 2066 6f72 2063  ame. Alias for c
+00002570: 6f6c 2e0a 0a20 2020 2045 7861 6d70 6c65  ol...    Example
+00002580: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+00002590: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
+000025a0: 2273 656c 6563 7420 3120 6173 2061 2229  "select 1 as a")
+000025b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000025c0: 7365 6c65 6374 2863 6f6c 756d 6e28 2261  select(column("a
+000025d0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+000025e0: 2020 2020 2020 5b52 6f77 2841 3d31 295d        [Row(A=1)]
+000025f0: 0a20 2020 2022 2222 0a20 2020 202e 2e2e  .    """.    ...
+00002600: 2020 2320 7072 6167 6d61 3a20 6e6f 2063    # pragma: no c
+00002610: 6f76 6572 0a0a 0a40 6f76 6572 6c6f 6164  over...@overload
+00002620: 0a64 6566 2063 6f6c 756d 6e28 6466 5f61  .def column(df_a
+00002630: 6c69 6173 3a20 7374 722c 2063 6f6c 5f6e  lias: str, col_n
+00002640: 616d 653a 2073 7472 2920 2d3e 2043 6f6c  ame: str) -> Col
+00002650: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00002660: 726e 7320 6120 3a63 6c61 7373 3a60 7e73  rns a :class:`~s
+00002670: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00002680: 6b2e 436f 6c75 6d6e 6020 7769 7468 2074  k.Column` with t
+00002690: 6865 2073 7065 6369 6669 6564 206e 616d  he specified nam
+000026a0: 6520 616e 6420 6461 7461 6672 616d 6520  e and dataframe 
+000026b0: 616c 6961 7320 6e61 6d65 2e20 416c 6961  alias name. Alia
+000026c0: 7320 666f 7220 636f 6c2e 0a0a 2020 2020  s for col...    
+000026d0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+000026e0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000026f0: 6f6e 2e73 716c 2822 7365 6c65 6374 2031  on.sql("select 1
+00002700: 2061 7320 6122 290a 2020 2020 2020 2020   as a").        
+00002710: 3e3e 3e20 6466 2e61 6c69 6173 2822 6466  >>> df.alias("df
+00002720: 2229 2e73 656c 6563 7428 636f 6c75 6d6e  ").select(column
+00002730: 2822 6466 222c 2022 6122 2929 2e63 6f6c  ("df", "a")).col
+00002740: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00002750: 526f 7728 413d 3129 5d0a 2020 2020 2222  Row(A=1)].    ""
+00002760: 220a 2020 2020 2e2e 2e20 2023 2070 7261  ".    ...  # pra
+00002770: 676d 613a 206e 6f20 636f 7665 720a 0a0a  gma: no cover...
+00002780: 6465 6620 636f 6c75 6d6e 286e 616d 6531  def column(name1
+00002790: 3a20 7374 722c 206e 616d 6532 3a20 4f70  : str, name2: Op
+000027a0: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+000027b0: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+000027c0: 2020 2069 6620 6e61 6d65 3220 6973 204e     if name2 is N
+000027d0: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
+000027e0: 7572 6e20 436f 6c75 6d6e 286e 616d 6531  urn Column(name1
+000027f0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00002800: 2020 2020 7265 7475 726e 2043 6f6c 756d      return Colum
+00002810: 6e28 6e61 6d65 312c 206e 616d 6532 290a  n(name1, name2).
+00002820: 0a0a 6465 6620 6c69 7428 6c69 7465 7261  ..def lit(litera
+00002830: 6c3a 204c 6974 6572 616c 5479 7065 2920  l: LiteralType) 
+00002840: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00002850: 2222 0a20 2020 2043 7265 6174 6573 2061  "".    Creates a
+00002860: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+00002870: 616b 652e 736e 6f77 7061 726b 2e43 6f6c  ake.snowpark.Col
+00002880: 756d 6e60 2065 7870 7265 7373 696f 6e20  umn` expression 
+00002890: 666f 7220 6120 6c69 7465 7261 6c20 7661  for a literal va
+000028a0: 6c75 652e 0a20 2020 2049 7420 7375 7070  lue..    It supp
+000028b0: 6f72 7473 2062 6173 6963 2050 7974 686f  orts basic Pytho
+000028c0: 6e20 6461 7461 2074 7970 6573 2c20 696e  n data types, in
+000028d0: 636c 7564 696e 6720 6060 696e 7460 602c  cluding ``int``,
+000028e0: 2060 6066 6c6f 6174 6060 2c20 6060 7374   ``float``, ``st
+000028f0: 7260 602c 0a20 2020 2060 6062 6f6f 6c60  r``,.    ``bool`
+00002900: 602c 2060 6062 7974 6573 6060 2c20 6060  `, ``bytes``, ``
+00002910: 6279 7465 6172 7261 7960 602c 2060 6064  bytearray``, ``d
+00002920: 6174 6574 696d 652e 7469 6d65 6060 2c20  atetime.time``, 
+00002930: 6060 6461 7465 7469 6d65 2e64 6174 6560  ``datetime.date`
+00002940: 602c 0a20 2020 2060 6064 6174 6574 696d  `,.    ``datetim
+00002950: 652e 6461 7465 7469 6d65 6060 2061 6e64  e.datetime`` and
+00002960: 2060 6064 6563 696d 616c 2e44 6563 696d   ``decimal.Decim
+00002970: 616c 6060 2e20 416c 736f 2c20 6974 2073  al``. Also, it s
+00002980: 7570 706f 7274 7320 5079 7468 6f6e 2073  upports Python s
+00002990: 7472 7563 7475 7265 6420 6461 7461 2074  tructured data t
+000029a0: 7970 6573 2c0a 2020 2020 696e 636c 7564  ypes,.    includ
+000029b0: 696e 6720 6060 6c69 7374 6060 2c20 6060  ing ``list``, ``
+000029c0: 7475 706c 6560 6020 616e 6420 6060 6469  tuple`` and ``di
+000029d0: 6374 6060 2c20 6275 7420 7468 6973 2063  ct``, but this c
+000029e0: 6f6e 7461 696e 6572 206d 7573 740a 2020  ontainer must.  
+000029f0: 2020 6265 204a 534f 4e20 7365 7269 616c    be JSON serial
+00002a00: 697a 6162 6c65 2e0a 0a20 2020 2045 7861  izable...    Exa
+00002a10: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00002a20: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+00002a30: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+00002a40: 636f 6c75 6d6e 7320 3d20 5b6c 6974 2831  columns = [lit(1
+00002a50: 292c 206c 6974 2822 3122 292c 206c 6974  ), lit("1"), lit
+00002a60: 2831 2e30 292c 206c 6974 2854 7275 6529  (1.0), lit(True)
+00002a70: 2c20 6c69 7428 6227 736e 6f77 2729 2c20  , lit(b'snow'), 
+00002a80: 6c69 7428 6461 7465 7469 6d65 2e64 6174  lit(datetime.dat
+00002a90: 6528 3230 3233 2c20 322c 2032 2929 2c20  e(2023, 2, 2)), 
+00002aa0: 6c69 7428 5b31 2c20 325d 292c 206c 6974  lit([1, 2]), lit
+00002ab0: 287b 2273 6e6f 7722 3a20 2266 6c61 6b65  ({"snow": "flake
+00002ac0: 227d 295d 0a20 2020 2020 2020 203e 3e3e  "})].        >>>
+00002ad0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00002ae0: 6461 7461 6672 616d 6528 5b5b 5d5d 292e  dataframe([[]]).
+00002af0: 7365 6c65 6374 285b 632e 6173 5f28 7374  select([c.as_(st
+00002b00: 7228 6929 2920 666f 7220 692c 2063 2069  r(i)) for i, c i
+00002b10: 6e20 656e 756d 6572 6174 6528 636f 6c75  n enumerate(colu
+00002b20: 6d6e 7329 5d29 2e73 686f 7728 290a 2020  mns)]).show().  
+00002b30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00002b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002b60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002b70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002b80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00002b90: 2020 2020 2020 7c22 3022 2020 7c22 3122        |"0"  |"1"
+00002ba0: 2020 7c22 3222 2020 7c22 3322 2020 207c    |"2"  |"3"   |
+00002bb0: 2234 2220 2020 2020 2020 2020 2020 2020  "4"             
+00002bc0: 2020 2020 7c22 3522 2020 2020 2020 2020      |"5"        
+00002bd0: 207c 2236 2220 2020 7c22 3722 2020 2020   |"6"   |"7"    
+00002be0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00002bf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00002c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00002c50: 2020 2020 2020 7c31 2020 2020 7c31 2020        |1    |1  
+00002c60: 2020 7c31 2e30 2020 7c54 7275 6520 207c    |1.0  |True  |
+00002c70: 6279 7465 6172 7261 7928 6227 736e 6f77  bytearray(b'snow
+00002c80: 2729 2020 7c32 3032 332d 3032 2d30 3220  ')  |2023-02-02 
+00002c90: 207c 5b20 2020 2020 7c7b 2020 2020 2020   |[     |{      
+00002ca0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00002cb0: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
+00002cc0: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
+00002cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ce0: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
+00002cf0: 207c 2020 312c 2020 7c20 2022 736e 6f77   |  1,  |  "snow
+00002d00: 223a 2022 666c 616b 6522 2020 7c0a 2020  ": "flake"  |.  
+00002d10: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
+00002d20: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
+00002d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d40: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
+00002d50: 207c 2020 3220 2020 7c7d 2020 2020 2020   |  2   |}      
+00002d60: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00002d70: 2020 2020 2020 7c20 2020 2020 7c20 2020        |     |   
+00002d80: 2020 7c20 2020 2020 7c20 2020 2020 207c    |     |      |
+00002d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002da0: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
+00002db0: 207c 5d20 2020 2020 7c20 2020 2020 2020   |]     |       
+00002dc0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+00002dd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00002de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00002e30: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00002e40: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
+00002e50: 7475 726e 206c 6974 6572 616c 2069 6620  turn literal if 
+00002e60: 6973 696e 7374 616e 6365 286c 6974 6572  isinstance(liter
+00002e70: 616c 2c20 436f 6c75 6d6e 2920 656c 7365  al, Column) else
+00002e80: 2043 6f6c 756d 6e28 4c69 7465 7261 6c28   Column(Literal(
+00002e90: 6c69 7465 7261 6c29 290a 0a0a 6465 6620  literal))...def 
+00002ea0: 7371 6c5f 6578 7072 2873 716c 3a20 7374  sql_expr(sql: st
+00002eb0: 7229 202d 3e20 436f 6c75 6d6e 3a0a 2020  r) -> Column:.  
+00002ec0: 2020 2222 2243 7265 6174 6573 2061 203a    """Creates a :
+00002ed0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00002ee0: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
+00002ef0: 6e60 2065 7870 7265 7373 696f 6e20 6672  n` expression fr
+00002f00: 6f6d 2072 6177 2053 514c 2074 6578 742e  om raw SQL text.
+00002f10: 0a20 2020 204e 6f74 6520 7468 6174 2074  .    Note that t
+00002f20: 6865 2066 756e 6374 696f 6e20 646f 6573  he function does
+00002f30: 206e 6f74 2069 6e74 6572 7072 6574 206f   not interpret o
+00002f40: 7220 6368 6563 6b20 7468 6520 5351 4c20  r check the SQL 
+00002f50: 7465 7874 2e0a 0a20 2020 2045 7861 6d70  text...    Examp
+00002f60: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00002f70: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00002f80: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00002f90: 5b31 2c20 325d 2c20 5b33 2c20 345d 5d2c  [1, 2], [3, 4]],
+00002fa0: 2073 6368 656d 613d 5b22 4122 2c20 2242   schema=["A", "B
+00002fb0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00002fc0: 6466 2e66 696c 7465 7228 2261 203e 2031  df.filter("a > 1
+00002fd0: 2229 2e63 6f6c 6c65 6374 2829 2020 2320  ").collect()  # 
+00002fe0: 7573 6520 5351 4c20 6578 7072 6573 7369  use SQL expressi
+00002ff0: 6f6e 0a20 2020 2020 2020 205b 526f 7728  on.        [Row(
+00003000: 413d 332c 2042 3d34 295d 0a20 2020 2022  A=3, B=4)].    "
+00003010: 2222 0a20 2020 2072 6574 7572 6e20 436f  "".    return Co
+00003020: 6c75 6d6e 2e5f 6578 7072 2873 716c 290a  lumn._expr(sql).
+00003030: 0a0a 6465 6620 6375 7272 656e 745f 7365  ..def current_se
+00003040: 7373 696f 6e28 2920 2d3e 2043 6f6c 756d  ssion() -> Colum
+00003050: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00003060: 6574 7572 6e73 2061 2075 6e69 7175 6520  eturns a unique 
+00003070: 7379 7374 656d 2069 6465 6e74 6966 6965  system identifie
+00003080: 7220 666f 7220 7468 6520 536e 6f77 666c  r for the Snowfl
+00003090: 616b 6520 7365 7373 696f 6e20 636f 7272  ake session corr
+000030a0: 6573 706f 6e64 696e 6720 746f 2074 6865  esponding to the
+000030b0: 2070 7265 7365 6e74 2063 6f6e 6e65 6374   present connect
+000030c0: 696f 6e2e 0a20 2020 2054 6869 7320 7769  ion..    This wi
+000030d0: 6c6c 2067 656e 6572 616c 6c79 2062 6520  ll generally be 
+000030e0: 6120 7379 7374 656d 2d67 656e 6572 6174  a system-generat
+000030f0: 6564 2061 6c70 6861 6e75 6d65 7269 6320  ed alphanumeric 
+00003100: 7374 7269 6e67 2e20 4974 2069 7320 4e4f  string. It is NO
+00003110: 5420 6465 7269 7665 6420 6672 6f6d 2074  T derived from t
+00003120: 6865 2075 7365 7220 6e61 6d65 206f 7220  he user name or 
+00003130: 7573 6572 2061 6363 6f75 6e74 2e0a 0a20  user account... 
+00003140: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+00003150: 2020 2020 3e3e 3e20 2320 5265 7475 726e      >>> # Return
+00003160: 2072 6573 756c 7420 6973 2074 6965 6420   result is tied 
+00003170: 746f 2073 6573 7369 6f6e 2c20 736f 2077  to session, so w
+00003180: 6520 6f6e 6c79 2074 6573 7420 6966 2074  e only test if t
+00003190: 6865 2072 6573 756c 7420 6578 6973 7473  he result exists
+000031a0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+000031b0: 756c 7420 3d20 7365 7373 696f 6e2e 6372  ult = session.cr
+000031c0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000031d0: 315d 292e 7365 6c65 6374 2863 7572 7265  1]).select(curre
+000031e0: 6e74 5f73 6573 7369 6f6e 2829 292e 636f  nt_session()).co
+000031f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00003200: 3e3e 3e20 6173 7365 7274 2072 6573 756c  >>> assert resul
+00003210: 745b 305d 5b27 4355 5252 454e 545f 5345  t[0]['CURRENT_SE
+00003220: 5353 494f 4e28 2927 5d20 6973 206e 6f74  SSION()'] is not
+00003230: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
+00003240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00003250: 2822 6375 7272 656e 745f 7365 7373 696f  ("current_sessio
+00003260: 6e22 2928 290a 0a0a 6465 6620 6375 7272  n")()...def curr
+00003270: 656e 745f 7374 6174 656d 656e 7428 2920  ent_statement() 
+00003280: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00003290: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000032a0: 6865 2053 514c 2074 6578 7420 6f66 2074  he SQL text of t
+000032b0: 6865 2073 7461 7465 6d65 6e74 2074 6861  he statement tha
+000032c0: 7420 6973 2063 7572 7265 6e74 6c79 2065  t is currently e
+000032d0: 7865 6375 7469 6e67 2e0a 0a20 2020 2045  xecuting...    E
+000032e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+000032f0: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
+00003300: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
+00003310: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
+00003320: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
+00003330: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
+00003340: 2020 2020 203e 3e3e 2073 6573 7369 6f6e       >>> session
+00003350: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00003360: 6528 5b31 5d29 2e73 656c 6563 7428 6375  e([1]).select(cu
+00003370: 7272 656e 745f 7374 6174 656d 656e 7428  rrent_statement(
+00003380: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00003390: 2020 2020 205b 526f 7728 4355 5252 454e       [Row(CURREN
+000033a0: 545f 5354 4154 454d 454e 5428 293d 2753  T_STATEMENT()='S
+000033b0: 454c 4543 5420 6375 7272 656e 745f 7374  ELECT current_st
+000033c0: 6174 656d 656e 7428 2920 4652 4f4d 2028  atement() FROM (
+000033d0: 2053 454c 4543 5420 225f 3122 2046 524f   SELECT "_1" FRO
+000033e0: 4d20 2820 5345 4c45 4354 2024 3120 4153  M ( SELECT $1 AS
+000033f0: 2022 5f31 2220 4652 4f4d 2020 5641 4c55   "_1" FROM  VALU
+00003400: 4553 2028 3120 3a3a 2049 4e54 2929 2927  ES (1 :: INT)))'
+00003410: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+00003420: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+00003430: 7572 7265 6e74 5f73 7461 7465 6d65 6e74  urrent_statement
+00003440: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
+00003450: 6e74 5f75 7365 7228 2920 2d3e 2043 6f6c  nt_user() -> Col
+00003460: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00003470: 2052 6574 7572 6e73 2074 6865 206e 616d   Returns the nam
+00003480: 6520 6f66 2074 6865 2075 7365 7220 6375  e of the user cu
+00003490: 7272 656e 746c 7920 6c6f 6767 6564 2069  rrently logged i
+000034a0: 6e74 6f20 7468 6520 7379 7374 656d 2e0a  nto the system..
+000034b0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+000034c0: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
+000034d0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
+000034e0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
+000034f0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
+00003500: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
+00003510: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
+00003520: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
+00003530: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00003540: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
+00003550: 7265 6e74 5f75 7365 7228 2929 2e63 6f6c  rent_user()).col
+00003560: 6c65 6374 2829 0a20 2020 2020 2020 203e  lect().        >
+00003570: 3e3e 2061 7373 6572 7420 7265 7375 6c74  >> assert result
+00003580: 5b30 5d5b 2743 5552 5245 4e54 5f55 5345  [0]['CURRENT_USE
+00003590: 5228 2927 5d20 6973 206e 6f74 204e 6f6e  R()'] is not Non
+000035a0: 650a 2020 2020 2222 220a 2020 2020 7265  e.    """.    re
+000035b0: 7475 726e 2062 7569 6c74 696e 2822 6375  turn builtin("cu
+000035c0: 7272 656e 745f 7573 6572 2229 2829 0a0a  rrent_user")()..
+000035d0: 0a64 6566 2063 7572 7265 6e74 5f76 6572  .def current_ver
+000035e0: 7369 6f6e 2829 202d 3e20 436f 6c75 6d6e  sion() -> Column
+000035f0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00003600: 7475 726e 7320 7468 6520 6375 7272 656e  turns the curren
+00003610: 7420 536e 6f77 666c 616b 6520 7665 7273  t Snowflake vers
+00003620: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
+00003630: 653a 0a20 2020 2020 2020 203e 3e3e 2023  e:.        >>> #
+00003640: 2052 6574 7572 6e20 7265 7375 6c74 2069   Return result i
+00003650: 7320 7469 6564 2074 6f20 7365 7373 696f  s tied to sessio
+00003660: 6e2c 2073 6f20 7765 206f 6e6c 7920 7465  n, so we only te
+00003670: 7374 2069 6620 7468 6520 7265 7375 6c74  st if the result
+00003680: 2065 7869 7374 730a 2020 2020 2020 2020   exists.        
+00003690: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
+000036a0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000036b0: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
+000036c0: 7428 6375 7272 656e 745f 7665 7273 696f  t(current_versio
+000036d0: 6e28 2929 2e63 6f6c 6c65 6374 2829 0a20  n()).collect(). 
+000036e0: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+000036f0: 7420 7265 7375 6c74 5b30 5d5b 2743 5552  t result[0]['CUR
+00003700: 5245 4e54 5f56 4552 5349 4f4e 2829 275d  RENT_VERSION()']
+00003710: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00003720: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
+00003730: 6275 696c 7469 6e28 2263 7572 7265 6e74  builtin("current
+00003740: 5f76 6572 7369 6f6e 2229 2829 0a0a 0a64  _version")()...d
+00003750: 6566 2063 7572 7265 6e74 5f77 6172 6568  ef current_wareh
+00003760: 6f75 7365 2829 202d 3e20 436f 6c75 6d6e  ouse() -> Column
+00003770: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00003780: 7475 726e 7320 7468 6520 6e61 6d65 206f  turns the name o
+00003790: 6620 7468 6520 7761 7265 686f 7573 6520  f the warehouse 
+000037a0: 696e 2075 7365 2066 6f72 2074 6865 2063  in use for the c
+000037b0: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
+000037c0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+000037d0: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
+000037e0: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
+000037f0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
+00003800: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
+00003810: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
+00003820: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
+00003830: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
+00003840: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00003850: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
+00003860: 7265 6e74 5f77 6172 6568 6f75 7365 2829  rent_warehouse()
+00003870: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00003880: 2020 2020 3e3e 3e20 6173 7365 7274 2072      >>> assert r
+00003890: 6573 756c 745b 305d 5b27 4355 5252 454e  esult[0]['CURREN
+000038a0: 545f 5741 5245 484f 5553 4528 2927 5d20  T_WAREHOUSE()'] 
+000038b0: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+000038c0: 2222 220a 2020 2020 7265 7475 726e 2062  """.    return b
+000038d0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
+000038e0: 7761 7265 686f 7573 6522 2928 290a 0a0a  warehouse")()...
+000038f0: 6465 6620 6375 7272 656e 745f 6461 7461  def current_data
+00003900: 6261 7365 2829 202d 3e20 436f 6c75 6d6e  base() -> Column
+00003910: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+00003920: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
+00003930: 2064 6174 6162 6173 6520 696e 2075 7365   database in use
+00003940: 2066 6f72 2074 6865 2063 7572 7265 6e74   for the current
+00003950: 2073 6573 7369 6f6e 2e0a 0a20 2020 2045   session...    E
+00003960: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00003970: 3e3e 3e20 2320 5265 7475 726e 2072 6573  >>> # Return res
+00003980: 756c 7420 6973 2074 6965 6420 746f 2073  ult is tied to s
+00003990: 6573 7369 6f6e 2c20 736f 2077 6520 6f6e  ession, so we on
+000039a0: 6c79 2074 6573 7420 6966 2074 6865 2072  ly test if the r
+000039b0: 6573 756c 7420 6578 6973 7473 0a20 2020  esult exists.   
+000039c0: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
+000039d0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000039e0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
+000039f0: 7365 6c65 6374 2863 7572 7265 6e74 5f64  select(current_d
+00003a00: 6174 6162 6173 6528 2929 2e63 6f6c 6c65  atabase()).colle
+00003a10: 6374 2829 0a20 2020 2020 2020 203e 3e3e  ct().        >>>
+00003a20: 2061 7373 6572 7420 7265 7375 6c74 5b30   assert result[0
+00003a30: 5d5b 2743 5552 5245 4e54 5f44 4154 4142  ]['CURRENT_DATAB
+00003a40: 4153 4528 2927 5d20 6973 206e 6f74 204e  ASE()'] is not N
+00003a50: 6f6e 650a 2020 2020 2222 220a 2020 2020  one.    """.    
+00003a60: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00003a70: 6375 7272 656e 745f 6461 7461 6261 7365  current_database
+00003a80: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
+00003a90: 6e74 5f72 6f6c 6528 2920 2d3e 2043 6f6c  nt_role() -> Col
+00003aa0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00003ab0: 726e 7320 7468 6520 6e61 6d65 206f 6620  rns the name of 
+00003ac0: 7468 6520 726f 6c65 2069 6e20 7573 6520  the role in use 
+00003ad0: 666f 7220 7468 6520 6375 7272 656e 7420  for the current 
+00003ae0: 7365 7373 696f 6e2e 0a0a 2020 2020 4578  session...    Ex
+00003af0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00003b00: 3e3e 2023 2052 6574 7572 6e20 7265 7375  >> # Return resu
+00003b10: 6c74 2069 7320 7469 6564 2074 6f20 7365  lt is tied to se
+00003b20: 7373 696f 6e2c 2073 6f20 7765 206f 6e6c  ssion, so we onl
+00003b30: 7920 7465 7374 2069 6620 7468 6520 7265  y test if the re
+00003b40: 7375 6c74 2065 7869 7374 730a 2020 2020  sult exists.    
+00003b50: 2020 2020 3e3e 3e20 7265 7375 6c74 203d      >>> result =
+00003b60: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00003b70: 6461 7461 6672 616d 6528 5b31 5d29 2e73  dataframe([1]).s
+00003b80: 656c 6563 7428 6375 7272 656e 745f 726f  elect(current_ro
+00003b90: 6c65 2829 292e 636f 6c6c 6563 7428 290a  le()).collect().
+00003ba0: 2020 2020 2020 2020 3e3e 3e20 6173 7365          >>> asse
+00003bb0: 7274 2072 6573 756c 745b 305d 5b27 4355  rt result[0]['CU
+00003bc0: 5252 454e 545f 524f 4c45 2829 275d 2069  RRENT_ROLE()'] i
+00003bd0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2022  s not None.    "
+00003be0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00003bf0: 696c 7469 6e28 2263 7572 7265 6e74 5f72  iltin("current_r
+00003c00: 6f6c 6522 2928 290a 0a0a 6465 6620 6375  ole")()...def cu
+00003c10: 7272 656e 745f 7363 6865 6d61 2829 202d  rrent_schema() -
+00003c20: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00003c30: 2252 6574 7572 6e73 2074 6865 206e 616d  "Returns the nam
+00003c40: 6520 6f66 2074 6865 2073 6368 656d 6120  e of the schema 
+00003c50: 696e 2075 7365 2066 6f72 2074 6865 2063  in use for the c
+00003c60: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
+00003c70: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+00003c80: 2020 2020 2020 3e3e 3e20 2320 5265 7475        >>> # Retu
+00003c90: 726e 2072 6573 756c 7420 6973 2074 6965  rn result is tie
+00003ca0: 6420 746f 2073 6573 7369 6f6e 2c20 736f  d to session, so
+00003cb0: 2077 6520 6f6e 6c79 2074 6573 7420 6966   we only test if
+00003cc0: 2074 6865 2072 6573 756c 7420 6578 6973   the result exis
+00003cd0: 7473 0a20 2020 2020 2020 203e 3e3e 2072  ts.        >>> r
+00003ce0: 6573 756c 7420 3d20 7365 7373 696f 6e2e  esult = session.
+00003cf0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00003d00: 285b 315d 292e 7365 6c65 6374 2863 7572  ([1]).select(cur
+00003d10: 7265 6e74 5f73 6368 656d 6128 2929 2e63  rent_schema()).c
+00003d20: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00003d30: 203e 3e3e 2061 7373 6572 7420 7265 7375   >>> assert resu
+00003d40: 6c74 5b30 5d5b 2743 5552 5245 4e54 5f53  lt[0]['CURRENT_S
+00003d50: 4348 454d 4128 2927 5d20 6973 206e 6f74  CHEMA()'] is not
+00003d60: 204e 6f6e 650a 2020 2020 2222 220a 2020   None.    """.  
+00003d70: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00003d80: 2822 6375 7272 656e 745f 7363 6865 6d61  ("current_schema
+00003d90: 2229 2829 0a0a 0a64 6566 2063 7572 7265  ")()...def curre
+00003da0: 6e74 5f73 6368 656d 6173 2829 202d 3e20  nt_schemas() -> 
+00003db0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00003dc0: 6574 7572 6e73 2061 6374 6976 6520 7365  eturns active se
+00003dd0: 6172 6368 2070 6174 6820 7363 6865 6d61  arch path schema
+00003de0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+00003df0: 0a20 2020 2020 2020 203e 3e3e 2023 2052  .        >>> # R
+00003e00: 6574 7572 6e20 7265 7375 6c74 2069 7320  eturn result is 
+00003e10: 7469 6564 2074 6f20 7365 7373 696f 6e2c  tied to session,
+00003e20: 2073 6f20 7765 206f 6e6c 7920 7465 7374   so we only test
+00003e30: 2069 6620 7468 6520 7265 7375 6c74 2065   if the result e
+00003e40: 7869 7374 730a 2020 2020 2020 2020 3e3e  xists.        >>
+00003e50: 3e20 7265 7375 6c74 203d 2073 6573 7369  > result = sessi
+00003e60: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00003e70: 616d 6528 5b31 5d29 2e73 656c 6563 7428  ame([1]).select(
+00003e80: 6375 7272 656e 745f 7363 6865 6d61 7328  current_schemas(
+00003e90: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00003ea0: 2020 2020 203e 3e3e 2061 7373 6572 7420       >>> assert 
+00003eb0: 7265 7375 6c74 5b30 5d5b 2743 5552 5245  result[0]['CURRE
+00003ec0: 4e54 5f53 4348 454d 4153 2829 275d 2069  NT_SCHEMAS()'] i
+00003ed0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2022  s not None.    "
+00003ee0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00003ef0: 696c 7469 6e28 2263 7572 7265 6e74 5f73  iltin("current_s
+00003f00: 6368 656d 6173 2229 2829 0a0a 0a64 6566  chemas")()...def
+00003f10: 2063 7572 7265 6e74 5f72 6567 696f 6e28   current_region(
+00003f20: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00003f30: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00003f40: 6e61 6d65 206f 6620 7468 6520 7265 6769  name of the regi
+00003f50: 6f6e 2066 6f72 2074 6865 2061 6363 6f75  on for the accou
+00003f60: 6e74 2077 6865 7265 2074 6865 2063 7572  nt where the cur
+00003f70: 7265 6e74 2075 7365 7220 6973 206c 6f67  rent user is log
+00003f80: 6765 6420 696e 2e0a 0a20 2020 2045 7861  ged in...    Exa
+00003f90: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00003fa0: 3e20 2320 5265 7475 726e 2072 6573 756c  > # Return resul
+00003fb0: 7420 6973 2074 6965 6420 746f 2073 6573  t is tied to ses
+00003fc0: 7369 6f6e 2c20 736f 2077 6520 6f6e 6c79  sion, so we only
+00003fd0: 2074 6573 7420 6966 2074 6865 2072 6573   test if the res
+00003fe0: 756c 7420 6578 6973 7473 0a20 2020 2020  ult exists.     
+00003ff0: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
+00004000: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00004010: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
+00004020: 6c65 6374 2863 7572 7265 6e74 5f72 6567  lect(current_reg
+00004030: 696f 6e28 2929 2e63 6f6c 6c65 6374 2829  ion()).collect()
+00004040: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
+00004050: 6572 7420 7265 7375 6c74 5b30 5d5b 2743  ert result[0]['C
+00004060: 5552 5245 4e54 5f52 4547 494f 4e28 2927  URRENT_REGION()'
+00004070: 5d20 6973 206e 6f74 204e 6f6e 650a 2020  ] is not None.  
+00004080: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00004090: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
+000040a0: 745f 7265 6769 6f6e 2229 2829 0a0a 0a64  t_region")()...d
+000040b0: 6566 2063 7572 7265 6e74 5f61 7661 696c  ef current_avail
+000040c0: 6162 6c65 5f72 6f6c 6573 2829 202d 3e20  able_roles() -> 
+000040d0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+000040e0: 6574 7572 6e73 2061 204a 534f 4e20 7374  eturns a JSON st
+000040f0: 7269 6e67 2074 6861 7420 6c69 7374 7320  ring that lists 
+00004100: 616c 6c20 726f 6c65 7320 6772 616e 7465  all roles grante
+00004110: 6420 746f 2074 6865 2063 7572 7265 6e74  d to the current
+00004120: 2075 7365 722e 0a0a 2020 2020 4578 616d   user...    Exam
+00004130: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00004140: 2023 2052 6574 7572 6e20 7265 7375 6c74   # Return result
+00004150: 2069 7320 7469 6564 2074 6f20 7365 7373   is tied to sess
+00004160: 696f 6e2c 2073 6f20 7765 206f 6e6c 7920  ion, so we only 
+00004170: 7465 7374 2069 6620 7468 6520 7265 7375  test if the resu
+00004180: 6c74 2065 7869 7374 730a 2020 2020 2020  lt exists.      
+00004190: 2020 3e3e 3e20 7265 7375 6c74 203d 2073    >>> result = s
+000041a0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+000041b0: 7461 6672 616d 6528 5b31 5d29 2e73 656c  taframe([1]).sel
+000041c0: 6563 7428 6375 7272 656e 745f 6176 6169  ect(current_avai
+000041d0: 6c61 626c 655f 726f 6c65 7328 2929 2e63  lable_roles()).c
+000041e0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000041f0: 203e 3e3e 2061 7373 6572 7420 7265 7375   >>> assert resu
+00004200: 6c74 5b30 5d5b 2743 5552 5245 4e54 5f41  lt[0]['CURRENT_A
+00004210: 5641 494c 4142 4c45 5f52 4f4c 4553 2829  VAILABLE_ROLES()
+00004220: 275d 2069 7320 6e6f 7420 4e6f 6e65 0a20  '] is not None. 
+00004230: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+00004240: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
+00004250: 6e74 5f61 7661 696c 6162 6c65 5f72 6f6c  nt_available_rol
+00004260: 6573 2229 2829 0a0a 0a64 6566 2061 6464  es")()...def add
+00004270: 5f6d 6f6e 7468 7328 0a20 2020 2064 6174  _months(.    dat
+00004280: 655f 6f72 5f74 696d 6573 7461 6d70 3a20  e_or_timestamp: 
+00004290: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6e75  ColumnOrName, nu
+000042a0: 6d62 6572 5f6f 665f 6d6f 6e74 6873 3a20  mber_of_months: 
+000042b0: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
+000042c0: 745d 0a29 202d 3e20 436f 6c75 6d6e 3a0a  t].) -> Column:.
+000042d0: 2020 2020 2222 2241 6464 7320 6f72 2073      """Adds or s
+000042e0: 7562 7472 6163 7473 2061 2073 7065 6369  ubtracts a speci
+000042f0: 6669 6564 206e 756d 6265 7220 6f66 206d  fied number of m
+00004300: 6f6e 7468 7320 746f 2061 2064 6174 6520  onths to a date 
+00004310: 6f72 2074 696d 6573 7461 6d70 2c20 7072  or timestamp, pr
+00004320: 6573 6572 7669 6e67 2074 6865 2065 6e64  eserving the end
+00004330: 2d6f 662d 6d6f 6e74 6820 696e 666f 726d  -of-month inform
+00004340: 6174 696f 6e2e 0a0a 2020 2020 4578 616d  ation...    Exam
+00004350: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00004360: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
+00004370: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00004380: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00004390: 5f64 6174 6166 7261 6d65 285b 6461 7465  _dataframe([date
+000043a0: 7469 6d65 2e64 6174 6528 3230 3232 2c20  time.date(2022, 
+000043b0: 342c 2036 295d 2c20 7363 6865 6d61 3d5b  4, 6)], schema=[
+000043c0: 2264 225d 290a 2020 2020 2020 2020 3e3e  "d"]).        >>
+000043d0: 3e20 6466 2e73 656c 6563 7428 6164 645f  > df.select(add_
+000043e0: 6d6f 6e74 6873 2822 6422 2c20 3429 292e  months("d", 4)).
+000043f0: 636f 6c6c 6563 7428 295b 305d 5b30 5d0a  collect()[0][0].
+00004400: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+00004410: 2e64 6174 6528 3230 3232 2c20 382c 2036  .date(2022, 8, 6
+00004420: 290a 2020 2020 2222 220a 2020 2020 6320  ).    """.    c 
+00004430: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00004440: 2864 6174 655f 6f72 5f74 696d 6573 7461  (date_or_timesta
+00004450: 6d70 2c20 2261 6464 5f6d 6f6e 7468 7322  mp, "add_months"
+00004460: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00004470: 6c74 696e 2822 6164 645f 6d6f 6e74 6873  ltin("add_months
+00004480: 2229 2863 2c20 6e75 6d62 6572 5f6f 665f  ")(c, number_of_
+00004490: 6d6f 6e74 6873 290a 0a0a 6465 6620 616e  months)...def an
+000044a0: 795f 7661 6c75 6528 653a 2043 6f6c 756d  y_value(e: Colum
+000044b0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000044c0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+000044d0: 6e73 2061 206e 6f6e 2d64 6574 6572 6d69  ns a non-determi
+000044e0: 6e69 7374 6963 2061 6e79 2076 616c 7565  nistic any value
+000044f0: 2066 6f72 2074 6865 2073 7065 6369 6669   for the specifi
+00004500: 6564 2063 6f6c 756d 6e2e 0a20 2020 2054  ed column..    T
+00004510: 6869 7320 6973 2061 6e20 6167 6772 6567  his is an aggreg
+00004520: 6174 6520 616e 6420 7769 6e64 6f77 2066  ate and window f
+00004530: 756e 6374 696f 6e2e 0a0a 2020 2020 4578  unction...    Ex
+00004540: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00004550: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00004560: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00004570: 285b 5b31 2c20 325d 2c20 5b33 2c20 345d  ([[1, 2], [3, 4]
+00004580: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+00004590: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+000045a0: 3e20 7265 7375 6c74 203d 2064 662e 7365  > result = df.se
+000045b0: 6c65 6374 2861 6e79 5f76 616c 7565 2822  lect(any_value("
+000045c0: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
+000045d0: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
+000045e0: 7420 6c65 6e28 7265 7375 6c74 2920 3d3d  t len(result) ==
+000045f0: 2031 2020 2320 6e6f 6e2d 6465 7465 726d   1  # non-determ
+00004600: 696e 6973 7469 6320 7661 6c75 6520 696e  inistic value in
+00004610: 2072 6573 756c 742e 0a20 2020 2022 2222   result..    """
+00004620: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00004630: 5f69 665f 7374 7228 652c 2022 616e 795f  _if_str(e, "any_
+00004640: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
+00004650: 726e 2063 616c 6c5f 6275 696c 7469 6e28  rn call_builtin(
+00004660: 2261 6e79 5f76 616c 7565 222c 2063 290a  "any_value", c).
+00004670: 0a0a 6465 6620 6269 746e 6f74 2865 3a20  ..def bitnot(e: 
+00004680: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00004690: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000046a0: 5265 7475 726e 7320 7468 6520 6269 7477  Returns the bitw
+000046b0: 6973 6520 6e65 6761 7469 6f6e 206f 6620  ise negation of 
+000046c0: 6120 6e75 6d65 7269 6320 6578 7072 6573  a numeric expres
+000046d0: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
+000046e0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+000046f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00004700: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+00004710: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00004720: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00004730: 7365 6c65 6374 2862 6974 6e6f 7428 2261  select(bitnot("a
+00004740: 2229 292e 636f 6c6c 6563 7428 295b 305d  ")).collect()[0]
+00004750: 5b30 5d0a 2020 2020 2020 2020 2d32 0a20  [0].        -2. 
+00004760: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00004770: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00004780: 2022 6269 746e 6f74 2229 0a20 2020 2072   "bitnot").    r
+00004790: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
+000047a0: 696e 2822 6269 746e 6f74 222c 2063 290a  in("bitnot", c).
+000047b0: 0a0a 6465 6620 6269 7473 6869 6674 6c65  ..def bitshiftle
+000047c0: 6674 2874 6f5f 7368 6966 745f 636f 6c75  ft(to_shift_colu
+000047d0: 6d6e 3a20 436f 6c75 6d6e 4f72 4e61 6d65  mn: ColumnOrName
+000047e0: 2c20 6e3a 2055 6e69 6f6e 5b43 6f6c 756d  , n: Union[Colum
+000047f0: 6e2c 2069 6e74 5d29 202d 3e20 436f 6c75  n, int]) -> Colu
+00004800: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00004810: 6e73 2074 6865 2062 6974 7769 7365 206e  ns the bitwise n
+00004820: 6567 6174 696f 6e20 6f66 2061 206e 756d  egation of a num
+00004830: 6572 6963 2065 7870 7265 7373 696f 6e2e  eric expression.
+00004840: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
+00004850: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00004860: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00004870: 6174 6166 7261 6d65 285b 325d 2c20 7363  ataframe([2], sc
+00004880: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00004890: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000048a0: 7428 6269 7473 6869 6674 6c65 6674 2822  t(bitshiftleft("
+000048b0: 6122 2c20 3129 292e 636f 6c6c 6563 7428  a", 1)).collect(
+000048c0: 295b 305d 5b30 5d0a 2020 2020 2020 2020  )[0][0].        
+000048d0: 340a 2020 2020 2222 220a 2020 2020 6320  4.    """.    c 
+000048e0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+000048f0: 2874 6f5f 7368 6966 745f 636f 6c75 6d6e  (to_shift_column
+00004900: 2c20 2262 6974 7368 6966 746c 6566 7422  , "bitshiftleft"
+00004910: 290a 2020 2020 7265 7475 726e 2063 616c  ).    return cal
+00004920: 6c5f 6275 696c 7469 6e28 2262 6974 7368  l_builtin("bitsh
+00004930: 6966 746c 6566 7422 2c20 632c 206e 290a  iftleft", c, n).
+00004940: 0a0a 6465 6620 6269 7473 6869 6674 7269  ..def bitshiftri
+00004950: 6768 7428 746f 5f73 6869 6674 5f63 6f6c  ght(to_shift_col
+00004960: 756d 6e3a 2043 6f6c 756d 6e4f 724e 616d  umn: ColumnOrNam
+00004970: 652c 206e 3a20 556e 696f 6e5b 436f 6c75  e, n: Union[Colu
+00004980: 6d6e 2c20 696e 745d 2920 2d3e 2043 6f6c  mn, int]) -> Col
+00004990: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+000049a0: 726e 7320 7468 6520 6269 7477 6973 6520  rns the bitwise 
+000049b0: 6e65 6761 7469 6f6e 206f 6620 6120 6e75  negation of a nu
+000049c0: 6d65 7269 6320 6578 7072 6573 7369 6f6e  meric expression
+000049d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
+000049e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000049f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00004a00: 6461 7461 6672 616d 6528 5b32 5d2c 2073  dataframe([2], s
+00004a10: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00004a20: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00004a30: 6374 2862 6974 7368 6966 7472 6967 6874  ct(bitshiftright
+00004a40: 2822 6122 2c20 3129 292e 636f 6c6c 6563  ("a", 1)).collec
+00004a50: 7428 295b 305d 5b30 5d0a 2020 2020 2020  t()[0][0].      
+00004a60: 2020 310a 2020 2020 2222 220a 2020 2020    1.    """.    
+00004a70: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00004a80: 7472 2874 6f5f 7368 6966 745f 636f 6c75  tr(to_shift_colu
+00004a90: 6d6e 2c20 2262 6974 7368 6966 7472 6967  mn, "bitshiftrig
+00004aa0: 6874 2229 0a20 2020 2072 6574 7572 6e20  ht").    return 
+00004ab0: 6361 6c6c 5f62 7569 6c74 696e 2822 6269  call_builtin("bi
+00004ac0: 7473 6869 6674 7269 6768 7422 2c20 632c  tshiftright", c,
+00004ad0: 206e 290a 0a0a 6465 6620 6272 6f75 6e64   n)...def bround
+00004ae0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+00004af0: 6d65 2c20 7363 616c 653a 2055 6e69 6f6e  me, scale: Union
+00004b00: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 202d  [Column, int]) -
+00004b10: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00004b20: 220a 2020 2020 526f 756e 6473 2074 6865  ".    Rounds the
+00004b30: 206e 756d 6265 7220 7573 696e 6720 6048   number using `H
+00004b40: 414c 465f 544f 5f45 5645 4e60 206f 7074  ALF_TO_EVEN` opt
+00004b50: 696f 6e2e 2054 6865 2060 4841 4c46 5f54  ion. The `HALF_T
+00004b60: 4f5f 4556 454e 6020 726f 756e 6469 6e67  O_EVEN` rounding
+00004b70: 206d 6f64 6520 726f 756e 6473 2074 6865   mode rounds the
+00004b80: 2067 6976 656e 2064 6563 696d 616c 2076   given decimal v
+00004b90: 616c 7565 2074 6f20 7468 6520 7370 6563  alue to the spec
+00004ba0: 6966 6965 6420 7363 616c 6520 286e 756d  ified scale (num
+00004bb0: 6265 7220 6f66 2064 6563 696d 616c 2070  ber of decimal p
+00004bc0: 6c61 6365 7329 2061 7320 666f 6c6c 6f77  laces) as follow
+00004bd0: 733a 0a20 2020 202a 2049 6620 7363 616c  s:.    * If scal
+00004be0: 6520 6973 2067 7265 6174 6572 2074 6861  e is greater tha
+00004bf0: 6e20 6f72 2065 7175 616c 2074 6f20 302c  n or equal to 0,
+00004c00: 2072 6f75 6e64 2074 6f20 7468 6520 7370   round to the sp
+00004c10: 6563 6966 6965 6420 6e75 6d62 6572 206f  ecified number o
+00004c20: 6620 6465 6369 6d61 6c20 706c 6163 6573  f decimal places
+00004c30: 2075 7369 6e67 2068 616c 662d 6576 656e   using half-even
+00004c40: 2072 6f75 6e64 696e 672e 2054 6869 7320   rounding. This 
+00004c50: 726f 756e 6473 2074 6f77 6172 6473 2074  rounds towards t
+00004c60: 6865 206e 6561 7265 7374 2076 616c 7565  he nearest value
+00004c70: 2077 6974 6820 7469 6573 2028 6571 7561   with ties (equa
+00004c80: 6c6c 7920 636c 6f73 6520 7661 6c75 6573  lly close values
+00004c90: 2920 726f 756e 6469 6e67 2074 6f20 7468  ) rounding to th
+00004ca0: 6520 6e65 6172 6573 7420 6576 656e 2064  e nearest even d
+00004cb0: 6967 6974 2e0a 2020 2020 2a20 4966 2073  igit..    * If s
+00004cc0: 6361 6c65 2069 7320 6c65 7373 2074 6861  cale is less tha
+00004cd0: 6e20 302c 2072 6f75 6e64 2074 6f20 7468  n 0, round to th
+00004ce0: 6520 696e 7465 6772 616c 2070 6172 7420  e integral part 
+00004cf0: 6f66 2074 6865 2064 6563 696d 616c 2e20  of the decimal. 
+00004d00: 5468 6973 2072 6f75 6e64 7320 746f 7761  This rounds towa
+00004d10: 7264 7320 3020 616e 6420 7472 756e 6361  rds 0 and trunca
+00004d20: 7465 7320 7468 6520 6465 6369 6d61 6c20  tes the decimal 
+00004d30: 706c 6163 6573 2e0a 0a20 2020 204e 6f74  places...    Not
+00004d40: 653a 0a0a 2020 2020 2020 2020 312e 2054  e:..        1. T
+00004d50: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
+00004d60: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+00004d70: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
+00004d80: 6520 6064 6174 6120 7479 7065 7320 666f  e `data types fo
+00004d90: 7220 6120 6669 7865 642d 706f 696e 7420  r a fixed-point 
+00004da0: 6e75 6d62 6572 0a20 2020 2020 2020 203c  number.        <
+00004db0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+00004dc0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+00004dd0: 6c2d 7265 6665 7265 6e63 652f 6461 7461  l-reference/data
+00004de0: 2d74 7970 6573 2d6e 756d 6572 6963 2e68  -types-numeric.h
+00004df0: 746d 6c23 6c61 6265 6c2d 6461 7461 2d74  tml#label-data-t
+00004e00: 7970 6573 2d66 6f72 2d66 6978 6564 2d70  ypes-for-fixed-p
+00004e10: 6f69 6e74 2d6e 756d 6265 7273 3e60 5f2e  oint-numbers>`_.
+00004e20: 0a0a 2020 2020 2020 2020 322e 2044 6174  ..        2. Dat
+00004e30: 6120 7479 7065 7320 666f 7220 666c 6f61  a types for floa
+00004e40: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
+00004e50: 7273 2028 652e 672e 2046 4c4f 4154 2920  rs (e.g. FLOAT) 
+00004e60: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
+00004e70: 6420 7769 7468 2074 6869 7320 6172 6775  d with this argu
+00004e80: 6d65 6e74 2e0a 0a20 2020 2020 2020 2033  ment...        3
+00004e90: 2e20 4966 2074 6865 2065 7870 7265 7373  . If the express
+00004ea0: 696f 6e20 6461 7461 2074 7970 6520 6973  ion data type is
+00004eb0: 206e 6f74 2073 7570 706f 7274 6564 2c20   not supported, 
+00004ec0: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+00004ed0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
+00004ee0: 7920 6361 7374 2074 6f20 6465 6369 6d61  y cast to decima
+00004ef0: 6c20 6265 666f 7265 2063 616c 6c69 6e67  l before calling
+00004f00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
+00004f10: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00004f20: 7274 2064 6563 696d 616c 0a20 2020 2020  rt decimal.     
+00004f30: 2020 203e 3e3e 2064 6174 6120 3d20 5b28     >>> data = [(
+00004f40: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
+00004f50: 312e 3233 3529 292c 2864 6563 696d 616c  1.235)),(decimal
+00004f60: 2e44 6563 696d 616c 2833 2e35 2929 5d0a  .Decimal(3.5))].
+00004f70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00004f80: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
+00004f90: 6174 6146 7261 6d65 2864 6174 612c 205b  ataFrame(data, [
+00004fa0: 2276 616c 7565 225d 290a 2020 2020 2020  "value"]).      
+00004fb0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00004fc0: 6272 6f75 6e64 2827 5641 4c55 4527 2c31  bround('VALUE',1
+00004fd0: 292e 616c 6961 7328 2256 414c 5545 2229  ).alias("VALUE")
+00004fe0: 292e 7368 6f77 2829 2023 2052 6f75 6e64  ).show() # Round
+00004ff0: 7320 746f 2031 2064 6563 696d 616c 2070  s to 1 decimal p
+00005000: 6c61 6365 0a20 2020 2020 2020 202d 2d2d  lace.        ---
+00005010: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00005020: 207c 2256 414c 5545 2220 207c 0a20 2020   |"VALUE"  |.   
+00005030: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00005040: 0a20 2020 2020 2020 207c 312e 3220 2020  .        |1.2   
+00005050: 2020 207c 0a20 2020 2020 2020 207c 332e     |.        |3.
+00005060: 3520 2020 2020 207c 0a20 2020 2020 2020  5      |.       
+00005070: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020   -----------.   
+00005080: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00005090: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000050a0: 7365 6c65 6374 2862 726f 756e 6428 2756  select(bround('V
+000050b0: 414c 5545 272c 3029 2e61 6c69 6173 2822  ALUE',0).alias("
+000050c0: 5641 4c55 4522 2929 2e73 686f 7728 2920  VALUE")).show() 
+000050d0: 2320 526f 756e 6473 2074 6f20 3120 6465  # Rounds to 1 de
+000050e0: 6369 6d61 6c20 706c 6163 650a 2020 2020  cimal place.    
+000050f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a      -----------.
+00005100: 2020 2020 2020 2020 7c22 5641 4c55 4522          |"VALUE"
+00005110: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00005120: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00005130: 7c31 2020 2020 2020 2020 7c0a 2020 2020  |1        |.    
+00005140: 2020 2020 7c34 2020 2020 2020 2020 7c0a      |4        |.
+00005150: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00005160: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00005170: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00005180: 2020 2020 636f 6c20 3d20 5f74 6f5f 636f      col = _to_co
+00005190: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2262  l_if_str(col, "b
+000051a0: 726f 756e 6422 290a 2020 2020 7363 616c  round").    scal
+000051b0: 6520 3d20 5f74 6f5f 636f 6c5f 6966 5f6c  e = _to_col_if_l
+000051c0: 6974 2873 6361 6c65 2c20 2262 726f 756e  it(scale, "broun
+000051d0: 6422 290a 2020 2020 7265 7475 726e 2063  d").    return c
+000051e0: 616c 6c5f 6275 696c 7469 6e28 2252 4f55  all_builtin("ROU
+000051f0: 4e44 222c 2063 6f6c 2c20 7363 616c 652c  ND", col, scale,
+00005200: 206c 6974 2822 4841 4c46 5f54 4f5f 4556   lit("HALF_TO_EV
+00005210: 454e 2229 290a 0a0a 6465 6620 636f 6e76  EN"))...def conv
+00005220: 6572 745f 7469 6d65 7a6f 6e65 280a 2020  ert_timezone(.  
+00005230: 2020 7461 7267 6574 5f74 696d 657a 6f6e    target_timezon
+00005240: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
+00005250: 0a20 2020 2073 6f75 7263 655f 7469 6d65  .    source_time
+00005260: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
+00005270: 2020 2020 736f 7572 6365 5f74 696d 657a      source_timez
+00005280: 6f6e 653a 204f 7074 696f 6e61 6c5b 436f  one: Optional[Co
+00005290: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
+000052a0: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
+000052b0: 0a20 2020 2022 2222 436f 6e76 6572 7473  .    """Converts
+000052c0: 2074 6865 2067 6976 656e 2073 6f75 7263   the given sourc
+000052d0: 655f 7469 6d65 2074 6f20 7468 6520 7461  e_time to the ta
+000052e0: 7267 6574 2074 696d 657a 6f6e 652e 0a0a  rget timezone...
+000052f0: 2020 2020 466f 7220 7469 6d65 7a6f 6e65      For timezone
+00005300: 2069 6e66 6f72 6d61 7469 6f6e 2c20 7265   information, re
+00005310: 6665 7220 746f 2074 6865 2060 536e 6f77  fer to the `Snow
+00005320: 666c 616b 6520 5351 4c20 636f 6e76 6572  flake SQL conver
+00005330: 745f 7469 6d65 7a6f 6e65 206e 6f74 6573  t_timezone notes
+00005340: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+00005350: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+00005360: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
+00005370: 6e63 7469 6f6e 732f 636f 6e76 6572 745f  nctions/convert_
+00005380: 7469 6d65 7a6f 6e65 2e68 746d 6c23 7573  timezone.html#us
+00005390: 6167 652d 6e6f 7465 733e 605f 0a0a 2020  age-notes>`_..  
+000053a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000053b0: 2020 2020 2020 2020 7461 7267 6574 5f74          target_t
+000053c0: 696d 657a 6f6e 653a 2054 6865 2074 696d  imezone: The tim
+000053d0: 6520 7a6f 6e65 2074 6f20 7768 6963 6820  e zone to which 
+000053e0: 7468 6520 696e 7075 7420 7469 6d65 7374  the input timest
+000053f0: 616d 7020 7368 6f75 6c64 2062 6520 636f  amp should be co
+00005400: 6e76 6572 7465 642e 3d0a 2020 2020 2020  nverted.=.      
+00005410: 2020 2020 2020 736f 7572 6365 5f74 696d        source_tim
+00005420: 653a 2054 6865 2074 696d 6573 7461 6d70  e: The timestamp
+00005430: 2074 6f20 636f 6e76 6572 742e 2057 6865   to convert. Whe
+00005440: 6e20 6974 2773 2061 2054 494d 4553 5441  n it's a TIMESTA
+00005450: 4d50 5f4c 545a 2c20 7573 6520 6060 4e6f  MP_LTZ, use ``No
+00005460: 6e65 6060 2066 6f72 2060 6073 6f75 7263  ne`` for ``sourc
+00005470: 655f 7469 6d65 7a6f 6e65 6060 2e0a 2020  e_timezone``..  
+00005480: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00005490: 5f74 696d 657a 6f6e 653a 2054 6865 2074  _timezone: The t
+000054a0: 696d 6520 7a6f 6e65 2066 6f72 2074 6865  ime zone for the
+000054b0: 2060 6073 6f75 7263 655f 7469 6d65 6060   ``source_time``
+000054c0: 2e20 5265 7175 6972 6564 2066 6f72 2074  . Required for t
+000054d0: 696d 6573 7461 6d70 7320 7769 7468 206e  imestamps with n
+000054e0: 6f20 7469 6d65 207a 6f6e 6520 2869 2e65  o time zone (i.e
+000054f0: 2e20 5449 4d45 5354 414d 505f 4e54 5a29  . TIMESTAMP_NTZ)
+00005500: 2e20 5573 6520 6060 4e6f 6e65 6060 2069  . Use ``None`` i
+00005510: 6620 7468 6520 7469 6d65 7374 616d 7073  f the timestamps
+00005520: 2068 6176 6520 6120 7469 6d65 207a 6f6e   have a time zon
+00005530: 6520 2869 2e65 2e20 5449 4d45 5354 414d  e (i.e. TIMESTAM
+00005540: 505f 4c54 5a29 2e20 4465 6661 756c 7420  P_LTZ). Default 
+00005550: 6973 2060 604e 6f6e 6560 602e 0a0a 2020  is ``None``...  
+00005560: 2020 2020 2020 4e6f 7465 3a0a 2020 2020        Note:.    
+00005570: 2020 2020 2020 2020 5468 6520 7365 7175          The sequ
+00005580: 656e 6365 206f 6620 7468 6520 3320 7061  ence of the 3 pa
+00005590: 7261 6d73 2069 7320 6469 6666 6572 656e  rams is differen
+000055a0: 7420 6672 6f6d 2074 6865 2053 514c 2066  t from the SQL f
+000055b0: 756e 6374 696f 6e2c 2077 6869 6368 2074  unction, which t
+000055c0: 776f 206f 7665 726c 6f61 6473 3a0a 0a20  wo overloads:.. 
+000055d0: 2020 2020 2020 2020 2020 2020 202d 2060               - `
+000055e0: 6043 4f4e 5645 5254 5f54 494d 455a 4f4e  `CONVERT_TIMEZON
+000055f0: 4528 203c 736f 7572 6365 5f74 7a3e 202c  E( <source_tz> ,
+00005600: 203c 7461 7267 6574 5f74 7a3e 202c 203c   <target_tz> , <
+00005610: 736f 7572 6365 5f74 696d 6573 7461 6d70  source_timestamp
+00005620: 5f6e 747a 3e20 2960 600a 2020 2020 2020  _ntz> )``.      
+00005630: 2020 2020 2020 2020 2d20 6060 434f 4e56          - ``CONV
+00005640: 4552 545f 5449 4d45 5a4f 4e45 2820 3c74  ERT_TIMEZONE( <t
+00005650: 6172 6765 745f 747a 3e20 2c20 3c73 6f75  arget_tz> , <sou
+00005660: 7263 655f 7469 6d65 7374 616d 703e 2029  rce_timestamp> )
+00005670: 6060 0a0a 2020 2020 2020 2020 2020 2020  ``..            
+00005680: 5468 6520 6669 7273 7420 7061 7261 6d65  The first parame
+00005690: 7465 7220 6060 736f 7572 6365 5f74 7a60  ter ``source_tz`
+000056a0: 6020 6973 206f 7074 696f 6e61 6c2e 2042  ` is optional. B
+000056b0: 7574 2069 6e20 5079 7468 6f6e 2061 6e20  ut in Python an 
+000056c0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+000056d0: 7420 7368 6f75 6c64 6e27 7420 6265 2070  t shouldn't be p
+000056e0: 6c61 6365 6420 6174 2074 6865 2066 6972  laced at the fir
+000056f0: 7374 2e0a 2020 2020 2020 2020 2020 2020  st..            
+00005700: 536f 2060 6073 6f75 7263 655f 7469 6d65  So ``source_time
+00005710: 7a6f 6e65 6060 2069 7320 6166 7465 7220  zone`` is after 
+00005720: 6060 736f 7572 6365 5f74 696d 6560 602e  ``source_time``.
+00005730: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00005740: 653a 0a20 2020 2020 2020 2020 2020 203e  e:.            >
+00005750: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00005760: 6d65 0a20 2020 2020 2020 2020 2020 203e  me.            >
+00005770: 3e3e 2066 726f 6d20 6461 7465 7574 696c  >> from dateutil
+00005780: 2069 6d70 6f72 7420 747a 0a20 2020 2020   import tz.     
+00005790: 2020 2020 2020 203e 3e3e 2064 6174 6574         >>> datet
+000057a0: 696d 655f 7769 7468 5f74 7a20 3d20 6461  ime_with_tz = da
+000057b0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+000057c0: 3230 3232 2c20 342c 2036 2c20 392c 2030  2022, 4, 6, 9, 0
+000057d0: 2c20 302c 2074 7a69 6e66 6f3d 747a 2e74  , 0, tzinfo=tz.t
+000057e0: 7a6f 6666 7365 7428 226d 797a 6f6e 6522  zoffset("myzone"
+000057f0: 2c20 2d33 3630 302a 3729 290a 2020 2020  , -3600*7)).    
+00005800: 2020 2020 2020 2020 3e3e 3e20 6461 7465          >>> date
+00005810: 7469 6d65 5f77 6974 685f 6e6f 5f74 7a20  time_with_no_tz 
+00005820: 3d20 6461 7465 7469 6d65 2e64 6174 6574  = datetime.datet
+00005830: 696d 6528 3230 3232 2c20 342c 2036 2c20  ime(2022, 4, 6, 
+00005840: 392c 2030 2c20 3029 0a20 2020 2020 2020  9, 0, 0).       
+00005850: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00005860: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00005870: 6166 7261 6d65 285b 5b64 6174 6574 696d  aframe([[datetim
+00005880: 655f 7769 7468 5f74 7a2c 2064 6174 6574  e_with_tz, datet
+00005890: 696d 655f 7769 7468 5f6e 6f5f 747a 5d5d  ime_with_no_tz]]
+000058a0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+000058b0: 6222 5d29 0a20 2020 2020 2020 2020 2020  b"]).           
+000058c0: 203e 3e3e 2072 6573 756c 7420 3d20 6466   >>> result = df
+000058d0: 2e73 656c 6563 7428 636f 6e76 6572 745f  .select(convert_
+000058e0: 7469 6d65 7a6f 6e65 286c 6974 2822 5554  timezone(lit("UT
+000058f0: 4322 292c 2063 6f6c 2822 6122 2929 2c20  C"), col("a")), 
+00005900: 636f 6e76 6572 745f 7469 6d65 7a6f 6e65  convert_timezone
+00005910: 286c 6974 2822 5554 4322 292c 2063 6f6c  (lit("UTC"), col
+00005920: 2822 6222 292c 206c 6974 2822 4173 6961  ("b"), lit("Asia
+00005930: 2f53 6861 6e67 6861 6922 2929 292e 636f  /Shanghai"))).co
+00005940: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00005950: 2020 2020 3e3e 3e20 7265 7375 6c74 5b30      >>> result[0
+00005960: 5d5b 305d 0a20 2020 2020 2020 2020 2020  ][0].           
+00005970: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00005980: 6d65 2832 3032 322c 2034 2c20 362c 2031  me(2022, 4, 6, 1
+00005990: 362c 2030 2c20 747a 696e 666f 3d3c 5554  6, 0, tzinfo=<UT
+000059a0: 433e 290a 2020 2020 2020 2020 2020 2020  C>).            
+000059b0: 3e3e 3e20 7265 7375 6c74 5b30 5d5b 315d  >>> result[0][1]
+000059c0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000059d0: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+000059e0: 3032 322c 2034 2c20 362c 2031 2c20 3029  022, 4, 6, 1, 0)
+000059f0: 0a20 2020 2022 2222 0a20 2020 2073 6f75  .    """.    sou
+00005a00: 7263 655f 747a 203d 2028 0a20 2020 2020  rce_tz = (.     
+00005a10: 2020 205f 746f 5f63 6f6c 5f69 665f 7374     _to_col_if_st
+00005a20: 7228 736f 7572 6365 5f74 696d 657a 6f6e  r(source_timezon
+00005a30: 652c 2022 636f 6e76 6572 745f 7469 6d65  e, "convert_time
+00005a40: 7a6f 6e65 2229 0a20 2020 2020 2020 2069  zone").        i
+00005a50: 6620 736f 7572 6365 5f74 696d 657a 6f6e  f source_timezon
+00005a60: 6520 6973 206e 6f74 204e 6f6e 650a 2020  e is not None.  
+00005a70: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
+00005a80: 2020 2020 290a 2020 2020 7461 7267 6574      ).    target
+00005a90: 5f74 7a20 3d20 5f74 6f5f 636f 6c5f 6966  _tz = _to_col_if
+00005aa0: 5f73 7472 2874 6172 6765 745f 7469 6d65  _str(target_time
+00005ab0: 7a6f 6e65 2c20 2263 6f6e 7665 7274 5f74  zone, "convert_t
+00005ac0: 696d 657a 6f6e 6522 290a 2020 2020 736f  imezone").    so
+00005ad0: 7572 6365 5f74 696d 655f 746f 5f63 6f6e  urce_time_to_con
+00005ae0: 7665 7274 203d 205f 746f 5f63 6f6c 5f69  vert = _to_col_i
+00005af0: 665f 7374 7228 736f 7572 6365 5f74 696d  f_str(source_tim
+00005b00: 652c 2022 636f 6e76 6572 745f 7469 6d65  e, "convert_time
+00005b10: 7a6f 6e65 2229 0a0a 2020 2020 6966 2073  zone")..    if s
+00005b20: 6f75 7263 655f 7469 6d65 7a6f 6e65 2069  ource_timezone i
+00005b30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00005b40: 7265 7475 726e 2063 616c 6c5f 6275 696c  return call_buil
+00005b50: 7469 6e28 2263 6f6e 7665 7274 5f74 696d  tin("convert_tim
+00005b60: 657a 6f6e 6522 2c20 7461 7267 6574 5f74  ezone", target_t
+00005b70: 7a2c 2073 6f75 7263 655f 7469 6d65 5f74  z, source_time_t
+00005b80: 6f5f 636f 6e76 6572 7429 0a20 2020 2072  o_convert).    r
+00005b90: 6574 7572 6e20 6361 6c6c 5f62 7569 6c74  eturn call_built
+00005ba0: 696e 280a 2020 2020 2020 2020 2263 6f6e  in(.        "con
+00005bb0: 7665 7274 5f74 696d 657a 6f6e 6522 2c20  vert_timezone", 
+00005bc0: 736f 7572 6365 5f74 7a2c 2074 6172 6765  source_tz, targe
+00005bd0: 745f 747a 2c20 736f 7572 6365 5f74 696d  t_tz, source_tim
+00005be0: 655f 746f 5f63 6f6e 7665 7274 0a20 2020  e_to_convert.   
+00005bf0: 2029 0a0a 0a64 6566 2061 7070 726f 785f   )...def approx_
+00005c00: 636f 756e 745f 6469 7374 696e 6374 2865  count_distinct(e
+00005c10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00005c20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00005c30: 2222 5573 6573 2048 7970 6572 4c6f 674c  ""Uses HyperLogL
+00005c40: 6f67 2074 6f20 7265 7475 726e 2061 6e20  og to return an 
+00005c50: 6170 7072 6f78 696d 6174 696f 6e20 6f66  approximation of
+00005c60: 2074 6865 2064 6973 7469 6e63 7420 6361   the distinct ca
+00005c70: 7264 696e 616c 6974 7920 6f66 2074 6865  rdinality of the
+00005c80: 2069 6e70 7574 2028 692e 652e 2048 4c4c   input (i.e. HLL
+00005c90: 2863 6f6c 312c 2063 6f6c 322c 202e 2e2e  (col1, col2, ...
+00005ca0: 2029 0a20 2020 2072 6574 7572 6e73 2061   ).    returns a
+00005cb0: 6e20 6170 7072 6f78 696d 6174 696f 6e20  n approximation 
+00005cc0: 6f66 2043 4f55 4e54 2844 4953 5449 4e43  of COUNT(DISTINC
+00005cd0: 5420 636f 6c31 2c20 636f 6c32 2c20 2e2e  T col1, col2, ..
+00005ce0: 2e20 2929 2e0a 0a20 2020 2045 7861 6d70  . ))...    Examp
+00005cf0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00005d00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00005d10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00005d20: 5b31 2c20 325d 2c20 5b33 2c20 345d 2c20  [1, 2], [3, 4], 
+00005d30: 5b35 2c20 365d 5d2c 2073 6368 656d 613d  [5, 6]], schema=
+00005d40: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+00005d50: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00005d60: 7428 6170 7072 6f78 5f63 6f75 6e74 5f64  t(approx_count_d
+00005d70: 6973 7469 6e63 7428 2261 2229 2e61 6c69  istinct("a").ali
+00005d80: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+00005d90: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00005da0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00005db0: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+00005dc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00005dd0: 2d2d 2d0a 2020 2020 2020 2020 7c33 2020  ---.        |3  
+00005de0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00005df0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00005e00: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00005e10: 3e0a 0a20 2020 2022 2222 0a20 2020 2063  >..    """.    c
+00005e20: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00005e30: 7228 652c 2022 6170 7072 6f78 5f63 6f75  r(e, "approx_cou
+00005e40: 6e74 5f64 6973 7469 6e63 7422 290a 2020  nt_distinct").  
+00005e50: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00005e60: 2822 6170 7072 6f78 5f63 6f75 6e74 5f64  ("approx_count_d
+00005e70: 6973 7469 6e63 7422 2928 6329 0a0a 0a64  istinct")(c)...d
+00005e80: 6566 2061 7667 2865 3a20 436f 6c75 6d6e  ef avg(e: Column
+00005e90: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00005ea0: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00005eb0: 7320 7468 6520 6176 6572 6167 6520 6f66  s the average of
+00005ec0: 206e 6f6e 2d4e 554c 4c20 7265 636f 7264   non-NULL record
+00005ed0: 732e 2049 6620 616c 6c20 7265 636f 7264  s. If all record
+00005ee0: 7320 696e 7369 6465 2061 2067 726f 7570  s inside a group
+00005ef0: 2061 7265 204e 554c 4c2c 0a20 2020 2074   are NULL,.    t
+00005f00: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+00005f10: 726e 7320 4e55 4c4c 2e0a 0a20 2020 2045  rns NULL...    E
+00005f20: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00005f30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00005f40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00005f50: 6d65 285b 5b31 5d2c 205b 325d 2c20 5b32  me([[1], [2], [2
+00005f60: 5d5d 2c20 7363 6865 6d61 3d5b 2264 225d  ]], schema=["d"]
+00005f70: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00005f80: 2e73 656c 6563 7428 6176 6728 6466 2e64  .select(avg(df.d
+00005f90: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00005fa0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00005fb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00005fc0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00005fd0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00005fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00005ff0: 207c 312e 3636 3636 3637 2020 7c0a 2020   |1.666667  |.  
+00006000: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00006010: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00006020: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00006030: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00006040: 665f 7374 7228 652c 2022 6176 6722 290a  f_str(e, "avg").
+00006050: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00006060: 696e 2822 6176 6722 2928 6329 0a0a 0a64  in("avg")(c)...d
+00006070: 6566 2063 6f72 7228 636f 6c75 6d6e 313a  ef corr(column1:
+00006080: 2043 6f6c 756d 6e4f 724e 616d 652c 2063   ColumnOrName, c
+00006090: 6f6c 756d 6e32 3a20 436f 6c75 6d6e 4f72  olumn2: ColumnOr
+000060a0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+000060b0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+000060c0: 7468 6520 636f 7272 656c 6174 696f 6e20  the correlation 
+000060d0: 636f 6566 6669 6369 656e 7420 666f 7220  coefficient for 
+000060e0: 6e6f 6e2d 6e75 6c6c 2070 6169 7273 2069  non-null pairs i
+000060f0: 6e20 6120 6772 6f75 702e 0a0a 2020 2020  n a group...    
+00006100: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00006110: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00006120: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00006130: 6d65 285b 5b31 2c20 325d 2c20 5b31 2c20  me([[1, 2], [1, 
+00006140: 325d 2c20 5b34 2c20 355d 2c20 5b32 2c20  2], [4, 5], [2, 
+00006150: 335d 2c20 5b33 2c20 4e6f 6e65 5d2c 205b  3], [3, None], [
+00006160: 342c 204e 6f6e 655d 2c20 5b36 2c34 5d5d  4, None], [6,4]]
+00006170: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+00006180: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
+00006190: 2064 662e 7365 6c65 6374 2863 6f72 7228   df.select(corr(
+000061a0: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
+000061b0: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
+000061c0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+000061d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000061e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000061f0: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
+00006200: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00006210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c30  -----.        |0
+00006230: 2e38 3133 3638 3135 3038 3332 3838 3039  .813681508328809
+00006240: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00006250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006260: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00006270: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00006280: 2020 6331 203d 205f 746f 5f63 6f6c 5f69    c1 = _to_col_i
+00006290: 665f 7374 7228 636f 6c75 6d6e 312c 2022  f_str(column1, "
+000062a0: 636f 7272 2229 0a20 2020 2063 3220 3d20  corr").    c2 = 
+000062b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000062c0: 6f6c 756d 6e32 2c20 2263 6f72 7222 290a  olumn2, "corr").
+000062d0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000062e0: 696e 2822 636f 7272 2229 2863 312c 2063  in("corr")(c1, c
+000062f0: 3229 0a0a 0a64 6566 2063 6f75 6e74 2865  2)...def count(e
+00006300: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00006310: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00006320: 2222 5265 7475 726e 7320 6569 7468 6572  ""Returns either
+00006330: 2074 6865 206e 756d 6265 7220 6f66 206e   the number of n
+00006340: 6f6e 2d4e 554c 4c20 7265 636f 7264 7320  on-NULL records 
+00006350: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
+00006360: 6420 636f 6c75 6d6e 732c 206f 7220 7468  d columns, or th
+00006370: 650a 2020 2020 746f 7461 6c20 6e75 6d62  e.    total numb
+00006380: 6572 206f 6620 7265 636f 7264 732e 0a0a  er of records...
+00006390: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+000063a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000063b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000063c0: 6166 7261 6d65 285b 5b31 5d2c 205b 4e6f  aframe([[1], [No
+000063d0: 6e65 5d2c 205b 335d 2c20 5b34 5d2c 205b  ne], [3], [4], [
+000063e0: 4e6f 6e65 5d5d 2c20 7363 6865 6d61 3d5b  None]], schema=[
+000063f0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00006400: 3e20 6466 2e73 656c 6563 7428 636f 756e  > df.select(coun
+00006410: 7428 636f 6c28 2261 2229 292e 616c 6961  t(col("a")).alia
+00006420: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00006430: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00006440: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00006450: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00006460: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00006470: 2d2d 0a20 2020 2020 2020 207c 3320 2020  --.        |3   
+00006480: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00006490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000064a0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+000064b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000064c0: 7365 6c65 6374 2863 6f75 6e74 2822 2a22  select(count("*"
+000064d0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000064e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000064f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00006500: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00006510: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00006520: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00006530: 207c 3520 2020 2020 2020 2020 7c0a 2020   |5         |.  
+00006540: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00006550: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00006560: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00006570: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00006580: 665f 7374 7228 652c 2022 636f 756e 7422  f_str(e, "count"
+00006590: 290a 2020 2020 7265 7475 726e 2028 0a20  ).    return (. 
+000065a0: 2020 2020 2020 2062 7569 6c74 696e 2822         builtin("
+000065b0: 636f 756e 7422 2928 4c69 7465 7261 6c28  count")(Literal(
+000065c0: 3129 290a 2020 2020 2020 2020 6966 2069  1)).        if i
+000065d0: 7369 6e73 7461 6e63 6528 632e 5f65 7870  sinstance(c._exp
+000065e0: 7265 7373 696f 6e2c 2053 7461 7229 0a20  ression, Star). 
+000065f0: 2020 2020 2020 2065 6c73 6520 6275 696c         else buil
+00006600: 7469 6e28 2263 6f75 6e74 2229 2863 2e5f  tin("count")(c._
+00006610: 6578 7072 6573 7369 6f6e 290a 2020 2020  expression).    
+00006620: 290a 0a0a 6465 6620 636f 756e 745f 6469  )...def count_di
+00006630: 7374 696e 6374 282a 636f 6c73 3a20 436f  stinct(*cols: Co
+00006640: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00006650: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00006660: 7475 726e 7320 6569 7468 6572 2074 6865  turns either the
+00006670: 206e 756d 6265 7220 6f66 206e 6f6e 2d4e   number of non-N
+00006680: 554c 4c20 6469 7374 696e 6374 2072 6563  ULL distinct rec
+00006690: 6f72 6473 2066 6f72 2074 6865 2073 7065  ords for the spe
+000066a0: 6369 6669 6564 2063 6f6c 756d 6e73 2c0a  cified columns,.
+000066b0: 2020 2020 6f72 2074 6865 2074 6f74 616c      or the total
+000066c0: 206e 756d 6265 7220 6f66 2074 6865 2064   number of the d
+000066d0: 6973 7469 6e63 7420 7265 636f 7264 732e  istinct records.
+000066e0: 0a0a 2020 2020 4578 616d 706c 653a 0a0a  ..    Example:..
+000066f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00006700: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00006710: 6461 7461 6672 616d 6528 5b5b 312c 2032  dataframe([[1, 2
+00006720: 5d2c 205b 312c 2032 5d2c 205b 332c 204e  ], [1, 2], [3, N
+00006730: 6f6e 655d 2c20 5b32 2c20 335d 2c20 5b33  one], [2, 3], [3
+00006740: 2c20 4e6f 6e65 5d2c 205b 342c 204e 6f6e  , None], [4, Non
+00006750: 655d 5d2c 2073 6368 656d 613d 5b22 6122  e]], schema=["a"
+00006760: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+00006770: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
+00006780: 756e 745f 6469 7374 696e 6374 2863 6f6c  unt_distinct(col
+00006790: 2822 6122 292c 2063 6f6c 2822 6222 2929  ("a"), col("b"))
+000067a0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+000067b0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+000067c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+000067d0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+000067e0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000067f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00006800: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
+00006810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00006820: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00006830: 4c49 4e45 3e0a 2020 2020 2020 2020 3e3e  LINE>.        >>
+00006840: 3e20 2320 2054 6865 2072 6573 756c 7420  > #  The result 
+00006850: 7368 6f75 6c64 2062 6520 3220 666f 7220  should be 2 for 
+00006860: 7b5b 312c 325d 2c5b 322c 335d 7d20 7369  {[1,2],[2,3]} si
+00006870: 6e63 6520 7468 6520 7265 7374 2061 7265  nce the rest are
+00006880: 2065 6974 6865 7220 6475 706c 6963 6174   either duplicat
+00006890: 6520 6f72 204e 554c 4c20 7265 636f 7264  e or NULL record
+000068a0: 730a 2020 2020 2222 220a 2020 2020 6373  s.    """.    cs
+000068b0: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
+000068c0: 7472 2863 2c20 2263 6f75 6e74 5f64 6973  tr(c, "count_dis
+000068d0: 7469 6e63 7422 2920 666f 7220 6320 696e  tinct") for c in
+000068e0: 2063 6f6c 735d 0a20 2020 2072 6574 7572   cols].    retur
+000068f0: 6e20 436f 6c75 6d6e 280a 2020 2020 2020  n Column(.      
+00006900: 2020 4675 6e63 7469 6f6e 4578 7072 6573    FunctionExpres
+00006910: 7369 6f6e 2822 636f 756e 7422 2c20 5b63  sion("count", [c
+00006920: 2e5f 6578 7072 6573 7369 6f6e 2066 6f72  ._expression for
+00006930: 2063 2069 6e20 6373 5d2c 2069 735f 6469   c in cs], is_di
+00006940: 7374 696e 6374 3d54 7275 6529 0a20 2020  stinct=True).   
+00006950: 2029 0a0a 0a64 6566 2063 6f76 6172 5f70   )...def covar_p
+00006960: 6f70 2863 6f6c 756d 6e31 3a20 436f 6c75  op(column1: Colu
+00006970: 6d6e 4f72 4e61 6d65 2c20 636f 6c75 6d6e  mnOrName, column
+00006980: 323a 2043 6f6c 756d 6e4f 724e 616d 6529  2: ColumnOrName)
+00006990: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+000069a0: 2222 2252 6574 7572 6e73 2074 6865 2070  """Returns the p
+000069b0: 6f70 756c 6174 696f 6e20 636f 7661 7269  opulation covari
+000069c0: 616e 6365 2066 6f72 206e 6f6e 2d6e 756c  ance for non-nul
+000069d0: 6c20 7061 6972 7320 696e 2061 2067 726f  l pairs in a gro
+000069e0: 7570 2e0a 0a20 2020 2045 7861 6d70 6c65  up...    Example
+000069f0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+00006a00: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00006a10: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+00006a20: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
+00006a30: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00006a40: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00006a50: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
+00006a60: 2c20 5b31 2c20 325d 2c20 5b34 2c20 355d  , [1, 2], [4, 5]
+00006a70: 2c20 5b32 2c20 335d 2c20 5b33 2c20 4e6f  , [2, 3], [3, No
+00006a80: 6e65 5d2c 205b 342c 204e 6f6e 655d 2c20  ne], [4, None], 
+00006a90: 5b36 2c34 5d5d 2c20 7363 6865 6d61 3d5b  [6,4]], schema=[
+00006aa0: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00006ab0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00006ac0: 2863 6f76 6172 5f70 6f70 2863 6f6c 2822  (covar_pop(col("
+00006ad0: 6122 292c 2063 6f6c 2822 6222 2929 2e63  a"), col("b")).c
+00006ae0: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
+00006af0: 7363 616c 653d 3329 292e 616c 6961 7328  scale=3)).alias(
+00006b00: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+00006b10: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00006b20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00006b30: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+00006b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00006b50: 0a20 2020 2020 2020 207c 312e 3834 3020  .        |1.840 
+00006b60: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00006b70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00006b80: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+00006b90: 2020 2022 2222 0a20 2020 2063 6f6c 3120     """.    col1 
+00006ba0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00006bb0: 2863 6f6c 756d 6e31 2c20 2263 6f76 6172  (column1, "covar
+00006bc0: 5f70 6f70 2229 0a20 2020 2063 6f6c 3220  _pop").    col2 
+00006bd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00006be0: 2863 6f6c 756d 6e32 2c20 2263 6f76 6172  (column2, "covar
+00006bf0: 5f70 6f70 2229 0a20 2020 2072 6574 7572  _pop").    retur
+00006c00: 6e20 6275 696c 7469 6e28 2263 6f76 6172  n builtin("covar
+00006c10: 5f70 6f70 2229 2863 6f6c 312c 2063 6f6c  _pop")(col1, col
+00006c20: 3229 0a0a 0a64 6566 2063 6f76 6172 5f73  2)...def covar_s
+00006c30: 616d 7028 636f 6c75 6d6e 313a 2043 6f6c  amp(column1: Col
+00006c40: 756d 6e4f 724e 616d 652c 2063 6f6c 756d  umnOrName, colum
+00006c50: 6e32 3a20 436f 6c75 6d6e 4f72 4e61 6d65  n2: ColumnOrName
+00006c60: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00006c70: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00006c80: 7361 6d70 6c65 2063 6f76 6172 6961 6e63  sample covarianc
+00006c90: 6520 666f 7220 6e6f 6e2d 6e75 6c6c 2070  e for non-null p
+00006ca0: 6169 7273 2069 6e20 6120 6772 6f75 702e  airs in a group.
+00006cb0: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
+00006cc0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00006cd0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00006ce0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+00006cf0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
+00006d00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00006d10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00006d20: 6672 616d 6528 5b5b 312c 2032 5d2c 205b  frame([[1, 2], [
+00006d30: 312c 2032 5d2c 205b 342c 2035 5d2c 205b  1, 2], [4, 5], [
+00006d40: 322c 2033 5d2c 205b 332c 204e 6f6e 655d  2, 3], [3, None]
+00006d50: 2c20 5b34 2c20 4e6f 6e65 5d2c 205b 362c  , [4, None], [6,
+00006d60: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
+00006d70: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+00006d80: 3e3e 3e20 6466 2e73 656c 6563 7428 636f  >>> df.select(co
+00006d90: 7661 725f 7361 6d70 2863 6f6c 2822 6122  var_samp(col("a"
+00006da0: 292c 2063 6f6c 2822 6222 2929 2e63 6173  ), col("b")).cas
+00006db0: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
+00006dc0: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
+00006dd0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00006de0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006df0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00006e00: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+00006e10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00006e20: 2020 2020 2020 207c 322e 3330 3020 2020         |2.300   
+00006e30: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00006e40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00006e50: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00006e60: 2022 2222 0a20 2020 2063 6f6c 3120 3d20   """.    col1 = 
+00006e70: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00006e80: 6f6c 756d 6e31 2c20 2263 6f76 6172 5f73  olumn1, "covar_s
+00006e90: 616d 7022 290a 2020 2020 636f 6c32 203d  amp").    col2 =
+00006ea0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00006eb0: 636f 6c75 6d6e 322c 2022 636f 7661 725f  column2, "covar_
+00006ec0: 7361 6d70 2229 0a20 2020 2072 6574 7572  samp").    retur
+00006ed0: 6e20 6275 696c 7469 6e28 2263 6f76 6172  n builtin("covar
+00006ee0: 5f73 616d 7022 2928 636f 6c31 2c20 636f  _samp")(col1, co
+00006ef0: 6c32 290a 0a0a 6465 6620 6b75 7274 6f73  l2)...def kurtos
+00006f00: 6973 2865 3a20 436f 6c75 6d6e 4f72 4e61  is(e: ColumnOrNa
+00006f10: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00006f20: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+00006f30: 6e73 2074 6865 2070 6f70 756c 6174 696f  ns the populatio
+00006f40: 6e20 6578 6365 7373 206b 7572 746f 7369  n excess kurtosi
+00006f50: 7320 6f66 206e 6f6e 2d4e 554c 4c20 7265  s of non-NULL re
+00006f60: 636f 7264 732e 2049 6620 616c 6c20 7265  cords. If all re
+00006f70: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
+00006f80: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
+00006f90: 4c2c 2074 6865 2066 756e 6374 696f 6e20  L, the function 
+00006fa0: 7265 7475 726e 7320 4e55 4c4c 2e0a 0a20  returns NULL... 
+00006fb0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00006fc0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00006fd0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00006fe0: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+00006ff0: 7274 206b 7572 746f 7369 730a 2020 2020  rt kurtosis.    
+00007000: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00007010: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00007020: 6672 616d 6528 5b31 2c20 332c 2031 302c  frame([1, 3, 10,
+00007030: 2031 2c20 335d 2c20 7363 6865 6d61 3d5b   1, 3], schema=[
+00007040: 2278 225d 290a 2020 2020 2020 2020 3e3e  "x"]).        >>
+00007050: 3e20 6466 2e73 656c 6563 7428 6b75 7274  > df.select(kurt
+00007060: 6f73 6973 2822 7822 292e 6173 5f28 2278  osis("x").as_("x
+00007070: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00007080: 2020 2020 2020 5b52 6f77 2858 3d44 6563        [Row(X=Dec
+00007090: 696d 616c 2827 332e 3631 3337 3336 3630  imal('3.61373660
+000070a0: 3939 3536 2729 295d 0a20 2020 2022 2222  9956'))].    """
+000070b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000070c0: 5f69 665f 7374 7228 652c 2022 6b75 7274  _if_str(e, "kurt
+000070d0: 6f73 6973 2229 0a20 2020 2072 6574 7572  osis").    retur
+000070e0: 6e20 6275 696c 7469 6e28 226b 7572 746f  n builtin("kurto
+000070f0: 7369 7322 2928 6329 0a0a 0a64 6566 206d  sis")(c)...def m
+00007100: 6178 2865 3a20 436f 6c75 6d6e 4f72 4e61  ax(e: ColumnOrNa
+00007110: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00007120: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+00007130: 6e73 2074 6865 206d 6178 696d 756d 2076  ns the maximum v
+00007140: 616c 7565 2066 6f72 2074 6865 2072 6563  alue for the rec
+00007150: 6f72 6473 2069 6e20 6120 6772 6f75 702e  ords in a group.
+00007160: 204e 554c 4c20 7661 6c75 6573 2061 7265   NULL values are
+00007170: 2069 676e 6f72 6564 0a20 2020 2075 6e6c   ignored.    unl
+00007180: 6573 7320 616c 6c20 7468 6520 7265 636f  ess all the reco
+00007190: 7264 7320 6172 6520 4e55 4c4c 2c20 696e  rds are NULL, in
+000071a0: 2077 6869 6368 2063 6173 6520 6120 4e55   which case a NU
+000071b0: 4c4c 2076 616c 7565 2069 7320 7265 7475  LL value is retu
+000071c0: 726e 6564 2e0a 0a20 2020 2045 7861 6d70  rned...    Examp
+000071d0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+000071e0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+000071f0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00007200: 5b31 2c20 332c 2031 302c 2031 2c20 335d  [1, 3, 10, 1, 3]
+00007210: 2c20 7363 6865 6d61 3d5b 2278 225d 290a  , schema=["x"]).
+00007220: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00007230: 656c 6563 7428 6d61 7828 2278 2229 2e61  elect(max("x").a
+00007240: 735f 2822 7822 2929 2e63 6f6c 6c65 6374  s_("x")).collect
+00007250: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00007260: 583d 3130 295d 0a20 2020 2022 2222 0a20  X=10)].    """. 
+00007270: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00007280: 665f 7374 7228 652c 2022 6d61 7822 290a  f_str(e, "max").
+00007290: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000072a0: 696e 2822 6d61 7822 2928 6329 0a0a 0a64  in("max")(c)...d
+000072b0: 6566 206d 6561 6e28 653a 2043 6f6c 756d  ef mean(e: Colum
+000072c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000072d0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000072e0: 5265 7475 726e 2074 6865 2061 7665 7261  Return the avera
+000072f0: 6765 2066 6f72 2074 6865 2073 7065 6369  ge for the speci
+00007300: 6669 6320 6e75 6d65 7269 6320 636f 6c75  fic numeric colu
+00007310: 6d6e 732e 2041 6c69 6173 206f 6620 3a66  mns. Alias of :f
+00007320: 756e 633a 6061 7667 602e 0a0a 2020 2020  unc:`avg`...    
+00007330: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00007340: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00007350: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00007360: 7261 6d65 285b 312c 2033 2c20 3130 2c20  rame([1, 3, 10, 
+00007370: 312c 2033 5d2c 2073 6368 656d 613d 5b22  1, 3], schema=["
+00007380: 7822 5d29 0a20 2020 2020 2020 203e 3e3e  x"]).        >>>
+00007390: 2064 662e 7365 6c65 6374 286d 6561 6e28   df.select(mean(
+000073a0: 2278 2229 2e61 735f 2822 7822 2929 2e63  "x").as_("x")).c
+000073b0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000073c0: 205b 526f 7728 583d 4465 6369 6d61 6c28   [Row(X=Decimal(
+000073d0: 2733 2e36 3030 3030 3027 2929 5d0a 2020  '3.600000'))].  
+000073e0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+000073f0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00007400: 226d 6561 6e22 290a 2020 2020 7265 7475  "mean").    retu
+00007410: 726e 2061 7667 2863 290a 0a0a 6465 6620  rn avg(c)...def 
+00007420: 6d65 6469 616e 2865 3a20 436f 6c75 6d6e  median(e: Column
+00007430: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00007440: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00007450: 6574 7572 6e73 2074 6865 206d 6564 6961  eturns the media
+00007460: 6e20 7661 6c75 6520 666f 7220 7468 6520  n value for the 
+00007470: 7265 636f 7264 7320 696e 2061 2067 726f  records in a gro
+00007480: 7570 2e20 4e55 4c4c 2076 616c 7565 7320  up. NULL values 
+00007490: 6172 6520 6967 6e6f 7265 640a 2020 2020  are ignored.    
+000074a0: 756e 6c65 7373 2061 6c6c 2074 6865 2072  unless all the r
+000074b0: 6563 6f72 6473 2061 7265 204e 554c 4c2c  ecords are NULL,
+000074c0: 2069 6e20 7768 6963 6820 6361 7365 2061   in which case a
+000074d0: 204e 554c 4c20 7661 6c75 6520 6973 2072   NULL value is r
+000074e0: 6574 7572 6e65 642e 0a0a 2020 2020 4578  eturned...    Ex
+000074f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00007500: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00007510: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00007520: 6d65 285b 312c 2033 2c20 3130 2c20 312c  me([1, 3, 10, 1,
+00007530: 2033 5d2c 2073 6368 656d 613d 5b22 7822   3], schema=["x"
+00007540: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00007550: 662e 7365 6c65 6374 286d 6564 6961 6e28  f.select(median(
+00007560: 2278 2229 2e61 735f 2822 7822 2929 2e63  "x").as_("x")).c
+00007570: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00007580: 205b 526f 7728 583d 4465 6369 6d61 6c28   [Row(X=Decimal(
+00007590: 2733 2e30 3030 2729 295d 0a20 2020 2022  '3.000'))].    "
+000075a0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+000075b0: 6f6c 5f69 665f 7374 7228 652c 2022 6d65  ol_if_str(e, "me
+000075c0: 6469 616e 2229 0a20 2020 2072 6574 7572  dian").    retur
+000075d0: 6e20 6275 696c 7469 6e28 226d 6564 6961  n builtin("media
+000075e0: 6e22 2928 6329 0a0a 0a64 6566 206d 696e  n")(c)...def min
+000075f0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00007600: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00007610: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00007620: 2074 6865 206d 696e 696d 756d 2076 616c   the minimum val
+00007630: 7565 2066 6f72 2074 6865 2072 6563 6f72  ue for the recor
+00007640: 6473 2069 6e20 6120 6772 6f75 702e 204e  ds in a group. N
+00007650: 554c 4c20 7661 6c75 6573 2061 7265 2069  ULL values are i
+00007660: 676e 6f72 6564 0a20 2020 2075 6e6c 6573  gnored.    unles
+00007670: 7320 616c 6c20 7468 6520 7265 636f 7264  s all the record
+00007680: 7320 6172 6520 4e55 4c4c 2c20 696e 2077  s are NULL, in w
+00007690: 6869 6368 2063 6173 6520 6120 4e55 4c4c  hich case a NULL
+000076a0: 2076 616c 7565 2069 7320 7265 7475 726e   value is return
+000076b0: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
+000076c0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+000076d0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000076e0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+000076f0: 2c20 332c 2031 302c 2031 2c20 335d 2c20  , 3, 10, 1, 3], 
+00007700: 7363 6865 6d61 3d5b 2278 225d 290a 2020  schema=["x"]).  
+00007710: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00007720: 6563 7428 6d69 6e28 2278 2229 2e61 735f  ect(min("x").as_
+00007730: 2822 7822 2929 2e63 6f6c 6c65 6374 2829  ("x")).collect()
+00007740: 0a20 2020 2020 2020 205b 526f 7728 583d  .        [Row(X=
+00007750: 3129 5d0a 2020 2020 2222 220a 2020 2020  1)].    """.    
+00007760: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00007770: 7472 2865 2c20 226d 696e 2229 0a20 2020  tr(e, "min").   
+00007780: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00007790: 226d 696e 2229 2863 290a 0a0a 6465 6620  "min")(c)...def 
+000077a0: 6d6f 6465 2865 3a20 436f 6c75 6d6e 4f72  mode(e: ColumnOr
+000077b0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+000077c0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+000077d0: 7572 6e73 2074 6865 206d 6f73 7420 6672  urns the most fr
+000077e0: 6571 7565 6e74 2076 616c 7565 2066 6f72  equent value for
+000077f0: 2074 6865 2072 6563 6f72 6473 2069 6e20   the records in 
+00007800: 6120 6772 6f75 702e 204e 554c 4c20 7661  a group. NULL va
+00007810: 6c75 6573 2061 7265 2069 676e 6f72 6564  lues are ignored
+00007820: 2e0a 2020 2020 4966 2061 6c6c 2074 6865  ..    If all the
+00007830: 2076 616c 7565 7320 6172 6520 4e55 4c4c   values are NULL
+00007840: 2c20 6f72 2074 6865 7265 2061 7265 2030  , or there are 0
+00007850: 2072 6f77 732c 2074 6865 6e20 7468 6520   rows, then the 
+00007860: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
+00007870: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
+00007880: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00007890: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000078a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000078b0: 285b 312c 2033 2c20 3130 2c20 312c 2034  ([1, 3, 10, 1, 4
+000078c0: 5d2c 2073 6368 656d 613d 5b22 7822 5d29  ], schema=["x"])
+000078d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000078e0: 7365 6c65 6374 286d 6f64 6528 2278 2229  select(mode("x")
+000078f0: 2e61 735f 2822 7822 2929 2e63 6f6c 6c65  .as_("x")).colle
+00007900: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00007910: 7728 583d 3129 5d0a 2020 2020 2222 220a  w(X=1)].    """.
+00007920: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00007930: 6966 5f73 7472 2865 2c20 226d 6f64 6522  if_str(e, "mode"
+00007940: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00007950: 6c74 696e 2822 6d6f 6465 2229 2863 290a  ltin("mode")(c).
+00007960: 0a0a 6465 6620 736b 6577 2865 3a20 436f  ..def skew(e: Co
+00007970: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00007980: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+00007990: 7475 726e 7320 7468 6520 7361 6d70 6c65  turns the sample
+000079a0: 2073 6b65 776e 6573 7320 6f66 206e 6f6e   skewness of non
+000079b0: 2d4e 554c 4c20 7265 636f 7264 732e 2049  -NULL records. I
+000079c0: 6620 616c 6c20 7265 636f 7264 7320 696e  f all records in
+000079d0: 7369 6465 2061 2067 726f 7570 0a20 2020  side a group.   
+000079e0: 2061 7265 204e 554c 4c2c 2074 6865 2066   are NULL, the f
+000079f0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+00007a00: 4e55 4c4c 2e0a 0a20 2020 2045 7861 6d70  NULL...    Examp
+00007a10: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00007a20: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+00007a30: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+00007a40: 6d70 6f72 7420 4465 6369 6d61 6c54 7970  mport DecimalTyp
+00007a50: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00007a60: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00007a70: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+00007a80: 2020 2020 202e 2e2e 2020 2020 205b 3130       ...     [10
+00007a90: 2c20 3130 2c20 3230 2c20 3235 2c20 3330  , 10, 20, 25, 30
+00007aa0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00007ab0: 2020 2073 6368 656d 613d 5b22 6122 5d0a     schema=["a"].
+00007ac0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
+00007ad0: 6c65 6374 2873 6b65 7728 2261 2229 2e63  lect(skew("a").c
+00007ae0: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
+00007af0: 7363 616c 653d 3429 2929 0a20 2020 2020  scale=4))).     
+00007b00: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
+00007b10: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00007b20: 2843 4153 5420 2853 4b45 5728 2241 2229  (CAST (SKEW("A")
+00007b30: 2041 5320 4e55 4d42 4552 2833 382c 2034   AS NUMBER(38, 4
+00007b40: 2929 3d44 6563 696d 616c 2827 302e 3035  ))=Decimal('0.05
+00007b50: 3234 2729 295d 0a20 2020 2022 2222 0a20  24'))].    """. 
+00007b60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00007b70: 665f 7374 7228 652c 2022 736b 6577 2229  f_str(e, "skew")
+00007b80: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00007b90: 7469 6e28 2273 6b65 7722 2928 6329 0a0a  tin("skew")(c)..
+00007ba0: 0a64 6566 2073 7464 6465 7628 653a 2043  .def stddev(e: C
+00007bb0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00007bc0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00007bd0: 6574 7572 6e73 2074 6865 2073 616d 706c  eturns the sampl
+00007be0: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
+00007bf0: 7469 6f6e 2028 7371 7561 7265 2072 6f6f  tion (square roo
+00007c00: 7420 6f66 2073 616d 706c 6520 7661 7269  t of sample vari
+00007c10: 616e 6365 2920 6f66 0a20 2020 206e 6f6e  ance) of.    non
+00007c20: 2d4e 554c 4c20 7661 6c75 6573 2e20 4966  -NULL values. If
+00007c30: 2061 6c6c 2072 6563 6f72 6473 2069 6e73   all records ins
+00007c40: 6964 6520 6120 6772 6f75 7020 6172 6520  ide a group are 
+00007c50: 4e55 4c4c 2c20 7265 7475 726e 7320 4e55  NULL, returns NU
+00007c60: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
+00007c70: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+00007c80: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00007c90: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+00007ca0: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
+00007cb0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00007cc0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00007cd0: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00007ce0: 2020 202e 2e2e 2020 2020 205b 342c 2039     ...     [4, 9
+00007cf0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00007d00: 2020 2073 6368 656d 613d 5b22 4e22 5d2c     schema=["N"],
+00007d10: 0a20 2020 2020 2020 202e 2e2e 2029 2e73  .        ... ).s
+00007d20: 656c 6563 7428 7374 6464 6576 2863 6f6c  elect(stddev(col
+00007d30: 2822 4e22 2929 2e63 6173 7428 4465 6369  ("N")).cast(Deci
+00007d40: 6d61 6c54 7970 6528 7363 616c 653d 3429  malType(scale=4)
+00007d50: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
+00007d60: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+00007d70: 2020 2020 5b52 6f77 2843 4153 5420 2853      [Row(CAST (S
+00007d80: 5444 4445 5628 224e 2229 2041 5320 4e55  TDDEV("N") AS NU
+00007d90: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+00007da0: 696d 616c 2827 332e 3533 3535 2729 295d  imal('3.5355'))]
+00007db0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00007dc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00007dd0: 652c 2022 7374 6464 6576 2229 0a20 2020  e, "stddev").   
+00007de0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00007df0: 2273 7464 6465 7622 2928 6329 0a0a 0a64  "stddev")(c)...d
+00007e00: 6566 2073 7464 6465 765f 7361 6d70 2865  ef stddev_samp(e
+00007e10: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00007e20: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00007e30: 2222 5265 7475 726e 7320 7468 6520 7361  ""Returns the sa
+00007e40: 6d70 6c65 2073 7461 6e64 6172 6420 6465  mple standard de
+00007e50: 7669 6174 696f 6e20 2873 7175 6172 6520  viation (square 
+00007e60: 726f 6f74 206f 6620 7361 6d70 6c65 2076  root of sample v
+00007e70: 6172 6961 6e63 6529 206f 660a 2020 2020  ariance) of.    
+00007e80: 6e6f 6e2d 4e55 4c4c 2076 616c 7565 732e  non-NULL values.
+00007e90: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
+00007ea0: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00007eb0: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
+00007ec0: 204e 554c 4c2e 2041 6c69 6173 206f 660a   NULL. Alias of.
+00007ed0: 2020 2020 3a66 756e 633a 6073 7464 6465      :func:`stdde
+00007ee0: 7660 2e0a 0a20 2020 2045 7861 6d70 6c65  v`...    Example
+00007ef0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+00007f00: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00007f10: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+00007f20: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
+00007f30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00007f40: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00007f50: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00007f60: 2020 202e 2e2e 2020 2020 205b 342c 2039     ...     [4, 9
+00007f70: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00007f80: 2020 2073 6368 656d 613d 5b22 4e22 5d2c     schema=["N"],
+00007f90: 0a20 2020 2020 2020 202e 2e2e 2029 2e73  .        ... ).s
+00007fa0: 656c 6563 7428 7374 6464 6576 5f73 616d  elect(stddev_sam
+00007fb0: 7028 636f 6c28 224e 2229 292e 6361 7374  p(col("N")).cast
+00007fc0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
+00007fd0: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
+00007fe0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+00007ff0: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
+00008000: 5354 2028 5354 4444 4556 5f53 414d 5028  ST (STDDEV_SAMP(
+00008010: 224e 2229 2041 5320 4e55 4d42 4552 2833  "N") AS NUMBER(3
+00008020: 382c 2034 2929 3d44 6563 696d 616c 2827  8, 4))=Decimal('
+00008030: 332e 3533 3535 2729 295d 0a20 2020 2022  3.5355'))].    "
+00008040: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00008050: 6f6c 5f69 665f 7374 7228 652c 2022 7374  ol_if_str(e, "st
+00008060: 6464 6576 5f73 616d 7022 290a 2020 2020  ddev_samp").    
+00008070: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00008080: 7374 6464 6576 5f73 616d 7022 2928 6329  stddev_samp")(c)
+00008090: 0a0a 0a64 6566 2073 7464 6465 765f 706f  ...def stddev_po
+000080a0: 7028 653a 2043 6f6c 756d 6e4f 724e 616d  p(e: ColumnOrNam
+000080b0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+000080c0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+000080d0: 2070 6f70 756c 6174 696f 6e20 7374 616e   population stan
+000080e0: 6461 7264 2064 6576 6961 7469 6f6e 2028  dard deviation (
+000080f0: 7371 7561 7265 2072 6f6f 7420 6f66 2076  square root of v
+00008100: 6172 6961 6e63 6529 206f 6620 6e6f 6e2d  ariance) of non-
+00008110: 4e55 4c4c 0a20 2020 2076 616c 7565 732e  NULL.    values.
+00008120: 2049 6620 616c 6c20 7265 636f 7264 7320   If all records 
+00008130: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00008140: 7265 204e 554c 4c2c 2072 6574 7572 6e73  re NULL, returns
+00008150: 204e 554c 4c2e 0a0a 2020 2020 4578 616d   NULL...    Exam
+00008160: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00008170: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00008180: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00008190: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+000081a0: 205b 342c 2039 5d2c 0a20 2020 2020 2020   [4, 9],.       
+000081b0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+000081c0: 5b22 4e22 5d2c 0a20 2020 2020 2020 202e  ["N"],.        .
+000081d0: 2e2e 2029 2e73 656c 6563 7428 7374 6464  .. ).select(stdd
+000081e0: 6576 5f70 6f70 2863 6f6c 2822 4e22 2929  ev_pop(col("N"))
+000081f0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00008200: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00008210: 2020 205b 526f 7728 5354 4444 4556 5f50     [Row(STDDEV_P
+00008220: 4f50 2822 4e22 293d 322e 3529 5d0a 2020  OP("N")=2.5)].  
+00008230: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00008240: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+00008250: 2273 7464 6465 765f 706f 7022 290a 2020  "stddev_pop").  
+00008260: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00008270: 2822 7374 6464 6576 5f70 6f70 2229 2863  ("stddev_pop")(c
+00008280: 290a 0a0a 6465 6620 7375 6d28 653a 2043  )...def sum(e: C
+00008290: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+000082a0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+000082b0: 6574 7572 6e73 2074 6865 2073 756d 206f  eturns the sum o
+000082c0: 6620 6e6f 6e2d 4e55 4c4c 2072 6563 6f72  f non-NULL recor
+000082d0: 6473 2069 6e20 6120 6772 6f75 702e 2059  ds in a group. Y
+000082e0: 6f75 2063 616e 2075 7365 2074 6865 2044  ou can use the D
+000082f0: 4953 5449 4e43 5420 6b65 7977 6f72 640a  ISTINCT keyword.
+00008300: 2020 2020 746f 2063 6f6d 7075 7465 2074      to compute t
+00008310: 6865 2073 756d 206f 6620 756e 6971 7565  he sum of unique
+00008320: 206e 6f6e 2d6e 756c 6c20 7661 6c75 6573   non-null values
+00008330: 2e20 4966 2061 6c6c 2072 6563 6f72 6473  . If all records
+00008340: 2069 6e73 6964 6520 6120 6772 6f75 7020   inside a group 
+00008350: 6172 650a 2020 2020 4e55 4c4c 2c20 7468  are.    NULL, th
+00008360: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+00008370: 6e73 204e 554c 4c2e 0a0a 2020 2020 4578  ns NULL...    Ex
+00008380: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00008390: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000083a0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+000083b0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+000083c0: 2020 205b 342c 2039 5d2c 0a20 2020 2020     [4, 9],.     
+000083d0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+000083e0: 613d 5b22 4e22 5d2c 0a20 2020 2020 2020  a=["N"],.       
+000083f0: 202e 2e2e 2029 2e73 656c 6563 7428 7375   ... ).select(su
+00008400: 6d28 636f 6c28 224e 2229 2929 0a20 2020  m(col("N"))).   
+00008410: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
+00008420: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00008430: 6f77 2853 554d 2822 4e22 293d 3133 295d  ow(SUM("N")=13)]
+00008440: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00008450: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00008460: 652c 2022 7375 6d22 290a 2020 2020 7265  e, "sum").    re
+00008470: 7475 726e 2062 7569 6c74 696e 2822 7375  turn builtin("su
+00008480: 6d22 2928 6329 0a0a 0a64 6566 2073 756d  m")(c)...def sum
+00008490: 5f64 6973 7469 6e63 7428 653a 2043 6f6c  _distinct(e: Col
+000084a0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000084b0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+000084c0: 7572 6e73 2074 6865 2073 756d 206f 6620  urns the sum of 
+000084d0: 6e6f 6e2d 4e55 4c4c 2064 6973 7469 6e63  non-NULL distinc
+000084e0: 7420 7265 636f 7264 7320 696e 2061 2067  t records in a g
+000084f0: 726f 7570 2e20 596f 7520 6361 6e20 7573  roup. You can us
+00008500: 6520 7468 650a 2020 2020 4449 5354 494e  e the.    DISTIN
+00008510: 4354 206b 6579 776f 7264 2074 6f20 636f  CT keyword to co
+00008520: 6d70 7574 6520 7468 6520 7375 6d20 6f66  mpute the sum of
+00008530: 2075 6e69 7175 6520 6e6f 6e2d 6e75 6c6c   unique non-null
+00008540: 2076 616c 7565 732e 2049 6620 616c 6c20   values. If all 
+00008550: 7265 636f 7264 730a 2020 2020 696e 7369  records.    insi
+00008560: 6465 2061 2067 726f 7570 2061 7265 204e  de a group are N
+00008570: 554c 4c2c 2074 6865 2066 756e 6374 696f  ULL, the functio
+00008580: 6e20 7265 7475 726e 7320 4e55 4c4c 2e0a  n returns NULL..
+00008590: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+000085a0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000085b0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000085c0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
+000085d0: 2020 2e2e 2e20 2020 2020 5b31 2c20 322c    ...     [1, 2,
+000085e0: 204e 6f6e 652c 2033 5d2c 0a20 2020 2020   None, 3],.     
+000085f0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+00008600: 613d 5b22 4e22 5d2c 0a20 2020 2020 2020  a=["N"],.       
+00008610: 202e 2e2e 2029 2e73 656c 6563 7428 7375   ... ).select(su
+00008620: 6d5f 6469 7374 696e 6374 2863 6f6c 2822  m_distinct(col("
+00008630: 4e22 2929 290a 2020 2020 2020 2020 3e3e  N"))).        >>
+00008640: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
+00008650: 2020 2020 2020 205b 526f 7728 5355 4d28         [Row(SUM(
+00008660: 2044 4953 5449 4e43 5420 224e 2229 3d36   DISTINCT "N")=6
+00008670: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+00008680: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00008690: 7228 652c 2022 7375 6d5f 6469 7374 696e  r(e, "sum_distin
+000086a0: 6374 2229 0a20 2020 2072 6574 7572 6e20  ct").    return 
+000086b0: 5f63 616c 6c5f 6675 6e63 7469 6f6e 2822  _call_function("
+000086c0: 7375 6d22 2c20 5472 7565 2c20 6329 0a0a  sum", True, c)..
+000086d0: 0a64 6566 2076 6172 6961 6e63 6528 653a  .def variance(e:
+000086e0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000086f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00008700: 2252 6574 7572 6e73 2074 6865 2073 616d  "Returns the sam
+00008710: 706c 6520 7661 7269 616e 6365 206f 6620  ple variance of 
+00008720: 6e6f 6e2d 4e55 4c4c 2072 6563 6f72 6473  non-NULL records
+00008730: 2069 6e20 6120 6772 6f75 702e 2049 6620   in a group. If 
+00008740: 616c 6c20 7265 636f 7264 730a 2020 2020  all records.    
+00008750: 696e 7369 6465 2061 2067 726f 7570 2061  inside a group a
+00008760: 7265 204e 554c 4c2c 2061 204e 554c 4c20  re NULL, a NULL 
+00008770: 6973 2072 6574 7572 6e65 642e 2046 6f72  is returned. For
+00008780: 2061 2073 696e 676c 6520 726f 772c 204e   a single row, N
+00008790: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
+000087a0: 6173 2073 616d 706c 6520 7661 7269 616e  as sample varian
+000087b0: 6365 2e0a 0a20 2020 2045 7861 6d70 6c65  ce...    Example
+000087c0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+000087d0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000087e0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
+000087f0: 2c20 2d31 2c20 312c 202d 312c 202d 315d  , -1, 1, -1, -1]
+00008800: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+00008810: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00008820: 656c 6563 7428 7661 7269 616e 6365 2863  elect(variance(c
+00008830: 6f6c 2822 6122 2929 292e 636f 6c6c 6563  ol("a"))).collec
+00008840: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00008850: 2856 4152 4941 4e43 4528 2241 2229 3d44  (VARIANCE("A")=D
+00008860: 6563 696d 616c 2827 312e 3230 3030 3030  ecimal('1.200000
+00008870: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
+00008880: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00008890: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000088a0: 5b31 2c20 4e6f 6e65 2c20 322c 2033 2c20  [1, None, 2, 3, 
+000088b0: 4e6f 6e65 2c20 352c 2036 5d2c 2073 6368  None, 5, 6], sch
+000088c0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+000088d0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000088e0: 2876 6172 6961 6e63 6528 636f 6c28 2261  (variance(col("a
+000088f0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+00008900: 2020 2020 2020 205b 526f 7728 5641 5249         [Row(VARI
+00008910: 414e 4345 2822 4122 293d 4465 6369 6d61  ANCE("A")=Decima
+00008920: 6c28 2734 2e33 3030 3030 3027 2929 5d0a  l('4.300000'))].
+00008930: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00008940: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00008950: 5f64 6174 6166 7261 6d65 285b 4e6f 6e65  _dataframe([None
+00008960: 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c 2073  , None, None], s
+00008970: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00008980: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00008990: 6374 2876 6172 6961 6e63 6528 636f 6c28  ct(variance(col(
+000089a0: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
+000089b0: 0a20 2020 2020 2020 205b 526f 7728 5641  .        [Row(VA
+000089c0: 5249 414e 4345 2822 4122 293d 4e6f 6e65  RIANCE("A")=None
+000089d0: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
+000089e0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000089f0: 6174 655f 6461 7461 6672 616d 6528 5b34  ate_dataframe([4
+00008a00: 325d 2c20 7363 6865 6d61 3d5b 2261 225d  2], schema=["a"]
+00008a10: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00008a20: 2e73 656c 6563 7428 7661 7269 616e 6365  .select(variance
+00008a30: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
+00008a40: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00008a50: 6f77 2856 4152 4941 4e43 4528 2241 2229  ow(VARIANCE("A")
+00008a60: 3d4e 6f6e 6529 5d0a 0a20 2020 2022 2222  =None)]..    """
+00008a70: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00008a80: 5f69 665f 7374 7228 652c 2022 7661 7269  _if_str(e, "vari
+00008a90: 616e 6365 2229 0a20 2020 2072 6574 7572  ance").    retur
+00008aa0: 6e20 6275 696c 7469 6e28 2276 6172 6961  n builtin("varia
+00008ab0: 6e63 6522 2928 6329 0a0a 0a64 6566 2076  nce")(c)...def v
+00008ac0: 6172 5f73 616d 7028 653a 2043 6f6c 756d  ar_samp(e: Colum
+00008ad0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00008ae0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00008af0: 6e73 2074 6865 2073 616d 706c 6520 7661  ns the sample va
+00008b00: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
+00008b10: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
+00008b20: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
+00008b30: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
+00008b40: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
+00008b50: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
+00008b60: 7572 6e65 642e 2046 6f72 2061 2073 696e  urned. For a sin
+00008b70: 676c 6520 726f 772c 204e 554c 4c20 6973  gle row, NULL is
+00008b80: 2072 6574 7572 6e65 6420 6173 2073 616d   returned as sam
+00008b90: 706c 6520 7661 7269 616e 6365 2e0a 2020  ple variance..  
+00008ba0: 2020 416c 6961 7320 6f66 203a 6675 6e63    Alias of :func
+00008bb0: 3a60 7661 7269 616e 6365 600a 0a20 2020  :`variance`..   
+00008bc0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00008bd0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00008be0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00008bf0: 6672 616d 6528 5b31 2c20 2d31 2c20 312c  frame([1, -1, 1,
+00008c00: 202d 312c 202d 315d 2c20 7363 6865 6d61   -1, -1], schema
+00008c10: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00008c20: 3e3e 3e20 6466 2e73 656c 6563 7428 7661  >>> df.select(va
+00008c30: 725f 7361 6d70 2863 6f6c 2822 6122 2929  r_samp(col("a"))
+00008c40: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00008c50: 2020 2020 5b52 6f77 2856 4152 4941 4e43      [Row(VARIANC
+00008c60: 4528 2241 2229 3d44 6563 696d 616c 2827  E("A")=Decimal('
+00008c70: 312e 3230 3030 3030 2729 295d 0a0a 2020  1.200000'))]..  
+00008c80: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00008c90: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00008ca0: 7461 6672 616d 6528 5b31 2c20 4e6f 6e65  taframe([1, None
+00008cb0: 2c20 322c 2033 2c20 4e6f 6e65 2c20 352c  , 2, 3, None, 5,
+00008cc0: 2036 5d2c 2073 6368 656d 613d 5b22 6122   6], schema=["a"
+00008cd0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00008ce0: 662e 7365 6c65 6374 2876 6172 5f73 616d  f.select(var_sam
+00008cf0: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
+00008d00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00008d10: 526f 7728 5641 5249 414e 4345 2822 4122  Row(VARIANCE("A"
+00008d20: 293d 4465 6369 6d61 6c28 2734 2e33 3030  )=Decimal('4.300
+00008d30: 3030 3027 2929 5d0a 0a20 2020 2020 2020  000'))]..       
+00008d40: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00008d50: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00008d60: 6d65 285b 4e6f 6e65 2c20 4e6f 6e65 2c20  me([None, None, 
+00008d70: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b22  None], schema=["
+00008d80: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00008d90: 2064 662e 7365 6c65 6374 2876 6172 5f73   df.select(var_s
+00008da0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
+00008db0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00008dc0: 205b 526f 7728 5641 5249 414e 4345 2822   [Row(VARIANCE("
+00008dd0: 4122 293d 4e6f 6e65 295d 0a0a 2020 2020  A")=None)]..    
+00008de0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00008df0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00008e00: 6672 616d 6528 5b34 325d 2c20 7363 6865  frame([42], sche
+00008e10: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+00008e20: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00008e30: 7661 725f 7361 6d70 2863 6f6c 2822 6122  var_samp(col("a"
+00008e40: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+00008e50: 2020 2020 2020 5b52 6f77 2856 4152 4941        [Row(VARIA
+00008e60: 4e43 4528 2241 2229 3d4e 6f6e 6529 5d0a  NCE("A")=None)].
+00008e70: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00008e80: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00008e90: 652c 2022 7661 725f 7361 6d70 2229 0a20  e, "var_samp"). 
+00008ea0: 2020 2072 6574 7572 6e20 7661 7269 616e     return varian
+00008eb0: 6365 2863 290a 0a0a 6465 6620 7661 725f  ce(c)...def var_
+00008ec0: 706f 7028 653a 2043 6f6c 756d 6e4f 724e  pop(e: ColumnOrN
+00008ed0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+00008ee0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00008ef0: 6865 2070 6f70 756c 6174 696f 6e20 7661  he population va
+00008f00: 7269 616e 6365 206f 6620 6e6f 6e2d 4e55  riance of non-NU
+00008f10: 4c4c 2072 6563 6f72 6473 2069 6e20 6120  LL records in a 
+00008f20: 6772 6f75 702e 2049 6620 616c 6c20 7265  group. If all re
+00008f30: 636f 7264 730a 2020 2020 696e 7369 6465  cords.    inside
+00008f40: 2061 2067 726f 7570 2061 7265 204e 554c   a group are NUL
+00008f50: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
+00008f60: 7572 6e65 642e 2054 6865 2070 6f70 756c  urned. The popul
+00008f70: 6174 696f 6e20 7661 7269 616e 6365 206f  ation variance o
+00008f80: 6620 6120 7369 6e67 6c65 2072 6f77 2069  f a single row i
+00008f90: 7320 302e 302e 0a0a 2020 2020 4578 616d  s 0.0...    Exam
+00008fa0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00008fb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00008fc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00008fd0: 285b 312c 202d 312c 2031 2c20 2d31 2c20  ([1, -1, 1, -1, 
+00008fe0: 2d31 5d2c 2073 6368 656d 613d 5b22 6122  -1], schema=["a"
+00008ff0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00009000: 662e 7365 6c65 6374 2876 6172 5f70 6f70  f.select(var_pop
+00009010: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
+00009020: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00009030: 6f77 2856 4152 5f50 4f50 2822 4122 293d  ow(VAR_POP("A")=
+00009040: 4465 6369 6d61 6c28 2730 2e39 3630 3030  Decimal('0.96000
+00009050: 3027 2929 5d0a 0a20 2020 2020 2020 203e  0'))]..        >
+00009060: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00009070: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00009080: 285b 312c 204e 6f6e 652c 2032 2c20 332c  ([1, None, 2, 3,
+00009090: 204e 6f6e 652c 2035 2c20 365d 2c20 7363   None, 5, 6], sc
+000090a0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+000090b0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000090c0: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
+000090d0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+000090e0: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
+000090f0: 504f 5028 2241 2229 3d44 6563 696d 616c  POP("A")=Decimal
+00009100: 2827 332e 3434 3030 3030 2729 295d 0a0a  ('3.440000'))]..
+00009110: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00009120: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00009130: 6461 7461 6672 616d 6528 5b4e 6f6e 652c  dataframe([None,
+00009140: 204e 6f6e 652c 204e 6f6e 655d 2c20 7363   None, None], sc
+00009150: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00009160: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00009170: 7428 7661 725f 706f 7028 636f 6c28 2261  t(var_pop(col("a
+00009180: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+00009190: 2020 2020 2020 205b 526f 7728 5641 525f         [Row(VAR_
+000091a0: 504f 5028 2241 2229 3d4e 6f6e 6529 5d0a  POP("A")=None)].
 000091b0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
 000091c0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-000091d0: 5f64 6174 6166 7261 6d65 285b 312c 322c  _dataframe([1,2,
-000091e0: 332c 342c 355d 2c20 7363 6865 6d61 3d5b  3,4,5], schema=[
-000091f0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00009200: 3e20 6466 2e73 656c 6563 7428 6170 7072  > df.select(appr
-00009210: 6f78 5f70 6572 6365 6e74 696c 655f 6163  ox_percentile_ac
-00009220: 6375 6d75 6c61 7465 2822 6122 292e 616c  cumulate("a").al
-00009230: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-00009240: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00009250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00009270: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00009280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009290: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000092a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000092b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000092c0: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
-000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092e0: 7c0a 2020 2020 2020 2020 7c20 2022 7374  |.        |  "st
-000092f0: 6174 6522 3a20 5b20 2020 2020 2020 2020  ate": [         
-00009300: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00009310: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
-00009320: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
-00009330: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
-00009340: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
-00009350: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
-00009360: 2020 2020 322e 3030 3030 3030 3030 3030      2.0000000000
-00009370: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
-00009380: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
-00009390: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
-000093a0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
-000093b0: 2020 332e 3030 3030 3030 3030 3030 3030    3.000000000000
-000093c0: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
-000093d0: 2020 2020 7c20 2020 2031 2e30 3030 3030      |    1.00000
-000093e0: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
-000093f0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
-00009400: 342e 3030 3030 3030 3030 3030 3030 3030  4.00000000000000
-00009410: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
-00009420: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
-00009430: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
-00009440: 0a20 2020 2020 2020 207c 2020 2020 352e  .        |    5.
-00009450: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
-00009460: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
-00009470: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
-00009480: 3030 3030 3030 652b 3030 2020 207c 0a20  000000e+00   |. 
-00009490: 2020 2020 2020 207c 2020 5d2c 2020 2020         |  ],    
-000094a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-000094c0: 2022 7479 7065 223a 2022 7464 6967 6573   "type": "tdiges
-000094d0: 7422 2c20 2020 2020 2020 207c 0a20 2020  t",        |.   
-000094e0: 2020 2020 207c 2020 2276 6572 7369 6f6e       |  "version
-000094f0: 223a 2031 2020 2020 2020 2020 2020 2020  ": 1            
-00009500: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009520: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00009530: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00009540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009550: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00009560: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00009570: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00009580: 5f73 7472 2863 6f6c 2c20 2261 7070 726f  _str(col, "appro
-00009590: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
-000095a0: 756d 756c 6174 6522 290a 2020 2020 7265  umulate").    re
-000095b0: 7475 726e 2062 7569 6c74 696e 2822 6170  turn builtin("ap
-000095c0: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
-000095d0: 6163 6375 6d75 6c61 7465 2229 2863 290a  accumulate")(c).
-000095e0: 0a0a 6465 6620 6170 7072 6f78 5f70 6572  ..def approx_per
-000095f0: 6365 6e74 696c 655f 6573 7469 6d61 7465  centile_estimate
-00009600: 2873 7461 7465 3a20 436f 6c75 6d6e 4f72  (state: ColumnOr
-00009610: 4e61 6d65 2c20 7065 7263 656e 7469 6c65  Name, percentile
-00009620: 3a20 666c 6f61 7429 202d 3e20 436f 6c75  : float) -> Colu
-00009630: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00009640: 6e73 2074 6865 2064 6573 6972 6564 2061  ns the desired a
-00009650: 7070 726f 7869 6d61 7465 6420 7065 7263  pproximated perc
-00009660: 656e 7469 6c65 2076 616c 7565 2066 6f72  entile value for
-00009670: 2074 6865 2073 7065 6369 6669 6564 2074   the specified t
-00009680: 2d44 6967 6573 7420 7374 6174 652e 0a20  -Digest state.. 
-00009690: 2020 2041 5050 524f 585f 5045 5243 454e     APPROX_PERCEN
-000096a0: 5449 4c45 5f45 5354 494d 4154 4528 4150  TILE_ESTIMATE(AP
-000096b0: 5052 4f58 5f50 4552 4345 4e54 494c 455f  PROX_PERCENTILE_
-000096c0: 4143 4355 4d55 4c41 5445 282e 2929 2069  ACCUMULATE(.)) i
-000096d0: 7320 6571 7569 7661 6c65 6e74 2074 6f0a  s equivalent to.
-000096e0: 2020 2020 4150 5052 4f58 5f50 4552 4345      APPROX_PERCE
-000096f0: 4e54 494c 4528 2e29 2e0a 0a20 2020 2045  NTILE(.)...    E
-00009700: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00009710: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00009720: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00009730: 6d65 285b 312c 322c 332c 342c 355d 2c20  me([1,2,3,4,5], 
-00009740: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00009750: 2020 2020 2020 3e3e 3e20 6466 5f61 6363        >>> df_acc
-00009760: 7520 3d20 6466 2e73 656c 6563 7428 6170  u = df.select(ap
-00009770: 7072 6f78 5f70 6572 6365 6e74 696c 655f  prox_percentile_
-00009780: 6163 6375 6d75 6c61 7465 2822 6122 292e  accumulate("a").
-00009790: 616c 6961 7328 2261 7070 5f70 6572 6365  alias("app_perce
-000097a0: 6e74 696c 655f 6163 6375 2229 290a 2020  ntile_accu")).  
-000097b0: 2020 2020 2020 3e3e 3e20 6466 5f61 6363        >>> df_acc
-000097c0: 752e 7365 6c65 6374 2861 7070 726f 785f  u.select(approx_
-000097d0: 7065 7263 656e 7469 6c65 5f65 7374 696d  percentile_estim
-000097e0: 6174 6528 2261 7070 5f70 6572 6365 6e74  ate("app_percent
-000097f0: 696c 655f 6163 6375 222c 2030 2e35 292e  ile_accu", 0.5).
-00009800: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00009810: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00009820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00009830: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00009840: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00009850: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00009860: 332e 3020 2020 2020 2020 7c0a 2020 2020  3.0       |.    
-00009870: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00009880: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00009890: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-000098a0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000098b0: 7374 7228 7374 6174 652c 2022 6170 7072  str(state, "appr
-000098c0: 6f78 5f70 6572 6365 6e74 696c 655f 6573  ox_percentile_es
-000098d0: 7469 6d61 7465 2229 0a20 2020 2072 6574  timate").    ret
-000098e0: 7572 6e20 6275 696c 7469 6e28 2261 7070  urn builtin("app
-000098f0: 726f 785f 7065 7263 656e 7469 6c65 5f65  rox_percentile_e
-00009900: 7374 696d 6174 6522 2928 632c 206c 6974  stimate")(c, lit
-00009910: 2870 6572 6365 6e74 696c 6529 290a 0a0a  (percentile))...
-00009920: 6465 6620 6170 7072 6f78 5f70 6572 6365  def approx_perce
-00009930: 6e74 696c 655f 636f 6d62 696e 6528 7374  ntile_combine(st
-00009940: 6174 653a 2043 6f6c 756d 6e4f 724e 616d  ate: ColumnOrNam
-00009950: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-00009960: 2020 2222 2243 6f6d 6269 6e65 7320 286d    """Combines (m
-00009970: 6572 6765 7329 2070 6572 6365 6e74 696c  erges) percentil
-00009980: 6520 696e 7075 7420 7374 6174 6573 2069  e input states i
-00009990: 6e74 6f20 6120 7369 6e67 6c65 206f 7574  nto a single out
-000099a0: 7075 7420 7374 6174 652e 0a20 2020 2054  put state..    T
-000099b0: 6869 7320 616c 6c6f 7773 2073 6365 6e61  his allows scena
-000099c0: 7269 6f73 2077 6865 7265 2041 5050 524f  rios where APPRO
-000099d0: 585f 5045 5243 454e 5449 4c45 5f41 4343  X_PERCENTILE_ACC
-000099e0: 554d 554c 4154 4520 6973 2072 756e 206f  UMULATE is run o
-000099f0: 7665 7220 686f 7269 7a6f 6e74 616c 2070  ver horizontal p
-00009a00: 6172 7469 7469 6f6e 730a 2020 2020 6f66  artitions.    of
-00009a10: 2074 6865 2073 616d 6520 7461 626c 652c   the same table,
-00009a20: 2070 726f 6475 6369 6e67 2061 6e20 616c   producing an al
-00009a30: 676f 7269 7468 6d20 7374 6174 6520 666f  gorithm state fo
-00009a40: 7220 6561 6368 2074 6162 6c65 2070 6172  r each table par
-00009a50: 7469 7469 6f6e 2e20 5468 6573 6520 7374  tition. These st
-00009a60: 6174 6573 2063 616e 0a20 2020 206c 6174  ates can.    lat
-00009a70: 6572 2062 6520 636f 6d62 696e 6564 2075  er be combined u
-00009a80: 7369 6e67 2041 5050 524f 585f 5045 5243  sing APPROX_PERC
-00009a90: 454e 5449 4c45 5f43 4f4d 4249 4e45 2c20  ENTILE_COMBINE, 
-00009aa0: 7072 6f64 7563 696e 6720 7468 6520 7361  producing the sa
-00009ab0: 6d65 206f 7574 7075 7420 7374 6174 6520  me output state 
-00009ac0: 6173 2061 0a20 2020 2073 696e 676c 6520  as a.    single 
-00009ad0: 7275 6e20 6f66 2041 5050 524f 585f 5045  run of APPROX_PE
-00009ae0: 5243 454e 5449 4c45 5f41 4343 554d 554c  RCENTILE_ACCUMUL
-00009af0: 4154 4520 6f76 6572 2074 6865 2065 6e74  ATE over the ent
-00009b00: 6972 6520 7461 626c 652e 0a0a 2020 2020  ire table...    
-00009b10: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-00009b20: 2020 3e3e 3e20 6466 3120 3d20 7365 7373    >>> df1 = sess
-00009b30: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00009b40: 7261 6d65 285b 312c 322c 332c 342c 355d  rame([1,2,3,4,5]
-00009b50: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00009b60: 2020 2020 2020 2020 3e3e 3e20 6466 3220          >>> df2 
-00009b70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00009b80: 5f64 6174 6166 7261 6d65 285b 362c 372c  _dataframe([6,7,
-00009b90: 382c 392c 3130 5d2c 2073 6368 656d 613d  8,9,10], schema=
-00009ba0: 5b22 6222 5d29 0a20 2020 2020 2020 203e  ["b"]).        >
-00009bb0: 3e3e 2064 665f 6163 6375 3120 3d20 6466  >> df_accu1 = df
-00009bc0: 312e 7365 6c65 6374 2861 7070 726f 785f  1.select(approx_
-00009bd0: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
-00009be0: 756c 6174 6528 2261 2229 2e61 6c69 6173  ulate("a").alias
-00009bf0: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
-00009c00: 5f61 6363 7522 2929 0a20 2020 2020 2020  _accu")).       
-00009c10: 203e 3e3e 2064 665f 6163 6375 3220 3d20   >>> df_accu2 = 
-00009c20: 6466 322e 7365 6c65 6374 2861 7070 726f  df2.select(appro
-00009c30: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
-00009c40: 756d 756c 6174 6528 2262 2229 2e61 6c69  umulate("b").ali
-00009c50: 6173 2822 6170 705f 7065 7263 656e 7469  as("app_percenti
-00009c60: 6c65 5f61 6363 7522 2929 0a20 2020 2020  le_accu")).     
-00009c70: 2020 203e 3e3e 2064 665f 6163 6375 312e     >>> df_accu1.
-00009c80: 756e 696f 6e28 6466 5f61 6363 7532 292e  union(df_accu2).
-00009c90: 7365 6c65 6374 2861 7070 726f 785f 7065  select(approx_pe
-00009ca0: 7263 656e 7469 6c65 5f63 6f6d 6269 6e65  rcentile_combine
-00009cb0: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
-00009cc0: 5f61 6363 7522 292e 616c 6961 7328 2272  _accu").alias("r
-00009cd0: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00009ce0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00009cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009d00: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00009d10: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
-00009d20: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00009d30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00009d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009d50: 2d2d 2d2d 0a20 2020 2020 2020 207c 7b20  ----.        |{ 
-00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d70: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00009d80: 2020 2020 7c20 2022 7374 6174 6522 3a20      |  "state": 
-00009d90: 5b20 2020 2020 2020 2020 2020 2020 2020  [               
-00009da0: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
-00009db0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
-00009dc0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
-00009dd0: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
-00009de0: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
-00009df0: 0a20 2020 2020 2020 207c 2020 2020 322e  .        |    2.
-00009e00: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
-00009e10: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
-00009e20: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
-00009e30: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
-00009e40: 2020 2020 2020 207c 2020 2020 332e 3030         |    3.00
-00009e50: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
-00009e60: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
-00009e70: 2020 2031 2e30 3030 3030 3030 3030 3030     1.00000000000
-00009e80: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
-00009e90: 2020 2020 207c 2020 2020 342e 3030 3030       |    4.0000
-00009ea0: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
-00009eb0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
-00009ec0: 2031 2e30 3030 3030 3030 3030 3030 3030   1.0000000000000
-00009ed0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
-00009ee0: 2020 207c 2020 2020 352e 3030 3030 3030     |    5.000000
-00009ef0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
-00009f00: 7c0a 2020 2020 2020 2020 7c20 2020 2031  |.        |    1
-00009f10: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
-00009f20: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
-00009f30: 207c 2020 2020 362e 3030 3030 3030 3030   |    6.00000000
-00009f40: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
-00009f50: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
-00009f60: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
-00009f70: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
-00009f80: 2020 2020 372e 3030 3030 3030 3030 3030      7.0000000000
-00009f90: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
-00009fa0: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
-00009fb0: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
-00009fc0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
-00009fd0: 2020 382e 3030 3030 3030 3030 3030 3030    8.000000000000
-00009fe0: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
-00009ff0: 2020 2020 7c20 2020 2031 2e30 3030 3030      |    1.00000
-0000a000: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
-0000a010: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
-0000a020: 392e 3030 3030 3030 3030 3030 3030 3030  9.00000000000000
-0000a030: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
-0000a040: 2020 7c20 2020 2031 2e30 3030 3030 3030    |    1.0000000
-0000a050: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
-0000a060: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
-0000a070: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
-0000a080: 2b30 312c 2020 7c0a 2020 2020 2020 2020  +01,  |.        
-0000a090: 7c20 2020 2031 2e30 3030 3030 3030 3030  |    1.000000000
-0000a0a0: 3030 3030 3030 652b 3030 2020 207c 0a20  000000e+00   |. 
-0000a0b0: 2020 2020 2020 207c 2020 5d2c 2020 2020         |  ],    
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0d0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0000a0e0: 2022 7479 7065 223a 2022 7464 6967 6573   "type": "tdiges
-0000a0f0: 7422 2c20 2020 2020 2020 207c 0a20 2020  t",        |.   
-0000a100: 2020 2020 207c 2020 2276 6572 7369 6f6e       |  "version
-0000a110: 223a 2031 2020 2020 2020 2020 2020 2020  ": 1            
-0000a120: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
-0000a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a140: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0000a150: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0000a160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a170: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000a180: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0000a190: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000a1a0: 5f73 7472 2873 7461 7465 2c20 2261 7070  _str(state, "app
-0000a1b0: 726f 785f 7065 7263 656e 7469 6c65 5f63  rox_percentile_c
-0000a1c0: 6f6d 6269 6e65 2229 0a20 2020 2072 6574  ombine").    ret
-0000a1d0: 7572 6e20 6275 696c 7469 6e28 2261 7070  urn builtin("app
-0000a1e0: 726f 785f 7065 7263 656e 7469 6c65 5f63  rox_percentile_c
-0000a1f0: 6f6d 6269 6e65 2229 2863 290a 0a0a 6465  ombine")(c)...de
-0000a200: 6620 6578 706c 6f64 6528 636f 6c3a 2043  f explode(col: C
-0000a210: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000a220: 5461 626c 6546 756e 6374 696f 6e43 616c  TableFunctionCal
-0000a230: 6c3a 0a20 2020 2022 2222 466c 6174 7465  l:.    """Flatte
-0000a240: 6e73 2061 2067 6976 656e 2061 7272 6179  ns a given array
-0000a250: 206f 7220 6d61 7020 7479 7065 2063 6f6c   or map type col
-0000a260: 756d 6e20 696e 746f 2069 6e64 6976 6964  umn into individ
-0000a270: 7561 6c20 726f 7773 2e20 5468 6520 6465  ual rows. The de
-0000a280: 6661 756c 740a 2020 2020 636f 6c75 6d6e  fault.    column
-0000a290: 206e 616d 6520 666f 7220 7468 6520 6f75   name for the ou
-0000a2a0: 7470 7574 2063 6f6c 756d 6e20 696e 2063  tput column in c
-0000a2b0: 6173 6520 6f66 2061 7272 6179 2069 6e70  ase of array inp
-0000a2c0: 7574 2063 6f6c 756d 6e20 6973 2060 6056  ut column is ``V
-0000a2d0: 414c 5545 6060 2c0a 2020 2020 616e 6420  ALUE``,.    and 
-0000a2e0: 6973 2060 604b 4559 6060 2061 6e64 2060  is ``KEY`` and `
-0000a2f0: 6056 414c 5545 6060 2069 6e20 6361 7365  `VALUE`` in case
-0000a300: 206f 6620 6d61 7020 696e 7075 7420 636f   of map input co
-0000a310: 6c75 6d6e 2e0a 0a20 2020 2045 7861 6d70  lumn...    Examp
-0000a320: 6c65 733a 3a0a 2020 2020 2020 2020 3e3e  les::.        >>
-0000a330: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000a340: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000a350: 5b5b 312c 205b 312c 2032 2c20 335d 2c20  [[1, [1, 2, 3], 
-0000a360: 7b22 4173 6869 2047 6172 616d 6922 3a20  {"Ashi Garami": 
-0000a370: 2253 696e 676c 6520 4c65 6720 5822 7d2c  "Single Leg X"},
-0000a380: 2022 4b69 6d75 7261 225d 2c0a 2020 2020   "Kimura"],.    
-0000a390: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a3b0: 2020 2020 2020 205b 322c 205b 3131 2c20         [2, [11, 
-0000a3c0: 3232 5d2c 207b 2253 616e 6b61 6b75 223a  22], {"Sankaku":
-0000a3d0: 2022 5472 6961 6e67 6c65 227d 2c20 2243   "Triangle"}, "C
-0000a3e0: 6f66 6665 6522 5d5d 2c0a 2020 2020 2020  offee"]],.      
-0000a3f0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0000a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a410: 2020 2020 2073 6368 656d 613d 5b22 6964       schema=["id
-0000a420: 7822 2c20 226c 6973 7473 222c 2022 6d61  x", "lists", "ma
-0000a430: 7073 222c 2022 7374 7273 225d 290a 2020  ps", "strs"]).  
-0000a440: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000a450: 6563 7428 6466 2e69 6478 2c20 6578 706c  ect(df.idx, expl
-0000a460: 6f64 6528 6466 2e6c 6973 7473 2929 2e73  ode(df.lists)).s
-0000a470: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0000a480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a490: 2d0a 2020 2020 2020 2020 7c22 4944 5822  -.        |"IDX"
-0000a4a0: 2020 7c22 5641 4c55 4522 2020 7c0a 2020    |"VALUE"  |.  
-0000a4b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000a4c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000a4d0: 2020 7c31 2020 2020 2020 7c31 2020 2020    |1      |1    
-0000a4e0: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
-0000a4f0: 2020 2020 2020 7c32 2020 2020 2020 2020        |2        
-0000a500: 7c0a 2020 2020 2020 2020 7c31 2020 2020  |.        |1    
-0000a510: 2020 7c33 2020 2020 2020 2020 7c0a 2020    |3        |.  
-0000a520: 2020 2020 2020 7c32 2020 2020 2020 7c31        |2      |1
-0000a530: 3120 2020 2020 2020 7c0a 2020 2020 2020  1       |.      
-0000a540: 2020 7c32 2020 2020 2020 7c32 3220 2020    |2      |22   
-0000a550: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0000a560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a570: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000a580: 4c49 4e45 3e0a 0a20 2020 2020 2020 203e  LINE>..        >
-0000a590: 3e3e 2064 662e 7365 6c65 6374 2864 662e  >> df.select(df.
-0000a5a0: 7374 7273 2c20 6578 706c 6f64 6528 6466  strs, explode(df
-0000a5b0: 2e6d 6170 7329 292e 7368 6f77 2829 0a20  .maps)).show(). 
-0000a5c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000a5d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a5e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a5f0: 0a20 2020 2020 2020 207c 2253 5452 5322  .        |"STRS"
-0000a600: 2020 7c22 4b45 5922 2020 2020 2020 2020    |"KEY"        
-0000a610: 7c22 5641 4c55 4522 2020 2020 2020 2020  |"VALUE"        
-0000a620: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000a630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a650: 2d2d 2d2d 0a20 2020 2020 2020 207c 4b69  ----.        |Ki
-0000a660: 6d75 7261 2020 7c41 7368 6920 4761 7261  mura  |Ashi Gara
-0000a670: 6d69 2020 7c22 5369 6e67 6c65 204c 6567  mi  |"Single Leg
-0000a680: 2058 2220 207c 0a20 2020 2020 2020 207c   X"  |.        |
-0000a690: 436f 6666 6565 2020 7c53 616e 6b61 6b75  Coffee  |Sankaku
-0000a6a0: 2020 2020 2020 7c22 5472 6961 6e67 6c65        |"Triangle
-0000a6b0: 2220 2020 2020 207c 0a20 2020 2020 2020  "      |.       
-0000a6c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0000a6d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a6e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000a6f0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
-0000a700: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000a710: 656c 6563 7428 6578 706c 6f64 6528 636f  elect(explode(co
-0000a720: 6c28 226c 6973 7473 2229 292e 616c 6961  l("lists")).alia
-0000a730: 7328 2275 6e6f 2229 292e 7368 6f77 2829  s("uno")).show()
-0000a740: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000a750: 2d2d 0a20 2020 2020 2020 207c 2255 4e4f  --.        |"UNO
-0000a760: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-0000a770: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000a780: 3120 2020 2020 207c 0a20 2020 2020 2020  1      |.       
-0000a790: 207c 3220 2020 2020 207c 0a20 2020 2020   |2      |.     
-0000a7a0: 2020 207c 3320 2020 2020 207c 0a20 2020     |3      |.   
-0000a7b0: 2020 2020 207c 3131 2020 2020 207c 0a20       |11     |. 
-0000a7c0: 2020 2020 2020 207c 3232 2020 2020 207c         |22     |
-0000a7d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000a7e0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0000a7f0: 4b4c 494e 453e 0a0a 2020 2020 2020 2020  KLINE>..        
-0000a800: 3e3e 3e20 6466 2e73 656c 6563 7428 6578  >>> df.select(ex
-0000a810: 706c 6f64 6528 276d 6170 7327 292e 6173  plode('maps').as
-0000a820: 5f28 2270 7269 6d6f 222c 2022 7365 6375  _("primo", "secu
-0000a830: 6e64 6f22 2929 2e73 686f 7728 290a 2020  ndo")).show().  
-0000a840: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000a850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a860: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0000a870: 2250 5249 4d4f 2220 2020 2020 207c 2253  "PRIMO"      |"S
-0000a880: 4543 554e 444f 2220 2020 2020 2020 7c0a  ECUNDO"       |.
-0000a890: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000a8a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a8b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000a8c0: 207c 4173 6869 2047 6172 616d 6920 207c   |Ashi Garami  |
-0000a8d0: 2253 696e 676c 6520 4c65 6720 5822 2020  "Single Leg X"  
-0000a8e0: 7c0a 2020 2020 2020 2020 7c53 616e 6b61  |.        |Sanka
-0000a8f0: 6b75 2020 2020 2020 7c22 5472 6961 6e67  ku      |"Triang
-0000a900: 6c65 2220 2020 2020 207c 0a20 2020 2020  le"      |.     
-0000a910: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0000a920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a930: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0000a940: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0000a950: 2020 2020 6675 6e63 5f63 616c 6c20 3d20      func_call = 
-0000a960: 5f45 7870 6c6f 6465 4675 6e63 7469 6f6e  _ExplodeFunction
-0000a970: 4361 6c6c 2863 6f6c 290a 2020 2020 6675  Call(col).    fu
-0000a980: 6e63 5f63 616c 6c2e 5f73 6574 5f61 7069  nc_call._set_api
-0000a990: 5f63 616c 6c5f 736f 7572 6365 2822 6675  _call_source("fu
-0000a9a0: 6e63 7469 6f6e 732e 6578 706c 6f64 6522  nctions.explode"
-0000a9b0: 290a 2020 2020 7265 7475 726e 2066 756e  ).    return fun
-0000a9c0: 635f 6361 6c6c 0a0a 0a64 6566 2067 726f  c_call...def gro
-0000a9d0: 7570 696e 6728 2a63 6f6c 733a 2043 6f6c  uping(*cols: Col
-0000a9e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0000a9f0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-0000aa00: 2020 4465 7363 7269 6265 7320 7768 6963    Describes whic
-0000aa10: 6820 6f66 2061 206c 6973 7420 6f66 2065  h of a list of e
-0000aa20: 7870 7265 7373 696f 6e73 2061 7265 2067  xpressions are g
-0000aa30: 726f 7570 6564 2069 6e20 6120 726f 7720  rouped in a row 
-0000aa40: 7072 6f64 7563 6564 2062 7920 6120 4752  produced by a GR
-0000aa50: 4f55 5020 4259 2071 7565 7279 2e0a 0a20  OUP BY query... 
-0000aa60: 2020 203a 6675 6e63 3a60 6772 6f75 7069     :func:`groupi
-0000aa70: 6e67 5f69 6460 2069 7320 616e 2061 6c69  ng_id` is an ali
-0000aa80: 6173 206f 6620 3a66 756e 633a 6067 726f  as of :func:`gro
-0000aa90: 7570 696e 6760 2e0a 0a20 2020 2045 7861  uping`...    Exa
-0000aaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-0000aab0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0000aac0: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
-0000aad0: 7420 4772 6f75 7069 6e67 5365 7473 0a20  t GroupingSets. 
-0000aae0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000aaf0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0000ab00: 6174 6166 7261 6d65 285b 5b31 2c20 322c  ataframe([[1, 2,
-0000ab10: 2033 5d2c 205b 342c 2035 2c20 365d 5d2c   3], [4, 5, 6]],
-0000ab20: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
-0000ab30: 2c20 2263 225d 290a 2020 2020 2020 2020  , "c"]).        
-0000ab40: 3e3e 3e20 6772 6f75 7069 6e67 5f73 6574  >>> grouping_set
-0000ab50: 7320 3d20 4772 6f75 7069 6e67 5365 7473  s = GroupingSets
-0000ab60: 285b 636f 6c28 2261 2229 5d2c 205b 636f  ([col("a")], [co
-0000ab70: 6c28 2262 2229 5d2c 205b 636f 6c28 2261  l("b")], [col("a
-0000ab80: 2229 2c20 636f 6c28 2262 2229 5d29 0a20  "), col("b")]). 
-0000ab90: 2020 2020 2020 203e 3e3e 2064 662e 6772         >>> df.gr
-0000aba0: 6f75 705f 6279 5f67 726f 7570 696e 675f  oup_by_grouping_
-0000abb0: 7365 7473 2867 726f 7570 696e 675f 7365  sets(grouping_se
-0000abc0: 7473 292e 6167 6728 5b63 6f75 6e74 2822  ts).agg([count("
-0000abd0: 6322 292c 2067 726f 7570 696e 6728 2261  c"), grouping("a
-0000abe0: 2229 2c20 6772 6f75 7069 6e67 2822 6222  "), grouping("b"
-0000abf0: 292c 2067 726f 7570 696e 6728 2261 222c  ), grouping("a",
-0000ac00: 2022 6222 295d 292e 636f 6c6c 6563 7428   "b")]).collect(
-0000ac10: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-0000ac20: 3d31 2c20 423d 322c 2043 4f55 4e54 2843  =1, B=2, COUNT(C
-0000ac30: 293d 312c 2047 524f 5550 494e 4728 4129  )=1, GROUPING(A)
-0000ac40: 3d30 2c20 4752 4f55 5049 4e47 2842 293d  =0, GROUPING(B)=
-0000ac50: 302c 2047 524f 5550 494e 4728 412c 2042  0, GROUPING(A, B
-0000ac60: 293d 3029 2c20 5c0a 526f 7728 413d 342c  )=0), \.Row(A=4,
-0000ac70: 2042 3d35 2c20 434f 554e 5428 4329 3d31   B=5, COUNT(C)=1
-0000ac80: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
-0000ac90: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
-0000aca0: 4752 4f55 5049 4e47 2841 2c20 4229 3d30  GROUPING(A, B)=0
-0000acb0: 292c 205c 0a52 6f77 2841 3d31 2c20 423d  ), \.Row(A=1, B=
-0000acc0: 4e6f 6e65 2c20 434f 554e 5428 4329 3d31  None, COUNT(C)=1
-0000acd0: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
-0000ace0: 2047 524f 5550 494e 4728 4229 3d31 2c20   GROUPING(B)=1, 
-0000acf0: 4752 4f55 5049 4e47 2841 2c20 4229 3d31  GROUPING(A, B)=1
-0000ad00: 292c 205c 0a52 6f77 2841 3d34 2c20 423d  ), \.Row(A=4, B=
-0000ad10: 4e6f 6e65 2c20 434f 554e 5428 4329 3d31  None, COUNT(C)=1
-0000ad20: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
-0000ad30: 2047 524f 5550 494e 4728 4229 3d31 2c20   GROUPING(B)=1, 
-0000ad40: 4752 4f55 5049 4e47 2841 2c20 4229 3d31  GROUPING(A, B)=1
-0000ad50: 292c 205c 0a52 6f77 2841 3d4e 6f6e 652c  ), \.Row(A=None,
-0000ad60: 2042 3d32 2c20 434f 554e 5428 4329 3d31   B=2, COUNT(C)=1
-0000ad70: 2c20 4752 4f55 5049 4e47 2841 293d 312c  , GROUPING(A)=1,
-0000ad80: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
-0000ad90: 4752 4f55 5049 4e47 2841 2c20 4229 3d32  GROUPING(A, B)=2
-0000ada0: 292c 205c 0a52 6f77 2841 3d4e 6f6e 652c  ), \.Row(A=None,
-0000adb0: 2042 3d35 2c20 434f 554e 5428 4329 3d31   B=5, COUNT(C)=1
-0000adc0: 2c20 4752 4f55 5049 4e47 2841 293d 312c  , GROUPING(A)=1,
-0000add0: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
-0000ade0: 4752 4f55 5049 4e47 2841 2c20 4229 3d32  GROUPING(A, B)=2
-0000adf0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0000ae00: 6f6c 756d 6e73 203d 205b 5f74 6f5f 636f  olumns = [_to_co
-0000ae10: 6c5f 6966 5f73 7472 2863 2c20 2267 726f  l_if_str(c, "gro
-0000ae20: 7570 696e 6722 2920 666f 7220 6320 696e  uping") for c in
-0000ae30: 2063 6f6c 735d 0a20 2020 2072 6574 7572   cols].    retur
-0000ae40: 6e20 6275 696c 7469 6e28 2267 726f 7570  n builtin("group
-0000ae50: 696e 6722 2928 2a63 6f6c 756d 6e73 290a  ing")(*columns).
-0000ae60: 0a0a 6772 6f75 7069 6e67 5f69 6420 3d20  ..grouping_id = 
-0000ae70: 6772 6f75 7069 6e67 0a0a 0a64 6566 2063  grouping...def c
-0000ae80: 6f61 6c65 7363 6528 2a65 3a20 436f 6c75  oalesce(*e: Colu
-0000ae90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000aea0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-0000aeb0: 726e 7320 7468 6520 6669 7273 7420 6e6f  rns the first no
-0000aec0: 6e2d 4e55 4c4c 2065 7870 7265 7373 696f  n-NULL expressio
-0000aed0: 6e20 616d 6f6e 6720 6974 7320 6172 6775  n among its argu
-0000aee0: 6d65 6e74 732c 206f 7220 4e55 4c4c 2069  ments, or NULL i
-0000aef0: 6620 616c 6c20 6974 730a 2020 2020 6172  f all its.    ar
-0000af00: 6775 6d65 6e74 7320 6172 6520 4e55 4c4c  guments are NULL
-0000af10: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0000af20: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0000af30: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000af40: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
-0000af50: 2032 2c20 335d 2c20 5b4e 6f6e 652c 2032   2, 3], [None, 2
-0000af60: 2c20 335d 2c20 5b4e 6f6e 652c 204e 6f6e  , 3], [None, Non
-0000af70: 652c 2033 5d2c 205b 4e6f 6e65 2c20 4e6f  e, 3], [None, No
-0000af80: 6e65 2c20 4e6f 6e65 5d5d 2c20 7363 6865  ne, None]], sche
-0000af90: 6d61 3d5b 2761 272c 2027 6227 2c20 2763  ma=['a', 'b', 'c
-0000afa0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-0000afb0: 6466 2e73 656c 6563 7428 6466 2e61 2c20  df.select(df.a, 
-0000afc0: 6466 2e62 2c20 6466 2e63 2c20 636f 616c  df.b, df.c, coal
-0000afd0: 6573 6365 2864 662e 612c 2064 662e 622c  esce(df.a, df.b,
-0000afe0: 2064 662e 6329 2e61 735f 2822 434f 414c   df.c).as_("COAL
-0000aff0: 4553 4345 2229 292e 7368 6f77 2829 0a20  ESCE")).show(). 
-0000b000: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000b010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b020: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000b030: 2020 207c 2241 2220 2020 7c22 4222 2020     |"A"   |"B"  
-0000b040: 207c 2243 2220 2020 7c22 434f 414c 4553   |"C"   |"COALES
-0000b050: 4345 2220 207c 0a20 2020 2020 2020 202d  CE"  |.        -
-0000b060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b080: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
-0000b090: 2020 7c32 2020 2020 207c 3320 2020 2020    |2     |3     
-0000b0a0: 7c31 2020 2020 2020 2020 2020 207c 0a20  |1           |. 
-0000b0b0: 2020 2020 2020 207c 4e55 4c4c 2020 7c32         |NULL  |2
-0000b0c0: 2020 2020 207c 3320 2020 2020 7c32 2020       |3     |2  
-0000b0d0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-0000b0e0: 2020 207c 4e55 4c4c 2020 7c4e 554c 4c20     |NULL  |NULL 
-0000b0f0: 207c 3320 2020 2020 7c33 2020 2020 2020   |3     |3      
-0000b100: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0000b110: 4e55 4c4c 2020 7c4e 554c 4c20 207c 4e55  NULL  |NULL  |NU
-0000b120: 4c4c 2020 7c4e 554c 4c20 2020 2020 2020  LL  |NULL       
-0000b130: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000b140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000b150: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0000b160: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000b170: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0000b180: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
-0000b190: 7472 2865 782c 2022 636f 616c 6573 6365  tr(ex, "coalesce
-0000b1a0: 2229 2066 6f72 2065 7820 696e 2065 5d0a  ") for ex in e].
-0000b1b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000b1c0: 696e 2822 636f 616c 6573 6365 2229 282a  in("coalesce")(*
-0000b1d0: 6329 0a0a 0a64 6566 2065 7175 616c 5f6e  c)...def equal_n
-0000b1e0: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
-0000b1f0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000b200: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-0000b210: 6e20 7472 7565 2069 6620 7468 6520 7661  n true if the va
-0000b220: 6c75 6520 696e 2074 6865 2063 6f6c 756d  lue in the colum
-0000b230: 6e20 6973 206e 6f74 2061 206e 756d 6265  n is not a numbe
-0000b240: 7220 284e 614e 292e 0a0a 2020 2020 4578  r (NaN)...    Ex
-0000b250: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0000b260: 203e 3e3e 2069 6d70 6f72 7420 6d61 7468   >>> import math
-0000b270: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000b280: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000b290: 5f64 6174 6166 7261 6d65 285b 312e 312c  _dataframe([1.1,
-0000b2a0: 206d 6174 682e 6e61 6e2c 2032 2e33 5d2c   math.nan, 2.3],
-0000b2b0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0000b2c0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0000b2d0: 6c65 6374 2865 7175 616c 5f6e 616e 2864  lect(equal_nan(d
-0000b2e0: 665b 2261 225d 292e 616c 6961 7328 2265  f["a"]).alias("e
-0000b2f0: 7175 616c 5f6e 616e 2229 292e 636f 6c6c  qual_nan")).coll
-0000b300: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0000b310: 6f77 2845 5155 414c 5f4e 414e 3d46 616c  ow(EQUAL_NAN=Fal
-0000b320: 7365 292c 2052 6f77 2845 5155 414c 5f4e  se), Row(EQUAL_N
-0000b330: 414e 3d54 7275 6529 2c20 526f 7728 4551  AN=True), Row(EQ
-0000b340: 5541 4c5f 4e41 4e3d 4661 6c73 6529 5d0a  UAL_NAN=False)].
-0000b350: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000b360: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000b370: 2c20 2265 7175 616c 5f6e 616e 2229 0a20  , "equal_nan"). 
-0000b380: 2020 2072 6574 7572 6e20 632e 6571 7561     return c.equa
-0000b390: 6c5f 6e61 6e28 290a 0a0a 6465 6620 6973  l_nan()...def is
-0000b3a0: 5f6e 756c 6c28 653a 2043 6f6c 756d 6e4f  _null(e: ColumnO
-0000b3b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000b3c0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0000b3d0: 7475 726e 2074 7275 6520 6966 2074 6865  turn true if the
-0000b3e0: 2076 616c 7565 2069 6e20 7468 6520 636f   value in the co
-0000b3f0: 6c75 6d6e 2069 7320 6e75 6c6c 2e0a 0a20  lumn is null... 
-0000b400: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0000b410: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0000b420: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0000b430: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-0000b440: 7274 2069 735f 6e75 6c6c 0a20 2020 2020  rt is_null.     
-0000b450: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0000b460: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0000b470: 7261 6d65 285b 312e 322c 2066 6c6f 6174  rame([1.2, float
-0000b480: 2822 6e61 6e22 292c 204e 6f6e 652c 2031  ("nan"), None, 1
-0000b490: 2e30 5d2c 2073 6368 656d 613d 5b22 6122  .0], schema=["a"
-0000b4a0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000b4b0: 662e 7365 6c65 6374 2869 735f 6e75 6c6c  f.select(is_null
-0000b4c0: 2822 6122 292e 6173 5f28 2261 2229 292e  ("a").as_("a")).
-0000b4d0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0000b4e0: 2020 5b52 6f77 2841 3d46 616c 7365 292c    [Row(A=False),
-0000b4f0: 2052 6f77 2841 3d46 616c 7365 292c 2052   Row(A=False), R
-0000b500: 6f77 2841 3d54 7275 6529 2c20 526f 7728  ow(A=True), Row(
-0000b510: 413d 4661 6c73 6529 5d0a 2020 2020 2222  A=False)].    ""
-0000b520: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0000b530: 6c5f 6966 5f73 7472 2865 2c20 2269 735f  l_if_str(e, "is_
-0000b540: 6e75 6c6c 2229 0a20 2020 2072 6574 7572  null").    retur
-0000b550: 6e20 632e 6973 5f6e 756c 6c28 290a 0a0a  n c.is_null()...
-0000b560: 6465 6620 6e65 6761 7465 2865 3a20 436f  def negate(e: Co
-0000b570: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000b580: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-0000b590: 7475 726e 7320 7468 6520 6e65 6761 7469  turns the negati
-0000b5a0: 6f6e 206f 6620 7468 6520 7661 6c75 6520  on of the value 
-0000b5b0: 696e 2074 6865 2063 6f6c 756d 6e20 2865  in the column (e
-0000b5c0: 7175 6976 616c 656e 7420 746f 2061 2075  quivalent to a u
-0000b5d0: 6e61 7279 206d 696e 7573 292e 0a0a 2020  nary minus)...  
-0000b5e0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0000b5f0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000b600: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000b610: 6166 7261 6d65 285b 5b31 5d5d 2c20 7363  aframe([[1]], sc
-0000b620: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0000b630: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0000b640: 7428 6e65 6761 7465 2863 6f6c 2822 6122  t(negate(col("a"
-0000b650: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-0000b660: 2929 292e 7368 6f77 2829 0a20 2020 2020  ))).show().     
-0000b670: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0000b680: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-0000b690: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-0000b6a0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000b6b0: 2020 7c2d 3120 2020 2020 2020 207c 0a20    |-1        |. 
-0000b6c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000b6d0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-0000b6e0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-0000b6f0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0000b700: 5f69 665f 7374 7228 652c 2022 6e65 6761  _if_str(e, "nega
-0000b710: 7465 2229 0a20 2020 2072 6574 7572 6e20  te").    return 
-0000b720: 2d63 0a0a 0a64 6566 206e 6f74 5f28 653a  -c...def not_(e:
-0000b730: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0000b740: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0000b750: 2252 6574 7572 6e73 2074 6865 2069 6e76  "Returns the inv
-0000b760: 6572 7365 206f 6620 6120 626f 6f6c 6561  erse of a boolea
-0000b770: 6e20 6578 7072 6573 7369 6f6e 2e0a 0a20  n expression... 
-0000b780: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0000b790: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000b7a0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0000b7b0: 7461 6672 616d 6528 5b5b 5472 7565 5d5d  taframe([[True]]
-0000b7c0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0000b7d0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0000b7e0: 656c 6563 7428 6e6f 745f 2863 6f6c 2822  elect(not_(col("
-0000b7f0: 6122 292e 616c 6961 7328 2272 6573 756c  a").alias("resul
-0000b800: 7422 2929 292e 7368 6f77 2829 0a20 2020  t"))).show().   
-0000b810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000b820: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-0000b830: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-0000b840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000b850: 2020 2020 7c46 616c 7365 2020 2020 207c      |False     |
-0000b860: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000b870: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0000b880: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0000b890: 220a 0a20 2020 2063 203d 205f 746f 5f63  "..    c = _to_c
-0000b8a0: 6f6c 5f69 665f 7374 7228 652c 2022 6e6f  ol_if_str(e, "no
-0000b8b0: 745f 2229 0a20 2020 2072 6574 7572 6e20  t_").    return 
-0000b8c0: 7e63 0a0a 0a64 6566 2072 616e 646f 6d28  ~c...def random(
-0000b8d0: 7365 6564 3a20 4f70 7469 6f6e 616c 5b69  seed: Optional[i
-0000b8e0: 6e74 5d20 3d20 4e6f 6e65 2920 2d3e 2043  nt] = None) -> C
-0000b8f0: 6f6c 756d 6e3a 0a20 2020 2022 2222 4561  olumn:.    """Ea
-0000b900: 6368 2063 616c 6c20 7265 7475 726e 7320  ch call returns 
-0000b910: 6120 7073 6575 646f 2d72 616e 646f 6d20  a pseudo-random 
-0000b920: 3634 2d62 6974 2069 6e74 6567 6572 2e0a  64-bit integer..
-0000b930: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0000b940: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000b950: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-0000b960: 6563 7420 3122 290a 2020 2020 2020 2020  ect 1").        
-0000b970: 3e3e 3e20 6466 203d 2064 662e 7365 6c65  >>> df = df.sele
-0000b980: 6374 2872 616e 646f 6d28 3132 3329 2e61  ct(random(123).a
-0000b990: 6c69 6173 2822 7265 7375 6c74 2229 290a  lias("result")).
-0000b9a0: 2020 2020 2222 220a 2020 2020 7320 3d20      """.    s = 
-0000b9b0: 7365 6564 2069 6620 7365 6564 2069 7320  seed if seed is 
-0000b9c0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 7261  not None else ra
-0000b9d0: 6e64 696e 7428 2d28 322a 2a36 3329 2c20  ndint(-(2**63), 
-0000b9e0: 322a 2a36 3320 2d20 3129 0a20 2020 2072  2**63 - 1).    r
-0000b9f0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
-0000ba00: 616e 646f 6d22 2928 4c69 7465 7261 6c28  andom")(Literal(
-0000ba10: 7329 290a 0a0a 6465 6620 756e 6966 6f72  s))...def unifor
-0000ba20: 6d28 0a20 2020 206d 696e 5f3a 2055 6e69  m(.    min_: Uni
-0000ba30: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-0000ba40: 2069 6e74 2c20 666c 6f61 745d 2c0a 2020   int, float],.  
-0000ba50: 2020 6d61 785f 3a20 556e 696f 6e5b 436f    max_: Union[Co
-0000ba60: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
-0000ba70: 2066 6c6f 6174 5d2c 0a20 2020 2067 656e   float],.    gen
-0000ba80: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-0000ba90: 4e61 6d65 2c20 696e 742c 2066 6c6f 6174  Name, int, float
-0000baa0: 5d2c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  ],.) -> Column:.
-0000bab0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0000bac0: 726e 7320 6120 756e 6966 6f72 6d6c 7920  rns a uniformly 
-0000bad0: 7261 6e64 6f6d 206e 756d 6265 722e 0a0a  random number...
-0000bae0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0000baf0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0000bb00: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
-0000bb10: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0000bb20: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0000bb30: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-0000bb40: 2020 2020 205b 5b31 5d5d 2c0a 2020 2020       [[1]],.    
-0000bb50: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-0000bb60: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
-0000bb70: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
-0000bb80: 3e3e 3e20 6466 2e73 656c 6563 7428 756e  >>> df.select(un
-0000bb90: 6966 6f72 6d28 312c 2031 3030 2c20 636f  iform(1, 100, co
-0000bba0: 6c28 2261 2229 292e 616c 6961 7328 2255  l("a")).alias("U
-0000bbb0: 4e49 464f 524d 2229 292e 636f 6c6c 6563  NIFORM")).collec
-0000bbc0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0000bbd0: 2855 4e49 464f 524d 3d36 3229 5d0a 2020  (UNIFORM=62)].  
-0000bbe0: 2020 2222 220a 0a20 2020 2064 6566 2063    """..    def c
-0000bbf0: 6f6e 7665 7274 5f6c 696d 6974 5f74 6f5f  onvert_limit_to_
-0000bc00: 636f 6c28 6c69 6d69 7429 3a0a 2020 2020  col(limit):.    
-0000bc10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000bc20: 6528 6c69 6d69 742c 2069 6e74 293a 0a20  e(limit, int):. 
-0000bc30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000bc40: 6e20 6c69 7428 6c69 6d69 7429 0a20 2020  n lit(limit).   
-0000bc50: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-0000bc60: 616e 6365 286c 696d 6974 2c20 666c 6f61  ance(limit, floa
-0000bc70: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0000bc80: 7265 7475 726e 206c 6974 286c 696d 6974  return lit(limit
-0000bc90: 292e 6361 7374 2846 6c6f 6174 5479 7065  ).cast(FloatType
-0000bca0: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
-0000bcb0: 726e 205f 746f 5f63 6f6c 5f69 665f 7374  rn _to_col_if_st
-0000bcc0: 7228 6c69 6d69 742c 2022 756e 6966 6f72  r(limit, "unifor
-0000bcd0: 6d22 290a 0a20 2020 206d 696e 5f63 6f6c  m")..    min_col
-0000bce0: 203d 2063 6f6e 7665 7274 5f6c 696d 6974   = convert_limit
-0000bcf0: 5f74 6f5f 636f 6c28 6d69 6e5f 290a 2020  _to_col(min_).  
-0000bd00: 2020 6d61 785f 636f 6c20 3d20 636f 6e76    max_col = conv
-0000bd10: 6572 745f 6c69 6d69 745f 746f 5f63 6f6c  ert_limit_to_col
-0000bd20: 286d 6178 5f29 0a20 2020 2067 656e 5f63  (max_).    gen_c
-0000bd30: 6f6c 203d 2028 0a20 2020 2020 2020 206c  ol = (.        l
-0000bd40: 6974 2867 656e 2920 6966 2069 7369 6e73  it(gen) if isins
-0000bd50: 7461 6e63 6528 6765 6e2c 2028 696e 742c  tance(gen, (int,
-0000bd60: 2066 6c6f 6174 2929 2065 6c73 6520 5f74   float)) else _t
-0000bd70: 6f5f 636f 6c5f 6966 5f73 7472 2867 656e  o_col_if_str(gen
-0000bd80: 2c20 2275 6e69 666f 726d 2229 0a20 2020  , "uniform").   
-0000bd90: 2029 0a20 2020 2072 6574 7572 6e20 6275   ).    return bu
-0000bda0: 696c 7469 6e28 2275 6e69 666f 726d 2229  iltin("uniform")
-0000bdb0: 286d 696e 5f63 6f6c 2c20 6d61 785f 636f  (min_col, max_co
-0000bdc0: 6c2c 2067 656e 5f63 6f6c 290a 0a0a 6465  l, gen_col)...de
-0000bdd0: 6620 7365 7131 2873 6967 6e3a 2069 6e74  f seq1(sign: int
-0000bde0: 203d 2030 2920 2d3e 2043 6f6c 756d 6e3a   = 0) -> Column:
-0000bdf0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0000be00: 6120 7365 7175 656e 6365 206f 6620 6d6f  a sequence of mo
-0000be10: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
-0000be20: 6561 7369 6e67 2069 6e74 6567 6572 732c  easing integers,
-0000be30: 2077 6974 6820 7772 6170 2d61 726f 756e   with wrap-aroun
-0000be40: 640a 2020 2020 7768 6963 6820 6861 7070  d.    which happ
-0000be50: 656e 7320 6166 7465 7220 6c61 7267 6573  ens after larges
-0000be60: 7420 7265 7072 6573 656e 7461 626c 6520  t representable 
-0000be70: 696e 7465 6765 7220 6f66 2069 6e74 6567  integer of integ
-0000be80: 6572 2077 6964 7468 2031 2062 7974 652e  er width 1 byte.
-0000be90: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-0000bea0: 2020 2020 7369 676e 3a20 5768 656e 2030      sign: When 0
-0000beb0: 2c20 7468 6520 7365 7175 656e 6365 2063  , the sequence c
-0000bec0: 6f6e 7469 6e75 6573 2061 7420 3020 6166  ontinues at 0 af
-0000bed0: 7465 7220 7772 6170 2d61 726f 756e 642e  ter wrap-around.
-0000bee0: 2057 6865 6e20 312c 2074 6865 2073 6571   When 1, the seq
-0000bef0: 7565 6e63 650a 2020 2020 2020 2020 2020  uence.          
-0000bf00: 2020 636f 6e74 696e 7565 7320 6174 2073    continues at s
-0000bf10: 6d61 6c6c 6573 7420 7265 7072 6573 656e  mallest represen
-0000bf20: 7461 626c 6520 3120 6279 7465 2069 6e74  table 1 byte int
-0000bf30: 6567 6572 2e20 4465 6661 756c 7473 2074  eger. Defaults t
-0000bf40: 6f20 302e 0a0a 2020 2020 5365 6520 416c  o 0...    See Al
-0000bf50: 736f 3a0a 2020 2020 2020 2020 2d20 3a6d  so:.        - :m
-0000bf60: 6574 683a 6053 6573 7369 6f6e 2e67 656e  eth:`Session.gen
-0000bf70: 6572 6174 6f72 602c 2077 6869 6368 2063  erator`, which c
-0000bf80: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
-0000bf90: 6e65 7261 7465 2069 6e20 7461 6e64 656d  nerate in tandem
-0000bfa0: 2077 6974 6820 6073 6571 3160 2074 6f0a   with `seq1` to.
-0000bfb0: 2020 2020 2020 2020 2020 2020 6765 6e65              gene
-0000bfc0: 7261 7465 2073 6571 7565 6e63 6573 2e0a  rate sequences..
-0000bfd0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0000bfe0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000bff0: 7365 7373 696f 6e2e 6765 6e65 7261 746f  session.generato
-0000c000: 7228 7365 7131 2830 292c 2072 6f77 636f  r(seq1(0), rowco
-0000c010: 756e 743d 3329 0a20 2020 2020 2020 203e  unt=3).        >
-0000c020: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
-0000c030: 2020 2020 2020 2020 5b52 6f77 2853 4551          [Row(SEQ
-0000c040: 3128 3029 3d30 292c 2052 6f77 2853 4551  1(0)=0), Row(SEQ
-0000c050: 3128 3029 3d31 292c 2052 6f77 2853 4551  1(0)=1), Row(SEQ
-0000c060: 3128 3029 3d32 295d 0a20 2020 2022 2222  1(0)=2)].    """
-0000c070: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000c080: 7469 6e28 2273 6571 3122 2928 4c69 7465  tin("seq1")(Lite
-0000c090: 7261 6c28 7369 676e 2929 0a0a 0a64 6566  ral(sign))...def
-0000c0a0: 2073 6571 3228 7369 676e 3a20 696e 7420   seq2(sign: int 
-0000c0b0: 3d20 3029 202d 3e20 436f 6c75 6d6e 3a0a  = 0) -> Column:.
-0000c0c0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-0000c0d0: 2073 6571 7565 6e63 6520 6f66 206d 6f6e   sequence of mon
-0000c0e0: 6f74 6f6e 6963 616c 6c79 2069 6e63 7265  otonically incre
-0000c0f0: 6173 696e 6720 696e 7465 6765 7273 2c20  asing integers, 
-0000c100: 7769 7468 2077 7261 702d 6172 6f75 6e64  with wrap-around
-0000c110: 0a20 2020 2077 6869 6368 2068 6170 7065  .    which happe
-0000c120: 6e73 2061 6674 6572 206c 6172 6765 7374  ns after largest
-0000c130: 2072 6570 7265 7365 6e74 6162 6c65 2069   representable i
-0000c140: 6e74 6567 6572 206f 6620 696e 7465 6765  nteger of intege
-0000c150: 7220 7769 6474 6820 3220 6279 7465 2e0a  r width 2 byte..
-0000c160: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-0000c170: 2020 2073 6967 6e3a 2057 6865 6e20 302c     sign: When 0,
-0000c180: 2074 6865 2073 6571 7565 6e63 6520 636f   the sequence co
-0000c190: 6e74 696e 7565 7320 6174 2030 2061 6674  ntinues at 0 aft
-0000c1a0: 6572 2077 7261 702d 6172 6f75 6e64 2e20  er wrap-around. 
-0000c1b0: 5768 656e 2031 2c20 7468 6520 7365 7175  When 1, the sequ
-0000c1c0: 656e 6365 0a20 2020 2020 2020 2020 2020  ence.           
-0000c1d0: 2063 6f6e 7469 6e75 6573 2061 7420 736d   continues at sm
-0000c1e0: 616c 6c65 7374 2072 6570 7265 7365 6e74  allest represent
-0000c1f0: 6162 6c65 2032 2062 7974 6520 696e 7465  able 2 byte inte
-0000c200: 6765 722e 2044 6566 6175 6c74 7320 746f  ger. Defaults to
-0000c210: 2030 2e0a 0a20 2020 2053 6565 2041 6c73   0...    See Als
-0000c220: 6f3a 0a20 2020 2020 2020 202d 203a 6d65  o:.        - :me
-0000c230: 7468 3a60 5365 7373 696f 6e2e 6765 6e65  th:`Session.gene
-0000c240: 7261 746f 7260 2c20 7768 6963 6820 6361  rator`, which ca
-0000c250: 6e20 6265 2075 7365 6420 746f 2067 656e  n be used to gen
-0000c260: 6572 6174 6520 696e 2074 616e 6465 6d20  erate in tandem 
-0000c270: 7769 7468 2060 7365 7132 6020 746f 0a20  with `seq2` to. 
-0000c280: 2020 2020 2020 2020 2020 2067 656e 6572             gener
-0000c290: 6174 6520 7365 7175 656e 6365 732e 0a0a  ate sequences...
-0000c2a0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0000c2b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0000c2c0: 6573 7369 6f6e 2e67 656e 6572 6174 6f72  ession.generator
-0000c2d0: 2873 6571 3228 3029 2c20 726f 7763 6f75  (seq2(0), rowcou
-0000c2e0: 6e74 3d33 290a 2020 2020 2020 2020 3e3e  nt=3).        >>
-0000c2f0: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
-0000c300: 2020 2020 2020 205b 526f 7728 5345 5132         [Row(SEQ2
-0000c310: 2830 293d 3029 2c20 526f 7728 5345 5132  (0)=0), Row(SEQ2
-0000c320: 2830 293d 3129 2c20 526f 7728 5345 5132  (0)=1), Row(SEQ2
-0000c330: 2830 293d 3229 5d0a 2020 2020 2222 220a  (0)=2)].    """.
-0000c340: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000c350: 696e 2822 7365 7132 2229 284c 6974 6572  in("seq2")(Liter
-0000c360: 616c 2873 6967 6e29 290a 0a0a 6465 6620  al(sign))...def 
-0000c370: 7365 7134 2873 6967 6e3a 2069 6e74 203d  seq4(sign: int =
-0000c380: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
-0000c390: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-0000c3a0: 7365 7175 656e 6365 206f 6620 6d6f 6e6f  sequence of mono
-0000c3b0: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
-0000c3c0: 7369 6e67 2069 6e74 6567 6572 732c 2077  sing integers, w
-0000c3d0: 6974 6820 7772 6170 2d61 726f 756e 640a  ith wrap-around.
-0000c3e0: 2020 2020 7768 6963 6820 6861 7070 656e      which happen
-0000c3f0: 7320 6166 7465 7220 6c61 7267 6573 7420  s after largest 
-0000c400: 7265 7072 6573 656e 7461 626c 6520 696e  representable in
-0000c410: 7465 6765 7220 6f66 2069 6e74 6567 6572  teger of integer
-0000c420: 2077 6964 7468 2034 2062 7974 652e 0a0a   width 4 byte...
-0000c430: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0000c440: 2020 7369 676e 3a20 5768 656e 2030 2c20    sign: When 0, 
-0000c450: 7468 6520 7365 7175 656e 6365 2063 6f6e  the sequence con
-0000c460: 7469 6e75 6573 2061 7420 3020 6166 7465  tinues at 0 afte
-0000c470: 7220 7772 6170 2d61 726f 756e 642e 2057  r wrap-around. W
-0000c480: 6865 6e20 312c 2074 6865 2073 6571 7565  hen 1, the seque
-0000c490: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-0000c4a0: 636f 6e74 696e 7565 7320 6174 2073 6d61  continues at sma
-0000c4b0: 6c6c 6573 7420 7265 7072 6573 656e 7461  llest representa
-0000c4c0: 626c 6520 3420 6279 7465 2069 6e74 6567  ble 4 byte integ
-0000c4d0: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
-0000c4e0: 302e 0a0a 2020 2020 5365 6520 416c 736f  0...    See Also
-0000c4f0: 3a0a 2020 2020 2020 2020 2d20 3a6d 6574  :.        - :met
-0000c500: 683a 6053 6573 7369 6f6e 2e67 656e 6572  h:`Session.gener
-0000c510: 6174 6f72 602c 2077 6869 6368 2063 616e  ator`, which can
-0000c520: 2062 6520 7573 6564 2074 6f20 6765 6e65   be used to gene
-0000c530: 7261 7465 2069 6e20 7461 6e64 656d 2077  rate in tandem w
-0000c540: 6974 6820 6073 6571 3460 2074 6f0a 2020  ith `seq4` to.  
-0000c550: 2020 2020 2020 2020 2020 6765 6e65 7261            genera
-0000c560: 7465 2073 6571 7565 6e63 6573 2e0a 0a20  te sequences... 
-0000c570: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0000c580: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000c590: 7373 696f 6e2e 6765 6e65 7261 746f 7228  ssion.generator(
-0000c5a0: 7365 7134 2830 292c 2072 6f77 636f 756e  seq4(0), rowcoun
-0000c5b0: 743d 3329 0a20 2020 2020 2020 203e 3e3e  t=3).        >>>
-0000c5c0: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
-0000c5d0: 2020 2020 2020 5b52 6f77 2853 4551 3428        [Row(SEQ4(
-0000c5e0: 3029 3d30 292c 2052 6f77 2853 4551 3428  0)=0), Row(SEQ4(
-0000c5f0: 3029 3d31 292c 2052 6f77 2853 4551 3428  0)=1), Row(SEQ4(
-0000c600: 3029 3d32 295d 0a20 2020 2022 2222 0a20  0)=2)].    """. 
-0000c610: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0000c620: 6e28 2273 6571 3422 2928 4c69 7465 7261  n("seq4")(Litera
-0000c630: 6c28 7369 676e 2929 0a0a 0a64 6566 2073  l(sign))...def s
-0000c640: 6571 3828 7369 676e 3a20 696e 7420 3d20  eq8(sign: int = 
-0000c650: 3029 202d 3e20 436f 6c75 6d6e 3a0a 2020  0) -> Column:.  
-0000c660: 2020 2222 2252 6574 7572 6e73 2061 2073    """Returns a s
-0000c670: 6571 7565 6e63 6520 6f66 206d 6f6e 6f74  equence of monot
-0000c680: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
-0000c690: 696e 6720 696e 7465 6765 7273 2c20 7769  ing integers, wi
-0000c6a0: 7468 2077 7261 702d 6172 6f75 6e64 0a20  th wrap-around. 
-0000c6b0: 2020 2077 6869 6368 2068 6170 7065 6e73     which happens
-0000c6c0: 2061 6674 6572 206c 6172 6765 7374 2072   after largest r
-0000c6d0: 6570 7265 7365 6e74 6162 6c65 2069 6e74  epresentable int
-0000c6e0: 6567 6572 206f 6620 696e 7465 6765 7220  eger of integer 
-0000c6f0: 7769 6474 6820 3820 6279 7465 2e0a 0a20  width 8 byte... 
-0000c700: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000c710: 2073 6967 6e3a 2057 6865 6e20 302c 2074   sign: When 0, t
-0000c720: 6865 2073 6571 7565 6e63 6520 636f 6e74  he sequence cont
-0000c730: 696e 7565 7320 6174 2030 2061 6674 6572  inues at 0 after
-0000c740: 2077 7261 702d 6172 6f75 6e64 2e20 5768   wrap-around. Wh
-0000c750: 656e 2031 2c20 7468 6520 7365 7175 656e  en 1, the sequen
-0000c760: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
-0000c770: 6f6e 7469 6e75 6573 2061 7420 736d 616c  ontinues at smal
-0000c780: 6c65 7374 2072 6570 7265 7365 6e74 6162  lest representab
-0000c790: 6c65 2038 2062 7974 6520 696e 7465 6765  le 8 byte intege
-0000c7a0: 722e 2044 6566 6175 6c74 7320 746f 2030  r. Defaults to 0
-0000c7b0: 2e0a 0a20 2020 2053 6565 2041 6c73 6f3a  ...    See Also:
-0000c7c0: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
-0000c7d0: 3a60 5365 7373 696f 6e2e 6765 6e65 7261  :`Session.genera
-0000c7e0: 746f 7260 2c20 7768 6963 6820 6361 6e20  tor`, which can 
-0000c7f0: 6265 2075 7365 6420 746f 2067 656e 6572  be used to gener
-0000c800: 6174 6520 696e 2074 616e 6465 6d20 7769  ate in tandem wi
-0000c810: 7468 2060 7365 7138 6020 746f 0a20 2020  th `seq8` to.   
-0000c820: 2020 2020 2020 2020 2067 656e 6572 6174           generat
-0000c830: 6520 7365 7175 656e 6365 732e 0a0a 2020  e sequences...  
-0000c840: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-0000c850: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000c860: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
-0000c870: 6571 3828 3029 2c20 726f 7763 6f75 6e74  eq8(0), rowcount
-0000c880: 3d33 290a 2020 2020 2020 2020 3e3e 3e20  =3).        >>> 
-0000c890: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
-0000c8a0: 2020 2020 205b 526f 7728 5345 5138 2830       [Row(SEQ8(0
-0000c8b0: 293d 3029 2c20 526f 7728 5345 5138 2830  )=0), Row(SEQ8(0
-0000c8c0: 293d 3129 2c20 526f 7728 5345 5138 2830  )=1), Row(SEQ8(0
-0000c8d0: 293d 3229 5d0a 2020 2020 2222 220a 2020  )=2)].    """.  
-0000c8e0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0000c8f0: 2822 7365 7138 2229 284c 6974 6572 616c  ("seq8")(Literal
-0000c900: 2873 6967 6e29 290a 0a0a 6465 6620 746f  (sign))...def to
-0000c910: 5f64 6563 696d 616c 2865 3a20 436f 6c75  _decimal(e: Colu
-0000c920: 6d6e 4f72 4e61 6d65 2c20 7072 6563 6973  mnOrName, precis
-0000c930: 696f 6e3a 2069 6e74 2c20 7363 616c 653a  ion: int, scale:
-0000c940: 2069 6e74 2920 2d3e 2043 6f6c 756d 6e3a   int) -> Column:
-0000c950: 0a20 2020 2022 2222 436f 6e76 6572 7473  .    """Converts
-0000c960: 2061 6e20 696e 7075 7420 6578 7072 6573   an input expres
-0000c970: 7369 6f6e 2074 6f20 6120 6465 6369 6d61  sion to a decima
-0000c980: 6c2e 0a0a 2020 2020 4578 616d 706c 653a  l...    Example:
-0000c990: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-0000c9a0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0000c9b0: 655f 6461 7461 6672 616d 6528 5b27 3132  e_dataframe(['12
-0000c9c0: 272c 2027 3131 2e33 272c 2027 2d39 302e  ', '11.3', '-90.
-0000c9d0: 3132 3334 3527 5d2c 2073 6368 656d 613d  12345'], schema=
-0000c9e0: 5b27 6127 5d29 0a20 2020 2020 2020 203e  ['a']).        >
-0000c9f0: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
-0000ca00: 6465 6369 6d61 6c28 636f 6c28 2761 2729  decimal(col('a')
-0000ca10: 2c20 3338 2c20 3029 2e61 735f 2827 616e  , 38, 0).as_('an
-0000ca20: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
-0000ca30: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-0000ca40: 3132 292c 2052 6f77 2841 4e53 3d31 3129  12), Row(ANS=11)
-0000ca50: 2c20 526f 7728 414e 533d 2d39 3029 5d0a  , Row(ANS=-90)].
-0000ca60: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000ca70: 7365 6c65 6374 2874 6f5f 6465 6369 6d61  select(to_decima
-0000ca80: 6c28 636f 6c28 2761 2729 2c20 3338 2c20  l(col('a'), 38, 
-0000ca90: 3229 2e61 735f 2827 616e 7327 2929 2e63  2).as_('ans')).c
-0000caa0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0000cab0: 205b 526f 7728 414e 533d 4465 6369 6d61   [Row(ANS=Decima
-0000cac0: 6c28 2731 322e 3030 2729 292c 2052 6f77  l('12.00')), Row
-0000cad0: 2841 4e53 3d44 6563 696d 616c 2827 3131  (ANS=Decimal('11
-0000cae0: 2e33 3027 2929 2c20 526f 7728 414e 533d  .30')), Row(ANS=
-0000caf0: 4465 6369 6d61 6c28 272d 3930 2e31 3227  Decimal('-90.12'
-0000cb00: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-0000cb10: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0000cb20: 7472 2865 2c20 2274 6f5f 6465 6369 6d61  tr(e, "to_decima
-0000cb30: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
-0000cb40: 7569 6c74 696e 2822 746f 5f64 6563 696d  uiltin("to_decim
-0000cb50: 616c 2229 2863 2c20 6c69 7428 7072 6563  al")(c, lit(prec
-0000cb60: 6973 696f 6e29 2c20 6c69 7428 7363 616c  ision), lit(scal
-0000cb70: 6529 290a 0a0a 6465 6620 6469 7630 280a  e))...def div0(.
-0000cb80: 2020 2020 6469 7669 6465 6e64 3a20 556e      dividend: Un
-0000cb90: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-0000cba0: 2c20 696e 742c 2066 6c6f 6174 5d2c 2064  , int, float], d
-0000cbb0: 6976 6973 6f72 3a20 556e 696f 6e5b 436f  ivisor: Union[Co
-0000cbc0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
-0000cbd0: 2066 6c6f 6174 5d0a 2920 2d3e 2043 6f6c   float].) -> Col
-0000cbe0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0000cbf0: 2050 6572 666f 726d 7320 6469 7669 7369   Performs divisi
-0000cc00: 6f6e 206c 696b 6520 7468 6520 6469 7669  on like the divi
-0000cc10: 7369 6f6e 206f 7065 7261 746f 7220 282f  sion operator (/
-0000cc20: 292c 0a20 2020 2062 7574 2072 6574 7572  ),.    but retur
-0000cc30: 6e73 2030 2077 6865 6e20 7468 6520 6469  ns 0 when the di
-0000cc40: 7669 736f 7220 6973 2030 2028 7261 7468  visor is 0 (rath
-0000cc50: 6572 2074 6861 6e20 7265 706f 7274 696e  er than reportin
-0000cc60: 6720 616e 2065 7272 6f72 292e 0a0a 2020  g an error)...  
-0000cc70: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0000cc80: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000cc90: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000cca0: 6166 7261 6d65 285b 315d 2c20 7363 6865  aframe([1], sche
-0000ccb0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-0000ccc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0000ccd0: 6469 7630 2864 665b 2261 225d 2c20 3129  div0(df["a"], 1)
-0000cce0: 2e61 6c69 6173 2822 6469 7669 6465 645f  .alias("divided_
-0000ccf0: 6279 5f6f 6e65 2229 2c20 6469 7630 2864  by_one"), div0(d
-0000cd00: 665b 2261 225d 2c20 3029 2e61 6c69 6173  f["a"], 0).alias
-0000cd10: 2822 6469 7669 6465 645f 6279 5f7a 6572  ("divided_by_zer
-0000cd20: 6f22 2929 2e63 6f6c 6c65 6374 2829 0a20  o")).collect(). 
-0000cd30: 2020 2020 2020 205b 526f 7728 4449 5649         [Row(DIVI
-0000cd40: 4445 445f 4259 5f4f 4e45 3d44 6563 696d  DED_BY_ONE=Decim
-0000cd50: 616c 2827 312e 3030 3030 3030 2729 2c20  al('1.000000'), 
-0000cd60: 4449 5649 4445 445f 4259 5f5a 4552 4f3d  DIVIDED_BY_ZERO=
-0000cd70: 4465 6369 6d61 6c28 2730 2e30 3030 3030  Decimal('0.00000
-0000cd80: 3027 2929 5d0a 2020 2020 2222 220a 2020  0'))].    """.  
-0000cd90: 2020 6469 7669 6465 6e64 5f63 6f6c 203d    dividend_col =
-0000cda0: 2028 0a20 2020 2020 2020 206c 6974 2864   (.        lit(d
-0000cdb0: 6976 6964 656e 6429 0a20 2020 2020 2020  ividend).       
-0000cdc0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
-0000cdd0: 6976 6964 656e 642c 2028 696e 742c 2066  ividend, (int, f
-0000cde0: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
-0000cdf0: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
-0000ce00: 7472 2864 6976 6964 656e 642c 2022 6469  tr(dividend, "di
-0000ce10: 7630 2229 0a20 2020 2029 0a20 2020 2064  v0").    ).    d
-0000ce20: 6976 6973 6f72 5f63 6f6c 203d 2028 0a20  ivisor_col = (. 
-0000ce30: 2020 2020 2020 206c 6974 2864 6976 6973         lit(divis
-0000ce40: 6f72 290a 2020 2020 2020 2020 6966 2069  or).        if i
-0000ce50: 7369 6e73 7461 6e63 6528 6469 7669 736f  sinstance(diviso
-0000ce60: 722c 2028 696e 742c 2066 6c6f 6174 2929  r, (int, float))
-0000ce70: 0a20 2020 2020 2020 2065 6c73 6520 5f74  .        else _t
-0000ce80: 6f5f 636f 6c5f 6966 5f73 7472 2864 6976  o_col_if_str(div
-0000ce90: 6973 6f72 2c20 2264 6976 3022 290a 2020  isor, "div0").  
-0000cea0: 2020 290a 2020 2020 7265 7475 726e 2062    ).    return b
-0000ceb0: 7569 6c74 696e 2822 6469 7630 2229 2864  uiltin("div0")(d
-0000cec0: 6976 6964 656e 645f 636f 6c2c 2064 6976  ividend_col, div
-0000ced0: 6973 6f72 5f63 6f6c 290a 0a0a 6465 6620  isor_col)...def 
-0000cee0: 7371 7274 2865 3a20 436f 6c75 6d6e 4f72  sqrt(e: ColumnOr
-0000cef0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0000cf00: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0000cf10: 7468 6520 7371 7561 7265 2d72 6f6f 7420  the square-root 
-0000cf20: 6f66 2061 206e 6f6e 2d6e 6567 6174 6976  of a non-negativ
-0000cf30: 6520 6e75 6d65 7269 6320 6578 7072 6573  e numeric expres
-0000cf40: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
-0000cf50: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-0000cf60: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0000cf70: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-0000cf80: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0000cf90: 5b34 2c20 395d 2c0a 2020 2020 2020 2020  [4, 9],.        
-0000cfa0: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
-0000cfb0: 224e 225d 2c0a 2020 2020 2020 2020 2e2e  "N"],.        ..
-0000cfc0: 2e20 292e 7365 6c65 6374 2873 7172 7428  . ).select(sqrt(
-0000cfd0: 636f 6c28 224e 2229 2929 0a20 2020 2020  col("N"))).     
-0000cfe0: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
-0000cff0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0000d000: 2853 5152 5428 224e 2229 3d32 2e30 292c  (SQRT("N")=2.0),
-0000d010: 2052 6f77 2853 5152 5428 224e 2229 3d33   Row(SQRT("N")=3
-0000d020: 2e30 295d 0a20 2020 2022 2222 0a20 2020  .0)].    """.   
-0000d030: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0000d040: 7374 7228 652c 2022 7371 7274 2229 0a20  str(e, "sqrt"). 
-0000d050: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0000d060: 6e28 2273 7172 7422 2928 6329 0a0a 0a64  n("sqrt")(c)...d
-0000d070: 6566 2061 6273 2865 3a20 436f 6c75 6d6e  ef abs(e: Column
-0000d080: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000d090: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-0000d0a0: 7320 7468 6520 6162 736f 6c75 7465 2076  s the absolute v
-0000d0b0: 616c 7565 206f 6620 6120 6e75 6d65 7269  alue of a numeri
-0000d0c0: 6320 6578 7072 6573 7369 6f6e 2e0a 0a20  c expression... 
-0000d0d0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0000d0e0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000d0f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000d100: 6166 7261 6d65 285b 5b2d 315d 5d2c 2073  aframe([[-1]], s
-0000d110: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000d120: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000d130: 6374 2861 6273 2863 6f6c 2822 6122 2929  ct(abs(col("a"))
-0000d140: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-0000d150: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0000d160: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0000d170: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-0000d180: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0000d190: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000d1a0: 7c31 2020 2020 2020 2020 207c 0a20 2020  |1         |.   
-0000d1b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000d1c0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0000d1d0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0000d1e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0000d1f0: 5f73 7472 2865 2c20 2261 6273 2229 0a20  _str(e, "abs"). 
-0000d200: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0000d210: 6e28 2261 6273 2229 2863 290a 0a0a 6465  n("abs")(c)...de
-0000d220: 6620 6163 6f73 2865 3a20 436f 6c75 6d6e  f acos(e: Column
-0000d230: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000d240: 6e3a 0a20 2020 2022 2222 436f 6d70 7574  n:.    """Comput
-0000d250: 6573 2074 6865 2069 6e76 6572 7365 2063  es the inverse c
-0000d260: 6f73 696e 6520 2861 7263 2063 6f73 696e  osine (arc cosin
-0000d270: 6529 206f 6620 6974 7320 696e 7075 743b  e) of its input;
-0000d280: 0a20 2020 2074 6865 2072 6573 756c 7420  .    the result 
-0000d290: 6973 2061 206e 756d 6265 7220 696e 2074  is a number in t
-0000d2a0: 6865 2069 6e74 6572 7661 6c20 5b2d 7069  he interval [-pi
-0000d2b0: 2c20 7069 5d2e 0a0a 2020 2020 4578 616d  , pi]...    Exam
-0000d2c0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-0000d2d0: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-0000d2e0: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
-0000d2f0: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
-0000d300: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-0000d310: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000d320: 7465 5f64 6174 6166 7261 6d65 285b 5b30  te_dataframe([[0
-0000d330: 2e35 5d5d 2c20 7363 6865 6d61 3d5b 2264  .5]], schema=["d
-0000d340: 6567 225d 290a 2020 2020 2020 2020 3e3e  eg"]).        >>
-0000d350: 3e20 6466 2e73 656c 6563 7428 6163 6f73  > df.select(acos
-0000d360: 2863 6f6c 2822 6465 6722 2929 2e63 6173  (col("deg")).cas
-0000d370: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
-0000d380: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
-0000d390: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-0000d3a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000d3b0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-0000d3c0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-0000d3d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-0000d3e0: 2020 2020 2020 207c 312e 3034 3720 2020         |1.047   
-0000d3f0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0000d400: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000d410: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0000d420: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0000d430: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-0000d440: 6163 6f73 2229 0a20 2020 2072 6574 7572  acos").    retur
-0000d450: 6e20 6275 696c 7469 6e28 2261 636f 7322  n builtin("acos"
-0000d460: 2928 6329 0a0a 0a64 6566 2061 7369 6e28  )(c)...def asin(
-0000d470: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0000d480: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0000d490: 2222 2243 6f6d 7075 7465 7320 7468 6520  """Computes the 
-0000d4a0: 696e 7665 7273 6520 7369 6e65 2028 6172  inverse sine (ar
-0000d4b0: 6320 7369 6e65 2920 6f66 2069 7473 2069  c sine) of its i
-0000d4c0: 6e70 7574 3b0a 2020 2020 7468 6520 7265  nput;.    the re
-0000d4d0: 7375 6c74 2069 7320 6120 6e75 6d62 6572  sult is a number
-0000d4e0: 2069 6e20 7468 6520 696e 7465 7276 616c   in the interval
-0000d4f0: 205b 2d70 692c 2070 695d 2e0a 0a20 2020   [-pi, pi]...   
-0000d500: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0000d510: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0000d520: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0000d530: 7970 6573 2069 6d70 6f72 7420 4465 6369  ypes import Deci
-0000d540: 6d61 6c54 7970 650a 2020 2020 2020 2020  malType.        
-0000d550: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0000d560: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0000d570: 6528 5b5b 315d 5d2c 2073 6368 656d 613d  e([[1]], schema=
-0000d580: 5b22 6465 6722 5d29 0a20 2020 2020 2020  ["deg"]).       
-0000d590: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-0000d5a0: 7369 6e28 636f 6c28 2264 6567 2229 292e  sin(col("deg")).
-0000d5b0: 6361 7374 2844 6563 696d 616c 5479 7065  cast(DecimalType
-0000d5c0: 2873 6361 6c65 3d33 2929 2e61 6c69 6173  (scale=3)).alias
-0000d5d0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-0000d5e0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0000d5f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000d600: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-0000d610: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000d620: 2d0a 2020 2020 2020 2020 7c31 2e35 3731  -.        |1.571
-0000d630: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0000d640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000d650: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-0000d660: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0000d670: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0000d680: 2c20 2261 7369 6e22 290a 2020 2020 7265  , "asin").    re
-0000d690: 7475 726e 2062 7569 6c74 696e 2822 6173  turn builtin("as
-0000d6a0: 696e 2229 2863 290a 0a0a 6465 6620 6174  in")(c)...def at
-0000d6b0: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
-0000d6c0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0000d6d0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
-0000d6e0: 6865 2069 6e76 6572 7365 2074 616e 6765  he inverse tange
-0000d6f0: 6e74 2028 6172 6320 7461 6e67 656e 7429  nt (arc tangent)
-0000d700: 206f 6620 6974 7320 696e 7075 743b 0a20   of its input;. 
-0000d710: 2020 2074 6865 2072 6573 756c 7420 6973     the result is
-0000d720: 2061 206e 756d 6265 7220 696e 2074 6865   a number in the
-0000d730: 2069 6e74 6572 7661 6c20 5b2d 7069 2c20   interval [-pi, 
-0000d740: 7069 5d2e 0a0a 2020 2020 4578 616d 706c  pi]...    Exampl
-0000d750: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0000d760: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0000d770: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0000d780: 706f 7274 2044 6563 696d 616c 5479 7065  port DecimalType
-0000d790: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000d7a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000d7b0: 5f64 6174 6166 7261 6d65 285b 5b31 5d5d  _dataframe([[1]]
-0000d7c0: 2c20 7363 6865 6d61 3d5b 2264 6567 225d  , schema=["deg"]
-0000d7d0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000d7e0: 2e73 656c 6563 7428 6174 616e 2863 6f6c  .select(atan(col
-0000d7f0: 2822 6465 6722 2929 2e63 6173 7428 4465  ("deg")).cast(De
-0000d800: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
-0000d810: 3329 292e 616c 6961 7328 2272 6573 756c  3)).alias("resul
-0000d820: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-0000d830: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0000d840: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0000d850: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-0000d860: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000d870: 2020 207c 302e 3738 3520 2020 2020 7c0a     |0.785     |.
-0000d880: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000d890: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0000d8a0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0000d8b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0000d8c0: 5f69 665f 7374 7228 652c 2022 6174 616e  _if_str(e, "atan
-0000d8d0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0000d8e0: 696c 7469 6e28 2261 7461 6e22 2928 6329  iltin("atan")(c)
-0000d8f0: 0a0a 0a64 6566 2061 7461 6e32 2879 3a20  ...def atan2(y: 
-0000d900: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 783a  ColumnOrName, x:
-0000d910: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0000d920: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0000d930: 2243 6f6d 7075 7465 7320 7468 6520 696e  "Computes the in
-0000d940: 7665 7273 6520 7461 6e67 656e 7420 2861  verse tangent (a
-0000d950: 7263 2074 616e 6765 6e74 2920 6f66 2069  rc tangent) of i
-0000d960: 7473 2069 6e70 7574 3b0a 2020 2020 7468  ts input;.    th
-0000d970: 6520 7265 7375 6c74 2069 7320 6120 6e75  e result is a nu
-0000d980: 6d62 6572 2069 6e20 7468 6520 696e 7465  mber in the inte
-0000d990: 7276 616c 205b 2d70 692c 2070 695d 2e0a  rval [-pi, pi]..
-0000d9a0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0000d9b0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0000d9c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0000d9d0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0000d9e0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
-0000d9f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000da00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0000da10: 6672 616d 6528 5b5b 312c 2032 5d5d 2c20  frame([[1, 2]], 
-0000da20: 7363 6865 6d61 3d5b 2278 222c 2022 7922  schema=["x", "y"
-0000da30: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000da40: 662e 7365 6c65 6374 2861 7461 6e32 2864  f.select(atan2(d
-0000da50: 662e 782c 2064 662e 7929 2e63 6173 7428  f.x, df.y).cast(
-0000da60: 4465 6369 6d61 6c54 7970 6528 7363 616c  DecimalType(scal
-0000da70: 653d 3329 292e 616c 6961 7328 2272 6573  e=3)).alias("res
-0000da80: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0000da90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000daa0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0000dab0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-0000dac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0000dad0: 2020 2020 207c 302e 3436 3420 2020 2020       |0.464     
-0000dae0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0000daf0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0000db00: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0000db10: 2222 0a20 2020 2079 5f63 6f6c 203d 205f  "".    y_col = _
-0000db20: 746f 5f63 6f6c 5f69 665f 7374 7228 792c  to_col_if_str(y,
-0000db30: 2022 6174 616e 3222 290a 2020 2020 785f   "atan2").    x_
-0000db40: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
-0000db50: 5f73 7472 2878 2c20 2261 7461 6e32 2229  _str(x, "atan2")
-0000db60: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000db70: 7469 6e28 2261 7461 6e32 2229 2879 5f63  tin("atan2")(y_c
-0000db80: 6f6c 2c20 785f 636f 6c29 0a0a 0a64 6566  ol, x_col)...def
-0000db90: 2063 6569 6c28 653a 2043 6f6c 756d 6e4f   ceil(e: ColumnO
-0000dba0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000dbb0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-0000dbc0: 2076 616c 7565 7320 6672 6f6d 2074 6865   values from the
-0000dbd0: 2073 7065 6369 6669 6564 2063 6f6c 756d   specified colum
-0000dbe0: 6e20 726f 756e 6465 6420 746f 2074 6865  n rounded to the
-0000dbf0: 206e 6561 7265 7374 2065 7175 616c 206f   nearest equal o
-0000dc00: 7220 6c61 7267 6572 0a20 2020 2069 6e74  r larger.    int
-0000dc10: 6567 6572 2e0a 0a20 2020 2045 7861 6d70  eger...    Examp
-0000dc20: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-0000dc30: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000dc40: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000dc50: 5b31 3335 2e31 3335 2c20 2d39 3735 2e39  [135.135, -975.9
-0000dc60: 3735 5d2c 2073 6368 656d 613d 5b22 6122  75], schema=["a"
-0000dc70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000dc80: 662e 7365 6c65 6374 2863 6569 6c28 6466  f.select(ceil(df
-0000dc90: 5b22 6122 5d29 2e61 6c69 6173 2822 6365  ["a"]).alias("ce
-0000dca0: 696c 2229 292e 636f 6c6c 6563 7428 290a  il")).collect().
-0000dcb0: 2020 2020 2020 2020 5b52 6f77 2843 4549          [Row(CEI
-0000dcc0: 4c3d 3133 362e 3029 2c20 526f 7728 4345  L=136.0), Row(CE
-0000dcd0: 494c 3d2d 3937 352e 3029 5d0a 2020 2020  IL=-975.0)].    
-0000dce0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0000dcf0: 636f 6c5f 6966 5f73 7472 2865 2c20 2263  col_if_str(e, "c
-0000dd00: 6569 6c22 290a 2020 2020 7265 7475 726e  eil").    return
-0000dd10: 2062 7569 6c74 696e 2822 6365 696c 2229   builtin("ceil")
-0000dd20: 2863 290a 0a0a 6465 6620 636f 7328 653a  (c)...def cos(e:
-0000dd30: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0000dd40: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0000dd50: 2243 6f6d 7075 7465 7320 7468 6520 636f  "Computes the co
-0000dd60: 7369 6e65 206f 6620 6974 7320 6172 6775  sine of its argu
-0000dd70: 6d65 6e74 3b20 7468 6520 6172 6775 6d65  ment; the argume
-0000dd80: 6e74 2073 686f 756c 6420 6265 2065 7870  nt should be exp
-0000dd90: 7265 7373 6564 2069 6e20 7261 6469 616e  ressed in radian
-0000dda0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
-0000ddb0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0000ddc0: 6d20 6d61 7468 2069 6d70 6f72 7420 7069  m math import pi
-0000ddd0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000dde0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000ddf0: 5f64 6174 6166 7261 6d65 285b 5b70 695d  _dataframe([[pi]
-0000de00: 5d2c 2073 6368 656d 613d 5b22 6465 6722  ], schema=["deg"
-0000de10: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0000de20: 662e 7365 6c65 6374 2863 6f73 2863 6f6c  f.select(cos(col
-0000de30: 2822 6465 6722 2929 2e61 6c69 6173 2822  ("deg")).alias("
-0000de40: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-0000de50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000de60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-0000de70: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-0000de80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-0000de90: 2020 2020 2020 2020 7c2d 312e 3020 2020          |-1.0   
-0000dea0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-0000deb0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000dec0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0000ded0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000dee0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000def0: 2263 6f73 2229 0a20 2020 2072 6574 7572  "cos").    retur
-0000df00: 6e20 6275 696c 7469 6e28 2263 6f73 2229  n builtin("cos")
-0000df10: 2863 290a 0a0a 6465 6620 636f 7368 2865  (c)...def cosh(e
-0000df20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0000df30: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0000df40: 2222 436f 6d70 7574 6573 2074 6865 2068  ""Computes the h
-0000df50: 7970 6572 626f 6c69 6320 636f 7369 6e65  yperbolic cosine
-0000df60: 206f 6620 6974 7320 6172 6775 6d65 6e74   of its argument
-0000df70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
-0000df80: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0000df90: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0000dfa0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-0000dfb0: 2044 6563 696d 616c 5479 7065 0a20 2020   DecimalType.   
-0000dfc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0000dfd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0000dfe0: 6166 7261 6d65 285b 5b30 5d5d 2c20 7363  aframe([[0]], sc
-0000dff0: 6865 6d61 3d5b 2264 6567 225d 290a 2020  hema=["deg"]).  
-0000e000: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0000e010: 6563 7428 636f 7368 2863 6f6c 2822 6465  ect(cosh(col("de
-0000e020: 6722 2929 2e61 6c69 6173 2822 7265 7375  g")).alias("resu
-0000e030: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-0000e040: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0000e050: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-0000e060: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-0000e070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000e080: 2020 2020 7c31 2e30 2020 2020 2020 207c      |1.0       |
-0000e090: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000e0a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0000e0b0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0000e0c0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0000e0d0: 6c5f 6966 5f73 7472 2865 2c20 2263 6f73  l_if_str(e, "cos
-0000e0e0: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
-0000e0f0: 7569 6c74 696e 2822 636f 7368 2229 2863  uiltin("cosh")(c
-0000e100: 290a 0a0a 6465 6620 6578 7028 653a 2043  )...def exp(e: C
-0000e110: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0000e120: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-0000e130: 2020 2020 436f 6d70 7574 6573 2045 756c      Computes Eul
-0000e140: 6572 2773 206e 756d 6265 7220 6520 7261  er's number e ra
-0000e150: 6973 6564 2074 6f20 6120 666c 6f61 7469  ised to a floati
-0000e160: 6e67 2d70 6f69 6e74 2076 616c 7565 2e0a  ng-point value..
-0000e170: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0000e180: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0000e190: 7274 206d 6174 680a 2020 2020 2020 2020  rt math.        
-0000e1a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0000e1b0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-0000e1c0: 7320 696d 706f 7274 2049 6e74 6567 6572  s import Integer
-0000e1d0: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-0000e1e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0000e1f0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0000e200: 302e 302c 206d 6174 682e 6c6f 6728 3130  0.0, math.log(10
-0000e210: 295d 2c20 7363 6865 6d61 3d5b 2261 225d  )], schema=["a"]
-0000e220: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0000e230: 2e73 656c 6563 7428 6578 7028 6466 5b22  .select(exp(df["
-0000e240: 6122 5d29 2e63 6173 7428 496e 7465 6765  a"]).cast(Intege
-0000e250: 7254 7970 6528 2929 2e61 6c69 6173 2822  rType()).alias("
-0000e260: 6578 7022 2929 2e63 6f6c 6c65 6374 2829  exp")).collect()
-0000e270: 0a20 2020 2020 2020 205b 526f 7728 4558  .        [Row(EX
-0000e280: 503d 3129 2c20 526f 7728 4558 503d 3130  P=1), Row(EXP=10
-0000e290: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0000e2a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0000e2b0: 7228 652c 2022 6578 7022 290a 2020 2020  r(e, "exp").    
-0000e2c0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000e2d0: 6578 7022 2928 6329 0a0a 0a64 6566 2066  exp")(c)...def f
-0000e2e0: 6163 746f 7269 616c 2865 3a20 436f 6c75  actorial(e: Colu
-0000e2f0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000e300: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0000e310: 2043 6f6d 7075 7465 7320 7468 6520 6661   Computes the fa
-0000e320: 6374 6f72 6961 6c20 6f66 2069 7473 2069  ctorial of its i
-0000e330: 6e70 7574 2e20 5468 6520 696e 7075 7420  nput. The input 
-0000e340: 6172 6775 6d65 6e74 206d 7573 7420 6265  argument must be
-0000e350: 2061 6e20 696e 7465 6765 720a 2020 2020   an integer.    
-0000e360: 6578 7072 6573 7369 6f6e 2069 6e20 7468  expression in th
-0000e370: 6520 7261 6e67 6520 6f66 2030 2074 6f20  e range of 0 to 
-0000e380: 3333 2e0a 0a20 2020 2045 7861 6d70 6c65  33...    Example
-0000e390: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0000e3a0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0000e3b0: 6174 655f 6461 7461 6672 616d 6528 5b30  ate_dataframe([0
-0000e3c0: 2c20 312c 2035 2c20 3130 5d2c 2073 6368  , 1, 5, 10], sch
-0000e3d0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-0000e3e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0000e3f0: 2866 6163 746f 7269 616c 2864 665b 2261  (factorial(df["a
-0000e400: 225d 292e 616c 6961 7328 2266 6163 746f  "]).alias("facto
-0000e410: 7269 616c 2229 292e 636f 6c6c 6563 7428  rial")).collect(
-0000e420: 290a 2020 2020 2020 2020 5b52 6f77 2846  ).        [Row(F
-0000e430: 4143 544f 5249 414c 3d31 292c 2052 6f77  ACTORIAL=1), Row
-0000e440: 2846 4143 544f 5249 414c 3d31 292c 2052  (FACTORIAL=1), R
-0000e450: 6f77 2846 4143 544f 5249 414c 3d31 3230  ow(FACTORIAL=120
-0000e460: 292c 2052 6f77 2846 4143 544f 5249 414c  ), Row(FACTORIAL
-0000e470: 3d33 3632 3838 3030 295d 0a20 2020 2022  =3628800)].    "
-0000e480: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0000e490: 6f6c 5f69 665f 7374 7228 652c 2022 6661  ol_if_str(e, "fa
-0000e4a0: 6374 6f72 6961 6c22 290a 2020 2020 7265  ctorial").    re
-0000e4b0: 7475 726e 2062 7569 6c74 696e 2822 6661  turn builtin("fa
-0000e4c0: 6374 6f72 6961 6c22 2928 6329 0a0a 0a64  ctorial")(c)...d
-0000e4d0: 6566 2066 6c6f 6f72 2865 3a20 436f 6c75  ef floor(e: Colu
-0000e4e0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0000e4f0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0000e500: 2052 6574 7572 6e73 2076 616c 7565 7320   Returns values 
-0000e510: 6672 6f6d 2074 6865 2073 7065 6369 6669  from the specifi
-0000e520: 6564 2063 6f6c 756d 6e20 726f 756e 6465  ed column rounde
-0000e530: 6420 746f 2074 6865 206e 6561 7265 7374  d to the nearest
-0000e540: 2065 7175 616c 206f 720a 2020 2020 736d   equal or.    sm
-0000e550: 616c 6c65 7220 696e 7465 6765 722e 0a0a  aller integer...
-0000e560: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
-0000e570: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000e580: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0000e590: 6461 7461 6672 616d 6528 5b31 3335 2e31  dataframe([135.1
-0000e5a0: 3335 2c20 2d39 3735 2e39 3735 5d2c 2073  35, -975.975], s
-0000e5b0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0000e5c0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0000e5d0: 6374 2866 6c6f 6f72 2864 665b 2261 225d  ct(floor(df["a"]
-0000e5e0: 292e 616c 6961 7328 2266 6c6f 6f72 2229  ).alias("floor")
-0000e5f0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0000e600: 2020 2020 5b52 6f77 2846 4c4f 4f52 3d31      [Row(FLOOR=1
-0000e610: 3335 2e30 292c 2052 6f77 2846 4c4f 4f52  35.0), Row(FLOOR
-0000e620: 3d2d 3937 362e 3029 5d0a 2020 2020 2222  =-976.0)].    ""
-0000e630: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0000e640: 6c5f 6966 5f73 7472 2865 2c20 2266 6c6f  l_if_str(e, "flo
-0000e650: 6f72 2229 0a20 2020 2072 6574 7572 6e20  or").    return 
-0000e660: 6275 696c 7469 6e28 2266 6c6f 6f72 2229  builtin("floor")
-0000e670: 2863 290a 0a0a 6465 6620 666f 726d 6174  (c)...def format
-0000e680: 5f6e 756d 6265 7228 636f 6c3a 2043 6f6c  _number(col: Col
-0000e690: 756d 6e4f 724e 616d 652c 2064 3a20 556e  umnOrName, d: Un
-0000e6a0: 696f 6e5b 436f 6c75 6d6e 2c20 696e 745d  ion[Column, int]
-0000e6b0: 293a 0a20 2020 2022 2222 466f 726d 6174  ):.    """Format
-0000e6c0: 206e 756d 6265 7273 2074 6f20 6120 7370   numbers to a sp
-0000e6d0: 6563 6966 6963 206e 756d 6265 7220 6f66  ecific number of
-0000e6e0: 2064 6563 696d 616c 2070 6c61 6365 7320   decimal places 
-0000e6f0: 7769 7468 2048 414c 465f 544f 5f45 5645  with HALF_TO_EVE
-0000e700: 4e20 726f 756e 6469 6e67 2e0a 0a20 2020  N rounding...   
-0000e710: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
-0000e720: 2e20 5468 6520 6461 7461 2074 7970 6520  . The data type 
-0000e730: 6f66 2074 6865 2065 7870 7265 7373 696f  of the expressio
-0000e740: 6e20 6d75 7374 2062 6520 6f6e 6520 6f66  n must be one of
-0000e750: 2074 6865 2060 6461 7461 2074 7970 6573   the `data types
-0000e760: 2066 6f72 2061 2066 6978 6564 2d70 6f69   for a fixed-poi
-0000e770: 6e74 206e 756d 6265 720a 2020 2020 2020  nt number.      
-0000e780: 2020 3c68 7474 7073 3a2f 2f64 6f63 732e    <https://docs.
-0000e790: 736e 6f77 666c 616b 652e 636f 6d2f 656e  snowflake.com/en
-0000e7a0: 2f73 716c 2d72 6566 6572 656e 6365 2f64  /sql-reference/d
-0000e7b0: 6174 612d 7479 7065 732d 6e75 6d65 7269  ata-types-numeri
-0000e7c0: 632e 6874 6d6c 236c 6162 656c 2d64 6174  c.html#label-dat
-0000e7d0: 612d 7479 7065 732d 666f 722d 6669 7865  a-types-for-fixe
-0000e7e0: 642d 706f 696e 742d 6e75 6d62 6572 733e  d-point-numbers>
-0000e7f0: 605f 2e0a 0a20 2020 2020 2020 2032 2e20  `_...        2. 
-0000e800: 4461 7461 2074 7970 6573 2066 6f72 2066  Data types for f
-0000e810: 6c6f 6174 696e 6720 706f 696e 7420 6e75  loating point nu
-0000e820: 6d62 6572 7320 2865 2e67 2e20 464c 4f41  mbers (e.g. FLOA
-0000e830: 5429 2061 7265 206e 6f74 2073 7570 706f  T) are not suppo
-0000e840: 7274 6564 2077 6974 6820 7468 6973 2061  rted with this a
-0000e850: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
-0000e860: 2020 332e 2049 6620 7468 6520 6578 7072    3. If the expr
-0000e870: 6573 7369 6f6e 2064 6174 6120 7479 7065  ession data type
-0000e880: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
-0000e890: 642c 2074 6865 2065 7870 7265 7373 696f  d, the expressio
-0000e8a0: 6e20 6d75 7374 2062 6520 6578 706c 6963  n must be explic
-0000e8b0: 6974 6c79 2063 6173 7420 746f 2064 6563  itly cast to dec
-0000e8c0: 696d 616c 2062 6566 6f72 6520 6361 6c6c  imal before call
-0000e8d0: 696e 672e 0a0a 2020 2020 4578 616d 706c  ing...    Exampl
-0000e8e0: 653a 3a0a 2020 2020 2020 2020 2020 2020  e::.            
-0000e8f0: 3e3e 3e20 696d 706f 7274 2064 6563 696d  >>> import decim
-0000e900: 616c 0a20 2020 2020 2020 2020 2020 203e  al.            >
-0000e910: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0000e920: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
-0000e930: 696f 6e73 2069 6d70 6f72 7420 666f 726d  ions import form
-0000e940: 6174 5f6e 756d 6265 720a 2020 2020 2020  at_number.      
-0000e950: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-0000e960: 205b 2831 2c20 6465 6369 6d61 6c2e 4465   [(1, decimal.De
-0000e970: 6369 6d61 6c28 332e 3134 3135 3929 292c  cimal(3.14159)),
-0000e980: 2028 322c 2064 6563 696d 616c 2e44 6563   (2, decimal.Dec
-0000e990: 696d 616c 2832 2e37 3138 3238 2929 2c20  imal(2.71828)), 
-0000e9a0: 2833 2c20 6465 6369 6d61 6c2e 4465 6369  (3, decimal.Deci
-0000e9b0: 6d61 6c28 312e 3431 3432 3129 295d 0a20  mal(1.41421))]. 
-0000e9c0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
-0000e9d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0000e9e0: 7465 4461 7461 4672 616d 6528 6461 7461  teDataFrame(data
-0000e9f0: 2c20 5b22 6964 222c 2022 7661 6c75 6522  , ["id", "value"
-0000ea00: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-0000ea10: 3e3e 2064 662e 7365 6c65 6374 2822 6964  >> df.select("id
-0000ea20: 222c 666f 726d 6174 5f6e 756d 6265 7228  ",format_number(
-0000ea30: 2276 616c 7565 222c 3229 2e61 6c69 6173  "value",2).alias
-0000ea40: 2822 7661 6c75 6522 2929 2e73 686f 7728  ("value")).show(
-0000ea50: 290a 2020 2020 2020 2020 2020 2020 2d2d  ).            --
-0000ea60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000ea70: 0a20 2020 2020 2020 2020 2020 207c 2249  .            |"I
-0000ea80: 4422 2020 7c22 5641 4c55 4522 2020 7c0a  D"  |"VALUE"  |.
-0000ea90: 2020 2020 2020 2020 2020 2020 2d2d 2d2d              ----
-0000eaa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0000eab0: 2020 2020 2020 2020 2020 207c 3120 2020             |1   
-0000eac0: 2020 7c33 2e31 3420 2020 2020 7c0a 2020    |3.14     |.  
-0000ead0: 2020 2020 2020 2020 2020 7c32 2020 2020            |2    
-0000eae0: 207c 322e 3732 2020 2020 207c 0a20 2020   |2.72     |.   
-0000eaf0: 2020 2020 2020 2020 207c 3320 2020 2020           |3     
-0000eb00: 7c31 2e34 3120 2020 2020 7c0a 2020 2020  |1.41     |.    
-0000eb10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000eb20: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000eb30: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0000eb40: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-0000eb50: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-0000eb60: 7374 7228 636f 6c2c 2022 666f 726d 6174  str(col, "format
-0000eb70: 5f6e 756d 6265 7222 290a 2020 2020 7265  _number").    re
-0000eb80: 7475 726e 2062 726f 756e 6428 636f 6c2c  turn bround(col,
-0000eb90: 2064 292e 6361 7374 2853 7472 696e 6754   d).cast(StringT
-0000eba0: 7970 6528 2929 0a0a 0a64 6566 2073 696e  ype())...def sin
-0000ebb0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0000ebc0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0000ebd0: 2022 2222 436f 6d70 7574 6573 2074 6865   """Computes the
-0000ebe0: 2073 696e 6520 6f66 2069 7473 2061 7267   sine of its arg
-0000ebf0: 756d 656e 743b 2074 6865 2061 7267 756d  ument; the argum
-0000ec00: 656e 7420 7368 6f75 6c64 2062 6520 6578  ent should be ex
-0000ec10: 7072 6573 7365 6420 696e 2072 6164 6961  pressed in radia
-0000ec20: 6e73 2e0a 0a20 2020 2045 7861 6d70 6c65  ns...    Example
-0000ec30: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
-0000ec40: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
-0000ec50: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
-0000ec60: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
-0000ec70: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0000ec80: 2073 6573 7369 6f6e 2e67 656e 6572 6174   session.generat
-0000ec90: 6f72 2873 6571 3128 3029 2c20 726f 7763  or(seq1(0), rowc
-0000eca0: 6f75 6e74 3d33 292e 7365 6c65 6374 2873  ount=3).select(s
-0000ecb0: 696e 2873 6571 3128 3029 292e 6361 7374  in(seq1(0)).cast
-0000ecc0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
-0000ecd0: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
-0000ece0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
-0000ecf0: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
-0000ed00: 5354 2028 5349 4e28 5345 5131 2830 2929  ST (SIN(SEQ1(0))
-0000ed10: 2041 5320 4e55 4d42 4552 2833 382c 2034   AS NUMBER(38, 4
-0000ed20: 2929 3d44 6563 696d 616c 2827 302e 3030  ))=Decimal('0.00
-0000ed30: 3030 2729 292c 2052 6f77 2843 4153 5420  00')), Row(CAST 
-0000ed40: 2853 494e 2853 4551 3128 3029 2920 4153  (SIN(SEQ1(0)) AS
-0000ed50: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
-0000ed60: 4465 6369 6d61 6c28 2730 2e38 3431 3527  Decimal('0.8415'
-0000ed70: 2929 2c20 526f 7728 4341 5354 2028 5349  )), Row(CAST (SI
-0000ed80: 4e28 5345 5131 2830 2929 2041 5320 4e55  N(SEQ1(0)) AS NU
-0000ed90: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
-0000eda0: 696d 616c 2827 302e 3930 3933 2729 295d  imal('0.9093'))]
-0000edb0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0000edc0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000edd0: 652c 2022 7369 6e22 290a 2020 2020 7265  e, "sin").    re
-0000ede0: 7475 726e 2062 7569 6c74 696e 2822 7369  turn builtin("si
-0000edf0: 6e22 2928 6329 0a0a 0a64 6566 2073 696e  n")(c)...def sin
-0000ee00: 6828 653a 2043 6f6c 756d 6e4f 724e 616d  h(e: ColumnOrNam
-0000ee10: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0000ee20: 2020 2222 2243 6f6d 7075 7465 7320 7468    """Computes th
-0000ee30: 6520 6879 7065 7262 6f6c 6963 2073 696e  e hyperbolic sin
-0000ee40: 6520 6f66 2069 7473 2061 7267 756d 656e  e of its argumen
-0000ee50: 742e 0a0a 2020 2020 4578 616d 706c 653a  t...    Example:
-0000ee60: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
-0000ee70: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-0000ee80: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-0000ee90: 7274 2044 6563 696d 616c 5479 7065 0a20  rt DecimalType. 
-0000eea0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000eeb0: 7365 7373 696f 6e2e 6765 6e65 7261 746f  session.generato
-0000eec0: 7228 7365 7131 2830 292c 2072 6f77 636f  r(seq1(0), rowco
-0000eed0: 756e 743d 3329 2e73 656c 6563 7428 7369  unt=3).select(si
-0000eee0: 6e68 2873 6571 3128 3029 292e 6361 7374  nh(seq1(0)).cast
-0000eef0: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
-0000ef00: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
-0000ef10: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
-0000ef20: 0a20 2020 2020 2020 205b 526f 7728 4341  .        [Row(CA
-0000ef30: 5354 2028 5349 4e48 2853 4551 3128 3029  ST (SINH(SEQ1(0)
-0000ef40: 2920 4153 204e 554d 4245 5228 3338 2c20  ) AS NUMBER(38, 
-0000ef50: 3429 293d 4465 6369 6d61 6c28 2730 2e30  4))=Decimal('0.0
-0000ef60: 3030 3027 2929 2c20 526f 7728 4341 5354  000')), Row(CAST
-0000ef70: 2028 5349 4e48 2853 4551 3128 3029 2920   (SINH(SEQ1(0)) 
-0000ef80: 4153 204e 554d 4245 5228 3338 2c20 3429  AS NUMBER(38, 4)
-0000ef90: 293d 4465 6369 6d61 6c28 2731 2e31 3735  )=Decimal('1.175
-0000efa0: 3227 2929 2c20 526f 7728 4341 5354 2028  2')), Row(CAST (
-0000efb0: 5349 4e48 2853 4551 3128 3029 2920 4153  SINH(SEQ1(0)) AS
-0000efc0: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
-0000efd0: 4465 6369 6d61 6c28 2733 2e36 3236 3927  Decimal('3.6269'
-0000efe0: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-0000eff0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0000f000: 7472 2865 2c20 2273 696e 6822 290a 2020  tr(e, "sinh").  
-0000f010: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0000f020: 2822 7369 6e68 2229 2863 290a 0a0a 6465  ("sinh")(c)...de
-0000f030: 6620 7461 6e28 653a 2043 6f6c 756d 6e4f  f tan(e: ColumnO
-0000f040: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000f050: 3a0a 2020 2020 2222 2243 6f6d 7075 7465  :.    """Compute
-0000f060: 7320 7468 6520 7461 6e67 656e 7420 6f66  s the tangent of
-0000f070: 2069 7473 2061 7267 756d 656e 743b 2074   its argument; t
-0000f080: 6865 2061 7267 756d 656e 7420 7368 6f75  he argument shou
-0000f090: 6c64 2062 6520 6578 7072 6573 7365 6420  ld be expressed 
-0000f0a0: 696e 2072 6164 6961 6e73 2e0a 0a20 2020  in radians...   
-0000f0b0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0000f0c0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0000f0d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-0000f0e0: 7065 7320 696d 706f 7274 2044 6563 696d  pes import Decim
-0000f0f0: 616c 5479 7065 0a20 2020 2020 2020 3e3e  alType.       >>
-0000f100: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000f110: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000f120: 5b30 2c20 315d 2c20 7363 6865 6d61 3d5b  [0, 1], schema=[
-0000f130: 224e 225d 292e 7365 6c65 6374 280a 2020  "N"]).select(.  
-0000f140: 2020 2020 202e 2e2e 2020 2020 2074 616e       ...     tan
-0000f150: 2863 6f6c 2822 4e22 2929 2e63 6173 7428  (col("N")).cast(
-0000f160: 4465 6369 6d61 6c54 7970 6528 7363 616c  DecimalType(scal
-0000f170: 653d 3429 290a 2020 2020 2020 202e 2e2e  e=4)).       ...
-0000f180: 2029 0a20 2020 2020 2020 3e3e 3e20 6466   ).       >>> df
-0000f190: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0000f1a0: 2020 5b52 6f77 2843 4153 5420 2854 414e    [Row(CAST (TAN
-0000f1b0: 2822 4e22 2920 4153 204e 554d 4245 5228  ("N") AS NUMBER(
-0000f1c0: 3338 2c20 3429 293d 4465 6369 6d61 6c28  38, 4))=Decimal(
-0000f1d0: 2730 2e30 3030 3027 2929 2c20 526f 7728  '0.0000')), Row(
-0000f1e0: 4341 5354 2028 5441 4e28 224e 2229 2041  CAST (TAN("N") A
-0000f1f0: 5320 4e55 4d42 4552 2833 382c 2034 2929  S NUMBER(38, 4))
-0000f200: 3d44 6563 696d 616c 2827 312e 3535 3734  =Decimal('1.5574
-0000f210: 2729 295d 0a20 2020 2022 2222 0a20 2020  '))].    """.   
-0000f220: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0000f230: 7374 7228 652c 2022 7461 6e22 290a 2020  str(e, "tan").  
-0000f240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0000f250: 2822 7461 6e22 2928 6329 0a0a 0a64 6566  ("tan")(c)...def
-0000f260: 2074 616e 6828 653a 2043 6f6c 756d 6e4f   tanh(e: ColumnO
-0000f270: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000f280: 3a0a 2020 2020 2222 2243 6f6d 7075 7465  :.    """Compute
-0000f290: 7320 7468 6520 6879 7065 7262 6f6c 6963  s the hyperbolic
-0000f2a0: 2074 616e 6765 6e74 206f 6620 6974 7320   tangent of its 
-0000f2b0: 6172 6775 6d65 6e74 2e0a 0a20 2020 2045  argument...    E
-0000f2c0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0000f2d0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0000f2e0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-0000f2f0: 6573 2069 6d70 6f72 7420 4465 6369 6d61  es import Decima
-0000f300: 6c54 7970 650a 2020 2020 2020 2020 3e3e  lType.        >>
-0000f310: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000f320: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000f330: 5b30 2c20 315d 2c20 7363 6865 6d61 3d5b  [0, 1], schema=[
-0000f340: 224e 225d 292e 7365 6c65 6374 280a 2020  "N"]).select(.  
-0000f350: 2020 2020 2020 2e2e 2e20 2020 2020 7461        ...     ta
-0000f360: 6e68 2863 6f6c 2822 4e22 292e 6361 7374  nh(col("N").cast
-0000f370: 2844 6563 696d 616c 5479 7065 2873 6361  (DecimalType(sca
-0000f380: 6c65 3d34 2929 290a 2020 2020 2020 2020  le=4))).        
-0000f390: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-0000f3a0: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
-0000f3b0: 2020 2020 2020 205b 526f 7728 5441 4e48         [Row(TANH
-0000f3c0: 2820 4341 5354 2028 224e 2220 4153 204e  ( CAST ("N" AS N
-0000f3d0: 554d 4245 5228 3338 2c20 3429 2929 3d30  UMBER(38, 4)))=0
-0000f3e0: 2e30 292c 2052 6f77 2854 414e 4828 2043  .0), Row(TANH( C
-0000f3f0: 4153 5420 2822 4e22 2041 5320 4e55 4d42  AST ("N" AS NUMB
-0000f400: 4552 2833 382c 2034 2929 293d 302e 3736  ER(38, 4)))=0.76
-0000f410: 3135 3934 3135 3539 3535 3736 3439 295d  15941559557649)]
-0000f420: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0000f430: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0000f440: 652c 2022 7461 6e68 2229 0a20 2020 2072  e, "tanh").    r
-0000f450: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
-0000f460: 616e 6822 2928 6329 0a0a 0a64 6566 2064  anh")(c)...def d
-0000f470: 6567 7265 6573 2865 3a20 436f 6c75 6d6e  egrees(e: Column
-0000f480: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0000f490: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
-0000f4a0: 6f6e 7665 7274 7320 7261 6469 616e 7320  onverts radians 
-0000f4b0: 746f 2064 6567 7265 6573 2e0a 0a20 2020  to degrees...   
-0000f4c0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0000f4d0: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
-0000f4e0: 6174 680a 2020 2020 2020 2020 3e3e 3e20  ath.        >>> 
-0000f4f0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0000f500: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0000f510: 706f 7274 2053 7472 7563 7454 7970 652c  port StructType,
-0000f520: 2053 7472 7563 7446 6965 6c64 2c20 446f   StructField, Do
-0000f530: 7562 6c65 5479 7065 2c20 496e 7465 6765  ubleType, Intege
-0000f540: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
-0000f550: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0000f560: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0000f570: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0000f580: 205b 6d61 7468 2e70 6920 2f20 332c 206d   [math.pi / 3, m
-0000f590: 6174 682e 7069 2c20 3320 2a20 6d61 7468  ath.pi, 3 * math
-0000f5a0: 2e70 695d 2c0a 2020 2020 2020 2020 2e2e  .pi],.        ..
-0000f5b0: 2e20 2020 2020 7363 6865 6d61 3d53 7472  .     schema=Str
-0000f5c0: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
-0000f5d0: 6965 6c64 2822 6122 2c20 446f 7562 6c65  ield("a", Double
-0000f5e0: 5479 7065 2829 295d 292c 0a20 2020 2020  Type())]),.     
-0000f5f0: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-0000f600: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
-0000f610: 6567 7265 6573 2863 6f6c 2822 6122 2929  egrees(col("a"))
-0000f620: 2e63 6173 7428 496e 7465 6765 7254 7970  .cast(IntegerTyp
-0000f630: 6528 2929 2e61 6c69 6173 2822 4445 4752  e()).alias("DEGR
-0000f640: 4545 5322 2929 2e63 6f6c 6c65 6374 2829  EES")).collect()
-0000f650: 0a20 2020 2020 2020 205b 526f 7728 4445  .        [Row(DE
-0000f660: 4752 4545 533d 3630 292c 2052 6f77 2844  GREES=60), Row(D
-0000f670: 4547 5245 4553 3d31 3830 292c 2052 6f77  EGREES=180), Row
-0000f680: 2844 4547 5245 4553 3d35 3430 295d 0a20  (DEGREES=540)]. 
-0000f690: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0000f6a0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0000f6b0: 2022 6465 6772 6565 7322 290a 2020 2020   "degrees").    
-0000f6c0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0000f6d0: 6465 6772 6565 7322 2928 6329 0a0a 0a64  degrees")(c)...d
-0000f6e0: 6566 2072 6164 6961 6e73 2865 3a20 436f  ef radians(e: Co
-0000f6f0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000f700: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
-0000f710: 6e76 6572 7473 2064 6567 7265 6573 2074  nverts degrees t
-0000f720: 6f20 7261 6469 616e 732e 0a0a 2020 2020  o radians...    
-0000f730: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
-0000f740: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0000f750: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0000f760: 6672 616d 6528 5b5b 312e 3131 315d 2c20  frame([[1.111], 
-0000f770: 5b32 2e32 3232 5d2c 205b 332e 3333 335d  [2.222], [3.333]
-0000f780: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0000f790: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000f7a0: 7365 6c65 6374 2872 6164 6961 6e73 2863  select(radians(c
-0000f7b0: 6f6c 2822 6122 2929 2e63 6173 7428 226e  ol("a")).cast("n
-0000f7c0: 756d 6265 7228 3338 2c20 3529 2229 2e61  umber(38, 5)").a
-0000f7d0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0000f7e0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0000f7f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0000f800: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-0000f810: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000f820: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c30  -----.        |0
-0000f830: 2e30 3139 3339 2020 207c 0a20 2020 2020  .01939   |.     
-0000f840: 2020 207c 302e 3033 3837 3820 2020 7c0a     |0.03878   |.
-0000f850: 2020 2020 2020 2020 7c30 2e30 3538 3137          |0.05817
-0000f860: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-0000f870: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000f880: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0000f890: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0000f8a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0000f8b0: 2272 6164 6961 6e73 2229 0a20 2020 2072  "radians").    r
-0000f8c0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
-0000f8d0: 6164 6961 6e73 2229 2863 290a 0a0a 6465  adians")(c)...de
-0000f8e0: 6620 6d64 3528 653a 2043 6f6c 756d 6e4f  f md5(e: ColumnO
-0000f8f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0000f900: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0000f910: 7475 726e 7320 6120 3332 2d63 6861 7261  turns a 32-chara
-0000f920: 6374 6572 2068 6578 2d65 6e63 6f64 6564  cter hex-encoded
-0000f930: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-0000f940: 6e67 2074 6865 2031 3238 2d62 6974 204d  ng the 128-bit M
-0000f950: 4435 206d 6573 7361 6765 2064 6967 6573  D5 message diges
-0000f960: 742e 0a0a 2020 2020 2045 7861 6d70 6c65  t...     Example
-0000f970: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0000f980: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0000f990: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
-0000f9a0: 6122 2c20 2262 225d 2c20 7363 6865 6d61  a", "b"], schema
-0000f9b0: 3d5b 2263 6f6c 225d 292e 7365 6c65 6374  =["col"]).select
-0000f9c0: 286d 6435 2822 636f 6c22 2929 0a20 2020  (md5("col")).   
-0000f9d0: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
-0000f9e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0000f9f0: 6f77 284d 4435 2822 434f 4c22 293d 2730  ow(MD5("COL")='0
-0000fa00: 6363 3137 3562 3963 3066 3162 3661 3833  cc175b9c0f1b6a83
-0000fa10: 3163 3339 3965 3236 3937 3732 3636 3127  1c399e269772661'
-0000fa20: 292c 2052 6f77 284d 4435 2822 434f 4c22  ), Row(MD5("COL"
-0000fa30: 293d 2739 3265 6235 6666 6565 3661 6532  )='92eb5ffee6ae2
-0000fa40: 6665 6333 6164 3731 6337 3737 3533 3135  fec3ad71c7775315
-0000fa50: 3738 6627 295d 0a20 2020 2022 2222 0a20  78f')].    """. 
-0000fa60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000fa70: 665f 7374 7228 652c 2022 6d64 3522 290a  f_str(e, "md5").
-0000fa80: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0000fa90: 696e 2822 6d64 3522 2928 6329 0a0a 0a64  in("md5")(c)...d
-0000faa0: 6566 2073 6861 3128 653a 2043 6f6c 756d  ef sha1(e: Colum
-0000fab0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0000fac0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0000fad0: 6e73 2061 2034 302d 6368 6172 6163 7465  ns a 40-characte
-0000fae0: 7220 6865 782d 656e 636f 6465 6420 7374  r hex-encoded st
-0000faf0: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
-0000fb00: 7468 6520 3136 302d 6269 7420 5348 412d  the 160-bit SHA-
-0000fb10: 3120 6d65 7373 6167 6520 6469 6765 7374  1 message digest
-0000fb20: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0000fb30: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0000fb40: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0000fb50: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
-0000fb60: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
-0000fb70: 636f 6c22 5d29 2e73 656c 6563 7428 7368  col"]).select(sh
-0000fb80: 6131 2822 636f 6c22 2929 0a20 2020 2020  a1("col")).     
-0000fb90: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
-0000fba0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0000fbb0: 2853 4841 3128 2243 4f4c 2229 3d27 3836  (SHA1("COL")='86
-0000fbc0: 6637 6534 3337 6661 6135 6137 6663 6531  f7e437faa5a7fce1
-0000fbd0: 3564 3164 6463 6239 6561 6561 6561 3337  5d1ddcb9eaeaea37
-0000fbe0: 3736 3637 6238 2729 2c20 526f 7728 5348  7667b8'), Row(SH
-0000fbf0: 4131 2822 434f 4c22 293d 2765 3964 3731  A1("COL")='e9d71
-0000fc00: 6635 6565 3763 3932 6436 6463 3965 3932  f5ee7c92d6dc9e92
-0000fc10: 6666 6461 6431 3762 3862 6434 3934 3138  ffdad17b8bd49418
-0000fc20: 6639 3827 295d 0a20 2020 2022 2222 0a20  f98')].    """. 
-0000fc30: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-0000fc40: 665f 7374 7228 652c 2022 7368 6131 2229  f_str(e, "sha1")
-0000fc50: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0000fc60: 7469 6e28 2273 6861 3122 2928 6329 0a0a  tin("sha1")(c)..
-0000fc70: 0a64 6566 2073 6861 3228 653a 2043 6f6c  .def sha2(e: Col
-0000fc80: 756d 6e4f 724e 616d 652c 206e 756d 5f62  umnOrName, num_b
-0000fc90: 6974 733a 2069 6e74 2920 2d3e 2043 6f6c  its: int) -> Col
-0000fca0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-0000fcb0: 726e 7320 6120 6865 782d 656e 636f 6465  rns a hex-encode
-0000fcc0: 6420 7374 7269 6e67 2063 6f6e 7461 696e  d string contain
-0000fcd0: 696e 6720 7468 6520 4e2d 6269 7420 5348  ing the N-bit SH
-0000fce0: 412d 3220 6d65 7373 6167 6520 6469 6765  A-2 message dige
-0000fcf0: 7374 2c0a 2020 2020 7768 6572 6520 4e20  st,.    where N 
-0000fd00: 6973 2074 6865 2073 7065 6369 6669 6564  is the specified
-0000fd10: 206f 7574 7075 7420 6469 6765 7374 2073   output digest s
-0000fd20: 697a 652e 0a0a 2020 2020 4578 616d 706c  ize...    Exampl
-0000fd30: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0000fd40: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0000fd50: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
-0000fd60: 6122 2c20 2262 225d 2c20 7363 6865 6d61  a", "b"], schema
-0000fd70: 3d5b 2263 6f6c 225d 292e 7365 6c65 6374  =["col"]).select
-0000fd80: 2873 6861 3228 2263 6f6c 222c 2032 3536  (sha2("col", 256
-0000fd90: 2929 0a20 2020 2020 2020 203e 3e3e 2064  )).        >>> d
-0000fda0: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
-0000fdb0: 2020 2020 5b52 6f77 2853 4841 3228 2243      [Row(SHA2("C
-0000fdc0: 4f4c 222c 2032 3536 293d 2763 6139 3738  OL", 256)='ca978
-0000fdd0: 3131 3263 6131 6262 6463 6166 6163 3233  112ca1bbdcafac23
-0000fde0: 3162 3339 6132 3364 6334 6461 3738 3665  1b39a23dc4da786e
-0000fdf0: 6666 3831 3437 6334 6537 3262 3938 3037  ff8147c4e72b9807
-0000fe00: 3738 3561 6665 6534 3862 6227 292c 2052  785afee48bb'), R
-0000fe10: 6f77 2853 4841 3228 2243 4f4c 222c 2032  ow(SHA2("COL", 2
-0000fe20: 3536 293d 2733 6532 3365 3831 3630 3033  56)='3e23e816003
-0000fe30: 3935 3934 6133 3338 3934 6636 3536 3465  9594a33894f6564e
-0000fe40: 3162 3133 3438 6262 6437 6130 3038 3864  1b1348bbd7a0088d
-0000fe50: 3432 6334 6163 6237 3365 6561 6564 3539  42c4acb73eeaed59
-0000fe60: 6330 3039 6427 295d 0a20 2020 2022 2222  c009d')].    """
-0000fe70: 0a20 2020 2070 6572 6d69 7474 6564 5f76  .    permitted_v
-0000fe80: 616c 7565 7320 3d20 5b30 2c20 3232 342c  alues = [0, 224,
-0000fe90: 2032 3536 2c20 3338 342c 2035 3132 5d0a   256, 384, 512].
-0000fea0: 2020 2020 6966 206e 756d 5f62 6974 7320      if num_bits 
-0000feb0: 6e6f 7420 696e 2070 6572 6d69 7474 6564  not in permitted
-0000fec0: 5f76 616c 7565 733a 0a20 2020 2020 2020  _values:.       
-0000fed0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000fee0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
-0000fef0: 226e 756d 5f62 6974 7320 7b6e 756d 5f62  "num_bits {num_b
-0000ff00: 6974 737d 2069 7320 6e6f 7420 696e 2074  its} is not in t
-0000ff10: 6865 2070 6572 6d69 7474 6564 2076 616c  he permitted val
-0000ff20: 7565 7320 7b70 6572 6d69 7474 6564 5f76  ues {permitted_v
-0000ff30: 616c 7565 737d 220a 2020 2020 2020 2020  alues}".        
-0000ff40: 290a 2020 2020 6320 3d20 5f74 6f5f 636f  ).    c = _to_co
-0000ff50: 6c5f 6966 5f73 7472 2865 2c20 2273 6861  l_if_str(e, "sha
-0000ff60: 3222 290a 2020 2020 7265 7475 726e 2062  2").    return b
-0000ff70: 7569 6c74 696e 2822 7368 6132 2229 2863  uiltin("sha2")(c
-0000ff80: 2c20 6e75 6d5f 6269 7473 290a 0a0a 6465  , num_bits)...de
-0000ff90: 6620 6861 7368 282a 636f 6c73 3a20 436f  f hash(*cols: Co
-0000ffa0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0000ffb0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-0000ffc0: 2020 2052 6574 7572 6e73 2061 2073 6967     Returns a sig
-0000ffd0: 6e65 6420 3634 2d62 6974 2068 6173 6820  ned 64-bit hash 
-0000ffe0: 7661 6c75 652e 204e 6f74 6520 7468 6174  value. Note that
-0000fff0: 2048 4153 4820 6e65 7665 7220 7265 7475   HASH never retu
-00010000: 726e 7320 4e55 4c4c 2c20 6576 656e 2066  rns NULL, even f
-00010010: 6f72 204e 554c 4c20 696e 7075 7473 2e0a  or NULL inputs..
-00010020: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00010030: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00010040: 6f72 7420 6465 6369 6d61 6c0a 2020 2020  ort decimal.    
-00010050: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00010060: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00010070: 6672 616d 6528 5b5b 3130 2c20 2231 3022  frame([[10, "10"
-00010080: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-00010090: 6c28 3130 292c 2031 302e 305d 5d2c 2073  l(10), 10.0]], s
-000100a0: 6368 656d 613d 5b22 6122 2c20 2262 222c  chema=["a", "b",
-000100b0: 2022 6322 2c20 2264 225d 290a 2020 2020   "c", "d"]).    
-000100c0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000100d0: 7428 6861 7368 2822 6122 292e 616c 6961  t(hash("a").alia
-000100e0: 7328 2268 6173 685f 6122 292c 2068 6173  s("hash_a"), has
-000100f0: 6828 2262 2229 2e61 6c69 6173 2822 6861  h("b").alias("ha
-00010100: 7368 5f62 2229 2c20 6861 7368 2822 6322  sh_b"), hash("c"
-00010110: 292e 616c 6961 7328 2268 6173 685f 6322  ).alias("hash_c"
-00010120: 292c 2068 6173 6828 2264 2229 2e61 6c69  ), hash("d").ali
-00010130: 6173 2822 6861 7368 5f64 2229 292e 636f  as("hash_d")).co
-00010140: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00010150: 5b52 6f77 2848 4153 485f 413d 3135 3939  [Row(HASH_A=1599
-00010160: 3632 3737 3036 3832 3239 3633 3036 382c  627706822963068,
-00010170: 2048 4153 485f 423d 3336 3232 3439 3439   HASH_B=36224949
-00010180: 3830 3434 3031 3038 3938 342c 2048 4153  80440108984, HAS
-00010190: 485f 433d 3135 3939 3632 3737 3036 3832  H_C=159962770682
-000101a0: 3239 3633 3036 382c 2048 4153 485f 443d  2963068, HASH_D=
-000101b0: 3135 3939 3632 3737 3036 3832 3239 3633  1599627706822963
-000101c0: 3036 3829 5d0a 2020 2020 2020 2020 3e3e  068)].        >>
-000101d0: 3e20 6466 2e73 656c 6563 7428 6861 7368  > df.select(hash
-000101e0: 286c 6974 284e 6f6e 6529 292e 616c 6961  (lit(None)).alia
-000101f0: 7328 226f 6e65 2229 2c20 6861 7368 286c  s("one"), hash(l
-00010200: 6974 284e 6f6e 6529 2c20 6c69 7428 4e6f  it(None), lit(No
-00010210: 6e65 2929 2e61 6c69 6173 2822 7477 6f22  ne)).alias("two"
-00010220: 292c 2068 6173 6828 6c69 7428 4e6f 6e65  ), hash(lit(None
-00010230: 292c 206c 6974 284e 6f6e 6529 2c20 6c69  ), lit(None), li
-00010240: 7428 4e6f 6e65 2929 2e61 6c69 6173 2822  t(None)).alias("
-00010250: 7468 7265 6522 2929 2e63 6f6c 6c65 6374  three")).collect
-00010260: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00010270: 4f4e 453d 3838 3137 3937 3537 3032 3339  ONE=881797570239
-00010280: 3336 3139 3336 382c 2054 574f 3d39 3533  3619368, TWO=953
-00010290: 3936 3332 3538 3335 3131 3034 3136 302c  963258351104160,
-000102a0: 2054 4852 4545 3d32 3934 3139 3438 3336   THREE=294194836
-000102b0: 3338 3435 3638 3434 3132 295d 0a20 2020  3845684412)].   
-000102c0: 2022 2222 0a20 2020 2063 6f6c 756d 6e73   """.    columns
-000102d0: 203d 205b 5f74 6f5f 636f 6c5f 6966 5f73   = [_to_col_if_s
-000102e0: 7472 2863 2c20 2268 6173 6822 2920 666f  tr(c, "hash") fo
-000102f0: 7220 6320 696e 2063 6f6c 735d 0a20 2020  r c in cols].   
-00010300: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00010310: 2268 6173 6822 2928 636f 6c75 6d6e 7329  "hash")(columns)
-00010320: 0a0a 0a64 6566 2061 7363 6969 2865 3a20  ...def ascii(e: 
-00010330: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00010340: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00010350: 5265 7475 726e 7320 7468 6520 4153 4349  Returns the ASCI
-00010360: 4920 636f 6465 2066 6f72 2074 6865 2066  I code for the f
-00010370: 6972 7374 2063 6861 7261 6374 6572 206f  irst character o
-00010380: 6620 6120 7374 7269 6e67 2e20 4966 2074  f a string. If t
-00010390: 6865 2073 7472 696e 6720 6973 2065 6d70  he string is emp
-000103a0: 7479 2c0a 2020 2020 6120 7661 6c75 6520  ty,.    a value 
-000103b0: 6f66 2030 2069 7320 7265 7475 726e 6564  of 0 is returned
-000103c0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-000103d0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-000103e0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-000103f0: 655f 6461 7461 6672 616d 6528 5b27 2127  e_dataframe(['!'
-00010400: 2c20 2741 272c 2027 6127 2c20 2727 2c20  , 'A', 'a', '', 
-00010410: 2762 6364 272c 204e 6f6e 655d 2c20 7363  'bcd', None], sc
-00010420: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-00010430: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00010440: 7428 6466 2e61 2c20 6173 6369 6928 6466  t(df.a, ascii(df
-00010450: 2e61 292e 6173 5f28 2761 7363 6969 2729  .a).as_('ascii')
-00010460: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00010470: 2020 2020 5b52 6f77 2841 3d27 2127 2c20      [Row(A='!', 
-00010480: 4153 4349 493d 3333 292c 2052 6f77 2841  ASCII=33), Row(A
-00010490: 3d27 4127 2c20 4153 4349 493d 3635 292c  ='A', ASCII=65),
-000104a0: 2052 6f77 2841 3d27 6127 2c20 4153 4349   Row(A='a', ASCI
-000104b0: 493d 3937 292c 2052 6f77 2841 3d27 272c  I=97), Row(A='',
-000104c0: 2041 5343 4949 3d30 292c 2052 6f77 2841   ASCII=0), Row(A
-000104d0: 3d27 6263 6427 2c20 4153 4349 493d 3938  ='bcd', ASCII=98
-000104e0: 292c 2052 6f77 2841 3d4e 6f6e 652c 2041  ), Row(A=None, A
-000104f0: 5343 4949 3d4e 6f6e 6529 5d0a 2020 2020  SCII=None)].    
-00010500: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00010510: 636f 6c5f 6966 5f73 7472 2865 2c20 2261  col_if_str(e, "a
-00010520: 7363 6969 2229 0a20 2020 2072 6574 7572  scii").    retur
-00010530: 6e20 6275 696c 7469 6e28 2261 7363 6969  n builtin("ascii
-00010540: 2229 2863 290a 0a0a 6465 6620 696e 6974  ")(c)...def init
-00010550: 6361 7028 653a 2043 6f6c 756d 6e4f 724e  cap(e: ColumnOrN
-00010560: 616d 652c 2064 656c 696d 6974 6572 733a  ame, delimiters:
-00010570: 2043 6f6c 756d 6e4f 724e 616d 6520 3d20   ColumnOrName = 
-00010580: 4e6f 6e65 2920 2d3e 2043 6f6c 756d 6e3a  None) -> Column:
-00010590: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-000105a0: 7572 6e73 2074 6865 2069 6e70 7574 2073  urns the input s
-000105b0: 7472 696e 6720 7769 7468 2074 6865 2066  tring with the f
-000105c0: 6972 7374 206c 6574 7465 7220 6f66 2065  irst letter of e
-000105d0: 6163 6820 776f 7264 2069 6e20 7570 7065  ach word in uppe
-000105e0: 7263 6173 650a 2020 2020 616e 6420 7468  rcase.    and th
-000105f0: 6520 7375 6273 6571 7565 6e74 206c 6574  e subsequent let
-00010600: 7465 7273 2069 6e20 6c6f 7765 7263 6173  ters in lowercas
-00010610: 652e 0a0a 2020 2020 6060 6465 6c69 6d69  e...    ``delimi
-00010620: 7465 7273 6060 2069 7320 616e 206f 7074  ters`` is an opt
-00010630: 696f 6e61 6c20 6172 6775 6d65 6e74 2073  ional argument s
-00010640: 7065 6369 6679 696e 6720 6120 7374 7269  pecifying a stri
-00010650: 6e67 206f 6620 6f6e 6520 6f72 206d 6f72  ng of one or mor
-00010660: 650a 2020 2020 6368 6172 6163 7465 7273  e.    characters
-00010670: 2074 6861 7420 6060 696e 6974 6361 7060   that ``initcap`
-00010680: 6020 7573 6573 2061 7320 7365 7061 7261  ` uses as separa
-00010690: 746f 7273 2066 6f72 2077 6f72 6473 2069  tors for words i
-000106a0: 6e20 7468 6520 696e 7075 7420 6578 7072  n the input expr
-000106b0: 6573 7369 6f6e 2e0a 0a20 2020 2049 6620  ession...    If 
-000106c0: 6060 6465 6c69 6d69 7465 7273 6060 2069  ``delimiters`` i
-000106d0: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
-000106e0: 2061 6e79 206f 6620 7468 6520 666f 6c6c   any of the foll
-000106f0: 6f77 696e 6720 6368 6172 6163 7465 7273  owing characters
-00010700: 2069 6e20 7468 650a 2020 2020 696e 7075   in the.    inpu
-00010710: 7420 6578 7072 6573 7369 6f6e 7320 6172  t expressions ar
-00010720: 6520 7472 6561 7465 6420 6173 2077 6f72  e treated as wor
-00010730: 6420 7365 7061 7261 746f 7273 3a0a 0a20  d separators:.. 
-00010740: 2020 2020 2020 2060 603c 7768 6974 6573         ``<whites
-00010750: 7061 6365 3e20 2120 3f20 4020 2220 5e20  pace> ! ? @ " ^ 
-00010760: 2320 2420 2620 7e20 5f20 2c20 2e20 3a20  # $ & ~ _ , . : 
-00010770: 3b20 2b20 2d20 2a20 2520 2f20 7c20 5c5c  ; + - * % / | \\
-00010780: 205b 205d 2028 2029 207b 207d 203c 203e   [ ] ( ) { } < >
-00010790: 6060 0a0a 2020 2020 4578 616d 706c 6573  ``..    Examples
-000107a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-000107b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-000107c0: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
-000107d0: 7468 6520 736b 7920 6973 2062 6c75 6522  the sky is blue"
-000107e0: 2c20 2257 4520 4341 4e20 4841 4e44 4c45  , "WE CAN HANDLE
-000107f0: 2054 4849 5322 2c20 22c3 84c3 a4c3 96c3   THIS", ".......
-00010800: b6c3 9fc3 9cc3 bc22 2c20 4e6f 6e65 5d2c  .......", None],
-00010810: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00010820: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00010830: 6c65 6374 2869 6e69 7463 6170 2864 665b  lect(initcap(df[
-00010840: 2261 225d 292e 616c 6961 7328 2269 6e69  "a"]).alias("ini
-00010850: 7463 6170 2229 292e 636f 6c6c 6563 7428  tcap")).collect(
-00010860: 290a 2020 2020 2020 2020 5b52 6f77 2849  ).        [Row(I
-00010870: 4e49 5443 4150 3d27 5468 6520 536b 7920  NITCAP='The Sky 
-00010880: 4973 2042 6c75 6527 292c 2052 6f77 2849  Is Blue'), Row(I
-00010890: 4e49 5443 4150 3d27 5765 2043 616e 2048  NITCAP='We Can H
-000108a0: 616e 646c 6520 5468 6973 2729 2c20 526f  andle This'), Ro
-000108b0: 7728 494e 4954 4341 503d 27c3 84c3 a4c3  w(INITCAP='.....
-000108c0: b6c3 b6c3 9fc3 bcc3 bc27 292c 2052 6f77  .........'), Row
-000108d0: 2849 4e49 5443 4150 3d4e 6f6e 6529 5d0a  (INITCAP=None)].
-000108e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000108f0: 656c 6563 7428 696e 6974 6361 7028 6466  elect(initcap(df
-00010900: 5b22 6122 5d2c 206c 6974 2827 2729 292e  ["a"], lit('')).
-00010910: 616c 6961 7328 2269 6e69 7463 6170 2229  alias("initcap")
-00010920: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00010930: 2020 2020 5b52 6f77 2849 4e49 5443 4150      [Row(INITCAP
-00010940: 3d27 5468 6520 736b 7920 6973 2062 6c75  ='The sky is blu
-00010950: 6527 292c 2052 6f77 2849 4e49 5443 4150  e'), Row(INITCAP
-00010960: 3d27 5765 2063 616e 2068 616e 646c 6520  ='We can handle 
-00010970: 7468 6973 2729 2c20 526f 7728 494e 4954  this'), Row(INIT
-00010980: 4341 503d 27c3 84c3 a4c3 b6c3 b6c3 9fc3  CAP='...........
-00010990: bcc3 bc27 292c 2052 6f77 2849 4e49 5443  ...'), Row(INITC
-000109a0: 4150 3d4e 6f6e 6529 5d0a 2020 2020 2222  AP=None)].    ""
-000109b0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-000109c0: 6c5f 6966 5f73 7472 2865 2c20 2269 6e69  l_if_str(e, "ini
-000109d0: 7463 6170 2229 0a20 2020 2069 6620 6465  tcap").    if de
-000109e0: 6c69 6d69 7465 7273 2069 7320 4e6f 6e65  limiters is None
-000109f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00010a00: 2062 7569 6c74 696e 2822 696e 6974 6361   builtin("initca
-00010a10: 7022 2928 6329 0a20 2020 2064 656c 696d  p")(c).    delim
-00010a20: 6974 6572 5f63 6f6c 203d 205f 746f 5f63  iter_col = _to_c
-00010a30: 6f6c 5f69 665f 7374 7228 6465 6c69 6d69  ol_if_str(delimi
-00010a40: 7465 7273 2c20 2269 6e69 7463 6170 2229  ters, "initcap")
-00010a50: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00010a60: 7469 6e28 2269 6e69 7463 6170 2229 2863  tin("initcap")(c
-00010a70: 2c20 6465 6c69 6d69 7465 725f 636f 6c29  , delimiter_col)
-00010a80: 0a0a 0a64 6566 206c 656e 6774 6828 653a  ...def length(e:
-00010a90: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00010aa0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00010ab0: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
-00010ac0: 6520 6c65 6e67 7468 206f 6620 616e 2069  e length of an i
-00010ad0: 6e70 7574 2073 7472 696e 6720 6f72 2062  nput string or b
-00010ae0: 696e 6172 7920 7661 6c75 652e 2046 6f72  inary value. For
-00010af0: 2073 7472 696e 6773 2c0a 2020 2020 7468   strings,.    th
-00010b00: 6520 6c65 6e67 7468 2069 7320 7468 6520  e length is the 
-00010b10: 6e75 6d62 6572 206f 6620 6368 6172 6163  number of charac
-00010b20: 7465 7273 2c20 616e 6420 5554 462d 3820  ters, and UTF-8 
-00010b30: 6368 6172 6163 7465 7273 2061 7265 2063  characters are c
-00010b40: 6f75 6e74 6564 2061 7320 610a 2020 2020  ounted as a.    
-00010b50: 7369 6e67 6c65 2063 6861 7261 6374 6572  single character
-00010b60: 2e20 466f 7220 6269 6e61 7279 2c20 7468  . For binary, th
-00010b70: 6520 6c65 6e67 7468 2069 7320 7468 6520  e length is the 
-00010b80: 6e75 6d62 6572 206f 6620 6279 7465 732e  number of bytes.
-00010b90: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00010ba0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00010bb0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00010bc0: 5f64 6174 6166 7261 6d65 285b 2274 6865  _dataframe(["the
-00010bd0: 2073 6b79 2069 7320 626c 7565 222c 2022   sky is blue", "
-00010be0: 5745 2043 414e 2048 414e 444c 4520 5448  WE CAN HANDLE TH
-00010bf0: 4953 222c 2022 c384 c3a4 c396 c3b6 c39f  IS", "..........
-00010c00: c39c c3bc 222c 204e 6f6e 655d 2c20 7363  ....", None], sc
-00010c10: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00010c20: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00010c30: 7428 6c65 6e67 7468 2864 665b 2261 225d  t(length(df["a"]
-00010c40: 292e 616c 6961 7328 226c 656e 6774 6822  ).alias("length"
-00010c50: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00010c60: 2020 2020 205b 526f 7728 4c45 4e47 5448       [Row(LENGTH
-00010c70: 3d31 3529 2c20 526f 7728 4c45 4e47 5448  =15), Row(LENGTH
-00010c80: 3d31 3829 2c20 526f 7728 4c45 4e47 5448  =18), Row(LENGTH
-00010c90: 3d37 292c 2052 6f77 284c 454e 4754 483d  =7), Row(LENGTH=
-00010ca0: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
-00010cb0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00010cc0: 665f 7374 7228 652c 2022 6c65 6e67 7468  f_str(e, "length
-00010cd0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00010ce0: 696c 7469 6e28 226c 656e 6774 6822 2928  iltin("length")(
-00010cf0: 6329 0a0a 0a64 6566 206c 6f77 6572 2865  c)...def lower(e
-00010d00: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00010d10: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00010d20: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-00010d30: 6865 2069 6e70 7574 2073 7472 696e 6720  he input string 
-00010d40: 7769 7468 2061 6c6c 2063 6861 7261 6374  with all charact
-00010d50: 6572 7320 636f 6e76 6572 7465 6420 746f  ers converted to
-00010d60: 206c 6f77 6572 6361 7365 2e0a 0a20 2020   lowercase...   
-00010d70: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00010d80: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00010d90: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00010da0: 6672 616d 6528 5b27 6162 6327 2c20 2741  frame(['abc', 'A
-00010db0: 6263 272c 2027 6142 4327 2c20 2741 6e66  bc', 'aBC', 'Anf
-00010dc0: c3bc 6872 756e 6773 7a65 6963 6865 6e27  ..hrungszeichen'
-00010dd0: 2c20 2731 342e 3935 20e2 82ac 275d 2c20  , '14.95 ...'], 
-00010de0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00010df0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00010e00: 6563 7428 6c6f 7765 7228 636f 6c28 2261  ect(lower(col("a
-00010e10: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-00010e20: 2020 2020 2020 205b 526f 7728 4c4f 5745         [Row(LOWE
-00010e30: 5228 2241 2229 3d27 6162 6327 292c 2052  R("A")='abc'), R
-00010e40: 6f77 284c 4f57 4552 2822 4122 293d 2761  ow(LOWER("A")='a
-00010e50: 6263 2729 2c20 526f 7728 4c4f 5745 5228  bc'), Row(LOWER(
-00010e60: 2241 2229 3d27 6162 6327 292c 2052 6f77  "A")='abc'), Row
-00010e70: 284c 4f57 4552 2822 4122 293d 2761 6e66  (LOWER("A")='anf
-00010e80: c3bc 6872 756e 6773 7a65 6963 6865 6e27  ..hrungszeichen'
-00010e90: 292c 2052 6f77 284c 4f57 4552 2822 4122  ), Row(LOWER("A"
-00010ea0: 293d 2731 342e 3935 20e2 82ac 2729 5d0a  )='14.95 ...')].
-00010eb0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00010ec0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-00010ed0: 2c20 226c 6f77 6572 2229 0a20 2020 2072  , "lower").    r
-00010ee0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
-00010ef0: 6f77 6572 2229 2863 290a 0a0a 6465 6620  ower")(c)...def 
-00010f00: 6c70 6164 2865 3a20 436f 6c75 6d6e 4f72  lpad(e: ColumnOr
-00010f10: 4e61 6d65 2c20 6c65 6e3a 2055 6e69 6f6e  Name, len: Union
-00010f20: 5b43 6f6c 756d 6e2c 2069 6e74 5d2c 2070  [Column, int], p
-00010f30: 6164 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ad: ColumnOrName
-00010f40: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00010f50: 2022 2222 0a20 2020 204c 6566 742d 7061   """.    Left-pa
-00010f60: 6473 2061 2073 7472 696e 6720 7769 7468  ds a string with
-00010f70: 2063 6861 7261 6374 6572 7320 6672 6f6d   characters from
-00010f80: 2061 6e6f 7468 6572 2073 7472 696e 672c   another string,
-00010f90: 206f 7220 6c65 6674 2d70 6164 7320 610a   or left-pads a.
-00010fa0: 2020 2020 6269 6e61 7279 2076 616c 7565      binary value
-00010fb0: 2077 6974 6820 6279 7465 7320 6672 6f6d   with bytes from
-00010fc0: 2061 6e6f 7468 6572 2062 696e 6172 7920   another binary 
-00010fd0: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
-00010fe0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00010ff0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00011000: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
-00011010: 696f 6e73 2069 6d70 6f72 7420 6c69 740a  ions import lit.
-00011020: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00011030: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00011040: 6461 7461 6672 616d 6528 5b5b 2261 225d  dataframe([["a"]
-00011050: 2c20 5b22 6222 5d2c 205b 2263 225d 5d2c  , ["b"], ["c"]],
-00011060: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-00011070: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00011080: 6c65 6374 286c 7061 6428 636f 6c28 2261  lect(lpad(col("a
-00011090: 2229 2c20 332c 206c 6974 2822 6b22 2929  "), 3, lit("k"))
-000110a0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-000110b0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-000110c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-000110d0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
-000110e0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000110f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011100: 7c6b 6b61 2020 2020 2020 207c 0a20 2020  |kka       |.   
-00011110: 2020 2020 207c 6b6b 6220 2020 2020 2020       |kkb       
-00011120: 7c0a 2020 2020 2020 2020 7c6b 6b63 2020  |.        |kkc  
-00011130: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00011140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00011150: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00011160: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00011170: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-00011180: 2c20 226c 7061 6422 290a 2020 2020 7020  , "lpad").    p 
-00011190: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-000111a0: 2870 6164 2c20 226c 7061 6422 290a 2020  (pad, "lpad").  
-000111b0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-000111c0: 2822 6c70 6164 2229 2863 2c20 6c69 7428  ("lpad")(c, lit(
-000111d0: 6c65 6e29 2c20 7029 0a0a 0a64 6566 206c  len), p)...def l
-000111e0: 7472 696d 2865 3a20 436f 6c75 6d6e 4f72  trim(e: ColumnOr
-000111f0: 4e61 6d65 2c20 7472 696d 5f73 7472 696e  Name, trim_strin
-00011200: 673a 204f 7074 696f 6e61 6c5b 436f 6c75  g: Optional[Colu
-00011210: 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f 6e65  mnOrName] = None
-00011220: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00011230: 2022 2222 0a20 2020 2052 656d 6f76 6573   """.    Removes
-00011240: 206c 6561 6469 6e67 2063 6861 7261 6374   leading charact
-00011250: 6572 732c 2069 6e63 6c75 6469 6e67 2077  ers, including w
-00011260: 6869 7465 7370 6163 652c 2066 726f 6d20  hitespace, from 
-00011270: 6120 7374 7269 6e67 2e0a 0a20 2020 2045  a string...    E
-00011280: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00011290: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-000112a0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-000112b0: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
-000112c0: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
-000112d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000112e0: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
-000112f0: 6173 7373 225d 2c20 5b22 6273 7373 225d  asss"], ["bsss"]
-00011300: 2c20 5b22 6373 7373 225d 5d2c 2073 6368  , ["csss"]], sch
-00011310: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00011320: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00011330: 2872 7472 696d 2863 6f6c 2822 6122 292c  (rtrim(col("a"),
-00011340: 2074 7269 6d5f 7374 7269 6e67 3d6c 6974   trim_string=lit
-00011350: 2822 7373 7322 2929 2e61 6c69 6173 2822  ("sss")).alias("
-00011360: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
-00011370: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00011380: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-00011390: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-000113a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000113b0: 2020 2020 2020 2020 7c61 2020 2020 2020          |a      
-000113c0: 2020 207c 0a20 2020 2020 2020 207c 6220     |.        |b 
-000113d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000113e0: 2020 7c63 2020 2020 2020 2020 207c 0a20    |c         |. 
-000113f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00011400: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00011410: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00011420: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00011430: 6966 5f73 7472 2865 2c20 226c 7472 696d  if_str(e, "ltrim
-00011440: 2229 0a20 2020 2074 203d 205f 746f 5f63  ").    t = _to_c
-00011450: 6f6c 5f69 665f 7374 7228 7472 696d 5f73  ol_if_str(trim_s
-00011460: 7472 696e 672c 2022 6c74 7269 6d22 2920  tring, "ltrim") 
-00011470: 6966 2074 7269 6d5f 7374 7269 6e67 2069  if trim_string i
-00011480: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00011490: 4e6f 6e65 0a20 2020 2072 6574 7572 6e20  None.    return 
-000114a0: 6275 696c 7469 6e28 226c 7472 696d 2229  builtin("ltrim")
-000114b0: 2863 2c20 7429 2069 6620 7420 6973 206e  (c, t) if t is n
-000114c0: 6f74 204e 6f6e 6520 656c 7365 2062 7569  ot None else bui
-000114d0: 6c74 696e 2822 6c74 7269 6d22 2928 6329  ltin("ltrim")(c)
-000114e0: 0a0a 0a64 6566 2072 7061 6428 653a 2043  ...def rpad(e: C
-000114f0: 6f6c 756d 6e4f 724e 616d 652c 206c 656e  olumnOrName, len
-00011500: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
-00011510: 696e 745d 2c20 7061 643a 2043 6f6c 756d  int], pad: Colum
-00011520: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00011530: 6d6e 3a0a 2020 2020 2222 2252 6967 6874  mn:.    """Right
-00011540: 2d70 6164 7320 6120 7374 7269 6e67 2077  -pads a string w
-00011550: 6974 6820 6368 6172 6163 7465 7273 2066  ith characters f
-00011560: 726f 6d20 616e 6f74 6865 7220 7374 7269  rom another stri
-00011570: 6e67 2c20 6f72 2072 6967 6874 2d70 6164  ng, or right-pad
-00011580: 7320 610a 2020 2020 6269 6e61 7279 2076  s a.    binary v
-00011590: 616c 7565 2077 6974 6820 6279 7465 7320  alue with bytes 
-000115a0: 6672 6f6d 2061 6e6f 7468 6572 2062 696e  from another bin
-000115b0: 6172 7920 7661 6c75 652e 2057 6865 6e20  ary value. When 
-000115c0: 6361 6c6c 6564 2c20 6065 6020 6973 2070  called, `e` is p
-000115d0: 6164 6465 6420 746f 206c 656e 6774 6820  added to length 
-000115e0: 606c 656e 600a 2020 2020 7769 7468 2063  `len`.    with c
-000115f0: 6861 7261 6374 6572 732f 6279 7465 7320  haracters/bytes 
-00011600: 6672 6f6d 2060 7061 6460 2e0a 0a20 2020  from `pad`...   
-00011610: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00011620: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00011630: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00011640: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00011650: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
-00011660: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00011670: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00011680: 5b22 6122 5d2c 205b 2262 225d 2c20 5b22  ["a"], ["b"], ["
-00011690: 6322 5d5d 2c20 7363 6865 6d61 3d5b 2261  c"]], schema=["a
-000116a0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000116b0: 6466 2e73 656c 6563 7428 7270 6164 2863  df.select(rpad(c
-000116c0: 6f6c 2822 6122 292c 2033 2c20 6c69 7428  ol("a"), 3, lit(
-000116d0: 226b 2229 292e 616c 6961 7328 2272 6573  "k")).alias("res
-000116e0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-000116f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00011700: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-00011710: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-00011720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00011730: 2020 2020 207c 616b 6b20 2020 2020 2020       |akk       
-00011740: 7c0a 2020 2020 2020 2020 7c62 6b6b 2020  |.        |bkk  
-00011750: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00011760: 636b 6b20 2020 2020 2020 7c0a 2020 2020  ckk       |.    
-00011770: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00011780: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00011790: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-000117a0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-000117b0: 7374 7228 652c 2022 7270 6164 2229 0a20  str(e, "rpad"). 
-000117c0: 2020 2070 203d 205f 746f 5f63 6f6c 5f69     p = _to_col_i
-000117d0: 665f 7374 7228 7061 642c 2022 7270 6164  f_str(pad, "rpad
-000117e0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-000117f0: 696c 7469 6e28 2272 7061 6422 2928 632c  iltin("rpad")(c,
-00011800: 206c 6974 286c 656e 292c 2070 290a 0a0a   lit(len), p)...
-00011810: 6465 6620 7274 7269 6d28 653a 2043 6f6c  def rtrim(e: Col
-00011820: 756d 6e4f 724e 616d 652c 2074 7269 6d5f  umnOrName, trim_
-00011830: 7374 7269 6e67 3a20 4f70 7469 6f6e 616c  string: Optional
-00011840: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
-00011850: 204e 6f6e 6529 202d 3e20 436f 6c75 6d6e   None) -> Column
-00011860: 3a0a 2020 2020 2222 2252 656d 6f76 6573  :.    """Removes
-00011870: 2074 7261 696c 696e 6720 6368 6172 6163   trailing charac
-00011880: 7465 7273 2c20 696e 636c 7564 696e 6720  ters, including 
-00011890: 7768 6974 6573 7061 6365 2c20 6672 6f6d  whitespace, from
-000118a0: 2061 2073 7472 696e 672e 0a0a 2020 2020   a string...    
-000118b0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000118c0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-000118d0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-000118e0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-000118f0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
-00011900: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00011910: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00011920: 2261 7373 7322 5d2c 205b 2262 7373 7322  "asss"], ["bsss"
-00011930: 5d2c 205b 2263 7373 7322 5d5d 2c20 7363  ], ["csss"]], sc
-00011940: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00011950: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00011960: 7428 7274 7269 6d28 636f 6c28 2261 2229  t(rtrim(col("a")
-00011970: 2c20 7472 696d 5f73 7472 696e 673d 6c69  , trim_string=li
-00011980: 7428 2273 7373 2229 292e 616c 6961 7328  t("sss")).alias(
-00011990: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-000119a0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-000119b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-000119c0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-000119d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000119e0: 0a20 2020 2020 2020 207c 6120 2020 2020  .        |a     
-000119f0: 2020 2020 7c0a 2020 2020 2020 2020 7c62      |.        |b
-00011a00: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00011a10: 2020 207c 6320 2020 2020 2020 2020 7c0a     |c         |.
-00011a20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00011a30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00011a40: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00011a50: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00011a60: 5f69 665f 7374 7228 652c 2022 7274 7269  _if_str(e, "rtri
-00011a70: 6d22 290a 2020 2020 7420 3d20 5f74 6f5f  m").    t = _to_
-00011a80: 636f 6c5f 6966 5f73 7472 2874 7269 6d5f  col_if_str(trim_
-00011a90: 7374 7269 6e67 2c20 2272 7472 696d 2229  string, "rtrim")
-00011aa0: 2069 6620 7472 696d 5f73 7472 696e 6720   if trim_string 
-00011ab0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-00011ac0: 204e 6f6e 650a 2020 2020 7265 7475 726e   None.    return
-00011ad0: 2062 7569 6c74 696e 2822 7274 7269 6d22   builtin("rtrim"
-00011ae0: 2928 632c 2074 2920 6966 2074 2069 7320  )(c, t) if t is 
-00011af0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 6275  not None else bu
-00011b00: 696c 7469 6e28 2272 7472 696d 2229 2863  iltin("rtrim")(c
-00011b10: 290a 0a0a 6465 6620 7265 7065 6174 2873  )...def repeat(s
-00011b20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00011b30: 6e3a 2055 6e69 6f6e 5b43 6f6c 756d 6e2c  n: Union[Column,
-00011b40: 2069 6e74 5d29 202d 3e20 436f 6c75 6d6e   int]) -> Column
-00011b50: 3a0a 2020 2020 2222 2242 7569 6c64 7320  :.    """Builds 
-00011b60: 6120 7374 7269 6e67 2062 7920 7265 7065  a string by repe
-00011b70: 6174 696e 6720 7468 6520 696e 7075 7420  ating the input 
-00011b80: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
-00011b90: 6420 6e75 6d62 6572 206f 6620 7469 6d65  d number of time
-00011ba0: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
-00011bb0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00011bc0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00011bd0: 7465 5f64 6174 6166 7261 6d65 285b 5b22  te_dataframe([["
-00011be0: 6122 5d2c 205b 2262 225d 2c20 5b22 6322  a"], ["b"], ["c"
-00011bf0: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-00011c00: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00011c10: 2e73 656c 6563 7428 7265 7065 6174 2863  .select(repeat(c
-00011c20: 6f6c 2822 6122 292c 2033 292e 616c 6961  ol("a"), 3).alia
-00011c30: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-00011c40: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00011c50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00011c60: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-00011c70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00011c80: 2d2d 0a20 2020 2020 2020 207c 6161 6120  --.        |aaa 
-00011c90: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00011ca0: 7c62 6262 2020 2020 2020 207c 0a20 2020  |bbb       |.   
-00011cb0: 2020 2020 207c 6363 6320 2020 2020 2020       |ccc       
-00011cc0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00011cd0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00011ce0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00011cf0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00011d00: 6f6c 5f69 665f 7374 7228 732c 2022 7265  ol_if_str(s, "re
-00011d10: 7065 6174 2229 0a20 2020 2072 6574 7572  peat").    retur
-00011d20: 6e20 6275 696c 7469 6e28 2272 6570 6561  n builtin("repea
-00011d30: 7422 2928 632c 206c 6974 286e 2929 0a0a  t")(c, lit(n))..
-00011d40: 0a64 6566 2072 6576 6572 7365 2863 6f6c  .def reverse(col
-00011d50: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00011d60: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00011d70: 2222 5265 7665 7273 6573 2074 6865 206f  ""Reverses the o
-00011d80: 7264 6572 206f 6620 6368 6172 6163 7465  rder of characte
-00011d90: 7273 2069 6e20 6120 7374 7269 6e67 2c20  rs in a string, 
-00011da0: 6f72 206f 6620 6279 7465 7320 696e 2061  or of bytes in a
-00011db0: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
-00011dc0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00011dd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00011de0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00011df0: 6174 6166 7261 6d65 285b 5b22 4865 6c6c  ataframe([["Hell
-00011e00: 6f22 5d2c 205b 2261 6263 225d 5d2c 2073  o"], ["abc"]], s
-00011e10: 6368 656d 613d 5b22 636f 6c31 225d 290a  chema=["col1"]).
-00011e20: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00011e30: 656c 6563 7428 7265 7665 7273 6528 636f  elect(reverse(co
-00011e40: 6c28 2263 6f6c 3122 2929 292e 7368 6f77  l("col1"))).show
-00011e50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00011e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011e70: 2d2d 0a20 2020 2020 2020 207c 2252 4556  --.        |"REV
-00011e80: 4552 5345 2822 2243 4f4c 3122 2229 2220  ERSE(""COL1"")" 
-00011e90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00011ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011eb0: 2d2d 0a20 2020 2020 2020 207c 6f6c 6c65  --.        |olle
-00011ec0: 4820 2020 2020 2020 2020 2020 2020 2020  H               
-00011ed0: 207c 0a20 2020 2020 2020 207c 6362 6120   |.        |cba 
-00011ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ef0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00011f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011f10: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00011f20: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00011f30: 2020 2063 6f6c 203d 205f 746f 5f63 6f6c     col = _to_col
-00011f40: 5f69 665f 7374 7228 636f 6c2c 2022 7265  _if_str(col, "re
-00011f50: 7665 7273 6522 290a 2020 2020 7265 7475  verse").    retu
-00011f60: 726e 2062 7569 6c74 696e 2822 7265 7665  rn builtin("reve
-00011f70: 7273 6522 2928 636f 6c29 0a0a 0a64 6566  rse")(col)...def
-00011f80: 2073 6f75 6e64 6578 2865 3a20 436f 6c75   soundex(e: Colu
-00011f90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00011fa0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00011fb0: 726e 7320 6120 7374 7269 6e67 2074 6861  rns a string tha
-00011fc0: 7420 636f 6e74 6169 6e73 2061 2070 686f  t contains a pho
-00011fd0: 6e65 7469 6320 7265 7072 6573 656e 7461  netic representa
-00011fe0: 7469 6f6e 206f 6620 7468 6520 696e 7075  tion of the inpu
-00011ff0: 7420 7374 7269 6e67 2e0a 0a20 2020 2045  t string...    E
-00012000: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-00012010: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00012020: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00012030: 6d65 285b 224d 6172 7368 6122 2c20 224d  me(["Marsha", "M
-00012040: 6172 6369 6122 5d2c 2073 6368 656d 613d  arcia"], schema=
-00012050: 5b22 5622 5d29 2e73 656c 6563 7428 736f  ["V"]).select(so
-00012060: 756e 6465 7828 636f 6c28 2256 2229 2929  undex(col("V")))
-00012070: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00012080: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00012090: 2020 5b52 6f77 2853 4f55 4e44 4558 2822    [Row(SOUNDEX("
-000120a0: 5622 293d 274d 3632 3027 292c 2052 6f77  V")='M620'), Row
-000120b0: 2853 4f55 4e44 4558 2822 5622 293d 274d  (SOUNDEX("V")='M
-000120c0: 3632 3027 295d 0a20 2020 2022 2222 0a20  620')].    """. 
-000120d0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-000120e0: 665f 7374 7228 652c 2022 736f 756e 6465  f_str(e, "sounde
-000120f0: 7822 290a 2020 2020 7265 7475 726e 2062  x").    return b
-00012100: 7569 6c74 696e 2822 736f 756e 6465 7822  uiltin("soundex"
-00012110: 2928 6329 0a0a 0a64 6566 2074 7269 6d28  )(c)...def trim(
-00012120: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
-00012130: 2074 7269 6d5f 7374 7269 6e67 3a20 4f70   trim_string: Op
-00012140: 7469 6f6e 616c 5b43 6f6c 756d 6e4f 724e  tional[ColumnOrN
-00012150: 616d 655d 203d 204e 6f6e 6529 202d 3e20  ame] = None) -> 
-00012160: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00012170: 656d 6f76 6573 206c 6561 6469 6e67 2061  emoves leading a
-00012180: 6e64 2074 7261 696c 696e 6720 6368 6172  nd trailing char
-00012190: 6163 7465 7273 2066 726f 6d20 6120 7374  acters from a st
-000121a0: 7269 6e67 2e20 5065 7220 6465 6661 756c  ring. Per defaul
-000121b0: 7420 6f6e 6c79 2077 6869 7465 7370 6163  t only whitespac
-000121c0: 6520 2720 2720 6368 6172 6163 7465 7273  e ' ' characters
-000121d0: 2061 7265 2072 656d 6f76 6564 2e0a 0a20   are removed... 
-000121e0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-000121f0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00012200: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00012210: 7461 6672 616d 6528 5b27 6865 6c6c 6f27  taframe(['hello'
-00012220: 2c20 2720 776f 726c 6427 2c20 2720 2020  , ' world', '   
-00012230: 2120 2020 275d 2c20 7363 6865 6d61 3d5b  !   '], schema=[
-00012240: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00012250: 3e20 6466 2e63 6f6c 6c65 6374 2829 0a20  > df.collect(). 
-00012260: 2020 2020 2020 205b 526f 7728 413d 2768         [Row(A='h
-00012270: 656c 6c6f 2729 2c20 526f 7728 413d 2720  ello'), Row(A=' 
-00012280: 776f 726c 6427 292c 2052 6f77 2841 3d27  world'), Row(A='
-00012290: 2020 2021 2020 2027 295d 0a20 2020 2020     !   ')].     
-000122a0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000122b0: 2874 7269 6d28 636f 6c28 2261 2229 2929  (trim(col("a")))
-000122c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000122d0: 2020 205b 526f 7728 5452 494d 2822 4122     [Row(TRIM("A"
-000122e0: 293d 2768 656c 6c6f 2729 2c20 526f 7728  )='hello'), Row(
-000122f0: 5452 494d 2822 4122 293d 2777 6f72 6c64  TRIM("A")='world
-00012300: 2729 2c20 526f 7728 5452 494d 2822 4122  '), Row(TRIM("A"
-00012310: 293d 2721 2729 5d0a 0a20 2020 2045 7861  )='!')]..    Exa
-00012320: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00012330: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00012340: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00012350: 6528 5b27 4555 5220 3132 2e39 3627 2c20  e(['EUR 12.96', 
-00012360: 2737 2e38 3955 5344 272c 2027 352e 3939  '7.89USD', '5.99
-00012370: 4527 5d2c 2073 6368 656d 613d 5b22 6122  E'], schema=["a"
-00012380: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00012390: 662e 7365 6c65 6374 2874 7269 6d28 636f  f.select(trim(co
-000123a0: 6c28 2261 2229 2c20 6c69 7428 2245 5552  l("a"), lit("EUR
-000123b0: 5553 4420 2229 292e 6173 5f28 2261 6e73  USD ")).as_("ans
-000123c0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-000123d0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
-000123e0: 3132 2e39 3627 292c 2052 6f77 2841 4e53  12.96'), Row(ANS
-000123f0: 3d27 372e 3839 2729 2c20 526f 7728 414e  ='7.89'), Row(AN
-00012400: 533d 2735 2e39 3927 295d 0a0a 2020 2020  S='5.99')]..    
-00012410: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00012420: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00012430: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00012440: 7261 6d65 285b 2761 6263 3132 2034 3561  rame(['abc12 45a
-00012450: 2037 3962 6321 275d 2c20 7363 6865 6d61   79bc!'], schema
-00012460: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00012470: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-00012480: 696d 2863 6f6c 2822 6122 292c 206c 6974  im(col("a"), lit
-00012490: 2822 6162 6321 2229 292e 6173 5f28 2261  ("abc!")).as_("a
-000124a0: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-000124b0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-000124c0: 3d27 3132 2034 3561 2037 3927 295d 0a0a  ='12 45a 79')]..
-000124d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-000124e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-000124f0: 2c20 2274 7269 6d22 290a 2020 2020 7420  , "trim").    t 
-00012500: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00012510: 2874 7269 6d5f 7374 7269 6e67 2c20 2274  (trim_string, "t
-00012520: 7269 6d22 2920 6966 2074 7269 6d5f 7374  rim") if trim_st
-00012530: 7269 6e67 2069 7320 6e6f 7420 4e6f 6e65  ring is not None
-00012540: 2065 6c73 6520 4e6f 6e65 0a20 2020 2072   else None.    r
-00012550: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
-00012560: 7269 6d22 2928 632c 2074 2920 6966 2074  rim")(c, t) if t
-00012570: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-00012580: 6520 6275 696c 7469 6e28 2274 7269 6d22  e builtin("trim"
-00012590: 2928 6329 0a0a 0a64 6566 2075 7070 6572  )(c)...def upper
-000125a0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-000125b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000125c0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-000125d0: 696e 7075 7420 7374 7269 6e67 2077 6974  input string wit
-000125e0: 6820 616c 6c20 6368 6172 6163 7465 7273  h all characters
-000125f0: 2063 6f6e 7665 7274 6564 2074 6f20 7570   converted to up
-00012600: 7065 7263 6173 652e 0a20 2020 2020 2020  percase..       
-00012610: 556e 6963 6f64 6520 6368 6172 6163 7465  Unicode characte
-00012620: 7273 2061 7265 2073 7570 706f 7274 6564  rs are supported
-00012630: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00012640: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00012650: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00012660: 655f 6461 7461 6672 616d 6528 5b27 6162  e_dataframe(['ab
-00012670: 6327 2c20 2741 6263 272c 2027 6142 4327  c', 'Abc', 'aBC'
-00012680: 2c20 2741 6e66 c3bc 6872 756e 6773 7a65  , 'Anf..hrungsze
-00012690: 6963 6865 6e27 2c20 2731 342e 3935 20e2  ichen', '14.95 .
-000126a0: 82ac 275d 2c20 7363 6865 6d61 3d5b 2261  ..'], schema=["a
-000126b0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000126c0: 6466 2e73 656c 6563 7428 7570 7065 7228  df.select(upper(
-000126d0: 636f 6c28 2261 2229 2929 2e63 6f6c 6c65  col("a"))).colle
-000126e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-000126f0: 7728 5550 5045 5228 2241 2229 3d27 4142  w(UPPER("A")='AB
-00012700: 4327 292c 2052 6f77 2855 5050 4552 2822  C'), Row(UPPER("
-00012710: 4122 293d 2741 4243 2729 2c20 526f 7728  A")='ABC'), Row(
-00012720: 5550 5045 5228 2241 2229 3d27 4142 4327  UPPER("A")='ABC'
-00012730: 292c 2052 6f77 2855 5050 4552 2822 4122  ), Row(UPPER("A"
-00012740: 293d 2741 4e46 c39c 4852 554e 4753 5a45  )='ANF..HRUNGSZE
-00012750: 4943 4845 4e27 292c 2052 6f77 2855 5050  ICHEN'), Row(UPP
-00012760: 4552 2822 4122 293d 2731 342e 3935 20e2  ER("A")='14.95 .
-00012770: 82ac 2729 5d0a 2020 2020 2222 220a 2020  ..')].    """.  
-00012780: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00012790: 5f73 7472 2865 2c20 2275 7070 6572 2229  _str(e, "upper")
-000127a0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-000127b0: 7469 6e28 2275 7070 6572 2229 2863 290a  tin("upper")(c).
-000127c0: 0a0a 6465 6620 7374 7274 6f6b 5f74 6f5f  ..def strtok_to_
-000127d0: 6172 7261 7928 0a20 2020 2074 6578 743a  array(.    text:
-000127e0: 2043 6f6c 756d 6e4f 724e 616d 652c 2064   ColumnOrName, d
-000127f0: 656c 696d 6974 6572 3a20 4f70 7469 6f6e  elimiter: Option
-00012800: 616c 5b43 6f6c 756d 6e4f 724e 616d 655d  al[ColumnOrName]
-00012810: 203d 204e 6f6e 650a 2920 2d3e 2043 6f6c   = None.) -> Col
-00012820: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00012830: 2054 6f6b 656e 697a 6573 2074 6865 2067   Tokenizes the g
-00012840: 6976 656e 2073 7472 696e 6720 7573 696e  iven string usin
-00012850: 6720 7468 6520 6769 7665 6e20 7365 7420  g the given set 
-00012860: 6f66 2064 656c 696d 6974 6572 7320 616e  of delimiters an
-00012870: 6420 7265 7475 726e 7320 7468 6520 746f  d returns the to
-00012880: 6b65 6e73 2061 7320 616e 2061 7272 6179  kens as an array
-00012890: 2e0a 0a20 2020 2049 6620 6569 7468 6572  ...    If either
-000128a0: 2070 6172 616d 6574 6572 2069 7320 6120   parameter is a 
-000128b0: 4e55 4c4c 2c20 6120 4e55 4c4c 2069 7320  NULL, a NULL is 
-000128c0: 7265 7475 726e 6564 2e20 416e 2065 6d70  returned. An emp
-000128d0: 7479 2061 7272 6179 2069 7320 7265 7475  ty array is retu
-000128e0: 726e 6564 2069 6620 746f 6b65 6e69 7a61  rned if tokeniza
-000128f0: 7469 6f6e 2070 726f 6475 6365 7320 6e6f  tion produces no
-00012900: 2074 6f6b 656e 732e 0a0a 2020 2020 4578   tokens...    Ex
-00012910: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00012920: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00012930: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00012940: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-00012950: 2020 205b 5b22 612e 622e 6322 2c20 222e     [["a.b.c", ".
-00012960: 225d 2c20 5b22 312c 322e 3322 2c20 222c  "], ["1,2.3", ",
-00012970: 225d 5d2c 0a20 2020 2020 2020 202e 2e2e  "]],.        ...
-00012980: 2020 2020 2073 6368 656d 613d 5b22 7465       schema=["te
-00012990: 7874 222c 2022 6465 6c69 6d69 7465 7222  xt", "delimiter"
-000129a0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
-000129b0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000129c0: 7365 6c65 6374 2873 7472 746f 6b5f 746f  select(strtok_to
-000129d0: 5f61 7272 6179 2822 7465 7874 222c 2022  _array("text", "
-000129e0: 6465 6c69 6d69 7465 7222 292e 616c 6961  delimiter").alia
-000129f0: 7328 2254 494d 455f 4652 4f4d 5f50 4152  s("TIME_FROM_PAR
-00012a00: 5453 2229 292e 636f 6c6c 6563 7428 290a  TS")).collect().
-00012a10: 2020 2020 2020 2020 5b52 6f77 2854 494d          [Row(TIM
-00012a20: 455f 4652 4f4d 5f50 4152 5453 3d27 5b5c  E_FROM_PARTS='[\
-00012a30: 5c6e 2020 2261 222c 5c5c 6e20 2022 6222  \n  "a",\\n  "b"
-00012a40: 2c5c 5c6e 2020 2263 225c 5c6e 5d27 292c  ,\\n  "c"\\n]'),
-00012a50: 2052 6f77 2854 494d 455f 4652 4f4d 5f50   Row(TIME_FROM_P
-00012a60: 4152 5453 3d27 5b5c 5c6e 2020 2231 222c  ARTS='[\\n  "1",
-00012a70: 5c5c 6e20 2022 322e 3322 5c5c 6e5d 2729  \\n  "2.3"\\n]')
-00012a80: 5d0a 2020 2020 2222 220a 2020 2020 7420  ].    """.    t 
-00012a90: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00012aa0: 2874 6578 742c 2022 7374 7274 6f6b 5f74  (text, "strtok_t
-00012ab0: 6f5f 6172 7261 7922 290a 2020 2020 6420  o_array").    d 
-00012ac0: 3d20 280a 2020 2020 2020 2020 5f74 6f5f  = (.        _to_
-00012ad0: 636f 6c5f 6966 5f73 7472 2864 656c 696d  col_if_str(delim
-00012ae0: 6974 6572 2c20 2273 7472 746f 6b5f 746f  iter, "strtok_to
-00012af0: 5f61 7272 6179 2229 0a20 2020 2020 2020  _array").       
-00012b00: 2069 6620 2864 656c 696d 6974 6572 2069   if (delimiter i
-00012b10: 7320 6e6f 7420 4e6f 6e65 290a 2020 2020  s not None).    
-00012b20: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
-00012b30: 2020 290a 2020 2020 7265 7475 726e 2028    ).    return (
-00012b40: 0a20 2020 2020 2020 2062 7569 6c74 696e  .        builtin
-00012b50: 2822 7374 7274 6f6b 5f74 6f5f 6172 7261  ("strtok_to_arra
-00012b60: 7922 2928 742c 2064 290a 2020 2020 2020  y")(t, d).      
-00012b70: 2020 6966 2028 6465 6c69 6d69 7465 7220    if (delimiter 
-00012b80: 6973 206e 6f74 204e 6f6e 6529 0a20 2020  is not None).   
-00012b90: 2020 2020 2065 6c73 6520 6275 696c 7469       else builti
-00012ba0: 6e28 2273 7472 746f 6b5f 746f 5f61 7272  n("strtok_to_arr
-00012bb0: 6179 2229 2874 290a 2020 2020 290a 0a0a  ay")(t).    )...
-00012bc0: 6465 6620 7374 7275 6374 282a 636f 6c73  def struct(*cols
-00012bd0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00012be0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00012bf0: 2222 0a20 2020 2052 6574 7572 6e73 2061  "".    Returns a
-00012c00: 6e20 4f42 4a45 4354 2063 6f6e 7374 7275  n OBJECT constru
-00012c10: 6374 6564 2077 6974 6820 7468 6520 6769  cted with the gi
-00012c20: 7665 6e20 636f 6c75 6d6e 732e 0a0a 2020  ven columns...  
-00012c30: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-00012c40: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00012c50: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00012c60: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
-00012c70: 2073 7472 7563 740a 2020 2020 2020 2020   struct.        
-00012c80: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00012c90: 2e63 7265 6174 6544 6174 6146 7261 6d65  .createDataFrame
-00012ca0: 285b 2822 426f 6222 2c20 3830 292c 2028  ([("Bob", 80), (
-00012cb0: 2241 6c69 6365 222c 204e 6f6e 6529 5d2c  "Alice", None)],
-00012cc0: 205b 226e 616d 6522 2c20 2261 6765 225d   ["name", "age"]
-00012cd0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-00012ce0: 7320 3d20 6466 2e73 656c 6563 7428 7374  s = df.select(st
-00012cf0: 7275 6374 2822 6167 6522 2c20 226e 616d  ruct("age", "nam
-00012d00: 6522 292e 616c 6961 7328 2273 7472 7563  e").alias("struc
-00012d10: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00012d20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00012d30: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00012d40: 2020 7c22 5354 5255 4354 2220 2020 2020    |"STRUCT"     
-00012d50: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00012d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012d70: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c7b  -----.        |{
-00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d90: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
-00012da0: 6167 6522 3a20 3830 2c20 2020 2020 2020  age": 80,       
-00012db0: 7c0a 2020 2020 2020 2020 7c20 2022 6e61  |.        |  "na
-00012dc0: 6d65 223a 2022 426f 6222 2020 2020 7c0a  me": "Bob"    |.
-00012dd0: 2020 2020 2020 2020 7c7d 2020 2020 2020          |}      
-00012de0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00012df0: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
-00012e00: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00012e10: 2020 2020 7c20 2022 6167 6522 3a20 6e75      |  "age": nu
-00012e20: 6c6c 2c20 2020 2020 7c0a 2020 2020 2020  ll,     |.      
-00012e30: 2020 7c20 2022 6e61 6d65 223a 2022 416c    |  "name": "Al
-00012e40: 6963 6522 2020 7c0a 2020 2020 2020 2020  ice"  |.        
-00012e50: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
-00012e60: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00012e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012e80: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00012e90: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00012ea0: 0a20 2020 2064 6566 2066 6c61 7474 656e  .    def flatten
-00012eb0: 5f63 6f6c 5f6c 6973 7428 6f62 6a29 3a0a  _col_list(obj):.
-00012ec0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00012ed0: 7461 6e63 6528 6f62 6a2c 2073 7472 2920  tance(obj, str) 
-00012ee0: 6f72 2069 7369 6e73 7461 6e63 6528 6f62  or isinstance(ob
-00012ef0: 6a2c 2043 6f6c 756d 6e29 3a0a 2020 2020  j, Column):.    
-00012f00: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00012f10: 6f62 6a5d 0a20 2020 2020 2020 2065 6c69  obj].        eli
-00012f20: 6620 6861 7361 7474 7228 6f62 6a2c 2022  f hasattr(obj, "
-00012f30: 5f5f 6974 6572 5f5f 2229 3a0a 2020 2020  __iter__"):.    
-00012f40: 2020 2020 2020 2020 6163 6320 3d20 5b5d          acc = []
-00012f50: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00012f60: 2069 6e6e 6572 4f62 6a20 696e 206f 626a   innerObj in obj
-00012f70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012f80: 2020 6163 6320 3d20 6163 6320 2b20 666c    acc = acc + fl
-00012f90: 6174 7465 6e5f 636f 6c5f 6c69 7374 2869  atten_col_list(i
-00012fa0: 6e6e 6572 4f62 6a29 0a20 2020 2020 2020  nnerObj).       
-00012fb0: 2020 2020 2072 6574 7572 6e20 6163 630a       return acc.
-00012fc0: 0a20 2020 206e 6577 5f63 6f6c 7320 3d20  .    new_cols = 
-00012fd0: 5b5d 0a20 2020 2066 6f72 2063 2069 6e20  [].    for c in 
-00012fe0: 666c 6174 7465 6e5f 636f 6c5f 6c69 7374  flatten_col_list
-00012ff0: 2863 6f6c 7329 3a0a 2020 2020 2020 2020  (cols):.        
-00013000: 2320 6669 7273 7420 696e 7365 7274 2066  # first insert f
-00013010: 6965 6c64 5f6e 616d 650a 2020 2020 2020  ield_name.      
-00013020: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00013030: 632c 2073 7472 293a 0a20 2020 2020 2020  c, str):.       
-00013040: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
-00013050: 7065 6e64 286c 6974 2863 2929 0a20 2020  pend(lit(c)).   
-00013060: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00013070: 2020 2020 2020 206e 616d 6520 3d20 632e         name = c.
-00013080: 5f65 7870 7265 7373 696f 6e2e 6e61 6d65  _expression.name
-00013090: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-000130a0: 6520 3d20 6e61 6d65 5b31 3a5d 2069 6620  e = name[1:] if 
-000130b0: 6e61 6d65 2e73 7461 7274 7377 6974 6828  name.startswith(
-000130c0: 2722 2729 2065 6c73 6520 6e61 6d65 0a20  '"') else name. 
-000130d0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-000130e0: 3d20 6e61 6d65 5b3a 2d31 5d20 6966 206e  = name[:-1] if n
-000130f0: 616d 652e 656e 6473 7769 7468 2827 2227  ame.endswith('"'
-00013100: 2920 656c 7365 206e 616d 650a 2020 2020  ) else name.    
-00013110: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
-00013120: 2e61 7070 656e 6428 6c69 7428 6e61 6d65  .append(lit(name
-00013130: 2929 0a20 2020 2020 2020 2023 206e 6578  )).        # nex
-00013140: 7420 696e 7365 7274 2066 6965 6c64 2076  t insert field v
-00013150: 616c 7565 0a20 2020 2020 2020 2063 203d  alue.        c =
-00013160: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00013170: 632c 2022 7374 7275 6374 2229 0a20 2020  c, "struct").   
-00013180: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00013190: 6365 2863 2c20 436f 6c75 6d6e 2920 616e  ce(c, Column) an
-000131a0: 6420 6973 696e 7374 616e 6365 2863 2e5f  d isinstance(c._
-000131b0: 6578 7072 6573 7369 6f6e 2c20 416c 6961  expression, Alia
-000131c0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000131d0: 6e65 775f 636f 6c73 2e61 7070 656e 6428  new_cols.append(
-000131e0: 636f 6c28 632e 5f65 7870 7265 7373 696f  col(c._expressio
-000131f0: 6e2e 6368 696c 6472 656e 5b30 5d29 290a  n.children[0])).
-00013200: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00013210: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
-00013220: 6c73 2e61 7070 656e 6428 6329 0a20 2020  ls.append(c).   
-00013230: 2072 6574 7572 6e20 6f62 6a65 6374 5f63   return object_c
-00013240: 6f6e 7374 7275 6374 5f6b 6565 705f 6e75  onstruct_keep_nu
-00013250: 6c6c 282a 6e65 775f 636f 6c73 290a 0a0a  ll(*new_cols)...
-00013260: 6465 6620 6c6f 6728 0a20 2020 2062 6173  def log(.    bas
-00013270: 653a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  e: Union[ColumnO
-00013280: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
-00013290: 745d 2c20 783a 2055 6e69 6f6e 5b43 6f6c  t], x: Union[Col
-000132a0: 756d 6e4f 724e 616d 652c 2069 6e74 2c20  umnOrName, int, 
-000132b0: 666c 6f61 745d 0a29 202d 3e20 436f 6c75  float].) -> Colu
-000132c0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-000132d0: 5265 7475 726e 7320 7468 6520 6c6f 6761  Returns the loga
-000132e0: 7269 7468 6d20 6f66 2061 206e 756d 6572  rithm of a numer
-000132f0: 6963 2065 7870 7265 7373 696f 6e2e 0a0a  ic expression...
-00013300: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00013310: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00013320: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00013330: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-00013340: 496e 7465 6765 7254 7970 650a 2020 2020  IntegerType.    
-00013350: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00013360: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00013370: 6672 616d 6528 5b31 2c20 3130 5d2c 2073  frame([1, 10], s
-00013380: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00013390: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-000133a0: 6374 286c 6f67 2831 302c 2064 665b 2261  ct(log(10, df["a
-000133b0: 225d 292e 6361 7374 2849 6e74 6567 6572  "]).cast(Integer
-000133c0: 5479 7065 2829 292e 616c 6961 7328 226c  Type()).alias("l
-000133d0: 6f67 2229 292e 636f 6c6c 6563 7428 290a  og")).collect().
-000133e0: 2020 2020 2020 2020 5b52 6f77 284c 4f47          [Row(LOG
-000133f0: 3d30 292c 2052 6f77 284c 4f47 3d31 295d  =0), Row(LOG=1)]
-00013400: 0a20 2020 2022 2222 0a20 2020 2062 203d  .    """.    b =
-00013410: 206c 6974 2862 6173 6529 2069 6620 6973   lit(base) if is
-00013420: 696e 7374 616e 6365 2862 6173 652c 2028  instance(base, (
-00013430: 696e 742c 2066 6c6f 6174 2929 2065 6c73  int, float)) els
-00013440: 6520 5f74 6f5f 636f 6c5f 6966 5f73 7472  e _to_col_if_str
-00013450: 2862 6173 652c 2022 6c6f 6722 290a 2020  (base, "log").  
-00013460: 2020 6172 6720 3d20 6c69 7428 7829 2069    arg = lit(x) i
-00013470: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
-00013480: 2869 6e74 2c20 666c 6f61 7429 2920 656c  (int, float)) el
-00013490: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
-000134a0: 7228 782c 2022 6c6f 6722 290a 2020 2020  r(x, "log").    
-000134b0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-000134c0: 6c6f 6722 2928 622c 2061 7267 290a 0a0a  log")(b, arg)...
-000134d0: 6465 6620 706f 7728 0a20 2020 206c 6566  def pow(.    lef
-000134e0: 743a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  t: Union[ColumnO
-000134f0: 724e 616d 652c 2069 6e74 2c20 666c 6f61  rName, int, floa
-00013500: 745d 2c20 7269 6768 743a 2055 6e69 6f6e  t], right: Union
-00013510: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00013520: 6e74 2c20 666c 6f61 745d 0a29 202d 3e20  nt, float].) -> 
-00013530: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00013540: 6574 7572 6e73 2061 206e 756d 6265 7220  eturns a number 
-00013550: 286c 6566 7429 2072 6169 7365 6420 746f  (left) raised to
-00013560: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
-00013570: 6f77 6572 2028 7269 6768 7429 2e0a 0a20  ower (right)... 
-00013580: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00013590: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000135a0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000135b0: 6166 7261 6d65 285b 5b32 2c20 335d 2c20  aframe([[2, 3], 
-000135c0: 5b33 2c20 345d 5d2c 2073 6368 656d 613d  [3, 4]], schema=
-000135d0: 5b22 7822 2c20 2279 225d 290a 2020 2020  ["x", "y"]).    
-000135e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000135f0: 7428 706f 7728 636f 6c28 2278 2229 2c20  t(pow(col("x"), 
-00013600: 636f 6c28 2279 2229 292e 616c 6961 7328  col("y")).alias(
-00013610: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00013620: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00013630: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00013640: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00013650: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00013660: 0a20 2020 2020 2020 207c 382e 3020 2020  .        |8.0   
-00013670: 2020 2020 7c0a 2020 2020 2020 2020 7c38      |.        |8
-00013680: 312e 3020 2020 2020 207c 0a20 2020 2020  1.0      |.     
-00013690: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000136a0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-000136b0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
-000136c0: 6e75 6d62 6572 203d 2028 0a20 2020 2020  number = (.     
-000136d0: 2020 206c 6974 286c 6566 7429 2069 6620     lit(left) if 
-000136e0: 6973 696e 7374 616e 6365 286c 6566 742c  isinstance(left,
-000136f0: 2028 696e 742c 2066 6c6f 6174 2929 2065   (int, float)) e
-00013700: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
-00013710: 7472 286c 6566 742c 2022 706f 7722 290a  tr(left, "pow").
-00013720: 2020 2020 290a 2020 2020 706f 7765 7220      ).    power 
-00013730: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
-00013740: 7269 6768 7429 2069 6620 6973 696e 7374  right) if isinst
-00013750: 616e 6365 2872 6967 6874 2c20 2869 6e74  ance(right, (int
-00013760: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
-00013770: 746f 5f63 6f6c 5f69 665f 7374 7228 7269  to_col_if_str(ri
-00013780: 6768 742c 2022 706f 7722 290a 2020 2020  ght, "pow").    
-00013790: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-000137a0: 6c74 696e 2822 706f 7722 2928 6e75 6d62  ltin("pow")(numb
-000137b0: 6572 2c20 706f 7765 7229 0a0a 0a64 6566  er, power)...def
-000137c0: 2072 6f75 6e64 2865 3a20 436f 6c75 6d6e   round(e: Column
-000137d0: 4f72 4e61 6d65 2c20 7363 616c 653a 2055  OrName, scale: U
-000137e0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-000137f0: 652c 2069 6e74 2c20 666c 6f61 745d 203d  e, int, float] =
-00013800: 2030 2920 2d3e 2043 6f6c 756d 6e3a 0a20   0) -> Column:. 
-00013810: 2020 2022 2222 5265 7475 726e 7320 726f     """Returns ro
-00013820: 756e 6465 6420 7661 6c75 6573 2066 726f  unded values fro
-00013830: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
-00013840: 636f 6c75 6d6e 2e0a 0a20 2020 2045 7861  column...    Exa
-00013850: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00013860: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00013870: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00013880: 6528 5b5b 312e 3131 5d2c 205b 322e 3232  e([[1.11], [2.22
-00013890: 5d2c 205b 332e 3333 5d5d 2c20 7363 6865  ], [3.33]], sche
-000138a0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-000138b0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000138c0: 726f 756e 6428 636f 6c28 2261 2229 292e  round(col("a")).
-000138d0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-000138e0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-000138f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00013900: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-00013910: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00013920: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00013930: 312e 3020 2020 2020 2020 7c0a 2020 2020  1.0       |.    
-00013940: 2020 2020 7c32 2e30 2020 2020 2020 207c      |2.0       |
-00013950: 0a20 2020 2020 2020 207c 332e 3020 2020  .        |3.0   
-00013960: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-00013970: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00013980: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-00013990: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-000139a0: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-000139b0: 2022 726f 756e 6422 290a 2020 2020 7363   "round").    sc
-000139c0: 616c 655f 636f 6c20 3d20 280a 2020 2020  ale_col = (.    
-000139d0: 2020 2020 6c69 7428 7363 616c 6529 0a20      lit(scale). 
-000139e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000139f0: 616e 6365 2873 6361 6c65 2c20 2869 6e74  ance(scale, (int
-00013a00: 2c20 666c 6f61 7429 290a 2020 2020 2020  , float)).      
-00013a10: 2020 656c 7365 205f 746f 5f63 6f6c 5f69    else _to_col_i
-00013a20: 665f 7374 7228 7363 616c 652c 2022 726f  f_str(scale, "ro
-00013a30: 756e 6422 290a 2020 2020 290a 2020 2020  und").    ).    
-00013a40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00013a50: 726f 756e 6422 2928 632c 2073 6361 6c65  round")(c, scale
-00013a60: 5f63 6f6c 290a 0a0a 6465 6620 7370 6c69  _col)...def spli
-00013a70: 7428 0a20 2020 2073 7472 3a20 436f 6c75  t(.    str: Colu
-00013a80: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7061  mnOrName,.    pa
-00013a90: 7474 6572 6e3a 2043 6f6c 756d 6e4f 724e  ttern: ColumnOrN
-00013aa0: 616d 652c 0a29 202d 3e20 436f 6c75 6d6e  ame,.) -> Column
-00013ab0: 3a0a 2020 2020 2222 2253 706c 6974 7320  :.    """Splits 
-00013ac0: 6120 6769 7665 6e20 7374 7269 6e67 2077  a given string w
-00013ad0: 6974 6820 6120 6769 7665 6e20 7365 7061  ith a given sepa
-00013ae0: 7261 746f 7220 616e 6420 7265 7475 726e  rator and return
-00013af0: 7320 7468 6520 7265 7375 6c74 2069 6e20  s the result in 
-00013b00: 616e 2061 7272 6179 0a20 2020 206f 6620  an array.    of 
-00013b10: 7374 7269 6e67 732e 2054 6f20 7370 6563  strings. To spec
-00013b20: 6966 7920 6120 7374 7269 6e67 2073 6570  ify a string sep
-00013b30: 6172 6174 6f72 2c20 7573 6520 7468 6520  arator, use the 
-00013b40: 3a66 756e 633a 606c 6974 2829 6020 6675  :func:`lit()` fu
-00013b50: 6e63 7469 6f6e 2e0a 0a20 2020 2045 7861  nction...    Exa
-00013b60: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00013b70: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00013b80: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00013b90: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00013ba0: 2020 5b5b 226d 616e 792d 6d61 6e79 2d77    [["many-many-w
-00013bb0: 6f72 6473 222c 2022 2d22 5d2c 205b 2268  ords", "-"], ["h
-00013bc0: 656c 6c6f 2d2d 6865 6c6c 6f22 2c20 222d  ello--hello", "-
-00013bd0: 2d22 5d5d 2c0a 2020 2020 2020 2020 2e2e  -"]],.        ..
-00013be0: 2e20 2020 2020 7363 6865 6d61 3d5b 2256  .     schema=["V
-00013bf0: 222c 2022 4422 5d2c 0a20 2020 2020 2020  ", "D"],.       
-00013c00: 202e 2e2e 2029 2e73 656c 6563 7428 7370   ... ).select(sp
-00013c10: 6c69 7428 636f 6c28 2256 2229 2c20 636f  lit(col("V"), co
-00013c20: 6c28 2244 2229 2929 0a20 2020 2020 2020  l("D"))).       
-00013c30: 203e 3e3e 2064 662e 7368 6f77 2829 0a20   >>> df.show(). 
-00013c40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00013c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013c60: 0a20 2020 2020 2020 207c 2253 504c 4954  .        |"SPLIT
-00013c70: 2822 2256 2222 2c20 2222 4422 2229 2220  (""V"", ""D"")" 
-00013c80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00013c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013ca0: 2d2d 2d2d 0a20 2020 2020 2020 207c 5b20  ----.        |[ 
-00013cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013cc0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00013cd0: 2020 226d 616e 7922 2c20 2020 2020 2020    "many",       
-00013ce0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00013cf0: 207c 2020 226d 616e 7922 2c20 2020 2020   |  "many",     
-00013d00: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00013d10: 2020 207c 2020 2277 6f72 6473 2220 2020     |  "words"   
-00013d20: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-00013d30: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
-00013d40: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-00013d50: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
-00013d60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00013d70: 0a20 2020 2020 2020 207c 2020 2268 656c  .        |  "hel
-00013d80: 6c6f 222c 2020 2020 2020 2020 2020 2020  lo",            
-00013d90: 207c 0a20 2020 2020 2020 207c 2020 2268   |.        |  "h
-00013da0: 656c 6c6f 2220 2020 2020 2020 2020 2020  ello"           
-00013db0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dd0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00013de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013df0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00013e00: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00013e10: 2022 2222 0a20 2020 2073 203d 205f 746f   """.    s = _to
-00013e20: 5f63 6f6c 5f69 665f 7374 7228 7374 722c  _col_if_str(str,
-00013e30: 2022 7370 6c69 7422 290a 2020 2020 7020   "split").    p 
-00013e40: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00013e50: 2870 6174 7465 726e 2c20 2273 706c 6974  (pattern, "split
-00013e60: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00013e70: 696c 7469 6e28 2273 706c 6974 2229 2873  iltin("split")(s
-00013e80: 2c20 7029 0a0a 0a64 6566 2073 7562 7374  , p)...def subst
-00013e90: 7269 6e67 280a 2020 2020 7374 723a 2043  ring(.    str: C
-00013ea0: 6f6c 756d 6e4f 724e 616d 652c 2070 6f73  olumnOrName, pos
-00013eb0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
-00013ec0: 696e 745d 2c20 6c65 6e3a 2055 6e69 6f6e  int], len: Union
-00013ed0: 5b43 6f6c 756d 6e2c 2069 6e74 5d0a 2920  [Column, int].) 
-00013ee0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00013ef0: 2222 5265 7475 726e 7320 7468 6520 706f  ""Returns the po
-00013f00: 7274 696f 6e20 6f66 2074 6865 2073 7472  rtion of the str
-00013f10: 696e 6720 6f72 2062 696e 6172 7920 7661  ing or binary va
-00013f20: 6c75 6520 7374 722c 2073 7461 7274 696e  lue str, startin
-00013f30: 6720 6672 6f6d 2074 6865 0a20 2020 2063  g from the.    c
-00013f40: 6861 7261 6374 6572 2f62 7974 6520 7370  haracter/byte sp
-00013f50: 6563 6966 6965 6420 6279 2070 6f73 2c20  ecified by pos, 
-00013f60: 7769 7468 206c 696d 6974 6564 206c 656e  with limited len
-00013f70: 6774 682e 2054 6865 206c 656e 6774 6820  gth. The length 
-00013f80: 7368 6f75 6c64 2062 6520 6772 6561 7465  should be greate
-00013f90: 720a 2020 2020 7468 616e 206f 7220 6571  r.    than or eq
-00013fa0: 7561 6c20 746f 207a 6572 6f2e 2049 6620  ual to zero. If 
-00013fb0: 7468 6520 6c65 6e67 7468 2069 7320 6120  the length is a 
-00013fc0: 6e65 6761 7469 7665 206e 756d 6265 722c  negative number,
-00013fd0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-00013fe0: 7475 726e 7320 616e 0a20 2020 2065 6d70  turns an.    emp
-00013ff0: 7479 2073 7472 696e 672e 0a0a 2020 2020  ty string...    
-00014000: 4e6f 7465 3a0a 2020 2020 2020 2020 466f  Note:.        Fo
-00014010: 7220 6060 706f 7360 602c 2031 2069 7320  r ``pos``, 1 is 
-00014020: 7468 6520 6669 7273 7420 6368 6172 6163  the first charac
-00014030: 7465 7220 6f66 2074 6865 2073 7472 696e  ter of the strin
-00014040: 6720 696e 2053 6e6f 7766 6c61 6b65 2064  g in Snowflake d
-00014050: 6174 6162 6173 652e 0a0a 2020 2020 3a66  atabase...    :f
-00014060: 756e 633a 6073 7562 7374 7260 2069 7320  unc:`substr` is 
-00014070: 616e 2061 6c69 6173 206f 6620 3a66 756e  an alias of :fun
-00014080: 633a 6073 7562 7374 7269 6e67 602e 0a0a  c:`substring`...
-00014090: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-000140a0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000140b0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000140c0: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
-000140d0: 202e 2e2e 2020 2020 205b 2261 6263 222c   ...     ["abc",
-000140e0: 2022 6465 6622 5d2c 0a20 2020 2020 2020   "def"],.       
-000140f0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00014100: 5b22 5322 5d2c 0a20 2020 2020 2020 202e  ["S"],.        .
-00014110: 2e2e 2029 2e73 656c 6563 7428 7375 6273  .. ).select(subs
-00014120: 7472 696e 6728 636f 6c28 2253 2229 2c20  tring(col("S"), 
-00014130: 312c 2031 2929 0a20 2020 2020 2020 203e  1, 1)).        >
-00014140: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
-00014150: 2020 2020 2020 2020 5b52 6f77 2853 5542          [Row(SUB
-00014160: 5354 5249 4e47 2822 5322 2c20 312c 2031  STRING("S", 1, 1
-00014170: 293d 2761 2729 2c20 526f 7728 5355 4253  )='a'), Row(SUBS
-00014180: 5452 494e 4728 2253 222c 2031 2c20 3129  TRING("S", 1, 1)
-00014190: 3d27 6427 295d 0a20 2020 2022 2222 0a20  ='d')].    """. 
-000141a0: 2020 2073 203d 205f 746f 5f63 6f6c 5f69     s = _to_col_i
-000141b0: 665f 7374 7228 7374 722c 2022 7375 6273  f_str(str, "subs
-000141c0: 7472 696e 6722 290a 2020 2020 7020 3d20  tring").    p = 
-000141d0: 706f 7320 6966 2069 7369 6e73 7461 6e63  pos if isinstanc
-000141e0: 6528 706f 732c 2043 6f6c 756d 6e29 2065  e(pos, Column) e
-000141f0: 6c73 6520 6c69 7428 706f 7329 0a20 2020  lse lit(pos).   
-00014200: 206c 656e 6774 6820 3d20 6c65 6e20 6966   length = len if
-00014210: 2069 7369 6e73 7461 6e63 6528 6c65 6e2c   isinstance(len,
-00014220: 2043 6f6c 756d 6e29 2065 6c73 6520 6c69   Column) else li
-00014230: 7428 6c65 6e29 0a20 2020 2072 6574 7572  t(len).    retur
-00014240: 6e20 6275 696c 7469 6e28 2273 7562 7374  n builtin("subst
-00014250: 7269 6e67 2229 2873 2c20 702c 206c 656e  ring")(s, p, len
-00014260: 6774 6829 0a0a 0a64 6566 2073 7562 7374  gth)...def subst
-00014270: 7269 6e67 5f69 6e64 6578 280a 2020 2020  ring_index(.    
-00014280: 7465 7874 3a20 436f 6c75 6d6e 4f72 4e61  text: ColumnOrNa
-00014290: 6d65 2c20 6465 6c69 6d3a 2043 6f6c 756d  me, delim: Colum
-000142a0: 6e4f 724c 6974 6572 616c 5374 722c 2063  nOrLiteralStr, c
-000142b0: 6f75 6e74 3a20 696e 740a 2920 2d3e 2043  ount: int.) -> C
-000142c0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-000142d0: 2020 2052 6574 7572 6e73 2074 6865 2073     Returns the s
-000142e0: 7562 7374 7269 6e67 2066 726f 6d20 7374  ubstring from st
-000142f0: 7269 6e67 2060 6074 6578 7460 6020 6265  ring ``text`` be
-00014300: 666f 7265 2060 6063 6f75 6e74 6060 206f  fore ``count`` o
-00014310: 6363 7572 7265 6e63 6573 206f 6620 7468  ccurrences of th
-00014320: 6520 6465 6c69 6d69 7465 7220 6060 6465  e delimiter ``de
-00014330: 6c69 6d60 602e 0a20 2020 2049 6620 6060  lim``..    If ``
-00014340: 636f 756e 7460 6020 6973 2070 6f73 6974  count`` is posit
-00014350: 6976 652c 2065 7665 7279 7468 696e 6720  ive, everything 
-00014360: 746f 2074 6865 206c 6566 7420 6f66 2074  to the left of t
-00014370: 6865 2066 696e 616c 2064 656c 696d 6974  he final delimit
-00014380: 6572 2028 636f 756e 7469 6e67 2066 726f  er (counting fro
-00014390: 6d20 6c65 6674 2920 6973 0a20 2020 2072  m left) is.    r
-000143a0: 6574 7572 6e65 642e 2049 6620 6060 636f  eturned. If ``co
-000143b0: 756e 7460 6020 6973 206e 6567 6174 6976  unt`` is negativ
-000143c0: 652c 2065 7665 7279 7468 696e 6720 746f  e, everything to
-000143d0: 2074 6865 2072 6967 6874 206f 6620 7468   the right of th
-000143e0: 6520 6669 6e61 6c20 6465 6c69 6d69 7465  e final delimite
-000143f0: 7220 2863 6f75 6e74 696e 6720 6672 6f6d  r (counting from
-00014400: 2074 6865 0a20 2020 2072 6967 6874 2920   the.    right) 
-00014410: 6973 2072 6574 7572 6e65 642e 2049 6620  is returned. If 
-00014420: 6060 636f 756e 7460 6020 6973 207a 6572  ``count`` is zer
-00014430: 6f2c 2072 6574 7572 6e73 2065 6d70 7479  o, returns empty
-00014440: 2073 7472 696e 672e 0a0a 2020 2020 4578   string...    Ex
-00014450: 616d 706c 6520 313a 3a0a 2020 2020 2020  ample 1::.      
-00014460: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00014470: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00014480: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-00014490: 2020 2020 205b 2261 2e62 2e63 2e64 225d       ["a.b.c.d"]
-000144a0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-000144b0: 2020 7363 6865 6d61 3d5b 2253 225d 2c0a    schema=["S"],.
-000144c0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
-000144d0: 6c65 6374 2873 7562 7374 7269 6e67 5f69  lect(substring_i
-000144e0: 6e64 6578 2863 6f6c 2822 5322 292c 2022  ndex(col("S"), "
-000144f0: 2e22 2c20 3229 2e61 6c69 6173 2822 7265  .", 2).alias("re
-00014500: 7375 6c74 2229 290a 2020 2020 2020 2020  sult")).        
-00014510: 3e3e 3e20 6466 2e73 686f 7728 290a 2020  >>> df.show().  
-00014520: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00014530: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-00014540: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-00014550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00014560: 2020 2020 207c 612e 6220 2020 2020 2020       |a.b       
-00014570: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00014580: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00014590: 424c 414e 4b4c 494e 453e 0a0a 2020 2020  BLANKLINE>..    
-000145a0: 4578 616d 706c 6520 323a 3a0a 2020 2020  Example 2::.    
-000145b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-000145c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000145d0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
-000145e0: 2e2e 2020 2020 205b 5b22 612e 622e 632e  ..     [["a.b.c.
-000145f0: 6422 2c20 222e 225d 5d2c 0a20 2020 2020  d", "."]],.     
-00014600: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-00014610: 613d 5b22 5322 2c20 2264 656c 696d 6974  a=["S", "delimit
-00014620: 6572 225d 2c0a 2020 2020 2020 2020 2e2e  er"],.        ..
-00014630: 2e20 292e 7365 6c65 6374 2873 7562 7374  . ).select(subst
-00014640: 7269 6e67 5f69 6e64 6578 2863 6f6c 2822  ring_index(col("
-00014650: 5322 292c 2063 6f6c 2822 6465 6c69 6d69  S"), col("delimi
-00014660: 7465 7222 292c 2032 292e 616c 6961 7328  ter"), 2).alias(
-00014670: 2272 6573 756c 7422 2929 0a20 2020 2020  "result")).     
-00014680: 2020 203e 3e3e 2064 662e 7368 6f77 2829     >>> df.show()
-00014690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000146a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-000146b0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
-000146c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000146d0: 2020 2020 2020 2020 7c61 2e62 2020 2020          |a.b    
-000146e0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-000146f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00014700: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00014710: 2020 2222 220a 2020 2020 7320 3d20 5f74    """.    s = _t
-00014720: 6f5f 636f 6c5f 6966 5f73 7472 2874 6578  o_col_if_str(tex
-00014730: 742c 2022 7375 6273 7472 696e 675f 696e  t, "substring_in
-00014740: 6465 7822 290a 2020 2020 7374 7274 6f6b  dex").    strtok
-00014750: 5f61 7272 6179 203d 2062 7569 6c74 696e  _array = builtin
-00014760: 2822 7374 7274 6f6b 5f74 6f5f 6172 7261  ("strtok_to_arra
-00014770: 7922 2928 732c 2064 656c 696d 290a 2020  y")(s, delim).  
-00014780: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00014790: 2822 6172 7261 795f 746f 5f73 7472 696e  ("array_to_strin
-000147a0: 6722 2928 0a20 2020 2020 2020 2062 7569  g")(.        bui
-000147b0: 6c74 696e 2822 6172 7261 795f 736c 6963  ltin("array_slic
-000147c0: 6522 2928 0a20 2020 2020 2020 2020 2020  e")(.           
-000147d0: 2073 7472 746f 6b5f 6172 7261 792c 0a20   strtok_array,. 
-000147e0: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
-000147f0: 636f 756e 7420 3e3d 2030 2065 6c73 6520  count >= 0 else 
-00014800: 6275 696c 7469 6e28 2261 7272 6179 5f73  builtin("array_s
-00014810: 697a 6522 2928 7374 7274 6f6b 5f61 7272  ize")(strtok_arr
-00014820: 6179 2920 2b20 636f 756e 742c 0a20 2020  ay) + count,.   
-00014830: 2020 2020 2020 2020 2063 6f75 6e74 2069           count i
-00014840: 6620 636f 756e 7420 3e3d 2030 2065 6c73  f count >= 0 els
-00014850: 6520 6275 696c 7469 6e28 2261 7272 6179  e builtin("array
-00014860: 5f73 697a 6522 2928 7374 7274 6f6b 5f61  _size")(strtok_a
-00014870: 7272 6179 292c 0a20 2020 2020 2020 2029  rray),.        )
-00014880: 2c0a 2020 2020 2020 2020 6465 6c69 6d2c  ,.        delim,
-00014890: 0a20 2020 2029 0a0a 0a64 6566 2072 6567  .    )...def reg
-000148a0: 6578 705f 636f 756e 7428 0a20 2020 2073  exp_count(.    s
-000148b0: 7562 6a65 6374 3a20 436f 6c75 6d6e 4f72  ubject: ColumnOr
-000148c0: 4e61 6d65 2c0a 2020 2020 7061 7474 6572  Name,.    patter
-000148d0: 6e3a 2043 6f6c 756d 6e4f 724c 6974 6572  n: ColumnOrLiter
-000148e0: 616c 5374 722c 0a20 2020 2070 6f73 6974  alStr,.    posit
-000148f0: 696f 6e3a 2055 6e69 6f6e 5b43 6f6c 756d  ion: Union[Colum
-00014900: 6e2c 2069 6e74 5d20 3d20 312c 0a20 2020  n, int] = 1,.   
-00014910: 202a 7061 7261 6d65 7465 7273 3a20 436f   *parameters: Co
-00014920: 6c75 6d6e 4f72 4c69 7465 7261 6c2c 0a29  lumnOrLiteral,.)
-00014930: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00014940: 2222 2252 6574 7572 6e73 2074 6865 206e  """Returns the n
-00014950: 756d 6265 7220 6f66 2074 696d 6573 2074  umber of times t
-00014960: 6861 7420 6120 7061 7474 6572 6e20 6f63  hat a pattern oc
-00014970: 6375 7273 2069 6e20 7468 6520 7375 626a  curs in the subj
-00014980: 6563 742e 0a0a 2020 2020 4578 616d 706c  ect...    Exampl
-00014990: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-000149a0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
-000149b0: 6c28 2273 656c 6563 7420 2a20 6672 6f6d  l("select * from
-000149c0: 2076 616c 7565 7328 2761 7070 6c65 2729   values('apple')
-000149d0: 2c28 2762 616e 616e 6127 292c 2827 7065  ,('banana'),('pe
-000149e0: 6163 6827 2920 6173 2054 2861 2922 290a  ach') as T(a)").
-000149f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00014a00: 656c 6563 7428 7265 6765 7870 5f63 6f75  elect(regexp_cou
-00014a10: 6e74 2863 6f6c 2822 6122 292c 2022 6122  nt(col("a"), "a"
-00014a20: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00014a30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00014a40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00014a50: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00014a60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00014a70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00014a80: 207c 3120 2020 2020 2020 2020 7c0a 2020   |1         |.  
-00014a90: 2020 2020 2020 7c33 2020 2020 2020 2020        |3        
-00014aa0: 207c 0a20 2020 2020 2020 207c 3120 2020   |.        |1   
-00014ab0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00014ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00014ad0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00014ae0: 0a20 2020 2022 2222 0a20 2020 2073 716c  .    """.    sql
-00014af0: 5f66 756e 635f 6e61 6d65 203d 2022 7265  _func_name = "re
-00014b00: 6765 7870 5f63 6f75 6e74 220a 2020 2020  gexp_count".    
-00014b10: 7375 6220 3d20 5f74 6f5f 636f 6c5f 6966  sub = _to_col_if
-00014b20: 5f73 7472 2873 7562 6a65 6374 2c20 7371  _str(subject, sq
-00014b30: 6c5f 6675 6e63 5f6e 616d 6529 0a20 2020  l_func_name).   
-00014b40: 2070 6174 203d 206c 6974 2870 6174 7465   pat = lit(patte
-00014b50: 726e 290a 2020 2020 706f 7320 3d20 6c69  rn).    pos = li
-00014b60: 7428 706f 7369 7469 6f6e 290a 0a20 2020  t(position)..   
-00014b70: 2070 6172 616d 7320 3d20 5b6c 6974 2870   params = [lit(p
-00014b80: 2920 666f 7220 7020 696e 2070 6172 616d  ) for p in param
-00014b90: 6574 6572 735d 0a20 2020 2072 6574 7572  eters].    retur
-00014ba0: 6e20 6275 696c 7469 6e28 7371 6c5f 6675  n builtin(sql_fu
-00014bb0: 6e63 5f6e 616d 6529 2873 7562 2c20 7061  nc_name)(sub, pa
-00014bc0: 742c 2070 6f73 2c20 2a70 6172 616d 7329  t, pos, *params)
-00014bd0: 0a0a 0a64 6566 2072 6567 6578 705f 6578  ...def regexp_ex
-00014be0: 7472 6163 7428 0a20 2020 2076 616c 7565  tract(.    value
-00014bf0: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
-00014c00: 6c53 7472 2c20 7265 6765 7870 3a20 436f  lStr, regexp: Co
-00014c10: 6c75 6d6e 4f72 4c69 7465 7261 6c53 7472  lumnOrLiteralStr
-00014c20: 2c20 6964 783a 2069 6e74 0a29 202d 3e20  , idx: int.) -> 
-00014c30: 436f 6c75 6d6e 3a0a 2020 2020 7222 2222  Column:.    r"""
-00014c40: 0a20 2020 2045 7874 7261 6374 2061 2073  .    Extract a s
-00014c50: 7065 6369 6669 6320 6772 6f75 7020 6d61  pecific group ma
-00014c60: 7463 6865 6420 6279 2061 2072 6567 6578  tched by a regex
-00014c70: 2c20 6672 6f6d 2074 6865 2073 7065 6369  , from the speci
-00014c80: 6669 6564 2073 7472 696e 6720 636f 6c75  fied string colu
-00014c90: 6d6e 2e0a 2020 2020 4966 2074 6865 2072  mn..    If the r
-00014ca0: 6567 6578 2064 6964 206e 6f74 206d 6174  egex did not mat
-00014cb0: 6368 2c20 6f72 2074 6865 2073 7065 6369  ch, or the speci
-00014cc0: 6669 6564 2067 726f 7570 2064 6964 206e  fied group did n
-00014cd0: 6f74 206d 6174 6368 2c0a 2020 2020 616e  ot match,.    an
-00014ce0: 2065 6d70 7479 2073 7472 696e 6720 6973   empty string is
-00014cf0: 2072 6574 7572 6e65 642e 0a0a 2020 2020   returned...    
-00014d00: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00014d10: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00014d20: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-00014d30: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-00014d40: 7265 6765 7870 5f65 7874 7261 6374 0a20  regexp_extract. 
-00014d50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00014d60: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
-00014d70: 7461 4672 616d 6528 5b5b 2269 645f 3230  taFrame([["id_20
-00014d80: 5f33 3022 2c20 3130 5d2c 205b 2269 645f  _30", 10], ["id_
-00014d90: 3430 5f35 3022 2c20 3330 5d5d 2c20 5b22  40_50", 30]], ["
-00014da0: 6964 222c 2022 6167 6522 5d29 0a20 2020  id", "age"]).   
-00014db0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00014dc0: 6374 2872 6567 6578 705f 6578 7472 6163  ct(regexp_extrac
-00014dd0: 7428 2269 6422 2c20 7222 285c 642b 2922  t("id", r"(\d+)"
-00014de0: 2c20 3129 2e61 6c69 6173 2822 5245 5322  , 1).alias("RES"
-00014df0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00014e00: 2020 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020    ---------.    
-00014e10: 2020 2020 7c22 5245 5322 2020 7c0a 2020      |"RES"  |.  
-00014e20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
-00014e30: 2020 2020 2020 2020 7c32 3020 2020 2020          |20     
-00014e40: 7c0a 2020 2020 2020 2020 7c34 3020 2020  |.        |40   
-00014e50: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00014e60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-00014e70: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-00014e80: 220a 2020 2020 7661 6c75 6520 3d20 5f74  ".    value = _t
-00014e90: 6f5f 636f 6c5f 6966 5f73 7472 2876 616c  o_col_if_str(val
-00014ea0: 7565 2c20 2272 6567 6578 705f 6578 7472  ue, "regexp_extr
-00014eb0: 6163 7422 290a 2020 2020 7265 6765 7870  act").    regexp
-00014ec0: 203d 205f 746f 5f63 6f6c 5f69 665f 6c69   = _to_col_if_li
-00014ed0: 7428 7265 6765 7870 2c20 2272 6567 6578  t(regexp, "regex
-00014ee0: 705f 6578 7472 6163 7422 290a 2020 2020  p_extract").    
-00014ef0: 6964 7820 3d20 5f74 6f5f 636f 6c5f 6966  idx = _to_col_if
-00014f00: 5f6c 6974 2869 6478 2c20 2272 6567 6578  _lit(idx, "regex
-00014f10: 705f 6578 7472 6163 7422 290a 2020 2020  p_extract").    
-00014f20: 7265 7475 726e 2063 6f61 6c65 7363 6528  return coalesce(
-00014f30: 0a20 2020 2020 2020 2063 616c 6c5f 6275  .        call_bu
-00014f40: 696c 7469 6e28 2272 6567 6578 705f 7375  iltin("regexp_su
-00014f50: 6273 7472 222c 2076 616c 7565 2c20 7265  bstr", value, re
-00014f60: 6765 7870 2c20 6c69 7428 3129 2c20 6c69  gexp, lit(1), li
-00014f70: 7428 3129 2c20 6c69 7428 2265 2229 2c20  t(1), lit("e"), 
-00014f80: 6964 7829 2c0a 2020 2020 2020 2020 6c69  idx),.        li
-00014f90: 7428 2222 292c 0a20 2020 2029 0a0a 0a64  t(""),.    )...d
-00014fa0: 6566 2072 6567 6578 705f 7265 706c 6163  ef regexp_replac
-00014fb0: 6528 0a20 2020 2073 7562 6a65 6374 3a20  e(.    subject: 
-00014fc0: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
-00014fd0: 2020 7061 7474 6572 6e3a 2043 6f6c 756d    pattern: Colum
-00014fe0: 6e4f 724c 6974 6572 616c 5374 722c 0a20  nOrLiteralStr,. 
-00014ff0: 2020 2072 6570 6c61 6365 6d65 6e74 3a20     replacement: 
-00015000: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
-00015010: 7472 203d 2022 222c 0a20 2020 2070 6f73  tr = "",.    pos
-00015020: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
-00015030: 756d 6e2c 2069 6e74 5d20 3d20 312c 0a20  umn, int] = 1,. 
-00015040: 2020 206f 6363 7572 7265 6e63 6573 3a20     occurrences: 
-00015050: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
-00015060: 745d 203d 2030 2c0a 2020 2020 2a70 6172  t] = 0,.    *par
-00015070: 616d 6574 6572 733a 2043 6f6c 756d 6e4f  ameters: ColumnO
-00015080: 724c 6974 6572 616c 2c0a 2920 2d3e 2043  rLiteral,.) -> C
-00015090: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-000150a0: 7475 726e 7320 7468 6520 7375 626a 6563  turns the subjec
-000150b0: 7420 7769 7468 2074 6865 2073 7065 6369  t with the speci
-000150c0: 6669 6564 2070 6174 7465 726e 2028 6f72  fied pattern (or
-000150d0: 2061 6c6c 206f 6363 7572 7265 6e63 6573   all occurrences
-000150e0: 206f 6620 7468 6520 7061 7474 6572 6e29   of the pattern)
-000150f0: 2065 6974 6865 7220 7265 6d6f 7665 6420   either removed 
-00015100: 6f72 2072 6570 6c61 6365 6420 6279 2061  or replaced by a
-00015110: 2072 6570 6c61 6365 6d65 6e74 2073 7472   replacement str
-00015120: 696e 672e 0a20 2020 2049 6620 6e6f 206d  ing..    If no m
-00015130: 6174 6368 6573 2061 7265 2066 6f75 6e64  atches are found
-00015140: 2c20 7265 7475 726e 7320 7468 6520 6f72  , returns the or
-00015150: 6967 696e 616c 2073 7562 6a65 6374 2e0a  iginal subject..
-00015160: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00015170: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00015180: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00015190: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-000151a0: 2020 2e2e 2e20 2020 2020 5b5b 2249 7420    ...     [["It 
-000151b0: 7761 7320 7468 6520 6265 7374 206f 6620  was the best of 
-000151c0: 7469 6d65 732c 2069 7420 7761 7320 7468  times, it was th
-000151d0: 6520 776f 7273 7420 6f66 2074 696d 6573  e worst of times
-000151e0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
-000151f0: 5d0a 2020 2020 2020 2020 2e2e 2e20 290a  ].        ... ).
-00015200: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00015210: 656c 6563 7428 7265 6765 7870 5f72 6570  elect(regexp_rep
-00015220: 6c61 6365 2863 6f6c 2822 6122 292c 206c  lace(col("a"), l
-00015230: 6974 2822 2820 297b 312c 7d22 292c 206c  it("( ){1,}"), l
-00015240: 6974 2822 2229 292e 616c 6961 7328 2272  it("")).alias("r
-00015250: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00015260: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00015270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015290: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-000152a0: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
-000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152c0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000152d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-000152e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000152f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00015300: 2020 2020 2020 207c 4974 7761 7374 6865         |Itwasthe
-00015310: 6265 7374 6f66 7469 6d65 732c 6974 7761  bestoftimes,itwa
-00015320: 7374 6865 776f 7273 746f 6674 696d 6573  stheworstoftimes
-00015330: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00015340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015360: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015370: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00015380: 2022 2222 0a20 2020 2073 716c 5f66 756e   """.    sql_fun
-00015390: 635f 6e61 6d65 203d 2022 7265 6765 7870  c_name = "regexp
-000153a0: 5f72 6570 6c61 6365 220a 2020 2020 7375  _replace".    su
-000153b0: 6220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  b = _to_col_if_s
-000153c0: 7472 2873 7562 6a65 6374 2c20 7371 6c5f  tr(subject, sql_
-000153d0: 6675 6e63 5f6e 616d 6529 0a20 2020 2070  func_name).    p
-000153e0: 6174 203d 206c 6974 2870 6174 7465 726e  at = lit(pattern
-000153f0: 290a 2020 2020 7265 7020 3d20 6c69 7428  ).    rep = lit(
-00015400: 7265 706c 6163 656d 656e 7429 0a20 2020  replacement).   
-00015410: 2070 6f73 203d 206c 6974 2870 6f73 6974   pos = lit(posit
-00015420: 696f 6e29 0a20 2020 206f 6363 203d 206c  ion).    occ = l
-00015430: 6974 286f 6363 7572 7265 6e63 6573 290a  it(occurrences).
-00015440: 0a20 2020 2070 6172 616d 7320 3d20 5b6c  .    params = [l
-00015450: 6974 2870 2920 666f 7220 7020 696e 2070  it(p) for p in p
-00015460: 6172 616d 6574 6572 735d 0a20 2020 2072  arameters].    r
-00015470: 6574 7572 6e20 6275 696c 7469 6e28 7371  eturn builtin(sq
-00015480: 6c5f 6675 6e63 5f6e 616d 6529 2873 7562  l_func_name)(sub
-00015490: 2c20 7061 742c 2072 6570 2c20 706f 732c  , pat, rep, pos,
-000154a0: 206f 6363 2c20 2a70 6172 616d 7329 0a0a   occ, *params)..
-000154b0: 0a64 6566 2072 6570 6c61 6365 280a 2020  .def replace(.  
-000154c0: 2020 7375 626a 6563 743a 2043 6f6c 756d    subject: Colum
-000154d0: 6e4f 724e 616d 652c 0a20 2020 2070 6174  nOrName,.    pat
-000154e0: 7465 726e 3a20 436f 6c75 6d6e 4f72 4c69  tern: ColumnOrLi
-000154f0: 7465 7261 6c53 7472 2c0a 2020 2020 7265  teralStr,.    re
-00015500: 706c 6163 656d 656e 743a 2043 6f6c 756d  placement: Colum
-00015510: 6e4f 724c 6974 6572 616c 5374 7220 3d20  nOrLiteralStr = 
-00015520: 2222 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  "",.) -> Column:
-00015530: 0a20 2020 2022 2222 0a20 2020 2052 656d  .    """.    Rem
-00015540: 6f76 6573 2061 6c6c 206f 6363 7572 7265  oves all occurre
-00015550: 6e63 6573 206f 6620 6120 7370 6563 6966  nces of a specif
-00015560: 6965 6420 7375 626a 6563 7420 616e 6420  ied subject and 
-00015570: 6f70 7469 6f6e 616c 6c79 2072 6570 6c61  optionally repla
-00015580: 6365 7320 7468 656d 2077 6974 6820 7265  ces them with re
-00015590: 706c 6163 656d 656e 742e 0a0a 2020 2020  placement...    
-000155a0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000155b0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000155c0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000155d0: 7261 6d65 285b 5b22 6170 706c 6522 5d2c  rame([["apple"],
-000155e0: 205b 2261 7070 6c65 2070 6965 225d 2c20   ["apple pie"], 
-000155f0: 5b22 6170 706c 6520 6a75 6963 6522 5d5d  ["apple juice"]]
-00015600: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-00015610: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00015620: 656c 6563 7428 7265 706c 6163 6528 636f  elect(replace(co
-00015630: 6c28 2261 2229 2c20 2261 7070 6c65 222c  l("a"), "apple",
-00015640: 2022 6f72 616e 6765 2229 2e61 6c69 6173   "orange").alias
-00015650: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-00015660: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00015670: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00015680: 2020 2020 7c22 5245 5355 4c54 2220 2020      |"RESULT"   
-00015690: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-000156a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000156b0: 2020 2020 2020 7c6f 7261 6e67 6520 2020        |orange   
-000156c0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-000156d0: 6f72 616e 6765 2070 6965 2020 2020 7c0a  orange pie    |.
-000156e0: 2020 2020 2020 2020 7c6f 7261 6e67 6520          |orange 
-000156f0: 6a75 6963 6520 207c 0a20 2020 2020 2020  juice  |.       
-00015700: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00015710: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00015720: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00015730: 2020 7371 6c5f 6675 6e63 5f6e 616d 6520    sql_func_name 
-00015740: 3d20 2272 6570 6c61 6365 220a 2020 2020  = "replace".    
-00015750: 7375 6220 3d20 5f74 6f5f 636f 6c5f 6966  sub = _to_col_if
-00015760: 5f73 7472 2873 7562 6a65 6374 2c20 7371  _str(subject, sq
-00015770: 6c5f 6675 6e63 5f6e 616d 6529 0a20 2020  l_func_name).   
-00015780: 2070 6174 203d 206c 6974 2870 6174 7465   pat = lit(patte
-00015790: 726e 290a 2020 2020 7265 7020 3d20 6c69  rn).    rep = li
-000157a0: 7428 7265 706c 6163 656d 656e 7429 0a20  t(replacement). 
-000157b0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-000157c0: 6e28 7371 6c5f 6675 6e63 5f6e 616d 6529  n(sql_func_name)
-000157d0: 2873 7562 2c20 7061 742c 2072 6570 290a  (sub, pat, rep).
-000157e0: 0a0a 6465 6620 6368 6172 696e 6465 7828  ..def charindex(
-000157f0: 0a20 2020 2074 6172 6765 745f 6578 7072  .    target_expr
-00015800: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
-00015810: 2020 2020 736f 7572 6365 5f65 7870 723a      source_expr:
-00015820: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
-00015830: 2020 2070 6f73 6974 696f 6e3a 204f 7074     position: Opt
-00015840: 696f 6e61 6c5b 556e 696f 6e5b 436f 6c75  ional[Union[Colu
-00015850: 6d6e 2c20 696e 745d 5d20 3d20 4e6f 6e65  mn, int]] = None
-00015860: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-00015870: 2020 2022 2222 5365 6172 6368 6573 2066     """Searches f
-00015880: 6f72 2060 6074 6172 6765 745f 6578 7072  or ``target_expr
-00015890: 6060 2069 6e20 6060 736f 7572 6365 5f65  `` in ``source_e
-000158a0: 7870 7260 6020 616e 642c 2069 6620 7375  xpr`` and, if su
-000158b0: 6363 6573 7366 756c 2c0a 2020 2020 7265  ccessful,.    re
-000158c0: 7475 726e 7320 7468 6520 706f 7369 7469  turns the positi
-000158d0: 6f6e 2028 312d 6261 7365 6429 206f 6620  on (1-based) of 
-000158e0: 7468 6520 6060 7461 7267 6574 5f65 7870  the ``target_exp
-000158f0: 7260 6020 696e 2060 6073 6f75 7263 655f  r`` in ``source_
-00015900: 6578 7072 6060 2e0a 0a20 2020 2041 7267  expr``...    Arg
-00015910: 733a 0a20 2020 2020 2020 2074 6172 6765  s:.        targe
-00015920: 745f 6578 7072 3a20 4120 7374 7269 6e67  t_expr: A string
-00015930: 206f 7220 6269 6e61 7279 2065 7870 7265   or binary expre
-00015940: 7373 696f 6e20 7265 7072 6573 656e 7469  ssion representi
-00015950: 6e67 2074 6865 2076 616c 7565 2074 6f20  ng the value to 
-00015960: 6c6f 6f6b 2066 6f72 2e0a 2020 2020 2020  look for..      
-00015970: 2020 736f 7572 6365 5f65 7870 723a 2041    source_expr: A
-00015980: 2073 7472 696e 6720 6f72 2062 696e 6172   string or binar
-00015990: 7920 6578 7072 6573 7369 6f6e 2072 6570  y expression rep
-000159a0: 7265 7365 6e74 696e 6720 7468 6520 7661  resenting the va
-000159b0: 6c75 6520 746f 2073 6561 7263 682e 0a20  lue to search.. 
-000159c0: 2020 2020 2020 2070 6f73 6974 696f 6e3a         position:
-000159d0: 2041 206e 756d 6265 7220 696e 6469 6361   A number indica
-000159e0: 7469 6f6e 2074 6865 2070 6f73 6974 696f  tion the positio
-000159f0: 6e20 2831 2d62 6173 6564 2920 6672 6f6d  n (1-based) from
-00015a00: 2077 6865 7265 2074 6f20 7374 6172 7420   where to start 
-00015a10: 7468 6520 7365 6172 6368 2e20 4465 6661  the search. Defa
-00015a20: 756c 7473 2074 6f20 4e6f 6e65 2e0a 0a20  ults to None... 
-00015a30: 2020 2045 7861 6d70 6c65 733a 3a0a 2020     Examples::.  
-00015a40: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00015a50: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00015a60: 7461 6672 616d 6528 5b22 6261 6e61 6e61  taframe(["banana
-00015a70: 225d 2c20 7363 6865 6d61 3d5b 2761 275d  "], schema=['a']
-00015a80: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00015a90: 2e73 656c 6563 7428 6368 6172 696e 6465  .select(charinde
-00015aa0: 7828 6c69 7428 2261 6e22 292c 2064 662e  x(lit("an"), df.
-00015ab0: 612c 2031 292e 6173 5f28 2272 6573 756c  a, 1).as_("resul
-00015ac0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00015ad0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00015ae0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00015af0: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-00015b00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00015b10: 2020 207c 3220 2020 2020 2020 2020 7c0a     |2         |.
-00015b20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00015b30: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00015b40: 414e 4b4c 494e 453e 0a0a 2020 2020 2020  ANKLINE>..      
-00015b50: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00015b60: 6368 6172 696e 6465 7828 6c69 7428 2261  charindex(lit("a
-00015b70: 6e22 292c 2064 662e 612c 2033 292e 6173  n"), df.a, 3).as
-00015b80: 5f28 2272 6573 756c 7422 2929 2e73 686f  _("result")).sho
-00015b90: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00015ba0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015bb0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
-00015bc0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00015bd0: 2d2d 0a20 2020 2020 2020 207c 3420 2020  --.        |4   
-00015be0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00015bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00015c00: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00015c10: 0a20 2020 2022 2222 0a20 2020 2074 203d  .    """.    t =
-00015c20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00015c30: 7461 7267 6574 5f65 7870 722c 2022 6368  target_expr, "ch
-00015c40: 6172 696e 6465 7822 290a 2020 2020 7320  arindex").    s 
-00015c50: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00015c60: 2873 6f75 7263 655f 6578 7072 2c20 2263  (source_expr, "c
-00015c70: 6861 7269 6e64 6578 2229 0a20 2020 2072  harindex").    r
-00015c80: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
-00015c90: 6275 696c 7469 6e28 2263 6861 7269 6e64  builtin("charind
-00015ca0: 6578 2229 2874 2c20 732c 206c 6974 2870  ex")(t, s, lit(p
-00015cb0: 6f73 6974 696f 6e29 290a 2020 2020 2020  osition)).      
-00015cc0: 2020 6966 2070 6f73 6974 696f 6e20 6973    if position is
-00015cd0: 206e 6f74 204e 6f6e 650a 2020 2020 2020   not None.      
-00015ce0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
-00015cf0: 6368 6172 696e 6465 7822 2928 742c 2073  charindex")(t, s
-00015d00: 290a 2020 2020 290a 0a0a 6465 6620 636f  ).    )...def co
-00015d10: 6c6c 6174 6528 653a 2043 6f6c 756d 6e2c  llate(e: Column,
-00015d20: 2063 6f6c 6c61 7469 6f6e 5f73 7065 633a   collation_spec:
-00015d30: 2073 7472 2920 2d3e 2043 6f6c 756d 6e3a   str) -> Column:
-00015d40: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-00015d50: 6120 636f 7079 206f 6620 7468 6520 6f72  a copy of the or
-00015d60: 6967 696e 616c 203a 636c 6173 733a 6043  iginal :class:`C
-00015d70: 6f6c 756d 6e60 2077 6974 6820 7468 6520  olumn` with the 
-00015d80: 7370 6563 6966 6965 6420 6060 636f 6c6c  specified ``coll
-00015d90: 6174 696f 6e5f 7370 6563 6060 0a20 2020  ation_spec``.   
-00015da0: 2070 726f 7065 7274 792c 2072 6174 6865   property, rathe
-00015db0: 7220 7468 616e 2074 6865 206f 7269 6769  r than the origi
-00015dc0: 6e61 6c20 636f 6c6c 6174 696f 6e20 7370  nal collation sp
-00015dd0: 6563 6966 6963 6174 696f 6e20 7072 6f70  ecification prop
-00015de0: 6572 7479 2e0a 0a20 2020 2046 6f72 2064  erty...    For d
-00015df0: 6574 6169 6c73 2c20 7365 6520 7468 6520  etails, see the 
-00015e00: 536e 6f77 666c 616b 6520 646f 6375 6d65  Snowflake docume
-00015e10: 6e74 6174 696f 6e20 6f6e 0a20 2020 2060  ntation on.    `
-00015e20: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
-00015e30: 6963 6174 696f 6e73 203c 6874 7470 733a  ications <https:
-00015e40: 2f2f 646f 6373 2e73 6e6f 7766 6c61 6b65  //docs.snowflake
-00015e50: 2e63 6f6d 2f65 6e2f 7371 6c2d 7265 6665  .com/en/sql-refe
-00015e60: 7265 6e63 652f 636f 6c6c 6174 696f 6e2e  rence/collation.
-00015e70: 6874 6d6c 236c 6162 656c 2d63 6f6c 6c61  html#label-colla
-00015e80: 7469 6f6e 2d73 7065 6369 6669 6361 7469  tion-specificati
-00015e90: 6f6e 3e60 5f2e 0a0a 2020 2020 4578 616d  on>`_...    Exam
-00015ea0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00015eb0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00015ec0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00015ed0: 5b27 c3b1 275d 2c20 7363 6865 6d61 3d5b  ['..'], schema=[
-00015ee0: 2776 275d 290a 2020 2020 2020 2020 3e3e  'v']).        >>
-00015ef0: 3e20 6466 2e73 656c 6563 7428 6466 2e76  > df.select(df.v
-00015f00: 203d 3d20 6c69 7428 27c3 9127 292c 2063   == lit('..'), c
-00015f10: 6f6c 6c61 7465 2864 662e 762c 2027 7370  ollate(df.v, 'sp
-00015f20: 2d75 7070 6572 2729 203d 3d20 6c69 7428  -upper') == lit(
-00015f30: 27c3 9127 2929 2e73 686f 7728 290a 2020  '..')).show().  
-00015f40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00015f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015f80: 0a20 2020 2020 2020 207c 2228 2222 5622  .        |"(""V"
-00015f90: 2220 3d20 27c3 9127 2922 2020 7c22 2843  " = '..')"  |"(C
-00015fa0: 4f4c 4c41 5445 2822 2256 2222 2c20 2753  OLLATE(""V"", 'S
-00015fb0: 502d 5550 5045 5227 2920 3d20 27c3 9127  P-UPPER') = '..'
-00015fc0: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
-00015fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015fe0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00015ff0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016000: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00016010: 207c 4661 6c73 6520 2020 2020 2020 2020   |False         
-00016020: 2020 207c 5472 7565 2020 2020 2020 2020     |True        
-00016030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016040: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00016050: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00016060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00016090: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000160a0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-000160b0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-000160c0: 7228 652c 2022 636f 6c6c 6174 6522 290a  r(e, "collate").
-000160d0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000160e0: 696e 2822 636f 6c6c 6174 6522 2928 632c  in("collate")(c,
-000160f0: 2063 6f6c 6c61 7469 6f6e 5f73 7065 6329   collation_spec)
-00016100: 0a0a 0a64 6566 2063 6f6c 6c61 7469 6f6e  ...def collation
-00016110: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00016120: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00016130: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00016140: 636f 6c6c 6174 696f 6e20 7370 6563 6966  collation specif
-00016150: 6963 6174 696f 6e20 6f66 2065 7870 722e  ication of expr.
-00016160: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00016170: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00016180: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00016190: 6461 7461 6672 616d 6528 5b27 c3b1 275d  dataframe(['..']
-000161a0: 2c20 7363 6865 6d61 3d5b 2776 275d 290a  , schema=['v']).
-000161b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000161c0: 656c 6563 7428 636f 6c6c 6174 696f 6e28  elect(collation(
-000161d0: 636f 6c6c 6174 6528 6466 2e76 2c20 2773  collate(df.v, 's
-000161e0: 702d 7570 7065 7227 2929 292e 7368 6f77  p-upper'))).show
-000161f0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00016200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016220: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00016230: 2243 4f4c 4c41 5449 4f4e 2843 4f4c 4c41  "COLLATION(COLLA
-00016240: 5445 2822 2256 2222 2c20 2753 502d 5550  TE(""V"", 'SP-UP
-00016250: 5045 5227 2929 2220 207c 0a20 2020 2020  PER'))"  |.     
-00016260: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00016270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00016290: 2020 2020 2020 207c 7370 2d75 7070 6572         |sp-upper
-000162a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162c0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000162d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000162e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000162f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00016300: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00016310: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00016320: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
-00016330: 6c6c 6174 696f 6e22 290a 2020 2020 7265  llation").    re
-00016340: 7475 726e 2062 7569 6c74 696e 2822 636f  turn builtin("co
-00016350: 6c6c 6174 696f 6e22 2928 6329 0a0a 0a64  llation")(c)...d
-00016360: 6566 2063 6f6e 6361 7428 2a63 6f6c 733a  ef concat(*cols:
-00016370: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00016380: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00016390: 2243 6f6e 6361 7465 6e61 7465 7320 6f6e  "Concatenates on
-000163a0: 6520 6f72 206d 6f72 6520 7374 7269 6e67  e or more string
-000163b0: 732c 206f 7220 636f 6e63 6174 656e 6174  s, or concatenat
-000163c0: 6573 206f 6e65 206f 7220 6d6f 7265 2062  es one or more b
-000163d0: 696e 6172 7920 7661 6c75 6573 2e20 4966  inary values. If
-000163e0: 2061 6e79 206f 6620 7468 6520 7661 6c75   any of the valu
-000163f0: 6573 2069 7320 6e75 6c6c 2c20 7468 6520  es is null, the 
-00016400: 7265 7375 6c74 2069 7320 616c 736f 206e  result is also n
-00016410: 756c 6c2e 0a0a 2020 2020 4578 616d 706c  ull...    Exampl
-00016420: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00016430: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00016440: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
-00016450: 2748 656c 6c6f 272c 2027 576f 726c 6427  'Hello', 'World'
-00016460: 5d5d 2c20 7363 6865 6d61 3d5b 2761 272c  ]], schema=['a',
-00016470: 2027 6227 5d29 0a20 2020 2020 2020 203e   'b']).        >
-00016480: 3e3e 2064 662e 7365 6c65 6374 2863 6f6e  >> df.select(con
-00016490: 6361 7428 6466 2e61 2c20 6466 2e62 2929  cat(df.a, df.b))
-000164a0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-000164b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000164c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000164d0: 2020 207c 2243 4f4e 4341 5428 2222 4122     |"CONCAT(""A"
-000164e0: 222c 2022 2242 2222 2922 2020 7c0a 2020  ", ""B"")"  |.  
-000164f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00016500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016510: 0a20 2020 2020 2020 207c 4865 6c6c 6f57  .        |HelloW
-00016520: 6f72 6c64 2020 2020 2020 2020 2020 2020  orld            
-00016530: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00016540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016550: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00016560: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00016570: 2222 0a0a 2020 2020 636f 6c75 6d6e 7320  ""..    columns 
-00016580: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
-00016590: 7228 632c 2022 636f 6e63 6174 2229 2066  r(c, "concat") f
-000165a0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
-000165b0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-000165c0: 2822 636f 6e63 6174 2229 282a 636f 6c75  ("concat")(*colu
-000165d0: 6d6e 7329 0a0a 0a64 6566 2063 6f6e 6361  mns)...def conca
-000165e0: 745f 7773 282a 636f 6c73 3a20 436f 6c75  t_ws(*cols: Colu
-000165f0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00016600: 756d 6e3a 0a20 2020 2022 2222 436f 6e63  umn:.    """Conc
-00016610: 6174 656e 6174 6573 2074 776f 206f 7220  atenates two or 
-00016620: 6d6f 7265 2073 7472 696e 6773 2c20 6f72  more strings, or
-00016630: 2063 6f6e 6361 7465 6e61 7465 7320 7477   concatenates tw
-00016640: 6f20 6f72 206d 6f72 6520 6269 6e61 7279  o or more binary
-00016650: 2076 616c 7565 732e 2049 6620 616e 7920   values. If any 
-00016660: 6f66 2074 6865 2076 616c 7565 7320 6973  of the values is
-00016670: 206e 756c 6c2c 2074 6865 2072 6573 756c   null, the resul
-00016680: 7420 6973 2061 6c73 6f20 6e75 6c6c 2e0a  t is also null..
-00016690: 2020 2020 5468 6520 434f 4e43 4154 5f57      The CONCAT_W
-000166a0: 5320 6f70 6572 6174 6f72 2072 6571 7569  S operator requi
-000166b0: 7265 7320 6174 206c 6561 7374 2074 776f  res at least two
-000166c0: 2061 7267 756d 656e 7473 2c20 616e 6420   arguments, and 
-000166d0: 7573 6573 2074 6865 2066 6972 7374 2061  uses the first a
-000166e0: 7267 756d 656e 7420 746f 2073 6570 6172  rgument to separ
-000166f0: 6174 6520 616c 6c20 666f 6c6c 6f77 696e  ate all followin
-00016700: 6720 6172 6775 6d65 6e74 732e 0a0a 2020  g arguments...  
-00016710: 2020 4578 616d 706c 6573 3a3a 0a20 2020    Examples::.   
-00016720: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00016730: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00016740: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-00016750: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
-00016760: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00016770: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00016780: 5b5b 2748 656c 6c6f 272c 2027 576f 726c  [['Hello', 'Worl
-00016790: 6427 5d5d 2c20 7363 6865 6d61 3d5b 2761  d']], schema=['a
-000167a0: 272c 2027 6227 5d29 0a20 2020 2020 2020  ', 'b']).       
-000167b0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-000167c0: 6f6e 6361 745f 7773 286c 6974 2827 2c27  oncat_ws(lit(','
-000167d0: 292c 2064 662e 612c 2064 662e 6229 292e  ), df.a, df.b)).
-000167e0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-000167f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016810: 2d0a 2020 2020 2020 2020 7c22 434f 4e43  -.        |"CONC
-00016820: 4154 5f57 5328 272c 272c 2022 2241 2222  AT_WS(',', ""A""
-00016830: 2c20 2222 4222 2229 2220 207c 0a20 2020  , ""B"")"  |.   
-00016840: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00016850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016860: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00016870: 7c48 656c 6c6f 2c57 6f72 6c64 2020 2020  |Hello,World    
-00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016890: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000168a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000168b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-000168c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-000168d0: 3e0a 0a20 2020 2020 2020 203e 3e3e 2064  >..        >>> d
-000168e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000168f0: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
-00016900: 4865 6c6c 6f27 2c20 2757 6f72 6c64 272c  Hello', 'World',
-00016910: 2027 2c27 5d5d 2c20 7363 6865 6d61 3d5b   ',']], schema=[
-00016920: 2761 272c 2027 6227 2c20 2773 6570 275d  'a', 'b', 'sep']
-00016930: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00016940: 2e73 656c 6563 7428 636f 6e63 6174 5f77  .select(concat_w
-00016950: 7328 2773 6570 272c 2064 662e 612c 2064  s('sep', df.a, d
-00016960: 662e 6229 292e 7368 6f77 2829 0a20 2020  f.b)).show().   
-00016970: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00016980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000169a0: 2020 2020 7c22 434f 4e43 4154 5f57 5328      |"CONCAT_WS(
-000169b0: 2222 5345 5022 222c 2022 2241 2222 2c20  ""SEP"", ""A"", 
-000169c0: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
-000169d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-000169e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000169f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00016a00: 2020 7c48 656c 6c6f 2c57 6f72 6c64 2020    |Hello,World  
-00016a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a20: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00016a30: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00016a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00016a50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00016a60: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00016a70: 2222 220a 2020 2020 636f 6c75 6d6e 7320  """.    columns 
-00016a80: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
-00016a90: 7228 632c 2022 636f 6e63 6174 5f77 7322  r(c, "concat_ws"
-00016aa0: 2920 666f 7220 6320 696e 2063 6f6c 735d  ) for c in cols]
-00016ab0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00016ac0: 7469 6e28 2263 6f6e 6361 745f 7773 2229  tin("concat_ws")
-00016ad0: 282a 636f 6c75 6d6e 7329 0a0a 0a64 6566  (*columns)...def
-00016ae0: 2074 7261 6e73 6c61 7465 280a 2020 2020   translate(.    
-00016af0: 7372 633a 2043 6f6c 756d 6e4f 724e 616d  src: ColumnOrNam
-00016b00: 652c 0a20 2020 2073 6f75 7263 655f 616c  e,.    source_al
-00016b10: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
-00016b20: 4e61 6d65 2c0a 2020 2020 7461 7267 6574  Name,.    target
-00016b30: 5f61 6c70 6861 6265 743a 2043 6f6c 756d  _alphabet: Colum
-00016b40: 6e4f 724e 616d 652c 0a29 202d 3e20 436f  nOrName,.) -> Co
-00016b50: 6c75 6d6e 3a0a 2020 2020 2222 2254 7261  lumn:.    """Tra
-00016b60: 6e73 6c61 7465 7320 7372 6320 6672 6f6d  nslates src from
-00016b70: 2074 6865 2063 6861 7261 6374 6572 7320   the characters 
-00016b80: 696e 2073 6f75 7263 655f 616c 7068 6162  in source_alphab
-00016b90: 6574 2074 6f20 7468 6520 6368 6172 6163  et to the charac
-00016ba0: 7465 7273 2069 6e0a 2020 2020 7461 7267  ters in.    targ
-00016bb0: 6574 5f61 6c70 6861 6265 742e 2045 6163  et_alphabet. Eac
-00016bc0: 6820 6368 6172 6163 7465 7220 6d61 7463  h character matc
-00016bd0: 6869 6e67 2061 2063 6861 7261 6374 6572  hing a character
-00016be0: 2061 7420 706f 7369 7469 6f6e 2069 2069   at position i i
-00016bf0: 6e20 7468 6520 736f 7572 6365 5f61 6c70  n the source_alp
-00016c00: 6861 6265 7420 6973 2072 6570 6c61 6365  habet is replace
-00016c10: 640a 2020 2020 7769 7468 2074 6865 2063  d.    with the c
-00016c20: 6861 7261 6374 6572 2061 7420 706f 7369  haracter at posi
-00016c30: 7469 6f6e 2069 2069 6e20 7468 6520 7461  tion i in the ta
-00016c40: 7267 6574 5f61 6c70 6861 6265 742e 2049  rget_alphabet. I
-00016c50: 6620 7461 7267 6574 5f61 6c70 6861 6265  f target_alphabe
-00016c60: 7420 6973 2073 686f 7274 6572 2c20 616e  t is shorter, an
-00016c70: 6420 7468 6572 6520 6973 206e 6f20 636f  d there is no co
-00016c80: 7272 6573 706f 6e64 696e 670a 2020 2020  rresponding.    
-00016c90: 6368 6172 6163 7465 7220 7468 6520 6368  character the ch
-00016ca0: 6172 6163 7465 7220 6973 206f 6d69 7474  aracter is omitt
-00016cb0: 6564 2e20 7461 7267 6574 5f61 6c70 6861  ed. target_alpha
-00016cc0: 6265 7420 6361 6e20 6e6f 7420 6265 206c  bet can not be l
-00016cd0: 6f6e 6765 7220 7468 616e 2073 6f75 7263  onger than sourc
-00016ce0: 655f 616c 7068 6162 6574 2e0a 0a20 2020  e_alphabet...   
-00016cf0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00016d00: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00016d10: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00016d20: 6672 616d 6528 5b22 6162 6364 6566 222c  frame(["abcdef",
-00016d30: 2022 6162 6261 225d 2c20 7363 6865 6d61   "abba"], schema
-00016d40: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
-00016d50: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
-00016d60: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
-00016d70: 2c20 6c69 7428 2261 6263 2229 2c20 6c69  , lit("abc"), li
-00016d80: 7428 2241 4243 2229 292e 6173 5f28 2261  t("ABC")).as_("a
-00016d90: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-00016da0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-00016db0: 3d27 4142 4364 6566 2729 2c20 526f 7728  ='ABCdef'), Row(
-00016dc0: 414e 533d 2741 4242 4127 295d 0a0a 2020  ANS='ABBA')]..  
-00016dd0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00016de0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00016df0: 7461 6672 616d 6528 5b22 6669 6c65 2077  taframe(["file w
-00016e00: 6974 6820 7370 6163 6573 2e74 7874 222c  ith spaces.txt",
-00016e10: 2022 5c5c 7474 6573 7422 5d2c 2073 6368   "\\ttest"], sch
-00016e20: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-00016e30: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00016e40: 2874 7261 6e73 6c61 7465 2863 6f6c 2822  (translate(col("
-00016e50: 6122 292c 206c 6974 2822 205c 5c74 2229  a"), lit(" \\t")
-00016e60: 2c20 6c69 7428 225f 2229 292e 6173 5f28  , lit("_")).as_(
-00016e70: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-00016e80: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00016e90: 4e53 3d27 6669 6c65 5f77 6974 685f 7370  NS='file_with_sp
-00016ea0: 6163 6573 2e74 7874 2729 2c20 526f 7728  aces.txt'), Row(
-00016eb0: 414e 533d 2774 6573 7427 295d 0a0a 2020  ANS='test')]..  
-00016ec0: 2020 2222 220a 2020 2020 736f 7572 6365    """.    source
-00016ed0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00016ee0: 7228 7372 632c 2022 7472 616e 736c 6174  r(src, "translat
-00016ef0: 6522 290a 2020 2020 736f 7572 6365 5f61  e").    source_a
-00016f00: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
-00016f10: 6c5f 6966 5f73 7472 2873 6f75 7263 655f  l_if_str(source_
-00016f20: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
-00016f30: 6c61 7465 2229 0a20 2020 2074 6172 6765  late").    targe
-00016f40: 745f 616c 7068 6162 6574 203d 205f 746f  t_alphabet = _to
-00016f50: 5f63 6f6c 5f69 665f 7374 7228 7461 7267  _col_if_str(targ
-00016f60: 6574 5f61 6c70 6861 6265 742c 2022 7472  et_alphabet, "tr
-00016f70: 616e 736c 6174 6522 290a 2020 2020 7265  anslate").    re
-00016f80: 7475 726e 2062 7569 6c74 696e 2822 7472  turn builtin("tr
-00016f90: 616e 736c 6174 6522 2928 736f 7572 6365  anslate")(source
-00016fa0: 2c20 736f 7572 6365 5f61 6c70 6861 6265  , source_alphabe
-00016fb0: 742c 2074 6172 6765 745f 616c 7068 6162  t, target_alphab
-00016fc0: 6574 290a 0a0a 6465 6620 636f 6e74 6169  et)...def contai
-00016fd0: 6e73 2863 6f6c 3a20 436f 6c75 6d6e 4f72  ns(col: ColumnOr
-00016fe0: 4e61 6d65 2c20 7374 7269 6e67 3a20 436f  Name, string: Co
-00016ff0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00017000: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
-00017010: 7475 726e 7320 6966 2060 636f 6c60 2063  turns if `col` c
-00017020: 6f6e 7461 696e 7320 6073 7472 696e 6760  ontains `string`
-00017030: 2066 6f72 2065 6163 6820 726f 772e 2053   for each row. S
-00017040: 6565 2060 434f 4e54 4149 4e53 203c 6874  ee `CONTAINS <ht
-00017050: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
-00017060: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
-00017070: 7265 6665 7265 6e63 652f 6675 6e63 7469  reference/functi
-00017080: 6f6e 732f 636f 6e74 6169 6e73 3e60 0a0a  ons/contains>`..
-00017090: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-000170a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000170b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000170c0: 6166 7261 6d65 285b 5b31 2c32 5d2c 205b  aframe([[1,2], [
-000170d0: 332c 345d 2c20 5b35 2c35 5d20 5d2c 2073  3,4], [5,5] ], s
-000170e0: 6368 656d 613d 5b22 6122 2c22 6222 5d29  chema=["a","b"])
-000170f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00017100: 7365 6c65 6374 2863 6f6e 7461 696e 7328  select(contains(
-00017110: 636f 6c28 2261 2229 2c20 636f 6c28 2262  col("a"), col("b
-00017120: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
-00017130: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00017140: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00017150: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00017160: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
-00017170: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00017180: 2020 207c 4661 6c73 6520 2020 2020 7c0a     |False     |.
-00017190: 2020 2020 2020 2020 7c46 616c 7365 2020          |False  
-000171a0: 2020 207c 0a20 2020 2020 2020 207c 5472     |.        |Tr
-000171b0: 7565 2020 2020 2020 7c0a 2020 2020 2020  ue      |.      
-000171c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000171d0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000171e0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-000171f0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00017200: 7228 636f 6c2c 2022 636f 6e74 6169 6e73  r(col, "contains
-00017210: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
-00017220: 6f6c 5f69 665f 7374 7228 7374 7269 6e67  ol_if_str(string
-00017230: 2c20 2263 6f6e 7461 696e 7322 290a 2020  , "contains").  
-00017240: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00017250: 2822 636f 6e74 6169 6e73 2229 2863 2c20  ("contains")(c, 
-00017260: 7329 0a0a 0a64 6566 2073 7461 7274 7377  s)...def startsw
-00017270: 6974 6828 636f 6c3a 2043 6f6c 756d 6e4f  ith(col: ColumnO
-00017280: 724e 616d 652c 2073 7472 3a20 436f 6c75  rName, str: Colu
-00017290: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000172a0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-000172b0: 726e 7320 7472 7565 2069 6620 636f 6c20  rns true if col 
-000172c0: 7374 6172 7473 2077 6974 6820 7374 722e  starts with str.
-000172d0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-000172e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000172f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00017300: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-00017310: 2020 202e 2e2e 2020 2020 205b 5b22 6162     ...     [["ab
-00017320: 6322 2c20 2261 225d 2c20 5b22 6162 6322  c", "a"], ["abc"
-00017330: 2c20 2273 225d 5d2c 0a20 2020 2020 2020  , "s"]],.       
-00017340: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00017350: 5b22 5322 2c20 2250 225d 2c0a 2020 2020  ["S", "P"],.    
-00017360: 2020 2020 2e2e 2e20 292e 7365 6c65 6374      ... ).select
-00017370: 2873 7461 7274 7377 6974 6828 636f 6c28  (startswith(col(
-00017380: 2253 2229 2c20 636f 6c28 2250 2229 2929  "S"), col("P")))
-00017390: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000173a0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-000173b0: 2020 5b52 6f77 2853 5441 5254 5357 4954    [Row(STARTSWIT
-000173c0: 4828 2253 222c 2022 5022 293d 5472 7565  H("S", "P")=True
-000173d0: 292c 2052 6f77 2853 5441 5254 5357 4954  ), Row(STARTSWIT
-000173e0: 4828 2253 222c 2022 5022 293d 4661 6c73  H("S", "P")=Fals
-000173f0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-00017400: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00017410: 7472 2863 6f6c 2c20 2273 7461 7274 7377  tr(col, "startsw
-00017420: 6974 6822 290a 2020 2020 7320 3d20 5f74  ith").    s = _t
-00017430: 6f5f 636f 6c5f 6966 5f73 7472 2873 7472  o_col_if_str(str
-00017440: 2c20 2273 7461 7274 7377 6974 6822 290a  , "startswith").
-00017450: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00017460: 696e 2822 7374 6172 7473 7769 7468 2229  in("startswith")
-00017470: 2863 2c20 7329 0a0a 0a64 6566 2065 6e64  (c, s)...def end
-00017480: 7377 6974 6828 636f 6c3a 2043 6f6c 756d  swith(col: Colum
-00017490: 6e4f 724e 616d 652c 2073 7472 3a20 436f  nOrName, str: Co
-000174a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-000174b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-000174c0: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-000174d0: 6966 2063 6f6c 2065 6e64 7320 7769 7468  if col ends with
-000174e0: 2073 7472 2e0a 0a20 2020 2045 7861 6d70   str...    Examp
-000174f0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00017500: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00017510: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00017520: 5b22 6170 706c 6522 2c20 2262 616e 616e  ["apple", "banan
-00017530: 6122 2c20 2270 6561 6368 225d 2c20 7363  a", "peach"], sc
-00017540: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-00017550: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00017560: 7428 656e 6473 7769 7468 2864 665b 2261  t(endswith(df["a
-00017570: 225d 2c20 6c69 7428 2261 6e61 2229 292e  "], lit("ana")).
-00017580: 616c 6961 7328 2265 6e64 7377 6974 6822  alias("endswith"
-00017590: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-000175a0: 2020 2020 205b 526f 7728 454e 4453 5749       [Row(ENDSWI
-000175b0: 5448 3d46 616c 7365 292c 2052 6f77 2845  TH=False), Row(E
-000175c0: 4e44 5357 4954 483d 5472 7565 292c 2052  NDSWITH=True), R
-000175d0: 6f77 2845 4e44 5357 4954 483d 4661 6c73  ow(ENDSWITH=Fals
-000175e0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-000175f0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00017600: 7472 2863 6f6c 2c20 2265 6e64 7377 6974  tr(col, "endswit
-00017610: 6822 290a 2020 2020 7320 3d20 5f74 6f5f  h").    s = _to_
-00017620: 636f 6c5f 6966 5f73 7472 2873 7472 2c20  col_if_str(str, 
-00017630: 2265 6e64 7377 6974 6822 290a 2020 2020  "endswith").    
-00017640: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00017650: 656e 6473 7769 7468 2229 2863 2c20 7329  endswith")(c, s)
-00017660: 0a0a 0a64 6566 2069 6e73 6572 7428 0a20  ...def insert(. 
-00017670: 2020 2062 6173 655f 6578 7072 3a20 436f     base_expr: Co
-00017680: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
-00017690: 706f 7369 7469 6f6e 3a20 556e 696f 6e5b  position: Union[
-000176a0: 436f 6c75 6d6e 2c20 696e 745d 2c0a 2020  Column, int],.  
-000176b0: 2020 6c65 6e67 7468 3a20 556e 696f 6e5b    length: Union[
-000176c0: 436f 6c75 6d6e 2c20 696e 745d 2c0a 2020  Column, int],.  
-000176d0: 2020 696e 7365 7274 5f65 7870 723a 2043    insert_expr: C
-000176e0: 6f6c 756d 6e4f 724e 616d 652c 0a29 202d  olumnOrName,.) -
-000176f0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00017700: 220a 2020 2020 5265 706c 6163 6573 2061  ".    Replaces a
-00017710: 2073 7562 7374 7269 6e67 206f 6620 7468   substring of th
-00017720: 6520 7370 6563 6966 6965 6420 6c65 6e67  e specified leng
-00017730: 7468 2c20 7374 6172 7469 6e67 2061 7420  th, starting at 
-00017740: 7468 6520 7370 6563 6966 6965 6420 706f  the specified po
-00017750: 7369 7469 6f6e 2c0a 2020 2020 7769 7468  sition,.    with
-00017760: 2061 206e 6577 2073 7472 696e 6720 6f72   a new string or
-00017770: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
-00017780: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
-00017790: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-000177a0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-000177b0: 6461 7461 6672 616d 6528 5b22 6162 6322  dataframe(["abc"
-000177c0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-000177d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000177e0: 7365 6c65 6374 2869 6e73 6572 7428 6466  select(insert(df
-000177f0: 5b22 6122 5d2c 2031 2c20 322c 206c 6974  ["a"], 1, 2, lit
-00017800: 2822 5a22 2929 2e61 6c69 6173 2822 696e  ("Z")).alias("in
-00017810: 7365 7274 2229 292e 636f 6c6c 6563 7428  sert")).collect(
-00017820: 290a 2020 2020 2020 2020 5b52 6f77 2849  ).        [Row(I
-00017830: 4e53 4552 543d 275a 6327 295d 0a20 2020  NSERT='Zc')].   
-00017840: 2022 2222 0a20 2020 2062 203d 205f 746f   """.    b = _to
-00017850: 5f63 6f6c 5f69 665f 7374 7228 6261 7365  _col_if_str(base
-00017860: 5f65 7870 722c 2022 696e 7365 7274 2229  _expr, "insert")
-00017870: 0a20 2020 2069 203d 205f 746f 5f63 6f6c  .    i = _to_col
-00017880: 5f69 665f 7374 7228 696e 7365 7274 5f65  _if_str(insert_e
-00017890: 7870 722c 2022 696e 7365 7274 2229 0a20  xpr, "insert"). 
-000178a0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-000178b0: 6e28 2269 6e73 6572 7422 2928 622c 206c  n("insert")(b, l
-000178c0: 6974 2870 6f73 6974 696f 6e29 2c20 6c69  it(position), li
-000178d0: 7428 6c65 6e67 7468 292c 2069 290a 0a0a  t(length), i)...
-000178e0: 6465 6620 6c65 6674 2873 7472 5f65 7870  def left(str_exp
-000178f0: 723a 2043 6f6c 756d 6e4f 724e 616d 652c  r: ColumnOrName,
-00017900: 206c 656e 6774 683a 2055 6e69 6f6e 5b43   length: Union[C
-00017910: 6f6c 756d 6e2c 2069 6e74 5d29 202d 3e20  olumn, int]) -> 
-00017920: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00017930: 6574 7572 6e73 2061 206c 6566 7420 6d6f  eturns a left mo
-00017940: 7374 2073 7562 7374 7269 6e67 206f 6620  st substring of 
-00017950: 6060 7374 725f 6578 7072 6060 2e0a 0a20  ``str_expr``... 
-00017960: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00017970: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00017980: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00017990: 7461 6672 616d 6528 5b5b 2261 6263 225d  taframe([["abc"]
-000179a0: 2c20 5b22 6465 6622 5d5d 2c20 7363 6865  , ["def"]], sche
-000179b0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-000179c0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000179d0: 6c65 6674 2863 6f6c 2822 6122 292c 2032  left(col("a"), 2
-000179e0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-000179f0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00017a00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00017a10: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00017a20: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00017a30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00017a40: 207c 6162 2020 2020 2020 2020 7c0a 2020   |ab        |.  
-00017a50: 2020 2020 2020 7c64 6520 2020 2020 2020        |de       
-00017a60: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00017a70: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00017a80: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-00017a90: 2222 220a 2020 2020 7320 3d20 5f74 6f5f  """.    s = _to_
-00017aa0: 636f 6c5f 6966 5f73 7472 2873 7472 5f65  col_if_str(str_e
-00017ab0: 7870 722c 2022 6c65 6674 2229 0a20 2020  xpr, "left").   
-00017ac0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00017ad0: 226c 6566 7422 2928 732c 206c 6974 286c  "left")(s, lit(l
-00017ae0: 656e 6774 6829 290a 0a0a 6465 6620 7269  ength))...def ri
-00017af0: 6768 7428 7374 725f 6578 7072 3a20 436f  ght(str_expr: Co
-00017b00: 6c75 6d6e 4f72 4e61 6d65 2c20 6c65 6e67  lumnOrName, leng
-00017b10: 7468 3a20 556e 696f 6e5b 436f 6c75 6d6e  th: Union[Column
-00017b20: 2c20 696e 745d 2920 2d3e 2043 6f6c 756d  , int]) -> Colum
-00017b30: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00017b40: 7320 6120 7269 6768 7420 6d6f 7374 2073  s a right most s
-00017b50: 7562 7374 7269 6e67 206f 6620 6060 7374  ubstring of ``st
-00017b60: 725f 6578 7072 6060 2e0a 0a20 2020 2045  r_expr``...    E
-00017b70: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00017b80: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00017b90: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00017ba0: 616d 6528 5b5b 2261 6263 225d 2c20 5b22  ame([["abc"], ["
-00017bb0: 6465 6622 5d5d 2c20 7363 6865 6d61 3d5b  def"]], schema=[
-00017bc0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00017bd0: 3e20 6466 2e73 656c 6563 7428 7269 6768  > df.select(righ
-00017be0: 7428 636f 6c28 2261 2229 2c20 3229 2e61  t(col("a"), 2).a
-00017bf0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-00017c00: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00017c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00017c20: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-00017c30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017c40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c62  -----.        |b
-00017c50: 6320 2020 2020 2020 207c 0a20 2020 2020  c        |.     
-00017c60: 2020 207c 6566 2020 2020 2020 2020 7c0a     |ef        |.
-00017c70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017c80: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00017c90: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00017ca0: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
-00017cb0: 5f69 665f 7374 7228 7374 725f 6578 7072  _if_str(str_expr
-00017cc0: 2c20 2272 6967 6874 2229 0a20 2020 2072  , "right").    r
-00017cd0: 6574 7572 6e20 6275 696c 7469 6e28 2272  eturn builtin("r
-00017ce0: 6967 6874 2229 2873 2c20 6c69 7428 6c65  ight")(s, lit(le
-00017cf0: 6e67 7468 2929 0a0a 0a64 6566 2063 6861  ngth))...def cha
-00017d00: 7228 636f 6c3a 2043 6f6c 756d 6e4f 724e  r(col: ColumnOrN
-00017d10: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-00017d20: 2020 2020 2222 2243 6f6e 7665 7274 7320      """Converts 
-00017d30: 6120 556e 6963 6f64 6520 636f 6465 2070  a Unicode code p
-00017d40: 6f69 6e74 2028 696e 636c 7564 696e 6720  oint (including 
-00017d50: 372d 6269 7420 4153 4349 4929 2069 6e74  7-bit ASCII) int
-00017d60: 6f20 7468 6520 6368 6172 6163 7465 7220  o the character 
-00017d70: 7468 6174 0a20 2020 206d 6174 6368 6573  that.    matches
-00017d80: 2074 6865 2069 6e70 7574 2055 6e69 636f   the input Unico
-00017d90: 6465 2e0a 0a20 2020 2045 7861 6d70 6c65  de...    Example
-00017da0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00017db0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00017dc0: 6174 655f 6461 7461 6672 616d 6528 5b38  ate_dataframe([8
-00017dd0: 332c 2033 332c 2031 3639 2c20 3833 3634  3, 33, 169, 8364
-00017de0: 2c20 4e6f 6e65 5d2c 2073 6368 656d 613d  , None], schema=
-00017df0: 5b27 6127 5d29 0a20 2020 2020 2020 203e  ['a']).        >
-00017e00: 3e3e 2064 662e 7365 6c65 6374 2864 662e  >> df.select(df.
-00017e10: 612c 2063 6861 7228 6466 2e61 292e 6173  a, char(df.a).as
-00017e20: 5f28 2763 6861 7227 2929 2e73 6f72 7428  _('char')).sort(
-00017e30: 6466 2e61 292e 7368 6f77 2829 0a20 2020  df.a).show().   
-00017e40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00017e50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00017e60: 2241 2220 2020 7c22 4348 4152 2220 207c  "A"   |"CHAR"  |
-00017e70: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017e80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00017e90: 2020 207c 4e55 4c4c 2020 7c4e 554c 4c20     |NULL  |NULL 
-00017ea0: 2020 207c 0a20 2020 2020 2020 207c 3333     |.        |33
-00017eb0: 2020 2020 7c21 2020 2020 2020 207c 0a20      |!       |. 
-00017ec0: 2020 2020 2020 207c 3833 2020 2020 7c53         |83    |S
-00017ed0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00017ee0: 207c 3136 3920 2020 7cc2 a920 2020 2020   |169   |..     
-00017ef0: 2020 7c0a 2020 2020 2020 2020 7c38 3336    |.        |836
-00017f00: 3420 207c e282 ac20 2020 2020 2020 7c0a  4  |...       |.
-00017f10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017f20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00017f30: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00017f40: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00017f50: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-00017f60: 2c20 2263 6861 7222 290a 2020 2020 7265  , "char").    re
-00017f70: 7475 726e 2062 7569 6c74 696e 2822 6368  turn builtin("ch
-00017f80: 6172 2229 2863 290a 0a0a 6465 6620 746f  ar")(c)...def to
-00017f90: 5f63 6861 7228 633a 2043 6f6c 756d 6e4f  _char(c: ColumnO
-00017fa0: 724e 616d 652c 2066 6f72 6d61 743a 204f  rName, format: O
-00017fb0: 7074 696f 6e61 6c5b 436f 6c75 6d6e 4f72  ptional[ColumnOr
-00017fc0: 4c69 7465 7261 6c53 7472 5d20 3d20 4e6f  LiteralStr] = No
-00017fd0: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
-00017fe0: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
-00017ff0: 2055 6e69 636f 6465 2063 6f64 6520 706f   Unicode code po
-00018000: 696e 7420 2869 6e63 6c75 6469 6e67 2037  int (including 7
-00018010: 2d62 6974 2041 5343 4949 2920 696e 746f  -bit ASCII) into
-00018020: 2074 6865 2063 6861 7261 6374 6572 2074   the character t
-00018030: 6861 740a 2020 2020 6d61 7463 6865 7320  hat.    matches 
-00018040: 7468 6520 696e 7075 7420 556e 6963 6f64  the input Unicod
-00018050: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-00018060: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-00018070: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-00018080: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-00018090: 322c 2033 2c20 345d 2c20 7363 6865 6d61  2, 3, 4], schema
-000180a0: 3d5b 2761 275d 290a 2020 2020 2020 2020  =['a']).        
-000180b0: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
-000180c0: 5f63 6861 7228 636f 6c28 2761 2729 292e  _char(col('a')).
-000180d0: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
-000180e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-000180f0: 6f77 2841 4e53 3d27 3127 292c 2052 6f77  ow(ANS='1'), Row
-00018100: 2841 4e53 3d27 3227 292c 2052 6f77 2841  (ANS='2'), Row(A
-00018110: 4e53 3d27 3327 292c 2052 6f77 2841 4e53  NS='3'), Row(ANS
-00018120: 3d27 3427 295d 0a0a 2020 2020 4578 616d  ='4')]..    Exam
-00018130: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00018140: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00018150: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-00018160: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00018170: 7465 5f64 6174 6166 7261 6d65 285b 6461  te_dataframe([da
-00018180: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-00018190: 3230 3233 2c20 342c 2031 3629 2c20 6461  2023, 4, 16), da
-000181a0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-000181b0: 3230 3137 2c20 342c 2033 2c20 322c 2035  2017, 4, 3, 2, 5
-000181c0: 392c 2033 372c 2031 3533 295d 2c20 7363  9, 37, 153)], sc
-000181d0: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
-000181e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000181f0: 7428 746f 5f63 6861 7228 636f 6c28 2761  t(to_char(col('a
-00018200: 2729 292e 6173 5f28 2761 6e73 2729 292e  ')).as_('ans')).
-00018210: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00018220: 2020 5b52 6f77 2841 4e53 3d27 3230 3233    [Row(ANS='2023
-00018230: 2d30 342d 3136 2030 303a 3030 3a30 302e  -04-16 00:00:00.
-00018240: 3030 3027 292c 2052 6f77 2841 4e53 3d27  000'), Row(ANS='
-00018250: 3230 3137 2d30 342d 3033 2030 323a 3539  2017-04-03 02:59
-00018260: 3a33 372e 3030 3027 295d 0a0a 2020 2020  :37.000')]..    
-00018270: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00018280: 636f 6c5f 6966 5f73 7472 2863 2c20 2274  col_if_str(c, "t
-00018290: 6f5f 6368 6172 2229 0a20 2020 2072 6574  o_char").    ret
-000182a0: 7572 6e20 280a 2020 2020 2020 2020 6275  urn (.        bu
-000182b0: 696c 7469 6e28 2274 6f5f 6368 6172 2229  iltin("to_char")
-000182c0: 2863 2c20 6c69 7428 666f 726d 6174 2929  (c, lit(format))
-000182d0: 0a20 2020 2020 2020 2069 6620 666f 726d  .        if form
-000182e0: 6174 2069 7320 6e6f 7420 4e6f 6e65 0a20  at is not None. 
-000182f0: 2020 2020 2020 2065 6c73 6520 6275 696c         else buil
-00018300: 7469 6e28 2274 6f5f 6368 6172 2229 2863  tin("to_char")(c
-00018310: 290a 2020 2020 290a 0a0a 6465 6620 746f  ).    )...def to
-00018320: 5f74 696d 6528 653a 2043 6f6c 756d 6e4f  _time(e: ColumnO
-00018330: 724e 616d 652c 2066 6d74 3a20 4f70 7469  rName, fmt: Opti
-00018340: 6f6e 616c 5b22 436f 6c75 6d6e 225d 203d  onal["Column"] =
-00018350: 204e 6f6e 6529 202d 3e20 436f 6c75 6d6e   None) -> Column
-00018360: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
-00018370: 7320 616e 2069 6e70 7574 2065 7870 7265  s an input expre
-00018380: 7373 696f 6e20 696e 746f 2074 6865 2063  ssion into the c
-00018390: 6f72 7265 7370 6f6e 6469 6e67 2074 696d  orresponding tim
-000183a0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-000183b0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-000183c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000183d0: 7465 5f64 6174 6166 7261 6d65 285b 2730  te_dataframe(['0
-000183e0: 343a 3135 3a32 392e 3939 3927 5d2c 2073  4:15:29.999'], s
-000183f0: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-00018400: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00018410: 6374 2874 6f5f 7469 6d65 2863 6f6c 2822  ct(to_time(col("
-00018420: 6122 2929 292e 636f 6c6c 6563 7428 290a  a"))).collect().
-00018430: 2020 2020 2020 2020 5b52 6f77 2854 4f5f          [Row(TO_
-00018440: 5449 4d45 2822 4122 293d 6461 7465 7469  TIME("A")=dateti
-00018450: 6d65 2e74 696d 6528 342c 2031 352c 2032  me.time(4, 15, 2
-00018460: 392c 2039 3939 3030 3029 295d 0a20 2020  9, 999000))].   
-00018470: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-00018480: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00018490: 746f 5f74 696d 6522 290a 2020 2020 7265  to_time").    re
-000184a0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-000184b0: 5f74 696d 6522 2928 632c 2066 6d74 2920  _time")(c, fmt) 
-000184c0: 6966 2066 6d74 2069 7320 6e6f 7420 4e6f  if fmt is not No
-000184d0: 6e65 2065 6c73 6520 6275 696c 7469 6e28  ne else builtin(
-000184e0: 2274 6f5f 7469 6d65 2229 2863 290a 0a0a  "to_time")(c)...
-000184f0: 6465 6620 746f 5f74 696d 6573 7461 6d70  def to_timestamp
-00018500: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00018510: 2c20 666d 743a 204f 7074 696f 6e61 6c5b  , fmt: Optional[
-00018520: 2243 6f6c 756d 6e22 5d20 3d20 4e6f 6e65  "Column"] = None
-00018530: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00018540: 2022 2222 436f 6e76 6572 7473 2061 6e20   """Converts an 
-00018550: 696e 7075 7420 6578 7072 6573 7369 6f6e  input expression
-00018560: 2069 6e74 6f20 7468 6520 636f 7272 6573   into the corres
-00018570: 706f 6e64 696e 6720 7469 6d65 7374 616d  ponding timestam
-00018580: 702e 0a0a 2020 2020 5065 7220 6465 6661  p...    Per defa
-00018590: 756c 7420 666d 7420 6973 2073 6574 2074  ult fmt is set t
-000185a0: 6f20 6175 746f 2c20 7768 6963 6820 6d61  o auto, which ma
-000185b0: 6b65 7320 536e 6f77 666c 616b 6520 6465  kes Snowflake de
-000185c0: 7465 6374 2074 6865 2066 6f72 6d61 7420  tect the format 
-000185d0: 6175 746f 6d61 7469 6361 6c6c 792e 2057  automatically. W
-000185e0: 6974 6820 6074 6f5f 7469 6d65 7374 616d  ith `to_timestam
-000185f0: 7060 2073 7472 696e 6773 0a20 2020 2063  p` strings.    c
-00018600: 616e 2062 6520 636f 6e76 6572 7465 6420  an be converted 
-00018610: 746f 2074 696d 6573 7461 6d70 732e 2054  to timestamps. T
-00018620: 6865 2066 6f72 6d61 7420 6861 7320 746f  he format has to
-00018630: 2062 6520 7370 6563 6966 6965 6420 6163   be specified ac
-00018640: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
-00018650: 756c 6573 2073 6574 2066 6f72 7468 2069  ules set forth i
-00018660: 6e0a 2020 2020 3c68 7474 7073 3a2f 2f64  n.    <https://d
-00018670: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
-00018680: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
-00018690: 6365 2f66 756e 6374 696f 6e73 2d63 6f6e  ce/functions-con
-000186a0: 7665 7273 696f 6e23 6461 7465 2d61 6e64  version#date-and
-000186b0: 2d74 696d 652d 666f 726d 6174 732d 696e  -time-formats-in
-000186c0: 2d63 6f6e 7665 7273 696f 6e2d 6675 6e63  -conversion-func
-000186d0: 7469 6f6e 733e 0a0a 2020 2020 4578 616d  tions>..    Exam
-000186e0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-000186f0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00018700: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00018710: 5b27 3230 3139 2d30 312d 3331 2030 313a  ['2019-01-31 01:
-00018720: 3032 3a30 332e 3030 3427 5d2c 2073 6368  02:03.004'], sch
-00018730: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
-00018740: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00018750: 2874 6f5f 7469 6d65 7374 616d 7028 636f  (to_timestamp(co
-00018760: 6c28 2261 2229 292e 6173 5f28 2261 6e73  l("a")).as_("ans
-00018770: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00018780: 2020 2020 2020 5b52 6f77 2841 4e53 3d64        [Row(ANS=d
-00018790: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-000187a0: 2832 3031 392c 2031 2c20 3331 2c20 312c  (2019, 1, 31, 1,
-000187b0: 2032 2c20 332c 2034 3030 3029 295d 0a20   2, 3, 4000))]. 
-000187c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000187d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000187e0: 6174 6166 7261 6d65 285b 2232 3032 302d  ataframe(["2020-
-000187f0: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
-00018800: 3030 225d 2c20 7363 6865 6d61 3d5b 2761  00"], schema=['a
-00018810: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-00018820: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
-00018830: 6573 7461 6d70 2863 6f6c 2822 6122 292c  estamp(col("a"),
-00018840: 206c 6974 2822 5959 5959 2d4d 4d2d 4444   lit("YYYY-MM-DD
-00018850: 2048 4832 343a 4d49 3a53 532e 4646 3322   HH24:MI:SS.FF3"
-00018860: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
-00018870: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00018880: 205b 526f 7728 414e 533d 6461 7465 7469   [Row(ANS=dateti
-00018890: 6d65 2e64 6174 6574 696d 6528 3230 3230  me.datetime(2020
-000188a0: 2c20 352c 2031 2c20 3133 2c20 3131 2c20  , 5, 1, 13, 11, 
-000188b0: 3230 2929 5d0a 0a20 2020 2041 6e6f 7468  20))]..    Anoth
-000188c0: 6572 206f 7074 696f 6e20 6973 2074 6f20  er option is to 
-000188d0: 636f 6e76 6572 7420 6461 7465 7320 696e  convert dates in
-000188e0: 746f 2074 696d 6573 7461 6d70 730a 0a20  to timestamps.. 
-000188f0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00018900: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-00018910: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
-00018920: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00018930: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
-00018940: 6528 5b64 6174 6574 696d 652e 6461 7465  e([datetime.date
-00018950: 7469 6d65 2832 3032 322c 2031 322c 2032  time(2022, 12, 2
-00018960: 352c 2031 332c 2035 392c 2033 382c 2034  5, 13, 59, 38, 4
-00018970: 3637 295d 2c20 7363 6865 6d61 3d5b 2261  67)], schema=["a
-00018980: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-00018990: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
-000189a0: 6573 7461 6d70 2863 6f6c 2822 6122 2929  estamp(col("a"))
-000189b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-000189c0: 2020 2020 5b52 6f77 2854 4f5f 5449 4d45      [Row(TO_TIME
-000189d0: 5354 414d 5028 2241 2229 3d64 6174 6574  STAMP("A")=datet
-000189e0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-000189f0: 322c 2031 322c 2032 352c 2031 332c 2035  2, 12, 25, 13, 5
-00018a00: 392c 2033 382c 2034 3637 2929 5d0a 2020  9, 38, 467))].  
-00018a10: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00018a20: 6573 7369 6f6e 2e63 7265 6174 6544 6174  ession.createDat
-00018a30: 6146 7261 6d65 285b 6461 7465 7469 6d65  aFrame([datetime
-00018a40: 2e64 6174 6528 3230 3233 2c20 332c 2031  .date(2023, 3, 1
-00018a50: 295d 2c20 7363 6865 6d61 3d5b 2261 225d  )], schema=["a"]
-00018a60: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00018a70: 2e73 656c 6563 7428 746f 5f74 696d 6573  .select(to_times
-00018a80: 7461 6d70 2863 6f6c 2822 6122 2929 292e  tamp(col("a"))).
-00018a90: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00018aa0: 2020 5b52 6f77 2854 4f5f 5449 4d45 5354    [Row(TO_TIMEST
-00018ab0: 414d 5028 2241 2229 3d64 6174 6574 696d  AMP("A")=datetim
-00018ac0: 652e 6461 7465 7469 6d65 2832 3032 332c  e.datetime(2023,
-00018ad0: 2033 2c20 312c 2030 2c20 3029 295d 0a0a   3, 1, 0, 0))]..
-00018ae0: 2020 2020 496e 7465 6765 7273 2063 616e      Integers can
-00018af0: 2062 6520 636f 6e76 6572 7465 6420 696e   be converted in
-00018b00: 746f 2061 2074 696d 6573 7461 6d70 2061  to a timestamp a
-00018b10: 7320 7765 6c6c 2c20 6279 2070 726f 7669  s well, by provi
-00018b20: 6469 6e67 206f 7074 696f 6e61 6c6c 7920  ding optionally 
-00018b30: 6120 7363 616c 6520 6173 2061 6e20 696e  a scale as an in
-00018b40: 7465 6765 7220 6173 206c 696e 6564 206f  teger as lined o
-00018b50: 7574 2069 6e0a 2020 2020 3c68 7474 7073  ut in.    <https
-00018b60: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
-00018b70: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
-00018b80: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
-00018b90: 2f74 6f5f 7469 6d65 7374 616d 7023 7573  /to_timestamp#us
-00018ba0: 6167 652d 6e6f 7465 733e 2e20 4375 7272  age-notes>. Curr
-00018bb0: 656e 746c 7920 536e 6f77 7061 726b 2064  ently Snowpark d
-00018bc0: 6f65 7320 7375 7070 6f72 740a 2020 2020  oes support.    
-00018bd0: 696e 7465 6765 7273 2069 6e20 7468 6520  integers in the 
-00018be0: 7261 6e67 6520 6f66 2061 6e20 382d 6279  range of an 8-by
-00018bf0: 7465 2073 6967 6e65 6420 696e 7465 6765  te signed intege
-00018c00: 7220 6f6e 6c79 2e0a 0a20 2020 2045 7861  r only...    Exa
-00018c10: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00018c20: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00018c30: 6372 6561 7465 4461 7461 4672 616d 6528  createDataFrame(
-00018c40: 5b32 302c 2033 3135 3336 3030 3030 3030  [20, 31536000000
-00018c50: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
-00018c60: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00018c70: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
-00018c80: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
-00018c90: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00018ca0: 205b 526f 7728 544f 5f54 494d 4553 5441   [Row(TO_TIMESTA
-00018cb0: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
-00018cc0: 2e64 6174 6574 696d 6528 3139 3730 2c20  .datetime(1970, 
-00018cd0: 312c 2031 2c20 302c 2030 2c20 3230 2929  1, 1, 0, 0, 20))
-00018ce0: 2c20 526f 7728 544f 5f54 494d 4553 5441  , Row(TO_TIMESTA
-00018cf0: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
-00018d00: 2e64 6174 6574 696d 6528 3239 3639 2c20  .datetime(2969, 
-00018d10: 352c 2033 2c20 302c 2030 2929 5d0a 2020  5, 3, 0, 0))].  
-00018d20: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00018d30: 6563 7428 746f 5f74 696d 6573 7461 6d70  ect(to_timestamp
-00018d40: 2863 6f6c 2822 6122 292c 206c 6974 2839  (col("a"), lit(9
-00018d50: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
-00018d60: 2020 2020 2020 5b52 6f77 2854 4f5f 5449        [Row(TO_TI
-00018d70: 4d45 5354 414d 5028 2241 222c 2039 293d  MESTAMP("A", 9)=
-00018d80: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00018d90: 6528 3139 3730 2c20 312c 2031 2c20 302c  e(1970, 1, 1, 0,
-00018da0: 2030 2929 2c20 526f 7728 544f 5f54 494d   0)), Row(TO_TIM
-00018db0: 4553 5441 4d50 2822 4122 2c20 3929 3d64  ESTAMP("A", 9)=d
-00018dc0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00018dd0: 2831 3937 302c 2031 2c20 312c 2030 2c20  (1970, 1, 1, 0, 
-00018de0: 302c 2033 312c 2035 3336 3030 3029 295d  0, 31, 536000))]
-00018df0: 0a0a 2020 2020 4c61 7267 6572 206e 756d  ..    Larger num
-00018e00: 6265 7273 2073 746f 7265 6420 696e 2061  bers stored in a
-00018e10: 2073 7472 696e 6720 6361 6e20 6265 2061   string can be a
-00018e20: 6c73 6f20 636f 6e76 6572 7465 6420 7669  lso converted vi
-00018e30: 6120 7468 6973 2061 7070 726f 6163 680a  a this approach.
-00018e40: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-00018e50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00018e60: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
-00018e70: 7461 4672 616d 6528 5b27 3230 272c 2027  taFrame(['20', '
-00018e80: 3331 3533 3630 3030 3030 3027 2c20 2733  31536000000', '3
-00018e90: 3135 3336 3030 3030 3030 3030 3027 2c20  1536000000000', 
-00018ea0: 2733 3135 3336 3030 3030 3030 3030 3030  '315360000000000
-00018eb0: 3030 275d 2c20 7363 6865 6d61 3d5b 2761  00'], schema=['a
-00018ec0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-00018ed0: 6466 2e73 656c 6563 7428 746f 5f74 696d  df.select(to_tim
-00018ee0: 6573 7461 6d70 2863 6f6c 2822 6122 2929  estamp(col("a"))
-00018ef0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
-00018f00: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00018f10: 526f 7728 414e 533d 6461 7465 7469 6d65  Row(ANS=datetime
-00018f20: 2e64 6174 6574 696d 6528 3139 3730 2c20  .datetime(1970, 
-00018f30: 312c 2031 2c20 302c 2030 2c20 3230 2929  1, 1, 0, 0, 20))
-00018f40: 2c20 526f 7728 414e 533d 6461 7465 7469  , Row(ANS=dateti
-00018f50: 6d65 2e64 6174 6574 696d 6528 3139 3731  me.datetime(1971
-00018f60: 2c20 312c 2031 2c20 302c 2030 2929 2c20  , 1, 1, 0, 0)), 
-00018f70: 526f 7728 414e 533d 6461 7465 7469 6d65  Row(ANS=datetime
-00018f80: 2e64 6174 6574 696d 6528 3139 3731 2c20  .datetime(1971, 
-00018f90: 312c 2031 2c20 302c 2030 2929 2c20 526f  1, 1, 0, 0)), Ro
-00018fa0: 7728 414e 533d 6461 7465 7469 6d65 2e64  w(ANS=datetime.d
-00018fb0: 6174 6574 696d 6528 3139 3731 2c20 312c  atetime(1971, 1,
-00018fc0: 2031 2c20 302c 2030 2929 5d0a 2020 2020   1, 0, 0))].    
-00018fd0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-00018fe0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
-00018ff0: 6f5f 7469 6d65 7374 616d 7022 290a 2020  o_timestamp").  
-00019000: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00019010: 2020 2062 7569 6c74 696e 2822 746f 5f74     builtin("to_t
-00019020: 696d 6573 7461 6d70 2229 2863 2c20 666d  imestamp")(c, fm
-00019030: 7429 0a20 2020 2020 2020 2069 6620 666d  t).        if fm
-00019040: 7420 6973 206e 6f74 204e 6f6e 650a 2020  t is not None.  
-00019050: 2020 2020 2020 656c 7365 2062 7569 6c74        else built
-00019060: 696e 2822 746f 5f74 696d 6573 7461 6d70  in("to_timestamp
-00019070: 2229 2863 290a 2020 2020 290a 0a0a 6465  ")(c).    )...de
-00019080: 6620 746f 5f64 6174 6528 653a 2043 6f6c  f to_date(e: Col
-00019090: 756d 6e4f 724e 616d 652c 2066 6d74 3a20  umnOrName, fmt: 
-000190a0: 4f70 7469 6f6e 616c 5b22 436f 6c75 6d6e  Optional["Column
-000190b0: 225d 203d 204e 6f6e 6529 202d 3e20 436f  "] = None) -> Co
-000190c0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6e  lumn:.    """Con
-000190d0: 7665 7274 7320 616e 2069 6e70 7574 2065  verts an input e
-000190e0: 7870 7265 7373 696f 6e20 696e 746f 2061  xpression into a
-000190f0: 2064 6174 652e 0a0a 2020 2020 4578 616d   date...    Exam
-00019100: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00019110: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00019120: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00019130: 285b 2732 3031 332d 3035 2d31 3727 2c20  (['2013-05-17', 
-00019140: 2732 3031 332d 3035 2d31 3727 5d2c 2073  '2013-05-17'], s
-00019150: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-00019160: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00019170: 6374 2874 6f5f 6461 7465 2863 6f6c 2827  ct(to_date(col('
-00019180: 6127 2929 2e61 735f 2827 616e 7327 2929  a')).as_('ans'))
-00019190: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-000191a0: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
-000191b0: 7469 6d65 2e64 6174 6528 3230 3133 2c20  time.date(2013, 
-000191c0: 352c 2031 3729 292c 2052 6f77 2841 4e53  5, 17)), Row(ANS
-000191d0: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
-000191e0: 3031 332c 2035 2c20 3137 2929 5d0a 0a20  013, 5, 17))].. 
-000191f0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00019200: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00019210: 6174 6166 7261 6d65 285b 2733 3135 3336  ataframe(['31536
-00019220: 3030 3030 3030 3030 3027 2c20 2737 3135  000000000', '715
-00019230: 3336 3030 3430 3030 3030 3027 5d2c 2073  36004000000'], s
-00019240: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-00019250: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00019260: 6374 2874 6f5f 6461 7465 2863 6f6c 2827  ct(to_date(col('
-00019270: 6127 2929 2e61 735f 2827 616e 7327 2929  a')).as_('ans'))
-00019280: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00019290: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
-000192a0: 7469 6d65 2e64 6174 6528 3139 3731 2c20  time.date(1971, 
-000192b0: 312c 2031 2929 2c20 526f 7728 414e 533d  1, 1)), Row(ANS=
-000192c0: 6461 7465 7469 6d65 2e64 6174 6528 3139  datetime.date(19
-000192d0: 3732 2c20 342c 2037 2929 5d0a 0a20 2020  72, 4, 7))]..   
-000192e0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-000192f0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
-00019300: 746f 5f64 6174 6522 290a 2020 2020 7265  to_date").    re
-00019310: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
-00019320: 5f64 6174 6522 2928 632c 2066 6d74 2920  _date")(c, fmt) 
-00019330: 6966 2066 6d74 2069 7320 6e6f 7420 4e6f  if fmt is not No
-00019340: 6e65 2065 6c73 6520 6275 696c 7469 6e28  ne else builtin(
-00019350: 2274 6f5f 6461 7465 2229 2863 290a 0a0a  "to_date")(c)...
-00019360: 6465 6620 6375 7272 656e 745f 7469 6d65  def current_time
-00019370: 7374 616d 7028 2920 2d3e 2043 6f6c 756d  stamp() -> Colum
-00019380: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
-00019390: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
-000193a0: 6d65 7374 616d 7020 666f 7220 7468 6520  mestamp for the 
-000193b0: 7379 7374 656d 2e0a 0a20 2020 2045 7861  system...    Exa
-000193c0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-000193d0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
-000193e0: 650a 2020 2020 2020 2020 3e3e 3e20 7265  e.        >>> re
-000193f0: 7375 6c74 203d 2073 6573 7369 6f6e 2e63  sult = session.c
-00019400: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00019410: 5b31 5d29 2e73 656c 6563 7428 6375 7272  [1]).select(curr
-00019420: 656e 745f 7469 6d65 7374 616d 7028 2929  ent_timestamp())
-00019430: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00019440: 2020 203e 3e3e 2061 7373 6572 7420 6973     >>> assert is
-00019450: 696e 7374 616e 6365 2872 6573 756c 745b  instance(result[
-00019460: 305d 5b22 4355 5252 454e 545f 5449 4d45  0]["CURRENT_TIME
-00019470: 5354 414d 5028 2922 5d2c 2064 6174 6574  STAMP()"], datet
-00019480: 696d 652e 6461 7465 7469 6d65 290a 2020  ime.datetime).  
-00019490: 2020 2222 220a 0a20 2020 2072 6574 7572    """..    retur
-000194a0: 6e20 6275 696c 7469 6e28 2263 7572 7265  n builtin("curre
-000194b0: 6e74 5f74 696d 6573 7461 6d70 2229 2829  nt_timestamp")()
-000194c0: 0a0a 0a64 6566 2063 7572 7265 6e74 5f64  ...def current_d
-000194d0: 6174 6528 2920 2d3e 2043 6f6c 756d 6e3a  ate() -> Column:
-000194e0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-000194f0: 7468 6520 6375 7272 656e 7420 6461 7465  the current date
-00019500: 2066 6f72 2074 6865 2073 7973 7465 6d2e   for the system.
-00019510: 0a0a 2020 2020 4578 616d 706c 653a 0a20  ..    Example:. 
-00019520: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00019530: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
-00019540: 2020 203e 3e3e 2072 6573 756c 7420 3d20     >>> result = 
-00019550: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00019560: 6174 6166 7261 6d65 285b 315d 292e 7365  ataframe([1]).se
-00019570: 6c65 6374 2863 7572 7265 6e74 5f64 6174  lect(current_dat
-00019580: 6528 2929 2e63 6f6c 6c65 6374 2829 0a20  e()).collect(). 
-00019590: 2020 2020 2020 203e 3e3e 2061 7373 6572         >>> asser
-000195a0: 7420 6973 696e 7374 616e 6365 2872 6573  t isinstance(res
-000195b0: 756c 745b 305d 5b22 4355 5252 454e 545f  ult[0]["CURRENT_
-000195c0: 4441 5445 2829 225d 2c20 6461 7465 7469  DATE()"], dateti
-000195d0: 6d65 2e64 6174 6529 0a20 2020 2022 2222  me.date).    """
-000195e0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-000195f0: 7469 6e28 2263 7572 7265 6e74 5f64 6174  tin("current_dat
-00019600: 6522 2928 290a 0a0a 6465 6620 6375 7272  e")()...def curr
-00019610: 656e 745f 7469 6d65 2829 202d 3e20 436f  ent_time() -> Co
-00019620: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00019630: 7572 6e73 2074 6865 2063 7572 7265 6e74  urns the current
-00019640: 2074 696d 6520 666f 7220 7468 6520 7379   time for the sy
-00019650: 7374 656d 2e0a 0a20 2020 2045 7861 6d70  stem...    Examp
-00019660: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-00019670: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-00019680: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
-00019690: 6c74 203d 2073 6573 7369 6f6e 2e63 7265  lt = session.cre
-000196a0: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-000196b0: 5d29 2e73 656c 6563 7428 6375 7272 656e  ]).select(curren
-000196c0: 745f 7469 6d65 2829 292e 636f 6c6c 6563  t_time()).collec
-000196d0: 7428 290a 2020 2020 2020 2020 3e3e 3e20  t().        >>> 
-000196e0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
-000196f0: 6528 7265 7375 6c74 5b30 5d5b 2243 5552  e(result[0]["CUR
-00019700: 5245 4e54 5f54 494d 4528 2922 5d2c 2064  RENT_TIME()"], d
-00019710: 6174 6574 696d 652e 7469 6d65 290a 2020  atetime.time).  
-00019720: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00019730: 2062 7569 6c74 696e 2822 6375 7272 656e   builtin("curren
-00019740: 745f 7469 6d65 2229 2829 0a0a 0a64 6566  t_time")()...def
-00019750: 2068 6f75 7228 653a 2043 6f6c 756d 6e4f   hour(e: ColumnO
-00019760: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00019770: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
-00019780: 7472 6163 7473 2074 6865 2068 6f75 7220  tracts the hour 
-00019790: 6672 6f6d 2061 2064 6174 6520 6f72 2074  from a date or t
-000197a0: 696d 6573 7461 6d70 2e0a 0a20 2020 2045  imestamp...    E
-000197b0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-000197c0: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-000197d0: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
-000197e0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000197f0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00019800: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
-00019810: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
-00019820: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-00019830: 3230 2d30 352d 3031 2031 333a 3131 3a32  20-05-01 13:11:2
-00019840: 302e 3030 3022 2c20 2225 592d 256d 2d25  0.000", "%Y-%m-%
-00019850: 6420 2548 3a25 4d3a 2553 2e25 6622 292c  d %H:%M:%S.%f"),
-00019860: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00019870: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-00019880: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
-00019890: 302d 3038 2d32 3120 3031 3a33 303a 3035  0-08-21 01:30:05
-000198a0: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
-000198b0: 2025 483a 254d 3a25 532e 2566 2229 0a20   %H:%M:%S.%f"). 
-000198c0: 2020 2020 2020 202e 2e2e 205d 2c20 7363         ... ], sc
-000198d0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-000198e0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-000198f0: 7428 686f 7572 2822 6122 2929 2e63 6f6c  t(hour("a")).col
-00019900: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00019910: 526f 7728 484f 5552 2822 4122 293d 3133  Row(HOUR("A")=13
-00019920: 292c 2052 6f77 2848 4f55 5228 2241 2229  ), Row(HOUR("A")
-00019930: 3d31 295d 0a20 2020 2022 2222 0a20 2020  =1)].    """.   
-00019940: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00019950: 7374 7228 652c 2022 686f 7572 2229 0a20  str(e, "hour"). 
-00019960: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00019970: 6e28 2268 6f75 7222 2928 6329 0a0a 0a64  n("hour")(c)...d
-00019980: 6566 206c 6173 745f 6461 7928 653a 2043  ef last_day(e: C
-00019990: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-000199a0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-000199b0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-000199c0: 6c61 7374 2064 6179 206f 6620 7468 6520  last day of the 
-000199d0: 7370 6563 6966 6965 6420 6461 7465 2070  specified date p
-000199e0: 6172 7420 666f 7220 6120 6461 7465 206f  art for a date o
-000199f0: 7220 7469 6d65 7374 616d 702e 0a20 2020  r timestamp..   
-00019a00: 2043 6f6d 6d6f 6e6c 7920 7573 6564 2074   Commonly used t
-00019a10: 6f20 7265 7475 726e 2074 6865 206c 6173  o return the las
-00019a20: 7420 6461 7920 6f66 2074 6865 206d 6f6e  t day of the mon
-00019a30: 7468 2066 6f72 2061 2064 6174 6520 6f72  th for a date or
-00019a40: 2074 696d 6573 7461 6d70 2e0a 0a20 2020   timestamp...   
-00019a50: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00019a60: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00019a70: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
-00019a80: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00019a90: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00019aa0: 6528 5b0a 2020 2020 2020 2020 2e2e 2e20  e([.        ... 
-00019ab0: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
-00019ac0: 6574 696d 652e 7374 7270 7469 6d65 2822  etime.strptime("
-00019ad0: 3230 3230 2d30 352d 3031 2031 333a 3131  2020-05-01 13:11
-00019ae0: 3a32 302e 3030 3022 2c20 2225 592d 256d  :20.000", "%Y-%m
-00019af0: 2d25 6420 2548 3a25 4d3a 2553 2e25 6622  -%d %H:%M:%S.%f"
-00019b00: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
-00019b10: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
-00019b20: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
-00019b30: 3032 302d 3038 2d32 3120 3031 3a33 303a  020-08-21 01:30:
-00019b40: 3035 2e30 3030 222c 2022 2559 2d25 6d2d  05.000", "%Y-%m-
-00019b50: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
-00019b60: 0a20 2020 2020 2020 202e 2e2e 205d 2c20  .        ... ], 
-00019b70: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00019b80: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00019b90: 6563 7428 6c61 7374 5f64 6179 2822 6122  ect(last_day("a"
-00019ba0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00019bb0: 2020 2020 205b 526f 7728 4c41 5354 5f44       [Row(LAST_D
-00019bc0: 4159 2822 4122 293d 6461 7465 7469 6d65  AY("A")=datetime
-00019bd0: 2e64 6174 6528 3230 3230 2c20 352c 2033  .date(2020, 5, 3
-00019be0: 3129 292c 2052 6f77 284c 4153 545f 4441  1)), Row(LAST_DA
-00019bf0: 5928 2241 2229 3d64 6174 6574 696d 652e  Y("A")=datetime.
-00019c00: 6461 7465 2832 3032 302c 2038 2c20 3331  date(2020, 8, 31
-00019c10: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-00019c20: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00019c30: 7472 2865 2c20 226c 6173 745f 6461 7922  tr(e, "last_day"
-00019c40: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00019c50: 6c74 696e 2822 6c61 7374 5f64 6179 2229  ltin("last_day")
-00019c60: 2863 290a 0a0a 6465 6620 6d69 6e75 7465  (c)...def minute
-00019c70: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00019c80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00019c90: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
-00019ca0: 7320 7468 6520 6d69 6e75 7465 2066 726f  s the minute fro
-00019cb0: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
-00019cc0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
-00019cd0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00019ce0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00019cf0: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-00019d00: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00019d10: 7465 5f64 6174 6166 7261 6d65 285b 0a20  te_dataframe([. 
-00019d20: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-00019d30: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00019d40: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
-00019d50: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
-00019d60: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
-00019d70: 483a 254d 3a25 532e 2566 2229 2c0a 2020  H:%M:%S.%f"),.  
-00019d80: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
-00019d90: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
-00019da0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
-00019db0: 382d 3231 2030 313a 3330 3a30 352e 3030  8-21 01:30:05.00
-00019dc0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
-00019dd0: 3a25 4d3a 2553 2e25 6622 290a 2020 2020  :%M:%S.%f").    
-00019de0: 2020 2020 2e2e 2e20 5d2c 2073 6368 656d      ... ], schem
-00019df0: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00019e00: 203e 3e3e 2064 662e 7365 6c65 6374 286d   >>> df.select(m
-00019e10: 696e 7574 6528 2261 2229 292e 636f 6c6c  inute("a")).coll
-00019e20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00019e30: 6f77 284d 494e 5554 4528 2241 2229 3d31  ow(MINUTE("A")=1
-00019e40: 3129 2c20 526f 7728 4d49 4e55 5445 2822  1), Row(MINUTE("
-00019e50: 4122 293d 3330 295d 0a20 2020 2022 2222  A")=30)].    """
-00019e60: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00019e70: 5f69 665f 7374 7228 652c 2022 6d69 6e75  _if_str(e, "minu
-00019e80: 7465 2229 0a20 2020 2072 6574 7572 6e20  te").    return 
-00019e90: 6275 696c 7469 6e28 226d 696e 7574 6522  builtin("minute"
-00019ea0: 2928 6329 0a0a 0a64 6566 206e 6578 745f  )(c)...def next_
-00019eb0: 6461 7928 6461 7465 3a20 436f 6c75 6d6e  day(date: Column
-00019ec0: 4f72 4e61 6d65 2c20 6461 795f 6f66 5f77  OrName, day_of_w
-00019ed0: 6565 6b3a 2043 6f6c 756d 6e4f 724c 6974  eek: ColumnOrLit
-00019ee0: 6572 616c 2920 2d3e 2043 6f6c 756d 6e3a  eral) -> Column:
-00019ef0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
-00019f00: 7572 6e73 2074 6865 2064 6174 6520 6f66  urns the date of
-00019f10: 2074 6865 2066 6972 7374 2073 7065 6369   the first speci
-00019f20: 6669 6564 2044 4f57 2028 6461 7920 6f66  fied DOW (day of
-00019f30: 2077 6565 6b29 2074 6861 7420 6f63 6375   week) that occu
-00019f40: 7273 2061 6674 6572 2074 6865 2069 6e70  rs after the inp
-00019f50: 7574 2064 6174 652e 0a0a 2020 2020 4578  ut date...    Ex
-00019f60: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00019f70: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
-00019f80: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
-00019f90: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00019fa0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00019fb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00019fc0: 2028 6461 7465 7469 6d65 2e64 6174 652e   (datetime.date.
-00019fd0: 6672 6f6d 6973 6f66 6f72 6d61 7428 2232  fromisoformat("2
-00019fe0: 3032 302d 3038 2d30 3122 292c 2022 6d6f  020-08-01"), "mo
-00019ff0: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-0001a000: 2020 2020 2864 6174 6574 696d 652e 6461      (datetime.da
-0001a010: 7465 2e66 726f 6d69 736f 666f 726d 6174  te.fromisoformat
-0001a020: 2822 3230 3230 2d31 322d 3031 2229 2c20  ("2020-12-01"), 
-0001a030: 2277 6522 292c 0a20 2020 2020 2020 202e  "we"),.        .
-0001a040: 2e2e 205d 2c20 7363 6865 6d61 3d5b 2261  .. ], schema=["a
-0001a050: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-0001a060: 203e 3e3e 2064 662e 7365 6c65 6374 286e   >>> df.select(n
-0001a070: 6578 745f 6461 7928 2261 222c 2063 6f6c  ext_day("a", col
-0001a080: 2822 6222 2929 292e 636f 6c6c 6563 7428  ("b"))).collect(
-0001a090: 290a 2020 2020 2020 2020 5b52 6f77 284e  ).        [Row(N
-0001a0a0: 4558 545f 4441 5928 2241 222c 2022 4222  EXT_DAY("A", "B"
-0001a0b0: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
-0001a0c0: 3230 3230 2c20 382c 2033 2929 2c20 526f  2020, 8, 3)), Ro
-0001a0d0: 7728 4e45 5854 5f44 4159 2822 4122 2c20  w(NEXT_DAY("A", 
-0001a0e0: 2242 2229 3d64 6174 6574 696d 652e 6461  "B")=datetime.da
-0001a0f0: 7465 2832 3032 302c 2031 322c 2032 2929  te(2020, 12, 2))
-0001a100: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-0001a110: 2e73 656c 6563 7428 6e65 7874 5f64 6179  .select(next_day
-0001a120: 2822 6122 2c20 2266 7222 2929 2e63 6f6c  ("a", "fr")).col
-0001a130: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0001a140: 526f 7728 4e45 5854 5f44 4159 2822 4122  Row(NEXT_DAY("A"
-0001a150: 2c20 2746 5227 293d 6461 7465 7469 6d65  , 'FR')=datetime
-0001a160: 2e64 6174 6528 3230 3230 2c20 382c 2037  .date(2020, 8, 7
-0001a170: 2929 2c20 526f 7728 4e45 5854 5f44 4159  )), Row(NEXT_DAY
-0001a180: 2822 4122 2c20 2746 5227 293d 6461 7465  ("A", 'FR')=date
-0001a190: 7469 6d65 2e64 6174 6528 3230 3230 2c20  time.date(2020, 
-0001a1a0: 3132 2c20 3429 295d 0a20 2020 2022 2222  12, 4))].    """
-0001a1b0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0001a1c0: 5f69 665f 7374 7228 6461 7465 2c20 226e  _if_str(date, "n
-0001a1d0: 6578 745f 6461 7922 290a 2020 2020 7265  ext_day").    re
-0001a1e0: 7475 726e 2062 7569 6c74 696e 2822 6e65  turn builtin("ne
-0001a1f0: 7874 5f64 6179 2229 2863 2c20 436f 6c75  xt_day")(c, Colu
-0001a200: 6d6e 2e5f 746f 5f65 7870 7228 6461 795f  mn._to_expr(day_
-0001a210: 6f66 5f77 6565 6b29 290a 0a0a 6465 6620  of_week))...def 
-0001a220: 7072 6576 696f 7573 5f64 6179 2864 6174  previous_day(dat
-0001a230: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
-0001a240: 2064 6179 5f6f 665f 7765 656b 3a20 436f   day_of_week: Co
-0001a250: 6c75 6d6e 4f72 4c69 7465 7261 6c29 202d  lumnOrLiteral) -
-0001a260: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0001a270: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
-0001a280: 6520 6461 7465 206f 6620 7468 6520 6669  e date of the fi
-0001a290: 7273 7420 7370 6563 6966 6965 6420 444f  rst specified DO
-0001a2a0: 5720 2864 6179 206f 6620 7765 656b 2920  W (day of week) 
-0001a2b0: 7468 6174 206f 6363 7572 7320 6265 666f  that occurs befo
-0001a2c0: 7265 2074 6865 2069 6e70 7574 2064 6174  re the input dat
-0001a2d0: 652e 0a0a 2020 2020 4578 616d 706c 653a  e...    Example:
-0001a2e0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-0001a2f0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-0001a300: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001a310: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001a320: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-0001a330: 2020 202e 2e2e 2020 2020 2028 6461 7465     ...     (date
-0001a340: 7469 6d65 2e64 6174 652e 6672 6f6d 6973  time.date.fromis
-0001a350: 6f66 6f72 6d61 7428 2232 3032 302d 3038  oformat("2020-08
-0001a360: 2d30 3122 292c 2022 6d6f 2229 2c0a 2020  -01"), "mo"),.  
-0001a370: 2020 2020 2020 2e2e 2e20 2020 2020 2864        ...     (d
-0001a380: 6174 6574 696d 652e 6461 7465 2e66 726f  atetime.date.fro
-0001a390: 6d69 736f 666f 726d 6174 2822 3230 3230  misoformat("2020
-0001a3a0: 2d31 322d 3031 2229 2c20 2277 6522 292c  -12-01"), "we"),
-0001a3b0: 0a20 2020 2020 2020 202e 2e2e 205d 2c20  .        ... ], 
-0001a3c0: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
-0001a3d0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0001a3e0: 662e 7365 6c65 6374 2870 7265 7669 6f75  f.select(previou
-0001a3f0: 735f 6461 7928 2261 222c 2063 6f6c 2822  s_day("a", col("
-0001a400: 6222 2929 292e 636f 6c6c 6563 7428 290a  b"))).collect().
-0001a410: 2020 2020 2020 2020 5b52 6f77 2850 5245          [Row(PRE
-0001a420: 5649 4f55 535f 4441 5928 2241 222c 2022  VIOUS_DAY("A", "
-0001a430: 4222 293d 6461 7465 7469 6d65 2e64 6174  B")=datetime.dat
-0001a440: 6528 3230 3230 2c20 372c 2032 3729 292c  e(2020, 7, 27)),
-0001a450: 2052 6f77 2850 5245 5649 4f55 535f 4441   Row(PREVIOUS_DA
-0001a460: 5928 2241 222c 2022 4222 293d 6461 7465  Y("A", "B")=date
-0001a470: 7469 6d65 2e64 6174 6528 3230 3230 2c20  time.date(2020, 
-0001a480: 3131 2c20 3235 2929 5d0a 2020 2020 2020  11, 25))].      
-0001a490: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001a4a0: 7072 6576 696f 7573 5f64 6179 2822 6122  previous_day("a"
-0001a4b0: 2c20 2266 7222 2929 2e63 6f6c 6c65 6374  , "fr")).collect
-0001a4c0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0001a4d0: 5052 4556 494f 5553 5f44 4159 2822 4122  PREVIOUS_DAY("A"
-0001a4e0: 2c20 2746 5227 293d 6461 7465 7469 6d65  , 'FR')=datetime
-0001a4f0: 2e64 6174 6528 3230 3230 2c20 372c 2033  .date(2020, 7, 3
-0001a500: 3129 292c 2052 6f77 2850 5245 5649 4f55  1)), Row(PREVIOU
-0001a510: 535f 4441 5928 2241 222c 2027 4652 2729  S_DAY("A", 'FR')
-0001a520: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
-0001a530: 3032 302c 2031 312c 2032 3729 295d 0a20  020, 11, 27))]. 
-0001a540: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0001a550: 746f 5f63 6f6c 5f69 665f 7374 7228 6461  to_col_if_str(da
-0001a560: 7465 2c20 2270 7265 7669 6f75 735f 6461  te, "previous_da
-0001a570: 7922 290a 2020 2020 7265 7475 726e 2062  y").    return b
-0001a580: 7569 6c74 696e 2822 7072 6576 696f 7573  uiltin("previous
-0001a590: 5f64 6179 2229 2863 2c20 436f 6c75 6d6e  _day")(c, Column
-0001a5a0: 2e5f 746f 5f65 7870 7228 6461 795f 6f66  ._to_expr(day_of
-0001a5b0: 5f77 6565 6b29 290a 0a0a 6465 6620 7365  _week))...def se
-0001a5c0: 636f 6e64 2865 3a20 436f 6c75 6d6e 4f72  cond(e: ColumnOr
-0001a5d0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0001a5e0: 0a20 2020 2022 2222 0a20 2020 2045 7874  .    """.    Ext
-0001a5f0: 7261 6374 7320 7468 6520 7365 636f 6e64  racts the second
-0001a600: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
-0001a610: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
-0001a620: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0001a630: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0001a640: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-0001a650: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001a660: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0001a670: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
-0001a680: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
-0001a690: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
-0001a6a0: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
-0001a6b0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
-0001a6c0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
-0001a6d0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0001a6e0: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
-0001a6f0: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-0001a700: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
-0001a710: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
-0001a720: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
-0001a730: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
-0001a740: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0001a750: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001a760: 6374 2873 6563 6f6e 6428 2261 2229 292e  ct(second("a")).
-0001a770: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0001a780: 2020 5b52 6f77 2853 4543 4f4e 4428 2241    [Row(SECOND("A
-0001a790: 2229 3d32 3029 2c20 526f 7728 5345 434f  ")=20), Row(SECO
-0001a7a0: 4e44 2822 4122 293d 3529 5d0a 2020 2020  ND("A")=5)].    
-0001a7b0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0001a7c0: 636f 6c5f 6966 5f73 7472 2865 2c20 2273  col_if_str(e, "s
-0001a7d0: 6563 6f6e 6422 290a 2020 2020 7265 7475  econd").    retu
-0001a7e0: 726e 2062 7569 6c74 696e 2822 7365 636f  rn builtin("seco
-0001a7f0: 6e64 2229 2863 290a 0a0a 6465 6620 6d6f  nd")(c)...def mo
-0001a800: 6e74 6828 653a 2043 6f6c 756d 6e4f 724e  nth(e: ColumnOrN
-0001a810: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001a820: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
-0001a830: 6163 7473 2074 6865 206d 6f6e 7468 2066  acts the month f
-0001a840: 726f 6d20 6120 6461 7465 206f 7220 7469  rom a date or ti
-0001a850: 6d65 7374 616d 702e 0a0a 2020 2020 4578  mestamp...    Ex
-0001a860: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0001a870: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
-0001a880: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
-0001a890: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0001a8a0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0001a8b0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0001a8c0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-0001a8d0: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
-0001a8e0: 302d 3035 2d30 3120 3133 3a31 313a 3230  0-05-01 13:11:20
-0001a8f0: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
-0001a900: 2025 483a 254d 3a25 532e 2566 2229 2c0a   %H:%M:%S.%f"),.
-0001a910: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001a920: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-0001a930: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-0001a940: 2d30 382d 3231 2030 313a 3330 3a30 352e  -08-21 01:30:05.
-0001a950: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-0001a960: 2548 3a25 4d3a 2553 2e25 6622 290a 2020  %H:%M:%S.%f").  
-0001a970: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
-0001a980: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
-0001a990: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001a9a0: 286d 6f6e 7468 2822 6122 2929 2e63 6f6c  (month("a")).col
-0001a9b0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0001a9c0: 526f 7728 4d4f 4e54 4828 2241 2229 3d35  Row(MONTH("A")=5
-0001a9d0: 292c 2052 6f77 284d 4f4e 5448 2822 4122  ), Row(MONTH("A"
-0001a9e0: 293d 3829 5d0a 2020 2020 2222 220a 2020  )=8)].    """.  
-0001a9f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0001aa00: 5f73 7472 2865 2c20 226d 6f6e 7468 2229  _str(e, "month")
-0001aa10: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001aa20: 7469 6e28 226d 6f6e 7468 2229 2863 290a  tin("month")(c).
-0001aa30: 0a0a 6465 6620 6d6f 6e74 686e 616d 6528  ..def monthname(
-0001aa40: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0001aa50: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0001aa60: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
-0001aa70: 2074 6865 2074 6872 6565 2d6c 6574 7465   the three-lette
-0001aa80: 7220 6d6f 6e74 6820 6e61 6d65 2066 726f  r month name fro
-0001aa90: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
-0001aaa0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-0001aab0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-0001aac0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-0001aad0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
-0001aae0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001aaf0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0001ab00: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
-0001ab10: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
-0001ab20: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-0001ab30: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-0001ab40: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-0001ab50: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-0001ab60: 3a25 532e 2566 2229 2c0a 2020 2020 2020  :%S.%f"),.      
-0001ab70: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
-0001ab80: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-0001ab90: 7469 6d65 2822 3230 3230 2d30 382d 3231  time("2020-08-21
-0001aba0: 2030 313a 3330 3a30 352e 3030 3022 2c20   01:30:05.000", 
-0001abb0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-0001abc0: 2553 2e25 6622 290a 2020 2020 2020 2020  %S.%f").        
-0001abd0: 2e2e 2e20 5d2c 2073 6368 656d 613d 5b22  ... ], schema=["
-0001abe0: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
-0001abf0: 2064 662e 7365 6c65 6374 286d 6f6e 7468   df.select(month
-0001ac00: 6e61 6d65 2822 6122 2929 2e63 6f6c 6c65  name("a")).colle
-0001ac10: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0001ac20: 7728 4d4f 4e54 484e 414d 4528 2241 2229  w(MONTHNAME("A")
-0001ac30: 3d27 4d61 7927 292c 2052 6f77 284d 4f4e  ='May'), Row(MON
-0001ac40: 5448 4e41 4d45 2822 4122 293d 2741 7567  THNAME("A")='Aug
-0001ac50: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
-0001ac60: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0001ac70: 7472 2865 2c20 226d 6f6e 7468 6e61 6d65  tr(e, "monthname
-0001ac80: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-0001ac90: 696c 7469 6e28 226d 6f6e 7468 6e61 6d65  iltin("monthname
-0001aca0: 2229 2863 290a 0a0a 6465 6620 7175 6172  ")(c)...def quar
-0001acb0: 7465 7228 653a 2043 6f6c 756d 6e4f 724e  ter(e: ColumnOrN
-0001acc0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001acd0: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
-0001ace0: 6163 7473 2074 6865 2071 7561 7274 6572  acts the quarter
-0001acf0: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
-0001ad00: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
-0001ad10: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0001ad20: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0001ad30: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-0001ad40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001ad50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0001ad60: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
-0001ad70: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
-0001ad80: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
-0001ad90: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
-0001ada0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
-0001adb0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
-0001adc0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0001add0: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
-0001ade0: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-0001adf0: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
-0001ae00: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
-0001ae10: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
-0001ae20: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
-0001ae30: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0001ae40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001ae50: 6374 2871 7561 7274 6572 2822 6122 2929  ct(quarter("a"))
-0001ae60: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001ae70: 2020 205b 526f 7728 5155 4152 5445 5228     [Row(QUARTER(
-0001ae80: 2241 2229 3d32 292c 2052 6f77 2851 5541  "A")=2), Row(QUA
-0001ae90: 5254 4552 2822 4122 293d 3329 5d0a 2020  RTER("A")=3)].  
-0001aea0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0001aeb0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0001aec0: 2271 7561 7274 6572 2229 0a20 2020 2072  "quarter").    r
-0001aed0: 6574 7572 6e20 6275 696c 7469 6e28 2271  eturn builtin("q
-0001aee0: 7561 7274 6572 2229 2863 290a 0a0a 6465  uarter")(c)...de
-0001aef0: 6620 7965 6172 2865 3a20 436f 6c75 6d6e  f year(e: Column
-0001af00: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0001af10: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
-0001af20: 7874 7261 6374 7320 7468 6520 7965 6172  xtracts the year
-0001af30: 2066 726f 6d20 6120 6461 7465 206f 7220   from a date or 
-0001af40: 7469 6d65 7374 616d 702e 0a0a 2020 2020  timestamp...    
-0001af50: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0001af60: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0001af70: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
-0001af80: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001af90: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0001afa0: 285b 0a20 2020 2020 2020 202e 2e2e 2020  ([.        ...  
-0001afb0: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
-0001afc0: 7469 6d65 2e73 7472 7074 696d 6528 2232  time.strptime("2
-0001afd0: 3032 302d 3035 2d30 3120 3133 3a31 313a  020-05-01 13:11:
-0001afe0: 3230 2e30 3030 222c 2022 2559 2d25 6d2d  20.000", "%Y-%m-
-0001aff0: 2564 2025 483a 254d 3a25 532e 2566 2229  %d %H:%M:%S.%f")
-0001b000: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0001b010: 2020 6461 7465 7469 6d65 2e64 6174 6574    datetime.datet
-0001b020: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-0001b030: 3230 2d30 382d 3231 2030 313a 3330 3a30  20-08-21 01:30:0
-0001b040: 352e 3030 3022 2c20 2225 592d 256d 2d25  5.000", "%Y-%m-%
-0001b050: 6420 2548 3a25 4d3a 2553 2e25 6622 290a  d %H:%M:%S.%f").
-0001b060: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
-0001b070: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0001b080: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001b090: 6374 2879 6561 7228 2261 2229 292e 636f  ct(year("a")).co
-0001b0a0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001b0b0: 5b52 6f77 2859 4541 5228 2241 2229 3d32  [Row(YEAR("A")=2
-0001b0c0: 3032 3029 2c20 526f 7728 5945 4152 2822  020), Row(YEAR("
-0001b0d0: 4122 293d 3230 3230 295d 0a20 2020 2022  A")=2020)].    "
-0001b0e0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001b0f0: 6f6c 5f69 665f 7374 7228 652c 2022 7965  ol_if_str(e, "ye
-0001b100: 6172 2229 0a20 2020 2072 6574 7572 6e20  ar").    return 
-0001b110: 6275 696c 7469 6e28 2279 6561 7222 2928  builtin("year")(
-0001b120: 6329 0a0a 0a64 6566 2073 7973 6461 7465  c)...def sysdate
-0001b130: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-0001b140: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-0001b150: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
-0001b160: 6d65 7374 616d 7020 666f 7220 7468 6520  mestamp for the 
-0001b170: 7379 7374 656d 2c20 6275 7420 696e 2074  system, but in t
-0001b180: 6865 2055 5443 2074 696d 6520 7a6f 6e65  he UTC time zone
-0001b190: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0001b1a0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0001b1b0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0001b1c0: 655f 6461 7461 6672 616d 6528 5b31 5d2c  e_dataframe([1],
-0001b1d0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0001b1e0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001b1f0: 6c65 6374 2873 7973 6461 7465 2829 292e  lect(sysdate()).
-0001b200: 636f 6c6c 6563 7428 2920 6973 206e 6f74  collect() is not
-0001b210: 204e 6f6e 650a 2020 2020 2020 2020 5472   None.        Tr
-0001b220: 7565 0a20 2020 2022 2222 0a20 2020 2072  ue.    """.    r
-0001b230: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
-0001b240: 7973 6461 7465 2229 2829 0a0a 0a64 6566  ysdate")()...def
-0001b250: 206d 6f6e 7468 735f 6265 7477 6565 6e28   months_between(
-0001b260: 6461 7465 313a 2043 6f6c 756d 6e4f 724e  date1: ColumnOrN
-0001b270: 616d 652c 2064 6174 6532 3a20 436f 6c75  ame, date2: Colu
-0001b280: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0001b290: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0001b2a0: 2052 6574 7572 6e73 2074 6865 206e 756d   Returns the num
-0001b2b0: 6265 7220 6f66 206d 6f6e 7468 7320 6265  ber of months be
-0001b2c0: 7477 6565 6e20 7477 6f20 4441 5445 206f  tween two DATE o
-0001b2d0: 7220 5449 4d45 5354 414d 5020 7661 6c75  r TIMESTAMP valu
-0001b2e0: 6573 2e0a 0a20 2020 2045 7861 6d70 6c65  es...    Example
-0001b2f0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001b300: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001b310: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001b320: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0001b330: 6461 7461 6672 616d 6528 5b5b 0a20 2020  dataframe([[.   
-0001b340: 2020 2020 202e 2e2e 2020 2020 2064 6174       ...     dat
-0001b350: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
-0001b360: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
-0001b370: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
-0001b380: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
-0001b390: 254d 3a25 532e 2566 2229 2c0a 2020 2020  %M:%S.%f"),.    
-0001b3a0: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
-0001b3b0: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
-0001b3c0: 7270 7469 6d65 2822 3230 3230 2d30 382d  rptime("2020-08-
-0001b3d0: 3231 2030 313a 3330 3a30 352e 3030 3022  21 01:30:05.000"
-0001b3e0: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
-0001b3f0: 4d3a 2553 2e25 6622 290a 2020 2020 2020  M:%S.%f").      
-0001b400: 2020 2e2e 2e20 5d5d 2c20 7363 6865 6d61    ... ]], schema
-0001b410: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
-0001b420: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0001b430: 6374 286d 6f6e 7468 735f 6265 7477 6565  ct(months_betwee
-0001b440: 6e28 2261 222c 2022 6222 2929 2e63 6f6c  n("a", "b")).col
-0001b450: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0001b460: 526f 7728 4d4f 4e54 4853 5f42 4554 5745  Row(MONTHS_BETWE
-0001b470: 454e 2822 4122 2c20 2242 2229 3d44 6563  EN("A", "B")=Dec
-0001b480: 696d 616c 2827 2d33 2e36 3239 3435 3227  imal('-3.629452'
-0001b490: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-0001b4a0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-0001b4b0: 7374 7228 6461 7465 312c 2022 6d6f 6e74  str(date1, "mont
-0001b4c0: 6873 5f62 6574 7765 656e 2229 0a20 2020  hs_between").   
-0001b4d0: 2063 3220 3d20 5f74 6f5f 636f 6c5f 6966   c2 = _to_col_if
-0001b4e0: 5f73 7472 2864 6174 6532 2c20 226d 6f6e  _str(date2, "mon
-0001b4f0: 7468 735f 6265 7477 6565 6e22 290a 2020  ths_between").  
-0001b500: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001b510: 2822 6d6f 6e74 6873 5f62 6574 7765 656e  ("months_between
-0001b520: 2229 2863 312c 2063 3229 0a0a 0a64 6566  ")(c1, c2)...def
-0001b530: 2074 6f5f 6765 6f67 7261 7068 7928 653a   to_geography(e:
-0001b540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0001b550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0001b560: 2250 6172 7365 7320 616e 2069 6e70 7574  "Parses an input
-0001b570: 2061 6e64 2072 6574 7572 6e73 2061 2076   and returns a v
-0001b580: 616c 7565 206f 6620 7479 7065 2047 454f  alue of type GEO
-0001b590: 4752 4150 4859 2e20 5375 7070 6f72 7465  GRAPHY. Supporte
-0001b5a0: 6420 696e 7075 7473 2061 7265 2073 7472  d inputs are str
-0001b5b0: 696e 6773 2069 6e0a 0a20 2020 2020 2020  ings in..       
-0001b5c0: 202d 2057 4b54 2028 7765 6c6c 2d6b 6e6f   - WKT (well-kno
-0001b5d0: 776e 2074 6578 7429 2e0a 2020 2020 2020  wn text)..      
-0001b5e0: 2020 2d20 574b 4220 2877 656c 6c2d 6b6e    - WKB (well-kn
-0001b5f0: 6f77 6e20 6269 6e61 7279 2920 696e 2068  own binary) in h
-0001b600: 6578 6164 6563 696d 616c 2066 6f72 6d61  exadecimal forma
-0001b610: 7420 2877 6974 686f 7574 2061 206c 6561  t (without a lea
-0001b620: 6469 6e67 2030 7829 2e0a 2020 2020 2020  ding 0x)..      
-0001b630: 2020 2d20 4557 4b54 2028 6578 7465 6e64    - EWKT (extend
-0001b640: 6564 2077 656c 6c2d 6b6e 6f77 6e20 7465  ed well-known te
-0001b650: 7874 292e 0a20 2020 2020 2020 202d 2045  xt)..        - E
-0001b660: 574b 4220 2865 7874 656e 6465 6420 7765  WKB (extended we
-0001b670: 6c6c 2d6b 6e6f 776e 2062 696e 6172 7929  ll-known binary)
-0001b680: 2069 6e20 6865 7861 6465 6369 6d61 6c20   in hexadecimal 
-0001b690: 666f 726d 6174 2028 7769 7468 6f75 7420  format (without 
-0001b6a0: 6120 6c65 6164 696e 6720 3078 292e 0a20  a leading 0x).. 
-0001b6b0: 2020 2020 2020 202d 2047 656f 4a53 4f4e         - GeoJSON
-0001b6c0: 2e0a 0a20 2020 2066 6f72 6d61 742e 0a0a  ...    format...
-0001b6d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0001b6e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0001b6f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001b700: 7461 6672 616d 6528 5b27 504f 494e 5428  taframe(['POINT(
-0001b710: 2d31 3232 2e33 3520 3337 2e35 3529 272c  -122.35 37.55)',
-0001b720: 2027 504f 494e 5428 3230 2e39 3220 3433   'POINT(20.92 43
-0001b730: 2e33 3329 275d 2c20 7363 6865 6d61 3d5b  .33)'], schema=[
-0001b740: 2761 275d 290a 2020 2020 2020 2020 3e3e  'a']).        >>
-0001b750: 3e20 6466 2e73 656c 6563 7428 746f 5f67  > df.select(to_g
-0001b760: 656f 6772 6170 6879 2863 6f6c 2822 6122  eography(col("a"
-0001b770: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
-0001b780: 2020 2020 2020 5b52 6f77 2854 4f5f 4745        [Row(TO_GE
-0001b790: 4f47 5241 5048 5928 2241 2229 3d27 7b5c  OGRAPHY("A")='{\
-0001b7a0: 5c6e 2020 2263 6f6f 7264 696e 6174 6573  \n  "coordinates
-0001b7b0: 223a 205b 5c5c 6e20 2020 202d 3132 322e  ": [\\n    -122.
-0001b7c0: 3335 2c5c 5c6e 2020 2020 3337 2e35 355c  35,\\n    37.55\
-0001b7d0: 5c6e 2020 5d2c 5c5c 6e20 2022 7479 7065  \n  ],\\n  "type
-0001b7e0: 223a 2022 506f 696e 7422 5c5c 6e7d 2729  ": "Point"\\n}')
-0001b7f0: 2c20 526f 7728 544f 5f47 454f 4752 4150  , Row(TO_GEOGRAP
-0001b800: 4859 2822 4122 293d 277b 5c5c 6e20 2022  HY("A")='{\\n  "
-0001b810: 636f 6f72 6469 6e61 7465 7322 3a20 5b5c  coordinates": [\
-0001b820: 5c6e 2020 2020 3230 2e39 322c 5c5c 6e20  \n    20.92,\\n 
-0001b830: 2020 2034 332e 3333 5c5c 6e20 205d 2c5c     43.33\\n  ],\
-0001b840: 5c6e 2020 2274 7970 6522 3a20 2250 6f69  \n  "type": "Poi
-0001b850: 6e74 225c 5c6e 7d27 295d 0a0a 2020 2020  nt"\\n}')]..    
-0001b860: 4265 7369 6465 7320 7374 7269 6e67 732c  Besides strings,
-0001b870: 2062 696e 6172 7920 7265 7072 6573 656e   binary represen
-0001b880: 7461 7469 6f6e 2069 6e20 574b 4220 616e  tation in WKB an
-0001b890: 6420 4557 4b42 2066 6f72 6d61 7420 6361  d EWKB format ca
-0001b8a0: 6e20 6265 2070 6172 7365 642c 206f 7220  n be parsed, or 
-0001b8b0: 6f62 6a65 6374 7320 6164 6865 7269 6e67  objects adhering
-0001b8c0: 2074 6f20 4765 6f4a 534f 4e20 666f 726d   to GeoJSON form
-0001b8d0: 6174 2e0a 2020 2020 466f 7220 616c 6c20  at..    For all 
-0001b8e0: 7375 7070 6f72 7465 6420 666f 726d 6174  supported format
-0001b8f0: 7320 636f 6e66 6572 2068 7474 7073 3a2f  s confer https:/
-0001b900: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-0001b910: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-0001b920: 656e 6365 2f64 6174 612d 7479 7065 732d  ence/data-types-
-0001b930: 6765 6f73 7061 7469 616c 2373 7570 706f  geospatial#suppo
-0001b940: 7274 6564 2d67 656f 7370 6174 6961 6c2d  rted-geospatial-
-0001b950: 6f62 6a65 6374 2d74 7970 6573 2e0a 2020  object-types..  
-0001b960: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0001b970: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0001b980: 2274 6f5f 6765 6f67 7261 7068 7922 290a  "to_geography").
-0001b990: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001b9a0: 696e 2822 746f 5f67 656f 6772 6170 6879  in("to_geography
-0001b9b0: 2229 2863 290a 0a0a 6465 6620 6172 7261  ")(c)...def arra
-0001b9c0: 7973 5f6f 7665 726c 6170 2861 7272 6179  ys_overlap(array
-0001b9d0: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
-0001b9e0: 2061 7272 6179 323a 2043 6f6c 756d 6e4f   array2: ColumnO
-0001b9f0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0001ba00: 3a0a 2020 2020 2222 2243 6f6d 7061 7265  :.    """Compare
-0001ba10: 7320 7768 6574 6865 7220 7477 6f20 4152  s whether two AR
-0001ba20: 5241 5973 2068 6176 6520 6174 206c 6561  RAYs have at lea
-0001ba30: 7374 206f 6e65 2065 6c65 6d65 6e74 2069  st one element i
-0001ba40: 6e20 636f 6d6d 6f6e 2e20 5265 7475 726e  n common. Return
-0001ba50: 7320 5452 5545 0a20 2020 2069 6620 7468  s TRUE.    if th
-0001ba60: 6572 6520 6973 2061 7420 6c65 6173 7420  ere is at least 
-0001ba70: 6f6e 6520 656c 656d 656e 7420 696e 2063  one element in c
-0001ba80: 6f6d 6d6f 6e3b 206f 7468 6572 7769 7365  ommon; otherwise
-0001ba90: 2072 6574 7572 6e73 2046 414c 5345 2e20   returns FALSE. 
-0001baa0: 5468 6520 6675 6e63 7469 6f6e 0a20 2020  The function.   
-0001bab0: 2069 7320 4e55 4c4c 2d73 6166 652c 206d   is NULL-safe, m
-0001bac0: 6561 6e69 6e67 2069 7420 7472 6561 7473  eaning it treats
-0001bad0: 204e 554c 4c73 2061 7320 6b6e 6f77 6e20   NULLs as known 
-0001bae0: 7661 6c75 6573 2066 6f72 2063 6f6d 7061  values for compa
-0001baf0: 7269 6e67 2065 7175 616c 6974 792e 0a0a  ring equality...
-0001bb00: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0001bb10: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0001bb20: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0001bb30: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
-0001bb40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0001bb50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0001bb60: 6166 7261 6d65 285b 526f 7728 5b31 2c20  aframe([Row([1, 
-0001bb70: 325d 2c20 5b31 2c20 335d 292c 2052 6f77  2], [1, 3]), Row
-0001bb80: 285b 312c 2032 5d2c 205b 332c 2034 5d29  ([1, 2], [3, 4])
-0001bb90: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
-0001bba0: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
-0001bbb0: 3e20 6466 2e73 656c 6563 7428 6172 7261  > df.select(arra
-0001bbc0: 7973 5f6f 7665 726c 6170 2822 6122 2c20  ys_overlap("a", 
-0001bbd0: 2262 2229 2e61 6c69 6173 2822 7265 7375  "b").alias("resu
-0001bbe0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-0001bbf0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0001bc00: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-0001bc10: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-0001bc20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001bc30: 2020 2020 7c54 7275 6520 2020 2020 207c      |True      |
-0001bc40: 0a20 2020 2020 2020 207c 4661 6c73 6520  .        |False 
-0001bc50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0001bc60: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001bc70: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0001bc80: 2020 2022 2222 0a20 2020 2061 3120 3d20     """.    a1 = 
-0001bc90: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
-0001bca0: 7272 6179 312c 2022 6172 7261 7973 5f6f  rray1, "arrays_o
-0001bcb0: 7665 726c 6170 2229 0a20 2020 2061 3220  verlap").    a2 
-0001bcc0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0001bcd0: 2861 7272 6179 322c 2022 6172 7261 7973  (array2, "arrays
-0001bce0: 5f6f 7665 726c 6170 2229 0a20 2020 2072  _overlap").    r
-0001bcf0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-0001bd00: 7272 6179 735f 6f76 6572 6c61 7022 2928  rrays_overlap")(
-0001bd10: 6131 2c20 6132 290a 0a0a 6465 6620 6172  a1, a2)...def ar
-0001bd20: 7261 795f 6469 7374 696e 6374 2863 6f6c  ray_distinct(col
-0001bd30: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 293a  : ColumnOrName):
-0001bd40: 0a20 2020 2022 2222 5468 6520 6675 6e63  .    """The func
-0001bd50: 7469 6f6e 2065 7863 6c75 6465 7320 616e  tion excludes an
-0001bd60: 7920 6475 706c 6963 6174 6520 656c 656d  y duplicate elem
-0001bd70: 656e 7473 2074 6861 7420 6172 6520 7072  ents that are pr
-0001bd80: 6573 656e 7420 696e 2074 6865 2069 6e70  esent in the inp
-0001bd90: 7574 2041 5252 4159 2e0a 2020 2020 5468  ut ARRAY..    Th
-0001bda0: 6520 6675 6e63 7469 6f6e 2069 7320 6e6f  e function is no
-0001bdb0: 7420 6775 6172 616e 7465 6564 2074 6f20  t guaranteed to 
-0001bdc0: 7265 7475 726e 2074 6865 2065 6c65 6d65  return the eleme
-0001bdd0: 6e74 7320 696e 2074 6865 2041 5252 4159  nts in the ARRAY
-0001bde0: 2069 6e20 6120 7370 6563 6966 6963 206f   in a specific o
-0001bdf0: 7264 6572 2e0a 2020 2020 5468 6520 6675  rder..    The fu
-0001be00: 6e63 7469 6f6e 2069 7320 4e55 4c4c 2073  nction is NULL s
-0001be10: 6166 652c 2077 6869 6368 206d 6561 6e73  afe, which means
-0001be20: 2074 6861 7420 6974 2074 7265 6174 7320   that it treats 
-0001be30: 4e55 4c4c 7320 6173 206b 6e6f 776e 2076  NULLs as known v
-0001be40: 616c 7565 7320 7768 656e 2069 6465 6e74  alues when ident
-0001be50: 6966 7969 6e67 2064 7570 6c69 6361 7465  ifying duplicate
-0001be60: 2065 6c65 6d65 6e74 732e 0a0a 2020 2020   elements...    
-0001be70: 4172 6773 3a0a 2020 2020 2020 2020 636f  Args:.        co
-0001be80: 6c3a 2054 6865 2061 7272 6179 2063 6f6c  l: The array col
-0001be90: 756d 6e0a 0a20 2020 2052 6574 7572 6e73  umn..    Returns
-0001bea0: 3a0a 2020 2020 2020 2020 5265 7475 726e  :.        Return
-0001beb0: 7320 6120 6e65 7720 4152 5241 5920 7468  s a new ARRAY th
-0001bec0: 6174 2063 6f6e 7461 696e 7320 6f6e 6c79  at contains only
-0001bed0: 2074 6865 2064 6973 7469 6e63 7420 656c   the distinct el
-0001bee0: 656d 656e 7473 2066 726f 6d20 7468 6520  ements from the 
-0001bef0: 696e 7075 7420 4152 5241 592e 0a0a 2020  input ARRAY...  
-0001bf00: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0001bf10: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0001bf20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0001bf30: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-0001bf40: 7420 6172 7261 795f 636f 6e73 7472 7563  t array_construc
-0001bf50: 742c 6172 7261 795f 6469 7374 696e 6374  t,array_distinct
-0001bf60: 2c6c 6974 0a20 2020 2020 2020 203e 3e3e  ,lit.        >>>
-0001bf70: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0001bf80: 6561 7465 4461 7461 4672 616d 6528 5b5b  eateDataFrame([[
-0001bf90: 2231 225d 5d2c 205b 2241 225d 290a 2020  "1"]], ["A"]).  
-0001bfa0: 2020 2020 2020 3e3e 3e20 6466 203d 2064        >>> df = d
-0001bfb0: 662e 7769 7468 436f 6c75 6d6e 2822 6172  f.withColumn("ar
-0001bfc0: 7261 7922 2c20 6172 7261 795f 636f 6e73  ray", array_cons
-0001bfd0: 7472 7563 7428 6c69 7428 3129 2c20 6c69  truct(lit(1), li
-0001bfe0: 7428 3129 2c20 6c69 7428 3129 2c20 6c69  t(1), lit(1), li
-0001bff0: 7428 3229 2c20 6c69 7428 3329 2c20 6c69  t(2), lit(3), li
-0001c000: 7428 3229 2c20 6c69 7428 3229 2929 0a20  t(2), lit(2))). 
-0001c010: 2020 2020 2020 203e 3e3e 2064 662e 7769         >>> df.wi
-0001c020: 7468 436f 6c75 6d6e 2822 6172 7261 795f  thColumn("array_
-0001c030: 6422 2c20 6172 7261 795f 6469 7374 696e  d", array_distin
-0001c040: 6374 2822 4152 5241 5922 2929 2e73 686f  ct("ARRAY")).sho
-0001c050: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-0001c060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001c070: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001c080: 2020 7c22 4122 2020 7c22 4152 5241 5922    |"A"  |"ARRAY"
-0001c090: 2020 7c22 4152 5241 595f 4422 2020 7c0a    |"ARRAY_D"  |.
-0001c0a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001c0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001c0c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
-0001c0d0: 2020 2020 7c5b 2020 2020 2020 2020 7c5b      |[        |[
-0001c0e0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0001c0f0: 2020 2020 7c20 2020 2020 7c20 2031 2c20      |     |  1, 
-0001c100: 2020 2020 7c20 2031 2c20 2020 2020 2020      |  1,       
-0001c110: 7c0a 2020 2020 2020 2020 7c20 2020 2020  |.        |     
-0001c120: 7c20 2031 2c20 2020 2020 7c20 2032 2c20  |  1,     |  2, 
-0001c130: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0001c140: 7c20 2020 2020 7c20 2031 2c20 2020 2020  |     |  1,     
-0001c150: 7c20 2033 2020 2020 2020 2020 7c0a 2020  |  3        |.  
-0001c160: 2020 2020 2020 7c20 2020 2020 7c20 2032        |     |  2
-0001c170: 2c20 2020 2020 7c5d 2020 2020 2020 2020  ,     |]        
-0001c180: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
-0001c190: 2020 7c20 2033 2c20 2020 2020 7c20 2020    |  3,     |   
-0001c1a0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0001c1b0: 2020 7c20 2020 2020 7c20 2032 2c20 2020    |     |  2,   
-0001c1c0: 2020 7c20 2020 2020 2020 2020 2020 7c0a    |           |.
-0001c1d0: 2020 2020 2020 2020 7c20 2020 2020 7c20          |     | 
-0001c1e0: 2032 2020 2020 2020 7c20 2020 2020 2020   2      |       
-0001c1f0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-0001c200: 2020 2020 7c5d 2020 2020 2020 2020 7c20      |]        | 
-0001c210: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0001c220: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001c230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001c240: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0001c250: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0001c260: 2020 636f 6c20 3d20 5f74 6f5f 636f 6c5f    col = _to_col_
-0001c270: 6966 5f73 7472 2863 6f6c 2c20 2261 7272  if_str(col, "arr
-0001c280: 6179 5f64 6973 7469 6e63 7422 290a 2020  ay_distinct").  
-0001c290: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001c2a0: 2822 6172 7261 795f 6469 7374 696e 6374  ("array_distinct
-0001c2b0: 2229 2863 6f6c 290a 0a0a 6465 6620 6172  ")(col)...def ar
-0001c2c0: 7261 795f 696e 7465 7273 6563 7469 6f6e  ray_intersection
-0001c2d0: 2861 7272 6179 313a 2043 6f6c 756d 6e4f  (array1: ColumnO
-0001c2e0: 724e 616d 652c 2061 7272 6179 323a 2043  rName, array2: C
-0001c2f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0001c300: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-0001c310: 6574 7572 6e73 2061 6e20 6172 7261 7920  eturns an array 
-0001c320: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
-0001c330: 6520 6d61 7463 6869 6e67 2065 6c65 6d65  e matching eleme
-0001c340: 6e74 7320 696e 2074 6865 2074 776f 2069  nts in the two i
-0001c350: 6e70 7574 2061 7272 6179 732e 0a0a 2020  nput arrays...  
-0001c360: 2020 5468 6520 6675 6e63 7469 6f6e 2069    The function i
-0001c370: 7320 4e55 4c4c 2d73 6166 652c 206d 6561  s NULL-safe, mea
-0001c380: 6e69 6e67 2069 7420 7472 6561 7473 204e  ning it treats N
-0001c390: 554c 4c73 2061 7320 6b6e 6f77 6e20 7661  ULLs as known va
-0001c3a0: 6c75 6573 2066 6f72 2063 6f6d 7061 7269  lues for compari
-0001c3b0: 6e67 2065 7175 616c 6974 792e 0a0a 2020  ng equality...  
-0001c3c0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0001c3d0: 6172 7261 7931 3a20 416e 2041 5252 4159  array1: An ARRAY
-0001c3e0: 2074 6861 7420 636f 6e74 6169 6e73 2065   that contains e
-0001c3f0: 6c65 6d65 6e74 7320 746f 2062 6520 636f  lements to be co
-0001c400: 6d70 6172 6564 2e0a 2020 2020 2020 2020  mpared..        
-0001c410: 6172 7261 7932 3a20 416e 2041 5252 4159  array2: An ARRAY
-0001c420: 2074 6861 7420 636f 6e74 6169 6e73 2065   that contains e
-0001c430: 6c65 6d65 6e74 7320 746f 2062 6520 636f  lements to be co
-0001c440: 6d70 6172 6564 2e0a 0a20 2020 2045 7861  mpared...    Exa
-0001c450: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-0001c460: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0001c470: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
-0001c480: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
-0001c490: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0001c4a0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0001c4b0: 5b52 6f77 285b 312c 2032 5d2c 205b 312c  [Row([1, 2], [1,
-0001c4c0: 2033 5d29 5d2c 2073 6368 656d 613d 5b22   3])], schema=["
-0001c4d0: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
-0001c4e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001c4f0: 6172 7261 795f 696e 7465 7273 6563 7469  array_intersecti
-0001c500: 6f6e 2822 6122 2c20 2262 2229 2e61 6c69  on("a", "b").ali
-0001c510: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
-0001c520: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-0001c530: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001c540: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
-0001c550: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001c560: 2d2d 2d0a 2020 2020 2020 2020 7c5b 2020  ---.        |[  
-0001c570: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0001c580: 207c 2020 3120 2020 2020 2020 7c0a 2020   |  1       |.  
-0001c590: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
-0001c5a0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001c5b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001c5c0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0001c5d0: 2222 220a 2020 2020 6131 203d 205f 746f  """.    a1 = _to
-0001c5e0: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
-0001c5f0: 7931 2c20 2261 7272 6179 5f69 6e74 6572  y1, "array_inter
-0001c600: 7365 6374 696f 6e22 290a 2020 2020 6132  section").    a2
-0001c610: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0001c620: 7228 6172 7261 7932 2c20 2261 7272 6179  r(array2, "array
-0001c630: 5f69 6e74 6572 7365 6374 696f 6e22 290a  _intersection").
-0001c640: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001c650: 696e 2822 6172 7261 795f 696e 7465 7273  in("array_inters
-0001c660: 6563 7469 6f6e 2229 2861 312c 2061 3229  ection")(a1, a2)
-0001c670: 0a0a 0a64 6566 2064 6174 655f 6164 6428  ...def date_add(
-0001c680: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
-0001c690: 652c 206e 756d 5f6f 665f 6461 7973 3a20  e, num_of_days: 
-0001c6a0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-0001c6b0: 6d65 2c20 696e 745d 293a 0a20 2020 2022  me, int]):.    "
-0001c6c0: 2222 0a20 2020 2041 6464 7320 6120 6e75  "".    Adds a nu
-0001c6d0: 6d62 6572 206f 6620 6461 7973 2074 6f20  mber of days to 
-0001c6e0: 6120 6461 7465 2063 6f6c 756d 6e2e 0a0a  a date column...
-0001c6f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0001c700: 2020 636f 6c3a 2054 6865 2063 6f6c 756d    col: The colum
-0001c710: 6e20 746f 2061 6464 2074 6f2e 0a20 2020  n to add to..   
-0001c720: 2020 2020 206e 756d 5f6f 665f 6461 7973       num_of_days
-0001c730: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
-0001c740: 6461 7973 2074 6f20 6164 642e 0a0a 2020  days to add...  
-0001c750: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0001c760: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0001c770: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0001c780: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-0001c790: 7420 6461 7465 5f61 6464 2c20 746f 5f64  t date_add, to_d
-0001c7a0: 6174 650a 2020 2020 2020 2020 3e3e 3e20  ate.        >>> 
-0001c7b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0001c7c0: 6174 6544 6174 6146 7261 6d65 285b 2822  ateDataFrame([("
-0001c7d0: 3139 3736 2d30 312d 3036 2229 5d2c 205b  1976-01-06")], [
-0001c7e0: 2264 6174 6522 5d29 0a20 2020 2020 2020  "date"]).       
-0001c7f0: 203e 3e3e 2064 6620 3d20 6466 2e77 6974   >>> df = df.wit
-0001c800: 6843 6f6c 756d 6e28 2264 6174 6522 2c20  hColumn("date", 
-0001c810: 746f 5f64 6174 6528 2264 6174 6522 2929  to_date("date"))
-0001c820: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-0001c830: 203d 2064 662e 7769 7468 436f 6c75 6d6e   = df.withColumn
-0001c840: 2822 6461 7465 222c 2064 6174 655f 6164  ("date", date_ad
-0001c850: 6428 2264 6174 6522 2c20 3429 292e 7368  d("date", 4)).sh
-0001c860: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
-0001c870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0001c880: 2020 2020 7c22 4441 5445 2220 2020 2020      |"DATE"     
-0001c890: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001c8a0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001c8b0: 2020 7c31 3937 362d 3031 2d31 3020 207c    |1976-01-10  |
-0001c8c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c8d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001c8e0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0001c8f0: 2222 220a 2020 2020 2320 436f 6e76 6572  """.    # Conver
-0001c900: 7420 7468 6520 696e 7075 7420 746f 2061  t the input to a
-0001c910: 2063 6f6c 756d 6e20 6966 2069 7420 6973   column if it is
-0001c920: 2061 2073 7472 696e 670a 2020 2020 636f   a string.    co
-0001c930: 6c20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  l = _to_col_if_s
-0001c940: 7472 2863 6f6c 2c20 2264 6174 655f 6164  tr(col, "date_ad
-0001c950: 6422 290a 2020 2020 6e75 6d5f 6f66 5f64  d").    num_of_d
-0001c960: 6179 7320 3d20 280a 2020 2020 2020 2020  ays = (.        
-0001c970: 6c69 7428 6e75 6d5f 6f66 5f64 6179 7329  lit(num_of_days)
-0001c980: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001c990: 7374 616e 6365 286e 756d 5f6f 665f 6461  stance(num_of_da
-0001c9a0: 7973 2c20 696e 7429 0a20 2020 2020 2020  ys, int).       
-0001c9b0: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
-0001c9c0: 5f73 7472 286e 756d 5f6f 665f 6461 7973  _str(num_of_days
-0001c9d0: 2c20 2264 6174 655f 6164 6422 290a 2020  , "date_add").  
-0001c9e0: 2020 290a 2020 2020 2320 5265 7475 726e    ).    # Return
-0001c9f0: 2074 6865 2064 6174 6561 6464 2066 756e   the dateadd fun
-0001ca00: 6374 696f 6e20 7769 7468 2074 6865 2063  ction with the c
-0001ca10: 6f6c 756d 6e20 616e 6420 6e75 6d62 6572  olumn and number
-0001ca20: 206f 6620 6461 7973 0a20 2020 2072 6574   of days.    ret
-0001ca30: 7572 6e20 6461 7465 6164 6428 2264 6179  urn dateadd("day
-0001ca40: 222c 206e 756d 5f6f 665f 6461 7973 2c20  ", num_of_days, 
-0001ca50: 636f 6c29 0a0a 0a64 6566 2064 6174 655f  col)...def date_
-0001ca60: 7375 6228 636f 6c3a 2043 6f6c 756d 6e4f  sub(col: ColumnO
-0001ca70: 724e 616d 652c 206e 756d 5f6f 665f 6461  rName, num_of_da
-0001ca80: 7973 3a20 556e 696f 6e5b 436f 6c75 6d6e  ys: Union[Column
-0001ca90: 4f72 4e61 6d65 2c20 696e 745d 293a 0a20  OrName, int]):. 
-0001caa0: 2020 2022 2222 0a20 2020 2053 7562 7472     """.    Subtr
-0001cab0: 6163 7473 2061 206e 756d 6265 7220 6f66  acts a number of
-0001cac0: 2064 6179 7320 6672 6f6d 2061 2064 6174   days from a dat
-0001cad0: 6520 636f 6c75 6d6e 2e0a 0a20 2020 2041  e column...    A
-0001cae0: 7267 733a 0a20 2020 2020 2020 2063 6f6c  rgs:.        col
-0001caf0: 3a20 5468 6520 636f 6c75 6d6e 2074 6f20  : The column to 
-0001cb00: 7375 6274 7261 6374 2066 726f 6d2e 0a20  subtract from.. 
-0001cb10: 2020 2020 2020 206e 756d 5f6f 665f 6461         num_of_da
-0001cb20: 7973 3a20 5468 6520 6e75 6d62 6572 206f  ys: The number o
-0001cb30: 6620 6461 7973 2074 6f20 7375 6274 7261  f days to subtra
-0001cb40: 6374 2e0a 0a20 2020 2045 7861 6d70 6c65  ct...    Example
-0001cb50: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001cb60: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0001cb70: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-0001cb80: 7320 696d 706f 7274 2064 6174 655f 7375  s import date_su
-0001cb90: 622c 2074 6f5f 6461 7465 0a20 2020 2020  b, to_date.     
-0001cba0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0001cbb0: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
-0001cbc0: 616d 6528 5b28 2231 3937 362d 3031 2d30  ame([("1976-01-0
-0001cbd0: 3622 295d 2c20 5b22 6461 7465 225d 290a  6")], ["date"]).
-0001cbe0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001cbf0: 2064 662e 7769 7468 436f 6c75 6d6e 2822   df.withColumn("
-0001cc00: 6461 7465 222c 2074 6f5f 6461 7465 2822  date", to_date("
-0001cc10: 6461 7465 2229 290a 2020 2020 2020 2020  date")).        
-0001cc20: 3e3e 3e20 6466 2e77 6974 6843 6f6c 756d  >>> df.withColum
-0001cc30: 6e28 2264 6174 6522 2c20 6461 7465 5f73  n("date", date_s
-0001cc40: 7562 2822 6461 7465 222c 2032 2929 2e73  ub("date", 2)).s
-0001cc50: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0001cc60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001cc70: 2020 2020 207c 2244 4154 4522 2020 2020       |"DATE"    
-0001cc80: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0001cc90: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001cca0: 2020 207c 3139 3736 2d30 312d 3034 2020     |1976-01-04  
-0001ccb0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0001ccc0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001ccd0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0001cce0: 2022 2222 0a20 2020 2023 2043 6f6e 7665   """.    # Conve
-0001ccf0: 7274 2074 6865 2069 6e70 7574 2070 6172  rt the input par
-0001cd00: 616d 6574 6572 7320 746f 2074 6865 2061  ameters to the a
-0001cd10: 7070 726f 7072 6961 7465 2074 7970 650a  ppropriate type.
-0001cd20: 2020 2020 636f 6c20 3d20 5f74 6f5f 636f      col = _to_co
-0001cd30: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2264  l_if_str(col, "d
-0001cd40: 6174 655f 7375 6222 290a 2020 2020 6e75  ate_sub").    nu
-0001cd50: 6d5f 6f66 5f64 6179 7320 3d20 280a 2020  m_of_days = (.  
-0001cd60: 2020 2020 2020 6c69 7428 6e75 6d5f 6f66        lit(num_of
-0001cd70: 5f64 6179 7329 0a20 2020 2020 2020 2069  _days).        i
-0001cd80: 6620 6973 696e 7374 616e 6365 286e 756d  f isinstance(num
-0001cd90: 5f6f 665f 6461 7973 2c20 696e 7429 0a20  _of_days, int). 
-0001cda0: 2020 2020 2020 2065 6c73 6520 5f74 6f5f         else _to_
-0001cdb0: 636f 6c5f 6966 5f73 7472 286e 756d 5f6f  col_if_str(num_o
-0001cdc0: 665f 6461 7973 2c20 2264 6174 655f 7375  f_days, "date_su
-0001cdd0: 6222 290a 2020 2020 290a 2020 2020 2320  b").    ).    # 
-0001cde0: 5265 7475 726e 2074 6865 2064 6174 6520  Return the date 
-0001cdf0: 636f 6c75 6d6e 2077 6974 6820 7468 6520  column with the 
-0001ce00: 6e75 6d62 6572 206f 6620 6461 7973 2073  number of days s
-0001ce10: 7562 7472 6163 7465 640a 2020 2020 7265  ubtracted.    re
-0001ce20: 7475 726e 2064 6174 6561 6464 2822 6461  turn dateadd("da
-0001ce30: 7922 2c20 2d31 202a 206e 756d 5f6f 665f  y", -1 * num_of_
-0001ce40: 6461 7973 2c20 636f 6c29 0a0a 0a64 6566  days, col)...def
-0001ce50: 2064 6174 6564 6966 6628 7061 7274 3a20   datediff(part: 
-0001ce60: 7374 722c 2063 6f6c 313a 2043 6f6c 756d  str, col1: Colum
-0001ce70: 6e4f 724e 616d 652c 2063 6f6c 323a 2043  nOrName, col2: C
-0001ce80: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0001ce90: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0001cea0: 616c 6375 6c61 7465 7320 7468 6520 6469  alculates the di
-0001ceb0: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
-0001cec0: 2074 776f 2064 6174 652c 2074 696d 652c   two date, time,
-0001ced0: 206f 7220 7469 6d65 7374 616d 7020 636f   or timestamp co
-0001cee0: 6c75 6d6e 7320 6261 7365 6420 6f6e 2074  lumns based on t
-0001cef0: 6865 2064 6174 6520 6f72 2074 696d 6520  he date or time 
-0001cf00: 7061 7274 2072 6571 7565 7374 6564 2e0a  part requested..
-0001cf10: 0a20 2020 2060 5375 7070 6f72 7465 6420  .    `Supported 
-0001cf20: 6461 7465 2061 6e64 2074 696d 6520 7061  date and time pa
-0001cf30: 7274 7320 3c68 7474 7073 3a2f 2f64 6f63  rts <https://doc
-0001cf40: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
-0001cf50: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
-0001cf60: 2f66 756e 6374 696f 6e73 2d64 6174 652d  /functions-date-
-0001cf70: 7469 6d65 2e68 746d 6c23 6c61 6265 6c2d  time.html#label-
-0001cf80: 7375 7070 6f72 7465 642d 6461 7465 2d74  supported-date-t
-0001cf90: 696d 652d 7061 7274 733e 605f 0a0a 2020  ime-parts>`_..  
-0001cfa0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0001cfb0: 2020 2020 203e 3e3e 2023 2079 6561 7220       >>> # year 
-0001cfc0: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
-0001cfd0: 656e 2074 776f 2064 6174 6520 636f 6c75  en two date colu
-0001cfe0: 6d6e 730a 2020 2020 2020 2020 3e3e 3e20  mns.        >>> 
-0001cff0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001d000: 2020 2020 2020 2020 3e3e 3e20 6461 7465          >>> date
-0001d010: 5f64 6620 3d20 7365 7373 696f 6e2e 6372  _df = session.cr
-0001d020: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-0001d030: 5b64 6174 6574 696d 652e 6461 7465 2832  [datetime.date(2
-0001d040: 3032 302c 2031 2c20 3129 2c20 6461 7465  020, 1, 1), date
-0001d050: 7469 6d65 2e64 6174 6528 3230 3231 2c20  time.date(2021, 
-0001d060: 312c 2031 295d 5d2c 2073 6368 656d 613d  1, 1)]], schema=
-0001d070: 5b22 6461 7465 5f63 6f6c 3122 2c20 2264  ["date_col1", "d
-0001d080: 6174 655f 636f 6c32 225d 290a 2020 2020  ate_col2"]).    
-0001d090: 2020 2020 3e3e 3e20 6461 7465 5f64 662e      >>> date_df.
-0001d0a0: 7365 6c65 6374 2864 6174 6564 6966 6628  select(datediff(
-0001d0b0: 2279 6561 7222 2c20 636f 6c28 2264 6174  "year", col("dat
-0001d0c0: 655f 636f 6c31 2229 2c20 636f 6c28 2264  e_col1"), col("d
-0001d0d0: 6174 655f 636f 6c32 2229 292e 616c 6961  ate_col2")).alia
-0001d0e0: 7328 2279 6561 725f 6469 6666 2229 292e  s("year_diff")).
-0001d0f0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0001d100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0001d110: 2020 2020 2020 207c 2259 4541 525f 4449         |"YEAR_DI
-0001d120: 4646 2220 207c 0a20 2020 2020 2020 202d  FF"  |.        -
-0001d130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0001d140: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
-0001d150: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0001d160: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0001d170: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-0001d180: 453e 0a0a 2020 2020 4172 6773 3a0a 2020  E>..    Args:.  
-0001d190: 2020 2020 2020 7061 7274 3a20 5468 6520        part: The 
-0001d1a0: 7469 6d65 2070 6172 7420 746f 2075 7365  time part to use
-0001d1b0: 2066 6f72 2063 616c 6375 6c61 7469 6e67   for calculating
-0001d1c0: 2074 6865 2064 6966 6665 7265 6e63 650a   the difference.
-0001d1d0: 2020 2020 2020 2020 636f 6c31 3a20 5468          col1: Th
-0001d1e0: 6520 6669 7273 7420 7469 6d65 7374 616d  e first timestam
-0001d1f0: 7020 636f 6c75 6d6e 206f 7220 6d69 6e75  p column or minu
-0001d200: 656e 6420 696e 2074 6865 2064 6174 6564  end in the dated
-0001d210: 6966 660a 2020 2020 2020 2020 636f 6c32  iff.        col2
-0001d220: 3a20 5468 6520 7365 636f 6e64 2074 696d  : The second tim
-0001d230: 6573 7461 6d70 2063 6f6c 756d 6e20 6f72  estamp column or
-0001d240: 2074 6865 2073 7562 7472 6168 656e 6420   the subtrahend 
-0001d250: 696e 2074 6865 2064 6174 6564 6966 660a  in the datediff.
-0001d260: 2020 2020 2222 220a 2020 2020 6966 206e      """.    if n
-0001d270: 6f74 2069 7369 6e73 7461 6e63 6528 7061  ot isinstance(pa
-0001d280: 7274 2c20 7374 7229 3a0a 2020 2020 2020  rt, str):.      
-0001d290: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001d2a0: 6f72 2822 7061 7274 206d 7573 7420 6265  or("part must be
-0001d2b0: 2061 2073 7472 696e 6722 290a 2020 2020   a string").    
-0001d2c0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
-0001d2d0: 7374 7228 636f 6c31 2c20 2264 6174 6564  str(col1, "dated
-0001d2e0: 6966 6622 290a 2020 2020 6332 203d 205f  iff").    c2 = _
-0001d2f0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-0001d300: 6c32 2c20 2264 6174 6564 6966 6622 290a  l2, "datediff").
-0001d310: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0001d320: 696e 2822 6461 7465 6469 6666 2229 2870  in("datediff")(p
-0001d330: 6172 742c 2063 312c 2063 3229 0a0a 0a64  art, c1, c2)...d
-0001d340: 6566 2064 6179 6469 6666 2863 6f6c 313a  ef daydiff(col1:
-0001d350: 2043 6f6c 756d 6e4f 724e 616d 652c 2063   ColumnOrName, c
-0001d360: 6f6c 323a 2043 6f6c 756d 6e4f 724e 616d  ol2: ColumnOrNam
-0001d370: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0001d380: 2020 2222 2243 616c 6375 6c61 7465 7320    """Calculates 
-0001d390: 7468 6520 6469 6666 6572 656e 6365 2062  the difference b
-0001d3a0: 6574 7765 656e 2074 776f 2064 6174 6573  etween two dates
-0001d3b0: 2c20 6f72 2074 696d 6573 7461 6d70 2063  , or timestamp c
-0001d3c0: 6f6c 756d 6e73 2062 6173 6564 2069 6e20  olumns based in 
-0001d3d0: 6461 7973 2e0a 2020 2020 5468 6520 7265  days..    The re
-0001d3e0: 7375 6c74 2077 696c 6c20 7265 666c 6563  sult will reflec
-0001d3f0: 7420 7468 6520 6469 6666 6572 656e 6365  t the difference
-0001d400: 2062 6574 7765 656e 2063 6f6c 3220 2d20   between col2 - 
-0001d410: 636f 6c31 0a0a 2020 2020 4578 616d 706c  col1..    Exampl
-0001d420: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0001d430: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0001d440: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-0001d450: 7320 696d 706f 7274 2064 6179 6469 6666  s import daydiff
-0001d460: 2c20 746f 5f64 6174 650a 2020 2020 2020  , to_date.      
-0001d470: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0001d480: 6f6e 2e63 7265 6174 6544 6174 6146 7261  on.createDataFra
-0001d490: 6d65 285b 2822 3230 3135 2d30 342d 3038  me([("2015-04-08
-0001d4a0: 222c 2022 3230 3135 2d30 352d 3130 2229  ", "2015-05-10")
-0001d4b0: 5d2c 205b 2264 3122 2c20 2264 3222 5d29  ], ["d1", "d2"])
-0001d4c0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-0001d4d0: 203d 2064 662e 7365 6c65 6374 2864 6179   = df.select(day
-0001d4e0: 6469 6666 2874 6f5f 6461 7465 2864 662e  diff(to_date(df.
-0001d4f0: 6432 292c 2074 6f5f 6461 7465 2864 662e  d2), to_date(df.
-0001d500: 6431 2929 2e61 6c69 6173 2822 6469 6666  d1)).alias("diff
-0001d510: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-0001d520: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0001d530: 2020 2020 2020 7c22 4449 4646 2220 207c        |"DIFF"  |
-0001d540: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001d550: 2d2d 2d0a 2020 2020 2020 2020 7c33 3220  ---.        |32 
-0001d560: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0001d570: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001d580: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-0001d590: 2020 2222 220a 2020 2020 636f 6c31 203d    """.    col1 =
-0001d5a0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0001d5b0: 636f 6c31 2c20 2264 6179 6469 6666 2229  col1, "daydiff")
-0001d5c0: 0a20 2020 2063 6f6c 3220 3d20 5f74 6f5f  .    col2 = _to_
-0001d5d0: 636f 6c5f 6966 5f73 7472 2863 6f6c 322c  col_if_str(col2,
-0001d5e0: 2022 6461 7964 6966 6622 290a 2020 2020   "daydiff").    
-0001d5f0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0001d600: 6461 7465 6469 6666 2229 286c 6974 2822  datediff")(lit("
-0001d610: 6461 7922 292c 2063 6f6c 322c 2063 6f6c  day"), col2, col
-0001d620: 3129 0a0a 0a64 6566 2074 7275 6e63 2865  1)...def trunc(e
-0001d630: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0001d640: 7363 616c 653a 2055 6e69 6f6e 5b43 6f6c  scale: Union[Col
-0001d650: 756d 6e4f 724e 616d 652c 2069 6e74 2c20  umnOrName, int, 
-0001d660: 666c 6f61 745d 203d 2030 2920 2d3e 2043  float] = 0) -> C
-0001d670: 6f6c 756d 6e3a 0a20 2020 2022 2222 526f  olumn:.    """Ro
-0001d680: 756e 6473 2074 6865 2069 6e70 7574 2065  unds the input e
-0001d690: 7870 7265 7373 696f 6e20 646f 776e 2074  xpression down t
-0001d6a0: 6f20 7468 6520 6e65 6172 6573 7420 286f  o the nearest (o
-0001d6b0: 7220 6571 7561 6c29 2069 6e74 6567 6572  r equal) integer
-0001d6c0: 2063 6c6f 7365 7220 746f 207a 6572 6f2c   closer to zero,
-0001d6d0: 0a20 2020 206f 7220 746f 2074 6865 206e  .    or to the n
-0001d6e0: 6561 7265 7374 2065 7175 616c 206f 7220  earest equal or 
-0001d6f0: 736d 616c 6c65 7220 7661 6c75 6520 7769  smaller value wi
-0001d700: 7468 2074 6865 2073 7065 6369 6669 6564  th the specified
-0001d710: 206e 756d 6265 7220 6f66 0a20 2020 2070   number of.    p
-0001d720: 6c61 6365 7320 6166 7465 7220 7468 6520  laces after the 
-0001d730: 6465 6369 6d61 6c20 706f 696e 742e 0a0a  decimal point...
-0001d740: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0001d750: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0001d760: 7365 7373 696f 6e2e 6372 6561 7465 4461  session.createDa
-0001d770: 7461 4672 616d 6528 5b2d 312e 302c 202d  taFrame([-1.0, -
-0001d780: 302e 392c 202d 2e35 2c20 2d2e 322c 2030  0.9, -.5, -.2, 0
-0001d790: 2e30 2c20 302e 322c 2030 2e35 2c20 302e  .0, 0.2, 0.5, 0.
-0001d7a0: 392c 2031 2e31 2c20 332e 3134 3135 395d  9, 1.1, 3.14159]
-0001d7b0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0001d7c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0001d7d0: 656c 6563 7428 7472 756e 6328 636f 6c28  elect(trunc(col(
-0001d7e0: 2261 2229 2929 2e63 6f6c 6c65 6374 2829  "a"))).collect()
-0001d7f0: 0a20 2020 2020 2020 205b 526f 7728 5452  .        [Row(TR
-0001d800: 554e 4328 2241 222c 2030 293d 2d31 2e30  UNC("A", 0)=-1.0
-0001d810: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
-0001d820: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
-0001d830: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
-0001d840: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
-0001d850: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
-0001d860: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
-0001d870: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
-0001d880: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
-0001d890: 5255 4e43 2822 4122 2c20 3029 3d30 2e30  RUNC("A", 0)=0.0
-0001d8a0: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
-0001d8b0: 2c20 3029 3d30 2e30 292c 2052 6f77 2854  , 0)=0.0), Row(T
-0001d8c0: 5255 4e43 2822 4122 2c20 3029 3d31 2e30  RUNC("A", 0)=1.0
-0001d8d0: 292c 2052 6f77 2854 5255 4e43 2822 4122  ), Row(TRUNC("A"
-0001d8e0: 2c20 3029 3d33 2e30 295d 0a0a 2020 2020  , 0)=3.0)]..    
-0001d8f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001d900: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
-0001d910: 7261 6d65 285b 2d31 2e33 3233 2c20 342e  rame([-1.323, 4.
-0001d920: 3536 372c 2030 2e30 3132 335d 2c20 7363  567, 0.0123], sc
-0001d930: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
-0001d940: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0001d950: 7428 7472 756e 6328 636f 6c28 2261 2229  t(trunc(col("a")
-0001d960: 2c20 6c69 7428 3029 2929 2e63 6f6c 6c65  , lit(0))).colle
-0001d970: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0001d980: 7728 5452 554e 4328 2241 222c 2030 293d  w(TRUNC("A", 0)=
-0001d990: 2d31 2e30 292c 2052 6f77 2854 5255 4e43  -1.0), Row(TRUNC
-0001d9a0: 2822 4122 2c20 3029 3d34 2e30 292c 2052  ("A", 0)=4.0), R
-0001d9b0: 6f77 2854 5255 4e43 2822 4122 2c20 3029  ow(TRUNC("A", 0)
-0001d9c0: 3d30 2e30 295d 0a20 2020 2020 2020 203e  =0.0)].        >
-0001d9d0: 3e3e 2064 662e 7365 6c65 6374 2874 7275  >> df.select(tru
-0001d9e0: 6e63 2863 6f6c 2822 6122 292c 206c 6974  nc(col("a"), lit
-0001d9f0: 2831 2929 292e 636f 6c6c 6563 7428 290a  (1))).collect().
-0001da00: 2020 2020 2020 2020 5b52 6f77 2854 5255          [Row(TRU
-0001da10: 4e43 2822 4122 2c20 3129 3d2d 312e 3329  NC("A", 1)=-1.3)
-0001da20: 2c20 526f 7728 5452 554e 4328 2241 222c  , Row(TRUNC("A",
-0001da30: 2031 293d 342e 3529 2c20 526f 7728 5452   1)=4.5), Row(TR
-0001da40: 554e 4328 2241 222c 2031 293d 302e 3029  UNC("A", 1)=0.0)
-0001da50: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-0001da60: 2e73 656c 6563 7428 7472 756e 6328 636f  .select(trunc(co
-0001da70: 6c28 2261 2229 2c20 6c69 7428 3229 2929  l("a"), lit(2)))
-0001da80: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001da90: 2020 205b 526f 7728 5452 554e 4328 2241     [Row(TRUNC("A
-0001daa0: 222c 2032 293d 2d31 2e33 3229 2c20 526f  ", 2)=-1.32), Ro
-0001dab0: 7728 5452 554e 4328 2241 222c 2032 293d  w(TRUNC("A", 2)=
-0001dac0: 342e 3536 292c 2052 6f77 2854 5255 4e43  4.56), Row(TRUNC
-0001dad0: 2822 4122 2c20 3229 3d30 2e30 3129 5d0a  ("A", 2)=0.01)].
-0001dae0: 0a20 2020 204e 6f74 6520 7468 6174 2074  .    Note that t
-0001daf0: 6865 2066 756e 6374 696f 6e20 6060 7472  he function ``tr
-0001db00: 756e 6360 6020 6973 206f 7665 726c 6f61  unc`` is overloa
-0001db10: 6465 6420 7769 7468 2060 6064 6174 655f  ded with ``date_
-0001db20: 7472 756e 6360 6020 666f 7220 6461 7465  trunc`` for date
-0001db30: 7469 6d65 2074 7970 6573 2e20 4974 2061  time types. It a
-0001db40: 6c6c 6f77 7320 746f 2072 6f75 6e64 2064  llows to round d
-0001db50: 6174 6574 696d 650a 2020 2020 6f62 6a65  atetime.    obje
-0001db60: 6374 732e 0a0a 2020 2020 4578 616d 706c  cts...    Exampl
-0001db70: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-0001db80: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-0001db90: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0001dba0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0001dbb0: 4461 7461 4672 616d 6528 5b64 6174 6574  DataFrame([datet
-0001dbc0: 696d 652e 6461 7465 2832 3032 322c 2031  ime.date(2022, 1
-0001dbd0: 322c 2032 3529 2c20 6461 7465 7469 6d65  2, 25), datetime
-0001dbe0: 2e64 6174 6528 3230 3232 2c20 312c 2031  .date(2022, 1, 1
-0001dbf0: 3029 2c20 6461 7465 7469 6d65 2e64 6174  0), datetime.dat
-0001dc00: 6528 3230 3232 2c20 372c 2037 295d 2c20  e(2022, 7, 7)], 
-0001dc10: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-0001dc20: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0001dc30: 6563 7428 7472 756e 6328 636f 6c28 2261  ect(trunc(col("a
-0001dc40: 2229 2c20 6c69 7428 2251 5541 5254 4552  "), lit("QUARTER
-0001dc50: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
-0001dc60: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
-0001dc70: 4328 2241 222c 2027 5155 4152 5445 5227  C("A", 'QUARTER'
-0001dc80: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
-0001dc90: 3230 3232 2c20 3130 2c20 3129 292c 2052  2022, 10, 1)), R
-0001dca0: 6f77 2854 5255 4e43 2822 4122 2c20 2751  ow(TRUNC("A", 'Q
-0001dcb0: 5541 5254 4552 2729 3d64 6174 6574 696d  UARTER')=datetim
-0001dcc0: 652e 6461 7465 2832 3032 322c 2031 2c20  e.date(2022, 1, 
-0001dcd0: 3129 292c 2052 6f77 2854 5255 4e43 2822  1)), Row(TRUNC("
-0001dce0: 4122 2c20 2751 5541 5254 4552 2729 3d64  A", 'QUARTER')=d
-0001dcf0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
-0001dd00: 322c 2037 2c20 3129 295d 0a0a 2020 2020  2, 7, 1))]..    
-0001dd10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001dd20: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
-0001dd30: 7261 6d65 285b 6461 7465 7469 6d65 2e64  rame([datetime.d
-0001dd40: 6174 6574 696d 6528 3230 3232 2c20 3132  atetime(2022, 12
-0001dd50: 2c20 3235 2c20 3133 2c20 3539 2c20 3338  , 25, 13, 59, 38
-0001dd60: 2c20 3436 3729 5d2c 2073 6368 656d 613d  , 467)], schema=
-0001dd70: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-0001dd80: 3e3e 2064 662e 636f 6c6c 6563 7428 290a  >> df.collect().
-0001dd90: 2020 2020 2020 2020 5b52 6f77 2841 3d64          [Row(A=d
-0001dda0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0001ddb0: 2832 3032 322c 2031 322c 2032 352c 2031  (2022, 12, 25, 1
-0001ddc0: 332c 2035 392c 2033 382c 2034 3637 2929  3, 59, 38, 467))
-0001ddd0: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-0001dde0: 2e73 656c 6563 7428 7472 756e 6328 636f  .select(trunc(co
-0001ddf0: 6c28 2261 2229 2c20 6c69 7428 224d 494e  l("a"), lit("MIN
-0001de00: 5554 4522 2929 292e 636f 6c6c 6563 7428  UTE"))).collect(
-0001de10: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
-0001de20: 5255 4e43 2822 4122 2c20 274d 494e 5554  RUNC("A", 'MINUT
-0001de30: 4527 293d 6461 7465 7469 6d65 2e64 6174  E')=datetime.dat
-0001de40: 6574 696d 6528 3230 3232 2c20 3132 2c20  etime(2022, 12, 
-0001de50: 3235 2c20 3133 2c20 3539 2929 5d0a 0a20  25, 13, 59))].. 
-0001de60: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0001de70: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0001de80: 2022 7472 756e 6322 290a 2020 2020 7363   "trunc").    sc
-0001de90: 616c 655f 636f 6c20 3d20 280a 2020 2020  ale_col = (.    
-0001dea0: 2020 2020 6c69 7428 7363 616c 6529 0a20      lit(scale). 
-0001deb0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001dec0: 616e 6365 2873 6361 6c65 2c20 2869 6e74  ance(scale, (int
-0001ded0: 2c20 666c 6f61 7429 290a 2020 2020 2020  , float)).      
-0001dee0: 2020 656c 7365 205f 746f 5f63 6f6c 5f69    else _to_col_i
-0001def0: 665f 7374 7228 7363 616c 652c 2022 7472  f_str(scale, "tr
-0001df00: 756e 6322 290a 2020 2020 290a 2020 2020  unc").    ).    
-0001df10: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0001df20: 7472 756e 6322 2928 632c 2073 6361 6c65  trunc")(c, scale
-0001df30: 5f63 6f6c 290a 0a0a 6465 6620 6461 7465  _col)...def date
-0001df40: 6164 6428 7061 7274 3a20 7374 722c 2063  add(part: str, c
-0001df50: 6f6c 313a 2043 6f6c 756d 6e4f 724e 616d  ol1: ColumnOrNam
-0001df60: 652c 2063 6f6c 323a 2043 6f6c 756d 6e4f  e, col2: ColumnO
-0001df70: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0001df80: 3a0a 2020 2020 2222 2241 6464 7320 7468  :.    """Adds th
-0001df90: 6520 7370 6563 6966 6965 6420 7661 6c75  e specified valu
-0001dfa0: 6520 666f 7220 7468 6520 7370 6563 6966  e for the specif
-0001dfb0: 6965 6420 6461 7465 206f 7220 7469 6d65  ied date or time
-0001dfc0: 2070 6172 7420 746f 2064 6174 6520 6f72   part to date or
-0001dfd0: 2074 696d 6520 6578 7072 2e0a 0a20 2020   time expr...   
-0001dfe0: 2060 5375 7070 6f72 7465 6420 6461 7465   `Supported date
-0001dff0: 2061 6e64 2074 696d 6520 7061 7274 7320   and time parts 
-0001e000: 3c68 7474 7073 3a2f 2f64 6f63 732e 736e  <https://docs.sn
-0001e010: 6f77 666c 616b 652e 636f 6d2f 656e 2f73  owflake.com/en/s
-0001e020: 716c 2d72 6566 6572 656e 6365 2f66 756e  ql-reference/fun
-0001e030: 6374 696f 6e73 2d64 6174 652d 7469 6d65  ctions-date-time
-0001e040: 2e68 746d 6c23 6c61 6265 6c2d 7375 7070  .html#label-supp
-0001e050: 6f72 7465 642d 6461 7465 2d74 696d 652d  orted-date-time-
-0001e060: 7061 7274 733e 605f 0a0a 2020 2020 4578  parts>`_..    Ex
-0001e070: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0001e080: 203e 3e3e 2023 2061 6464 206f 6e65 2079   >>> # add one y
-0001e090: 6561 7220 6f6e 2064 6174 6573 0a20 2020  ear on dates.   
-0001e0a0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
-0001e0b0: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
-0001e0c0: 203e 3e3e 2064 6174 655f 6466 203d 2073   >>> date_df = s
-0001e0d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001e0e0: 7461 6672 616d 6528 5b5b 6461 7465 7469  taframe([[dateti
-0001e0f0: 6d65 2e64 6174 6528 3230 3230 2c20 312c  me.date(2020, 1,
-0001e100: 2031 295d 5d2c 2073 6368 656d 613d 5b22   1)]], schema=["
-0001e110: 6461 7465 5f63 6f6c 225d 290a 2020 2020  date_col"]).    
-0001e120: 2020 2020 3e3e 3e20 6461 7465 5f64 662e      >>> date_df.
-0001e130: 7365 6c65 6374 2864 6174 6561 6464 2822  select(dateadd("
-0001e140: 7965 6172 222c 206c 6974 2831 292c 2063  year", lit(1), c
-0001e150: 6f6c 2822 6461 7465 5f63 6f6c 2229 292e  ol("date_col")).
-0001e160: 616c 6961 7328 2279 6561 725f 6164 6465  alias("year_adde
-0001e170: 6422 2929 2e73 686f 7728 290a 2020 2020  d")).show().    
-0001e180: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0001e190: 2d2d 2d2d 0a20 2020 2020 2020 207c 2259  ----.        |"Y
-0001e1a0: 4541 525f 4144 4445 4422 2020 7c0a 2020  EAR_ADDED"  |.  
-0001e1b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001e1c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0001e1d0: 3230 3231 2d30 312d 3031 2020 2020 7c0a  2021-01-01    |.
-0001e1e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001e1f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001e200: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-0001e210: 2020 2020 203e 3e3e 2064 6174 655f 6466       >>> date_df
-0001e220: 2e73 656c 6563 7428 6461 7465 6164 6428  .select(dateadd(
-0001e230: 226d 6f6e 7468 222c 206c 6974 2831 292c  "month", lit(1),
-0001e240: 2063 6f6c 2822 6461 7465 5f63 6f6c 2229   col("date_col")
-0001e250: 292e 616c 6961 7328 226d 6f6e 7468 5f61  ).alias("month_a
-0001e260: 6464 6564 2229 292e 7368 6f77 2829 0a20  dded")).show(). 
-0001e270: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001e280: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0001e290: 207c 224d 4f4e 5448 5f41 4444 4544 2220   |"MONTH_ADDED" 
-0001e2a0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001e2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001e2c0: 2020 2020 207c 3230 3230 2d30 322d 3031       |2020-02-01
-0001e2d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0001e2e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001e2f0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0001e300: 494e 453e 0a20 2020 2020 2020 203e 3e3e  INE>.        >>>
-0001e310: 2064 6174 655f 6466 2e73 656c 6563 7428   date_df.select(
-0001e320: 6461 7465 6164 6428 2264 6179 222c 206c  dateadd("day", l
-0001e330: 6974 2831 292c 2063 6f6c 2822 6461 7465  it(1), col("date
-0001e340: 5f63 6f6c 2229 292e 616c 6961 7328 2264  _col")).alias("d
-0001e350: 6179 5f61 6464 6564 2229 292e 7368 6f77  ay_added")).show
-0001e360: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0001e370: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001e380: 2020 207c 2244 4159 5f41 4444 4544 2220     |"DAY_ADDED" 
-0001e390: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001e3a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001e3b0: 2020 207c 3230 3230 2d30 312d 3032 2020     |2020-01-02  
-0001e3c0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0001e3d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001e3e0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
-0001e3f0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0001e400: 2020 7061 7274 3a20 5468 6520 7469 6d65    part: The time
-0001e410: 2070 6172 7420 746f 2075 7365 2066 6f72   part to use for
-0001e420: 2074 6865 2061 6464 6974 696f 6e0a 2020   the addition.  
-0001e430: 2020 2020 2020 636f 6c31 3a20 5468 6520        col1: The 
-0001e440: 6669 7273 7420 7469 6d65 7374 616d 7020  first timestamp 
-0001e450: 636f 6c75 6d6e 206f 7220 6164 6465 6e64  column or addend
-0001e460: 2069 6e20 7468 6520 6461 7465 6164 640a   in the dateadd.
-0001e470: 2020 2020 2020 2020 636f 6c32 3a20 5468          col2: Th
-0001e480: 6520 7365 636f 6e64 2074 696d 6573 7461  e second timesta
-0001e490: 6d70 2063 6f6c 756d 6e20 6f72 2074 6865  mp column or the
-0001e4a0: 2061 6464 656e 6420 696e 2074 6865 2064   addend in the d
-0001e4b0: 6174 6561 6464 0a20 2020 2022 2222 0a20  ateadd.    """. 
-0001e4c0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0001e4d0: 616e 6365 2870 6172 742c 2073 7472 293a  ance(part, str):
-0001e4e0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0001e4f0: 616c 7565 4572 726f 7228 2270 6172 7420  alueError("part 
-0001e500: 6d75 7374 2062 6520 6120 7374 7269 6e67  must be a string
-0001e510: 2229 0a20 2020 2063 3120 3d20 5f74 6f5f  ").    c1 = _to_
-0001e520: 636f 6c5f 6966 5f73 7472 2863 6f6c 312c  col_if_str(col1,
-0001e530: 2022 6461 7465 6164 6422 290a 2020 2020   "dateadd").    
-0001e540: 6332 203d 205f 746f 5f63 6f6c 5f69 665f  c2 = _to_col_if_
-0001e550: 7374 7228 636f 6c32 2c20 2264 6174 6561  str(col2, "datea
-0001e560: 6464 2229 0a20 2020 2072 6574 7572 6e20  dd").    return 
-0001e570: 6275 696c 7469 6e28 2264 6174 6561 6464  builtin("dateadd
-0001e580: 2229 2870 6172 742c 2063 312c 2063 3229  ")(part, c1, c2)
-0001e590: 0a0a 0a64 6566 2064 6174 655f 7061 7274  ...def date_part
-0001e5a0: 2870 6172 743a 2073 7472 2c20 653a 2043  (part: str, e: C
-0001e5b0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0001e5c0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-0001e5d0: 2020 2020 4578 7472 6163 7473 2074 6865      Extracts the
-0001e5e0: 2073 7065 6369 6669 6564 2064 6174 6520   specified date 
-0001e5f0: 6f72 2074 696d 6520 7061 7274 2066 726f  or time part fro
-0001e600: 6d20 6120 6461 7465 2c20 7469 6d65 2c20  m a date, time, 
-0001e610: 6f72 2074 696d 6573 7461 6d70 2e20 5365  or timestamp. Se
-0001e620: 650a 2020 2020 6044 4154 455f 5041 5254  e.    `DATE_PART
-0001e630: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-0001e640: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-0001e650: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
-0001e660: 6e63 7469 6f6e 732f 6461 7465 5f70 6172  nctions/date_par
-0001e670: 742e 6874 6d6c 3e60 5f20 666f 7220 6465  t.html>`_ for de
-0001e680: 7461 696c 732e 0a0a 2020 2020 4172 6773  tails...    Args
-0001e690: 3a0a 2020 2020 2020 2020 7061 7274 3a20  :.        part: 
-0001e6a0: 5468 6520 7469 6d65 2070 6172 7420 746f  The time part to
-0001e6b0: 2075 7365 2066 6f72 2074 6865 2061 6464   use for the add
-0001e6c0: 6974 696f 6e2e 0a20 2020 2020 2020 2065  ition..        e
-0001e6d0: 3a20 5468 6520 636f 6c75 6d6e 2065 7870  : The column exp
-0001e6e0: 7265 7373 696f 6e20 6f66 2061 2064 6174  ression of a dat
-0001e6f0: 652c 2074 696d 652c 206f 7220 7469 6d65  e, time, or time
-0001e700: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
-0001e710: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-0001e720: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-0001e730: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-0001e740: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0001e750: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
-0001e760: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0001e770: 2832 3032 332c 2031 2c20 312c 2031 2c20  (2023, 1, 1, 1, 
-0001e780: 312c 2031 295d 5d2c 2073 6368 656d 613d  1, 1)]], schema=
-0001e790: 5b22 7473 5f63 6f6c 225d 290a 2020 2020  ["ts_col"]).    
-0001e7a0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0001e7b0: 7428 6461 7465 5f70 6172 7428 2279 6561  t(date_part("yea
-0001e7c0: 7222 2c20 636f 6c28 2274 735f 636f 6c22  r", col("ts_col"
-0001e7d0: 2929 2e61 6c69 6173 2822 7965 6172 2229  )).alias("year")
-0001e7e0: 2c20 6461 7465 5f70 6172 7428 2265 706f  , date_part("epo
-0001e7f0: 6368 5f73 6563 6f6e 6422 2c20 636f 6c28  ch_second", col(
-0001e800: 2274 735f 636f 6c22 2929 2e61 6c69 6173  "ts_col")).alias
-0001e810: 2822 6570 6f63 685f 7365 636f 6e64 2229  ("epoch_second")
-0001e820: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0001e830: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001e840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001e850: 2020 2020 207c 2259 4541 5222 2020 7c22       |"YEAR"  |"
-0001e860: 4550 4f43 485f 5345 434f 4e44 2220 207c  EPOCH_SECOND"  |
-0001e870: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001e880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001e890: 2d2d 2d2d 0a20 2020 2020 2020 207c 3230  ----.        |20
-0001e8a0: 3233 2020 2020 7c31 3637 3235 3334 3836  23    |167253486
-0001e8b0: 3120 2020 2020 207c 0a20 2020 2020 2020  1      |.       
-0001e8c0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0001e8d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0001e8e0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0001e8f0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-0001e900: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-0001e910: 6172 742c 2073 7472 293a 0a20 2020 2020  art, str):.     
-0001e920: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001e930: 726f 7228 2270 6172 7420 6d75 7374 2062  ror("part must b
-0001e940: 6520 6120 7374 7269 6e67 2229 0a20 2020  e a string").   
-0001e950: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-0001e960: 7374 7228 652c 2022 6461 7465 5f70 6172  str(e, "date_par
-0001e970: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
-0001e980: 7569 6c74 696e 2822 6461 7465 5f70 6172  uiltin("date_par
-0001e990: 7422 2928 7061 7274 2c20 6329 0a0a 0a64  t")(part, c)...d
-0001e9a0: 6566 2064 6174 655f 6672 6f6d 5f70 6172  ef date_from_par
-0001e9b0: 7473 280a 2020 2020 793a 2055 6e69 6f6e  ts(.    y: Union
-0001e9c0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-0001e9d0: 6e74 5d2c 0a20 2020 206d 3a20 556e 696f  nt],.    m: Unio
-0001e9e0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-0001e9f0: 696e 745d 2c0a 2020 2020 643a 2055 6e69  int],.    d: Uni
-0001ea00: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-0001ea10: 2069 6e74 5d2c 0a29 202d 3e20 436f 6c75   int],.) -> Colu
-0001ea20: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0001ea30: 4372 6561 7465 7320 6120 6461 7465 2066  Creates a date f
-0001ea40: 726f 6d20 696e 6469 7669 6475 616c 206e  rom individual n
-0001ea50: 756d 6572 6963 2063 6f6d 706f 6e65 6e74  umeric component
-0001ea60: 7320 7468 6174 2072 6570 7265 7365 6e74  s that represent
-0001ea70: 2074 6865 2079 6561 722c 206d 6f6e 7468   the year, month
-0001ea80: 2c20 616e 6420 6461 7920 6f66 2074 6865  , and day of the
-0001ea90: 206d 6f6e 7468 2e0a 0a20 2020 2045 7861   month...    Exa
-0001eaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-0001eab0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0001eac0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0001ead0: 285b 5b32 3032 322c 2034 2c20 315d 5d2c  ([[2022, 4, 1]],
-0001eae0: 2073 6368 656d 613d 5b22 7965 6172 222c   schema=["year",
-0001eaf0: 2022 6d6f 6e74 6822 2c20 2264 6179 225d   "month", "day"]
-0001eb00: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0001eb10: 2e73 656c 6563 7428 6461 7465 5f66 726f  .select(date_fro
-0001eb20: 6d5f 7061 7274 7328 2279 6561 7222 2c20  m_parts("year", 
-0001eb30: 226d 6f6e 7468 222c 2022 6461 7922 2929  "month", "day"))
-0001eb40: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001eb50: 2020 205b 526f 7728 4441 5445 5f46 524f     [Row(DATE_FRO
-0001eb60: 4d5f 5041 5254 5328 2259 4541 5222 2c20  M_PARTS("YEAR", 
-0001eb70: 224d 4f4e 5448 222c 2022 4441 5922 293d  "MONTH", "DAY")=
-0001eb80: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-0001eb90: 3232 2c20 342c 2031 2929 5d0a 2020 2020  22, 4, 1))].    
-0001eba0: 2020 2020 3e3e 3e20 7365 7373 696f 6e2e      >>> session.
-0001ebb0: 7461 626c 6528 2264 7561 6c22 292e 7365  table("dual").se
-0001ebc0: 6c65 6374 2864 6174 655f 6672 6f6d 5f70  lect(date_from_p
-0001ebd0: 6172 7473 2832 3032 322c 2034 2c20 3129  arts(2022, 4, 1)
-0001ebe0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0001ebf0: 2020 2020 5b52 6f77 2844 4154 455f 4652      [Row(DATE_FR
-0001ec00: 4f4d 5f50 4152 5453 2832 3032 322c 2034  OM_PARTS(2022, 4
-0001ec10: 2c20 3129 3d64 6174 6574 696d 652e 6461  , 1)=datetime.da
-0001ec20: 7465 2832 3032 322c 2034 2c20 3129 295d  te(2022, 4, 1))]
-0001ec30: 0a20 2020 2022 2222 0a20 2020 2079 5f63  .    """.    y_c
-0001ec40: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-0001ec50: 7374 725f 6f72 5f69 6e74 2879 2c20 2264  str_or_int(y, "d
-0001ec60: 6174 655f 6672 6f6d 5f70 6172 7473 2229  ate_from_parts")
-0001ec70: 0a20 2020 206d 5f63 6f6c 203d 205f 746f  .    m_col = _to
-0001ec80: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
-0001ec90: 6e74 286d 2c20 2264 6174 655f 6672 6f6d  nt(m, "date_from
-0001eca0: 5f70 6172 7473 2229 0a20 2020 2064 5f63  _parts").    d_c
-0001ecb0: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
-0001ecc0: 7374 725f 6f72 5f69 6e74 2864 2c20 2264  str_or_int(d, "d
-0001ecd0: 6174 655f 6672 6f6d 5f70 6172 7473 2229  ate_from_parts")
-0001ece0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-0001ecf0: 7469 6e28 2264 6174 655f 6672 6f6d 5f70  tin("date_from_p
-0001ed00: 6172 7473 2229 2879 5f63 6f6c 2c20 6d5f  arts")(y_col, m_
-0001ed10: 636f 6c2c 2064 5f63 6f6c 290a 0a0a 6465  col, d_col)...de
-0001ed20: 6620 6461 7465 5f74 7275 6e63 2870 6172  f date_trunc(par
-0001ed30: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
-0001ed40: 2065 7870 723a 2043 6f6c 756d 6e4f 724e   expr: ColumnOrN
-0001ed50: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001ed60: 2020 2020 2222 220a 2020 2020 5472 756e      """.    Trun
-0001ed70: 6361 7465 7320 6120 4441 5445 2c20 5449  cates a DATE, TI
-0001ed80: 4d45 2c20 6f72 2054 494d 4553 5441 4d50  ME, or TIMESTAMP
-0001ed90: 2074 6f20 7468 6520 7370 6563 6966 6965   to the specifie
-0001eda0: 6420 7072 6563 6973 696f 6e2e 0a0a 2020  d precision...  
-0001edb0: 2020 4e6f 7465 2074 6861 7420 7472 756e    Note that trun
-0001edc0: 6361 7469 6f6e 2069 7320 6e6f 7420 7468  cation is not th
-0001edd0: 6520 7361 6d65 2061 7320 6578 7472 6163  e same as extrac
-0001ede0: 7469 6f6e 2e20 466f 7220 6578 616d 706c  tion. For exampl
-0001edf0: 653a 0a20 2020 202d 2054 7275 6e63 6174  e:.    - Truncat
-0001ee00: 696e 6720 6120 7469 6d65 7374 616d 7020  ing a timestamp 
-0001ee10: 646f 776e 2074 6f20 7468 6520 7175 6172  down to the quar
-0001ee20: 7465 7220 7265 7475 726e 7320 7468 6520  ter returns the 
-0001ee30: 7469 6d65 7374 616d 7020 636f 7272 6573  timestamp corres
-0001ee40: 706f 6e64 696e 6720 746f 206d 6964 6e69  ponding to midni
-0001ee50: 6768 7420 6f66 2074 6865 2066 6972 7374  ght of the first
-0001ee60: 2064 6179 206f 6620 7468 650a 2020 2020   day of the.    
-0001ee70: 7175 6172 7465 7220 666f 7220 7468 6520  quarter for the 
-0001ee80: 696e 7075 7420 7469 6d65 7374 616d 702e  input timestamp.
-0001ee90: 0a20 2020 202d 2045 7874 7261 6374 696e  .    - Extractin
-0001eea0: 6720 7468 6520 7175 6172 7465 7220 6461  g the quarter da
-0001eeb0: 7465 2070 6172 7420 6672 6f6d 2061 2074  te part from a t
-0001eec0: 696d 6573 7461 6d70 2072 6574 7572 6e73  imestamp returns
-0001eed0: 2074 6865 2071 7561 7274 6572 206e 756d   the quarter num
-0001eee0: 6265 7220 6f66 2074 6865 2079 6561 7220  ber of the year 
-0001eef0: 696e 2074 6865 2074 696d 6573 7461 6d70  in the timestamp
-0001ef00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0001ef10: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001ef20: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
-0001ef30: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-0001ef40: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-0001ef50: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-0001ef60: 2e2e 2e20 2020 2020 5b5b 6461 7465 7469  ...     [[dateti
-0001ef70: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
-0001ef80: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
-0001ef90: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
-0001efa0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-0001efb0: 2553 2e25 6622 295d 5d2c 0a20 2020 2020  %S.%f")]],.     
-0001efc0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-0001efd0: 613d 5b22 6122 5d2c 0a20 2020 2020 2020  a=["a"],.       
-0001efe0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-0001eff0: 3e3e 2064 662e 7365 6c65 6374 2864 6174  >> df.select(dat
-0001f000: 655f 7472 756e 6328 2259 4541 5222 2c20  e_trunc("YEAR", 
-0001f010: 2261 2229 2c20 6461 7465 5f74 7275 6e63  "a"), date_trunc
-0001f020: 2822 4d4f 4e54 4822 2c20 2261 2229 2c20  ("MONTH", "a"), 
-0001f030: 6461 7465 5f74 7275 6e63 2822 4441 5922  date_trunc("DAY"
-0001f040: 2c20 2261 2229 292e 636f 6c6c 6563 7428  , "a")).collect(
-0001f050: 290a 2020 2020 2020 2020 5b52 6f77 2844  ).        [Row(D
-0001f060: 4154 455f 5452 554e 4328 2259 4541 5222  ATE_TRUNC("YEAR"
-0001f070: 2c20 2241 2229 3d64 6174 6574 696d 652e  , "A")=datetime.
-0001f080: 6461 7465 7469 6d65 2832 3032 302c 2031  datetime(2020, 1
-0001f090: 2c20 312c 2030 2c20 3029 2c20 4441 5445  , 1, 0, 0), DATE
-0001f0a0: 5f54 5255 4e43 2822 4d4f 4e54 4822 2c20  _TRUNC("MONTH", 
-0001f0b0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
-0001f0c0: 7465 7469 6d65 2832 3032 302c 2035 2c20  tetime(2020, 5, 
-0001f0d0: 312c 2030 2c20 3029 2c20 4441 5445 5f54  1, 0, 0), DATE_T
-0001f0e0: 5255 4e43 2822 4441 5922 2c20 2241 2229  RUNC("DAY", "A")
-0001f0f0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-0001f100: 6d65 2832 3032 302c 2035 2c20 312c 2030  me(2020, 5, 1, 0
-0001f110: 2c20 3029 295d 0a20 2020 2020 2020 203e  , 0))].        >
-0001f120: 3e3e 2064 662e 7365 6c65 6374 2864 6174  >> df.select(dat
-0001f130: 655f 7472 756e 6328 2248 4f55 5222 2c20  e_trunc("HOUR", 
-0001f140: 2261 2229 2c20 6461 7465 5f74 7275 6e63  "a"), date_trunc
-0001f150: 2822 4d49 4e55 5445 222c 2022 6122 292c  ("MINUTE", "a"),
-0001f160: 2064 6174 655f 7472 756e 6328 2253 4543   date_trunc("SEC
-0001f170: 4f4e 4422 2c20 2261 2229 292e 636f 6c6c  OND", "a")).coll
-0001f180: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0001f190: 6f77 2844 4154 455f 5452 554e 4328 2248  ow(DATE_TRUNC("H
-0001f1a0: 4f55 5222 2c20 2241 2229 3d64 6174 6574  OUR", "A")=datet
-0001f1b0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-0001f1c0: 302c 2035 2c20 312c 2031 332c 2030 292c  0, 5, 1, 13, 0),
-0001f1d0: 2044 4154 455f 5452 554e 4328 224d 494e   DATE_TRUNC("MIN
-0001f1e0: 5554 4522 2c20 2241 2229 3d64 6174 6574  UTE", "A")=datet
-0001f1f0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-0001f200: 302c 2035 2c20 312c 2031 332c 2031 3129  0, 5, 1, 13, 11)
-0001f210: 2c20 4441 5445 5f54 5255 4e43 2822 5345  , DATE_TRUNC("SE
-0001f220: 434f 4e44 222c 2022 4122 293d 6461 7465  COND", "A")=date
-0001f230: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-0001f240: 3230 2c20 352c 2031 2c20 3133 2c20 3131  20, 5, 1, 13, 11
-0001f250: 2c20 3230 2929 5d0a 2020 2020 2020 2020  , 20))].        
-0001f260: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
-0001f270: 7465 5f74 7275 6e63 2822 5155 4152 5445  te_trunc("QUARTE
-0001f280: 5222 2c20 2261 2229 292e 636f 6c6c 6563  R", "a")).collec
-0001f290: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0001f2a0: 2844 4154 455f 5452 554e 4328 2251 5541  (DATE_TRUNC("QUA
-0001f2b0: 5254 4552 222c 2022 4122 293d 6461 7465  RTER", "A")=date
-0001f2c0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-0001f2d0: 3230 2c20 342c 2031 2c20 302c 2030 2929  20, 4, 1, 0, 0))
-0001f2e0: 5d0a 2020 2020 2222 220a 2020 2020 7061  ].    """.    pa
-0001f2f0: 7274 5f63 6f6c 203d 205f 746f 5f63 6f6c  rt_col = _to_col
-0001f300: 5f69 665f 7374 7228 7061 7274 2c20 2264  _if_str(part, "d
-0001f310: 6174 655f 7472 756e 6322 290a 2020 2020  ate_trunc").    
-0001f320: 6578 7072 5f63 6f6c 203d 205f 746f 5f63  expr_col = _to_c
-0001f330: 6f6c 5f69 665f 7374 7228 6578 7072 2c20  ol_if_str(expr, 
-0001f340: 2264 6174 655f 7472 756e 6322 290a 2020  "date_trunc").  
-0001f350: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0001f360: 2822 6461 7465 5f74 7275 6e63 2229 2870  ("date_trunc")(p
-0001f370: 6172 745f 636f 6c2c 2065 7870 725f 636f  art_col, expr_co
-0001f380: 6c29 0a0a 0a64 6566 2064 6179 6e61 6d65  l)...def dayname
-0001f390: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0001f3a0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001f3b0: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
-0001f3c0: 7320 7468 6520 7468 7265 652d 6c65 7474  s the three-lett
-0001f3d0: 6572 2064 6179 2d6f 662d 7765 656b 206e  er day-of-week n
-0001f3e0: 616d 6520 6672 6f6d 2074 6865 2073 7065  ame from the spe
-0001f3f0: 6369 6669 6564 2064 6174 6520 6f72 2074  cified date or t
-0001f400: 696d 6573 7461 6d70 2e0a 0a20 2020 2045  imestamp...    E
-0001f410: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0001f420: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
-0001f430: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
-0001f440: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-0001f450: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-0001f460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001f470: 5b5b 6461 7465 7469 6d65 2e64 6174 6574  [[datetime.datet
-0001f480: 696d 652e 7374 7270 7469 6d65 2822 3230  ime.strptime("20
-0001f490: 3230 2d30 352d 3031 2031 333a 3131 3a32  20-05-01 13:11:2
-0001f4a0: 302e 3030 3022 2c20 2225 592d 256d 2d25  0.000", "%Y-%m-%
-0001f4b0: 6420 2548 3a25 4d3a 2553 2e25 6622 295d  d %H:%M:%S.%f")]
-0001f4c0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0001f4d0: 2020 2073 6368 656d 613d 5b22 6122 5d2c     schema=["a"],
-0001f4e0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-0001f4f0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0001f500: 6c65 6374 2864 6179 6e61 6d65 2822 6122  lect(dayname("a"
-0001f510: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0001f520: 2020 2020 205b 526f 7728 4441 594e 414d       [Row(DAYNAM
-0001f530: 4528 2241 2229 3d27 4672 6927 295d 0a20  E("A")='Fri')]. 
-0001f540: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0001f550: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0001f560: 2022 6461 796e 616d 6522 290a 2020 2020   "dayname").    
-0001f570: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0001f580: 6461 796e 616d 6522 2928 6329 0a0a 0a64  dayname")(c)...d
-0001f590: 6566 2064 6179 6f66 6d6f 6e74 6828 653a  ef dayofmonth(e:
-0001f5a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0001f5b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0001f5c0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
-0001f5d0: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
-0001f5e0: 2064 6179 2028 6e75 6d62 6572 2920 6f66   day (number) of
-0001f5f0: 2074 6865 206d 6f6e 7468 2066 726f 6d20   the month from 
-0001f600: 6120 6461 7465 206f 7220 7469 6d65 7374  a date or timest
-0001f610: 616d 702e 0a0a 2020 2020 4578 616d 706c  amp...    Exampl
-0001f620: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0001f630: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
-0001f640: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0001f650: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0001f660: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-0001f670: 2020 202e 2e2e 2020 2020 205b 5b64 6174     ...     [[dat
-0001f680: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
-0001f690: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
-0001f6a0: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
-0001f6b0: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
-0001f6c0: 254d 3a25 532e 2566 2229 5d5d 2c0a 2020  %M:%S.%f")]],.  
-0001f6d0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
-0001f6e0: 6865 6d61 3d5b 2261 225d 2c0a 2020 2020  hema=["a"],.    
-0001f6f0: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-0001f700: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001f710: 6461 796f 666d 6f6e 7468 2822 6122 2929  dayofmonth("a"))
-0001f720: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001f730: 2020 205b 526f 7728 4441 594f 464d 4f4e     [Row(DAYOFMON
-0001f740: 5448 2822 4122 293d 3129 5d0a 2020 2020  TH("A")=1)].    
-0001f750: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0001f760: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
-0001f770: 6179 6f66 6d6f 6e74 6822 290a 2020 2020  ayofmonth").    
-0001f780: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0001f790: 6461 796f 666d 6f6e 7468 2229 2863 290a  dayofmonth")(c).
-0001f7a0: 0a0a 6465 6620 6461 796f 6677 6565 6b28  ..def dayofweek(
-0001f7b0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0001f7c0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0001f7d0: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
-0001f7e0: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-0001f7f0: 6e67 2064 6179 2028 6e75 6d62 6572 2920  ng day (number) 
-0001f800: 6f66 2074 6865 2077 6565 6b20 6672 6f6d  of the week from
-0001f810: 2061 2064 6174 6520 6f72 2074 696d 6573   a date or times
-0001f820: 7461 6d70 2e0a 0a20 2020 2045 7861 6d70  tamp...    Examp
-0001f830: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-0001f840: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-0001f850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0001f860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0001f870: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-0001f880: 2020 2020 2e2e 2e20 2020 2020 5b5b 6461      ...     [[da
-0001f890: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
-0001f8a0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
-0001f8b0: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
-0001f8c0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
-0001f8d0: 3a25 4d3a 2553 2e25 6622 295d 5d2c 0a20  :%M:%S.%f")]],. 
-0001f8e0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-0001f8f0: 6368 656d 613d 5b22 6122 5d2c 0a20 2020  chema=["a"],.   
-0001f900: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-0001f910: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-0001f920: 2864 6179 6f66 7765 656b 2822 6122 2929  (dayofweek("a"))
-0001f930: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0001f940: 2020 205b 526f 7728 4441 594f 4657 4545     [Row(DAYOFWEE
-0001f950: 4b28 2241 2229 3d35 295d 0a20 2020 2022  K("A")=5)].    "
-0001f960: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0001f970: 6f6c 5f69 665f 7374 7228 652c 2022 6461  ol_if_str(e, "da
-0001f980: 796f 6677 6565 6b22 290a 2020 2020 7265  yofweek").    re
-0001f990: 7475 726e 2062 7569 6c74 696e 2822 6461  turn builtin("da
-0001f9a0: 796f 6677 6565 6b22 2928 6329 0a0a 0a64  yofweek")(c)...d
-0001f9b0: 6566 2064 6179 6f66 7965 6172 2865 3a20  ef dayofyear(e: 
-0001f9c0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0001f9d0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0001f9e0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
-0001f9f0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
-0001fa00: 6461 7920 286e 756d 6265 7229 206f 6620  day (number) of 
-0001fa10: 7468 6520 7965 6172 2066 726f 6d20 6120  the year from a 
-0001fa20: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
-0001fa30: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
-0001fa40: 3a0a 2020 2020 2020 2020 3e3e 3e20 696d  :.        >>> im
-0001fa50: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
-0001fa60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0001fa70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001fa80: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
-0001fa90: 202e 2e2e 2020 2020 205b 5b64 6174 6574   ...     [[datet
-0001faa0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
-0001fab0: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
-0001fac0: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
-0001fad0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-0001fae0: 3a25 532e 2566 2229 5d5d 2c0a 2020 2020  :%S.%f")]],.    
-0001faf0: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-0001fb00: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
-0001fb10: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
-0001fb20: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
-0001fb30: 796f 6679 6561 7228 2261 2229 292e 636f  yofyear("a")).co
-0001fb40: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0001fb50: 5b52 6f77 2844 4159 4f46 5945 4152 2822  [Row(DAYOFYEAR("
-0001fb60: 4122 293d 3132 3229 5d0a 2020 2020 2222  A")=122)].    ""
-0001fb70: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0001fb80: 6c5f 6966 5f73 7472 2865 2c20 2264 6179  l_if_str(e, "day
-0001fb90: 6f66 7965 6172 2229 0a20 2020 2072 6574  ofyear").    ret
-0001fba0: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
-0001fbb0: 6f66 7965 6172 2229 2863 290a 0a0a 6465  ofyear")(c)...de
-0001fbc0: 6620 6973 5f61 7272 6179 2863 6f6c 3a20  f is_array(col: 
-0001fbd0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-0001fbe0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-0001fbf0: 0a20 2020 2052 6574 7572 6e73 2074 7275  .    Returns tru
-0001fc00: 6520 6966 2074 6865 2073 7065 6369 6669  e if the specifi
-0001fc10: 6564 2056 4152 4941 4e54 2063 6f6c 756d  ed VARIANT colum
-0001fc20: 6e20 636f 6e74 6169 6e73 2061 6e20 4152  n contains an AR
-0001fc30: 5241 5920 7661 6c75 652e 0a0a 2020 2020  RAY value...    
-0001fc40: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
-0001fc50: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0001fc60: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0001fc70: 6672 616d 6528 5b5b 5b22 656c 656d 656e  frame([[["elemen
-0001fc80: 7422 5d2c 2054 7275 655d 5d2c 2073 6368  t"], True]], sch
-0001fc90: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
-0001fca0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0001fcb0: 656c 6563 7428 6973 5f61 7272 6179 2864  elect(is_array(d
-0001fcc0: 665b 2261 225d 292e 616c 6961 7328 2269  f["a"]).alias("i
-0001fcd0: 735f 6172 7261 795f 6122 292c 2069 735f  s_array_a"), is_
-0001fce0: 6172 7261 7928 6466 5b22 6222 5d29 2e61  array(df["b"]).a
-0001fcf0: 6c69 6173 2822 6973 5f61 7272 6179 5f62  lias("is_array_b
-0001fd00: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-0001fd10: 2020 2020 2020 5b52 6f77 2849 535f 4152        [Row(IS_AR
-0001fd20: 5241 595f 413d 5472 7565 2c20 4953 5f41  RAY_A=True, IS_A
-0001fd30: 5252 4159 5f42 3d46 616c 7365 295d 0a20  RRAY_B=False)]. 
-0001fd40: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0001fd50: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-0001fd60: 6c2c 2022 6973 5f61 7272 6179 2229 0a20  l, "is_array"). 
-0001fd70: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0001fd80: 6e28 2269 735f 6172 7261 7922 2928 6329  n("is_array")(c)
-0001fd90: 0a0a 0a64 6566 2069 735f 626f 6f6c 6561  ...def is_boolea
-0001fda0: 6e28 636f 6c3a 2043 6f6c 756d 6e4f 724e  n(col: ColumnOrN
-0001fdb0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0001fdc0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0001fdd0: 726e 7320 7472 7565 2069 6620 7468 6520  rns true if the 
-0001fde0: 7370 6563 6966 6965 6420 5641 5249 414e  specified VARIAN
-0001fdf0: 5420 636f 6c75 6d6e 2063 6f6e 7461 696e  T column contain
-0001fe00: 7320 6120 626f 6f6c 6561 6e20 7661 6c75  s a boolean valu
-0001fe10: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
-0001fe20: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001fe30: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0001fe40: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0001fe50: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
-0001fe60: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
-0001fe70: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0001fe80: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0001fe90: 7461 6672 616d 6528 5b5b 5472 7565 2c20  taframe([[True, 
-0001fea0: 2758 275d 5d2c 2073 6368 656d 613d 5b22  'X']], schema=["
-0001feb0: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
-0001fec0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0001fed0: 6973 5f62 6f6f 6c65 616e 2874 6f5f 7661  is_boolean(to_va
-0001fee0: 7269 616e 7428 6466 5b22 6122 5d29 292e  riant(df["a"])).
-0001fef0: 616c 6961 7328 2262 6f6f 6c65 616e 2229  alias("boolean")
-0001ff00: 2c20 6973 5f62 6f6f 6c65 616e 2874 6f5f  , is_boolean(to_
-0001ff10: 7661 7269 616e 7428 6466 5b22 6222 5d29  variant(df["b"])
-0001ff20: 292e 616c 6961 7328 2276 6172 6368 6172  ).alias("varchar
-0001ff30: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-0001ff40: 2020 2020 2020 5b52 6f77 2842 4f4f 4c45        [Row(BOOLE
-0001ff50: 414e 3d54 7275 652c 2056 4152 4348 4152  AN=True, VARCHAR
-0001ff60: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
-0001ff70: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0001ff80: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
-0001ff90: 5f62 6f6f 6c65 616e 2229 0a20 2020 2072  _boolean").    r
-0001ffa0: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
-0001ffb0: 735f 626f 6f6c 6561 6e22 2928 6329 0a0a  s_boolean")(c)..
-0001ffc0: 0a64 6566 2069 735f 6269 6e61 7279 2863  .def is_binary(c
-0001ffd0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
-0001ffe0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0001fff0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00020000: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
-00020010: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
-00020020: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
-00020030: 2062 696e 6172 7920 7661 6c75 652e 0a0a   binary value...
-00020040: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
-00020050: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00020060: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00020070: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
-00020080: 2053 7472 7563 7446 6965 6c64 2c20 5661   StructField, Va
-00020090: 7269 616e 7454 7970 650a 2020 2020 2020  riantType.      
-000200a0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-000200b0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-000200c0: 616d 6528 5b5b 6222 736e 6f77 222c 2022  ame([[b"snow", "
-000200d0: 736e 6f77 225d 5d2c 2073 6368 656d 613d  snow"]], schema=
-000200e0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
-000200f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00020100: 7428 6973 5f62 696e 6172 7928 746f 5f76  t(is_binary(to_v
-00020110: 6172 6961 6e74 2864 665b 2261 225d 2929  ariant(df["a"]))
-00020120: 2e61 6c69 6173 2822 6269 6e61 7279 2229  .alias("binary")
-00020130: 2c20 6973 5f62 696e 6172 7928 746f 5f76  , is_binary(to_v
-00020140: 6172 6961 6e74 2864 665b 2262 225d 2929  ariant(df["b"]))
-00020150: 2e61 6c69 6173 2822 7661 7263 6861 7222  .alias("varchar"
-00020160: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00020170: 2020 2020 205b 526f 7728 4249 4e41 5259       [Row(BINARY
-00020180: 3d54 7275 652c 2056 4152 4348 4152 3d46  =True, VARCHAR=F
-00020190: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
-000201a0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-000201b0: 665f 7374 7228 636f 6c2c 2022 6973 5f62  f_str(col, "is_b
-000201c0: 696e 6172 7922 290a 2020 2020 7265 7475  inary").    retu
-000201d0: 726e 2062 7569 6c74 696e 2822 6973 5f62  rn builtin("is_b
-000201e0: 696e 6172 7922 2928 6329 0a0a 0a64 6566  inary")(c)...def
-000201f0: 2069 735f 6368 6172 2863 6f6c 3a20 436f   is_char(col: Co
-00020200: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00020210: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00020220: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-00020230: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
-00020240: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
-00020250: 636f 6e74 6169 6e73 2061 2073 7472 696e  contains a strin
-00020260: 672e 0a0a 2020 2020 4578 616d 706c 6573  g...    Examples
-00020270: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00020280: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00020290: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-000202a0: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
-000202b0: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
-000202c0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000202d0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-000202e0: 7461 6672 616d 6528 5b5b 2261 6263 222c  taframe([["abc",
-000202f0: 2031 3233 5d5d 2c20 7363 6865 6d61 3d5b   123]], schema=[
-00020300: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
-00020310: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00020320: 2869 735f 6368 6172 2874 6f5f 7661 7269  (is_char(to_vari
-00020330: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
-00020340: 6961 7328 2276 6172 6368 6172 2229 2c20  ias("varchar"), 
-00020350: 6973 5f63 6861 7228 746f 5f76 6172 6961  is_char(to_varia
-00020360: 6e74 2864 665b 2262 225d 2929 2e61 6c69  nt(df["b"])).ali
-00020370: 6173 2822 696e 7422 2929 2e63 6f6c 6c65  as("int")).colle
-00020380: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00020390: 7728 5641 5243 4841 523d 5472 7565 2c20  w(VARCHAR=True, 
-000203a0: 494e 543d 4661 6c73 6529 5d0a 2020 2020  INT=False)].    
-000203b0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-000203c0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-000203d0: 2269 735f 6368 6172 2229 0a20 2020 2072  "is_char").    r
-000203e0: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
-000203f0: 735f 6368 6172 2229 2863 290a 0a0a 6973  s_char")(c)...is
-00020400: 5f76 6172 6368 6172 203d 2069 735f 6368  _varchar = is_ch
-00020410: 6172 0a0a 0a64 6566 2069 735f 6461 7465  ar...def is_date
-00020420: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-00020430: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00020440: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
-00020450: 6e73 2074 7275 6520 6966 2074 6865 2073  ns true if the s
-00020460: 7065 6369 6669 6564 2056 4152 4941 4e54  pecified VARIANT
-00020470: 2063 6f6c 756d 6e20 636f 6e74 6169 6e73   column contains
-00020480: 2061 2064 6174 6520 7661 6c75 652e 0a0a   a date value...
-00020490: 2020 2020 4578 616d 706c 6573 3a3a 0a0a      Examples::..
-000204a0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-000204b0: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
-000204c0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-000204d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000204e0: 7479 7065 7320 696d 706f 7274 2053 7472  types import Str
-000204f0: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
-00020500: 7454 7970 650a 2020 2020 2020 2020 3e3e  tType.        >>
-00020510: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00020520: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00020530: 5b5b 6461 7465 7469 6d65 2e64 6174 6528  [[datetime.date(
-00020540: 3230 3233 2c20 332c 2032 292c 2031 3233  2023, 3, 2), 123
-00020550: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
-00020560: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
-00020570: 3e3e 2064 662e 7365 6c65 6374 2869 735f  >> df.select(is_
-00020580: 6461 7465 2874 6f5f 7661 7269 616e 7428  date(to_variant(
-00020590: 6466 5b22 6122 5d29 292e 616c 6961 7328  df["a"])).alias(
-000205a0: 2264 6174 6522 292c 2069 735f 6461 7465  "date"), is_date
-000205b0: 2874 6f5f 7661 7269 616e 7428 6466 5b22  (to_variant(df["
-000205c0: 6222 5d29 292e 616c 6961 7328 2269 6e74  b"])).alias("int
-000205d0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-000205e0: 2020 2020 2020 5b52 6f77 2844 4154 453d        [Row(DATE=
-000205f0: 5472 7565 2c20 494e 543d 4661 6c73 6529  True, INT=False)
-00020600: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-00020610: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00020620: 2863 6f6c 2c20 2269 735f 6461 7465 2229  (col, "is_date")
-00020630: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00020640: 7469 6e28 2269 735f 6461 7465 2229 2863  tin("is_date")(c
-00020650: 290a 0a0a 6973 5f64 6174 655f 7661 6c75  )...is_date_valu
-00020660: 6520 3d20 6973 5f64 6174 650a 0a0a 6465  e = is_date...de
-00020670: 6620 6973 5f64 6563 696d 616c 2863 6f6c  f is_decimal(col
-00020680: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00020690: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-000206a0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-000206b0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
-000206c0: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
-000206d0: 756d 6e20 636f 6e74 6169 6e73 2061 2066  umn contains a f
-000206e0: 6978 6564 2d70 6f69 6e74 2064 6563 696d  ixed-point decim
-000206f0: 616c 2076 616c 7565 206f 7220 696e 7465  al value or inte
-00020700: 6765 722e 0a0a 2020 2020 4578 616d 706c  ger...    Exampl
-00020710: 6573 3a3a 0a0a 2020 2020 2020 2020 3e3e  es::..        >>
-00020720: 3e20 696d 706f 7274 2064 6563 696d 616c  > import decimal
-00020730: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00020740: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00020750: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00020760: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
-00020770: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
-00020780: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00020790: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-000207a0: 7261 6d65 285b 5b64 6563 696d 616c 2e44  rame([[decimal.D
-000207b0: 6563 696d 616c 2831 292c 2022 5822 5d5d  ecimal(1), "X"]]
-000207c0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
-000207d0: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
-000207e0: 2064 662e 7365 6c65 6374 2869 735f 6465   df.select(is_de
-000207f0: 6369 6d61 6c28 746f 5f76 6172 6961 6e74  cimal(to_variant
-00020800: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
-00020810: 2822 6465 6369 6d61 6c22 292c 2069 735f  ("decimal"), is_
-00020820: 6465 6369 6d61 6c28 746f 5f76 6172 6961  decimal(to_varia
-00020830: 6e74 2864 665b 2262 225d 2929 2e61 6c69  nt(df["b"])).ali
-00020840: 6173 2822 7661 7263 6861 7222 2929 2e63  as("varchar")).c
-00020850: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00020860: 205b 526f 7728 4445 4349 4d41 4c3d 5472   [Row(DECIMAL=Tr
-00020870: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
-00020880: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-00020890: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-000208a0: 7472 2863 6f6c 2c20 2269 735f 6465 6369  tr(col, "is_deci
-000208b0: 6d61 6c22 290a 2020 2020 7265 7475 726e  mal").    return
-000208c0: 2062 7569 6c74 696e 2822 6973 5f64 6563   builtin("is_dec
-000208d0: 696d 616c 2229 2863 290a 0a0a 6465 6620  imal")(c)...def 
-000208e0: 6973 5f64 6f75 626c 6528 636f 6c3a 2043  is_double(col: C
-000208f0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00020900: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00020910: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
-00020920: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
-00020930: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
-00020940: 2063 6f6e 7461 696e 7320 6120 666c 6f61   contains a floa
-00020950: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
-00020960: 2c20 6669 7865 642d 706f 696e 7420 6465  , fixed-point de
-00020970: 6369 6d61 6c2c 206f 7220 696e 7465 6765  cimal, or intege
-00020980: 722e 0a0a 2020 2020 4578 616d 706c 6573  r...    Examples
-00020990: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-000209a0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-000209b0: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-000209c0: 706f 7274 2053 7472 7563 7446 6965 6c64  port StructField
-000209d0: 2c20 5661 7269 616e 7454 7970 650a 2020  , VariantType.  
-000209e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-000209f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00020a00: 7461 6672 616d 6528 5b5b 312e 322c 2022  taframe([[1.2, "
-00020a10: 5822 5d5d 2c20 7363 6865 6d61 3d5b 2261  X"]], schema=["a
-00020a20: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-00020a30: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
-00020a40: 735f 646f 7562 6c65 2874 6f5f 7661 7269  s_double(to_vari
-00020a50: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
-00020a60: 6961 7328 2264 6f75 626c 6522 292c 2069  ias("double"), i
-00020a70: 735f 646f 7562 6c65 2874 6f5f 7661 7269  s_double(to_vari
-00020a80: 616e 7428 6466 5b22 6222 5d29 292e 616c  ant(df["b"])).al
-00020a90: 6961 7328 2276 6172 6368 6172 2229 292e  ias("varchar")).
-00020aa0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00020ab0: 2020 5b52 6f77 2844 4f55 424c 453d 5472    [Row(DOUBLE=Tr
-00020ac0: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
-00020ad0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
-00020ae0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-00020af0: 7472 2863 6f6c 2c20 2269 735f 646f 7562  tr(col, "is_doub
-00020b00: 6c65 2229 0a20 2020 2072 6574 7572 6e20  le").    return 
-00020b10: 6275 696c 7469 6e28 2269 735f 646f 7562  builtin("is_doub
-00020b20: 6c65 2229 2863 290a 0a0a 6465 6620 6973  le")(c)...def is
-00020b30: 5f72 6561 6c28 636f 6c3a 2043 6f6c 756d  _real(col: Colum
-00020b40: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00020b50: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00020b60: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
-00020b70: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
-00020b80: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
-00020b90: 7461 696e 7320 6120 666c 6f61 7469 6e67  tains a floating
-00020ba0: 2d70 6f69 6e74 2076 616c 7565 2c20 6669  -point value, fi
-00020bb0: 7865 642d 706f 696e 7420 6465 6369 6d61  xed-point decima
-00020bc0: 6c2c 206f 7220 696e 7465 6765 722e 0a0a  l, or integer...
-00020bd0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00020be0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00020bf0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00020c00: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-00020c10: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
-00020c20: 6973 5f72 6561 6c0a 2020 2020 2020 2020  is_real.        
-00020c30: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00020c40: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00020c50: 6528 5b5b 312e 322c 2022 5822 5d5d 2c20  e([[1.2, "X"]], 
-00020c60: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
-00020c70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00020c80: 662e 7365 6c65 6374 2869 735f 7265 616c  f.select(is_real
-00020c90: 2874 6f5f 7661 7269 616e 7428 2261 2229  (to_variant("a")
-00020ca0: 292e 6173 5f28 2261 2229 2c20 6973 5f72  ).as_("a"), is_r
-00020cb0: 6561 6c28 746f 5f76 6172 6961 6e74 2822  eal(to_variant("
-00020cc0: 6222 2929 2e61 735f 2822 6222 2929 2e63  b")).as_("b")).c
-00020cd0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00020ce0: 205b 526f 7728 413d 5472 7565 2c20 423d   [Row(A=True, B=
-00020cf0: 4661 6c73 6529 5d0a 2020 2020 2222 220a  False)].    """.
-00020d00: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00020d10: 6966 5f73 7472 2863 6f6c 2c20 2269 735f  if_str(col, "is_
-00020d20: 7265 616c 2229 0a20 2020 2072 6574 7572  real").    retur
-00020d30: 6e20 6275 696c 7469 6e28 2269 735f 7265  n builtin("is_re
-00020d40: 616c 2229 2863 290a 0a0a 6465 6620 6973  al")(c)...def is
-00020d50: 5f69 6e74 6567 6572 2863 6f6c 3a20 436f  _integer(col: Co
-00020d60: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-00020d70: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
-00020d80: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
-00020d90: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
-00020da0: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
-00020db0: 636f 6e74 6169 6e73 2061 2069 6e74 6567  contains a integ
-00020dc0: 6572 2076 616c 7565 2e0a 0a20 2020 2045  er value...    E
-00020dd0: 7861 6d70 6c65 733a 3a0a 0a20 2020 2020  xamples::..     
-00020de0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00020df0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-00020e00: 7970 6573 2069 6d70 6f72 7420 5374 7275  ypes import Stru
-00020e10: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
-00020e20: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-00020e30: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00020e40: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00020e50: 5b31 2c20 2258 225d 5d2c 2073 6368 656d  [1, "X"]], schem
-00020e60: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
-00020e70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00020e80: 6563 7428 6973 5f69 6e74 6567 6572 2874  ect(is_integer(t
-00020e90: 6f5f 7661 7269 616e 7428 6466 5b22 6122  o_variant(df["a"
-00020ea0: 5d29 292e 616c 6961 7328 2269 6e74 2229  ])).alias("int")
-00020eb0: 2c20 6973 5f69 6e74 6567 6572 2874 6f5f  , is_integer(to_
-00020ec0: 7661 7269 616e 7428 6466 5b22 6222 5d29  variant(df["b"])
-00020ed0: 292e 616c 6961 7328 2276 6172 6368 6172  ).alias("varchar
-00020ee0: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00020ef0: 2020 2020 2020 5b52 6f77 2849 4e54 3d54        [Row(INT=T
-00020f00: 7275 652c 2056 4152 4348 4152 3d46 616c  rue, VARCHAR=Fal
-00020f10: 7365 295d 0a20 2020 2022 2222 0a20 2020  se)].    """.   
-00020f20: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
-00020f30: 7374 7228 636f 6c2c 2022 6973 5f69 6e74  str(col, "is_int
-00020f40: 6567 6572 2229 0a20 2020 2072 6574 7572  eger").    retur
-00020f50: 6e20 6275 696c 7469 6e28 2269 735f 696e  n builtin("is_in
-00020f60: 7465 6765 7222 2928 6329 0a0a 0a64 6566  teger")(c)...def
-00020f70: 2069 735f 6e75 6c6c 5f76 616c 7565 2863   is_null_value(c
-00020f80: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
-00020f90: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00020fa0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
-00020fb0: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
-00020fc0: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
-00020fd0: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
-00020fe0: 204a 534f 4e20 6e75 6c6c 2076 616c 7565   JSON null value
-00020ff0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00021000: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00021010: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00021020: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
-00021030: 696d 706f 7274 2074 6f5f 7661 7269 616e  import to_varian
-00021040: 742c 2069 735f 6e75 6c6c 5f76 616c 7565  t, is_null_value
-00021050: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00021060: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00021070: 5f64 6174 6166 7261 6d65 285b 5b7b 2261  _dataframe([[{"a
-00021080: 223a 2022 666f 6f22 7d5d 2c20 5b7b 2261  ": "foo"}], [{"a
-00021090: 223a 204e 6f6e 657d 5d2c 205b 4e6f 6e65  ": None}], [None
-000210a0: 5d5d 2c20 7363 6865 6d61 3d5b 2261 225d  ]], schema=["a"]
-000210b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000210c0: 2e73 656c 6563 7428 6973 5f6e 756c 6c5f  .select(is_null_
-000210d0: 7661 6c75 6528 746f 5f76 6172 6961 6e74  value(to_variant
-000210e0: 2822 6122 295b 2261 225d 292e 6173 5f28  ("a")["a"]).as_(
-000210f0: 2261 2229 292e 636f 6c6c 6563 7428 290a  "a")).collect().
-00021100: 2020 2020 2020 2020 5b52 6f77 2841 3d46          [Row(A=F
-00021110: 616c 7365 292c 2052 6f77 2841 3d54 7275  alse), Row(A=Tru
-00021120: 6529 2c20 526f 7728 413d 4e6f 6e65 295d  e), Row(A=None)]
-00021130: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00021140: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00021150: 636f 6c2c 2022 6973 5f6e 756c 6c5f 7661  col, "is_null_va
-00021160: 6c75 6522 290a 2020 2020 7265 7475 726e  lue").    return
-00021170: 2062 7569 6c74 696e 2822 6973 5f6e 756c   builtin("is_nul
-00021180: 6c5f 7661 6c75 6522 2928 6329 0a0a 0a64  l_value")(c)...d
-00021190: 6566 2069 735f 6f62 6a65 6374 2863 6f6c  ef is_object(col
-000211a0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-000211b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-000211c0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
-000211d0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
-000211e0: 6669 6564 2056 4152 4941 4e54 2063 6f6c  fied VARIANT col
-000211f0: 756d 6e20 636f 6e74 6169 6e73 2061 6e20  umn contains an 
-00021200: 4f42 4a45 4354 2076 616c 7565 2e0a 0a20  OBJECT value... 
-00021210: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00021220: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00021230: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00021240: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-00021250: 7274 2074 6f5f 7661 7269 616e 742c 2069  rt to_variant, i
-00021260: 735f 6f62 6a65 6374 0a20 2020 2020 2020  s_object.       
-00021270: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00021280: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00021290: 6d65 285b 5b5b 312c 2032 5d2c 207b 2261  me([[[1, 2], {"a
-000212a0: 223a 2022 736e 6f77 227d 5d5d 2c20 7363  ": "snow"}]], sc
-000212b0: 6865 6d61 3d5b 2261 222c 2022 6222 5d29  hema=["a", "b"])
-000212c0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-000212d0: 7365 6c65 6374 2869 735f 6f62 6a65 6374  select(is_object
-000212e0: 2874 6f5f 7661 7269 616e 7428 2261 2229  (to_variant("a")
-000212f0: 292e 6173 5f28 2261 2229 2c20 6973 5f6f  ).as_("a"), is_o
-00021300: 626a 6563 7428 746f 5f76 6172 6961 6e74  bject(to_variant
-00021310: 2822 6222 2929 2e61 735f 2822 6222 2929  ("b")).as_("b"))
-00021320: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00021330: 2020 205b 526f 7728 413d 4661 6c73 652c     [Row(A=False,
-00021340: 2042 3d54 7275 6529 5d0a 2020 2020 2222   B=True)].    ""
-00021350: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-00021360: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2269  l_if_str(col, "i
-00021370: 735f 6f62 6a65 6374 2229 0a20 2020 2072  s_object").    r
-00021380: 6574 7572 6e20 6275 696c 7469 6e28 2269  eturn builtin("i
-00021390: 735f 6f62 6a65 6374 2229 2863 290a 0a0a  s_object")(c)...
-000213a0: 6465 6620 6973 5f74 696d 6528 636f 6c3a  def is_time(col:
-000213b0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-000213c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-000213d0: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
-000213e0: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
-000213f0: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
-00021400: 6d6e 2063 6f6e 7461 696e 7320 6120 5449  mn contains a TI
-00021410: 4d45 2076 616c 7565 2e0a 0a20 2020 2045  ME value...    E
-00021420: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00021430: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
-00021440: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
-00021450: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-00021460: 2e73 6e6f 7770 6172 6b2e 6675 6e63 7469  .snowpark.functi
-00021470: 6f6e 7320 696d 706f 7274 2074 6f5f 7661  ons import to_va
-00021480: 7269 616e 742c 2069 735f 7469 6d65 0a20  riant, is_time. 
-00021490: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-000214a0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-000214b0: 6174 6166 7261 6d65 285b 5b64 6174 6574  ataframe([[datet
-000214c0: 696d 652e 7469 6d65 2831 302c 2031 3029  ime.time(10, 10)
-000214d0: 2c20 2258 225d 5d2c 2073 6368 656d 613d  , "X"]], schema=
-000214e0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
-000214f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00021500: 7428 6973 5f74 696d 6528 746f 5f76 6172  t(is_time(to_var
-00021510: 6961 6e74 2822 6122 2929 2e61 735f 2822  iant("a")).as_("
-00021520: 6122 292c 2069 735f 7469 6d65 2874 6f5f  a"), is_time(to_
-00021530: 7661 7269 616e 7428 2262 2229 292e 6173  variant("b")).as
-00021540: 5f28 2262 2229 292e 636f 6c6c 6563 7428  _("b")).collect(
-00021550: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-00021560: 3d54 7275 652c 2042 3d46 616c 7365 295d  =True, B=False)]
-00021570: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-00021580: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00021590: 636f 6c2c 2022 6973 5f74 696d 6522 290a  col, "is_time").
-000215a0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000215b0: 696e 2822 6973 5f74 696d 6522 2928 6329  in("is_time")(c)
-000215c0: 0a0a 0a64 6566 2069 735f 7469 6d65 7374  ...def is_timest
-000215d0: 616d 705f 6c74 7a28 636f 6c3a 2043 6f6c  amp_ltz(col: Col
-000215e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000215f0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00021600: 2020 5265 7475 726e 7320 7472 7565 2069    Returns true i
-00021610: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
-00021620: 5641 5249 414e 5420 636f 6c75 6d6e 2063  VARIANT column c
-00021630: 6f6e 7461 696e 7320 6120 5449 4d45 5354  ontains a TIMEST
-00021640: 414d 505f 4c54 5a20 7661 6c75 6520 746f  AMP_LTZ value to
-00021650: 2062 650a 2020 2020 696e 7465 7270 7265   be.    interpre
-00021660: 7465 6420 7573 696e 6720 7468 6520 6c6f  ted using the lo
-00021670: 6361 6c20 7469 6d65 207a 6f6e 652e 0a0a  cal time zone...
-00021680: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00021690: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-000216a0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-000216b0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-000216c0: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
-000216d0: 6973 5f74 696d 6573 7461 6d70 5f6c 747a  is_timestamp_ltz
-000216e0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-000216f0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
-00021700: 656c 6563 7420 746f 5f74 696d 6573 7461  elect to_timesta
-00021710: 6d70 5f6e 747a 2827 3230 3137 2d30 322d  mp_ntz('2017-02-
-00021720: 3234 2031 323a 3030 3a30 302e 3435 3627  24 12:00:00.456'
-00021730: 2920 6173 2074 696d 6573 7461 6d70 5f6e  ) as timestamp_n
-00021740: 747a 312c 2022 0a20 2020 2020 2020 202e  tz1, ".        .
-00021750: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00021760: 2020 2020 2274 6f5f 7469 6d65 7374 616d      "to_timestam
-00021770: 705f 6c74 7a28 2732 3031 372d 3032 2d32  p_ltz('2017-02-2
-00021780: 3420 3133 3a30 303a 3030 2e31 3233 202b  4 13:00:00.123 +
-00021790: 3031 3a30 3027 2920 6173 2074 696d 6573  01:00') as times
-000217a0: 7461 6d70 5f6c 747a 312c 2022 0a20 2020  tamp_ltz1, ".   
-000217b0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000217c0: 2020 2020 2020 2020 2020 2274 6f5f 7469            "to_ti
-000217d0: 6d65 7374 616d 705f 747a 2827 3230 3137  mestamp_tz('2017
-000217e0: 2d30 322d 3234 2031 333a 3030 3a30 302e  -02-24 13:00:00.
-000217f0: 3132 3320 2b30 313a 3030 2729 2061 7320  123 +01:00') as 
-00021800: 7469 6d65 7374 616d 705f 747a 3122 290a  timestamp_tz1").
-00021810: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00021820: 656c 6563 7428 6973 5f74 696d 6573 7461  elect(is_timesta
-00021830: 6d70 5f6c 747a 2874 6f5f 7661 7269 616e  mp_ltz(to_varian
-00021840: 7428 2274 696d 6573 7461 6d70 5f6e 747a  t("timestamp_ntz
-00021850: 3122 2929 2e61 735f 2822 6122 292c 0a20  1")).as_("a"),. 
-00021860: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00021870: 2020 2020 2069 735f 7469 6d65 7374 616d       is_timestam
-00021880: 705f 6c74 7a28 746f 5f76 6172 6961 6e74  p_ltz(to_variant
-00021890: 2822 7469 6d65 7374 616d 705f 6c74 7a31  ("timestamp_ltz1
-000218a0: 2229 292e 6173 5f28 2262 2229 2c0a 2020  ")).as_("b"),.  
-000218b0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-000218c0: 2020 2020 6973 5f74 696d 6573 7461 6d70      is_timestamp
-000218d0: 5f6c 747a 2874 6f5f 7661 7269 616e 7428  _ltz(to_variant(
-000218e0: 2274 696d 6573 7461 6d70 5f74 7a31 2229  "timestamp_tz1")
-000218f0: 292e 6173 5f28 2263 2229 292e 636f 6c6c  ).as_("c")).coll
-00021900: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00021910: 6f77 2841 3d46 616c 7365 2c20 423d 5472  ow(A=False, B=Tr
-00021920: 7565 2c20 433d 4661 6c73 6529 5d0a 2020  ue, C=False)].  
-00021930: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00021940: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
-00021950: 2c20 2269 735f 7469 6d65 7374 616d 705f  , "is_timestamp_
-00021960: 6c74 7a22 290a 2020 2020 7265 7475 726e  ltz").    return
-00021970: 2062 7569 6c74 696e 2822 6973 5f74 696d   builtin("is_tim
-00021980: 6573 7461 6d70 5f6c 747a 2229 2863 290a  estamp_ltz")(c).
-00021990: 0a0a 6465 6620 6973 5f74 696d 6573 7461  ..def is_timesta
-000219a0: 6d70 5f6e 747a 2863 6f6c 3a20 436f 6c75  mp_ntz(col: Colu
-000219b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000219c0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-000219d0: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
-000219e0: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
-000219f0: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
-00021a00: 6e74 6169 6e73 2061 2054 494d 4553 5441  ntains a TIMESTA
-00021a10: 4d50 5f4e 545a 2076 616c 7565 2077 6974  MP_NTZ value wit
-00021a20: 6820 6e6f 2074 696d 6520 7a6f 6e65 2e0a  h no time zone..
-00021a30: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-00021a40: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00021a50: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00021a60: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
-00021a70: 706f 7274 2074 6f5f 7661 7269 616e 742c  port to_variant,
-00021a80: 2069 735f 7469 6d65 7374 616d 705f 6e74   is_timestamp_nt
-00021a90: 7a0a 2020 2020 2020 2020 3e3e 3e20 6466  z.        >>> df
-00021aa0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-00021ab0: 7365 6c65 6374 2074 6f5f 7469 6d65 7374  select to_timest
-00021ac0: 616d 705f 6e74 7a28 2732 3031 372d 3032  amp_ntz('2017-02
-00021ad0: 2d32 3420 3132 3a30 303a 3030 2e34 3536  -24 12:00:00.456
-00021ae0: 2729 2061 7320 7469 6d65 7374 616d 705f  ') as timestamp_
-00021af0: 6e74 7a31 2c20 220a 2020 2020 2020 2020  ntz1, ".        
-00021b00: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00021b10: 2020 2020 2022 746f 5f74 696d 6573 7461       "to_timesta
-00021b20: 6d70 5f6c 747a 2827 3230 3137 2d30 322d  mp_ltz('2017-02-
-00021b30: 3234 2031 333a 3030 3a30 302e 3132 3320  24 13:00:00.123 
-00021b40: 2b30 313a 3030 2729 2061 7320 7469 6d65  +01:00') as time
-00021b50: 7374 616d 705f 6c74 7a31 2c20 220a 2020  stamp_ltz1, ".  
-00021b60: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00021b70: 2020 2020 2020 2020 2020 2022 746f 5f74             "to_t
-00021b80: 696d 6573 7461 6d70 5f74 7a28 2732 3031  imestamp_tz('201
-00021b90: 372d 3032 2d32 3420 3133 3a30 303a 3030  7-02-24 13:00:00
-00021ba0: 2e31 3233 202b 3031 3a30 3027 2920 6173  .123 +01:00') as
-00021bb0: 2074 696d 6573 7461 6d70 5f74 7a31 2229   timestamp_tz1")
-00021bc0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00021bd0: 7365 6c65 6374 2869 735f 7469 6d65 7374  select(is_timest
-00021be0: 616d 705f 6e74 7a28 746f 5f76 6172 6961  amp_ntz(to_varia
-00021bf0: 6e74 2822 7469 6d65 7374 616d 705f 6e74  nt("timestamp_nt
-00021c00: 7a31 2229 292e 6173 5f28 2261 2229 2c0a  z1")).as_("a"),.
-00021c10: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00021c20: 2020 2020 2020 6973 5f74 696d 6573 7461        is_timesta
-00021c30: 6d70 5f6e 747a 2874 6f5f 7661 7269 616e  mp_ntz(to_varian
-00021c40: 7428 2274 696d 6573 7461 6d70 5f6c 747a  t("timestamp_ltz
-00021c50: 3122 2929 2e61 735f 2822 6222 292c 0a20  1")).as_("b"),. 
-00021c60: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00021c70: 2020 2020 2069 735f 7469 6d65 7374 616d       is_timestam
-00021c80: 705f 6e74 7a28 746f 5f76 6172 6961 6e74  p_ntz(to_variant
-00021c90: 2822 7469 6d65 7374 616d 705f 747a 3122  ("timestamp_tz1"
-00021ca0: 2929 2e61 735f 2822 6322 2929 2e63 6f6c  )).as_("c")).col
-00021cb0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00021cc0: 526f 7728 413d 5472 7565 2c20 423d 4661  Row(A=True, B=Fa
-00021cd0: 6c73 652c 2043 3d46 616c 7365 295d 0a20  lse, C=False)]. 
-00021ce0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-00021cf0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
-00021d00: 6c2c 2022 6973 5f74 696d 6573 7461 6d70  l, "is_timestamp
-00021d10: 5f6e 747a 2229 0a20 2020 2072 6574 7572  _ntz").    retur
-00021d20: 6e20 6275 696c 7469 6e28 2269 735f 7469  n builtin("is_ti
-00021d30: 6d65 7374 616d 705f 6e74 7a22 2928 6329  mestamp_ntz")(c)
-00021d40: 0a0a 0a64 6566 2069 735f 7469 6d65 7374  ...def is_timest
-00021d50: 616d 705f 747a 2863 6f6c 3a20 436f 6c75  amp_tz(col: Colu
-00021d60: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-00021d70: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00021d80: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
-00021d90: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
-00021da0: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
-00021db0: 6e74 6169 6e73 2061 2054 494d 4553 5441  ntains a TIMESTA
-00021dc0: 4d50 5f54 5a20 7661 6c75 6520 7769 7468  MP_TZ value with
-00021dd0: 2061 2074 696d 6520 7a6f 6e65 2e0a 0a20   a time zone... 
-00021de0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00021df0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00021e00: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00021e10: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-00021e20: 7274 2074 6f5f 7661 7269 616e 742c 2069  rt to_variant, i
-00021e30: 735f 7469 6d65 7374 616d 705f 747a 0a20  s_timestamp_tz. 
-00021e40: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00021e50: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-00021e60: 6563 7420 746f 5f74 696d 6573 7461 6d70  ect to_timestamp
-00021e70: 5f6e 747a 2827 3230 3137 2d30 322d 3234  _ntz('2017-02-24
-00021e80: 2031 323a 3030 3a30 302e 3435 3627 2920   12:00:00.456') 
-00021e90: 6173 2074 696d 6573 7461 6d70 5f6e 747a  as timestamp_ntz
-00021ea0: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
-00021eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ec0: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
-00021ed0: 6c74 7a28 2732 3031 372d 3032 2d32 3420  ltz('2017-02-24 
-00021ee0: 3133 3a30 303a 3030 2e31 3233 202b 3031  13:00:00.123 +01
-00021ef0: 3a30 3027 2920 6173 2074 696d 6573 7461  :00') as timesta
-00021f00: 6d70 5f6c 747a 312c 2022 0a20 2020 2020  mp_ltz1, ".     
-00021f10: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00021f20: 2020 2020 2020 2020 2274 6f5f 7469 6d65          "to_time
-00021f30: 7374 616d 705f 747a 2827 3230 3137 2d30  stamp_tz('2017-0
-00021f40: 322d 3234 2031 333a 3030 3a30 302e 3132  2-24 13:00:00.12
-00021f50: 3320 2b30 313a 3030 2729 2061 7320 7469  3 +01:00') as ti
-00021f60: 6d65 7374 616d 705f 747a 3122 290a 2020  mestamp_tz1").  
-00021f70: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00021f80: 6563 7428 6973 5f74 696d 6573 7461 6d70  ect(is_timestamp
-00021f90: 5f74 7a28 746f 5f76 6172 6961 6e74 2822  _tz(to_variant("
-00021fa0: 7469 6d65 7374 616d 705f 6e74 7a31 2229  timestamp_ntz1")
-00021fb0: 292e 6173 5f28 2261 2229 2c0a 2020 2020  ).as_("a"),.    
-00021fc0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00021fd0: 2020 6973 5f74 696d 6573 7461 6d70 5f74    is_timestamp_t
-00021fe0: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
-00021ff0: 6d65 7374 616d 705f 6c74 7a31 2229 292e  mestamp_ltz1")).
-00022000: 6173 5f28 2262 2229 2c0a 2020 2020 2020  as_("b"),.      
-00022010: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-00022020: 6973 5f74 696d 6573 7461 6d70 5f74 7a28  is_timestamp_tz(
-00022030: 746f 5f76 6172 6961 6e74 2822 7469 6d65  to_variant("time
-00022040: 7374 616d 705f 747a 3122 2929 2e61 735f  stamp_tz1")).as_
-00022050: 2822 6322 2929 2e63 6f6c 6c65 6374 2829  ("c")).collect()
-00022060: 0a20 2020 2020 2020 205b 526f 7728 413d  .        [Row(A=
-00022070: 4661 6c73 652c 2042 3d46 616c 7365 2c20  False, B=False, 
-00022080: 433d 5472 7565 295d 0a20 2020 2022 2222  C=True)].    """
-00022090: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-000220a0: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
-000220b0: 5f74 696d 6573 7461 6d70 5f74 7a22 290a  _timestamp_tz").
-000220c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000220d0: 696e 2822 6973 5f74 696d 6573 7461 6d70  in("is_timestamp
-000220e0: 5f74 7a22 2928 6329 0a0a 0a64 6566 205f  _tz")(c)...def _
-000220f0: 636f 6c75 6d6e 735f 6672 6f6d 5f74 696d  columns_from_tim
-00022100: 6573 7461 6d70 5f70 6172 7473 280a 2020  estamp_parts(.  
-00022110: 2020 6675 6e63 5f6e 616d 653a 2073 7472    func_name: str
-00022120: 2c20 2a61 7267 733a 2055 6e69 6f6e 5b43  , *args: Union[C
-00022130: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
-00022140: 5d0a 2920 2d3e 2054 7570 6c65 5b43 6f6c  ].) -> Tuple[Col
-00022150: 756d 6e2c 202e 2e2e 5d3a 0a20 2020 2069  umn, ...]:.    i
-00022160: 6620 6c65 6e28 6172 6773 2920 3d3d 2033  f len(args) == 3
-00022170: 3a0a 2020 2020 2020 2020 7965 6172 5f20  :.        year_ 
-00022180: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00022190: 5f6f 725f 696e 7428 6172 6773 5b30 5d2c  _or_int(args[0],
-000221a0: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
-000221b0: 2020 2020 6d6f 6e74 6820 3d20 5f74 6f5f      month = _to_
-000221c0: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
-000221d0: 7428 6172 6773 5b31 5d2c 2066 756e 635f  t(args[1], func_
-000221e0: 6e61 6d65 290a 2020 2020 2020 2020 6461  name).        da
-000221f0: 7920 3d20 5f74 6f5f 636f 6c5f 6966 5f73  y = _to_col_if_s
-00022200: 7472 5f6f 725f 696e 7428 6172 6773 5b32  tr_or_int(args[2
-00022210: 5d2c 2066 756e 635f 6e61 6d65 290a 2020  ], func_name).  
-00022220: 2020 2020 2020 7265 7475 726e 2079 6561        return yea
-00022230: 725f 2c20 6d6f 6e74 682c 2064 6179 0a20  r_, month, day. 
-00022240: 2020 2065 6c69 6620 6c65 6e28 6172 6773     elif len(args
-00022250: 2920 3d3d 2036 3a0a 2020 2020 2020 2020  ) == 6:.        
-00022260: 7965 6172 5f20 3d20 5f74 6f5f 636f 6c5f  year_ = _to_col_
-00022270: 6966 5f73 7472 5f6f 725f 696e 7428 6172  if_str_or_int(ar
-00022280: 6773 5b30 5d2c 2066 756e 635f 6e61 6d65  gs[0], func_name
-00022290: 290a 2020 2020 2020 2020 6d6f 6e74 6820  ).        month 
-000222a0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-000222b0: 5f6f 725f 696e 7428 6172 6773 5b31 5d2c  _or_int(args[1],
-000222c0: 2066 756e 635f 6e61 6d65 290a 2020 2020   func_name).    
-000222d0: 2020 2020 6461 7920 3d20 5f74 6f5f 636f      day = _to_co
-000222e0: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
-000222f0: 6172 6773 5b32 5d2c 2066 756e 635f 6e61  args[2], func_na
-00022300: 6d65 290a 2020 2020 2020 2020 686f 7572  me).        hour
-00022310: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00022320: 725f 6f72 5f69 6e74 2861 7267 735b 335d  r_or_int(args[3]
-00022330: 2c20 6675 6e63 5f6e 616d 6529 0a20 2020  , func_name).   
-00022340: 2020 2020 206d 696e 7574 6520 3d20 5f74       minute = _t
-00022350: 6f5f 636f 6c5f 6966 5f73 7472 5f6f 725f  o_col_if_str_or_
-00022360: 696e 7428 6172 6773 5b34 5d2c 2066 756e  int(args[4], fun
-00022370: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
-00022380: 7365 636f 6e64 203d 205f 746f 5f63 6f6c  second = _to_col
-00022390: 5f69 665f 7374 725f 6f72 5f69 6e74 2861  _if_str_or_int(a
-000223a0: 7267 735b 355d 2c20 6675 6e63 5f6e 616d  rgs[5], func_nam
-000223b0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-000223c0: 6e20 7965 6172 5f2c 206d 6f6e 7468 2c20  n year_, month, 
-000223d0: 6461 792c 2068 6f75 722c 206d 696e 7574  day, hour, minut
-000223e0: 652c 2073 6563 6f6e 640a 2020 2020 656c  e, second.    el
-000223f0: 7365 3a0a 2020 2020 2020 2020 2320 5368  se:.        # Sh
-00022400: 6f75 6c64 206e 6576 6572 2068 6170 7065  ould never happe
-00022410: 6e20 7369 6e63 6520 7765 206f 6e6c 7920  n since we only 
-00022420: 7573 6520 7468 6973 2069 6e74 6572 6e61  use this interna
-00022430: 6c6c 790a 2020 2020 2020 2020 7261 6973  lly.        rais
-00022440: 6520 5661 6c75 6545 7272 6f72 2866 2249  e ValueError(f"I
-00022450: 6e63 6f72 7265 6374 206e 756d 6265 7220  ncorrect number 
-00022460: 6f66 2061 7267 7320 7061 7373 6564 2074  of args passed t
-00022470: 6f20 7b66 756e 635f 6e61 6d65 7d22 290a  o {func_name}").
-00022480: 0a0a 6465 6620 5f74 696d 6573 7461 6d70  ..def _timestamp
-00022490: 5f66 726f 6d5f 7061 7274 735f 696e 7465  _from_parts_inte
-000224a0: 726e 616c 280a 2020 2020 6675 6e63 5f6e  rnal(.    func_n
-000224b0: 616d 653a 2073 7472 2c20 2a61 7267 733a  ame: str, *args:
-000224c0: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
-000224d0: 616d 652c 2069 6e74 5d2c 202a 2a6b 7761  ame, int], **kwa
-000224e0: 7267 733a 2055 6e69 6f6e 5b43 6f6c 756d  rgs: Union[Colum
-000224f0: 6e4f 724e 616d 652c 2069 6e74 5d0a 2920  nOrName, int].) 
-00022500: 2d3e 2054 7570 6c65 5b43 6f6c 756d 6e2c  -> Tuple[Column,
-00022510: 202e 2e2e 5d3a 0a20 2020 206e 756d 5f61   ...]:.    num_a
-00022520: 7267 7320 3d20 6c65 6e28 6172 6773 290a  rgs = len(args).
-00022530: 2020 2020 6966 206e 756d 5f61 7267 7320      if num_args 
-00022540: 3d3d 2032 3a0a 2020 2020 2020 2020 2320  == 2:.        # 
-00022550: 6578 7072 6573 7369 6f6e 206d 6f64 650a  expression mode.
-00022560: 2020 2020 2020 2020 6461 7465 5f65 7870          date_exp
-00022570: 7220 3d20 5f74 6f5f 636f 6c5f 6966 5f73  r = _to_col_if_s
-00022580: 7472 2861 7267 735b 305d 2c20 6675 6e63  tr(args[0], func
-00022590: 5f6e 616d 6529 0a20 2020 2020 2020 2074  _name).        t
-000225a0: 696d 655f 6578 7072 203d 205f 746f 5f63  ime_expr = _to_c
-000225b0: 6f6c 5f69 665f 7374 7228 6172 6773 5b31  ol_if_str(args[1
-000225c0: 5d2c 2066 756e 635f 6e61 6d65 290a 2020  ], func_name).  
-000225d0: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
-000225e0: 655f 6578 7072 2c20 7469 6d65 5f65 7870  e_expr, time_exp
-000225f0: 720a 2020 2020 656c 6966 2036 203c 3d20  r.    elif 6 <= 
-00022600: 6e75 6d5f 6172 6773 203c 3d20 383a 0a20  num_args <= 8:. 
-00022610: 2020 2020 2020 2023 2070 6172 7473 206d         # parts m
-00022620: 6f64 650a 2020 2020 2020 2020 792c 206d  ode.        y, m
-00022630: 2c20 642c 2068 2c20 6d69 6e5f 2c20 7320  , d, h, min_, s 
-00022640: 3d20 5f63 6f6c 756d 6e73 5f66 726f 6d5f  = _columns_from_
-00022650: 7469 6d65 7374 616d 705f 7061 7274 7328  timestamp_parts(
-00022660: 6675 6e63 5f6e 616d 652c 202a 6172 6773  func_name, *args
-00022670: 5b3a 365d 290a 2020 2020 2020 2020 6e73  [:6]).        ns
-00022680: 5f61 7267 203d 2061 7267 735b 365d 2069  _arg = args[6] i
-00022690: 6620 6e75 6d5f 6172 6773 203e 3d20 3720  f num_args >= 7 
-000226a0: 656c 7365 206b 7761 7267 732e 6765 7428  else kwargs.get(
-000226b0: 226e 616e 6f73 6563 6f6e 6473 2229 0a20  "nanoseconds"). 
-000226c0: 2020 2020 2020 2023 2054 696d 657a 6f6e         # Timezon
-000226d0: 6520 6973 206f 6e6c 7920 6163 6365 7074  e is only accept
-000226e0: 6564 2069 6e20 7469 6d65 7374 616d 705f  ed in timestamp_
-000226f0: 6672 6f6d 5f70 6172 7473 2066 756e 6374  from_parts funct
-00022700: 696f 6e0a 2020 2020 2020 2020 747a 5f61  ion.        tz_a
-00022710: 7267 203d 2061 7267 735b 375d 2069 6620  rg = args[7] if 
-00022720: 6e75 6d5f 6172 6773 203d 3d20 3820 656c  num_args == 8 el
-00022730: 7365 206b 7761 7267 732e 6765 7428 2274  se kwargs.get("t
-00022740: 696d 657a 6f6e 6522 290a 2020 2020 2020  imezone").      
-00022750: 2020 6966 2074 7a5f 6172 6720 6973 206e    if tz_arg is n
-00022760: 6f74 204e 6f6e 6520 616e 6420 6675 6e63  ot None and func
-00022770: 5f6e 616d 6520 213d 2022 7469 6d65 7374  _name != "timest
-00022780: 616d 705f 6672 6f6d 5f70 6172 7473 223a  amp_from_parts":
-00022790: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000227a0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
-000227b0: 7b66 756e 635f 6e61 6d65 7d20 646f 6573  {func_name} does
-000227c0: 206e 6f74 2061 6363 6570 7420 7469 6d65   not accept time
-000227d0: 7a6f 6e65 2061 7320 616e 2061 7267 756d  zone as an argum
-000227e0: 656e 7422 290a 2020 2020 2020 2020 6e73  ent").        ns
-000227f0: 203d 204e 6f6e 6520 6966 206e 735f 6172   = None if ns_ar
-00022800: 6720 6973 204e 6f6e 6520 656c 7365 205f  g is None else _
-00022810: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
-00022820: 5f69 6e74 286e 735f 6172 672c 2066 756e  _int(ns_arg, fun
-00022830: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
-00022840: 747a 203d 204e 6f6e 6520 6966 2074 7a5f  tz = None if tz_
-00022850: 6172 6720 6973 204e 6f6e 6520 656c 7365  arg is None else
-00022860: 205f 746f 5f63 6f6c 5f69 665f 7371 6c5f   _to_col_if_sql_
-00022870: 6578 7072 2874 7a5f 6172 672c 2066 756e  expr(tz_arg, fun
-00022880: 635f 6e61 6d65 290a 2020 2020 2020 2020  c_name).        
-00022890: 6966 206e 7320 6973 206e 6f74 204e 6f6e  if ns is not Non
-000228a0: 6520 616e 6420 747a 2069 7320 6e6f 7420  e and tz is not 
-000228b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000228c0: 2020 7265 7475 726e 2079 2c20 6d2c 2064    return y, m, d
-000228d0: 2c20 682c 206d 696e 5f2c 2073 2c20 6e73  , h, min_, s, ns
-000228e0: 2c20 747a 0a20 2020 2020 2020 2065 6c69  , tz.        eli
-000228f0: 6620 6e73 2069 7320 6e6f 7420 4e6f 6e65  f ns is not None
-00022900: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00022910: 7475 726e 2079 2c20 6d2c 2064 2c20 682c  turn y, m, d, h,
-00022920: 206d 696e 5f2c 2073 2c20 6e73 0a20 2020   min_, s, ns.   
-00022930: 2020 2020 2065 6c69 6620 747a 2069 7320       elif tz is 
-00022940: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00022950: 2020 2020 2020 2320 5765 206e 6565 6420        # We need 
-00022960: 746f 2066 696c 6c20 696e 206e 616e 6f73  to fill in nanos
-00022970: 6563 6f6e 6473 2061 7320 3020 746f 206d  econds as 0 to m
-00022980: 616b 6520 7468 6520 7371 6c20 6675 6e63  ake the sql func
-00022990: 7469 6f6e 2077 6f72 6b0a 2020 2020 2020  tion work.      
-000229a0: 2020 2020 2020 7265 7475 726e 2079 2c20        return y, 
-000229b0: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
-000229c0: 2c20 6c69 7428 3029 2c20 747a 0a20 2020  , lit(0), tz.   
-000229d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000229e0: 2020 2020 2020 2072 6574 7572 6e20 792c         return y,
-000229f0: 206d 2c20 642c 2068 2c20 6d69 6e5f 2c20   m, d, h, min_, 
-00022a00: 730a 2020 2020 656c 7365 3a0a 2020 2020  s.    else:.    
-00022a10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00022a20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00022a30: 2020 6622 7b66 756e 635f 6e61 6d65 7d20    f"{func_name} 
-00022a40: 6578 7065 6374 6564 2032 206f 7220 3620  expected 2 or 6 
-00022a50: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00022a60: 7473 2c20 676f 7420 7b6e 756d 5f61 7267  ts, got {num_arg
-00022a70: 737d 220a 2020 2020 2020 2020 290a 0a0a  s}".        )...
-00022a80: 6465 6620 7469 6d65 5f66 726f 6d5f 7061  def time_from_pa
-00022a90: 7274 7328 0a20 2020 2068 6f75 723a 2055  rts(.    hour: U
-00022aa0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00022ab0: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
-00022ac0: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
-00022ad0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
-00022ae0: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
-00022af0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-00022b00: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
-00022b10: 6f6e 6473 3a20 4f70 7469 6f6e 616c 5b55  onds: Optional[U
-00022b20: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-00022b30: 652c 2069 6e74 5d5d 203d 204e 6f6e 652c  e, int]] = None,
-00022b40: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-00022b50: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
-00022b60: 7320 6120 7469 6d65 2066 726f 6d20 696e  s a time from in
-00022b70: 6469 7669 6475 616c 206e 756d 6572 6963  dividual numeric
-00022b80: 2063 6f6d 706f 6e65 6e74 732e 0a0a 2020   components...  
-00022b90: 2020 5449 4d45 5f46 524f 4d5f 5041 5254    TIME_FROM_PART
-00022ba0: 5320 6973 2074 7970 6963 616c 6c79 2075  S is typically u
-00022bb0: 7365 6420 746f 2068 616e 646c 6520 7661  sed to handle va
-00022bc0: 6c75 6573 2069 6e20 226e 6f72 6d61 6c22  lues in "normal"
-00022bd0: 2072 616e 6765 7320 2865 2e67 2e20 686f   ranges (e.g. ho
-00022be0: 7572 7320 302d 3233 2c20 6d69 6e75 7465  urs 0-23, minute
-00022bf0: 7320 302d 3539 292c 0a20 2020 2062 7574  s 0-59),.    but
-00022c00: 2069 7420 616c 736f 2068 616e 646c 6573   it also handles
-00022c10: 2076 616c 7565 7320 6672 6f6d 206f 7574   values from out
-00022c20: 7369 6465 2074 6865 7365 2072 616e 6765  side these range
-00022c30: 732e 2054 6869 7320 616c 6c6f 7773 2c20  s. This allows, 
-00022c40: 666f 7220 6578 616d 706c 652c 2063 686f  for example, cho
-00022c50: 6f73 696e 6720 7468 6520 4e2d 7468 206d  osing the N-th m
-00022c60: 696e 7574 650a 2020 2020 696e 2061 2064  inute.    in a d
-00022c70: 6179 2c20 7768 6963 6820 6361 6e20 6265  ay, which can be
-00022c80: 2075 7365 6420 746f 2073 696d 706c 6966   used to simplif
-00022c90: 7920 736f 6d65 2063 6f6d 7075 7461 7469  y some computati
-00022ca0: 6f6e 732e 0a0a 2020 2020 4578 616d 706c  ons...    Exampl
-00022cb0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00022cc0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00022cd0: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00022ce0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00022cf0: 5b5b 3131 2c20 3131 2c20 302c 2039 3837  [[11, 11, 0, 987
-00022d00: 3635 3433 3231 5d2c 205b 3130 2c20 3130  654321], [10, 10
-00022d10: 2c20 302c 2039 3837 3635 3433 3231 5d5d  , 0, 987654321]]
-00022d20: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00022d30: 2020 7363 6865 6d61 3d5b 2268 6f75 7222    schema=["hour"
-00022d40: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
-00022d50: 6f6e 6422 2c20 226e 616e 6f73 6563 6f6e  ond", "nanosecon
-00022d60: 6473 225d 2c0a 2020 2020 2020 2020 2e2e  ds"],.        ..
-00022d70: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-00022d80: 6466 2e73 656c 6563 7428 7469 6d65 5f66  df.select(time_f
-00022d90: 726f 6d5f 7061 7274 7328 0a20 2020 2020  rom_parts(.     
-00022da0: 2020 202e 2e2e 2020 2020 2022 686f 7572     ...     "hour
-00022db0: 222c 2022 6d69 6e75 7465 222c 2022 7365  ", "minute", "se
-00022dc0: 636f 6e64 222c 206e 616e 6f73 6563 6f6e  cond", nanosecon
-00022dd0: 6473 3d22 6e61 6e6f 7365 636f 6e64 7322  ds="nanoseconds"
-00022de0: 0a20 2020 2020 2020 202e 2e2e 2029 2e61  .        ... ).a
-00022df0: 6c69 6173 2822 5449 4d45 5f46 524f 4d5f  lias("TIME_FROM_
-00022e00: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
-00022e10: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00022e20: 5449 4d45 5f46 524f 4d5f 5041 5254 533d  TIME_FROM_PARTS=
-00022e30: 6461 7465 7469 6d65 2e74 696d 6528 3131  datetime.time(11
-00022e40: 2c20 3131 2c20 302c 2039 3837 3635 3429  , 11, 0, 987654)
-00022e50: 292c 2052 6f77 2854 494d 455f 4652 4f4d  ), Row(TIME_FROM
-00022e60: 5f50 4152 5453 3d64 6174 6574 696d 652e  _PARTS=datetime.
-00022e70: 7469 6d65 2831 302c 2031 302c 2030 2c20  time(10, 10, 0, 
-00022e80: 3938 3736 3534 2929 5d0a 2020 2020 2222  987654))].    ""
-00022e90: 220a 2020 2020 682c 206d 2c20 7320 3d20  ".    h, m, s = 
-00022ea0: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
-00022eb0: 6d65 7374 616d 705f 7061 7274 7328 2274  mestamp_parts("t
-00022ec0: 696d 655f 6672 6f6d 5f70 6172 7473 222c  ime_from_parts",
-00022ed0: 2068 6f75 722c 206d 696e 7574 652c 2073   hour, minute, s
-00022ee0: 6563 6f6e 6429 0a20 2020 2069 6620 6e61  econd).    if na
-00022ef0: 6e6f 7365 636f 6e64 733a 0a20 2020 2020  noseconds:.     
-00022f00: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00022f10: 6e28 2274 696d 655f 6672 6f6d 5f70 6172  n("time_from_par
-00022f20: 7473 2229 280a 2020 2020 2020 2020 2020  ts")(.          
-00022f30: 2020 682c 206d 2c20 732c 205f 746f 5f63    h, m, s, _to_c
-00022f40: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
-00022f50: 286e 616e 6f73 6563 6f6e 6473 2c20 2274  (nanoseconds, "t
-00022f60: 696d 655f 6672 6f6d 5f70 6172 7473 2229  ime_from_parts")
-00022f70: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
-00022f80: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-00022f90: 7572 6e20 6275 696c 7469 6e28 2274 696d  urn builtin("tim
-00022fa0: 655f 6672 6f6d 5f70 6172 7473 2229 2868  e_from_parts")(h
-00022fb0: 2c20 6d2c 2073 290a 0a0a 406f 7665 726c  , m, s)...@overl
-00022fc0: 6f61 640a 6465 6620 7469 6d65 7374 616d  oad.def timestam
-00022fd0: 705f 6672 6f6d 5f70 6172 7473 2864 6174  p_from_parts(dat
-00022fe0: 655f 6578 7072 3a20 436f 6c75 6d6e 4f72  e_expr: ColumnOr
-00022ff0: 4e61 6d65 2c20 7469 6d65 5f65 7870 723a  Name, time_expr:
-00023000: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00023010: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2e2e  > Column:.    ..
-00023020: 2e20 2023 2070 7261 676d 613a 206e 6f20  .  # pragma: no 
-00023030: 636f 7665 720a 0a0a 406f 7665 726c 6f61  cover...@overloa
-00023040: 640a 6465 6620 7469 6d65 7374 616d 705f  d.def timestamp_
-00023050: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
-00023060: 7965 6172 3a20 556e 696f 6e5b 436f 6c75  year: Union[Colu
-00023070: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
-00023080: 2020 2020 6d6f 6e74 683a 2055 6e69 6f6e      month: Union
-00023090: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-000230a0: 6e74 5d2c 0a20 2020 2064 6179 3a20 556e  nt],.    day: Un
-000230b0: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-000230c0: 2c20 696e 745d 2c0a 2020 2020 686f 7572  , int],.    hour
-000230d0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-000230e0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-000230f0: 6d69 6e75 7465 3a20 556e 696f 6e5b 436f  minute: Union[Co
-00023100: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00023110: 2c0a 2020 2020 7365 636f 6e64 3a20 556e  ,.    second: Un
-00023120: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-00023130: 2c20 696e 745d 2c0a 2020 2020 6e61 6e6f  , int],.    nano
-00023140: 7365 636f 6e64 3a20 4f70 7469 6f6e 616c  second: Optional
-00023150: 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f 724e  [Union[ColumnOrN
-00023160: 616d 652c 2069 6e74 5d5d 203d 204e 6f6e  ame, int]] = Non
-00023170: 652c 0a20 2020 2074 696d 657a 6f6e 653a  e,.    timezone:
-00023180: 204f 7074 696f 6e61 6c5b 436f 6c75 6d6e   Optional[Column
-00023190: 4f72 4c69 7465 7261 6c53 7472 5d20 3d20  OrLiteralStr] = 
-000231a0: 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c 756d  None,.) -> Colum
-000231b0: 6e3a 0a20 2020 202e 2e2e 2020 2320 7072  n:.    ...  # pr
-000231c0: 6167 6d61 3a20 6e6f 2063 6f76 6572 0a0a  agma: no cover..
-000231d0: 0a64 6566 2074 696d 6573 7461 6d70 5f66  .def timestamp_f
-000231e0: 726f 6d5f 7061 7274 7328 2a61 7267 732c  rom_parts(*args,
-000231f0: 202a 2a6b 7761 7267 7329 202d 3e20 436f   **kwargs) -> Co
-00023200: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00023210: 2020 4372 6561 7465 7320 6120 7469 6d65    Creates a time
-00023220: 7374 616d 7020 6672 6f6d 2069 6e64 6976  stamp from indiv
-00023230: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
-00023240: 6d70 6f6e 656e 7473 2e20 4966 206e 6f20  mponents. If no 
-00023250: 7469 6d65 207a 6f6e 6520 6973 2069 6e20  time zone is in 
-00023260: 6566 6665 6374 2c0a 2020 2020 7468 6520  effect,.    the 
-00023270: 6675 6e63 7469 6f6e 2063 616e 2062 6520  function can be 
-00023280: 7573 6564 2074 6f20 6372 6561 7465 2061  used to create a
-00023290: 2074 696d 6573 7461 6d70 2066 726f 6d20   timestamp from 
-000232a0: 6120 6461 7465 2065 7870 7265 7373 696f  a date expressio
-000232b0: 6e20 616e 6420 6120 7469 6d65 2065 7870  n and a time exp
-000232c0: 7265 7373 696f 6e2e 0a0a 2020 2020 4578  ression...    Ex
-000232d0: 616d 706c 6520 313a 3a0a 0a20 2020 2020  ample 1::..     
-000232e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-000232f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00023300: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
-00023310: 2e20 2020 2020 5b5b 3230 3232 2c20 342c  .     [[2022, 4,
-00023320: 2031 2c20 3131 2c20 3131 2c20 305d 2c20   1, 11, 11, 0], 
-00023330: 5b32 3032 322c 2033 2c20 3331 2c20 3131  [2022, 3, 31, 11
-00023340: 2c20 3131 2c20 305d 5d2c 0a20 2020 2020  , 11, 0]],.     
-00023350: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
-00023360: 613d 5b22 7965 6172 222c 2022 6d6f 6e74  a=["year", "mont
-00023370: 6822 2c20 2264 6179 222c 2022 686f 7572  h", "day", "hour
-00023380: 222c 2022 6d69 6e75 7465 222c 2022 7365  ", "minute", "se
-00023390: 636f 6e64 225d 2c0a 2020 2020 2020 2020  cond"],.        
-000233a0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-000233b0: 3e20 6466 2e73 656c 6563 7428 7469 6d65  > df.select(time
-000233c0: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
-000233d0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-000233e0: 2020 2279 6561 7222 2c20 226d 6f6e 7468    "year", "month
-000233f0: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
-00023400: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
-00023410: 6f6e 6422 0a20 2020 2020 2020 202e 2e2e  ond".        ...
-00023420: 2029 2e61 6c69 6173 2822 5449 4d45 5354   ).alias("TIMEST
-00023430: 414d 505f 4652 4f4d 5f50 4152 5453 2229  AMP_FROM_PARTS")
-00023440: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00023450: 2020 2020 5b52 6f77 2854 494d 4553 5441      [Row(TIMESTA
-00023460: 4d50 5f46 524f 4d5f 5041 5254 533d 6461  MP_FROM_PARTS=da
-00023470: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-00023480: 3230 3232 2c20 342c 2031 2c20 3131 2c20  2022, 4, 1, 11, 
-00023490: 3131 2929 2c20 526f 7728 5449 4d45 5354  11)), Row(TIMEST
-000234a0: 414d 505f 4652 4f4d 5f50 4152 5453 3d64  AMP_FROM_PARTS=d
-000234b0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-000234c0: 2832 3032 322c 2033 2c20 3331 2c20 3131  (2022, 3, 31, 11
-000234d0: 2c20 3131 2929 5d0a 0a20 2020 2045 7861  , 11))]..    Exa
-000234e0: 6d70 6c65 2032 3a3a 0a0a 2020 2020 2020  mple 2::..      
-000234f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00023500: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00023510: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-00023520: 2020 2020 205b 5b27 3230 3232 2d30 342d       [['2022-04-
-00023530: 3031 272c 2027 3131 3a31 313a 3030 275d  01', '11:11:00']
-00023540: 2c20 5b27 3230 3232 2d30 332d 3331 272c  , ['2022-03-31',
-00023550: 2027 3131 3a31 313a 3030 275d 5d2c 0a20   '11:11:00']],. 
-00023560: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-00023570: 6368 656d 613d 5b22 6461 7465 222c 2022  chema=["date", "
-00023580: 7469 6d65 225d 0a20 2020 2020 2020 202e  time"].        .
-00023590: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-000235a0: 2064 662e 7365 6c65 6374 280a 2020 2020   df.select(.    
-000235b0: 2020 2020 2e2e 2e20 2020 2020 7469 6d65      ...     time
-000235c0: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
-000235d0: 2874 6f5f 6461 7465 2822 6461 7465 2229  (to_date("date")
-000235e0: 2c20 746f 5f74 696d 6528 2274 696d 6522  , to_time("time"
-000235f0: 290a 2020 2020 2020 2020 2e2e 2e20 292e  ).        ... ).
-00023600: 616c 6961 7328 2254 494d 4553 5441 4d50  alias("TIMESTAMP
-00023610: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
-00023620: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00023630: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
-00023640: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
-00023650: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-00023660: 322c 2034 2c20 312c 2031 312c 2031 3129  2, 4, 1, 11, 11)
-00023670: 292c 2052 6f77 2854 494d 4553 5441 4d50  ), Row(TIMESTAMP
-00023680: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
-00023690: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-000236a0: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
-000236b0: 3129 295d 0a20 2020 2022 2222 0a20 2020  1))].    """.   
-000236c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-000236d0: 2274 696d 6573 7461 6d70 5f66 726f 6d5f  "timestamp_from_
-000236e0: 7061 7274 7322 2928 0a20 2020 2020 2020  parts")(.       
-000236f0: 202a 5f74 696d 6573 7461 6d70 5f66 726f   *_timestamp_fro
-00023700: 6d5f 7061 7274 735f 696e 7465 726e 616c  m_parts_internal
-00023710: 2822 7469 6d65 7374 616d 705f 6672 6f6d  ("timestamp_from
-00023720: 5f70 6172 7473 222c 202a 6172 6773 2c20  _parts", *args, 
-00023730: 2a2a 6b77 6172 6773 290a 2020 2020 290a  **kwargs).    ).
-00023740: 0a0a 6465 6620 7469 6d65 7374 616d 705f  ..def timestamp_
-00023750: 6c74 7a5f 6672 6f6d 5f70 6172 7473 280a  ltz_from_parts(.
-00023760: 2020 2020 7965 6172 3a20 556e 696f 6e5b      year: Union[
-00023770: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-00023780: 745d 2c0a 2020 2020 6d6f 6e74 683a 2055  t],.    month: U
-00023790: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
-000237a0: 652c 2069 6e74 5d2c 0a20 2020 2064 6179  e, int],.    day
-000237b0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-000237c0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-000237d0: 686f 7572 3a20 556e 696f 6e5b 436f 6c75  hour: Union[Colu
-000237e0: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
-000237f0: 2020 2020 6d69 6e75 7465 3a20 556e 696f      minute: Unio
-00023800: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
-00023810: 696e 745d 2c0a 2020 2020 7365 636f 6e64  int],.    second
-00023820: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-00023830: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-00023840: 6e61 6e6f 7365 636f 6e64 733a 204f 7074  nanoseconds: Opt
-00023850: 696f 6e61 6c5b 556e 696f 6e5b 436f 6c75  ional[Union[Colu
-00023860: 6d6e 4f72 4e61 6d65 2c20 696e 745d 5d20  mnOrName, int]] 
-00023870: 3d20 4e6f 6e65 2c0a 2920 2d3e 2043 6f6c  = None,.) -> Col
-00023880: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00023890: 2043 7265 6174 6573 2061 2074 696d 6573   Creates a times
-000238a0: 7461 6d70 2066 726f 6d20 696e 6469 7669  tamp from indivi
-000238b0: 6475 616c 206e 756d 6572 6963 2063 6f6d  dual numeric com
-000238c0: 706f 6e65 6e74 732e 0a0a 2020 2020 4578  ponents...    Ex
-000238d0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000238e0: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
-000238f0: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
-00023900: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00023910: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00023920: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00023930: 5b5b 3230 3232 2c20 342c 2031 2c20 3131  [[2022, 4, 1, 11
-00023940: 2c20 3131 2c20 305d 2c20 5b32 3032 322c  , 11, 0], [2022,
-00023950: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
-00023960: 305d 5d2c 0a20 2020 2020 2020 202e 2e2e  0]],.        ...
-00023970: 2020 2020 2073 6368 656d 613d 5b22 7965       schema=["ye
-00023980: 6172 222c 2022 6d6f 6e74 6822 2c20 2264  ar", "month", "d
-00023990: 6179 222c 2022 686f 7572 222c 2022 6d69  ay", "hour", "mi
-000239a0: 6e75 7465 222c 2022 7365 636f 6e64 225d  nute", "second"]
-000239b0: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
-000239c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-000239d0: 656c 6563 7428 7469 6d65 7374 616d 705f  elect(timestamp_
-000239e0: 6c74 7a5f 6672 6f6d 5f70 6172 7473 280a  ltz_from_parts(.
-000239f0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00023a00: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
-00023a10: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
-00023a20: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
-00023a30: 6422 0a20 2020 2020 2020 202e 2e2e 2029  d".        ... )
-00023a40: 2e61 6c69 6173 2822 5449 4d45 5354 414d  .alias("TIMESTAM
-00023a50: 505f 4c54 5a5f 4652 4f4d 5f50 4152 5453  P_LTZ_FROM_PARTS
-00023a60: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00023a70: 2020 2020 2020 5b52 6f77 2854 494d 4553        [Row(TIMES
-00023a80: 5441 4d50 5f4c 545a 5f46 524f 4d5f 5041  TAMP_LTZ_FROM_PA
-00023a90: 5254 533d 6461 7465 7469 6d65 2e64 6174  RTS=datetime.dat
-00023aa0: 6574 696d 6528 3230 3232 2c20 342c 2031  etime(2022, 4, 1
-00023ab0: 2c20 3131 2c20 3131 2c20 747a 696e 666f  , 11, 11, tzinfo
-00023ac0: 3d3c 4473 7454 7a49 6e66 6f20 2741 6d65  =<DstTzInfo 'Ame
-00023ad0: 7269 6361 2f4c 6f73 5f41 6e67 656c 6573  rica/Los_Angeles
-00023ae0: 2720 5044 542d 3120 6461 792c 2031 373a  ' PDT-1 day, 17:
-00023af0: 3030 3a30 3020 4453 543e 2929 2c20 526f  00:00 DST>)), Ro
-00023b00: 7728 5449 4d45 5354 414d 505f 4c54 5a5f  w(TIMESTAMP_LTZ_
-00023b10: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
-00023b20: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
-00023b30: 322c 2033 2c20 3331 2c20 3131 2c20 3131  2, 3, 31, 11, 11
-00023b40: 2c20 747a 696e 666f 3d3c 4473 7454 7a49  , tzinfo=<DstTzI
-00023b50: 6e66 6f20 2741 6d65 7269 6361 2f4c 6f73  nfo 'America/Los
-00023b60: 5f41 6e67 656c 6573 2720 5044 542d 3120  _Angeles' PDT-1 
-00023b70: 6461 792c 2031 373a 3030 3a30 3020 4453  day, 17:00:00 DS
-00023b80: 543e 2929 5d0a 2020 2020 2222 220a 2020  T>))].    """.  
-00023b90: 2020 6675 6e63 5f6e 616d 6520 3d20 2274    func_name = "t
-00023ba0: 696d 6573 7461 6d70 5f6c 747a 5f66 726f  imestamp_ltz_fro
-00023bb0: 6d5f 7061 7274 7322 0a20 2020 2079 2c20  m_parts".    y, 
-00023bc0: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
-00023bd0: 203d 205f 636f 6c75 6d6e 735f 6672 6f6d   = _columns_from
-00023be0: 5f74 696d 6573 7461 6d70 5f70 6172 7473  _timestamp_parts
-00023bf0: 280a 2020 2020 2020 2020 6675 6e63 5f6e  (.        func_n
-00023c00: 616d 652c 2079 6561 722c 206d 6f6e 7468  ame, year, month
-00023c10: 2c20 6461 792c 2068 6f75 722c 206d 696e  , day, hour, min
-00023c20: 7574 652c 2073 6563 6f6e 640a 2020 2020  ute, second.    
-00023c30: 290a 2020 2020 6e73 203d 204e 6f6e 6520  ).    ns = None 
-00023c40: 6966 206e 616e 6f73 6563 6f6e 6473 2069  if nanoseconds i
-00023c50: 7320 4e6f 6e65 2065 6c73 6520 5f74 6f5f  s None else _to_
-00023c60: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
-00023c70: 7428 6e61 6e6f 7365 636f 6e64 732c 2066  t(nanoseconds, f
-00023c80: 756e 635f 6e61 6d65 290a 2020 2020 7265  unc_name).    re
-00023c90: 7475 726e 2028 0a20 2020 2020 2020 2062  turn (.        b
-00023ca0: 7569 6c74 696e 2866 756e 635f 6e61 6d65  uiltin(func_name
-00023cb0: 2928 792c 206d 2c20 642c 2068 2c20 6d69  )(y, m, d, h, mi
-00023cc0: 6e5f 2c20 7329 0a20 2020 2020 2020 2069  n_, s).        i
-00023cd0: 6620 6e73 2069 7320 4e6f 6e65 0a20 2020  f ns is None.   
-00023ce0: 2020 2020 2065 6c73 6520 6275 696c 7469       else builti
-00023cf0: 6e28 6675 6e63 5f6e 616d 6529 2879 2c20  n(func_name)(y, 
-00023d00: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
-00023d10: 2c20 6e73 290a 2020 2020 290a 0a0a 406f  , ns).    )...@o
-00023d20: 7665 726c 6f61 640a 6465 6620 7469 6d65  verload.def time
-00023d30: 7374 616d 705f 6e74 7a5f 6672 6f6d 5f70  stamp_ntz_from_p
-00023d40: 6172 7473 280a 2020 2020 6461 7465 5f65  arts(.    date_e
-00023d50: 7870 723a 2043 6f6c 756d 6e4f 724e 616d  xpr: ColumnOrNam
-00023d60: 652c 2074 696d 655f 6578 7072 3a20 436f  e, time_expr: Co
-00023d70: 6c75 6d6e 4f72 4e61 6d65 0a29 202d 3e20  lumnOrName.) -> 
-00023d80: 436f 6c75 6d6e 3a0a 2020 2020 2e2e 2e20  Column:.    ... 
-00023d90: 2023 2070 7261 676d 613a 206e 6f20 636f   # pragma: no co
-00023da0: 7665 720a 0a0a 406f 7665 726c 6f61 640a  ver...@overload.
-00023db0: 6465 6620 7469 6d65 7374 616d 705f 6e74  def timestamp_nt
-00023dc0: 7a5f 6672 6f6d 5f70 6172 7473 280a 2020  z_from_parts(.  
-00023dd0: 2020 7965 6172 3a20 556e 696f 6e5b 436f    year: Union[Co
-00023de0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00023df0: 2c0a 2020 2020 6d6f 6e74 683a 2055 6e69  ,.    month: Uni
-00023e00: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-00023e10: 2069 6e74 5d2c 0a20 2020 2064 6179 3a20   int],.    day: 
-00023e20: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-00023e30: 6d65 2c20 696e 745d 2c0a 2020 2020 686f  me, int],.    ho
-00023e40: 7572 3a20 556e 696f 6e5b 436f 6c75 6d6e  ur: Union[Column
-00023e50: 4f72 4e61 6d65 2c20 696e 745d 2c0a 2020  OrName, int],.  
-00023e60: 2020 6d69 6e75 7465 3a20 556e 696f 6e5b    minute: Union[
-00023e70: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
-00023e80: 745d 2c0a 2020 2020 7365 636f 6e64 3a20  t],.    second: 
-00023e90: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
-00023ea0: 6d65 2c20 696e 745d 2c0a 2020 2020 6e61  me, int],.    na
-00023eb0: 6e6f 7365 636f 6e64 3a20 4f70 7469 6f6e  nosecond: Option
-00023ec0: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f  al[Union[ColumnO
-00023ed0: 724e 616d 652c 2069 6e74 5d5d 203d 204e  rName, int]] = N
-00023ee0: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
-00023ef0: 3a0a 2020 2020 2e2e 2e20 2023 2070 7261  :.    ...  # pra
-00023f00: 676d 613a 206e 6f20 636f 7665 720a 0a0a  gma: no cover...
-00023f10: 6465 6620 7469 6d65 7374 616d 705f 6e74  def timestamp_nt
-00023f20: 7a5f 6672 6f6d 5f70 6172 7473 282a 6172  z_from_parts(*ar
-00023f30: 6773 2c20 2a2a 6b77 6172 6773 2920 2d3e  gs, **kwargs) ->
-00023f40: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00023f50: 0a20 2020 2043 7265 6174 6573 2061 2074  .    Creates a t
-00023f60: 696d 6573 7461 6d70 2066 726f 6d20 696e  imestamp from in
-00023f70: 6469 7669 6475 616c 206e 756d 6572 6963  dividual numeric
-00023f80: 2063 6f6d 706f 6e65 6e74 732e 2054 6865   components. The
-00023f90: 2066 756e 6374 696f 6e20 6361 6e20 6265   function can be
-00023fa0: 2075 7365 6420 746f 0a20 2020 2063 7265   used to.    cre
-00023fb0: 6174 6520 6120 7469 6d65 7374 616d 7020  ate a timestamp 
-00023fc0: 6672 6f6d 2061 2064 6174 6520 6578 7072  from a date expr
-00023fd0: 6573 7369 6f6e 2061 6e64 2061 2074 696d  ession and a tim
-00023fe0: 6520 6578 7072 6573 7369 6f6e 2e0a 0a20  e expression... 
-00023ff0: 2020 2045 7861 6d70 6c65 2031 3a3a 0a0a     Example 1::..
-00024000: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00024010: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-00024020: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
-00024030: 2020 202e 2e2e 2020 2020 205b 5b32 3032     ...     [[202
-00024040: 322c 2034 2c20 312c 2031 312c 2031 312c  2, 4, 1, 11, 11,
-00024050: 2030 5d2c 205b 3230 3232 2c20 332c 2033   0], [2022, 3, 3
-00024060: 312c 2031 312c 2031 312c 2030 5d5d 2c0a  1, 11, 11, 0]],.
-00024070: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00024080: 7363 6865 6d61 3d5b 2279 6561 7222 2c20  schema=["year", 
-00024090: 226d 6f6e 7468 222c 2022 6461 7922 2c20  "month", "day", 
-000240a0: 2268 6f75 7222 2c20 226d 696e 7574 6522  "hour", "minute"
-000240b0: 2c20 2273 6563 6f6e 6422 5d2c 0a20 2020  , "second"],.   
-000240c0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-000240d0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000240e0: 2874 696d 6573 7461 6d70 5f6e 747a 5f66  (timestamp_ntz_f
-000240f0: 726f 6d5f 7061 7274 7328 0a20 2020 2020  rom_parts(.     
-00024100: 2020 202e 2e2e 2020 2020 2022 7965 6172     ...     "year
-00024110: 222c 2022 6d6f 6e74 6822 2c20 2264 6179  ", "month", "day
-00024120: 222c 2022 686f 7572 222c 2022 6d69 6e75  ", "hour", "minu
-00024130: 7465 222c 2022 7365 636f 6e64 220a 2020  te", "second".  
-00024140: 2020 2020 2020 2e2e 2e20 292e 616c 6961        ... ).alia
-00024150: 7328 2254 494d 4553 5441 4d50 5f4e 545a  s("TIMESTAMP_NTZ
-00024160: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
-00024170: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00024180: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
-00024190: 4e54 5a5f 4652 4f4d 5f50 4152 5453 3d64  NTZ_FROM_PARTS=d
-000241a0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-000241b0: 2832 3032 322c 2034 2c20 312c 2031 312c  (2022, 4, 1, 11,
-000241c0: 2031 3129 292c 2052 6f77 2854 494d 4553   11)), Row(TIMES
-000241d0: 5441 4d50 5f4e 545a 5f46 524f 4d5f 5041  TAMP_NTZ_FROM_PA
-000241e0: 5254 533d 6461 7465 7469 6d65 2e64 6174  RTS=datetime.dat
-000241f0: 6574 696d 6528 3230 3232 2c20 332c 2033  etime(2022, 3, 3
-00024200: 312c 2031 312c 2031 3129 295d 0a0a 2020  1, 11, 11))]..  
-00024210: 2020 4578 616d 706c 6520 323a 3a0a 0a20    Example 2::.. 
-00024220: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00024230: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00024240: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-00024250: 2020 2e2e 2e20 2020 2020 5b5b 2732 3032    ...     [['202
-00024260: 322d 3034 2d30 3127 2c20 2731 313a 3131  2-04-01', '11:11
-00024270: 3a30 3027 5d2c 205b 2732 3032 322d 3033  :00'], ['2022-03
-00024280: 2d33 3127 2c20 2731 313a 3131 3a30 3027  -31', '11:11:00'
-00024290: 5d5d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]],.        ... 
-000242a0: 2020 2020 7363 6865 6d61 3d5b 2264 6174      schema=["dat
-000242b0: 6522 2c20 2274 696d 6522 5d0a 2020 2020  e", "time"].    
-000242c0: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
-000242d0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000242e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-000242f0: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
-00024300: 726f 6d5f 7061 7274 7328 746f 5f64 6174  rom_parts(to_dat
-00024310: 6528 2264 6174 6522 292c 2074 6f5f 7469  e("date"), to_ti
-00024320: 6d65 2822 7469 6d65 2229 0a20 2020 2020  me("time").     
-00024330: 2020 202e 2e2e 2029 2e61 6c69 6173 2822     ... ).alias("
-00024340: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
-00024350: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
-00024360: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00024370: 6f77 2854 494d 4553 5441 4d50 5f4e 545a  ow(TIMESTAMP_NTZ
-00024380: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
-00024390: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-000243a0: 3232 2c20 342c 2031 2c20 3131 2c20 3131  22, 4, 1, 11, 11
-000243b0: 2929 2c20 526f 7728 5449 4d45 5354 414d  )), Row(TIMESTAM
-000243c0: 505f 4e54 5a5f 4652 4f4d 5f50 4152 5453  P_NTZ_FROM_PARTS
-000243d0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
-000243e0: 6d65 2832 3032 322c 2033 2c20 3331 2c20  me(2022, 3, 31, 
-000243f0: 3131 2c20 3131 2929 5d0a 2020 2020 2222  11, 11))].    ""
-00024400: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
-00024410: 6c74 696e 2822 7469 6d65 7374 616d 705f  ltin("timestamp_
-00024420: 6e74 7a5f 6672 6f6d 5f70 6172 7473 2229  ntz_from_parts")
-00024430: 280a 2020 2020 2020 2020 2a5f 7469 6d65  (.        *_time
-00024440: 7374 616d 705f 6672 6f6d 5f70 6172 7473  stamp_from_parts
-00024450: 5f69 6e74 6572 6e61 6c28 2274 696d 6573  _internal("times
-00024460: 7461 6d70 5f6e 747a 5f66 726f 6d5f 7061  tamp_ntz_from_pa
-00024470: 7274 7322 2c20 2a61 7267 732c 202a 2a6b  rts", *args, **k
-00024480: 7761 7267 7329 0a20 2020 2029 0a0a 0a64  wargs).    )...d
-00024490: 6566 2074 696d 6573 7461 6d70 5f74 7a5f  ef timestamp_tz_
-000244a0: 6672 6f6d 5f70 6172 7473 280a 2020 2020  from_parts(.    
-000244b0: 7965 6172 3a20 556e 696f 6e5b 436f 6c75  year: Union[Colu
-000244c0: 6d6e 4f72 4e61 6d65 2c20 696e 745d 2c0a  mnOrName, int],.
-000244d0: 2020 2020 6d6f 6e74 683a 2055 6e69 6f6e      month: Union
-000244e0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
-000244f0: 6e74 5d2c 0a20 2020 2064 6179 3a20 556e  nt],.    day: Un
-00024500: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-00024510: 2c20 696e 745d 2c0a 2020 2020 686f 7572  , int],.    hour
-00024520: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
-00024530: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
-00024540: 6d69 6e75 7465 3a20 556e 696f 6e5b 436f  minute: Union[Co
-00024550: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00024560: 2c0a 2020 2020 7365 636f 6e64 3a20 556e  ,.    second: Un
-00024570: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
-00024580: 2c20 696e 745d 2c0a 2020 2020 6e61 6e6f  , int],.    nano
-00024590: 7365 636f 6e64 733a 204f 7074 696f 6e61  seconds: Optiona
-000245a0: 6c5b 556e 696f 6e5b 436f 6c75 6d6e 4f72  l[Union[ColumnOr
-000245b0: 4e61 6d65 2c20 696e 745d 5d20 3d20 4e6f  Name, int]] = No
-000245c0: 6e65 2c0a 2020 2020 7469 6d65 7a6f 6e65  ne,.    timezone
-000245d0: 3a20 4f70 7469 6f6e 616c 5b43 6f6c 756d  : Optional[Colum
-000245e0: 6e4f 724c 6974 6572 616c 5374 725d 203d  nOrLiteralStr] =
-000245f0: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
-00024600: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00024610: 4372 6561 7465 7320 6120 7469 6d65 7374  Creates a timest
-00024620: 616d 7020 6672 6f6d 2069 6e64 6976 6964  amp from individ
-00024630: 7561 6c20 6e75 6d65 7269 6320 636f 6d70  ual numeric comp
-00024640: 6f6e 656e 7473 2061 6e64 2061 2073 7472  onents and a str
-00024650: 696e 6720 7469 6d65 7a6f 6e65 2e0a 0a20  ing timezone... 
-00024660: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-00024670: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00024680: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00024690: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
-000246a0: 202e 2e2e 2020 2020 205b 5b32 3032 322c   ...     [[2022,
-000246b0: 2034 2c20 312c 2031 312c 2031 312c 2030   4, 1, 11, 11, 0
-000246c0: 2c20 2741 6d65 7269 6361 2f4c 6f73 5f41  , 'America/Los_A
-000246d0: 6e67 656c 6573 275d 2c20 5b32 3032 322c  ngeles'], [2022,
-000246e0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
-000246f0: 302c 2027 416d 6572 6963 612f 4c6f 735f  0, 'America/Los_
-00024700: 416e 6765 6c65 7327 5d5d 2c0a 2020 2020  Angeles']],.    
-00024710: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
-00024720: 6d61 3d5b 2279 6561 7222 2c20 226d 6f6e  ma=["year", "mon
-00024730: 7468 222c 2022 6461 7922 2c20 2268 6f75  th", "day", "hou
-00024740: 7222 2c20 226d 696e 7574 6522 2c20 2273  r", "minute", "s
-00024750: 6563 6f6e 6422 2c20 2274 696d 657a 6f6e  econd", "timezon
-00024760: 6522 5d2c 0a20 2020 2020 2020 202e 2e2e  e"],.        ...
-00024770: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-00024780: 662e 7365 6c65 6374 2874 696d 6573 7461  f.select(timesta
-00024790: 6d70 5f74 7a5f 6672 6f6d 5f70 6172 7473  mp_tz_from_parts
-000247a0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-000247b0: 2020 2279 6561 7222 2c20 226d 6f6e 7468    "year", "month
-000247c0: 222c 2022 6461 7922 2c20 2268 6f75 7222  ", "day", "hour"
-000247d0: 2c20 226d 696e 7574 6522 2c20 2273 6563  , "minute", "sec
-000247e0: 6f6e 6422 2c20 7469 6d65 7a6f 6e65 3d22  ond", timezone="
-000247f0: 7469 6d65 7a6f 6e65 220a 2020 2020 2020  timezone".      
-00024800: 2020 2e2e 2e20 292e 616c 6961 7328 2254    ... ).alias("T
-00024810: 494d 4553 5441 4d50 5f54 5a5f 4652 4f4d  IMESTAMP_TZ_FROM
-00024820: 5f50 4152 5453 2229 292e 636f 6c6c 6563  _PARTS")).collec
-00024830: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00024840: 2854 494d 4553 5441 4d50 5f54 5a5f 4652  (TIMESTAMP_TZ_FR
+000091d0: 5f64 6174 6166 7261 6d65 285b 3432 5d2c  _dataframe([42],
+000091e0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+000091f0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00009200: 6c65 6374 2876 6172 5f70 6f70 2863 6f6c  lect(var_pop(col
+00009210: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00009220: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+00009230: 4152 5f50 4f50 2822 4122 293d 4465 6369  AR_POP("A")=Deci
+00009240: 6d61 6c28 2730 2e30 3030 3030 3027 2929  mal('0.000000'))
+00009250: 5d0a 0a20 2020 2022 2222 0a20 2020 2063  ]..    """.    c
+00009260: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00009270: 7228 652c 2022 7661 725f 706f 7022 290a  r(e, "var_pop").
+00009280: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00009290: 696e 2822 7661 725f 706f 7022 2928 6329  in("var_pop")(c)
+000092a0: 0a0a 0a64 6566 2061 7070 726f 785f 7065  ...def approx_pe
+000092b0: 7263 656e 7469 6c65 2863 6f6c 3a20 436f  rcentile(col: Co
+000092c0: 6c75 6d6e 4f72 4e61 6d65 2c20 7065 7263  lumnOrName, perc
+000092d0: 656e 7469 6c65 3a20 666c 6f61 7429 202d  entile: float) -
+000092e0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000092f0: 2252 6574 7572 6e73 2061 6e20 6170 7072  "Returns an appr
+00009300: 6f78 696d 6174 6564 2076 616c 7565 2066  oximated value f
+00009310: 6f72 2074 6865 2064 6573 6972 6564 2070  or the desired p
+00009320: 6572 6365 6e74 696c 652e 2054 6869 7320  ercentile. This 
+00009330: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
+00009340: 6520 742d 4469 6765 7374 2061 6c67 6f72  e t-Digest algor
+00009350: 6974 686d 2e0a 0a20 2020 2045 7861 6d70  ithm...    Examp
+00009360: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00009370: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00009380: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00009390: 302c 312c 322c 332c 342c 352c 362c 372c  0,1,2,3,4,5,6,7,
+000093a0: 382c 395d 2c20 7363 6865 6d61 3d5b 2261  8,9], schema=["a
+000093b0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000093c0: 6466 2e73 656c 6563 7428 6170 7072 6f78  df.select(approx
+000093d0: 5f70 6572 6365 6e74 696c 6528 2261 222c  _percentile("a",
+000093e0: 2030 2e35 292e 616c 6961 7328 2272 6573   0.5).alias("res
+000093f0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+00009400: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00009410: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00009420: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00009430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00009440: 2020 2020 207c 342e 3520 2020 2020 2020       |4.5       
+00009450: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00009460: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00009470: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00009480: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00009490: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+000094a0: 6170 7072 6f78 5f70 6572 6365 6e74 696c  approx_percentil
+000094b0: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
+000094c0: 7569 6c74 696e 2822 6170 7072 6f78 5f70  uiltin("approx_p
+000094d0: 6572 6365 6e74 696c 6522 2928 632c 206c  ercentile")(c, l
+000094e0: 6974 2870 6572 6365 6e74 696c 6529 290a  it(percentile)).
+000094f0: 0a0a 6465 6620 6170 7072 6f78 5f70 6572  ..def approx_per
+00009500: 6365 6e74 696c 655f 6163 6375 6d75 6c61  centile_accumula
+00009510: 7465 2863 6f6c 3a20 436f 6c75 6d6e 4f72  te(col: ColumnOr
+00009520: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00009530: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00009540: 7468 6520 696e 7465 726e 616c 2072 6570  the internal rep
+00009550: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
+00009560: 6865 2074 2d44 6967 6573 7420 7374 6174  he t-Digest stat
+00009570: 6520 2861 7320 6120 4a53 4f4e 206f 626a  e (as a JSON obj
+00009580: 6563 7429 2061 7420 7468 6520 656e 6420  ect) at the end 
+00009590: 6f66 2061 6767 7265 6761 7469 6f6e 2e0a  of aggregation..
+000095a0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+000095b0: 6e20 7573 6573 2074 6865 2074 2d44 6967  n uses the t-Dig
+000095c0: 6573 7420 616c 676f 7269 7468 6d2e 0a0a  est algorithm...
+000095d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+000095e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000095f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00009600: 7461 6672 616d 6528 5b31 2c32 2c33 2c34  taframe([1,2,3,4
+00009610: 2c35 5d2c 2073 6368 656d 613d 5b22 6122  ,5], schema=["a"
+00009620: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00009630: 662e 7365 6c65 6374 2861 7070 726f 785f  f.select(approx_
+00009640: 7065 7263 656e 7469 6c65 5f61 6363 756d  percentile_accum
+00009650: 756c 6174 6528 2261 2229 2e61 6c69 6173  ulate("a").alias
+00009660: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+00009670: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00009680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009690: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000096a0: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
+000096b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000096c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000096d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000096e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000096f0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
+00009700: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+00009710: 2020 2020 2020 207c 2020 2273 7461 7465         |  "state
+00009720: 223a 205b 2020 2020 2020 2020 2020 2020  ": [            
+00009730: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00009740: 2020 2031 2e30 3030 3030 3030 3030 3030     1.00000000000
+00009750: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+00009760: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
+00009770: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+00009780: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+00009790: 2032 2e30 3030 3030 3030 3030 3030 3030   2.0000000000000
+000097a0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
+000097b0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
+000097c0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
+000097d0: 7c0a 2020 2020 2020 2020 7c20 2020 2033  |.        |    3
+000097e0: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
+000097f0: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
+00009800: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
+00009810: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
+00009820: 2020 2020 2020 2020 7c20 2020 2034 2e30          |    4.0
+00009830: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+00009840: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+00009850: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
+00009860: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+00009870: 2020 2020 2020 7c20 2020 2035 2e30 3030        |    5.000
+00009880: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+00009890: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+000098a0: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
+000098b0: 3030 3065 2b30 3020 2020 7c0a 2020 2020  000e+00   |.    
+000098c0: 2020 2020 7c20 205d 2c20 2020 2020 2020      |  ],       
+000098d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000098e0: 207c 0a20 2020 2020 2020 207c 2020 2274   |.        |  "t
+000098f0: 7970 6522 3a20 2274 6469 6765 7374 222c  ype": "tdigest",
+00009900: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00009910: 2020 7c20 2022 7665 7273 696f 6e22 3a20    |  "version": 
+00009920: 3120 2020 2020 2020 2020 2020 2020 207c  1              |
+00009930: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
+00009940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009950: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00009960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00009980: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00009990: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+000099a0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+000099b0: 7228 636f 6c2c 2022 6170 7072 6f78 5f70  r(col, "approx_p
+000099c0: 6572 6365 6e74 696c 655f 6163 6375 6d75  ercentile_accumu
+000099d0: 6c61 7465 2229 0a20 2020 2072 6574 7572  late").    retur
+000099e0: 6e20 6275 696c 7469 6e28 2261 7070 726f  n builtin("appro
+000099f0: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
+00009a00: 756d 756c 6174 6522 2928 6329 0a0a 0a64  umulate")(c)...d
+00009a10: 6566 2061 7070 726f 785f 7065 7263 656e  ef approx_percen
+00009a20: 7469 6c65 5f65 7374 696d 6174 6528 7374  tile_estimate(st
+00009a30: 6174 653a 2043 6f6c 756d 6e4f 724e 616d  ate: ColumnOrNam
+00009a40: 652c 2070 6572 6365 6e74 696c 653a 2066  e, percentile: f
+00009a50: 6c6f 6174 2920 2d3e 2043 6f6c 756d 6e3a  loat) -> Column:
+00009a60: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+00009a70: 7468 6520 6465 7369 7265 6420 6170 7072  the desired appr
+00009a80: 6f78 696d 6174 6564 2070 6572 6365 6e74  oximated percent
+00009a90: 696c 6520 7661 6c75 6520 666f 7220 7468  ile value for th
+00009aa0: 6520 7370 6563 6966 6965 6420 742d 4469  e specified t-Di
+00009ab0: 6765 7374 2073 7461 7465 2e0a 2020 2020  gest state..    
+00009ac0: 4150 5052 4f58 5f50 4552 4345 4e54 494c  APPROX_PERCENTIL
+00009ad0: 455f 4553 5449 4d41 5445 2841 5050 524f  E_ESTIMATE(APPRO
+00009ae0: 585f 5045 5243 454e 5449 4c45 5f41 4343  X_PERCENTILE_ACC
+00009af0: 554d 554c 4154 4528 2e29 2920 6973 2065  UMULATE(.)) is e
+00009b00: 7175 6976 616c 656e 7420 746f 0a20 2020  quivalent to.   
+00009b10: 2041 5050 524f 585f 5045 5243 454e 5449   APPROX_PERCENTI
+00009b20: 4c45 282e 292e 0a0a 2020 2020 4578 616d  LE(.)...    Exam
+00009b30: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00009b40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00009b50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00009b60: 5b31 2c32 2c33 2c34 2c35 5d2c 2073 6368  [1,2,3,4,5], sch
+00009b70: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00009b80: 2020 203e 3e3e 2064 665f 6163 6375 203d     >>> df_accu =
+00009b90: 2064 662e 7365 6c65 6374 2861 7070 726f   df.select(appro
+00009ba0: 785f 7065 7263 656e 7469 6c65 5f61 6363  x_percentile_acc
+00009bb0: 756d 756c 6174 6528 2261 2229 2e61 6c69  umulate("a").ali
+00009bc0: 6173 2822 6170 705f 7065 7263 656e 7469  as("app_percenti
+00009bd0: 6c65 5f61 6363 7522 2929 0a20 2020 2020  le_accu")).     
+00009be0: 2020 203e 3e3e 2064 665f 6163 6375 2e73     >>> df_accu.s
+00009bf0: 656c 6563 7428 6170 7072 6f78 5f70 6572  elect(approx_per
+00009c00: 6365 6e74 696c 655f 6573 7469 6d61 7465  centile_estimate
+00009c10: 2822 6170 705f 7065 7263 656e 7469 6c65  ("app_percentile
+00009c20: 5f61 6363 7522 2c20 302e 3529 2e61 6c69  _accu", 0.5).ali
+00009c30: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+00009c40: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00009c50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00009c60: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+00009c70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00009c80: 2d2d 2d0a 2020 2020 2020 2020 7c33 2e30  ---.        |3.0
+00009c90: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00009ca0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00009cb0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00009cc0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
+00009cd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00009ce0: 2873 7461 7465 2c20 2261 7070 726f 785f  (state, "approx_
+00009cf0: 7065 7263 656e 7469 6c65 5f65 7374 696d  percentile_estim
+00009d00: 6174 6522 290a 2020 2020 7265 7475 726e  ate").    return
+00009d10: 2062 7569 6c74 696e 2822 6170 7072 6f78   builtin("approx
+00009d20: 5f70 6572 6365 6e74 696c 655f 6573 7469  _percentile_esti
+00009d30: 6d61 7465 2229 2863 2c20 6c69 7428 7065  mate")(c, lit(pe
+00009d40: 7263 656e 7469 6c65 2929 0a0a 0a64 6566  rcentile))...def
+00009d50: 2061 7070 726f 785f 7065 7263 656e 7469   approx_percenti
+00009d60: 6c65 5f63 6f6d 6269 6e65 2873 7461 7465  le_combine(state
+00009d70: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00009d80: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00009d90: 2222 436f 6d62 696e 6573 2028 6d65 7267  ""Combines (merg
+00009da0: 6573 2920 7065 7263 656e 7469 6c65 2069  es) percentile i
+00009db0: 6e70 7574 2073 7461 7465 7320 696e 746f  nput states into
+00009dc0: 2061 2073 696e 676c 6520 6f75 7470 7574   a single output
+00009dd0: 2073 7461 7465 2e0a 2020 2020 5468 6973   state..    This
+00009de0: 2061 6c6c 6f77 7320 7363 656e 6172 696f   allows scenario
+00009df0: 7320 7768 6572 6520 4150 5052 4f58 5f50  s where APPROX_P
+00009e00: 4552 4345 4e54 494c 455f 4143 4355 4d55  ERCENTILE_ACCUMU
+00009e10: 4c41 5445 2069 7320 7275 6e20 6f76 6572  LATE is run over
+00009e20: 2068 6f72 697a 6f6e 7461 6c20 7061 7274   horizontal part
+00009e30: 6974 696f 6e73 0a20 2020 206f 6620 7468  itions.    of th
+00009e40: 6520 7361 6d65 2074 6162 6c65 2c20 7072  e same table, pr
+00009e50: 6f64 7563 696e 6720 616e 2061 6c67 6f72  oducing an algor
+00009e60: 6974 686d 2073 7461 7465 2066 6f72 2065  ithm state for e
+00009e70: 6163 6820 7461 626c 6520 7061 7274 6974  ach table partit
+00009e80: 696f 6e2e 2054 6865 7365 2073 7461 7465  ion. These state
+00009e90: 7320 6361 6e0a 2020 2020 6c61 7465 7220  s can.    later 
+00009ea0: 6265 2063 6f6d 6269 6e65 6420 7573 696e  be combined usin
+00009eb0: 6720 4150 5052 4f58 5f50 4552 4345 4e54  g APPROX_PERCENT
+00009ec0: 494c 455f 434f 4d42 494e 452c 2070 726f  ILE_COMBINE, pro
+00009ed0: 6475 6369 6e67 2074 6865 2073 616d 6520  ducing the same 
+00009ee0: 6f75 7470 7574 2073 7461 7465 2061 7320  output state as 
+00009ef0: 610a 2020 2020 7369 6e67 6c65 2072 756e  a.    single run
+00009f00: 206f 6620 4150 5052 4f58 5f50 4552 4345   of APPROX_PERCE
+00009f10: 4e54 494c 455f 4143 4355 4d55 4c41 5445  NTILE_ACCUMULATE
+00009f20: 206f 7665 7220 7468 6520 656e 7469 7265   over the entire
+00009f30: 2074 6162 6c65 2e0a 0a20 2020 2045 7861   table...    Exa
+00009f40: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+00009f50: 3e3e 2064 6631 203d 2073 6573 7369 6f6e  >> df1 = session
+00009f60: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00009f70: 6528 5b31 2c32 2c33 2c34 2c35 5d2c 2073  e([1,2,3,4,5], s
+00009f80: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00009f90: 2020 2020 203e 3e3e 2064 6632 203d 2073       >>> df2 = s
+00009fa0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00009fb0: 7461 6672 616d 6528 5b36 2c37 2c38 2c39  taframe([6,7,8,9
+00009fc0: 2c31 305d 2c20 7363 6865 6d61 3d5b 2262  ,10], schema=["b
+00009fd0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00009fe0: 6466 5f61 6363 7531 203d 2064 6631 2e73  df_accu1 = df1.s
+00009ff0: 656c 6563 7428 6170 7072 6f78 5f70 6572  elect(approx_per
+0000a000: 6365 6e74 696c 655f 6163 6375 6d75 6c61  centile_accumula
+0000a010: 7465 2822 6122 292e 616c 6961 7328 2261  te("a").alias("a
+0000a020: 7070 5f70 6572 6365 6e74 696c 655f 6163  pp_percentile_ac
+0000a030: 6375 2229 290a 2020 2020 2020 2020 3e3e  cu")).        >>
+0000a040: 3e20 6466 5f61 6363 7532 203d 2064 6632  > df_accu2 = df2
+0000a050: 2e73 656c 6563 7428 6170 7072 6f78 5f70  .select(approx_p
+0000a060: 6572 6365 6e74 696c 655f 6163 6375 6d75  ercentile_accumu
+0000a070: 6c61 7465 2822 6222 292e 616c 6961 7328  late("b").alias(
+0000a080: 2261 7070 5f70 6572 6365 6e74 696c 655f  "app_percentile_
+0000a090: 6163 6375 2229 290a 2020 2020 2020 2020  accu")).        
+0000a0a0: 3e3e 3e20 6466 5f61 6363 7531 2e75 6e69  >>> df_accu1.uni
+0000a0b0: 6f6e 2864 665f 6163 6375 3229 2e73 656c  on(df_accu2).sel
+0000a0c0: 6563 7428 6170 7072 6f78 5f70 6572 6365  ect(approx_perce
+0000a0d0: 6e74 696c 655f 636f 6d62 696e 6528 2261  ntile_combine("a
+0000a0e0: 7070 5f70 6572 6365 6e74 696c 655f 6163  pp_percentile_ac
+0000a0f0: 6375 2229 2e61 6c69 6173 2822 7265 7375  cu").alias("resu
+0000a100: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0000a110: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000a120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a130: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0000a140: 5355 4c54 2220 2020 2020 2020 2020 2020  SULT"           
+0000a150: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0000a160: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000a170: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a180: 2d0a 2020 2020 2020 2020 7c7b 2020 2020  -.        |{    
+0000a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1a0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0000a1b0: 207c 2020 2273 7461 7465 223a 205b 2020   |  "state": [  
+0000a1c0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+0000a1d0: 2020 2020 2020 2020 7c20 2020 2031 2e30          |    1.0
+0000a1e0: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+0000a1f0: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+0000a200: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
+0000a210: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+0000a220: 2020 2020 2020 7c20 2020 2032 2e30 3030        |    2.000
+0000a230: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
+0000a240: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+0000a250: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
+0000a260: 3030 3065 2b30 302c 2020 7c0a 2020 2020  000e+00,  |.    
+0000a270: 2020 2020 7c20 2020 2033 2e30 3030 3030      |    3.00000
+0000a280: 3030 3030 3030 3030 3030 652b 3030 2c20  0000000000e+00, 
+0000a290: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+0000a2a0: 312e 3030 3030 3030 3030 3030 3030 3030  1.00000000000000
+0000a2b0: 3065 2b30 302c 2020 7c0a 2020 2020 2020  0e+00,  |.      
+0000a2c0: 2020 7c20 2020 2034 2e30 3030 3030 3030    |    4.0000000
+0000a2d0: 3030 3030 3030 3030 652b 3030 2c20 207c  00000000e+00,  |
+0000a2e0: 0a20 2020 2020 2020 207c 2020 2020 312e  .        |    1.
+0000a2f0: 3030 3030 3030 3030 3030 3030 3030 3065  000000000000000e
+0000a300: 2b30 302c 2020 7c0a 2020 2020 2020 2020  +00,  |.        
+0000a310: 7c20 2020 2035 2e30 3030 3030 3030 3030  |    5.000000000
+0000a320: 3030 3030 3030 652b 3030 2c20 207c 0a20  000000e+00,  |. 
+0000a330: 2020 2020 2020 207c 2020 2020 312e 3030         |    1.00
+0000a340: 3030 3030 3030 3030 3030 3030 3065 2b30  0000000000000e+0
+0000a350: 302c 2020 7c0a 2020 2020 2020 2020 7c20  0,  |.        | 
+0000a360: 2020 2036 2e30 3030 3030 3030 3030 3030     6.00000000000
+0000a370: 3030 3030 652b 3030 2c20 207c 0a20 2020  0000e+00,  |.   
+0000a380: 2020 2020 207c 2020 2020 312e 3030 3030       |    1.0000
+0000a390: 3030 3030 3030 3030 3030 3065 2b30 302c  00000000000e+00,
+0000a3a0: 2020 7c0a 2020 2020 2020 2020 7c20 2020    |.        |   
+0000a3b0: 2037 2e30 3030 3030 3030 3030 3030 3030   7.0000000000000
+0000a3c0: 3030 652b 3030 2c20 207c 0a20 2020 2020  00e+00,  |.     
+0000a3d0: 2020 207c 2020 2020 312e 3030 3030 3030     |    1.000000
+0000a3e0: 3030 3030 3030 3030 3065 2b30 302c 2020  000000000e+00,  
+0000a3f0: 7c0a 2020 2020 2020 2020 7c20 2020 2038  |.        |    8
+0000a400: 2e30 3030 3030 3030 3030 3030 3030 3030  .000000000000000
+0000a410: 652b 3030 2c20 207c 0a20 2020 2020 2020  e+00,  |.       
+0000a420: 207c 2020 2020 312e 3030 3030 3030 3030   |    1.00000000
+0000a430: 3030 3030 3030 3065 2b30 302c 2020 7c0a  0000000e+00,  |.
+0000a440: 2020 2020 2020 2020 7c20 2020 2039 2e30          |    9.0
+0000a450: 3030 3030 3030 3030 3030 3030 3030 652b  00000000000000e+
+0000a460: 3030 2c20 207c 0a20 2020 2020 2020 207c  00,  |.        |
+0000a470: 2020 2020 312e 3030 3030 3030 3030 3030      1.0000000000
+0000a480: 3030 3030 3065 2b30 302c 2020 7c0a 2020  00000e+00,  |.  
+0000a490: 2020 2020 2020 7c20 2020 2031 2e30 3030        |    1.000
+0000a4a0: 3030 3030 3030 3030 3030 3030 652b 3031  000000000000e+01
+0000a4b0: 2c20 207c 0a20 2020 2020 2020 207c 2020  ,  |.        |  
+0000a4c0: 2020 312e 3030 3030 3030 3030 3030 3030    1.000000000000
+0000a4d0: 3030 3065 2b30 3020 2020 7c0a 2020 2020  000e+00   |.    
+0000a4e0: 2020 2020 7c20 205d 2c20 2020 2020 2020      |  ],       
+0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a500: 207c 0a20 2020 2020 2020 207c 2020 2274   |.        |  "t
+0000a510: 7970 6522 3a20 2274 6469 6765 7374 222c  ype": "tdigest",
+0000a520: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0000a530: 2020 7c20 2022 7665 7273 696f 6e22 3a20    |  "version": 
+0000a540: 3120 2020 2020 2020 2020 2020 2020 207c  1              |
+0000a550: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
+0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a570: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000a580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0000a5a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000a5b0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0000a5c0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000a5d0: 7228 7374 6174 652c 2022 6170 7072 6f78  r(state, "approx
+0000a5e0: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
+0000a5f0: 696e 6522 290a 2020 2020 7265 7475 726e  ine").    return
+0000a600: 2062 7569 6c74 696e 2822 6170 7072 6f78   builtin("approx
+0000a610: 5f70 6572 6365 6e74 696c 655f 636f 6d62  _percentile_comb
+0000a620: 696e 6522 2928 6329 0a0a 0a64 6566 2065  ine")(c)...def e
+0000a630: 7870 6c6f 6465 2863 6f6c 3a20 436f 6c75  xplode(col: Colu
+0000a640: 6d6e 4f72 4e61 6d65 2920 2d3e 2054 6162  mnOrName) -> Tab
+0000a650: 6c65 4675 6e63 7469 6f6e 4361 6c6c 3a0a  leFunctionCall:.
+0000a660: 2020 2020 2222 2246 6c61 7474 656e 7320      """Flattens 
+0000a670: 6120 6769 7665 6e20 6172 7261 7920 6f72  a given array or
+0000a680: 206d 6170 2074 7970 6520 636f 6c75 6d6e   map type column
+0000a690: 2069 6e74 6f20 696e 6469 7669 6475 616c   into individual
+0000a6a0: 2072 6f77 732e 2054 6865 2064 6566 6175   rows. The defau
+0000a6b0: 6c74 0a20 2020 2063 6f6c 756d 6e20 6e61  lt.    column na
+0000a6c0: 6d65 2066 6f72 2074 6865 206f 7574 7075  me for the outpu
+0000a6d0: 7420 636f 6c75 6d6e 2069 6e20 6361 7365  t column in case
+0000a6e0: 206f 6620 6172 7261 7920 696e 7075 7420   of array input 
+0000a6f0: 636f 6c75 6d6e 2069 7320 6060 5641 4c55  column is ``VALU
+0000a700: 4560 602c 0a20 2020 2061 6e64 2069 7320  E``,.    and is 
+0000a710: 6060 4b45 5960 6020 616e 6420 6060 5641  ``KEY`` and ``VA
+0000a720: 4c55 4560 6020 696e 2063 6173 6520 6f66  LUE`` in case of
+0000a730: 206d 6170 2069 6e70 7574 2063 6f6c 756d   map input colum
+0000a740: 6e2e 0a0a 2020 2020 4578 616d 706c 6573  n...    Examples
+0000a750: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+0000a760: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000a770: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+0000a780: 2c20 5b31 2c20 322c 2033 5d2c 207b 2241  , [1, 2, 3], {"A
+0000a790: 7368 6920 4761 7261 6d69 223a 2022 5369  shi Garami": "Si
+0000a7a0: 6e67 6c65 204c 6567 2058 227d 2c20 224b  ngle Leg X"}, "K
+0000a7b0: 696d 7572 6122 5d2c 0a20 2020 2020 2020  imura"],.       
+0000a7c0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+0000a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7e0: 2020 2020 5b32 2c20 5b31 312c 2032 325d      [2, [11, 22]
+0000a7f0: 2c20 7b22 5361 6e6b 616b 7522 3a20 2254  , {"Sankaku": "T
+0000a800: 7269 616e 676c 6522 7d2c 2022 436f 6666  riangle"}, "Coff
+0000a810: 6565 225d 5d2c 0a20 2020 2020 2020 202e  ee"]],.        .
+0000a820: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a840: 2020 7363 6865 6d61 3d5b 2269 6478 222c    schema=["idx",
+0000a850: 2022 6c69 7374 7322 2c20 226d 6170 7322   "lists", "maps"
+0000a860: 2c20 2273 7472 7322 5d29 0a20 2020 2020  , "strs"]).     
+0000a870: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0000a880: 2864 662e 6964 782c 2065 7870 6c6f 6465  (df.idx, explode
+0000a890: 2864 662e 6c69 7374 7329 292e 7368 6f77  (df.lists)).show
+0000a8a0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0000a8b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0000a8c0: 2020 2020 2020 207c 2249 4458 2220 207c         |"IDX"  |
+0000a8d0: 2256 414c 5545 2220 207c 0a20 2020 2020  "VALUE"  |.     
+0000a8e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000a8f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000a900: 3120 2020 2020 207c 3120 2020 2020 2020  1      |1       
+0000a910: 207c 0a20 2020 2020 2020 207c 3120 2020   |.        |1   
+0000a920: 2020 207c 3220 2020 2020 2020 207c 0a20     |2        |. 
+0000a930: 2020 2020 2020 207c 3120 2020 2020 207c         |1      |
+0000a940: 3320 2020 2020 2020 207c 0a20 2020 2020  3        |.     
+0000a950: 2020 207c 3220 2020 2020 207c 3131 2020     |2      |11  
+0000a960: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0000a970: 3220 2020 2020 207c 3232 2020 2020 2020  2      |22      
+0000a980: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000a990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0000a9a0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000a9b0: 453e 0a0a 2020 2020 2020 2020 3e3e 3e20  E>..        >>> 
+0000a9c0: 6466 2e73 656c 6563 7428 6466 2e73 7472  df.select(df.str
+0000a9d0: 732c 2065 7870 6c6f 6465 2864 662e 6d61  s, explode(df.ma
+0000a9e0: 7073 2929 2e73 686f 7728 290a 2020 2020  ps)).show().    
+0000a9f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000aa00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000aa10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0000aa20: 2020 2020 2020 7c22 5354 5253 2220 207c        |"STRS"  |
+0000aa30: 224b 4559 2220 2020 2020 2020 207c 2256  "KEY"        |"V
+0000aa40: 414c 5545 2220 2020 2020 2020 2020 7c0a  ALUE"         |.
+0000aa50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000aa60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000aa70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000aa80: 2d0a 2020 2020 2020 2020 7c4b 696d 7572  -.        |Kimur
+0000aa90: 6120 207c 4173 6869 2047 6172 616d 6920  a  |Ashi Garami 
+0000aaa0: 207c 2253 696e 676c 6520 4c65 6720 5822   |"Single Leg X"
+0000aab0: 2020 7c0a 2020 2020 2020 2020 7c43 6f66    |.        |Cof
+0000aac0: 6665 6520 207c 5361 6e6b 616b 7520 2020  fee  |Sankaku   
+0000aad0: 2020 207c 2254 7269 616e 676c 6522 2020     |"Triangle"  
+0000aae0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0000aaf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ab00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ab10: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000ab20: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
+0000ab30: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0000ab40: 6374 2865 7870 6c6f 6465 2863 6f6c 2822  ct(explode(col("
+0000ab50: 6c69 7374 7322 2929 2e61 6c69 6173 2822  lists")).alias("
+0000ab60: 756e 6f22 2929 2e73 686f 7728 290a 2020  uno")).show().  
+0000ab70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
+0000ab80: 2020 2020 2020 2020 7c22 554e 4f22 2020          |"UNO"  
+0000ab90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000aba0: 2d2d 2d0a 2020 2020 2020 2020 7c31 2020  ---.        |1  
+0000abb0: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
+0000abc0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000abd0: 7c33 2020 2020 2020 7c0a 2020 2020 2020  |3      |.      
+0000abe0: 2020 7c31 3120 2020 2020 7c0a 2020 2020    |11     |.    
+0000abf0: 2020 2020 7c32 3220 2020 2020 7c0a 2020      |22     |.  
+0000ac00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a        ---------.
+0000ac10: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0000ac20: 4e45 3e0a 0a20 2020 2020 2020 203e 3e3e  NE>..        >>>
+0000ac30: 2064 662e 7365 6c65 6374 2865 7870 6c6f   df.select(explo
+0000ac40: 6465 2827 6d61 7073 2729 2e61 735f 2822  de('maps').as_("
+0000ac50: 7072 696d 6f22 2c20 2273 6563 756e 646f  primo", "secundo
+0000ac60: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0000ac70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000ac80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ac90: 2d2d 2d0a 2020 2020 2020 2020 7c22 5052  ---.        |"PR
+0000aca0: 494d 4f22 2020 2020 2020 7c22 5345 4355  IMO"      |"SECU
+0000acb0: 4e44 4f22 2020 2020 2020 207c 0a20 2020  NDO"       |.   
+0000acc0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000acd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ace0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c41  -----.        |A
+0000acf0: 7368 6920 4761 7261 6d69 2020 7c22 5369  shi Garami  |"Si
+0000ad00: 6e67 6c65 204c 6567 2058 2220 207c 0a20  ngle Leg X"  |. 
+0000ad10: 2020 2020 2020 207c 5361 6e6b 616b 7520         |Sankaku 
+0000ad20: 2020 2020 207c 2254 7269 616e 676c 6522       |"Triangle"
+0000ad30: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000ad40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ad50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000ad60: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0000ad70: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0000ad80: 2066 756e 635f 6361 6c6c 203d 205f 4578   func_call = _Ex
+0000ad90: 706c 6f64 6546 756e 6374 696f 6e43 616c  plodeFunctionCal
+0000ada0: 6c28 636f 6c29 0a20 2020 2066 756e 635f  l(col).    func_
+0000adb0: 6361 6c6c 2e5f 7365 745f 6170 695f 6361  call._set_api_ca
+0000adc0: 6c6c 5f73 6f75 7263 6528 2266 756e 6374  ll_source("funct
+0000add0: 696f 6e73 2e65 7870 6c6f 6465 2229 0a20  ions.explode"). 
+0000ade0: 2020 2072 6574 7572 6e20 6675 6e63 5f63     return func_c
+0000adf0: 616c 6c0a 0a0a 6465 6620 6772 6f75 7069  all...def groupi
+0000ae00: 6e67 282a 636f 6c73 3a20 436f 6c75 6d6e  ng(*cols: Column
+0000ae10: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+0000ae20: 6e3a 0a20 2020 2022 2222 0a20 2020 2044  n:.    """.    D
+0000ae30: 6573 6372 6962 6573 2077 6869 6368 206f  escribes which o
+0000ae40: 6620 6120 6c69 7374 206f 6620 6578 7072  f a list of expr
+0000ae50: 6573 7369 6f6e 7320 6172 6520 6772 6f75  essions are grou
+0000ae60: 7065 6420 696e 2061 2072 6f77 2070 726f  ped in a row pro
+0000ae70: 6475 6365 6420 6279 2061 2047 524f 5550  duced by a GROUP
+0000ae80: 2042 5920 7175 6572 792e 0a0a 2020 2020   BY query...    
+0000ae90: 3a66 756e 633a 6067 726f 7570 696e 675f  :func:`grouping_
+0000aea0: 6964 6020 6973 2061 6e20 616c 6961 7320  id` is an alias 
+0000aeb0: 6f66 203a 6675 6e63 3a60 6772 6f75 7069  of :func:`groupi
+0000aec0: 6e67 602e 0a0a 2020 2020 4578 616d 706c  ng`...    Exampl
+0000aed0: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0000aee0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000aef0: 6e6f 7770 6172 6b20 696d 706f 7274 2047  nowpark import G
+0000af00: 726f 7570 696e 6753 6574 730a 2020 2020  roupingSets.    
+0000af10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000af20: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0000af30: 6672 616d 6528 5b5b 312c 2032 2c20 335d  frame([[1, 2, 3]
+0000af40: 2c20 5b34 2c20 352c 2036 5d5d 2c73 6368  , [4, 5, 6]],sch
+0000af50: 656d 613d 5b22 6122 2c20 2262 222c 2022  ema=["a", "b", "
+0000af60: 6322 5d29 0a20 2020 2020 2020 203e 3e3e  c"]).        >>>
+0000af70: 2067 726f 7570 696e 675f 7365 7473 203d   grouping_sets =
+0000af80: 2047 726f 7570 696e 6753 6574 7328 5b63   GroupingSets([c
+0000af90: 6f6c 2822 6122 295d 2c20 5b63 6f6c 2822  ol("a")], [col("
+0000afa0: 6222 295d 2c20 5b63 6f6c 2822 6122 292c  b")], [col("a"),
+0000afb0: 2063 6f6c 2822 6222 295d 290a 2020 2020   col("b")]).    
+0000afc0: 2020 2020 3e3e 3e20 6466 2e67 726f 7570      >>> df.group
+0000afd0: 5f62 795f 6772 6f75 7069 6e67 5f73 6574  _by_grouping_set
+0000afe0: 7328 6772 6f75 7069 6e67 5f73 6574 7329  s(grouping_sets)
+0000aff0: 2e61 6767 285b 636f 756e 7428 2263 2229  .agg([count("c")
+0000b000: 2c20 6772 6f75 7069 6e67 2822 6122 292c  , grouping("a"),
+0000b010: 2067 726f 7570 696e 6728 2262 2229 2c20   grouping("b"), 
+0000b020: 6772 6f75 7069 6e67 2822 6122 2c20 2262  grouping("a", "b
+0000b030: 2229 5d29 2e63 6f6c 6c65 6374 2829 0a20  ")]).collect(). 
+0000b040: 2020 2020 2020 205b 526f 7728 413d 312c         [Row(A=1,
+0000b050: 2042 3d32 2c20 434f 554e 5428 4329 3d31   B=2, COUNT(C)=1
+0000b060: 2c20 4752 4f55 5049 4e47 2841 293d 302c  , GROUPING(A)=0,
+0000b070: 2047 524f 5550 494e 4728 4229 3d30 2c20   GROUPING(B)=0, 
+0000b080: 4752 4f55 5049 4e47 2841 2c20 4229 3d30  GROUPING(A, B)=0
+0000b090: 292c 205c 0a52 6f77 2841 3d34 2c20 423d  ), \.Row(A=4, B=
+0000b0a0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
+0000b0b0: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b0c0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000b0d0: 5550 494e 4728 412c 2042 293d 3029 2c20  UPING(A, B)=0), 
+0000b0e0: 5c0a 526f 7728 413d 312c 2042 3d4e 6f6e  \.Row(A=1, B=Non
+0000b0f0: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
+0000b100: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b110: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
+0000b120: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
+0000b130: 5c0a 526f 7728 413d 342c 2042 3d4e 6f6e  \.Row(A=4, B=Non
+0000b140: 652c 2043 4f55 4e54 2843 293d 312c 2047  e, COUNT(C)=1, G
+0000b150: 524f 5550 494e 4728 4129 3d30 2c20 4752  ROUPING(A)=0, GR
+0000b160: 4f55 5049 4e47 2842 293d 312c 2047 524f  OUPING(B)=1, GRO
+0000b170: 5550 494e 4728 412c 2042 293d 3129 2c20  UPING(A, B)=1), 
+0000b180: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
+0000b190: 322c 2043 4f55 4e54 2843 293d 312c 2047  2, COUNT(C)=1, G
+0000b1a0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
+0000b1b0: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000b1c0: 5550 494e 4728 412c 2042 293d 3229 2c20  UPING(A, B)=2), 
+0000b1d0: 5c0a 526f 7728 413d 4e6f 6e65 2c20 423d  \.Row(A=None, B=
+0000b1e0: 352c 2043 4f55 4e54 2843 293d 312c 2047  5, COUNT(C)=1, G
+0000b1f0: 524f 5550 494e 4728 4129 3d31 2c20 4752  ROUPING(A)=1, GR
+0000b200: 4f55 5049 4e47 2842 293d 302c 2047 524f  OUPING(B)=0, GRO
+0000b210: 5550 494e 4728 412c 2042 293d 3229 5d0a  UPING(A, B)=2)].
+0000b220: 2020 2020 2222 220a 2020 2020 636f 6c75      """.    colu
+0000b230: 6d6e 7320 3d20 5b5f 746f 5f63 6f6c 5f69  mns = [_to_col_i
+0000b240: 665f 7374 7228 632c 2022 6772 6f75 7069  f_str(c, "groupi
+0000b250: 6e67 2229 2066 6f72 2063 2069 6e20 636f  ng") for c in co
+0000b260: 6c73 5d0a 2020 2020 7265 7475 726e 2062  ls].    return b
+0000b270: 7569 6c74 696e 2822 6772 6f75 7069 6e67  uiltin("grouping
+0000b280: 2229 282a 636f 6c75 6d6e 7329 0a0a 0a67  ")(*columns)...g
+0000b290: 726f 7570 696e 675f 6964 203d 2067 726f  rouping_id = gro
+0000b2a0: 7570 696e 670a 0a0a 6465 6620 636f 616c  uping...def coal
+0000b2b0: 6573 6365 282a 653a 2043 6f6c 756d 6e4f  esce(*e: ColumnO
+0000b2c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000b2d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0000b2e0: 2074 6865 2066 6972 7374 206e 6f6e 2d4e   the first non-N
+0000b2f0: 554c 4c20 6578 7072 6573 7369 6f6e 2061  ULL expression a
+0000b300: 6d6f 6e67 2069 7473 2061 7267 756d 656e  mong its argumen
+0000b310: 7473 2c20 6f72 204e 554c 4c20 6966 2061  ts, or NULL if a
+0000b320: 6c6c 2069 7473 0a20 2020 2061 7267 756d  ll its.    argum
+0000b330: 656e 7473 2061 7265 204e 554c 4c2e 0a0a  ents are NULL...
+0000b340: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0000b350: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000b360: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0000b370: 6174 6166 7261 6d65 285b 5b31 2c20 322c  ataframe([[1, 2,
+0000b380: 2033 5d2c 205b 4e6f 6e65 2c20 322c 2033   3], [None, 2, 3
+0000b390: 5d2c 205b 4e6f 6e65 2c20 4e6f 6e65 2c20  ], [None, None, 
+0000b3a0: 335d 2c20 5b4e 6f6e 652c 204e 6f6e 652c  3], [None, None,
+0000b3b0: 204e 6f6e 655d 5d2c 2073 6368 656d 613d   None]], schema=
+0000b3c0: 5b27 6127 2c20 2762 272c 2027 6327 5d29  ['a', 'b', 'c'])
+0000b3d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000b3e0: 7365 6c65 6374 2864 662e 612c 2064 662e  select(df.a, df.
+0000b3f0: 622c 2064 662e 632c 2063 6f61 6c65 7363  b, df.c, coalesc
+0000b400: 6528 6466 2e61 2c20 6466 2e62 2c20 6466  e(df.a, df.b, df
+0000b410: 2e63 292e 6173 5f28 2243 4f41 4c45 5343  .c).as_("COALESC
+0000b420: 4522 2929 2e73 686f 7728 290a 2020 2020  E")).show().    
+0000b430: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000b440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b450: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000b460: 7c22 4122 2020 207c 2242 2220 2020 7c22  |"A"   |"B"   |"
+0000b470: 4322 2020 207c 2243 4f41 4c45 5343 4522  C"   |"COALESCE"
+0000b480: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000b490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b4a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0000b4b0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
+0000b4c0: 3220 2020 2020 7c33 2020 2020 207c 3120  2     |3     |1 
+0000b4d0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0000b4e0: 2020 2020 7c4e 554c 4c20 207c 3220 2020      |NULL  |2   
+0000b4f0: 2020 7c33 2020 2020 207c 3220 2020 2020    |3     |2     
+0000b500: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0000b510: 7c4e 554c 4c20 207c 4e55 4c4c 2020 7c33  |NULL  |NULL  |3
+0000b520: 2020 2020 207c 3320 2020 2020 2020 2020       |3         
+0000b530: 2020 7c0a 2020 2020 2020 2020 7c4e 554c    |.        |NUL
+0000b540: 4c20 207c 4e55 4c4c 2020 7c4e 554c 4c20  L  |NULL  |NULL 
+0000b550: 207c 4e55 4c4c 2020 2020 2020 2020 7c0a   |NULL        |.
+0000b560: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000b570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000b590: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0000b5a0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000b5b0: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
+0000b5c0: 6578 2c20 2263 6f61 6c65 7363 6522 2920  ex, "coalesce") 
+0000b5d0: 666f 7220 6578 2069 6e20 655d 0a20 2020  for ex in e].   
+0000b5e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0000b5f0: 2263 6f61 6c65 7363 6522 2928 2a63 290a  "coalesce")(*c).
+0000b600: 0a0a 6465 6620 6571 7561 6c5f 6e61 6e28  ..def equal_nan(
+0000b610: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0000b620: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000b630: 2222 220a 2020 2020 5265 7475 726e 2074  """.    Return t
+0000b640: 7275 6520 6966 2074 6865 2076 616c 7565  rue if the value
+0000b650: 2069 6e20 7468 6520 636f 6c75 6d6e 2069   in the column i
+0000b660: 7320 6e6f 7420 6120 6e75 6d62 6572 2028  s not a number (
+0000b670: 4e61 4e29 2e0a 0a20 2020 2045 7861 6d70  NaN)...    Examp
+0000b680: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0000b690: 3e20 696d 706f 7274 206d 6174 680a 2020  > import math.  
+0000b6a0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000b6b0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000b6c0: 7461 6672 616d 6528 5b31 2e31 2c20 6d61  taframe([1.1, ma
+0000b6d0: 7468 2e6e 616e 2c20 322e 335d 2c20 7363  th.nan, 2.3], sc
+0000b6e0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0000b6f0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0000b700: 7428 6571 7561 6c5f 6e61 6e28 6466 5b22  t(equal_nan(df["
+0000b710: 6122 5d29 2e61 6c69 6173 2822 6571 7561  a"]).alias("equa
+0000b720: 6c5f 6e61 6e22 2929 2e63 6f6c 6c65 6374  l_nan")).collect
+0000b730: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0000b740: 4551 5541 4c5f 4e41 4e3d 4661 6c73 6529  EQUAL_NAN=False)
+0000b750: 2c20 526f 7728 4551 5541 4c5f 4e41 4e3d  , Row(EQUAL_NAN=
+0000b760: 5472 7565 292c 2052 6f77 2845 5155 414c  True), Row(EQUAL
+0000b770: 5f4e 414e 3d46 616c 7365 295d 0a20 2020  _NAN=False)].   
+0000b780: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0000b790: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+0000b7a0: 6571 7561 6c5f 6e61 6e22 290a 2020 2020  equal_nan").    
+0000b7b0: 7265 7475 726e 2063 2e65 7175 616c 5f6e  return c.equal_n
+0000b7c0: 616e 2829 0a0a 0a64 6566 2069 735f 6e75  an()...def is_nu
+0000b7d0: 6c6c 2865 3a20 436f 6c75 6d6e 4f72 4e61  ll(e: ColumnOrNa
+0000b7e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000b7f0: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+0000b800: 6e20 7472 7565 2069 6620 7468 6520 7661  n true if the va
+0000b810: 6c75 6520 696e 2074 6865 2063 6f6c 756d  lue in the colum
+0000b820: 6e20 6973 206e 756c 6c2e 0a0a 2020 2020  n is null...    
+0000b830: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000b840: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0000b850: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0000b860: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0000b870: 6973 5f6e 756c 6c0a 2020 2020 2020 2020  is_null.        
+0000b880: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0000b890: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0000b8a0: 6528 5b31 2e32 2c20 666c 6f61 7428 226e  e([1.2, float("n
+0000b8b0: 616e 2229 2c20 4e6f 6e65 2c20 312e 305d  an"), None, 1.0]
+0000b8c0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0000b8d0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000b8e0: 656c 6563 7428 6973 5f6e 756c 6c28 2261  elect(is_null("a
+0000b8f0: 2229 2e61 735f 2822 6122 2929 2e63 6f6c  ").as_("a")).col
+0000b900: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0000b910: 526f 7728 413d 4661 6c73 6529 2c20 526f  Row(A=False), Ro
+0000b920: 7728 413d 4661 6c73 6529 2c20 526f 7728  w(A=False), Row(
+0000b930: 413d 5472 7565 292c 2052 6f77 2841 3d46  A=True), Row(A=F
+0000b940: 616c 7365 295d 0a20 2020 2022 2222 0a20  alse)].    """. 
+0000b950: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000b960: 665f 7374 7228 652c 2022 6973 5f6e 756c  f_str(e, "is_nul
+0000b970: 6c22 290a 2020 2020 7265 7475 726e 2063  l").    return c
+0000b980: 2e69 735f 6e75 6c6c 2829 0a0a 0a64 6566  .is_null()...def
+0000b990: 206e 6567 6174 6528 653a 2043 6f6c 756d   negate(e: Colum
+0000b9a0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0000b9b0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0000b9c0: 6e73 2074 6865 206e 6567 6174 696f 6e20  ns the negation 
+0000b9d0: 6f66 2074 6865 2076 616c 7565 2069 6e20  of the value in 
+0000b9e0: 7468 6520 636f 6c75 6d6e 2028 6571 7569  the column (equi
+0000b9f0: 7661 6c65 6e74 2074 6f20 6120 756e 6172  valent to a unar
+0000ba00: 7920 6d69 6e75 7329 2e0a 0a20 2020 2045  y minus)...    E
+0000ba10: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0000ba20: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000ba30: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000ba40: 616d 6528 5b5b 315d 5d2c 2073 6368 656d  ame([[1]], schem
+0000ba50: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+0000ba60: 203e 3e3e 2064 662e 7365 6c65 6374 286e   >>> df.select(n
+0000ba70: 6567 6174 6528 636f 6c28 2261 2229 2e61  egate(col("a").a
+0000ba80: 6c69 6173 2822 7265 7375 6c74 2229 2929  lias("result")))
+0000ba90: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0000baa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0000bab0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0000bac0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000bad0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0000bae0: 2d31 2020 2020 2020 2020 7c0a 2020 2020  -1        |.    
+0000baf0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0000bb00: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0000bb10: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
+0000bb20: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000bb30: 5f73 7472 2865 2c20 226e 6567 6174 6522  _str(e, "negate"
+0000bb40: 290a 2020 2020 7265 7475 726e 202d 630a  ).    return -c.
+0000bb50: 0a0a 6465 6620 6e6f 745f 2865 3a20 436f  ..def not_(e: Co
+0000bb60: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000bb70: 6f6c 756d 6e3a 0a20 2020 2022 2222 5265  olumn:.    """Re
+0000bb80: 7475 726e 7320 7468 6520 696e 7665 7273  turns the invers
+0000bb90: 6520 6f66 2061 2062 6f6f 6c65 616e 2065  e of a boolean e
+0000bba0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
+0000bbb0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000bbc0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0000bbd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0000bbe0: 7261 6d65 285b 5b54 7275 655d 5d2c 2073  rame([[True]], s
+0000bbf0: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0000bc00: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0000bc10: 6374 286e 6f74 5f28 636f 6c28 2261 2229  ct(not_(col("a")
+0000bc20: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0000bc30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0000bc40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000bc50: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0000bc60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000bc70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000bc80: 207c 4661 6c73 6520 2020 2020 7c0a 2020   |False     |.  
+0000bc90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000bca0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0000bcb0: 4b4c 494e 453e 0a20 2020 2022 2222 0a0a  KLINE>.    """..
+0000bcc0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0000bcd0: 6966 5f73 7472 2865 2c20 226e 6f74 5f22  if_str(e, "not_"
+0000bce0: 290a 2020 2020 7265 7475 726e 207e 630a  ).    return ~c.
+0000bcf0: 0a0a 6465 6620 7261 6e64 6f6d 2873 6565  ..def random(see
+0000bd00: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
+0000bd10: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
+0000bd20: 6d6e 3a0a 2020 2020 2222 2245 6163 6820  mn:.    """Each 
+0000bd30: 6361 6c6c 2072 6574 7572 6e73 2061 2070  call returns a p
+0000bd40: 7365 7564 6f2d 7261 6e64 6f6d 2036 342d  seudo-random 64-
+0000bd50: 6269 7420 696e 7465 6765 722e 0a0a 2020  bit integer...  
+0000bd60: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000bd70: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000bd80: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+0000bd90: 2031 2229 0a20 2020 2020 2020 203e 3e3e   1").        >>>
+0000bda0: 2064 6620 3d20 6466 2e73 656c 6563 7428   df = df.select(
+0000bdb0: 7261 6e64 6f6d 2831 3233 292e 616c 6961  random(123).alia
+0000bdc0: 7328 2272 6573 756c 7422 2929 0a20 2020  s("result")).   
+0000bdd0: 2022 2222 0a20 2020 2073 203d 2073 6565   """.    s = see
+0000bde0: 6420 6966 2073 6565 6420 6973 206e 6f74  d if seed is not
+0000bdf0: 204e 6f6e 6520 656c 7365 2072 616e 6469   None else randi
+0000be00: 6e74 282d 2832 2a2a 3633 292c 2032 2a2a  nt(-(2**63), 2**
+0000be10: 3633 202d 2031 290a 2020 2020 7265 7475  63 - 1).    retu
+0000be20: 726e 2062 7569 6c74 696e 2822 7261 6e64  rn builtin("rand
+0000be30: 6f6d 2229 284c 6974 6572 616c 2873 2929  om")(Literal(s))
+0000be40: 0a0a 0a64 6566 2075 6e69 666f 726d 280a  ...def uniform(.
+0000be50: 2020 2020 6d69 6e5f 3a20 556e 696f 6e5b      min_: Union[
+0000be60: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+0000be70: 742c 2066 6c6f 6174 5d2c 0a20 2020 206d  t, float],.    m
+0000be80: 6178 5f3a 2055 6e69 6f6e 5b43 6f6c 756d  ax_: Union[Colum
+0000be90: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
+0000bea0: 6f61 745d 2c0a 2020 2020 6765 6e3a 2055  oat],.    gen: U
+0000beb0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+0000bec0: 652c 2069 6e74 2c20 666c 6f61 745d 2c0a  e, int, float],.
+0000bed0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0000bee0: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+0000bef0: 2061 2075 6e69 666f 726d 6c79 2072 616e   a uniformly ran
+0000bf00: 646f 6d20 6e75 6d62 6572 2e0a 0a20 2020  dom number...   
+0000bf10: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000bf20: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0000bf30: 7465 7469 6d65 0a20 2020 2020 2020 203e  tetime.        >
+0000bf40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0000bf50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+0000bf60: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+0000bf70: 2020 5b5b 315d 5d2c 0a20 2020 2020 2020    [[1]],.       
+0000bf80: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+0000bf90: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
+0000bfa0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+0000bfb0: 2064 662e 7365 6c65 6374 2875 6e69 666f   df.select(unifo
+0000bfc0: 726d 2831 2c20 3130 302c 2063 6f6c 2822  rm(1, 100, col("
+0000bfd0: 6122 2929 2e61 6c69 6173 2822 554e 4946  a")).alias("UNIF
+0000bfe0: 4f52 4d22 2929 2e63 6f6c 6c65 6374 2829  ORM")).collect()
+0000bff0: 0a20 2020 2020 2020 205b 526f 7728 554e  .        [Row(UN
+0000c000: 4946 4f52 4d3d 3632 295d 0a20 2020 2022  IFORM=62)].    "
+0000c010: 2222 0a0a 2020 2020 6465 6620 636f 6e76  ""..    def conv
+0000c020: 6572 745f 6c69 6d69 745f 746f 5f63 6f6c  ert_limit_to_col
+0000c030: 286c 696d 6974 293a 0a20 2020 2020 2020  (limit):.       
+0000c040: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+0000c050: 696d 6974 2c20 696e 7429 3a0a 2020 2020  imit, int):.    
+0000c060: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000c070: 6974 286c 696d 6974 290a 2020 2020 2020  it(limit).      
+0000c080: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0000c090: 6528 6c69 6d69 742c 2066 6c6f 6174 293a  e(limit, float):
+0000c0a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000c0b0: 7572 6e20 6c69 7428 6c69 6d69 7429 2e63  urn lit(limit).c
+0000c0c0: 6173 7428 466c 6f61 7454 7970 6528 2929  ast(FloatType())
+0000c0d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000c0e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286c  _to_col_if_str(l
+0000c0f0: 696d 6974 2c20 2275 6e69 666f 726d 2229  imit, "uniform")
+0000c100: 0a0a 2020 2020 6d69 6e5f 636f 6c20 3d20  ..    min_col = 
+0000c110: 636f 6e76 6572 745f 6c69 6d69 745f 746f  convert_limit_to
+0000c120: 5f63 6f6c 286d 696e 5f29 0a20 2020 206d  _col(min_).    m
+0000c130: 6178 5f63 6f6c 203d 2063 6f6e 7665 7274  ax_col = convert
+0000c140: 5f6c 696d 6974 5f74 6f5f 636f 6c28 6d61  _limit_to_col(ma
+0000c150: 785f 290a 2020 2020 6765 6e5f 636f 6c20  x_).    gen_col 
+0000c160: 3d20 280a 2020 2020 2020 2020 6c69 7428  = (.        lit(
+0000c170: 6765 6e29 2069 6620 6973 696e 7374 616e  gen) if isinstan
+0000c180: 6365 2867 656e 2c20 2869 6e74 2c20 666c  ce(gen, (int, fl
+0000c190: 6f61 7429 2920 656c 7365 205f 746f 5f63  oat)) else _to_c
+0000c1a0: 6f6c 5f69 665f 7374 7228 6765 6e2c 2022  ol_if_str(gen, "
+0000c1b0: 756e 6966 6f72 6d22 290a 2020 2020 290a  uniform").    ).
+0000c1c0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000c1d0: 696e 2822 756e 6966 6f72 6d22 2928 6d69  in("uniform")(mi
+0000c1e0: 6e5f 636f 6c2c 206d 6178 5f63 6f6c 2c20  n_col, max_col, 
+0000c1f0: 6765 6e5f 636f 6c29 0a0a 0a64 6566 2073  gen_col)...def s
+0000c200: 6571 3128 7369 676e 3a20 696e 7420 3d20  eq1(sign: int = 
+0000c210: 3029 202d 3e20 436f 6c75 6d6e 3a0a 2020  0) -> Column:.  
+0000c220: 2020 2222 2252 6574 7572 6e73 2061 2073    """Returns a s
+0000c230: 6571 7565 6e63 6520 6f66 206d 6f6e 6f74  equence of monot
+0000c240: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+0000c250: 696e 6720 696e 7465 6765 7273 2c20 7769  ing integers, wi
+0000c260: 7468 2077 7261 702d 6172 6f75 6e64 0a20  th wrap-around. 
+0000c270: 2020 2077 6869 6368 2068 6170 7065 6e73     which happens
+0000c280: 2061 6674 6572 206c 6172 6765 7374 2072   after largest r
+0000c290: 6570 7265 7365 6e74 6162 6c65 2069 6e74  epresentable int
+0000c2a0: 6567 6572 206f 6620 696e 7465 6765 7220  eger of integer 
+0000c2b0: 7769 6474 6820 3120 6279 7465 2e0a 0a20  width 1 byte... 
+0000c2c0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0000c2d0: 2073 6967 6e3a 2057 6865 6e20 302c 2074   sign: When 0, t
+0000c2e0: 6865 2073 6571 7565 6e63 6520 636f 6e74  he sequence cont
+0000c2f0: 696e 7565 7320 6174 2030 2061 6674 6572  inues at 0 after
+0000c300: 2077 7261 702d 6172 6f75 6e64 2e20 5768   wrap-around. Wh
+0000c310: 656e 2031 2c20 7468 6520 7365 7175 656e  en 1, the sequen
+0000c320: 6365 0a20 2020 2020 2020 2020 2020 2063  ce.            c
+0000c330: 6f6e 7469 6e75 6573 2061 7420 736d 616c  ontinues at smal
+0000c340: 6c65 7374 2072 6570 7265 7365 6e74 6162  lest representab
+0000c350: 6c65 2031 2062 7974 6520 696e 7465 6765  le 1 byte intege
+0000c360: 722e 2044 6566 6175 6c74 7320 746f 2030  r. Defaults to 0
+0000c370: 2e0a 0a20 2020 2053 6565 2041 6c73 6f3a  ...    See Also:
+0000c380: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
+0000c390: 3a60 5365 7373 696f 6e2e 6765 6e65 7261  :`Session.genera
+0000c3a0: 746f 7260 2c20 7768 6963 6820 6361 6e20  tor`, which can 
+0000c3b0: 6265 2075 7365 6420 746f 2067 656e 6572  be used to gener
+0000c3c0: 6174 6520 696e 2074 616e 6465 6d20 7769  ate in tandem wi
+0000c3d0: 7468 2060 7365 7131 6020 746f 0a20 2020  th `seq1` to.   
+0000c3e0: 2020 2020 2020 2020 2067 656e 6572 6174           generat
+0000c3f0: 6520 7365 7175 656e 6365 732e 0a0a 2020  e sequences...  
+0000c400: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000c410: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000c420: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
+0000c430: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
+0000c440: 3d33 290a 2020 2020 2020 2020 3e3e 3e20  =3).        >>> 
+0000c450: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+0000c460: 2020 2020 205b 526f 7728 5345 5131 2830       [Row(SEQ1(0
+0000c470: 293d 3029 2c20 526f 7728 5345 5131 2830  )=0), Row(SEQ1(0
+0000c480: 293d 3129 2c20 526f 7728 5345 5131 2830  )=1), Row(SEQ1(0
+0000c490: 293d 3229 5d0a 2020 2020 2222 220a 2020  )=2)].    """.  
+0000c4a0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000c4b0: 2822 7365 7131 2229 284c 6974 6572 616c  ("seq1")(Literal
+0000c4c0: 2873 6967 6e29 290a 0a0a 6465 6620 7365  (sign))...def se
+0000c4d0: 7132 2873 6967 6e3a 2069 6e74 203d 2030  q2(sign: int = 0
+0000c4e0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0000c4f0: 2022 2222 5265 7475 726e 7320 6120 7365   """Returns a se
+0000c500: 7175 656e 6365 206f 6620 6d6f 6e6f 746f  quence of monoto
+0000c510: 6e69 6361 6c6c 7920 696e 6372 6561 7369  nically increasi
+0000c520: 6e67 2069 6e74 6567 6572 732c 2077 6974  ng integers, wit
+0000c530: 6820 7772 6170 2d61 726f 756e 640a 2020  h wrap-around.  
+0000c540: 2020 7768 6963 6820 6861 7070 656e 7320    which happens 
+0000c550: 6166 7465 7220 6c61 7267 6573 7420 7265  after largest re
+0000c560: 7072 6573 656e 7461 626c 6520 696e 7465  presentable inte
+0000c570: 6765 7220 6f66 2069 6e74 6567 6572 2077  ger of integer w
+0000c580: 6964 7468 2032 2062 7974 652e 0a0a 2020  idth 2 byte...  
+0000c590: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0000c5a0: 7369 676e 3a20 5768 656e 2030 2c20 7468  sign: When 0, th
+0000c5b0: 6520 7365 7175 656e 6365 2063 6f6e 7469  e sequence conti
+0000c5c0: 6e75 6573 2061 7420 3020 6166 7465 7220  nues at 0 after 
+0000c5d0: 7772 6170 2d61 726f 756e 642e 2057 6865  wrap-around. Whe
+0000c5e0: 6e20 312c 2074 6865 2073 6571 7565 6e63  n 1, the sequenc
+0000c5f0: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
+0000c600: 6e74 696e 7565 7320 6174 2073 6d61 6c6c  ntinues at small
+0000c610: 6573 7420 7265 7072 6573 656e 7461 626c  est representabl
+0000c620: 6520 3220 6279 7465 2069 6e74 6567 6572  e 2 byte integer
+0000c630: 2e20 4465 6661 756c 7473 2074 6f20 302e  . Defaults to 0.
+0000c640: 0a0a 2020 2020 5365 6520 416c 736f 3a0a  ..    See Also:.
+0000c650: 2020 2020 2020 2020 2d20 3a6d 6574 683a          - :meth:
+0000c660: 6053 6573 7369 6f6e 2e67 656e 6572 6174  `Session.generat
+0000c670: 6f72 602c 2077 6869 6368 2063 616e 2062  or`, which can b
+0000c680: 6520 7573 6564 2074 6f20 6765 6e65 7261  e used to genera
+0000c690: 7465 2069 6e20 7461 6e64 656d 2077 6974  te in tandem wit
+0000c6a0: 6820 6073 6571 3260 2074 6f0a 2020 2020  h `seq2` to.    
+0000c6b0: 2020 2020 2020 2020 6765 6e65 7261 7465          generate
+0000c6c0: 2073 6571 7565 6e63 6573 2e0a 0a20 2020   sequences...   
+0000c6d0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0000c6e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0000c6f0: 696f 6e2e 6765 6e65 7261 746f 7228 7365  ion.generator(se
+0000c700: 7132 2830 292c 2072 6f77 636f 756e 743d  q2(0), rowcount=
+0000c710: 3329 0a20 2020 2020 2020 203e 3e3e 2064  3).        >>> d
+0000c720: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+0000c730: 2020 2020 5b52 6f77 2853 4551 3228 3029      [Row(SEQ2(0)
+0000c740: 3d30 292c 2052 6f77 2853 4551 3228 3029  =0), Row(SEQ2(0)
+0000c750: 3d31 292c 2052 6f77 2853 4551 3228 3029  =1), Row(SEQ2(0)
+0000c760: 3d32 295d 0a20 2020 2022 2222 0a20 2020  =2)].    """.   
+0000c770: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0000c780: 2273 6571 3222 2928 4c69 7465 7261 6c28  "seq2")(Literal(
+0000c790: 7369 676e 2929 0a0a 0a64 6566 2073 6571  sign))...def seq
+0000c7a0: 3428 7369 676e 3a20 696e 7420 3d20 3029  4(sign: int = 0)
+0000c7b0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000c7c0: 2222 2252 6574 7572 6e73 2061 2073 6571  """Returns a seq
+0000c7d0: 7565 6e63 6520 6f66 206d 6f6e 6f74 6f6e  uence of monoton
+0000c7e0: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
+0000c7f0: 6720 696e 7465 6765 7273 2c20 7769 7468  g integers, with
+0000c800: 2077 7261 702d 6172 6f75 6e64 0a20 2020   wrap-around.   
+0000c810: 2077 6869 6368 2068 6170 7065 6e73 2061   which happens a
+0000c820: 6674 6572 206c 6172 6765 7374 2072 6570  fter largest rep
+0000c830: 7265 7365 6e74 6162 6c65 2069 6e74 6567  resentable integ
+0000c840: 6572 206f 6620 696e 7465 6765 7220 7769  er of integer wi
+0000c850: 6474 6820 3420 6279 7465 2e0a 0a20 2020  dth 4 byte...   
+0000c860: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
+0000c870: 6967 6e3a 2057 6865 6e20 302c 2074 6865  ign: When 0, the
+0000c880: 2073 6571 7565 6e63 6520 636f 6e74 696e   sequence contin
+0000c890: 7565 7320 6174 2030 2061 6674 6572 2077  ues at 0 after w
+0000c8a0: 7261 702d 6172 6f75 6e64 2e20 5768 656e  rap-around. When
+0000c8b0: 2031 2c20 7468 6520 7365 7175 656e 6365   1, the sequence
+0000c8c0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0000c8d0: 7469 6e75 6573 2061 7420 736d 616c 6c65  tinues at smalle
+0000c8e0: 7374 2072 6570 7265 7365 6e74 6162 6c65  st representable
+0000c8f0: 2034 2062 7974 6520 696e 7465 6765 722e   4 byte integer.
+0000c900: 2044 6566 6175 6c74 7320 746f 2030 2e0a   Defaults to 0..
+0000c910: 0a20 2020 2053 6565 2041 6c73 6f3a 0a20  .    See Also:. 
+0000c920: 2020 2020 2020 202d 203a 6d65 7468 3a60         - :meth:`
+0000c930: 5365 7373 696f 6e2e 6765 6e65 7261 746f  Session.generato
+0000c940: 7260 2c20 7768 6963 6820 6361 6e20 6265  r`, which can be
+0000c950: 2075 7365 6420 746f 2067 656e 6572 6174   used to generat
+0000c960: 6520 696e 2074 616e 6465 6d20 7769 7468  e in tandem with
+0000c970: 2060 7365 7134 6020 746f 0a20 2020 2020   `seq4` to.     
+0000c980: 2020 2020 2020 2067 656e 6572 6174 6520         generate 
+0000c990: 7365 7175 656e 6365 732e 0a0a 2020 2020  sequences...    
+0000c9a0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0000c9b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000c9c0: 6f6e 2e67 656e 6572 6174 6f72 2873 6571  on.generator(seq
+0000c9d0: 3428 3029 2c20 726f 7763 6f75 6e74 3d33  4(0), rowcount=3
+0000c9e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0000c9f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0000ca00: 2020 205b 526f 7728 5345 5134 2830 293d     [Row(SEQ4(0)=
+0000ca10: 3029 2c20 526f 7728 5345 5134 2830 293d  0), Row(SEQ4(0)=
+0000ca20: 3129 2c20 526f 7728 5345 5134 2830 293d  1), Row(SEQ4(0)=
+0000ca30: 3229 5d0a 2020 2020 2222 220a 2020 2020  2)].    """.    
+0000ca40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000ca50: 7365 7134 2229 284c 6974 6572 616c 2873  seq4")(Literal(s
+0000ca60: 6967 6e29 290a 0a0a 6465 6620 7365 7138  ign))...def seq8
+0000ca70: 2873 6967 6e3a 2069 6e74 203d 2030 2920  (sign: int = 0) 
+0000ca80: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0000ca90: 2222 5265 7475 726e 7320 6120 7365 7175  ""Returns a sequ
+0000caa0: 656e 6365 206f 6620 6d6f 6e6f 746f 6e69  ence of monotoni
+0000cab0: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
+0000cac0: 2069 6e74 6567 6572 732c 2077 6974 6820   integers, with 
+0000cad0: 7772 6170 2d61 726f 756e 640a 2020 2020  wrap-around.    
+0000cae0: 7768 6963 6820 6861 7070 656e 7320 6166  which happens af
+0000caf0: 7465 7220 6c61 7267 6573 7420 7265 7072  ter largest repr
+0000cb00: 6573 656e 7461 626c 6520 696e 7465 6765  esentable intege
+0000cb10: 7220 6f66 2069 6e74 6567 6572 2077 6964  r of integer wid
+0000cb20: 7468 2038 2062 7974 652e 0a0a 2020 2020  th 8 byte...    
+0000cb30: 4172 6773 3a0a 2020 2020 2020 2020 7369  Args:.        si
+0000cb40: 676e 3a20 5768 656e 2030 2c20 7468 6520  gn: When 0, the 
+0000cb50: 7365 7175 656e 6365 2063 6f6e 7469 6e75  sequence continu
+0000cb60: 6573 2061 7420 3020 6166 7465 7220 7772  es at 0 after wr
+0000cb70: 6170 2d61 726f 756e 642e 2057 6865 6e20  ap-around. When 
+0000cb80: 312c 2074 6865 2073 6571 7565 6e63 650a  1, the sequence.
+0000cb90: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000cba0: 696e 7565 7320 6174 2073 6d61 6c6c 6573  inues at smalles
+0000cbb0: 7420 7265 7072 6573 656e 7461 626c 6520  t representable 
+0000cbc0: 3820 6279 7465 2069 6e74 6567 6572 2e20  8 byte integer. 
+0000cbd0: 4465 6661 756c 7473 2074 6f20 302e 0a0a  Defaults to 0...
+0000cbe0: 2020 2020 5365 6520 416c 736f 3a0a 2020      See Also:.  
+0000cbf0: 2020 2020 2020 2d20 3a6d 6574 683a 6053        - :meth:`S
+0000cc00: 6573 7369 6f6e 2e67 656e 6572 6174 6f72  ession.generator
+0000cc10: 602c 2077 6869 6368 2063 616e 2062 6520  `, which can be 
+0000cc20: 7573 6564 2074 6f20 6765 6e65 7261 7465  used to generate
+0000cc30: 2069 6e20 7461 6e64 656d 2077 6974 6820   in tandem with 
+0000cc40: 6073 6571 3860 2074 6f0a 2020 2020 2020  `seq8` to.      
+0000cc50: 2020 2020 2020 6765 6e65 7261 7465 2073        generate s
+0000cc60: 6571 7565 6e63 6573 2e0a 0a20 2020 2045  equences...    E
+0000cc70: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0000cc80: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000cc90: 6e2e 6765 6e65 7261 746f 7228 7365 7138  n.generator(seq8
+0000cca0: 2830 292c 2072 6f77 636f 756e 743d 3329  (0), rowcount=3)
+0000ccb0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000ccc0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0000ccd0: 2020 5b52 6f77 2853 4551 3828 3029 3d30    [Row(SEQ8(0)=0
+0000cce0: 292c 2052 6f77 2853 4551 3828 3029 3d31  ), Row(SEQ8(0)=1
+0000ccf0: 292c 2052 6f77 2853 4551 3828 3029 3d32  ), Row(SEQ8(0)=2
+0000cd00: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
+0000cd10: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
+0000cd20: 6571 3822 2928 4c69 7465 7261 6c28 7369  eq8")(Literal(si
+0000cd30: 676e 2929 0a0a 0a64 6566 2074 6f5f 6465  gn))...def to_de
+0000cd40: 6369 6d61 6c28 653a 2043 6f6c 756d 6e4f  cimal(e: ColumnO
+0000cd50: 724e 616d 652c 2070 7265 6369 7369 6f6e  rName, precision
+0000cd60: 3a20 696e 742c 2073 6361 6c65 3a20 696e  : int, scale: in
+0000cd70: 7429 202d 3e20 436f 6c75 6d6e 3a0a 2020  t) -> Column:.  
+0000cd80: 2020 2222 2243 6f6e 7665 7274 7320 616e    """Converts an
+0000cd90: 2069 6e70 7574 2065 7870 7265 7373 696f   input expressio
+0000cda0: 6e20 746f 2061 2064 6563 696d 616c 2e0a  n to a decimal..
+0000cdb0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000cdc0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000cdd0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0000cde0: 6174 6166 7261 6d65 285b 2731 3227 2c20  ataframe(['12', 
+0000cdf0: 2731 312e 3327 2c20 272d 3930 2e31 3233  '11.3', '-90.123
+0000ce00: 3435 275d 2c20 7363 6865 6d61 3d5b 2761  45'], schema=['a
+0000ce10: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+0000ce20: 6466 2e73 656c 6563 7428 746f 5f64 6563  df.select(to_dec
+0000ce30: 696d 616c 2863 6f6c 2827 6127 292c 2033  imal(col('a'), 3
+0000ce40: 382c 2030 292e 6173 5f28 2761 6e73 2729  8, 0).as_('ans')
+0000ce50: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0000ce60: 2020 2020 5b52 6f77 2841 4e53 3d31 3229      [Row(ANS=12)
+0000ce70: 2c20 526f 7728 414e 533d 3131 292c 2052  , Row(ANS=11), R
+0000ce80: 6f77 2841 4e53 3d2d 3930 295d 0a0a 2020  ow(ANS=-90)]..  
+0000ce90: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0000cea0: 6563 7428 746f 5f64 6563 696d 616c 2863  ect(to_decimal(c
+0000ceb0: 6f6c 2827 6127 292c 2033 382c 2032 292e  ol('a'), 38, 2).
+0000cec0: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
+0000ced0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0000cee0: 6f77 2841 4e53 3d44 6563 696d 616c 2827  ow(ANS=Decimal('
+0000cef0: 3132 2e30 3027 2929 2c20 526f 7728 414e  12.00')), Row(AN
+0000cf00: 533d 4465 6369 6d61 6c28 2731 312e 3330  S=Decimal('11.30
+0000cf10: 2729 292c 2052 6f77 2841 4e53 3d44 6563  ')), Row(ANS=Dec
+0000cf20: 696d 616c 2827 2d39 302e 3132 2729 295d  imal('-90.12'))]
+0000cf30: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000cf40: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000cf50: 652c 2022 746f 5f64 6563 696d 616c 2229  e, "to_decimal")
+0000cf60: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000cf70: 7469 6e28 2274 6f5f 6465 6369 6d61 6c22  tin("to_decimal"
+0000cf80: 2928 632c 206c 6974 2870 7265 6369 7369  )(c, lit(precisi
+0000cf90: 6f6e 292c 206c 6974 2873 6361 6c65 2929  on), lit(scale))
+0000cfa0: 0a0a 0a64 6566 2064 6976 3028 0a20 2020  ...def div0(.   
+0000cfb0: 2064 6976 6964 656e 643a 2055 6e69 6f6e   dividend: Union
+0000cfc0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+0000cfd0: 6e74 2c20 666c 6f61 745d 2c20 6469 7669  nt, float], divi
+0000cfe0: 736f 723a 2055 6e69 6f6e 5b43 6f6c 756d  sor: Union[Colum
+0000cff0: 6e4f 724e 616d 652c 2069 6e74 2c20 666c  nOrName, int, fl
+0000d000: 6f61 745d 0a29 202d 3e20 436f 6c75 6d6e  oat].) -> Column
+0000d010: 3a0a 2020 2020 2222 220a 2020 2020 5065  :.    """.    Pe
+0000d020: 7266 6f72 6d73 2064 6976 6973 696f 6e20  rforms division 
+0000d030: 6c69 6b65 2074 6865 2064 6976 6973 696f  like the divisio
+0000d040: 6e20 6f70 6572 6174 6f72 2028 2f29 2c0a  n operator (/),.
+0000d050: 2020 2020 6275 7420 7265 7475 726e 7320      but returns 
+0000d060: 3020 7768 656e 2074 6865 2064 6976 6973  0 when the divis
+0000d070: 6f72 2069 7320 3020 2872 6174 6865 7220  or is 0 (rather 
+0000d080: 7468 616e 2072 6570 6f72 7469 6e67 2061  than reporting a
+0000d090: 6e20 6572 726f 7229 2e0a 0a20 2020 2045  n error)...    E
+0000d0a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0000d0b0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000d0c0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000d0d0: 616d 6528 5b31 5d2c 2073 6368 656d 613d  ame([1], schema=
+0000d0e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+0000d0f0: 3e3e 2064 662e 7365 6c65 6374 2864 6976  >> df.select(div
+0000d100: 3028 6466 5b22 6122 5d2c 2031 292e 616c  0(df["a"], 1).al
+0000d110: 6961 7328 2264 6976 6964 6564 5f62 795f  ias("divided_by_
+0000d120: 6f6e 6522 292c 2064 6976 3028 6466 5b22  one"), div0(df["
+0000d130: 6122 5d2c 2030 292e 616c 6961 7328 2264  a"], 0).alias("d
+0000d140: 6976 6964 6564 5f62 795f 7a65 726f 2229  ivided_by_zero")
+0000d150: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0000d160: 2020 2020 5b52 6f77 2844 4956 4944 4544      [Row(DIVIDED
+0000d170: 5f42 595f 4f4e 453d 4465 6369 6d61 6c28  _BY_ONE=Decimal(
+0000d180: 2731 2e30 3030 3030 3027 292c 2044 4956  '1.000000'), DIV
+0000d190: 4944 4544 5f42 595f 5a45 524f 3d44 6563  IDED_BY_ZERO=Dec
+0000d1a0: 696d 616c 2827 302e 3030 3030 3030 2729  imal('0.000000')
+0000d1b0: 295d 0a20 2020 2022 2222 0a20 2020 2064  )].    """.    d
+0000d1c0: 6976 6964 656e 645f 636f 6c20 3d20 280a  ividend_col = (.
+0000d1d0: 2020 2020 2020 2020 6c69 7428 6469 7669          lit(divi
+0000d1e0: 6465 6e64 290a 2020 2020 2020 2020 6966  dend).        if
+0000d1f0: 2069 7369 6e73 7461 6e63 6528 6469 7669   isinstance(divi
+0000d200: 6465 6e64 2c20 2869 6e74 2c20 666c 6f61  dend, (int, floa
+0000d210: 7429 290a 2020 2020 2020 2020 656c 7365  t)).        else
+0000d220: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000d230: 6469 7669 6465 6e64 2c20 2264 6976 3022  dividend, "div0"
+0000d240: 290a 2020 2020 290a 2020 2020 6469 7669  ).    ).    divi
+0000d250: 736f 725f 636f 6c20 3d20 280a 2020 2020  sor_col = (.    
+0000d260: 2020 2020 6c69 7428 6469 7669 736f 7229      lit(divisor)
+0000d270: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0000d280: 7374 616e 6365 2864 6976 6973 6f72 2c20  stance(divisor, 
+0000d290: 2869 6e74 2c20 666c 6f61 7429 290a 2020  (int, float)).  
+0000d2a0: 2020 2020 2020 656c 7365 205f 746f 5f63        else _to_c
+0000d2b0: 6f6c 5f69 665f 7374 7228 6469 7669 736f  ol_if_str(diviso
+0000d2c0: 722c 2022 6469 7630 2229 0a20 2020 2029  r, "div0").    )
+0000d2d0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000d2e0: 7469 6e28 2264 6976 3022 2928 6469 7669  tin("div0")(divi
+0000d2f0: 6465 6e64 5f63 6f6c 2c20 6469 7669 736f  dend_col, diviso
+0000d300: 725f 636f 6c29 0a0a 0a64 6566 2073 7172  r_col)...def sqr
+0000d310: 7428 653a 2043 6f6c 756d 6e4f 724e 616d  t(e: ColumnOrNam
+0000d320: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0000d330: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+0000d340: 2073 7175 6172 652d 726f 6f74 206f 6620   square-root of 
+0000d350: 6120 6e6f 6e2d 6e65 6761 7469 7665 206e  a non-negative n
+0000d360: 756d 6572 6963 2065 7870 7265 7373 696f  umeric expressio
+0000d370: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+0000d380: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0000d390: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000d3a0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+0000d3b0: 2020 2020 202e 2e2e 2020 2020 205b 342c       ...     [4,
+0000d3c0: 2039 5d2c 0a20 2020 2020 2020 202e 2e2e   9],.        ...
+0000d3d0: 2020 2020 2073 6368 656d 613d 5b22 4e22       schema=["N"
+0000d3e0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+0000d3f0: 2e73 656c 6563 7428 7371 7274 2863 6f6c  .select(sqrt(col
+0000d400: 2822 4e22 2929 290a 2020 2020 2020 2020  ("N"))).        
+0000d410: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+0000d420: 0a20 2020 2020 2020 205b 526f 7728 5351  .        [Row(SQ
+0000d430: 5254 2822 4e22 293d 322e 3029 2c20 526f  RT("N")=2.0), Ro
+0000d440: 7728 5351 5254 2822 4e22 293d 332e 3029  w(SQRT("N")=3.0)
+0000d450: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+0000d460: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000d470: 2865 2c20 2273 7172 7422 290a 2020 2020  (e, "sqrt").    
+0000d480: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000d490: 7371 7274 2229 2863 290a 0a0a 6465 6620  sqrt")(c)...def 
+0000d4a0: 6162 7328 653a 2043 6f6c 756d 6e4f 724e  abs(e: ColumnOrN
+0000d4b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0000d4c0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+0000d4d0: 6865 2061 6273 6f6c 7574 6520 7661 6c75  he absolute valu
+0000d4e0: 6520 6f66 2061 206e 756d 6572 6963 2065  e of a numeric e
+0000d4f0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
+0000d500: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+0000d510: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000d520: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000d530: 616d 6528 5b5b 2d31 5d5d 2c20 7363 6865  ame([[-1]], sche
+0000d540: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0000d550: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0000d560: 6162 7328 636f 6c28 2261 2229 292e 616c  abs(col("a")).al
+0000d570: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+0000d580: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0000d590: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000d5a0: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+0000d5b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000d5c0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
+0000d5d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0000d5e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000d5f0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0000d600: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0000d610: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000d620: 7228 652c 2022 6162 7322 290a 2020 2020  r(e, "abs").    
+0000d630: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0000d640: 6162 7322 2928 6329 0a0a 0a64 6566 2061  abs")(c)...def a
+0000d650: 636f 7328 653a 2043 6f6c 756d 6e4f 724e  cos(e: ColumnOrN
+0000d660: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0000d670: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
+0000d680: 7468 6520 696e 7665 7273 6520 636f 7369  the inverse cosi
+0000d690: 6e65 2028 6172 6320 636f 7369 6e65 2920  ne (arc cosine) 
+0000d6a0: 6f66 2069 7473 2069 6e70 7574 3b0a 2020  of its input;.  
+0000d6b0: 2020 7468 6520 7265 7375 6c74 2069 7320    the result is 
+0000d6c0: 6120 6e75 6d62 6572 2069 6e20 7468 6520  a number in the 
+0000d6d0: 696e 7465 7276 616c 205b 2d70 692c 2070  interval [-pi, p
+0000d6e0: 695d 2e0a 0a20 2020 2045 7861 6d70 6c65  i]...    Example
+0000d6f0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+0000d700: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+0000d710: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+0000d720: 6f72 7420 4465 6369 6d61 6c54 7970 650a  ort DecimalType.
+0000d730: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000d740: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0000d750: 6461 7461 6672 616d 6528 5b5b 302e 355d  dataframe([[0.5]
+0000d760: 5d2c 2073 6368 656d 613d 5b22 6465 6722  ], schema=["deg"
+0000d770: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0000d780: 662e 7365 6c65 6374 2861 636f 7328 636f  f.select(acos(co
+0000d790: 6c28 2264 6567 2229 292e 6361 7374 2844  l("deg")).cast(D
+0000d7a0: 6563 696d 616c 5479 7065 2873 6361 6c65  ecimalType(scale
+0000d7b0: 3d33 2929 2e61 6c69 6173 2822 7265 7375  =3)).alias("resu
+0000d7c0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0000d7d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000d7e0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0000d7f0: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0000d800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000d810: 2020 2020 7c31 2e30 3437 2020 2020 207c      |1.047     |
+0000d820: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000d830: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0000d840: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0000d850: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0000d860: 6c5f 6966 5f73 7472 2865 2c20 2261 636f  l_if_str(e, "aco
+0000d870: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
+0000d880: 7569 6c74 696e 2822 6163 6f73 2229 2863  uiltin("acos")(c
+0000d890: 290a 0a0a 6465 6620 6173 696e 2865 3a20  )...def asin(e: 
+0000d8a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0000d8b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0000d8c0: 436f 6d70 7574 6573 2074 6865 2069 6e76  Computes the inv
+0000d8d0: 6572 7365 2073 696e 6520 2861 7263 2073  erse sine (arc s
+0000d8e0: 696e 6529 206f 6620 6974 7320 696e 7075  ine) of its inpu
+0000d8f0: 743b 0a20 2020 2074 6865 2072 6573 756c  t;.    the resul
+0000d900: 7420 6973 2061 206e 756d 6265 7220 696e  t is a number in
+0000d910: 2074 6865 2069 6e74 6572 7661 6c20 5b2d   the interval [-
+0000d920: 7069 2c20 7069 5d2e 0a0a 2020 2020 4578  pi, pi]...    Ex
+0000d930: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0000d940: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0000d950: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+0000d960: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
+0000d970: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+0000d980: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+0000d990: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+0000d9a0: 5b31 5d5d 2c20 7363 6865 6d61 3d5b 2264  [1]], schema=["d
+0000d9b0: 6567 225d 290a 2020 2020 2020 2020 3e3e  eg"]).        >>
+0000d9c0: 3e20 6466 2e73 656c 6563 7428 6173 696e  > df.select(asin
+0000d9d0: 2863 6f6c 2822 6465 6722 2929 2e63 6173  (col("deg")).cas
+0000d9e0: 7428 4465 6369 6d61 6c54 7970 6528 7363  t(DecimalType(sc
+0000d9f0: 616c 653d 3329 292e 616c 6961 7328 2272  ale=3)).alias("r
+0000da00: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0000da10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000da20: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0000da30: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0000da40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000da50: 2020 2020 2020 207c 312e 3537 3120 2020         |1.571   
+0000da60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000da70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000da80: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0000da90: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0000daa0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+0000dab0: 6173 696e 2229 0a20 2020 2072 6574 7572  asin").    retur
+0000dac0: 6e20 6275 696c 7469 6e28 2261 7369 6e22  n builtin("asin"
+0000dad0: 2928 6329 0a0a 0a64 6566 2061 7461 6e28  )(c)...def atan(
+0000dae0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
+0000daf0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0000db00: 2222 2243 6f6d 7075 7465 7320 7468 6520  """Computes the 
+0000db10: 696e 7665 7273 6520 7461 6e67 656e 7420  inverse tangent 
+0000db20: 2861 7263 2074 616e 6765 6e74 2920 6f66  (arc tangent) of
+0000db30: 2069 7473 2069 6e70 7574 3b0a 2020 2020   its input;.    
+0000db40: 7468 6520 7265 7375 6c74 2069 7320 6120  the result is a 
+0000db50: 6e75 6d62 6572 2069 6e20 7468 6520 696e  number in the in
+0000db60: 7465 7276 616c 205b 2d70 692c 2070 695d  terval [-pi, pi]
+0000db70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000db80: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0000db90: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0000dba0: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+0000dbb0: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
+0000dbc0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000dbd0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000dbe0: 7461 6672 616d 6528 5b5b 315d 5d2c 2073  taframe([[1]], s
+0000dbf0: 6368 656d 613d 5b22 6465 6722 5d29 0a20  chema=["deg"]). 
+0000dc00: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000dc10: 6c65 6374 2861 7461 6e28 636f 6c28 2264  lect(atan(col("d
+0000dc20: 6567 2229 292e 6361 7374 2844 6563 696d  eg")).cast(Decim
+0000dc30: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
+0000dc40: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+0000dc50: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0000dc60: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0000dc70: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0000dc80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0000dc90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000dca0: 7c30 2e37 3835 2020 2020 207c 0a20 2020  |0.785     |.   
+0000dcb0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000dcc0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0000dcd0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0000dce0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0000dcf0: 5f73 7472 2865 2c20 2261 7461 6e22 290a  _str(e, "atan").
+0000dd00: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0000dd10: 696e 2822 6174 616e 2229 2863 290a 0a0a  in("atan")(c)...
+0000dd20: 6465 6620 6174 616e 3228 793a 2043 6f6c  def atan2(y: Col
+0000dd30: 756d 6e4f 724e 616d 652c 2078 3a20 436f  umnOrName, x: Co
+0000dd40: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000dd50: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+0000dd60: 6d70 7574 6573 2074 6865 2069 6e76 6572  mputes the inver
+0000dd70: 7365 2074 616e 6765 6e74 2028 6172 6320  se tangent (arc 
+0000dd80: 7461 6e67 656e 7429 206f 6620 6974 7320  tangent) of its 
+0000dd90: 696e 7075 743b 0a20 2020 2074 6865 2072  input;.    the r
+0000dda0: 6573 756c 7420 6973 2061 206e 756d 6265  esult is a numbe
+0000ddb0: 7220 696e 2074 6865 2069 6e74 6572 7661  r in the interva
+0000ddc0: 6c20 5b2d 7069 2c20 7069 5d2e 0a0a 2020  l [-pi, pi]...  
+0000ddd0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+0000dde0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0000ddf0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0000de00: 7479 7065 7320 696d 706f 7274 2044 6563  types import Dec
+0000de10: 696d 616c 5479 7065 0a20 2020 2020 2020  imalType.       
+0000de20: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000de30: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0000de40: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
+0000de50: 656d 613d 5b22 7822 2c20 2279 225d 290a  ema=["x", "y"]).
+0000de60: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000de70: 656c 6563 7428 6174 616e 3228 6466 2e78  elect(atan2(df.x
+0000de80: 2c20 6466 2e79 292e 6361 7374 2844 6563  , df.y).cast(Dec
+0000de90: 696d 616c 5479 7065 2873 6361 6c65 3d33  imalType(scale=3
+0000dea0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+0000deb0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+0000dec0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0000ded0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+0000dee0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+0000def0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000df00: 2020 7c30 2e34 3634 2020 2020 207c 0a20    |0.464     |. 
+0000df10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000df20: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0000df30: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0000df40: 2020 2020 795f 636f 6c20 3d20 5f74 6f5f      y_col = _to_
+0000df50: 636f 6c5f 6966 5f73 7472 2879 2c20 2261  col_if_str(y, "a
+0000df60: 7461 6e32 2229 0a20 2020 2078 5f63 6f6c  tan2").    x_col
+0000df70: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0000df80: 7228 782c 2022 6174 616e 3222 290a 2020  r(x, "atan2").  
+0000df90: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0000dfa0: 2822 6174 616e 3222 2928 795f 636f 6c2c  ("atan2")(y_col,
+0000dfb0: 2078 5f63 6f6c 290a 0a0a 6465 6620 6365   x_col)...def ce
+0000dfc0: 696c 2865 3a20 436f 6c75 6d6e 4f72 4e61  il(e: ColumnOrNa
+0000dfd0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000dfe0: 2020 2022 2222 5265 7475 726e 7320 7661     """Returns va
+0000dff0: 6c75 6573 2066 726f 6d20 7468 6520 7370  lues from the sp
+0000e000: 6563 6966 6965 6420 636f 6c75 6d6e 2072  ecified column r
+0000e010: 6f75 6e64 6564 2074 6f20 7468 6520 6e65  ounded to the ne
+0000e020: 6172 6573 7420 6571 7561 6c20 6f72 206c  arest equal or l
+0000e030: 6172 6765 720a 2020 2020 696e 7465 6765  arger.    intege
+0000e040: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
+0000e050: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0000e060: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000e070: 7465 5f64 6174 6166 7261 6d65 285b 3133  te_dataframe([13
+0000e080: 352e 3133 352c 202d 3937 352e 3937 355d  5.135, -975.975]
+0000e090: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+0000e0a0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000e0b0: 656c 6563 7428 6365 696c 2864 665b 2261  elect(ceil(df["a
+0000e0c0: 225d 292e 616c 6961 7328 2263 6569 6c22  "]).alias("ceil"
+0000e0d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0000e0e0: 2020 2020 205b 526f 7728 4345 494c 3d31       [Row(CEIL=1
+0000e0f0: 3336 2e30 292c 2052 6f77 2843 4549 4c3d  36.0), Row(CEIL=
+0000e100: 2d39 3735 2e30 295d 0a20 2020 2022 2222  -975.0)].    """
+0000e110: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0000e120: 5f69 665f 7374 7228 652c 2022 6365 696c  _if_str(e, "ceil
+0000e130: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0000e140: 696c 7469 6e28 2263 6569 6c22 2928 6329  iltin("ceil")(c)
+0000e150: 0a0a 0a64 6566 2063 6f73 2865 3a20 436f  ...def cos(e: Co
+0000e160: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0000e170: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+0000e180: 6d70 7574 6573 2074 6865 2063 6f73 696e  mputes the cosin
+0000e190: 6520 6f66 2069 7473 2061 7267 756d 656e  e of its argumen
+0000e1a0: 743b 2074 6865 2061 7267 756d 656e 7420  t; the argument 
+0000e1b0: 7368 6f75 6c64 2062 6520 6578 7072 6573  should be expres
+0000e1c0: 7365 6420 696e 2072 6164 6961 6e73 2e0a  sed in radians..
+0000e1d0: 0a20 2020 2045 7861 6d70 6c65 3a0a 2020  .    Example:.  
+0000e1e0: 2020 2020 2020 3e3e 3e20 6672 6f6d 206d        >>> from m
+0000e1f0: 6174 6820 696d 706f 7274 2070 690a 2020  ath import pi.  
+0000e200: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000e210: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000e220: 7461 6672 616d 6528 5b5b 7069 5d5d 2c20  taframe([[pi]], 
+0000e230: 7363 6865 6d61 3d5b 2264 6567 225d 290a  schema=["deg"]).
+0000e240: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0000e250: 656c 6563 7428 636f 7328 636f 6c28 2264  elect(cos(col("d
+0000e260: 6567 2229 292e 616c 6961 7328 2272 6573  eg")).alias("res
+0000e270: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0000e280: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000e290: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0000e2a0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0000e2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0000e2c0: 2020 2020 207c 2d31 2e30 2020 2020 2020       |-1.0      
+0000e2d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000e2e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0000e2f0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0000e300: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0000e310: 6f6c 5f69 665f 7374 7228 652c 2022 636f  ol_if_str(e, "co
+0000e320: 7322 290a 2020 2020 7265 7475 726e 2062  s").    return b
+0000e330: 7569 6c74 696e 2822 636f 7322 2928 6329  uiltin("cos")(c)
+0000e340: 0a0a 0a64 6566 2063 6f73 6828 653a 2043  ...def cosh(e: C
+0000e350: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0000e360: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0000e370: 6f6d 7075 7465 7320 7468 6520 6879 7065  omputes the hype
+0000e380: 7262 6f6c 6963 2063 6f73 696e 6520 6f66  rbolic cosine of
+0000e390: 2069 7473 2061 7267 756d 656e 742e 0a0a   its argument...
+0000e3a0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
+0000e3b0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0000e3c0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0000e3d0: 2e74 7970 6573 2069 6d70 6f72 7420 4465  .types import De
+0000e3e0: 6369 6d61 6c54 7970 650a 2020 2020 2020  cimalType.      
+0000e3f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0000e400: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0000e410: 616d 6528 5b5b 305d 5d2c 2073 6368 656d  ame([[0]], schem
+0000e420: 613d 5b22 6465 6722 5d29 0a20 2020 2020  a=["deg"]).     
+0000e430: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0000e440: 2863 6f73 6828 636f 6c28 2264 6567 2229  (cosh(col("deg")
+0000e450: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0000e460: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0000e470: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0000e480: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0000e490: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0000e4a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000e4b0: 207c 312e 3020 2020 2020 2020 7c0a 2020   |1.0       |.  
+0000e4c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000e4d0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0000e4e0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0000e4f0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000e500: 665f 7374 7228 652c 2022 636f 7368 2229  f_str(e, "cosh")
+0000e510: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0000e520: 7469 6e28 2263 6f73 6822 2928 6329 0a0a  tin("cosh")(c)..
+0000e530: 0a64 6566 2065 7870 2865 3a20 436f 6c75  .def exp(e: Colu
+0000e540: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0000e550: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0000e560: 2043 6f6d 7075 7465 7320 4575 6c65 7227   Computes Euler'
+0000e570: 7320 6e75 6d62 6572 2065 2072 6169 7365  s number e raise
+0000e580: 6420 746f 2061 2066 6c6f 6174 696e 672d  d to a floating-
+0000e590: 706f 696e 7420 7661 6c75 652e 0a0a 2020  point value...  
+0000e5a0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0000e5b0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+0000e5c0: 6d61 7468 0a20 2020 2020 2020 203e 3e3e  math.        >>>
+0000e5d0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+0000e5e0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+0000e5f0: 6d70 6f72 7420 496e 7465 6765 7254 7970  mport IntegerTyp
+0000e600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0000e610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0000e620: 655f 6461 7461 6672 616d 6528 5b30 2e30  e_dataframe([0.0
+0000e630: 2c20 6d61 7468 2e6c 6f67 2831 3029 5d2c  , math.log(10)],
+0000e640: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0000e650: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0000e660: 6c65 6374 2865 7870 2864 665b 2261 225d  lect(exp(df["a"]
+0000e670: 292e 6361 7374 2849 6e74 6567 6572 5479  ).cast(IntegerTy
+0000e680: 7065 2829 292e 616c 6961 7328 2265 7870  pe()).alias("exp
+0000e690: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+0000e6a0: 2020 2020 2020 5b52 6f77 2845 5850 3d31        [Row(EXP=1
+0000e6b0: 292c 2052 6f77 2845 5850 3d31 3029 5d0a  ), Row(EXP=10)].
+0000e6c0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+0000e6d0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+0000e6e0: 2c20 2265 7870 2229 0a20 2020 2072 6574  , "exp").    ret
+0000e6f0: 7572 6e20 6275 696c 7469 6e28 2265 7870  urn builtin("exp
+0000e700: 2229 2863 290a 0a0a 6465 6620 6661 6374  ")(c)...def fact
+0000e710: 6f72 6961 6c28 653a 2043 6f6c 756d 6e4f  orial(e: ColumnO
+0000e720: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000e730: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
+0000e740: 6d70 7574 6573 2074 6865 2066 6163 746f  mputes the facto
+0000e750: 7269 616c 206f 6620 6974 7320 696e 7075  rial of its inpu
+0000e760: 742e 2054 6865 2069 6e70 7574 2061 7267  t. The input arg
+0000e770: 756d 656e 7420 6d75 7374 2062 6520 616e  ument must be an
+0000e780: 2069 6e74 6567 6572 0a20 2020 2065 7870   integer.    exp
+0000e790: 7265 7373 696f 6e20 696e 2074 6865 2072  ression in the r
+0000e7a0: 616e 6765 206f 6620 3020 746f 2033 332e  ange of 0 to 33.
+0000e7b0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0000e7c0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000e7d0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000e7e0: 5f64 6174 6166 7261 6d65 285b 302c 2031  _dataframe([0, 1
+0000e7f0: 2c20 352c 2031 305d 2c20 7363 6865 6d61  , 5, 10], schema
+0000e800: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+0000e810: 3e3e 3e20 6466 2e73 656c 6563 7428 6661  >>> df.select(fa
+0000e820: 6374 6f72 6961 6c28 6466 5b22 6122 5d29  ctorial(df["a"])
+0000e830: 2e61 6c69 6173 2822 6661 6374 6f72 6961  .alias("factoria
+0000e840: 6c22 2929 2e63 6f6c 6c65 6374 2829 0a20  l")).collect(). 
+0000e850: 2020 2020 2020 205b 526f 7728 4641 4354         [Row(FACT
+0000e860: 4f52 4941 4c3d 3129 2c20 526f 7728 4641  ORIAL=1), Row(FA
+0000e870: 4354 4f52 4941 4c3d 3129 2c20 526f 7728  CTORIAL=1), Row(
+0000e880: 4641 4354 4f52 4941 4c3d 3132 3029 2c20  FACTORIAL=120), 
+0000e890: 526f 7728 4641 4354 4f52 4941 4c3d 3336  Row(FACTORIAL=36
+0000e8a0: 3238 3830 3029 5d0a 2020 2020 2222 220a  28800)].    """.
+0000e8b0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0000e8c0: 6966 5f73 7472 2865 2c20 2266 6163 746f  if_str(e, "facto
+0000e8d0: 7269 616c 2229 0a20 2020 2072 6574 7572  rial").    retur
+0000e8e0: 6e20 6275 696c 7469 6e28 2266 6163 746f  n builtin("facto
+0000e8f0: 7269 616c 2229 2863 290a 0a0a 6465 6620  rial")(c)...def 
+0000e900: 666c 6f6f 7228 653a 2043 6f6c 756d 6e4f  floor(e: ColumnO
+0000e910: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0000e920: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0000e930: 7475 726e 7320 7661 6c75 6573 2066 726f  turns values fro
+0000e940: 6d20 7468 6520 7370 6563 6966 6965 6420  m the specified 
+0000e950: 636f 6c75 6d6e 2072 6f75 6e64 6564 2074  column rounded t
+0000e960: 6f20 7468 6520 6e65 6172 6573 7420 6571  o the nearest eq
+0000e970: 7561 6c20 6f72 0a20 2020 2073 6d61 6c6c  ual or.    small
+0000e980: 6572 2069 6e74 6567 6572 2e0a 0a20 2020  er integer...   
+0000e990: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+0000e9a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000e9b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0000e9c0: 6166 7261 6d65 285b 3133 352e 3133 352c  aframe([135.135,
+0000e9d0: 202d 3937 352e 3937 355d 2c20 7363 6865   -975.975], sche
+0000e9e0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0000e9f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0000ea00: 666c 6f6f 7228 6466 5b22 6122 5d29 2e61  floor(df["a"]).a
+0000ea10: 6c69 6173 2822 666c 6f6f 7222 2929 2e63  lias("floor")).c
+0000ea20: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0000ea30: 205b 526f 7728 464c 4f4f 523d 3133 352e   [Row(FLOOR=135.
+0000ea40: 3029 2c20 526f 7728 464c 4f4f 523d 2d39  0), Row(FLOOR=-9
+0000ea50: 3736 2e30 295d 0a20 2020 2022 2222 0a20  76.0)].    """. 
+0000ea60: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0000ea70: 665f 7374 7228 652c 2022 666c 6f6f 7222  f_str(e, "floor"
+0000ea80: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0000ea90: 6c74 696e 2822 666c 6f6f 7222 2928 6329  ltin("floor")(c)
+0000eaa0: 0a0a 0a64 6566 2066 6f72 6d61 745f 6e75  ...def format_nu
+0000eab0: 6d62 6572 2863 6f6c 3a20 436f 6c75 6d6e  mber(col: Column
+0000eac0: 4f72 4e61 6d65 2c20 643a 2055 6e69 6f6e  OrName, d: Union
+0000ead0: 5b43 6f6c 756d 6e2c 2069 6e74 5d29 3a0a  [Column, int]):.
+0000eae0: 2020 2020 2222 2246 6f72 6d61 7420 6e75      """Format nu
+0000eaf0: 6d62 6572 7320 746f 2061 2073 7065 6369  mbers to a speci
+0000eb00: 6669 6320 6e75 6d62 6572 206f 6620 6465  fic number of de
+0000eb10: 6369 6d61 6c20 706c 6163 6573 2077 6974  cimal places wit
+0000eb20: 6820 4841 4c46 5f54 4f5f 4556 454e 2072  h HALF_TO_EVEN r
+0000eb30: 6f75 6e64 696e 672e 0a0a 2020 2020 4e6f  ounding...    No
+0000eb40: 7465 3a0a 2020 2020 2020 2020 312e 2054  te:.        1. T
+0000eb50: 6865 2064 6174 6120 7479 7065 206f 6620  he data type of 
+0000eb60: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+0000eb70: 7573 7420 6265 206f 6e65 206f 6620 7468  ust be one of th
+0000eb80: 6520 6064 6174 6120 7479 7065 7320 666f  e `data types fo
+0000eb90: 7220 6120 6669 7865 642d 706f 696e 7420  r a fixed-point 
+0000eba0: 6e75 6d62 6572 0a20 2020 2020 2020 203c  number.        <
+0000ebb0: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+0000ebc0: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+0000ebd0: 6c2d 7265 6665 7265 6e63 652f 6461 7461  l-reference/data
+0000ebe0: 2d74 7970 6573 2d6e 756d 6572 6963 2e68  -types-numeric.h
+0000ebf0: 746d 6c23 6c61 6265 6c2d 6461 7461 2d74  tml#label-data-t
+0000ec00: 7970 6573 2d66 6f72 2d66 6978 6564 2d70  ypes-for-fixed-p
+0000ec10: 6f69 6e74 2d6e 756d 6265 7273 3e60 5f2e  oint-numbers>`_.
+0000ec20: 0a0a 2020 2020 2020 2020 322e 2044 6174  ..        2. Dat
+0000ec30: 6120 7479 7065 7320 666f 7220 666c 6f61  a types for floa
+0000ec40: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
+0000ec50: 7273 2028 652e 672e 2046 4c4f 4154 2920  rs (e.g. FLOAT) 
+0000ec60: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
+0000ec70: 6420 7769 7468 2074 6869 7320 6172 6775  d with this argu
+0000ec80: 6d65 6e74 2e0a 0a20 2020 2020 2020 2033  ment...        3
+0000ec90: 2e20 4966 2074 6865 2065 7870 7265 7373  . If the express
+0000eca0: 696f 6e20 6461 7461 2074 7970 6520 6973  ion data type is
+0000ecb0: 206e 6f74 2073 7570 706f 7274 6564 2c20   not supported, 
+0000ecc0: 7468 6520 6578 7072 6573 7369 6f6e 206d  the expression m
+0000ecd0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
+0000ece0: 7920 6361 7374 2074 6f20 6465 6369 6d61  y cast to decima
+0000ecf0: 6c20 6265 666f 7265 2063 616c 6c69 6e67  l before calling
+0000ed00: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0000ed10: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+0000ed20: 2069 6d70 6f72 7420 6465 6369 6d61 6c0a   import decimal.
+0000ed30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000ed40: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0000ed50: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+0000ed60: 7320 696d 706f 7274 2066 6f72 6d61 745f  s import format_
+0000ed70: 6e75 6d62 6572 0a20 2020 2020 2020 2020  number.         
+0000ed80: 2020 203e 3e3e 2064 6174 6120 3d20 5b28     >>> data = [(
+0000ed90: 312c 2064 6563 696d 616c 2e44 6563 696d  1, decimal.Decim
+0000eda0: 616c 2833 2e31 3431 3539 2929 2c20 2832  al(3.14159)), (2
+0000edb0: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
+0000edc0: 6c28 322e 3731 3832 3829 292c 2028 332c  l(2.71828)), (3,
+0000edd0: 2064 6563 696d 616c 2e44 6563 696d 616c   decimal.Decimal
+0000ede0: 2831 2e34 3134 3231 2929 5d0a 2020 2020  (1.41421))].    
+0000edf0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000ee00: 2073 6573 7369 6f6e 2e63 7265 6174 6544   session.createD
+0000ee10: 6174 6146 7261 6d65 2864 6174 612c 205b  ataFrame(data, [
+0000ee20: 2269 6422 2c20 2276 616c 7565 225d 290a  "id", "value"]).
+0000ee30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+0000ee40: 6466 2e73 656c 6563 7428 2269 6422 2c66  df.select("id",f
+0000ee50: 6f72 6d61 745f 6e75 6d62 6572 2822 7661  ormat_number("va
+0000ee60: 6c75 6522 2c32 292e 616c 6961 7328 2276  lue",2).alias("v
+0000ee70: 616c 7565 2229 292e 7368 6f77 2829 0a20  alue")).show(). 
+0000ee80: 2020 2020 2020 2020 2020 202d 2d2d 2d2d             -----
+0000ee90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0000eea0: 2020 2020 2020 2020 2020 7c22 4944 2220            |"ID" 
+0000eeb0: 207c 2256 414c 5545 2220 207c 0a20 2020   |"VALUE"  |.   
+0000eec0: 2020 2020 2020 2020 202d 2d2d 2d2d 2d2d           -------
+0000eed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0000eee0: 2020 2020 2020 2020 7c31 2020 2020 207c          |1     |
+0000eef0: 332e 3134 2020 2020 207c 0a20 2020 2020  3.14     |.     
+0000ef00: 2020 2020 2020 207c 3220 2020 2020 7c32         |2     |2
+0000ef10: 2e37 3220 2020 2020 7c0a 2020 2020 2020  .72     |.      
+0000ef20: 2020 2020 2020 7c33 2020 2020 207c 312e        |3     |1.
+0000ef30: 3431 2020 2020 207c 0a20 2020 2020 2020  41     |.       
+0000ef40: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000ef50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000ef60: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0000ef70: 2020 2020 2222 220a 2020 2020 636f 6c20      """.    col 
+0000ef80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000ef90: 2863 6f6c 2c20 2266 6f72 6d61 745f 6e75  (col, "format_nu
+0000efa0: 6d62 6572 2229 0a20 2020 2072 6574 7572  mber").    retur
+0000efb0: 6e20 6272 6f75 6e64 2863 6f6c 2c20 6429  n bround(col, d)
+0000efc0: 2e63 6173 7428 5374 7269 6e67 5479 7065  .cast(StringType
+0000efd0: 2829 290a 0a0a 6465 6620 7369 6e28 653a  ())...def sin(e:
+0000efe0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0000eff0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0000f000: 2243 6f6d 7075 7465 7320 7468 6520 7369  "Computes the si
+0000f010: 6e65 206f 6620 6974 7320 6172 6775 6d65  ne of its argume
+0000f020: 6e74 3b20 7468 6520 6172 6775 6d65 6e74  nt; the argument
+0000f030: 2073 686f 756c 6420 6265 2065 7870 7265   should be expre
+0000f040: 7373 6564 2069 6e20 7261 6469 616e 732e  ssed in radians.
+0000f050: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0000f060: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0000f070: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0000f080: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0000f090: 2044 6563 696d 616c 5479 7065 0a20 2020   DecimalType.   
+0000f0a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0000f0b0: 7373 696f 6e2e 6765 6e65 7261 746f 7228  ssion.generator(
+0000f0c0: 7365 7131 2830 292c 2072 6f77 636f 756e  seq1(0), rowcoun
+0000f0d0: 743d 3329 2e73 656c 6563 7428 7369 6e28  t=3).select(sin(
+0000f0e0: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
+0000f0f0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000f100: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
+0000f110: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+0000f120: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
+0000f130: 2853 494e 2853 4551 3128 3029 2920 4153  (SIN(SEQ1(0)) AS
+0000f140: 204e 554d 4245 5228 3338 2c20 3429 293d   NUMBER(38, 4))=
+0000f150: 4465 6369 6d61 6c28 2730 2e30 3030 3027  Decimal('0.0000'
+0000f160: 2929 2c20 526f 7728 4341 5354 2028 5349  )), Row(CAST (SI
+0000f170: 4e28 5345 5131 2830 2929 2041 5320 4e55  N(SEQ1(0)) AS NU
+0000f180: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+0000f190: 696d 616c 2827 302e 3834 3135 2729 292c  imal('0.8415')),
+0000f1a0: 2052 6f77 2843 4153 5420 2853 494e 2853   Row(CAST (SIN(S
+0000f1b0: 4551 3128 3029 2920 4153 204e 554d 4245  EQ1(0)) AS NUMBE
+0000f1c0: 5228 3338 2c20 3429 293d 4465 6369 6d61  R(38, 4))=Decima
+0000f1d0: 6c28 2730 2e39 3039 3327 2929 5d0a 2020  l('0.9093'))].  
+0000f1e0: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0000f1f0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0000f200: 2273 696e 2229 0a20 2020 2072 6574 7572  "sin").    retur
+0000f210: 6e20 6275 696c 7469 6e28 2273 696e 2229  n builtin("sin")
+0000f220: 2863 290a 0a0a 6465 6620 7369 6e68 2865  (c)...def sinh(e
+0000f230: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0000f240: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0000f250: 2222 436f 6d70 7574 6573 2074 6865 2068  ""Computes the h
+0000f260: 7970 6572 626f 6c69 6320 7369 6e65 206f  yperbolic sine o
+0000f270: 6620 6974 7320 6172 6775 6d65 6e74 2e0a  f its argument..
+0000f280: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0000f290: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0000f2a0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0000f2b0: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+0000f2c0: 4465 6369 6d61 6c54 7970 650a 2020 2020  DecimalType.    
+0000f2d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0000f2e0: 7369 6f6e 2e67 656e 6572 6174 6f72 2873  sion.generator(s
+0000f2f0: 6571 3128 3029 2c20 726f 7763 6f75 6e74  eq1(0), rowcount
+0000f300: 3d33 292e 7365 6c65 6374 2873 696e 6828  =3).select(sinh(
+0000f310: 7365 7131 2830 2929 2e63 6173 7428 4465  seq1(0)).cast(De
+0000f320: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000f330: 3429 2929 0a20 2020 2020 2020 203e 3e3e  4))).        >>>
+0000f340: 2064 662e 636f 6c6c 6563 7428 290a 2020   df.collect().  
+0000f350: 2020 2020 2020 5b52 6f77 2843 4153 5420        [Row(CAST 
+0000f360: 2853 494e 4828 5345 5131 2830 2929 2041  (SINH(SEQ1(0)) A
+0000f370: 5320 4e55 4d42 4552 2833 382c 2034 2929  S NUMBER(38, 4))
+0000f380: 3d44 6563 696d 616c 2827 302e 3030 3030  =Decimal('0.0000
+0000f390: 2729 292c 2052 6f77 2843 4153 5420 2853  ')), Row(CAST (S
+0000f3a0: 494e 4828 5345 5131 2830 2929 2041 5320  INH(SEQ1(0)) AS 
+0000f3b0: 4e55 4d42 4552 2833 382c 2034 2929 3d44  NUMBER(38, 4))=D
+0000f3c0: 6563 696d 616c 2827 312e 3137 3532 2729  ecimal('1.1752')
+0000f3d0: 292c 2052 6f77 2843 4153 5420 2853 494e  ), Row(CAST (SIN
+0000f3e0: 4828 5345 5131 2830 2929 2041 5320 4e55  H(SEQ1(0)) AS NU
+0000f3f0: 4d42 4552 2833 382c 2034 2929 3d44 6563  MBER(38, 4))=Dec
+0000f400: 696d 616c 2827 332e 3632 3639 2729 295d  imal('3.6269'))]
+0000f410: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0000f420: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0000f430: 652c 2022 7369 6e68 2229 0a20 2020 2072  e, "sinh").    r
+0000f440: 6574 7572 6e20 6275 696c 7469 6e28 2273  eturn builtin("s
+0000f450: 696e 6822 2928 6329 0a0a 0a64 6566 2074  inh")(c)...def t
+0000f460: 616e 2865 3a20 436f 6c75 6d6e 4f72 4e61  an(e: ColumnOrNa
+0000f470: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000f480: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
+0000f490: 6865 2074 616e 6765 6e74 206f 6620 6974  he tangent of it
+0000f4a0: 7320 6172 6775 6d65 6e74 3b20 7468 6520  s argument; the 
+0000f4b0: 6172 6775 6d65 6e74 2073 686f 756c 6420  argument should 
+0000f4c0: 6265 2065 7870 7265 7373 6564 2069 6e20  be expressed in 
+0000f4d0: 7261 6469 616e 732e 0a0a 2020 2020 4578  radians...    Ex
+0000f4e0: 616d 706c 653a 3a0a 2020 2020 2020 203e  ample::.       >
+0000f4f0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+0000f500: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+0000f510: 2069 6d70 6f72 7420 4465 6369 6d61 6c54   import DecimalT
+0000f520: 7970 650a 2020 2020 2020 203e 3e3e 2064  ype.       >>> d
+0000f530: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000f540: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
+0000f550: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
+0000f560: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
+0000f570: 2020 2e2e 2e20 2020 2020 7461 6e28 636f    ...     tan(co
+0000f580: 6c28 224e 2229 292e 6361 7374 2844 6563  l("N")).cast(Dec
+0000f590: 696d 616c 5479 7065 2873 6361 6c65 3d34  imalType(scale=4
+0000f5a0: 2929 0a20 2020 2020 2020 2e2e 2e20 290a  )).       ... ).
+0000f5b0: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
+0000f5c0: 6c6c 6563 7428 290a 2020 2020 2020 205b  llect().       [
+0000f5d0: 526f 7728 4341 5354 2028 5441 4e28 224e  Row(CAST (TAN("N
+0000f5e0: 2229 2041 5320 4e55 4d42 4552 2833 382c  ") AS NUMBER(38,
+0000f5f0: 2034 2929 3d44 6563 696d 616c 2827 302e   4))=Decimal('0.
+0000f600: 3030 3030 2729 292c 2052 6f77 2843 4153  0000')), Row(CAS
+0000f610: 5420 2854 414e 2822 4e22 2920 4153 204e  T (TAN("N") AS N
+0000f620: 554d 4245 5228 3338 2c20 3429 293d 4465  UMBER(38, 4))=De
+0000f630: 6369 6d61 6c28 2731 2e35 3537 3427 2929  cimal('1.5574'))
+0000f640: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+0000f650: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0000f660: 2865 2c20 2274 616e 2229 0a20 2020 2072  (e, "tan").    r
+0000f670: 6574 7572 6e20 6275 696c 7469 6e28 2274  eturn builtin("t
+0000f680: 616e 2229 2863 290a 0a0a 6465 6620 7461  an")(c)...def ta
+0000f690: 6e68 2865 3a20 436f 6c75 6d6e 4f72 4e61  nh(e: ColumnOrNa
+0000f6a0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000f6b0: 2020 2022 2222 436f 6d70 7574 6573 2074     """Computes t
+0000f6c0: 6865 2068 7970 6572 626f 6c69 6320 7461  he hyperbolic ta
+0000f6d0: 6e67 656e 7420 6f66 2069 7473 2061 7267  ngent of its arg
+0000f6e0: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
+0000f6f0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+0000f700: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+0000f710: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+0000f720: 696d 706f 7274 2044 6563 696d 616c 5479  import DecimalTy
+0000f730: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+0000f740: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000f750: 7465 5f64 6174 6166 7261 6d65 285b 302c  te_dataframe([0,
+0000f760: 2031 5d2c 2073 6368 656d 613d 5b22 4e22   1], schema=["N"
+0000f770: 5d29 2e73 656c 6563 7428 0a20 2020 2020  ]).select(.     
+0000f780: 2020 202e 2e2e 2020 2020 2074 616e 6828     ...     tanh(
+0000f790: 636f 6c28 224e 2229 2e63 6173 7428 4465  col("N").cast(De
+0000f7a0: 6369 6d61 6c54 7970 6528 7363 616c 653d  cimalType(scale=
+0000f7b0: 3429 2929 0a20 2020 2020 2020 202e 2e2e  4))).        ...
+0000f7c0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+0000f7d0: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+0000f7e0: 2020 2020 5b52 6f77 2854 414e 4828 2043      [Row(TANH( C
+0000f7f0: 4153 5420 2822 4e22 2041 5320 4e55 4d42  AST ("N" AS NUMB
+0000f800: 4552 2833 382c 2034 2929 293d 302e 3029  ER(38, 4)))=0.0)
+0000f810: 2c20 526f 7728 5441 4e48 2820 4341 5354  , Row(TANH( CAST
+0000f820: 2028 224e 2220 4153 204e 554d 4245 5228   ("N" AS NUMBER(
+0000f830: 3338 2c20 3429 2929 3d30 2e37 3631 3539  38, 4)))=0.76159
+0000f840: 3431 3535 3935 3537 3634 3929 5d0a 2020  41559557649)].  
+0000f850: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0000f860: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+0000f870: 2274 616e 6822 290a 2020 2020 7265 7475  "tanh").    retu
+0000f880: 726e 2062 7569 6c74 696e 2822 7461 6e68  rn builtin("tanh
+0000f890: 2229 2863 290a 0a0a 6465 6620 6465 6772  ")(c)...def degr
+0000f8a0: 6565 7328 653a 2043 6f6c 756d 6e4f 724e  ees(e: ColumnOrN
+0000f8b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0000f8c0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+0000f8d0: 6572 7473 2072 6164 6961 6e73 2074 6f20  erts radians to 
+0000f8e0: 6465 6772 6565 732e 0a0a 2020 2020 4578  degrees...    Ex
+0000f8f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0000f900: 203e 3e3e 2069 6d70 6f72 7420 6d61 7468   >>> import math
+0000f910: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0000f920: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0000f930: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+0000f940: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
+0000f950: 7275 6374 4669 656c 642c 2044 6f75 626c  ructField, Doubl
+0000f960: 6554 7970 652c 2049 6e74 6567 6572 5479  eType, IntegerTy
+0000f970: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+0000f980: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0000f990: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
+0000f9a0: 2020 2020 2020 2e2e 2e20 2020 2020 5b6d        ...     [m
+0000f9b0: 6174 682e 7069 202f 2033 2c20 6d61 7468  ath.pi / 3, math
+0000f9c0: 2e70 692c 2033 202a 206d 6174 682e 7069  .pi, 3 * math.pi
+0000f9d0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+0000f9e0: 2020 2073 6368 656d 613d 5374 7275 6374     schema=Struct
+0000f9f0: 5479 7065 285b 5374 7275 6374 4669 656c  Type([StructFiel
+0000fa00: 6428 2261 222c 2044 6f75 626c 6554 7970  d("a", DoubleTyp
+0000fa10: 6528 2929 5d29 2c0a 2020 2020 2020 2020  e())]),.        
+0000fa20: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+0000fa30: 3e20 6466 2e73 656c 6563 7428 6465 6772  > df.select(degr
+0000fa40: 6565 7328 636f 6c28 2261 2229 292e 6361  ees(col("a")).ca
+0000fa50: 7374 2849 6e74 6567 6572 5479 7065 2829  st(IntegerType()
+0000fa60: 292e 616c 6961 7328 2244 4547 5245 4553  ).alias("DEGREES
+0000fa70: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+0000fa80: 2020 2020 2020 5b52 6f77 2844 4547 5245        [Row(DEGRE
+0000fa90: 4553 3d36 3029 2c20 526f 7728 4445 4752  ES=60), Row(DEGR
+0000faa0: 4545 533d 3138 3029 2c20 526f 7728 4445  EES=180), Row(DE
+0000fab0: 4752 4545 533d 3534 3029 5d0a 2020 2020  GREES=540)].    
+0000fac0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0000fad0: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
+0000fae0: 6567 7265 6573 2229 0a20 2020 2072 6574  egrees").    ret
+0000faf0: 7572 6e20 6275 696c 7469 6e28 2264 6567  urn builtin("deg
+0000fb00: 7265 6573 2229 2863 290a 0a0a 6465 6620  rees")(c)...def 
+0000fb10: 7261 6469 616e 7328 653a 2043 6f6c 756d  radians(e: Colum
+0000fb20: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0000fb30: 6d6e 3a0a 2020 2020 2222 2243 6f6e 7665  mn:.    """Conve
+0000fb40: 7274 7320 6465 6772 6565 7320 746f 2072  rts degrees to r
+0000fb50: 6164 6961 6e73 2e0a 0a20 2020 2045 7861  adians...    Exa
+0000fb60: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
+0000fb70: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0000fb80: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0000fb90: 6d65 285b 5b31 2e31 3131 5d2c 205b 322e  me([[1.111], [2.
+0000fba0: 3232 325d 2c20 5b33 2e33 3333 5d5d 2c20  222], [3.333]], 
+0000fbb0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+0000fbc0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0000fbd0: 6563 7428 7261 6469 616e 7328 636f 6c28  ect(radians(col(
+0000fbe0: 2261 2229 292e 6361 7374 2822 6e75 6d62  "a")).cast("numb
+0000fbf0: 6572 2833 382c 2035 2922 292e 616c 6961  er(38, 5)").alia
+0000fc00: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+0000fc10: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0000fc20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000fc30: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+0000fc40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000fc50: 2d2d 0a20 2020 2020 2020 207c 302e 3031  --.        |0.01
+0000fc60: 3933 3920 2020 7c0a 2020 2020 2020 2020  939   |.        
+0000fc70: 7c30 2e30 3338 3738 2020 207c 0a20 2020  |0.03878   |.   
+0000fc80: 2020 2020 207c 302e 3035 3831 3720 2020       |0.05817   
+0000fc90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0000fca0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0000fcb0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0000fcc0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0000fcd0: 6f6c 5f69 665f 7374 7228 652c 2022 7261  ol_if_str(e, "ra
+0000fce0: 6469 616e 7322 290a 2020 2020 7265 7475  dians").    retu
+0000fcf0: 726e 2062 7569 6c74 696e 2822 7261 6469  rn builtin("radi
+0000fd00: 616e 7322 2928 6329 0a0a 0a64 6566 206d  ans")(c)...def m
+0000fd10: 6435 2865 3a20 436f 6c75 6d6e 4f72 4e61  d5(e: ColumnOrNa
+0000fd20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0000fd30: 2020 2022 2222 0a20 2020 2052 6574 7572     """.    Retur
+0000fd40: 6e73 2061 2033 322d 6368 6172 6163 7465  ns a 32-characte
+0000fd50: 7220 6865 782d 656e 636f 6465 6420 7374  r hex-encoded st
+0000fd60: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
+0000fd70: 7468 6520 3132 382d 6269 7420 4d44 3520  the 128-bit MD5 
+0000fd80: 6d65 7373 6167 6520 6469 6765 7374 2e0a  message digest..
+0000fd90: 0a20 2020 2020 4578 616d 706c 653a 3a0a  .     Example::.
+0000fda0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000fdb0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0000fdc0: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
+0000fdd0: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
+0000fde0: 636f 6c22 5d29 2e73 656c 6563 7428 6d64  col"]).select(md
+0000fdf0: 3528 2263 6f6c 2229 290a 2020 2020 2020  5("col")).      
+0000fe00: 2020 3e3e 3e20 6466 2e63 6f6c 6c65 6374    >>> df.collect
+0000fe10: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0000fe20: 4d44 3528 2243 4f4c 2229 3d27 3063 6331  MD5("COL")='0cc1
+0000fe30: 3735 6239 6330 6631 6236 6138 3331 6333  75b9c0f1b6a831c3
+0000fe40: 3939 6532 3639 3737 3236 3631 2729 2c20  99e269772661'), 
+0000fe50: 526f 7728 4d44 3528 2243 4f4c 2229 3d27  Row(MD5("COL")='
+0000fe60: 3932 6562 3566 6665 6536 6165 3266 6563  92eb5ffee6ae2fec
+0000fe70: 3361 6437 3163 3737 3735 3331 3537 3866  3ad71c777531578f
+0000fe80: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+0000fe90: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0000fea0: 7472 2865 2c20 226d 6435 2229 0a20 2020  tr(e, "md5").   
+0000feb0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0000fec0: 226d 6435 2229 2863 290a 0a0a 6465 6620  "md5")(c)...def 
+0000fed0: 7368 6131 2865 3a20 436f 6c75 6d6e 4f72  sha1(e: ColumnOr
+0000fee0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0000fef0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0000ff00: 6120 3430 2d63 6861 7261 6374 6572 2068  a 40-character h
+0000ff10: 6578 2d65 6e63 6f64 6564 2073 7472 696e  ex-encoded strin
+0000ff20: 6720 636f 6e74 6169 6e69 6e67 2074 6865  g containing the
+0000ff30: 2031 3630 2d62 6974 2053 4841 2d31 206d   160-bit SHA-1 m
+0000ff40: 6573 7361 6765 2064 6967 6573 742e 0a0a  essage digest...
+0000ff50: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0000ff60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0000ff70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0000ff80: 7461 6672 616d 6528 5b22 6122 2c20 2262  taframe(["a", "b
+0000ff90: 225d 2c20 7363 6865 6d61 3d5b 2263 6f6c  "], schema=["col
+0000ffa0: 225d 292e 7365 6c65 6374 2873 6861 3128  "]).select(sha1(
+0000ffb0: 2263 6f6c 2229 290a 2020 2020 2020 2020  "col")).        
+0000ffc0: 3e3e 3e20 6466 2e63 6f6c 6c65 6374 2829  >>> df.collect()
+0000ffd0: 0a20 2020 2020 2020 205b 526f 7728 5348  .        [Row(SH
+0000ffe0: 4131 2822 434f 4c22 293d 2738 3666 3765  A1("COL")='86f7e
+0000fff0: 3433 3766 6161 3561 3766 6365 3135 6431  437faa5a7fce15d1
+00010000: 6464 6362 3965 6165 6165 6133 3737 3636  ddcb9eaeaea37766
+00010010: 3762 3827 292c 2052 6f77 2853 4841 3128  7b8'), Row(SHA1(
+00010020: 2243 4f4c 2229 3d27 6539 6437 3166 3565  "COL")='e9d71f5e
+00010030: 6537 6339 3264 3664 6339 6539 3266 6664  e7c92d6dc9e92ffd
+00010040: 6164 3137 6238 6264 3439 3431 3866 3938  ad17b8bd49418f98
+00010050: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00010060: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00010070: 7472 2865 2c20 2273 6861 3122 290a 2020  tr(e, "sha1").  
+00010080: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00010090: 2822 7368 6131 2229 2863 290a 0a0a 6465  ("sha1")(c)...de
+000100a0: 6620 7368 6132 2865 3a20 436f 6c75 6d6e  f sha2(e: Column
+000100b0: 4f72 4e61 6d65 2c20 6e75 6d5f 6269 7473  OrName, num_bits
+000100c0: 3a20 696e 7429 202d 3e20 436f 6c75 6d6e  : int) -> Column
+000100d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+000100e0: 2061 2068 6578 2d65 6e63 6f64 6564 2073   a hex-encoded s
+000100f0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
+00010100: 2074 6865 204e 2d62 6974 2053 4841 2d32   the N-bit SHA-2
+00010110: 206d 6573 7361 6765 2064 6967 6573 742c   message digest,
+00010120: 0a20 2020 2077 6865 7265 204e 2069 7320  .    where N is 
+00010130: 7468 6520 7370 6563 6966 6965 6420 6f75  the specified ou
+00010140: 7470 7574 2064 6967 6573 7420 7369 7a65  tput digest size
+00010150: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00010160: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00010170: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00010180: 5f64 6174 6166 7261 6d65 285b 2261 222c  _dataframe(["a",
+00010190: 2022 6222 5d2c 2073 6368 656d 613d 5b22   "b"], schema=["
+000101a0: 636f 6c22 5d29 2e73 656c 6563 7428 7368  col"]).select(sh
+000101b0: 6132 2822 636f 6c22 2c20 3235 3629 290a  a2("col", 256)).
+000101c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e63          >>> df.c
+000101d0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000101e0: 205b 526f 7728 5348 4132 2822 434f 4c22   [Row(SHA2("COL"
+000101f0: 2c20 3235 3629 3d27 6361 3937 3831 3132  , 256)='ca978112
+00010200: 6361 3162 6264 6361 6661 6332 3331 6233  ca1bbdcafac231b3
+00010210: 3961 3233 6463 3464 6137 3836 6566 6638  9a23dc4da786eff8
+00010220: 3134 3763 3465 3732 6239 3830 3737 3835  147c4e72b9807785
+00010230: 6166 6565 3438 6262 2729 2c20 526f 7728  afee48bb'), Row(
+00010240: 5348 4132 2822 434f 4c22 2c20 3235 3629  SHA2("COL", 256)
+00010250: 3d27 3365 3233 6538 3136 3030 3339 3539  ='3e23e816003959
+00010260: 3461 3333 3839 3466 3635 3634 6531 6231  4a33894f6564e1b1
+00010270: 3334 3862 6264 3761 3030 3838 6434 3263  348bbd7a0088d42c
+00010280: 3461 6362 3733 6565 6165 6435 3963 3030  4acb73eeaed59c00
+00010290: 3964 2729 5d0a 2020 2020 2222 220a 2020  9d')].    """.  
+000102a0: 2020 7065 726d 6974 7465 645f 7661 6c75    permitted_valu
+000102b0: 6573 203d 205b 302c 2032 3234 2c20 3235  es = [0, 224, 25
+000102c0: 362c 2033 3834 2c20 3531 325d 0a20 2020  6, 384, 512].   
+000102d0: 2069 6620 6e75 6d5f 6269 7473 206e 6f74   if num_bits not
+000102e0: 2069 6e20 7065 726d 6974 7465 645f 7661   in permitted_va
+000102f0: 6c75 6573 3a0a 2020 2020 2020 2020 7261  lues:.        ra
+00010300: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00010310: 2020 2020 2020 2020 2020 2020 6622 6e75              f"nu
+00010320: 6d5f 6269 7473 207b 6e75 6d5f 6269 7473  m_bits {num_bits
+00010330: 7d20 6973 206e 6f74 2069 6e20 7468 6520  } is not in the 
+00010340: 7065 726d 6974 7465 6420 7661 6c75 6573  permitted values
+00010350: 207b 7065 726d 6974 7465 645f 7661 6c75   {permitted_valu
+00010360: 6573 7d22 0a20 2020 2020 2020 2029 0a20  es}".        ). 
+00010370: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00010380: 665f 7374 7228 652c 2022 7368 6132 2229  f_str(e, "sha2")
+00010390: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+000103a0: 7469 6e28 2273 6861 3222 2928 632c 206e  tin("sha2")(c, n
+000103b0: 756d 5f62 6974 7329 0a0a 0a64 6566 2068  um_bits)...def h
+000103c0: 6173 6828 2a63 6f6c 733a 2043 6f6c 756d  ash(*cols: Colum
+000103d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000103e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000103f0: 5265 7475 726e 7320 6120 7369 676e 6564  Returns a signed
+00010400: 2036 342d 6269 7420 6861 7368 2076 616c   64-bit hash val
+00010410: 7565 2e20 4e6f 7465 2074 6861 7420 4841  ue. Note that HA
+00010420: 5348 206e 6576 6572 2072 6574 7572 6e73  SH never returns
+00010430: 204e 554c 4c2c 2065 7665 6e20 666f 7220   NULL, even for 
+00010440: 4e55 4c4c 2069 6e70 7574 732e 0a0a 2020  NULL inputs...  
+00010450: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
+00010460: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00010470: 2064 6563 696d 616c 0a20 2020 2020 2020   decimal.       
+00010480: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00010490: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000104a0: 6d65 285b 5b31 302c 2022 3130 222c 2064  me([[10, "10", d
+000104b0: 6563 696d 616c 2e44 6563 696d 616c 2831  ecimal.Decimal(1
+000104c0: 3029 2c20 3130 2e30 5d5d 2c20 7363 6865  0), 10.0]], sche
+000104d0: 6d61 3d5b 2261 222c 2022 6222 2c20 2263  ma=["a", "b", "c
+000104e0: 222c 2022 6422 5d29 0a20 2020 2020 2020  ", "d"]).       
+000104f0: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
+00010500: 6173 6828 2261 2229 2e61 6c69 6173 2822  ash("a").alias("
+00010510: 6861 7368 5f61 2229 2c20 6861 7368 2822  hash_a"), hash("
+00010520: 6222 292e 616c 6961 7328 2268 6173 685f  b").alias("hash_
+00010530: 6222 292c 2068 6173 6828 2263 2229 2e61  b"), hash("c").a
+00010540: 6c69 6173 2822 6861 7368 5f63 2229 2c20  lias("hash_c"), 
+00010550: 6861 7368 2822 6422 292e 616c 6961 7328  hash("d").alias(
+00010560: 2268 6173 685f 6422 2929 2e63 6f6c 6c65  "hash_d")).colle
+00010570: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00010580: 7728 4841 5348 5f41 3d31 3539 3936 3237  w(HASH_A=1599627
+00010590: 3730 3638 3232 3936 3330 3638 2c20 4841  706822963068, HA
+000105a0: 5348 5f42 3d33 3632 3234 3934 3938 3034  SH_B=36224949804
+000105b0: 3430 3130 3839 3834 2c20 4841 5348 5f43  40108984, HASH_C
+000105c0: 3d31 3539 3936 3237 3730 3638 3232 3936  =159962770682296
+000105d0: 3330 3638 2c20 4841 5348 5f44 3d31 3539  3068, HASH_D=159
+000105e0: 3936 3237 3730 3638 3232 3936 3330 3638  9627706822963068
+000105f0: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
+00010600: 662e 7365 6c65 6374 2868 6173 6828 6c69  f.select(hash(li
+00010610: 7428 4e6f 6e65 2929 2e61 6c69 6173 2822  t(None)).alias("
+00010620: 6f6e 6522 292c 2068 6173 6828 6c69 7428  one"), hash(lit(
+00010630: 4e6f 6e65 292c 206c 6974 284e 6f6e 6529  None), lit(None)
+00010640: 292e 616c 6961 7328 2274 776f 2229 2c20  ).alias("two"), 
+00010650: 6861 7368 286c 6974 284e 6f6e 6529 2c20  hash(lit(None), 
+00010660: 6c69 7428 4e6f 6e65 292c 206c 6974 284e  lit(None), lit(N
+00010670: 6f6e 6529 292e 616c 6961 7328 2274 6872  one)).alias("thr
+00010680: 6565 2229 292e 636f 6c6c 6563 7428 290a  ee")).collect().
+00010690: 2020 2020 2020 2020 5b52 6f77 284f 4e45          [Row(ONE
+000106a0: 3d38 3831 3739 3735 3730 3233 3933 3631  =881797570239361
+000106b0: 3933 3638 2c20 5457 4f3d 3935 3339 3633  9368, TWO=953963
+000106c0: 3235 3833 3531 3130 3431 3630 2c20 5448  258351104160, TH
+000106d0: 5245 453d 3239 3431 3934 3833 3633 3834  REE=294194836384
+000106e0: 3536 3834 3431 3229 5d0a 2020 2020 2222  5684412)].    ""
+000106f0: 220a 2020 2020 636f 6c75 6d6e 7320 3d20  ".    columns = 
+00010700: 5b5f 746f 5f63 6f6c 5f69 665f 7374 7228  [_to_col_if_str(
+00010710: 632c 2022 6861 7368 2229 2066 6f72 2063  c, "hash") for c
+00010720: 2069 6e20 636f 6c73 5d0a 2020 2020 7265   in cols].    re
+00010730: 7475 726e 2062 7569 6c74 696e 2822 6861  turn builtin("ha
+00010740: 7368 2229 2863 6f6c 756d 6e73 290a 0a0a  sh")(columns)...
+00010750: 6465 6620 6173 6369 6928 653a 2043 6f6c  def ascii(e: Col
+00010760: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00010770: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00010780: 7572 6e73 2074 6865 2041 5343 4949 2063  urns the ASCII c
+00010790: 6f64 6520 666f 7220 7468 6520 6669 7273  ode for the firs
+000107a0: 7420 6368 6172 6163 7465 7220 6f66 2061  t character of a
+000107b0: 2073 7472 696e 672e 2049 6620 7468 6520   string. If the 
+000107c0: 7374 7269 6e67 2069 7320 656d 7074 792c  string is empty,
+000107d0: 0a20 2020 2061 2076 616c 7565 206f 6620  .    a value of 
+000107e0: 3020 6973 2072 6574 7572 6e65 642e 0a0a  0 is returned...
+000107f0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00010800: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00010810: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00010820: 6174 6166 7261 6d65 285b 2721 272c 2027  ataframe(['!', '
+00010830: 4127 2c20 2761 272c 2027 272c 2027 6263  A', 'a', '', 'bc
+00010840: 6427 2c20 4e6f 6e65 5d2c 2073 6368 656d  d', None], schem
+00010850: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
+00010860: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+00010870: 662e 612c 2061 7363 6969 2864 662e 6129  f.a, ascii(df.a)
+00010880: 2e61 735f 2827 6173 6369 6927 2929 2e63  .as_('ascii')).c
+00010890: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+000108a0: 205b 526f 7728 413d 2721 272c 2041 5343   [Row(A='!', ASC
+000108b0: 4949 3d33 3329 2c20 526f 7728 413d 2741  II=33), Row(A='A
+000108c0: 272c 2041 5343 4949 3d36 3529 2c20 526f  ', ASCII=65), Ro
+000108d0: 7728 413d 2761 272c 2041 5343 4949 3d39  w(A='a', ASCII=9
+000108e0: 3729 2c20 526f 7728 413d 2727 2c20 4153  7), Row(A='', AS
+000108f0: 4349 493d 3029 2c20 526f 7728 413d 2762  CII=0), Row(A='b
+00010900: 6364 272c 2041 5343 4949 3d39 3829 2c20  cd', ASCII=98), 
+00010910: 526f 7728 413d 4e6f 6e65 2c20 4153 4349  Row(A=None, ASCI
+00010920: 493d 4e6f 6e65 295d 0a20 2020 2022 2222  I=None)].    """
+00010930: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00010940: 5f69 665f 7374 7228 652c 2022 6173 6369  _if_str(e, "asci
+00010950: 6922 290a 2020 2020 7265 7475 726e 2062  i").    return b
+00010960: 7569 6c74 696e 2822 6173 6369 6922 2928  uiltin("ascii")(
+00010970: 6329 0a0a 0a64 6566 2069 6e69 7463 6170  c)...def initcap
+00010980: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00010990: 2c20 6465 6c69 6d69 7465 7273 3a20 436f  , delimiters: Co
+000109a0: 6c75 6d6e 4f72 4e61 6d65 203d 204e 6f6e  lumnOrName = Non
+000109b0: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+000109c0: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+000109d0: 7320 7468 6520 696e 7075 7420 7374 7269  s the input stri
+000109e0: 6e67 2077 6974 6820 7468 6520 6669 7273  ng with the firs
+000109f0: 7420 6c65 7474 6572 206f 6620 6561 6368  t letter of each
+00010a00: 2077 6f72 6420 696e 2075 7070 6572 6361   word in upperca
+00010a10: 7365 0a20 2020 2061 6e64 2074 6865 2073  se.    and the s
+00010a20: 7562 7365 7175 656e 7420 6c65 7474 6572  ubsequent letter
+00010a30: 7320 696e 206c 6f77 6572 6361 7365 2e0a  s in lowercase..
+00010a40: 0a20 2020 2060 6064 656c 696d 6974 6572  .    ``delimiter
+00010a50: 7360 6020 6973 2061 6e20 6f70 7469 6f6e  s`` is an option
+00010a60: 616c 2061 7267 756d 656e 7420 7370 6563  al argument spec
+00010a70: 6966 7969 6e67 2061 2073 7472 696e 6720  ifying a string 
+00010a80: 6f66 206f 6e65 206f 7220 6d6f 7265 0a20  of one or more. 
+00010a90: 2020 2063 6861 7261 6374 6572 7320 7468     characters th
+00010aa0: 6174 2060 6069 6e69 7463 6170 6060 2075  at ``initcap`` u
+00010ab0: 7365 7320 6173 2073 6570 6172 6174 6f72  ses as separator
+00010ac0: 7320 666f 7220 776f 7264 7320 696e 2074  s for words in t
+00010ad0: 6865 2069 6e70 7574 2065 7870 7265 7373  he input express
+00010ae0: 696f 6e2e 0a0a 2020 2020 4966 2060 6064  ion...    If ``d
+00010af0: 656c 696d 6974 6572 7360 6020 6973 206e  elimiters`` is n
+00010b00: 6f74 2073 7065 6369 6669 6564 2c20 616e  ot specified, an
+00010b10: 7920 6f66 2074 6865 2066 6f6c 6c6f 7769  y of the followi
+00010b20: 6e67 2063 6861 7261 6374 6572 7320 696e  ng characters in
+00010b30: 2074 6865 0a20 2020 2069 6e70 7574 2065   the.    input e
+00010b40: 7870 7265 7373 696f 6e73 2061 7265 2074  xpressions are t
+00010b50: 7265 6174 6564 2061 7320 776f 7264 2073  reated as word s
+00010b60: 6570 6172 6174 6f72 733a 0a0a 2020 2020  eparators:..    
+00010b70: 2020 2020 6060 3c77 6869 7465 7370 6163      ``<whitespac
+00010b80: 653e 2021 203f 2040 2022 205e 2023 2024  e> ! ? @ " ^ # $
+00010b90: 2026 207e 205f 202c 202e 203a 203b 202b   & ~ _ , . : ; +
+00010ba0: 202d 202a 2025 202f 207c 205c 5c20 5b20   - * % / | \\ [ 
+00010bb0: 5d20 2820 2920 7b20 7d20 3c20 3e60 600a  ] ( ) { } < >``.
+00010bc0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00010bd0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00010be0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00010bf0: 5f64 6174 6166 7261 6d65 285b 2274 6865  _dataframe(["the
+00010c00: 2073 6b79 2069 7320 626c 7565 222c 2022   sky is blue", "
+00010c10: 5745 2043 414e 2048 414e 444c 4520 5448  WE CAN HANDLE TH
+00010c20: 4953 222c 2022 c384 c3a4 c396 c3b6 c39f  IS", "..........
+00010c30: c39c c3bc 222c 204e 6f6e 655d 2c20 7363  ....", None], sc
+00010c40: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+00010c50: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+00010c60: 7428 696e 6974 6361 7028 6466 5b22 6122  t(initcap(df["a"
+00010c70: 5d29 2e61 6c69 6173 2822 696e 6974 6361  ]).alias("initca
+00010c80: 7022 2929 2e63 6f6c 6c65 6374 2829 0a20  p")).collect(). 
+00010c90: 2020 2020 2020 205b 526f 7728 494e 4954         [Row(INIT
+00010ca0: 4341 503d 2754 6865 2053 6b79 2049 7320  CAP='The Sky Is 
+00010cb0: 426c 7565 2729 2c20 526f 7728 494e 4954  Blue'), Row(INIT
+00010cc0: 4341 503d 2757 6520 4361 6e20 4861 6e64  CAP='We Can Hand
+00010cd0: 6c65 2054 6869 7327 292c 2052 6f77 2849  le This'), Row(I
+00010ce0: 4e49 5443 4150 3d27 c384 c3a4 c3b6 c3b6  NITCAP='........
+00010cf0: c39f c3bc c3bc 2729 2c20 526f 7728 494e  ......'), Row(IN
+00010d00: 4954 4341 503d 4e6f 6e65 295d 0a20 2020  ITCAP=None)].   
+00010d10: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00010d20: 6374 2869 6e69 7463 6170 2864 665b 2261  ct(initcap(df["a
+00010d30: 225d 2c20 6c69 7428 2727 2929 2e61 6c69  "], lit('')).ali
+00010d40: 6173 2822 696e 6974 6361 7022 2929 2e63  as("initcap")).c
+00010d50: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00010d60: 205b 526f 7728 494e 4954 4341 503d 2754   [Row(INITCAP='T
+00010d70: 6865 2073 6b79 2069 7320 626c 7565 2729  he sky is blue')
+00010d80: 2c20 526f 7728 494e 4954 4341 503d 2757  , Row(INITCAP='W
+00010d90: 6520 6361 6e20 6861 6e64 6c65 2074 6869  e can handle thi
+00010da0: 7327 292c 2052 6f77 2849 4e49 5443 4150  s'), Row(INITCAP
+00010db0: 3d27 c384 c3a4 c3b6 c3b6 c39f c3bc c3bc  ='..............
+00010dc0: 2729 2c20 526f 7728 494e 4954 4341 503d  '), Row(INITCAP=
+00010dd0: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
+00010de0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00010df0: 665f 7374 7228 652c 2022 696e 6974 6361  f_str(e, "initca
+00010e00: 7022 290a 2020 2020 6966 2064 656c 696d  p").    if delim
+00010e10: 6974 6572 7320 6973 204e 6f6e 653a 0a20  iters is None:. 
+00010e20: 2020 2020 2020 2072 6574 7572 6e20 6275         return bu
+00010e30: 696c 7469 6e28 2269 6e69 7463 6170 2229  iltin("initcap")
+00010e40: 2863 290a 2020 2020 6465 6c69 6d69 7465  (c).    delimite
+00010e50: 725f 636f 6c20 3d20 5f74 6f5f 636f 6c5f  r_col = _to_col_
+00010e60: 6966 5f73 7472 2864 656c 696d 6974 6572  if_str(delimiter
+00010e70: 732c 2022 696e 6974 6361 7022 290a 2020  s, "initcap").  
+00010e80: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00010e90: 2822 696e 6974 6361 7022 2928 632c 2064  ("initcap")(c, d
+00010ea0: 656c 696d 6974 6572 5f63 6f6c 290a 0a0a  elimiter_col)...
+00010eb0: 6465 6620 6c65 6e67 7468 2865 3a20 436f  def length(e: Co
+00010ec0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00010ed0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00010ee0: 2020 2052 6574 7572 6e73 2074 6865 206c     Returns the l
+00010ef0: 656e 6774 6820 6f66 2061 6e20 696e 7075  ength of an inpu
+00010f00: 7420 7374 7269 6e67 206f 7220 6269 6e61  t string or bina
+00010f10: 7279 2076 616c 7565 2e20 466f 7220 7374  ry value. For st
+00010f20: 7269 6e67 732c 0a20 2020 2074 6865 206c  rings,.    the l
+00010f30: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
+00010f40: 6265 7220 6f66 2063 6861 7261 6374 6572  ber of character
+00010f50: 732c 2061 6e64 2055 5446 2d38 2063 6861  s, and UTF-8 cha
+00010f60: 7261 6374 6572 7320 6172 6520 636f 756e  racters are coun
+00010f70: 7465 6420 6173 2061 0a20 2020 2073 696e  ted as a.    sin
+00010f80: 676c 6520 6368 6172 6163 7465 722e 2046  gle character. F
+00010f90: 6f72 2062 696e 6172 792c 2074 6865 206c  or binary, the l
+00010fa0: 656e 6774 6820 6973 2074 6865 206e 756d  ength is the num
+00010fb0: 6265 7220 6f66 2062 7974 6573 2e0a 0a20  ber of bytes... 
+00010fc0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+00010fd0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00010fe0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00010ff0: 7461 6672 616d 6528 5b22 7468 6520 736b  taframe(["the sk
+00011000: 7920 6973 2062 6c75 6522 2c20 2257 4520  y is blue", "WE 
+00011010: 4341 4e20 4841 4e44 4c45 2054 4849 5322  CAN HANDLE THIS"
+00011020: 2c20 22c3 84c3 a4c3 96c3 b6c3 9fc3 9cc3  , ".............
+00011030: bc22 2c20 4e6f 6e65 5d2c 2073 6368 656d  .", None], schem
+00011040: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00011050: 203e 3e3e 2064 662e 7365 6c65 6374 286c   >>> df.select(l
+00011060: 656e 6774 6828 6466 5b22 6122 5d29 2e61  ength(df["a"]).a
+00011070: 6c69 6173 2822 6c65 6e67 7468 2229 292e  lias("length")).
+00011080: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00011090: 2020 5b52 6f77 284c 454e 4754 483d 3135    [Row(LENGTH=15
+000110a0: 292c 2052 6f77 284c 454e 4754 483d 3138  ), Row(LENGTH=18
+000110b0: 292c 2052 6f77 284c 454e 4754 483d 3729  ), Row(LENGTH=7)
+000110c0: 2c20 526f 7728 4c45 4e47 5448 3d4e 6f6e  , Row(LENGTH=Non
+000110d0: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+000110e0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+000110f0: 7472 2865 2c20 226c 656e 6774 6822 290a  tr(e, "length").
+00011100: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00011110: 696e 2822 6c65 6e67 7468 2229 2863 290a  in("length")(c).
+00011120: 0a0a 6465 6620 6c6f 7765 7228 653a 2043  ..def lower(e: C
+00011130: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00011140: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00011150: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00011160: 696e 7075 7420 7374 7269 6e67 2077 6974  input string wit
+00011170: 6820 616c 6c20 6368 6172 6163 7465 7273  h all characters
+00011180: 2063 6f6e 7665 7274 6564 2074 6f20 6c6f   converted to lo
+00011190: 7765 7263 6173 652e 0a0a 2020 2020 4578  wercase...    Ex
+000111a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000111b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000111c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000111d0: 6d65 285b 2761 6263 272c 2027 4162 6327  me(['abc', 'Abc'
+000111e0: 2c20 2761 4243 272c 2027 416e 66c3 bc68  , 'aBC', 'Anf..h
+000111f0: 7275 6e67 737a 6569 6368 656e 272c 2027  rungszeichen', '
+00011200: 3134 2e39 3520 e282 ac27 5d2c 2073 6368  14.95 ...'], sch
+00011210: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00011220: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00011230: 286c 6f77 6572 2863 6f6c 2822 6122 2929  (lower(col("a"))
+00011240: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+00011250: 2020 2020 5b52 6f77 284c 4f57 4552 2822      [Row(LOWER("
+00011260: 4122 293d 2761 6263 2729 2c20 526f 7728  A")='abc'), Row(
+00011270: 4c4f 5745 5228 2241 2229 3d27 6162 6327  LOWER("A")='abc'
+00011280: 292c 2052 6f77 284c 4f57 4552 2822 4122  ), Row(LOWER("A"
+00011290: 293d 2761 6263 2729 2c20 526f 7728 4c4f  )='abc'), Row(LO
+000112a0: 5745 5228 2241 2229 3d27 616e 66c3 bc68  WER("A")='anf..h
+000112b0: 7275 6e67 737a 6569 6368 656e 2729 2c20  rungszeichen'), 
+000112c0: 526f 7728 4c4f 5745 5228 2241 2229 3d27  Row(LOWER("A")='
+000112d0: 3134 2e39 3520 e282 ac27 295d 0a20 2020  14.95 ...')].   
+000112e0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000112f0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00011300: 6c6f 7765 7222 290a 2020 2020 7265 7475  lower").    retu
+00011310: 726e 2062 7569 6c74 696e 2822 6c6f 7765  rn builtin("lowe
+00011320: 7222 2928 6329 0a0a 0a64 6566 206c 7061  r")(c)...def lpa
+00011330: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
+00011340: 652c 206c 656e 3a20 556e 696f 6e5b 436f  e, len: Union[Co
+00011350: 6c75 6d6e 2c20 696e 745d 2c20 7061 643a  lumn, int], pad:
+00011360: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00011370: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00011380: 220a 2020 2020 4c65 6674 2d70 6164 7320  ".    Left-pads 
+00011390: 6120 7374 7269 6e67 2077 6974 6820 6368  a string with ch
+000113a0: 6172 6163 7465 7273 2066 726f 6d20 616e  aracters from an
+000113b0: 6f74 6865 7220 7374 7269 6e67 2c20 6f72  other string, or
+000113c0: 206c 6566 742d 7061 6473 2061 0a20 2020   left-pads a.   
+000113d0: 2062 696e 6172 7920 7661 6c75 6520 7769   binary value wi
+000113e0: 7468 2062 7974 6573 2066 726f 6d20 616e  th bytes from an
+000113f0: 6f74 6865 7220 6269 6e61 7279 2076 616c  other binary val
+00011400: 7565 2e0a 0a20 2020 2045 7861 6d70 6c65  ue...    Example
+00011410: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00011420: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00011430: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+00011440: 7320 696d 706f 7274 206c 6974 0a20 2020  s import lit.   
+00011450: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00011460: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00011470: 6166 7261 6d65 285b 5b22 6122 5d2c 205b  aframe([["a"], [
+00011480: 2262 225d 2c20 5b22 6322 5d5d 2c20 7363  "b"], ["c"]], sc
+00011490: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+000114a0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000114b0: 7428 6c70 6164 2863 6f6c 2822 6122 292c  t(lpad(col("a"),
+000114c0: 2033 2c20 6c69 7428 226b 2229 292e 616c   3, lit("k")).al
+000114d0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+000114e0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+000114f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00011500: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+00011510: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011520: 2d2d 2d2d 0a20 2020 2020 2020 207c 6b6b  ----.        |kk
+00011530: 6120 2020 2020 2020 7c0a 2020 2020 2020  a       |.      
+00011540: 2020 7c6b 6b62 2020 2020 2020 207c 0a20    |kkb       |. 
+00011550: 2020 2020 2020 207c 6b6b 6320 2020 2020         |kkc     
+00011560: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00011570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00011580: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00011590: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+000115a0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+000115b0: 6c70 6164 2229 0a20 2020 2070 203d 205f  lpad").    p = _
+000115c0: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
+000115d0: 642c 2022 6c70 6164 2229 0a20 2020 2072  d, "lpad").    r
+000115e0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
+000115f0: 7061 6422 2928 632c 206c 6974 286c 656e  pad")(c, lit(len
+00011600: 292c 2070 290a 0a0a 6465 6620 6c74 7269  ), p)...def ltri
+00011610: 6d28 653a 2043 6f6c 756d 6e4f 724e 616d  m(e: ColumnOrNam
+00011620: 652c 2074 7269 6d5f 7374 7269 6e67 3a20  e, trim_string: 
+00011630: 4f70 7469 6f6e 616c 5b43 6f6c 756d 6e4f  Optional[ColumnO
+00011640: 724e 616d 655d 203d 204e 6f6e 6529 202d  rName] = None) -
+00011650: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00011660: 220a 2020 2020 5265 6d6f 7665 7320 6c65  ".    Removes le
+00011670: 6164 696e 6720 6368 6172 6163 7465 7273  ading characters
+00011680: 2c20 696e 636c 7564 696e 6720 7768 6974  , including whit
+00011690: 6573 7061 6365 2c20 6672 6f6d 2061 2073  espace, from a s
+000116a0: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
+000116b0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+000116c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+000116d0: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
+000116e0: 696f 6e73 2069 6d70 6f72 7420 6c69 740a  ions import lit.
+000116f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00011700: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00011710: 6461 7461 6672 616d 6528 5b5b 2261 7373  dataframe([["ass
+00011720: 7322 5d2c 205b 2262 7373 7322 5d2c 205b  s"], ["bsss"], [
+00011730: 2263 7373 7322 5d5d 2c20 7363 6865 6d61  "csss"]], schema
+00011740: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00011750: 3e3e 3e20 6466 2e73 656c 6563 7428 7274  >>> df.select(rt
+00011760: 7269 6d28 636f 6c28 2261 2229 2c20 7472  rim(col("a"), tr
+00011770: 696d 5f73 7472 696e 673d 6c69 7428 2273  im_string=lit("s
+00011780: 7373 2229 292e 616c 6961 7328 2272 6573  ss")).alias("res
+00011790: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+000117a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000117b0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+000117c0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+000117d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+000117e0: 2020 2020 207c 6120 2020 2020 2020 2020       |a         
+000117f0: 7c0a 2020 2020 2020 2020 7c62 2020 2020  |.        |b    
+00011800: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00011810: 6320 2020 2020 2020 2020 7c0a 2020 2020  c         |.    
+00011820: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00011830: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00011840: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00011850: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00011860: 7374 7228 652c 2022 6c74 7269 6d22 290a  str(e, "ltrim").
+00011870: 2020 2020 7420 3d20 5f74 6f5f 636f 6c5f      t = _to_col_
+00011880: 6966 5f73 7472 2874 7269 6d5f 7374 7269  if_str(trim_stri
+00011890: 6e67 2c20 226c 7472 696d 2229 2069 6620  ng, "ltrim") if 
+000118a0: 7472 696d 5f73 7472 696e 6720 6973 206e  trim_string is n
+000118b0: 6f74 204e 6f6e 6520 656c 7365 204e 6f6e  ot None else Non
+000118c0: 650a 2020 2020 7265 7475 726e 2062 7569  e.    return bui
+000118d0: 6c74 696e 2822 6c74 7269 6d22 2928 632c  ltin("ltrim")(c,
+000118e0: 2074 2920 6966 2074 2069 7320 6e6f 7420   t) if t is not 
+000118f0: 4e6f 6e65 2065 6c73 6520 6275 696c 7469  None else builti
+00011900: 6e28 226c 7472 696d 2229 2863 290a 0a0a  n("ltrim")(c)...
+00011910: 6465 6620 7270 6164 2865 3a20 436f 6c75  def rpad(e: Colu
+00011920: 6d6e 4f72 4e61 6d65 2c20 6c65 6e3a 2055  mnOrName, len: U
+00011930: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
+00011940: 5d2c 2070 6164 3a20 436f 6c75 6d6e 4f72  ], pad: ColumnOr
+00011950: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00011960: 0a20 2020 2022 2222 5269 6768 742d 7061  .    """Right-pa
+00011970: 6473 2061 2073 7472 696e 6720 7769 7468  ds a string with
+00011980: 2063 6861 7261 6374 6572 7320 6672 6f6d   characters from
+00011990: 2061 6e6f 7468 6572 2073 7472 696e 672c   another string,
+000119a0: 206f 7220 7269 6768 742d 7061 6473 2061   or right-pads a
+000119b0: 0a20 2020 2062 696e 6172 7920 7661 6c75  .    binary valu
+000119c0: 6520 7769 7468 2062 7974 6573 2066 726f  e with bytes fro
+000119d0: 6d20 616e 6f74 6865 7220 6269 6e61 7279  m another binary
+000119e0: 2076 616c 7565 2e20 5768 656e 2063 616c   value. When cal
+000119f0: 6c65 642c 2060 6560 2069 7320 7061 6464  led, `e` is padd
+00011a00: 6564 2074 6f20 6c65 6e67 7468 2060 6c65  ed to length `le
+00011a10: 6e60 0a20 2020 2077 6974 6820 6368 6172  n`.    with char
+00011a20: 6163 7465 7273 2f62 7974 6573 2066 726f  acters/bytes fro
+00011a30: 6d20 6070 6164 602e 0a0a 2020 2020 4578  m `pad`...    Ex
+00011a40: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00011a50: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00011a60: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+00011a70: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
+00011a80: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
+00011a90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00011aa0: 655f 6461 7461 6672 616d 6528 5b5b 2261  e_dataframe([["a
+00011ab0: 225d 2c20 5b22 6222 5d2c 205b 2263 225d  "], ["b"], ["c"]
+00011ac0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00011ad0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00011ae0: 7365 6c65 6374 2872 7061 6428 636f 6c28  select(rpad(col(
+00011af0: 2261 2229 2c20 332c 206c 6974 2822 6b22  "a"), 3, lit("k"
+00011b00: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+00011b10: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
+00011b20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00011b30: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00011b40: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00011b50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00011b60: 2020 7c61 6b6b 2020 2020 2020 207c 0a20    |akk       |. 
+00011b70: 2020 2020 2020 207c 626b 6b20 2020 2020         |bkk     
+00011b80: 2020 7c0a 2020 2020 2020 2020 7c63 6b6b    |.        |ckk
+00011b90: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00011ba0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00011bb0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00011bc0: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
+00011bd0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00011be0: 2865 2c20 2272 7061 6422 290a 2020 2020  (e, "rpad").    
+00011bf0: 7020 3d20 5f74 6f5f 636f 6c5f 6966 5f73  p = _to_col_if_s
+00011c00: 7472 2870 6164 2c20 2272 7061 6422 290a  tr(pad, "rpad").
+00011c10: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00011c20: 696e 2822 7270 6164 2229 2863 2c20 6c69  in("rpad")(c, li
+00011c30: 7428 6c65 6e29 2c20 7029 0a0a 0a64 6566  t(len), p)...def
+00011c40: 2072 7472 696d 2865 3a20 436f 6c75 6d6e   rtrim(e: Column
+00011c50: 4f72 4e61 6d65 2c20 7472 696d 5f73 7472  OrName, trim_str
+00011c60: 696e 673a 204f 7074 696f 6e61 6c5b 436f  ing: Optional[Co
+00011c70: 6c75 6d6e 4f72 4e61 6d65 5d20 3d20 4e6f  lumnOrName] = No
+00011c80: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00011c90: 2020 2022 2222 5265 6d6f 7665 7320 7472     """Removes tr
+00011ca0: 6169 6c69 6e67 2063 6861 7261 6374 6572  ailing character
+00011cb0: 732c 2069 6e63 6c75 6469 6e67 2077 6869  s, including whi
+00011cc0: 7465 7370 6163 652c 2066 726f 6d20 6120  tespace, from a 
+00011cd0: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
+00011ce0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00011cf0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00011d00: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+00011d10: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
+00011d20: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00011d30: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00011d40: 5f64 6174 6166 7261 6d65 285b 5b22 6173  _dataframe([["as
+00011d50: 7373 225d 2c20 5b22 6273 7373 225d 2c20  ss"], ["bsss"], 
+00011d60: 5b22 6373 7373 225d 5d2c 2073 6368 656d  ["csss"]], schem
+00011d70: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00011d80: 203e 3e3e 2064 662e 7365 6c65 6374 2872   >>> df.select(r
+00011d90: 7472 696d 2863 6f6c 2822 6122 292c 2074  trim(col("a"), t
+00011da0: 7269 6d5f 7374 7269 6e67 3d6c 6974 2822  rim_string=lit("
+00011db0: 7373 7322 2929 2e61 6c69 6173 2822 7265  sss")).alias("re
+00011dc0: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00011dd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00011de0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00011df0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00011e00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00011e10: 2020 2020 2020 7c61 2020 2020 2020 2020        |a        
+00011e20: 207c 0a20 2020 2020 2020 207c 6220 2020   |.        |b   
+00011e30: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00011e40: 7c63 2020 2020 2020 2020 207c 0a20 2020  |c         |.   
+00011e50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00011e60: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00011e70: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00011e80: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00011e90: 5f73 7472 2865 2c20 2272 7472 696d 2229  _str(e, "rtrim")
+00011ea0: 0a20 2020 2074 203d 205f 746f 5f63 6f6c  .    t = _to_col
+00011eb0: 5f69 665f 7374 7228 7472 696d 5f73 7472  _if_str(trim_str
+00011ec0: 696e 672c 2022 7274 7269 6d22 2920 6966  ing, "rtrim") if
+00011ed0: 2074 7269 6d5f 7374 7269 6e67 2069 7320   trim_string is 
+00011ee0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
+00011ef0: 6e65 0a20 2020 2072 6574 7572 6e20 6275  ne.    return bu
+00011f00: 696c 7469 6e28 2272 7472 696d 2229 2863  iltin("rtrim")(c
+00011f10: 2c20 7429 2069 6620 7420 6973 206e 6f74  , t) if t is not
+00011f20: 204e 6f6e 6520 656c 7365 2062 7569 6c74   None else built
+00011f30: 696e 2822 7274 7269 6d22 2928 6329 0a0a  in("rtrim")(c)..
+00011f40: 0a64 6566 2072 6570 6561 7428 733a 2043  .def repeat(s: C
+00011f50: 6f6c 756d 6e4f 724e 616d 652c 206e 3a20  olumnOrName, n: 
+00011f60: 556e 696f 6e5b 436f 6c75 6d6e 2c20 696e  Union[Column, in
+00011f70: 745d 2920 2d3e 2043 6f6c 756d 6e3a 0a20  t]) -> Column:. 
+00011f80: 2020 2022 2222 4275 696c 6473 2061 2073     """Builds a s
+00011f90: 7472 696e 6720 6279 2072 6570 6561 7469  tring by repeati
+00011fa0: 6e67 2074 6865 2069 6e70 7574 2066 6f72  ng the input for
+00011fb0: 2074 6865 2073 7065 6369 6669 6564 206e   the specified n
+00011fc0: 756d 6265 7220 6f66 2074 696d 6573 2e0a  umber of times..
+00011fd0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00011fe0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00011ff0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00012000: 6461 7461 6672 616d 6528 5b5b 2261 225d  dataframe([["a"]
+00012010: 2c20 5b22 6222 5d2c 205b 2263 225d 5d2c  , ["b"], ["c"]],
+00012020: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00012030: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00012040: 6c65 6374 2872 6570 6561 7428 636f 6c28  lect(repeat(col(
+00012050: 2261 2229 2c20 3329 2e61 6c69 6173 2822  "a"), 3).alias("
+00012060: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00012070: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00012080: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00012090: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000120a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000120b0: 2020 2020 2020 2020 7c61 6161 2020 2020          |aaa    
+000120c0: 2020 207c 0a20 2020 2020 2020 207c 6262     |.        |bb
+000120d0: 6220 2020 2020 2020 7c0a 2020 2020 2020  b       |.      
+000120e0: 2020 7c63 6363 2020 2020 2020 207c 0a20    |ccc       |. 
+000120f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00012100: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00012110: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00012120: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00012130: 6966 5f73 7472 2873 2c20 2272 6570 6561  if_str(s, "repea
+00012140: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+00012150: 7569 6c74 696e 2822 7265 7065 6174 2229  uiltin("repeat")
+00012160: 2863 2c20 6c69 7428 6e29 290a 0a0a 6465  (c, lit(n))...de
+00012170: 6620 7265 7665 7273 6528 636f 6c3a 2043  f reverse(col: C
+00012180: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00012190: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+000121a0: 6576 6572 7365 7320 7468 6520 6f72 6465  everses the orde
+000121b0: 7220 6f66 2063 6861 7261 6374 6572 7320  r of characters 
+000121c0: 696e 2061 2073 7472 696e 672c 206f 7220  in a string, or 
+000121d0: 6f66 2062 7974 6573 2069 6e20 6120 6269  of bytes in a bi
+000121e0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
+000121f0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00012200: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00012210: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00012220: 6672 616d 6528 5b5b 2248 656c 6c6f 225d  frame([["Hello"]
+00012230: 2c20 5b22 6162 6322 5d5d 2c20 7363 6865  , ["abc"]], sche
+00012240: 6d61 3d5b 2263 6f6c 3122 5d29 0a20 2020  ma=["col1"]).   
+00012250: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00012260: 6374 2872 6576 6572 7365 2863 6f6c 2822  ct(reverse(col("
+00012270: 636f 6c31 2229 2929 2e73 686f 7728 290a  col1"))).show().
+00012280: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000122a0: 2020 2020 2020 2020 7c22 5245 5645 5253          |"REVERS
+000122b0: 4528 2222 434f 4c31 2222 2922 2020 7c0a  E(""COL1"")"  |.
+000122c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000122d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000122e0: 2020 2020 2020 2020 7c6f 6c6c 6548 2020          |olleH  
+000122f0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00012300: 2020 2020 2020 2020 7c63 6261 2020 2020          |cba    
+00012310: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00012320: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00012340: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+00012350: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+00012360: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
+00012370: 5f73 7472 2863 6f6c 2c20 2272 6576 6572  _str(col, "rever
+00012380: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
+00012390: 6275 696c 7469 6e28 2272 6576 6572 7365  builtin("reverse
+000123a0: 2229 2863 6f6c 290a 0a0a 6465 6620 736f  ")(col)...def so
+000123b0: 756e 6465 7828 653a 2043 6f6c 756d 6e4f  undex(e: ColumnO
+000123c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+000123d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+000123e0: 2061 2073 7472 696e 6720 7468 6174 2063   a string that c
+000123f0: 6f6e 7461 696e 7320 6120 7068 6f6e 6574  ontains a phonet
+00012400: 6963 2072 6570 7265 7365 6e74 6174 696f  ic representatio
+00012410: 6e20 6f66 2074 6865 2069 6e70 7574 2073  n of the input s
+00012420: 7472 696e 672e 0a0a 2020 2020 4578 616d  tring...    Exam
+00012430: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00012440: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00012450: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00012460: 5b22 4d61 7273 6861 222c 2022 4d61 7263  ["Marsha", "Marc
+00012470: 6961 225d 2c20 7363 6865 6d61 3d5b 2256  ia"], schema=["V
+00012480: 225d 292e 7365 6c65 6374 2873 6f75 6e64  "]).select(sound
+00012490: 6578 2863 6f6c 2822 5622 2929 290a 2020  ex(col("V"))).  
+000124a0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+000124b0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000124c0: 526f 7728 534f 554e 4445 5828 2256 2229  Row(SOUNDEX("V")
+000124d0: 3d27 4d36 3230 2729 2c20 526f 7728 534f  ='M620'), Row(SO
+000124e0: 554e 4445 5828 2256 2229 3d27 4d36 3230  UNDEX("V")='M620
+000124f0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+00012500: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00012510: 7472 2865 2c20 2273 6f75 6e64 6578 2229  tr(e, "soundex")
+00012520: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00012530: 7469 6e28 2273 6f75 6e64 6578 2229 2863  tin("soundex")(c
+00012540: 290a 0a0a 6465 6620 7472 696d 2865 3a20  )...def trim(e: 
+00012550: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7472  ColumnOrName, tr
+00012560: 696d 5f73 7472 696e 673a 204f 7074 696f  im_string: Optio
+00012570: 6e61 6c5b 436f 6c75 6d6e 4f72 4e61 6d65  nal[ColumnOrName
+00012580: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
+00012590: 756d 6e3a 0a20 2020 2022 2222 5265 6d6f  umn:.    """Remo
+000125a0: 7665 7320 6c65 6164 696e 6720 616e 6420  ves leading and 
+000125b0: 7472 6169 6c69 6e67 2063 6861 7261 6374  trailing charact
+000125c0: 6572 7320 6672 6f6d 2061 2073 7472 696e  ers from a strin
+000125d0: 672e 2050 6572 2064 6566 6175 6c74 206f  g. Per default o
+000125e0: 6e6c 7920 7768 6974 6573 7061 6365 2027  nly whitespace '
+000125f0: 2027 2063 6861 7261 6374 6572 7320 6172   ' characters ar
+00012600: 6520 7265 6d6f 7665 642e 0a0a 2020 2020  e removed...    
+00012610: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00012620: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00012630: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00012640: 7261 6d65 285b 2768 656c 6c6f 272c 2027  rame(['hello', '
+00012650: 2077 6f72 6c64 272c 2027 2020 2021 2020   world', '   !  
+00012660: 2027 5d2c 2073 6368 656d 613d 5b22 6122   '], schema=["a"
+00012670: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00012680: 662e 636f 6c6c 6563 7428 290a 2020 2020  f.collect().    
+00012690: 2020 2020 5b52 6f77 2841 3d27 6865 6c6c      [Row(A='hell
+000126a0: 6f27 292c 2052 6f77 2841 3d27 2077 6f72  o'), Row(A=' wor
+000126b0: 6c64 2729 2c20 526f 7728 413d 2720 2020  ld'), Row(A='   
+000126c0: 2120 2020 2729 5d0a 2020 2020 2020 2020  !   ')].        
+000126d0: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+000126e0: 696d 2863 6f6c 2822 6122 2929 292e 636f  im(col("a"))).co
+000126f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00012700: 5b52 6f77 2854 5249 4d28 2241 2229 3d27  [Row(TRIM("A")='
+00012710: 6865 6c6c 6f27 292c 2052 6f77 2854 5249  hello'), Row(TRI
+00012720: 4d28 2241 2229 3d27 776f 726c 6427 292c  M("A")='world'),
+00012730: 2052 6f77 2854 5249 4d28 2241 2229 3d27   Row(TRIM("A")='
+00012740: 2127 295d 0a0a 2020 2020 4578 616d 706c  !')]..    Exampl
+00012750: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00012760: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00012770: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00012780: 2745 5552 2031 322e 3936 272c 2027 372e  'EUR 12.96', '7.
+00012790: 3839 5553 4427 2c20 2735 2e39 3945 275d  89USD', '5.99E']
+000127a0: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
+000127b0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+000127c0: 656c 6563 7428 7472 696d 2863 6f6c 2822  elect(trim(col("
+000127d0: 6122 292c 206c 6974 2822 4555 5255 5344  a"), lit("EURUSD
+000127e0: 2022 2929 2e61 735f 2822 616e 7322 2929   ")).as_("ans"))
+000127f0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00012800: 2020 205b 526f 7728 414e 533d 2731 322e     [Row(ANS='12.
+00012810: 3936 2729 2c20 526f 7728 414e 533d 2737  96'), Row(ANS='7
+00012820: 2e38 3927 292c 2052 6f77 2841 4e53 3d27  .89'), Row(ANS='
+00012830: 352e 3939 2729 5d0a 0a20 2020 2045 7861  5.99')]..    Exa
+00012840: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00012850: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00012860: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00012870: 6528 5b27 6162 6331 3220 3435 6120 3739  e(['abc12 45a 79
+00012880: 6263 2127 5d2c 2073 6368 656d 613d 5b22  bc!'], schema=["
+00012890: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+000128a0: 2064 662e 7365 6c65 6374 2874 7269 6d28   df.select(trim(
+000128b0: 636f 6c28 2261 2229 2c20 6c69 7428 2261  col("a"), lit("a
+000128c0: 6263 2122 2929 2e61 735f 2822 616e 7322  bc!")).as_("ans"
+000128d0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000128e0: 2020 2020 205b 526f 7728 414e 533d 2731       [Row(ANS='1
+000128f0: 3220 3435 6120 3739 2729 5d0a 0a20 2020  2 45a 79')]..   
+00012900: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00012910: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00012920: 7472 696d 2229 0a20 2020 2074 203d 205f  trim").    t = _
+00012930: 746f 5f63 6f6c 5f69 665f 7374 7228 7472  to_col_if_str(tr
+00012940: 696d 5f73 7472 696e 672c 2022 7472 696d  im_string, "trim
+00012950: 2229 2069 6620 7472 696d 5f73 7472 696e  ") if trim_strin
+00012960: 6720 6973 206e 6f74 204e 6f6e 6520 656c  g is not None el
+00012970: 7365 204e 6f6e 650a 2020 2020 7265 7475  se None.    retu
+00012980: 726e 2062 7569 6c74 696e 2822 7472 696d  rn builtin("trim
+00012990: 2229 2863 2c20 7429 2069 6620 7420 6973  ")(c, t) if t is
+000129a0: 206e 6f74 204e 6f6e 6520 656c 7365 2062   not None else b
+000129b0: 7569 6c74 696e 2822 7472 696d 2229 2863  uiltin("trim")(c
+000129c0: 290a 0a0a 6465 6620 7570 7065 7228 653a  )...def upper(e:
+000129d0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000129e0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000129f0: 2252 6574 7572 6e73 2074 6865 2069 6e70  "Returns the inp
+00012a00: 7574 2073 7472 696e 6720 7769 7468 2061  ut string with a
+00012a10: 6c6c 2063 6861 7261 6374 6572 7320 636f  ll characters co
+00012a20: 6e76 6572 7465 6420 746f 2075 7070 6572  nverted to upper
+00012a30: 6361 7365 2e0a 2020 2020 2020 2055 6e69  case..       Uni
+00012a40: 636f 6465 2063 6861 7261 6374 6572 7320  code characters 
+00012a50: 6172 6520 7375 7070 6f72 7465 642e 0a0a  are supported...
+00012a60: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00012a70: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00012a80: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00012a90: 6174 6166 7261 6d65 285b 2761 6263 272c  ataframe(['abc',
+00012aa0: 2027 4162 6327 2c20 2761 4243 272c 2027   'Abc', 'aBC', '
+00012ab0: 416e 66c3 bc68 7275 6e67 737a 6569 6368  Anf..hrungszeich
+00012ac0: 656e 272c 2027 3134 2e39 3520 e282 ac27  en', '14.95 ...'
+00012ad0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00012ae0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00012af0: 7365 6c65 6374 2875 7070 6572 2863 6f6c  select(upper(col
+00012b00: 2822 6122 2929 292e 636f 6c6c 6563 7428  ("a"))).collect(
+00012b10: 290a 2020 2020 2020 2020 5b52 6f77 2855  ).        [Row(U
+00012b20: 5050 4552 2822 4122 293d 2741 4243 2729  PPER("A")='ABC')
+00012b30: 2c20 526f 7728 5550 5045 5228 2241 2229  , Row(UPPER("A")
+00012b40: 3d27 4142 4327 292c 2052 6f77 2855 5050  ='ABC'), Row(UPP
+00012b50: 4552 2822 4122 293d 2741 4243 2729 2c20  ER("A")='ABC'), 
+00012b60: 526f 7728 5550 5045 5228 2241 2229 3d27  Row(UPPER("A")='
+00012b70: 414e 46c3 9c48 5255 4e47 535a 4549 4348  ANF..HRUNGSZEICH
+00012b80: 454e 2729 2c20 526f 7728 5550 5045 5228  EN'), Row(UPPER(
+00012b90: 2241 2229 3d27 3134 2e39 3520 e282 ac27  "A")='14.95 ...'
+00012ba0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+00012bb0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00012bc0: 7228 652c 2022 7570 7065 7222 290a 2020  r(e, "upper").  
+00012bd0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00012be0: 2822 7570 7065 7222 2928 6329 0a0a 0a64  ("upper")(c)...d
+00012bf0: 6566 2073 7472 746f 6b5f 746f 5f61 7272  ef strtok_to_arr
+00012c00: 6179 280a 2020 2020 7465 7874 3a20 436f  ay(.    text: Co
+00012c10: 6c75 6d6e 4f72 4e61 6d65 2c20 6465 6c69  lumnOrName, deli
+00012c20: 6d69 7465 723a 204f 7074 696f 6e61 6c5b  miter: Optional[
+00012c30: 436f 6c75 6d6e 4f72 4e61 6d65 5d20 3d20  ColumnOrName] = 
+00012c40: 4e6f 6e65 0a29 202d 3e20 436f 6c75 6d6e  None.) -> Column
+00012c50: 3a0a 2020 2020 2222 220a 2020 2020 546f  :.    """.    To
+00012c60: 6b65 6e69 7a65 7320 7468 6520 6769 7665  kenizes the give
+00012c70: 6e20 7374 7269 6e67 2075 7369 6e67 2074  n string using t
+00012c80: 6865 2067 6976 656e 2073 6574 206f 6620  he given set of 
+00012c90: 6465 6c69 6d69 7465 7273 2061 6e64 2072  delimiters and r
+00012ca0: 6574 7572 6e73 2074 6865 2074 6f6b 656e  eturns the token
+00012cb0: 7320 6173 2061 6e20 6172 7261 792e 0a0a  s as an array...
+00012cc0: 2020 2020 4966 2065 6974 6865 7220 7061      If either pa
+00012cd0: 7261 6d65 7465 7220 6973 2061 204e 554c  rameter is a NUL
+00012ce0: 4c2c 2061 204e 554c 4c20 6973 2072 6574  L, a NULL is ret
+00012cf0: 7572 6e65 642e 2041 6e20 656d 7074 7920  urned. An empty 
+00012d00: 6172 7261 7920 6973 2072 6574 7572 6e65  array is returne
+00012d10: 6420 6966 2074 6f6b 656e 697a 6174 696f  d if tokenizatio
+00012d20: 6e20 7072 6f64 7563 6573 206e 6f20 746f  n produces no to
+00012d30: 6b65 6e73 2e0a 0a20 2020 2045 7861 6d70  kens...    Examp
+00012d40: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00012d50: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00012d60: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00012d70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00012d80: 5b5b 2261 2e62 2e63 222c 2022 2e22 5d2c  [["a.b.c", "."],
+00012d90: 205b 2231 2c32 2e33 222c 2022 2c22 5d5d   ["1,2.3", ","]]
+00012da0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00012db0: 2020 7363 6865 6d61 3d5b 2274 6578 7422    schema=["text"
+00012dc0: 2c20 2264 656c 696d 6974 6572 225d 2c0a  , "delimiter"],.
+00012dd0: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+00012de0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00012df0: 6563 7428 7374 7274 6f6b 5f74 6f5f 6172  ect(strtok_to_ar
+00012e00: 7261 7928 2274 6578 7422 2c20 2264 656c  ray("text", "del
+00012e10: 696d 6974 6572 2229 2e61 6c69 6173 2822  imiter").alias("
+00012e20: 5449 4d45 5f46 524f 4d5f 5041 5254 5322  TIME_FROM_PARTS"
+00012e30: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00012e40: 2020 2020 205b 526f 7728 5449 4d45 5f46       [Row(TIME_F
+00012e50: 524f 4d5f 5041 5254 533d 275b 5c5c 6e20  ROM_PARTS='[\\n 
+00012e60: 2022 6122 2c5c 5c6e 2020 2262 222c 5c5c   "a",\\n  "b",\\
+00012e70: 6e20 2022 6322 5c5c 6e5d 2729 2c20 526f  n  "c"\\n]'), Ro
+00012e80: 7728 5449 4d45 5f46 524f 4d5f 5041 5254  w(TIME_FROM_PART
+00012e90: 533d 275b 5c5c 6e20 2022 3122 2c5c 5c6e  S='[\\n  "1",\\n
+00012ea0: 2020 2232 2e33 225c 5c6e 5d27 295d 0a20    "2.3"\\n]')]. 
+00012eb0: 2020 2022 2222 0a20 2020 2074 203d 205f     """.    t = _
+00012ec0: 746f 5f63 6f6c 5f69 665f 7374 7228 7465  to_col_if_str(te
+00012ed0: 7874 2c20 2273 7472 746f 6b5f 746f 5f61  xt, "strtok_to_a
+00012ee0: 7272 6179 2229 0a20 2020 2064 203d 2028  rray").    d = (
+00012ef0: 0a20 2020 2020 2020 205f 746f 5f63 6f6c  .        _to_col
+00012f00: 5f69 665f 7374 7228 6465 6c69 6d69 7465  _if_str(delimite
+00012f10: 722c 2022 7374 7274 6f6b 5f74 6f5f 6172  r, "strtok_to_ar
+00012f20: 7261 7922 290a 2020 2020 2020 2020 6966  ray").        if
+00012f30: 2028 6465 6c69 6d69 7465 7220 6973 206e   (delimiter is n
+00012f40: 6f74 204e 6f6e 6529 0a20 2020 2020 2020  ot None).       
+00012f50: 2065 6c73 6520 4e6f 6e65 0a20 2020 2029   else None.    )
+00012f60: 0a20 2020 2072 6574 7572 6e20 280a 2020  .    return (.  
+00012f70: 2020 2020 2020 6275 696c 7469 6e28 2273        builtin("s
+00012f80: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
+00012f90: 2874 2c20 6429 0a20 2020 2020 2020 2069  (t, d).        i
+00012fa0: 6620 2864 656c 696d 6974 6572 2069 7320  f (delimiter is 
+00012fb0: 6e6f 7420 4e6f 6e65 290a 2020 2020 2020  not None).      
+00012fc0: 2020 656c 7365 2062 7569 6c74 696e 2822    else builtin("
+00012fd0: 7374 7274 6f6b 5f74 6f5f 6172 7261 7922  strtok_to_array"
+00012fe0: 2928 7429 0a20 2020 2029 0a0a 0a64 6566  )(t).    )...def
+00012ff0: 2073 7472 7563 7428 2a63 6f6c 733a 2043   struct(*cols: C
+00013000: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00013010: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00013020: 2020 2020 5265 7475 726e 7320 616e 204f      Returns an O
+00013030: 424a 4543 5420 636f 6e73 7472 7563 7465  BJECT constructe
+00013040: 6420 7769 7468 2074 6865 2067 6976 656e  d with the given
+00013050: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2045   columns...    E
+00013060: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+00013070: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00013080: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+00013090: 6374 696f 6e73 2069 6d70 6f72 7420 7374  ctions import st
+000130a0: 7275 6374 0a20 2020 2020 2020 203e 3e3e  ruct.        >>>
+000130b0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000130c0: 6561 7465 4461 7461 4672 616d 6528 5b28  eateDataFrame([(
+000130d0: 2242 6f62 222c 2038 3029 2c20 2822 416c  "Bob", 80), ("Al
+000130e0: 6963 6522 2c20 4e6f 6e65 295d 2c20 5b22  ice", None)], ["
+000130f0: 6e61 6d65 222c 2022 6167 6522 5d29 0a20  name", "age"]). 
+00013100: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00013110: 2064 662e 7365 6c65 6374 2873 7472 7563   df.select(struc
+00013120: 7428 2261 6765 222c 2022 6e61 6d65 2229  t("age", "name")
+00013130: 2e61 6c69 6173 2822 7374 7275 6374 2229  .alias("struct")
+00013140: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00013150: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00013160: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00013170: 2253 5452 5543 5422 2020 2020 2020 2020  "STRUCT"        
+00013180: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00013190: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000131a0: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
+000131b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000131c0: 0a20 2020 2020 2020 207c 2020 2261 6765  .        |  "age
+000131d0: 223a 2038 302c 2020 2020 2020 207c 0a20  ": 80,       |. 
+000131e0: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
+000131f0: 3a20 2242 6f62 2220 2020 207c 0a20 2020  : "Bob"    |.   
+00013200: 2020 2020 207c 7d20 2020 2020 2020 2020       |}         
+00013210: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00013220: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
+00013230: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00013240: 207c 2020 2261 6765 223a 206e 756c 6c2c   |  "age": null,
+00013250: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00013260: 2020 226e 616d 6522 3a20 2241 6c69 6365    "name": "Alice
+00013270: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
+00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013290: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000132a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000132b0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+000132c0: 494e 453e 0a20 2020 2022 2222 0a0a 2020  INE>.    """..  
+000132d0: 2020 6465 6620 666c 6174 7465 6e5f 636f    def flatten_co
+000132e0: 6c5f 6c69 7374 286f 626a 293a 0a20 2020  l_list(obj):.   
+000132f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00013300: 6365 286f 626a 2c20 7374 7229 206f 7220  ce(obj, str) or 
+00013310: 6973 696e 7374 616e 6365 286f 626a 2c20  isinstance(obj, 
+00013320: 436f 6c75 6d6e 293a 0a20 2020 2020 2020  Column):.       
+00013330: 2020 2020 2072 6574 7572 6e20 5b6f 626a       return [obj
+00013340: 5d0a 2020 2020 2020 2020 656c 6966 2068  ].        elif h
+00013350: 6173 6174 7472 286f 626a 2c20 225f 5f69  asattr(obj, "__i
+00013360: 7465 725f 5f22 293a 0a20 2020 2020 2020  ter__"):.       
+00013370: 2020 2020 2061 6363 203d 205b 5d0a 2020       acc = [].  
+00013380: 2020 2020 2020 2020 2020 666f 7220 696e            for in
+00013390: 6e65 724f 626a 2069 6e20 6f62 6a3a 0a20  nerObj in obj:. 
+000133a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000133b0: 6363 203d 2061 6363 202b 2066 6c61 7474  cc = acc + flatt
+000133c0: 656e 5f63 6f6c 5f6c 6973 7428 696e 6e65  en_col_list(inne
+000133d0: 724f 626a 290a 2020 2020 2020 2020 2020  rObj).          
+000133e0: 2020 7265 7475 726e 2061 6363 0a0a 2020    return acc..  
+000133f0: 2020 6e65 775f 636f 6c73 203d 205b 5d0a    new_cols = [].
+00013400: 2020 2020 666f 7220 6320 696e 2066 6c61      for c in fla
+00013410: 7474 656e 5f63 6f6c 5f6c 6973 7428 636f  tten_col_list(co
+00013420: 6c73 293a 0a20 2020 2020 2020 2023 2066  ls):.        # f
+00013430: 6972 7374 2069 6e73 6572 7420 6669 656c  irst insert fiel
+00013440: 645f 6e61 6d65 0a20 2020 2020 2020 2069  d_name.        i
+00013450: 6620 6973 696e 7374 616e 6365 2863 2c20  f isinstance(c, 
+00013460: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+00013470: 2020 6e65 775f 636f 6c73 2e61 7070 656e    new_cols.appen
+00013480: 6428 6c69 7428 6329 290a 2020 2020 2020  d(lit(c)).      
+00013490: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000134a0: 2020 2020 6e61 6d65 203d 2063 2e5f 6578      name = c._ex
+000134b0: 7072 6573 7369 6f6e 2e6e 616d 650a 2020  pression.name.  
+000134c0: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
+000134d0: 206e 616d 655b 313a 5d20 6966 206e 616d   name[1:] if nam
+000134e0: 652e 7374 6172 7473 7769 7468 2827 2227  e.startswith('"'
+000134f0: 2920 656c 7365 206e 616d 650a 2020 2020  ) else name.    
+00013500: 2020 2020 2020 2020 6e61 6d65 203d 206e          name = n
+00013510: 616d 655b 3a2d 315d 2069 6620 6e61 6d65  ame[:-1] if name
+00013520: 2e65 6e64 7377 6974 6828 2722 2729 2065  .endswith('"') e
+00013530: 6c73 6520 6e61 6d65 0a20 2020 2020 2020  lse name.       
+00013540: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
+00013550: 7065 6e64 286c 6974 286e 616d 6529 290a  pend(lit(name)).
+00013560: 2020 2020 2020 2020 2320 6e65 7874 2069          # next i
+00013570: 6e73 6572 7420 6669 656c 6420 7661 6c75  nsert field valu
+00013580: 650a 2020 2020 2020 2020 6320 3d20 5f74  e.        c = _t
+00013590: 6f5f 636f 6c5f 6966 5f73 7472 2863 2c20  o_col_if_str(c, 
+000135a0: 2273 7472 7563 7422 290a 2020 2020 2020  "struct").      
+000135b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000135c0: 632c 2043 6f6c 756d 6e29 2061 6e64 2069  c, Column) and i
+000135d0: 7369 6e73 7461 6e63 6528 632e 5f65 7870  sinstance(c._exp
+000135e0: 7265 7373 696f 6e2c 2041 6c69 6173 293a  ression, Alias):
+000135f0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00013600: 5f63 6f6c 732e 6170 7065 6e64 2863 6f6c  _cols.append(col
+00013610: 2863 2e5f 6578 7072 6573 7369 6f6e 2e63  (c._expression.c
+00013620: 6869 6c64 7265 6e5b 305d 2929 0a20 2020  hildren[0])).   
+00013630: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00013640: 2020 2020 2020 206e 6577 5f63 6f6c 732e         new_cols.
+00013650: 6170 7065 6e64 2863 290a 2020 2020 7265  append(c).    re
+00013660: 7475 726e 206f 626a 6563 745f 636f 6e73  turn object_cons
+00013670: 7472 7563 745f 6b65 6570 5f6e 756c 6c28  truct_keep_null(
+00013680: 2a6e 6577 5f63 6f6c 7329 0a0a 0a64 6566  *new_cols)...def
+00013690: 206c 6f67 280a 2020 2020 6261 7365 3a20   log(.    base: 
+000136a0: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+000136b0: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
+000136c0: 2078 3a20 556e 696f 6e5b 436f 6c75 6d6e   x: Union[Column
+000136d0: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
+000136e0: 6174 5d0a 2920 2d3e 2043 6f6c 756d 6e3a  at].) -> Column:
+000136f0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00013700: 7572 6e73 2074 6865 206c 6f67 6172 6974  urns the logarit
+00013710: 686d 206f 6620 6120 6e75 6d65 7269 6320  hm of a numeric 
+00013720: 6578 7072 6573 7369 6f6e 2e0a 0a20 2020  expression...   
+00013730: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00013740: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00013750: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00013760: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
+00013770: 6567 6572 5479 7065 0a20 2020 2020 2020  egerType.       
+00013780: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00013790: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+000137a0: 6d65 285b 312c 2031 305d 2c20 7363 6865  me([1, 10], sche
+000137b0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+000137c0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000137d0: 6c6f 6728 3130 2c20 6466 5b22 6122 5d29  log(10, df["a"])
+000137e0: 2e63 6173 7428 496e 7465 6765 7254 7970  .cast(IntegerTyp
+000137f0: 6528 2929 2e61 6c69 6173 2822 6c6f 6722  e()).alias("log"
+00013800: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00013810: 2020 2020 205b 526f 7728 4c4f 473d 3029       [Row(LOG=0)
+00013820: 2c20 526f 7728 4c4f 473d 3129 5d0a 2020  , Row(LOG=1)].  
+00013830: 2020 2222 220a 2020 2020 6220 3d20 6c69    """.    b = li
+00013840: 7428 6261 7365 2920 6966 2069 7369 6e73  t(base) if isins
+00013850: 7461 6e63 6528 6261 7365 2c20 2869 6e74  tance(base, (int
+00013860: 2c20 666c 6f61 7429 2920 656c 7365 205f  , float)) else _
+00013870: 746f 5f63 6f6c 5f69 665f 7374 7228 6261  to_col_if_str(ba
+00013880: 7365 2c20 226c 6f67 2229 0a20 2020 2061  se, "log").    a
+00013890: 7267 203d 206c 6974 2878 2920 6966 2069  rg = lit(x) if i
+000138a0: 7369 6e73 7461 6e63 6528 782c 2028 696e  sinstance(x, (in
+000138b0: 742c 2066 6c6f 6174 2929 2065 6c73 6520  t, float)) else 
+000138c0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2878  _to_col_if_str(x
+000138d0: 2c20 226c 6f67 2229 0a20 2020 2072 6574  , "log").    ret
+000138e0: 7572 6e20 6275 696c 7469 6e28 226c 6f67  urn builtin("log
+000138f0: 2229 2862 2c20 6172 6729 0a0a 0a64 6566  ")(b, arg)...def
+00013900: 2070 6f77 280a 2020 2020 6c65 6674 3a20   pow(.    left: 
+00013910: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+00013920: 6d65 2c20 696e 742c 2066 6c6f 6174 5d2c  me, int, float],
+00013930: 2072 6967 6874 3a20 556e 696f 6e5b 436f   right: Union[Co
+00013940: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 742c  lumnOrName, int,
+00013950: 2066 6c6f 6174 5d0a 2920 2d3e 2043 6f6c   float].) -> Col
+00013960: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00013970: 726e 7320 6120 6e75 6d62 6572 2028 6c65  rns a number (le
+00013980: 6674 2920 7261 6973 6564 2074 6f20 7468  ft) raised to th
+00013990: 6520 7370 6563 6966 6965 6420 706f 7765  e specified powe
+000139a0: 7220 2872 6967 6874 292e 0a0a 2020 2020  r (right)...    
+000139b0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+000139c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000139d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000139e0: 616d 6528 5b5b 322c 2033 5d2c 205b 332c  ame([[2, 3], [3,
+000139f0: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2278   4]], schema=["x
+00013a00: 222c 2022 7922 5d29 0a20 2020 2020 2020  ", "y"]).       
+00013a10: 203e 3e3e 2064 662e 7365 6c65 6374 2870   >>> df.select(p
+00013a20: 6f77 2863 6f6c 2822 7822 292c 2063 6f6c  ow(col("x"), col
+00013a30: 2822 7922 2929 2e61 6c69 6173 2822 7265  ("y")).alias("re
+00013a40: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00013a50: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00013a60: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00013a70: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00013a80: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00013a90: 2020 2020 2020 7c38 2e30 2020 2020 2020        |8.0      
+00013aa0: 207c 0a20 2020 2020 2020 207c 3831 2e30   |.        |81.0
+00013ab0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00013ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00013ad0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+00013ae0: 0a20 2020 2022 2222 0a20 2020 206e 756d  .    """.    num
+00013af0: 6265 7220 3d20 280a 2020 2020 2020 2020  ber = (.        
+00013b00: 6c69 7428 6c65 6674 2920 6966 2069 7369  lit(left) if isi
+00013b10: 6e73 7461 6e63 6528 6c65 6674 2c20 2869  nstance(left, (i
+00013b20: 6e74 2c20 666c 6f61 7429 2920 656c 7365  nt, float)) else
+00013b30: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00013b40: 6c65 6674 2c20 2270 6f77 2229 0a20 2020  left, "pow").   
+00013b50: 2029 0a20 2020 2070 6f77 6572 203d 2028   ).    power = (
+00013b60: 0a20 2020 2020 2020 206c 6974 2872 6967  .        lit(rig
+00013b70: 6874 2920 6966 2069 7369 6e73 7461 6e63  ht) if isinstanc
+00013b80: 6528 7269 6768 742c 2028 696e 742c 2066  e(right, (int, f
+00013b90: 6c6f 6174 2929 2065 6c73 6520 5f74 6f5f  loat)) else _to_
+00013ba0: 636f 6c5f 6966 5f73 7472 2872 6967 6874  col_if_str(right
+00013bb0: 2c20 2270 6f77 2229 0a20 2020 2029 0a20  , "pow").    ). 
+00013bc0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+00013bd0: 6e28 2270 6f77 2229 286e 756d 6265 722c  n("pow")(number,
+00013be0: 2070 6f77 6572 290a 0a0a 6465 6620 726f   power)...def ro
+00013bf0: 756e 6428 653a 2043 6f6c 756d 6e4f 724e  und(e: ColumnOrN
+00013c00: 616d 652c 2073 6361 6c65 3a20 556e 696f  ame, scale: Unio
+00013c10: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00013c20: 696e 742c 2066 6c6f 6174 5d20 3d20 3029  int, float] = 0)
+00013c30: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00013c40: 2222 2252 6574 7572 6e73 2072 6f75 6e64  """Returns round
+00013c50: 6564 2076 616c 7565 7320 6672 6f6d 2074  ed values from t
+00013c60: 6865 2073 7065 6369 6669 6564 2063 6f6c  he specified col
+00013c70: 756d 6e2e 0a0a 2020 2020 4578 616d 706c  umn...    Exampl
+00013c80: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00013c90: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00013ca0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00013cb0: 5b31 2e31 315d 2c20 5b32 2e32 325d 2c20  [1.11], [2.22], 
+00013cc0: 5b33 2e33 335d 5d2c 2073 6368 656d 613d  [3.33]], schema=
+00013cd0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00013ce0: 3e3e 2064 662e 7365 6c65 6374 2872 6f75  >> df.select(rou
+00013cf0: 6e64 2863 6f6c 2822 6122 2929 2e61 6c69  nd(col("a")).ali
+00013d00: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+00013d10: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00013d20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00013d30: 2020 7c22 5245 5355 4c54 2220 207c 0a20    |"RESULT"  |. 
+00013d40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00013d50: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e30  ---.        |1.0
+00013d60: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00013d70: 207c 322e 3020 2020 2020 2020 7c0a 2020   |2.0       |.  
+00013d80: 2020 2020 2020 7c33 2e30 2020 2020 2020        |3.0      
+00013d90: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00013da0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00013db0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+00013dc0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00013dd0: 636f 6c5f 6966 5f73 7472 2865 2c20 2272  col_if_str(e, "r
+00013de0: 6f75 6e64 2229 0a20 2020 2073 6361 6c65  ound").    scale
+00013df0: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
+00013e00: 206c 6974 2873 6361 6c65 290a 2020 2020   lit(scale).    
+00013e10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00013e20: 6528 7363 616c 652c 2028 696e 742c 2066  e(scale, (int, f
+00013e30: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
+00013e40: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+00013e50: 7472 2873 6361 6c65 2c20 2272 6f75 6e64  tr(scale, "round
+00013e60: 2229 0a20 2020 2029 0a20 2020 2072 6574  ").    ).    ret
+00013e70: 7572 6e20 6275 696c 7469 6e28 2272 6f75  urn builtin("rou
+00013e80: 6e64 2229 2863 2c20 7363 616c 655f 636f  nd")(c, scale_co
+00013e90: 6c29 0a0a 0a64 6566 2073 706c 6974 280a  l)...def split(.
+00013ea0: 2020 2020 7374 723a 2043 6f6c 756d 6e4f      str: ColumnO
+00013eb0: 724e 616d 652c 0a20 2020 2070 6174 7465  rName,.    patte
+00013ec0: 726e 3a20 436f 6c75 6d6e 4f72 4e61 6d65  rn: ColumnOrName
+00013ed0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+00013ee0: 2020 2022 2222 5370 6c69 7473 2061 2067     """Splits a g
+00013ef0: 6976 656e 2073 7472 696e 6720 7769 7468  iven string with
+00013f00: 2061 2067 6976 656e 2073 6570 6172 6174   a given separat
+00013f10: 6f72 2061 6e64 2072 6574 7572 6e73 2074  or and returns t
+00013f20: 6865 2072 6573 756c 7420 696e 2061 6e20  he result in an 
+00013f30: 6172 7261 790a 2020 2020 6f66 2073 7472  array.    of str
+00013f40: 696e 6773 2e20 546f 2073 7065 6369 6679  ings. To specify
+00013f50: 2061 2073 7472 696e 6720 7365 7061 7261   a string separa
+00013f60: 746f 722c 2075 7365 2074 6865 203a 6675  tor, use the :fu
+00013f70: 6e63 3a60 6c69 7428 2960 2066 756e 6374  nc:`lit()` funct
+00013f80: 696f 6e2e 0a0a 2020 2020 4578 616d 706c  ion...    Exampl
+00013f90: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00013fa0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00013fb0: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
+00013fc0: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
+00013fd0: 5b22 6d61 6e79 2d6d 616e 792d 776f 7264  ["many-many-word
+00013fe0: 7322 2c20 222d 225d 2c20 5b22 6865 6c6c  s", "-"], ["hell
+00013ff0: 6f2d 2d68 656c 6c6f 222c 2022 2d2d 225d  o--hello", "--"]
+00014000: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+00014010: 2020 2073 6368 656d 613d 5b22 5622 2c20     schema=["V", 
+00014020: 2244 225d 2c0a 2020 2020 2020 2020 2e2e  "D"],.        ..
+00014030: 2e20 292e 7365 6c65 6374 2873 706c 6974  . ).select(split
+00014040: 2863 6f6c 2822 5622 292c 2063 6f6c 2822  (col("V"), col("
+00014050: 4422 2929 290a 2020 2020 2020 2020 3e3e  D"))).        >>
+00014060: 3e20 6466 2e73 686f 7728 290a 2020 2020  > df.show().    
+00014070: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00014080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00014090: 2020 2020 2020 7c22 5350 4c49 5428 2222        |"SPLIT(""
+000140a0: 5622 222c 2022 2244 2222 2922 2020 7c0a  V"", ""D"")"  |.
+000140b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000140c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000140d0: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
+000140e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140f0: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+00014100: 6d61 6e79 222c 2020 2020 2020 2020 2020  many",          
+00014110: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00014120: 2022 6d61 6e79 222c 2020 2020 2020 2020   "many",        
+00014130: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00014140: 7c20 2022 776f 7264 7322 2020 2020 2020  |  "words"      
+00014150: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00014160: 2020 7c5d 2020 2020 2020 2020 2020 2020    |]            
+00014170: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00014180: 2020 2020 7c5b 2020 2020 2020 2020 2020      |[          
+00014190: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+000141a0: 2020 2020 2020 7c20 2022 6865 6c6c 6f22        |  "hello"
+000141b0: 2c20 2020 2020 2020 2020 2020 2020 7c0a  ,             |.
+000141c0: 2020 2020 2020 2020 7c20 2022 6865 6c6c          |  "hell
+000141d0: 6f22 2020 2020 2020 2020 2020 2020 2020  o"              
+000141e0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+000141f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014200: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00014210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00014220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00014230: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+00014240: 220a 2020 2020 7320 3d20 5f74 6f5f 636f  ".    s = _to_co
+00014250: 6c5f 6966 5f73 7472 2873 7472 2c20 2273  l_if_str(str, "s
+00014260: 706c 6974 2229 0a20 2020 2070 203d 205f  plit").    p = _
+00014270: 746f 5f63 6f6c 5f69 665f 7374 7228 7061  to_col_if_str(pa
+00014280: 7474 6572 6e2c 2022 7370 6c69 7422 290a  ttern, "split").
+00014290: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+000142a0: 696e 2822 7370 6c69 7422 2928 732c 2070  in("split")(s, p
+000142b0: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
+000142c0: 6728 0a20 2020 2073 7472 3a20 436f 6c75  g(.    str: Colu
+000142d0: 6d6e 4f72 4e61 6d65 2c20 706f 733a 2055  mnOrName, pos: U
+000142e0: 6e69 6f6e 5b43 6f6c 756d 6e2c 2069 6e74  nion[Column, int
+000142f0: 5d2c 206c 656e 3a20 556e 696f 6e5b 436f  ], len: Union[Co
+00014300: 6c75 6d6e 2c20 696e 745d 0a29 202d 3e20  lumn, int].) -> 
+00014310: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00014320: 6574 7572 6e73 2074 6865 2070 6f72 7469  eturns the porti
+00014330: 6f6e 206f 6620 7468 6520 7374 7269 6e67  on of the string
+00014340: 206f 7220 6269 6e61 7279 2076 616c 7565   or binary value
+00014350: 2073 7472 2c20 7374 6172 7469 6e67 2066   str, starting f
+00014360: 726f 6d20 7468 650a 2020 2020 6368 6172  rom the.    char
+00014370: 6163 7465 722f 6279 7465 2073 7065 6369  acter/byte speci
+00014380: 6669 6564 2062 7920 706f 732c 2077 6974  fied by pos, wit
+00014390: 6820 6c69 6d69 7465 6420 6c65 6e67 7468  h limited length
+000143a0: 2e20 5468 6520 6c65 6e67 7468 2073 686f  . The length sho
+000143b0: 756c 6420 6265 2067 7265 6174 6572 0a20  uld be greater. 
+000143c0: 2020 2074 6861 6e20 6f72 2065 7175 616c     than or equal
+000143d0: 2074 6f20 7a65 726f 2e20 4966 2074 6865   to zero. If the
+000143e0: 206c 656e 6774 6820 6973 2061 206e 6567   length is a neg
+000143f0: 6174 6976 6520 6e75 6d62 6572 2c20 7468  ative number, th
+00014400: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+00014410: 6e73 2061 6e0a 2020 2020 656d 7074 7920  ns an.    empty 
+00014420: 7374 7269 6e67 2e0a 0a20 2020 204e 6f74  string...    Not
+00014430: 653a 0a20 2020 2020 2020 2046 6f72 2060  e:.        For `
+00014440: 6070 6f73 6060 2c20 3120 6973 2074 6865  `pos``, 1 is the
+00014450: 2066 6972 7374 2063 6861 7261 6374 6572   first character
+00014460: 206f 6620 7468 6520 7374 7269 6e67 2069   of the string i
+00014470: 6e20 536e 6f77 666c 616b 6520 6461 7461  n Snowflake data
+00014480: 6261 7365 2e0a 0a20 2020 203a 6675 6e63  base...    :func
+00014490: 3a60 7375 6273 7472 6020 6973 2061 6e20  :`substr` is an 
+000144a0: 616c 6961 7320 6f66 203a 6675 6e63 3a60  alias of :func:`
+000144b0: 7375 6273 7472 696e 6760 2e0a 0a20 2020  substring`...   
+000144c0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+000144d0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000144e0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000144f0: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00014500: 2e20 2020 2020 5b22 6162 6322 2c20 2264  .     ["abc", "d
+00014510: 6566 225d 2c0a 2020 2020 2020 2020 2e2e  ef"],.        ..
+00014520: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
+00014530: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
+00014540: 292e 7365 6c65 6374 2873 7562 7374 7269  ).select(substri
+00014550: 6e67 2863 6f6c 2822 5322 292c 2031 2c20  ng(col("S"), 1, 
+00014560: 3129 290a 2020 2020 2020 2020 3e3e 3e20  1)).        >>> 
+00014570: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+00014580: 2020 2020 205b 526f 7728 5355 4253 5452       [Row(SUBSTR
+00014590: 494e 4728 2253 222c 2031 2c20 3129 3d27  ING("S", 1, 1)='
+000145a0: 6127 292c 2052 6f77 2853 5542 5354 5249  a'), Row(SUBSTRI
+000145b0: 4e47 2822 5322 2c20 312c 2031 293d 2764  NG("S", 1, 1)='d
+000145c0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+000145d0: 7320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  s = _to_col_if_s
+000145e0: 7472 2873 7472 2c20 2273 7562 7374 7269  tr(str, "substri
+000145f0: 6e67 2229 0a20 2020 2070 203d 2070 6f73  ng").    p = pos
+00014600: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
+00014610: 6f73 2c20 436f 6c75 6d6e 2920 656c 7365  os, Column) else
+00014620: 206c 6974 2870 6f73 290a 2020 2020 6c65   lit(pos).    le
+00014630: 6e67 7468 203d 206c 656e 2069 6620 6973  ngth = len if is
+00014640: 696e 7374 616e 6365 286c 656e 2c20 436f  instance(len, Co
+00014650: 6c75 6d6e 2920 656c 7365 206c 6974 286c  lumn) else lit(l
+00014660: 656e 290a 2020 2020 7265 7475 726e 2062  en).    return b
+00014670: 7569 6c74 696e 2822 7375 6273 7472 696e  uiltin("substrin
+00014680: 6722 2928 732c 2070 2c20 6c65 6e67 7468  g")(s, p, length
+00014690: 290a 0a0a 6465 6620 7375 6273 7472 696e  )...def substrin
+000146a0: 675f 696e 6465 7828 0a20 2020 2074 6578  g_index(.    tex
+000146b0: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
+000146c0: 2064 656c 696d 3a20 436f 6c75 6d6e 4f72   delim: ColumnOr
+000146d0: 4c69 7465 7261 6c53 7472 2c20 636f 756e  LiteralStr, coun
+000146e0: 743a 2069 6e74 0a29 202d 3e20 436f 6c75  t: int.) -> Colu
+000146f0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00014700: 5265 7475 726e 7320 7468 6520 7375 6273  Returns the subs
+00014710: 7472 696e 6720 6672 6f6d 2073 7472 696e  tring from strin
+00014720: 6720 6060 7465 7874 6060 2062 6566 6f72  g ``text`` befor
+00014730: 6520 6060 636f 756e 7460 6020 6f63 6375  e ``count`` occu
+00014740: 7272 656e 6365 7320 6f66 2074 6865 2064  rrences of the d
+00014750: 656c 696d 6974 6572 2060 6064 656c 696d  elimiter ``delim
+00014760: 6060 2e0a 2020 2020 4966 2060 6063 6f75  ``..    If ``cou
+00014770: 6e74 6060 2069 7320 706f 7369 7469 7665  nt`` is positive
+00014780: 2c20 6576 6572 7974 6869 6e67 2074 6f20  , everything to 
+00014790: 7468 6520 6c65 6674 206f 6620 7468 6520  the left of the 
+000147a0: 6669 6e61 6c20 6465 6c69 6d69 7465 7220  final delimiter 
+000147b0: 2863 6f75 6e74 696e 6720 6672 6f6d 206c  (counting from l
+000147c0: 6566 7429 2069 730a 2020 2020 7265 7475  eft) is.    retu
+000147d0: 726e 6564 2e20 4966 2060 6063 6f75 6e74  rned. If ``count
+000147e0: 6060 2069 7320 6e65 6761 7469 7665 2c20  `` is negative, 
+000147f0: 6576 6572 7974 6869 6e67 2074 6f20 7468  everything to th
+00014800: 6520 7269 6768 7420 6f66 2074 6865 2066  e right of the f
+00014810: 696e 616c 2064 656c 696d 6974 6572 2028  inal delimiter (
+00014820: 636f 756e 7469 6e67 2066 726f 6d20 7468  counting from th
+00014830: 650a 2020 2020 7269 6768 7429 2069 7320  e.    right) is 
+00014840: 7265 7475 726e 6564 2e20 4966 2060 6063  returned. If ``c
+00014850: 6f75 6e74 6060 2069 7320 7a65 726f 2c20  ount`` is zero, 
+00014860: 7265 7475 726e 7320 656d 7074 7920 7374  returns empty st
+00014870: 7269 6e67 2e0a 0a20 2020 2045 7861 6d70  ring...    Examp
+00014880: 6c65 2031 3a3a 0a20 2020 2020 2020 203e  le 1::.        >
+00014890: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000148a0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000148b0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+000148c0: 2020 5b22 612e 622e 632e 6422 5d2c 0a20    ["a.b.c.d"],. 
+000148d0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+000148e0: 6368 656d 613d 5b22 5322 5d2c 0a20 2020  chema=["S"],.   
+000148f0: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
+00014900: 7428 7375 6273 7472 696e 675f 696e 6465  t(substring_inde
+00014910: 7828 636f 6c28 2253 2229 2c20 222e 222c  x(col("S"), ".",
+00014920: 2032 292e 616c 6961 7328 2272 6573 756c   2).alias("resul
+00014930: 7422 2929 0a20 2020 2020 2020 203e 3e3e  t")).        >>>
+00014940: 2064 662e 7368 6f77 2829 0a20 2020 2020   df.show().     
+00014950: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00014960: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
+00014970: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00014980: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00014990: 2020 7c61 2e62 2020 2020 2020 207c 0a20    |a.b       |. 
+000149a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000149b0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+000149c0: 4e4b 4c49 4e45 3e0a 0a20 2020 2045 7861  NKLINE>..    Exa
+000149d0: 6d70 6c65 2032 3a3a 0a20 2020 2020 2020  mple 2::.       
+000149e0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+000149f0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00014a00: 6d65 280a 2020 2020 2020 2020 2e2e 2e20  me(.        ... 
+00014a10: 2020 2020 5b5b 2261 2e62 2e63 2e64 222c      [["a.b.c.d",
+00014a20: 2022 2e22 5d5d 2c0a 2020 2020 2020 2020   "."]],.        
+00014a30: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+00014a40: 2253 222c 2022 6465 6c69 6d69 7465 7222  "S", "delimiter"
+00014a50: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+00014a60: 2e73 656c 6563 7428 7375 6273 7472 696e  .select(substrin
+00014a70: 675f 696e 6465 7828 636f 6c28 2253 2229  g_index(col("S")
+00014a80: 2c20 636f 6c28 2264 656c 696d 6974 6572  , col("delimiter
+00014a90: 2229 2c20 3229 2e61 6c69 6173 2822 7265  "), 2).alias("re
+00014aa0: 7375 6c74 2229 290a 2020 2020 2020 2020  sult")).        
+00014ab0: 3e3e 3e20 6466 2e73 686f 7728 290a 2020  >>> df.show().  
+00014ac0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00014ad0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+00014ae0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+00014af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00014b00: 2020 2020 207c 612e 6220 2020 2020 2020       |a.b       
+00014b10: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00014b20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00014b30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00014b40: 2222 0a20 2020 2073 203d 205f 746f 5f63  "".    s = _to_c
+00014b50: 6f6c 5f69 665f 7374 7228 7465 7874 2c20  ol_if_str(text, 
+00014b60: 2273 7562 7374 7269 6e67 5f69 6e64 6578  "substring_index
+00014b70: 2229 0a20 2020 2073 7472 746f 6b5f 6172  ").    strtok_ar
+00014b80: 7261 7920 3d20 6275 696c 7469 6e28 2273  ray = builtin("s
+00014b90: 7472 746f 6b5f 746f 5f61 7272 6179 2229  trtok_to_array")
+00014ba0: 2873 2c20 6465 6c69 6d29 0a20 2020 2072  (s, delim).    r
+00014bb0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+00014bc0: 7272 6179 5f74 6f5f 7374 7269 6e67 2229  rray_to_string")
+00014bd0: 280a 2020 2020 2020 2020 6275 696c 7469  (.        builti
+00014be0: 6e28 2261 7272 6179 5f73 6c69 6365 2229  n("array_slice")
+00014bf0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+00014c00: 7274 6f6b 5f61 7272 6179 2c0a 2020 2020  rtok_array,.    
+00014c10: 2020 2020 2020 2020 3020 6966 2063 6f75          0 if cou
+00014c20: 6e74 203e 3d20 3020 656c 7365 2062 7569  nt >= 0 else bui
+00014c30: 6c74 696e 2822 6172 7261 795f 7369 7a65  ltin("array_size
+00014c40: 2229 2873 7472 746f 6b5f 6172 7261 7929  ")(strtok_array)
+00014c50: 202b 2063 6f75 6e74 2c0a 2020 2020 2020   + count,.      
+00014c60: 2020 2020 2020 636f 756e 7420 6966 2063        count if c
+00014c70: 6f75 6e74 203e 3d20 3020 656c 7365 2062  ount >= 0 else b
+00014c80: 7569 6c74 696e 2822 6172 7261 795f 7369  uiltin("array_si
+00014c90: 7a65 2229 2873 7472 746f 6b5f 6172 7261  ze")(strtok_arra
+00014ca0: 7929 2c0a 2020 2020 2020 2020 292c 0a20  y),.        ),. 
+00014cb0: 2020 2020 2020 2064 656c 696d 2c0a 2020         delim,.  
+00014cc0: 2020 290a 0a0a 6465 6620 7265 6765 7870    )...def regexp
+00014cd0: 5f63 6f75 6e74 280a 2020 2020 7375 626a  _count(.    subj
+00014ce0: 6563 743a 2043 6f6c 756d 6e4f 724e 616d  ect: ColumnOrNam
+00014cf0: 652c 0a20 2020 2070 6174 7465 726e 3a20  e,.    pattern: 
+00014d00: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c53  ColumnOrLiteralS
+00014d10: 7472 2c0a 2020 2020 706f 7369 7469 6f6e  tr,.    position
+00014d20: 3a20 556e 696f 6e5b 436f 6c75 6d6e 2c20  : Union[Column, 
+00014d30: 696e 745d 203d 2031 2c0a 2020 2020 2a70  int] = 1,.    *p
+00014d40: 6172 616d 6574 6572 733a 2043 6f6c 756d  arameters: Colum
+00014d50: 6e4f 724c 6974 6572 616c 2c0a 2920 2d3e  nOrLiteral,.) ->
+00014d60: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00014d70: 5265 7475 726e 7320 7468 6520 6e75 6d62  Returns the numb
+00014d80: 6572 206f 6620 7469 6d65 7320 7468 6174  er of times that
+00014d90: 2061 2070 6174 7465 726e 206f 6363 7572   a pattern occur
+00014da0: 7320 696e 2074 6865 2073 7562 6a65 6374  s in the subject
+00014db0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00014dc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00014dd0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+00014de0: 7365 6c65 6374 202a 2066 726f 6d20 7661  select * from va
+00014df0: 6c75 6573 2827 6170 706c 6527 292c 2827  lues('apple'),('
+00014e00: 6261 6e61 6e61 2729 2c28 2770 6561 6368  banana'),('peach
+00014e10: 2729 2061 7320 5428 6129 2229 0a20 2020  ') as T(a)").   
+00014e20: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00014e30: 6374 2872 6567 6578 705f 636f 756e 7428  ct(regexp_count(
+00014e40: 636f 6c28 2261 2229 2c20 2261 2229 2e61  col("a"), "a").a
+00014e50: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00014e60: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00014e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00014e80: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00014e90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00014ea0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
+00014eb0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00014ec0: 2020 207c 3320 2020 2020 2020 2020 7c0a     |3         |.
+00014ed0: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
+00014ee0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00014ef0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00014f00: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00014f10: 2020 2222 220a 2020 2020 7371 6c5f 6675    """.    sql_fu
+00014f20: 6e63 5f6e 616d 6520 3d20 2272 6567 6578  nc_name = "regex
+00014f30: 705f 636f 756e 7422 0a20 2020 2073 7562  p_count".    sub
+00014f40: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00014f50: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
+00014f60: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
+00014f70: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
+00014f80: 0a20 2020 2070 6f73 203d 206c 6974 2870  .    pos = lit(p
+00014f90: 6f73 6974 696f 6e29 0a0a 2020 2020 7061  osition)..    pa
+00014fa0: 7261 6d73 203d 205b 6c69 7428 7029 2066  rams = [lit(p) f
+00014fb0: 6f72 2070 2069 6e20 7061 7261 6d65 7465  or p in paramete
+00014fc0: 7273 5d0a 2020 2020 7265 7475 726e 2062  rs].    return b
+00014fd0: 7569 6c74 696e 2873 716c 5f66 756e 635f  uiltin(sql_func_
+00014fe0: 6e61 6d65 2928 7375 622c 2070 6174 2c20  name)(sub, pat, 
+00014ff0: 706f 732c 202a 7061 7261 6d73 290a 0a0a  pos, *params)...
+00015000: 6465 6620 7265 6765 7870 5f65 7874 7261  def regexp_extra
+00015010: 6374 280a 2020 2020 7661 6c75 653a 2043  ct(.    value: C
+00015020: 6f6c 756d 6e4f 724c 6974 6572 616c 5374  olumnOrLiteralSt
+00015030: 722c 2072 6567 6578 703a 2043 6f6c 756d  r, regexp: Colum
+00015040: 6e4f 724c 6974 6572 616c 5374 722c 2069  nOrLiteralStr, i
+00015050: 6478 3a20 696e 740a 2920 2d3e 2043 6f6c  dx: int.) -> Col
+00015060: 756d 6e3a 0a20 2020 2072 2222 220a 2020  umn:.    r""".  
+00015070: 2020 4578 7472 6163 7420 6120 7370 6563    Extract a spec
+00015080: 6966 6963 2067 726f 7570 206d 6174 6368  ific group match
+00015090: 6564 2062 7920 6120 7265 6765 782c 2066  ed by a regex, f
+000150a0: 726f 6d20 7468 6520 7370 6563 6966 6965  rom the specifie
+000150b0: 6420 7374 7269 6e67 2063 6f6c 756d 6e2e  d string column.
+000150c0: 0a20 2020 2049 6620 7468 6520 7265 6765  .    If the rege
+000150d0: 7820 6469 6420 6e6f 7420 6d61 7463 682c  x did not match,
+000150e0: 206f 7220 7468 6520 7370 6563 6966 6965   or the specifie
+000150f0: 6420 6772 6f75 7020 6469 6420 6e6f 7420  d group did not 
+00015100: 6d61 7463 682c 0a20 2020 2061 6e20 656d  match,.    an em
+00015110: 7074 7920 7374 7269 6e67 2069 7320 7265  pty string is re
+00015120: 7475 726e 6564 2e0a 0a20 2020 2045 7861  turned...    Exa
+00015130: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00015140: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00015150: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+00015160: 7469 6f6e 7320 696d 706f 7274 2072 6567  tions import reg
+00015170: 6578 705f 6578 7472 6163 740a 2020 2020  exp_extract.    
+00015180: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00015190: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+000151a0: 7261 6d65 285b 5b22 6964 5f32 305f 3330  rame([["id_20_30
+000151b0: 222c 2031 305d 2c20 5b22 6964 5f34 305f  ", 10], ["id_40_
+000151c0: 3530 222c 2033 305d 5d2c 205b 2269 6422  50", 30]], ["id"
+000151d0: 2c20 2261 6765 225d 290a 2020 2020 2020  , "age"]).      
+000151e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000151f0: 7265 6765 7870 5f65 7874 7261 6374 2822  regexp_extract("
+00015200: 6964 222c 2072 2228 5c64 2b29 222c 2031  id", r"(\d+)", 1
+00015210: 292e 616c 6961 7328 2252 4553 2229 292e  ).alias("RES")).
+00015220: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00015230: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015240: 207c 2252 4553 2220 207c 0a20 2020 2020   |"RES"  |.     
+00015250: 2020 202d 2d2d 2d2d 2d2d 2d2d 0a20 2020     ---------.   
+00015260: 2020 2020 207c 3230 2020 2020 207c 0a20       |20     |. 
+00015270: 2020 2020 2020 207c 3430 2020 2020 207c         |40     |
+00015280: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015290: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+000152a0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+000152b0: 2020 2076 616c 7565 203d 205f 746f 5f63     value = _to_c
+000152c0: 6f6c 5f69 665f 7374 7228 7661 6c75 652c  ol_if_str(value,
+000152d0: 2022 7265 6765 7870 5f65 7874 7261 6374   "regexp_extract
+000152e0: 2229 0a20 2020 2072 6567 6578 7020 3d20  ").    regexp = 
+000152f0: 5f74 6f5f 636f 6c5f 6966 5f6c 6974 2872  _to_col_if_lit(r
+00015300: 6567 6578 702c 2022 7265 6765 7870 5f65  egexp, "regexp_e
+00015310: 7874 7261 6374 2229 0a20 2020 2069 6478  xtract").    idx
+00015320: 203d 205f 746f 5f63 6f6c 5f69 665f 6c69   = _to_col_if_li
+00015330: 7428 6964 782c 2022 7265 6765 7870 5f65  t(idx, "regexp_e
+00015340: 7874 7261 6374 2229 0a20 2020 2072 6574  xtract").    ret
+00015350: 7572 6e20 636f 616c 6573 6365 280a 2020  urn coalesce(.  
+00015360: 2020 2020 2020 6361 6c6c 5f62 7569 6c74        call_built
+00015370: 696e 2822 7265 6765 7870 5f73 7562 7374  in("regexp_subst
+00015380: 7222 2c20 7661 6c75 652c 2072 6567 6578  r", value, regex
+00015390: 702c 206c 6974 2831 292c 206c 6974 2831  p, lit(1), lit(1
+000153a0: 292c 206c 6974 2822 6522 292c 2069 6478  ), lit("e"), idx
+000153b0: 292c 0a20 2020 2020 2020 206c 6974 2822  ),.        lit("
+000153c0: 2229 2c0a 2020 2020 290a 0a0a 6465 6620  "),.    )...def 
+000153d0: 7265 6765 7870 5f72 6570 6c61 6365 280a  regexp_replace(.
+000153e0: 2020 2020 7375 626a 6563 743a 2043 6f6c      subject: Col
+000153f0: 756d 6e4f 724e 616d 652c 0a20 2020 2070  umnOrName,.    p
+00015400: 6174 7465 726e 3a20 436f 6c75 6d6e 4f72  attern: ColumnOr
+00015410: 4c69 7465 7261 6c53 7472 2c0a 2020 2020  LiteralStr,.    
+00015420: 7265 706c 6163 656d 656e 743a 2043 6f6c  replacement: Col
+00015430: 756d 6e4f 724c 6974 6572 616c 5374 7220  umnOrLiteralStr 
+00015440: 3d20 2222 2c0a 2020 2020 706f 7369 7469  = "",.    positi
+00015450: 6f6e 3a20 556e 696f 6e5b 436f 6c75 6d6e  on: Union[Column
+00015460: 2c20 696e 745d 203d 2031 2c0a 2020 2020  , int] = 1,.    
+00015470: 6f63 6375 7272 656e 6365 733a 2055 6e69  occurrences: Uni
+00015480: 6f6e 5b43 6f6c 756d 6e2c 2069 6e74 5d20  on[Column, int] 
+00015490: 3d20 302c 0a20 2020 202a 7061 7261 6d65  = 0,.    *parame
+000154a0: 7465 7273 3a20 436f 6c75 6d6e 4f72 4c69  ters: ColumnOrLi
+000154b0: 7465 7261 6c2c 0a29 202d 3e20 436f 6c75  teral,.) -> Colu
+000154c0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+000154d0: 6e73 2074 6865 2073 7562 6a65 6374 2077  ns the subject w
+000154e0: 6974 6820 7468 6520 7370 6563 6966 6965  ith the specifie
+000154f0: 6420 7061 7474 6572 6e20 286f 7220 616c  d pattern (or al
+00015500: 6c20 6f63 6375 7272 656e 6365 7320 6f66  l occurrences of
+00015510: 2074 6865 2070 6174 7465 726e 2920 6569   the pattern) ei
+00015520: 7468 6572 2072 656d 6f76 6564 206f 7220  ther removed or 
+00015530: 7265 706c 6163 6564 2062 7920 6120 7265  replaced by a re
+00015540: 706c 6163 656d 656e 7420 7374 7269 6e67  placement string
+00015550: 2e0a 2020 2020 4966 206e 6f20 6d61 7463  ..    If no matc
+00015560: 6865 7320 6172 6520 666f 756e 642c 2072  hes are found, r
+00015570: 6574 7572 6e73 2074 6865 206f 7269 6769  eturns the origi
+00015580: 6e61 6c20 7375 626a 6563 742e 0a0a 2020  nal subject...  
+00015590: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+000155a0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+000155b0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+000155c0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+000155d0: 2e2e 2020 2020 205b 5b22 4974 2077 6173  ..     [["It was
+000155e0: 2074 6865 2062 6573 7420 6f66 2074 696d   the best of tim
+000155f0: 6573 2c20 6974 2077 6173 2074 6865 2077  es, it was the w
+00015600: 6f72 7374 206f 6620 7469 6d65 7322 5d5d  orst of times"]]
+00015610: 2c20 7363 6865 6d61 3d5b 2261 225d 0a20  , schema=["a"]. 
+00015620: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00015630: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00015640: 6374 2872 6567 6578 705f 7265 706c 6163  ct(regexp_replac
+00015650: 6528 636f 6c28 2261 2229 2c20 6c69 7428  e(col("a"), lit(
+00015660: 2228 2029 7b31 2c7d 2229 2c20 6c69 7428  "( ){1,}"), lit(
+00015670: 2222 2929 2e61 6c69 6173 2822 7265 7375  "")).alias("resu
+00015680: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00015690: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000156a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000156b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000156c0: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+000156d0: 4c54 2220 2020 2020 2020 2020 2020 2020  LT"             
+000156e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156f0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00015700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00015730: 2020 2020 7c49 7477 6173 7468 6562 6573      |Itwasthebes
+00015740: 746f 6674 696d 6573 2c69 7477 6173 7468  toftimes,itwasth
+00015750: 6577 6f72 7374 6f66 7469 6d65 7320 207c  eworstoftimes  |
+00015760: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015790: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+000157a0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+000157b0: 220a 2020 2020 7371 6c5f 6675 6e63 5f6e  ".    sql_func_n
+000157c0: 616d 6520 3d20 2272 6567 6578 705f 7265  ame = "regexp_re
+000157d0: 706c 6163 6522 0a20 2020 2073 7562 203d  place".    sub =
+000157e0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+000157f0: 7375 626a 6563 742c 2073 716c 5f66 756e  subject, sql_fun
+00015800: 635f 6e61 6d65 290a 2020 2020 7061 7420  c_name).    pat 
+00015810: 3d20 6c69 7428 7061 7474 6572 6e29 0a20  = lit(pattern). 
+00015820: 2020 2072 6570 203d 206c 6974 2872 6570     rep = lit(rep
+00015830: 6c61 6365 6d65 6e74 290a 2020 2020 706f  lacement).    po
+00015840: 7320 3d20 6c69 7428 706f 7369 7469 6f6e  s = lit(position
+00015850: 290a 2020 2020 6f63 6320 3d20 6c69 7428  ).    occ = lit(
+00015860: 6f63 6375 7272 656e 6365 7329 0a0a 2020  occurrences)..  
+00015870: 2020 7061 7261 6d73 203d 205b 6c69 7428    params = [lit(
+00015880: 7029 2066 6f72 2070 2069 6e20 7061 7261  p) for p in para
+00015890: 6d65 7465 7273 5d0a 2020 2020 7265 7475  meters].    retu
+000158a0: 726e 2062 7569 6c74 696e 2873 716c 5f66  rn builtin(sql_f
+000158b0: 756e 635f 6e61 6d65 2928 7375 622c 2070  unc_name)(sub, p
+000158c0: 6174 2c20 7265 702c 2070 6f73 2c20 6f63  at, rep, pos, oc
+000158d0: 632c 202a 7061 7261 6d73 290a 0a0a 6465  c, *params)...de
+000158e0: 6620 7265 706c 6163 6528 0a20 2020 2073  f replace(.    s
+000158f0: 7562 6a65 6374 3a20 436f 6c75 6d6e 4f72  ubject: ColumnOr
+00015900: 4e61 6d65 2c0a 2020 2020 7061 7474 6572  Name,.    patter
+00015910: 6e3a 2043 6f6c 756d 6e4f 724c 6974 6572  n: ColumnOrLiter
+00015920: 616c 5374 722c 0a20 2020 2072 6570 6c61  alStr,.    repla
+00015930: 6365 6d65 6e74 3a20 436f 6c75 6d6e 4f72  cement: ColumnOr
+00015940: 4c69 7465 7261 6c53 7472 203d 2022 222c  LiteralStr = "",
+00015950: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
+00015960: 2020 2222 220a 2020 2020 5265 6d6f 7665    """.    Remove
+00015970: 7320 616c 6c20 6f63 6375 7272 656e 6365  s all occurrence
+00015980: 7320 6f66 2061 2073 7065 6369 6669 6564  s of a specified
+00015990: 2073 7562 6a65 6374 2061 6e64 206f 7074   subject and opt
+000159a0: 696f 6e61 6c6c 7920 7265 706c 6163 6573  ionally replaces
+000159b0: 2074 6865 6d20 7769 7468 2072 6570 6c61   them with repla
+000159c0: 6365 6d65 6e74 2e0a 0a20 2020 2045 7861  cement...    Exa
+000159d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+000159e0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000159f0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00015a00: 6528 5b5b 2261 7070 6c65 225d 2c20 5b22  e([["apple"], ["
+00015a10: 6170 706c 6520 7069 6522 5d2c 205b 2261  apple pie"], ["a
+00015a20: 7070 6c65 206a 7569 6365 225d 5d2c 2073  pple juice"]], s
+00015a30: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+00015a40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00015a50: 6374 2872 6570 6c61 6365 2863 6f6c 2822  ct(replace(col("
+00015a60: 6122 292c 2022 6170 706c 6522 2c20 226f  a"), "apple", "o
+00015a70: 7261 6e67 6522 292e 616c 6961 7328 2272  range").alias("r
+00015a80: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00015a90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015aa0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015ab0: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
+00015ac0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00015ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00015ae0: 2020 207c 6f72 616e 6765 2020 2020 2020     |orange      
+00015af0: 2020 7c0a 2020 2020 2020 2020 7c6f 7261    |.        |ora
+00015b00: 6e67 6520 7069 6520 2020 207c 0a20 2020  nge pie    |.   
+00015b10: 2020 2020 207c 6f72 616e 6765 206a 7569       |orange jui
+00015b20: 6365 2020 7c0a 2020 2020 2020 2020 2d2d  ce  |.        --
+00015b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00015b40: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+00015b50: 453e 0a20 2020 2022 2222 0a20 2020 2073  E>.    """.    s
+00015b60: 716c 5f66 756e 635f 6e61 6d65 203d 2022  ql_func_name = "
+00015b70: 7265 706c 6163 6522 0a20 2020 2073 7562  replace".    sub
+00015b80: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00015b90: 7228 7375 626a 6563 742c 2073 716c 5f66  r(subject, sql_f
+00015ba0: 756e 635f 6e61 6d65 290a 2020 2020 7061  unc_name).    pa
+00015bb0: 7420 3d20 6c69 7428 7061 7474 6572 6e29  t = lit(pattern)
+00015bc0: 0a20 2020 2072 6570 203d 206c 6974 2872  .    rep = lit(r
+00015bd0: 6570 6c61 6365 6d65 6e74 290a 2020 2020  eplacement).    
+00015be0: 7265 7475 726e 2062 7569 6c74 696e 2873  return builtin(s
+00015bf0: 716c 5f66 756e 635f 6e61 6d65 2928 7375  ql_func_name)(su
+00015c00: 622c 2070 6174 2c20 7265 7029 0a0a 0a64  b, pat, rep)...d
+00015c10: 6566 2063 6861 7269 6e64 6578 280a 2020  ef charindex(.  
+00015c20: 2020 7461 7267 6574 5f65 7870 723a 2043    target_expr: C
+00015c30: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
+00015c40: 2073 6f75 7263 655f 6578 7072 3a20 436f   source_expr: Co
+00015c50: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
+00015c60: 706f 7369 7469 6f6e 3a20 4f70 7469 6f6e  position: Option
+00015c70: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e2c  al[Union[Column,
+00015c80: 2069 6e74 5d5d 203d 204e 6f6e 652c 0a29   int]] = None,.)
+00015c90: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00015ca0: 2222 2253 6561 7263 6865 7320 666f 7220  """Searches for 
+00015cb0: 6060 7461 7267 6574 5f65 7870 7260 6020  ``target_expr`` 
+00015cc0: 696e 2060 6073 6f75 7263 655f 6578 7072  in ``source_expr
+00015cd0: 6060 2061 6e64 2c20 6966 2073 7563 6365  `` and, if succe
+00015ce0: 7373 6675 6c2c 0a20 2020 2072 6574 7572  ssful,.    retur
+00015cf0: 6e73 2074 6865 2070 6f73 6974 696f 6e20  ns the position 
+00015d00: 2831 2d62 6173 6564 2920 6f66 2074 6865  (1-based) of the
+00015d10: 2060 6074 6172 6765 745f 6578 7072 6060   ``target_expr``
+00015d20: 2069 6e20 6060 736f 7572 6365 5f65 7870   in ``source_exp
+00015d30: 7260 602e 0a0a 2020 2020 4172 6773 3a0a  r``...    Args:.
+00015d40: 2020 2020 2020 2020 7461 7267 6574 5f65          target_e
+00015d50: 7870 723a 2041 2073 7472 696e 6720 6f72  xpr: A string or
+00015d60: 2062 696e 6172 7920 6578 7072 6573 7369   binary expressi
+00015d70: 6f6e 2072 6570 7265 7365 6e74 696e 6720  on representing 
+00015d80: 7468 6520 7661 6c75 6520 746f 206c 6f6f  the value to loo
+00015d90: 6b20 666f 722e 0a20 2020 2020 2020 2073  k for..        s
+00015da0: 6f75 7263 655f 6578 7072 3a20 4120 7374  ource_expr: A st
+00015db0: 7269 6e67 206f 7220 6269 6e61 7279 2065  ring or binary e
+00015dc0: 7870 7265 7373 696f 6e20 7265 7072 6573  xpression repres
+00015dd0: 656e 7469 6e67 2074 6865 2076 616c 7565  enting the value
+00015de0: 2074 6f20 7365 6172 6368 2e0a 2020 2020   to search..    
+00015df0: 2020 2020 706f 7369 7469 6f6e 3a20 4120      position: A 
+00015e00: 6e75 6d62 6572 2069 6e64 6963 6174 696f  number indicatio
+00015e10: 6e20 7468 6520 706f 7369 7469 6f6e 2028  n the position (
+00015e20: 312d 6261 7365 6429 2066 726f 6d20 7768  1-based) from wh
+00015e30: 6572 6520 746f 2073 7461 7274 2074 6865  ere to start the
+00015e40: 2073 6561 7263 682e 2044 6566 6175 6c74   search. Default
+00015e50: 7320 746f 204e 6f6e 652e 0a0a 2020 2020  s to None...    
+00015e60: 4578 616d 706c 6573 3a3a 0a20 2020 2020  Examples::.     
+00015e70: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00015e80: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00015e90: 7261 6d65 285b 2262 616e 616e 6122 5d2c  rame(["banana"],
+00015ea0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
+00015eb0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00015ec0: 6c65 6374 2863 6861 7269 6e64 6578 286c  lect(charindex(l
+00015ed0: 6974 2822 616e 2229 2c20 6466 2e61 2c20  it("an"), df.a, 
+00015ee0: 3129 2e61 735f 2822 7265 7375 6c74 2229  1).as_("result")
+00015ef0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00015f00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00015f10: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00015f20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00015f30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00015f40: 7c32 2020 2020 2020 2020 207c 0a20 2020  |2         |.   
+00015f50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00015f60: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00015f70: 4c49 4e45 3e0a 0a20 2020 2020 2020 203e  LINE>..        >
+00015f80: 3e3e 2064 662e 7365 6c65 6374 2863 6861  >> df.select(cha
+00015f90: 7269 6e64 6578 286c 6974 2822 616e 2229  rindex(lit("an")
+00015fa0: 2c20 6466 2e61 2c20 3329 2e61 735f 2822  , df.a, 3).as_("
+00015fb0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00015fc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015fd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00015fe0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+00015ff0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00016000: 2020 2020 2020 2020 7c34 2020 2020 2020          |4      
+00016010: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00016020: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00016030: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00016040: 2020 2222 220a 2020 2020 7420 3d20 5f74    """.    t = _t
+00016050: 6f5f 636f 6c5f 6966 5f73 7472 2874 6172  o_col_if_str(tar
+00016060: 6765 745f 6578 7072 2c20 2263 6861 7269  get_expr, "chari
+00016070: 6e64 6578 2229 0a20 2020 2073 203d 205f  ndex").    s = _
+00016080: 746f 5f63 6f6c 5f69 665f 7374 7228 736f  to_col_if_str(so
+00016090: 7572 6365 5f65 7870 722c 2022 6368 6172  urce_expr, "char
+000160a0: 696e 6465 7822 290a 2020 2020 7265 7475  index").    retu
+000160b0: 726e 2028 0a20 2020 2020 2020 2062 7569  rn (.        bui
+000160c0: 6c74 696e 2822 6368 6172 696e 6465 7822  ltin("charindex"
+000160d0: 2928 742c 2073 2c20 6c69 7428 706f 7369  )(t, s, lit(posi
+000160e0: 7469 6f6e 2929 0a20 2020 2020 2020 2069  tion)).        i
+000160f0: 6620 706f 7369 7469 6f6e 2069 7320 6e6f  f position is no
+00016100: 7420 4e6f 6e65 0a20 2020 2020 2020 2065  t None.        e
+00016110: 6c73 6520 6275 696c 7469 6e28 2263 6861  lse builtin("cha
+00016120: 7269 6e64 6578 2229 2874 2c20 7329 0a20  rindex")(t, s). 
+00016130: 2020 2029 0a0a 0a64 6566 2063 6f6c 6c61     )...def colla
+00016140: 7465 2865 3a20 436f 6c75 6d6e 2c20 636f  te(e: Column, co
+00016150: 6c6c 6174 696f 6e5f 7370 6563 3a20 7374  llation_spec: st
+00016160: 7229 202d 3e20 436f 6c75 6d6e 3a0a 2020  r) -> Column:.  
+00016170: 2020 2222 2252 6574 7572 6e73 2061 2063    """Returns a c
+00016180: 6f70 7920 6f66 2074 6865 206f 7269 6769  opy of the origi
+00016190: 6e61 6c20 3a63 6c61 7373 3a60 436f 6c75  nal :class:`Colu
+000161a0: 6d6e 6020 7769 7468 2074 6865 2073 7065  mn` with the spe
+000161b0: 6369 6669 6564 2060 6063 6f6c 6c61 7469  cified ``collati
+000161c0: 6f6e 5f73 7065 6360 600a 2020 2020 7072  on_spec``.    pr
+000161d0: 6f70 6572 7479 2c20 7261 7468 6572 2074  operty, rather t
+000161e0: 6861 6e20 7468 6520 6f72 6967 696e 616c  han the original
+000161f0: 2063 6f6c 6c61 7469 6f6e 2073 7065 6369   collation speci
+00016200: 6669 6361 7469 6f6e 2070 726f 7065 7274  fication propert
+00016210: 792e 0a0a 2020 2020 466f 7220 6465 7461  y...    For deta
+00016220: 696c 732c 2073 6565 2074 6865 2053 6e6f  ils, see the Sno
+00016230: 7766 6c61 6b65 2064 6f63 756d 656e 7461  wflake documenta
+00016240: 7469 6f6e 206f 6e0a 2020 2020 6063 6f6c  tion on.    `col
+00016250: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
+00016260: 7469 6f6e 7320 3c68 7474 7073 3a2f 2f64  tions <https://d
+00016270: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
+00016280: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
+00016290: 6365 2f63 6f6c 6c61 7469 6f6e 2e68 746d  ce/collation.htm
+000162a0: 6c23 6c61 6265 6c2d 636f 6c6c 6174 696f  l#label-collatio
+000162b0: 6e2d 7370 6563 6966 6963 6174 696f 6e3e  n-specification>
+000162c0: 605f 2e0a 0a20 2020 2045 7861 6d70 6c65  `_...    Example
+000162d0: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+000162e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000162f0: 7465 5f64 6174 6166 7261 6d65 285b 27c3  te_dataframe(['.
+00016300: b127 5d2c 2073 6368 656d 613d 5b27 7627  .'], schema=['v'
+00016310: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00016320: 662e 7365 6c65 6374 2864 662e 7620 3d3d  f.select(df.v ==
+00016330: 206c 6974 2827 c391 2729 2c20 636f 6c6c   lit('..'), coll
+00016340: 6174 6528 6466 2e76 2c20 2773 702d 7570  ate(df.v, 'sp-up
+00016350: 7065 7227 2920 3d3d 206c 6974 2827 c391  per') == lit('..
+00016360: 2729 292e 7368 6f77 2829 0a20 2020 2020  ')).show().     
+00016370: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00016380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+000163b0: 2020 2020 2020 7c22 2822 2256 2222 203d        |"(""V"" =
+000163c0: 2027 c391 2729 2220 207c 2228 434f 4c4c   '..')"  |"(COLL
+000163d0: 4154 4528 2222 5622 222c 2027 5350 2d55  ATE(""V"", 'SP-U
+000163e0: 5050 4552 2729 203d 2027 c391 2729 2220  PPER') = '..')" 
+000163f0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00016400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016430: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c46  -----.        |F
+00016440: 616c 7365 2020 2020 2020 2020 2020 2020  alse            
+00016450: 7c54 7275 6520 2020 2020 2020 2020 2020  |True           
+00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016470: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00016480: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00016490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000164a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000164b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000164c0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+000164d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+000164e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+000164f0: 2c20 2263 6f6c 6c61 7465 2229 0a20 2020  , "collate").   
+00016500: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00016510: 2263 6f6c 6c61 7465 2229 2863 2c20 636f  "collate")(c, co
+00016520: 6c6c 6174 696f 6e5f 7370 6563 290a 0a0a  llation_spec)...
+00016530: 6465 6620 636f 6c6c 6174 696f 6e28 653a  def collation(e:
+00016540: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00016550: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00016560: 2252 6574 7572 6e73 2074 6865 2063 6f6c  "Returns the col
+00016570: 6c61 7469 6f6e 2073 7065 6369 6669 6361  lation specifica
+00016580: 7469 6f6e 206f 6620 6578 7072 2e0a 0a20  tion of expr... 
+00016590: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+000165a0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000165b0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000165c0: 6166 7261 6d65 285b 27c3 b127 5d2c 2073  aframe(['..'], s
+000165d0: 6368 656d 613d 5b27 7627 5d29 0a20 2020  chema=['v']).   
+000165e0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+000165f0: 6374 2863 6f6c 6c61 7469 6f6e 2863 6f6c  ct(collation(col
+00016600: 6c61 7465 2864 662e 762c 2027 7370 2d75  late(df.v, 'sp-u
+00016610: 7070 6572 2729 2929 2e73 686f 7728 290a  pper'))).show().
+00016620: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00016630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016640: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016650: 2d2d 2d0a 2020 2020 2020 2020 7c22 434f  ---.        |"CO
+00016660: 4c4c 4154 494f 4e28 434f 4c4c 4154 4528  LLATION(COLLATE(
+00016670: 2222 5622 222c 2027 5350 2d55 5050 4552  ""V"", 'SP-UPPER
+00016680: 2729 2922 2020 7c0a 2020 2020 2020 2020  '))"  |.        
+00016690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000166a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000166b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000166c0: 2020 2020 7c73 702d 7570 7065 7220 2020      |sp-upper   
+000166d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166e0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+000166f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00016700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016720: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00016730: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00016740: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00016750: 6966 5f73 7472 2865 2c20 2263 6f6c 6c61  if_str(e, "colla
+00016760: 7469 6f6e 2229 0a20 2020 2072 6574 7572  tion").    retur
+00016770: 6e20 6275 696c 7469 6e28 2263 6f6c 6c61  n builtin("colla
+00016780: 7469 6f6e 2229 2863 290a 0a0a 6465 6620  tion")(c)...def 
+00016790: 636f 6e63 6174 282a 636f 6c73 3a20 436f  concat(*cols: Co
+000167a0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000167b0: 6f6c 756d 6e3a 0a20 2020 2022 2222 436f  olumn:.    """Co
+000167c0: 6e63 6174 656e 6174 6573 206f 6e65 206f  ncatenates one o
+000167d0: 7220 6d6f 7265 2073 7472 696e 6773 2c20  r more strings, 
+000167e0: 6f72 2063 6f6e 6361 7465 6e61 7465 7320  or concatenates 
+000167f0: 6f6e 6520 6f72 206d 6f72 6520 6269 6e61  one or more bina
+00016800: 7279 2076 616c 7565 732e 2049 6620 616e  ry values. If an
+00016810: 7920 6f66 2074 6865 2076 616c 7565 7320  y of the values 
+00016820: 6973 206e 756c 6c2c 2074 6865 2072 6573  is null, the res
+00016830: 756c 7420 6973 2061 6c73 6f20 6e75 6c6c  ult is also null
+00016840: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00016850: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00016860: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00016870: 5f64 6174 6166 7261 6d65 285b 5b27 4865  _dataframe([['He
+00016880: 6c6c 6f27 2c20 2757 6f72 6c64 275d 5d2c  llo', 'World']],
+00016890: 2073 6368 656d 613d 5b27 6127 2c20 2762   schema=['a', 'b
+000168a0: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+000168b0: 6466 2e73 656c 6563 7428 636f 6e63 6174  df.select(concat
+000168c0: 2864 662e 612c 2064 662e 6229 292e 7368  (df.a, df.b)).sh
+000168d0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+000168e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000168f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016900: 7c22 434f 4e43 4154 2822 2241 2222 2c20  |"CONCAT(""A"", 
+00016910: 2222 4222 2229 2220 207c 0a20 2020 2020  ""B"")"  |.     
+00016920: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00016930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00016940: 2020 2020 2020 7c48 656c 6c6f 576f 726c        |HelloWorl
+00016950: 6420 2020 2020 2020 2020 2020 2020 207c  d              |
+00016960: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00016970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016980: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00016990: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+000169a0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
+000169b0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+000169c0: 2c20 2263 6f6e 6361 7422 2920 666f 7220  , "concat") for 
+000169d0: 6320 696e 2063 6f6c 735d 0a20 2020 2072  c in cols].    r
+000169e0: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+000169f0: 6f6e 6361 7422 2928 2a63 6f6c 756d 6e73  oncat")(*columns
+00016a00: 290a 0a0a 6465 6620 636f 6e63 6174 5f77  )...def concat_w
+00016a10: 7328 2a63 6f6c 733a 2043 6f6c 756d 6e4f  s(*cols: ColumnO
+00016a20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00016a30: 3a0a 2020 2020 2222 2243 6f6e 6361 7465  :.    """Concate
+00016a40: 6e61 7465 7320 7477 6f20 6f72 206d 6f72  nates two or mor
+00016a50: 6520 7374 7269 6e67 732c 206f 7220 636f  e strings, or co
+00016a60: 6e63 6174 656e 6174 6573 2074 776f 206f  ncatenates two o
+00016a70: 7220 6d6f 7265 2062 696e 6172 7920 7661  r more binary va
+00016a80: 6c75 6573 2e20 4966 2061 6e79 206f 6620  lues. If any of 
+00016a90: 7468 6520 7661 6c75 6573 2069 7320 6e75  the values is nu
+00016aa0: 6c6c 2c20 7468 6520 7265 7375 6c74 2069  ll, the result i
+00016ab0: 7320 616c 736f 206e 756c 6c2e 0a20 2020  s also null..   
+00016ac0: 2054 6865 2043 4f4e 4341 545f 5753 206f   The CONCAT_WS o
+00016ad0: 7065 7261 746f 7220 7265 7175 6972 6573  perator requires
+00016ae0: 2061 7420 6c65 6173 7420 7477 6f20 6172   at least two ar
+00016af0: 6775 6d65 6e74 732c 2061 6e64 2075 7365  guments, and use
+00016b00: 7320 7468 6520 6669 7273 7420 6172 6775  s the first argu
+00016b10: 6d65 6e74 2074 6f20 7365 7061 7261 7465  ment to separate
+00016b20: 2061 6c6c 2066 6f6c 6c6f 7769 6e67 2061   all following a
+00016b30: 7267 756d 656e 7473 2e0a 0a20 2020 2045  rguments...    E
+00016b40: 7861 6d70 6c65 733a 3a0a 2020 2020 2020  xamples::.      
+00016b50: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00016b60: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+00016b70: 6e63 7469 6f6e 7320 696d 706f 7274 206c  nctions import l
+00016b80: 6974 0a20 2020 2020 2020 203e 3e3e 2064  it.        >>> d
+00016b90: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00016ba0: 7465 5f64 6174 6166 7261 6d65 285b 5b27  te_dataframe([['
+00016bb0: 4865 6c6c 6f27 2c20 2757 6f72 6c64 275d  Hello', 'World']
+00016bc0: 5d2c 2073 6368 656d 613d 5b27 6127 2c20  ], schema=['a', 
+00016bd0: 2762 275d 290a 2020 2020 2020 2020 3e3e  'b']).        >>
+00016be0: 3e20 6466 2e73 656c 6563 7428 636f 6e63  > df.select(conc
+00016bf0: 6174 5f77 7328 6c69 7428 272c 2729 2c20  at_ws(lit(','), 
+00016c00: 6466 2e61 2c20 6466 2e62 2929 2e73 686f  df.a, df.b)).sho
+00016c10: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00016c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00016c40: 2020 2020 2020 207c 2243 4f4e 4341 545f         |"CONCAT_
+00016c50: 5753 2827 2c27 2c20 2222 4122 222c 2022  WS(',', ""A"", "
+00016c60: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
+00016c70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00016c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016c90: 2d2d 2d2d 0a20 2020 2020 2020 207c 4865  ----.        |He
+00016ca0: 6c6c 6f2c 576f 726c 6420 2020 2020 2020  llo,World       
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00016cc0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00016cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00016cf0: 2020 203c 424c 414e 4b4c 494e 453e 0a0a     <BLANKLINE>..
+00016d00: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00016d10: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00016d20: 6461 7461 6672 616d 6528 5b5b 2748 656c  dataframe([['Hel
+00016d30: 6c6f 272c 2027 576f 726c 6427 2c20 272c  lo', 'World', ',
+00016d40: 275d 5d2c 2073 6368 656d 613d 5b27 6127  ']], schema=['a'
+00016d50: 2c20 2762 272c 2027 7365 7027 5d29 0a20  , 'b', 'sep']). 
+00016d60: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00016d70: 6c65 6374 2863 6f6e 6361 745f 7773 2827  lect(concat_ws('
+00016d80: 7365 7027 2c20 6466 2e61 2c20 6466 2e62  sep', df.a, df.b
+00016d90: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00016da0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00016db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016dc0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00016dd0: 207c 2243 4f4e 4341 545f 5753 2822 2253   |"CONCAT_WS(""S
+00016de0: 4550 2222 2c20 2222 4122 222c 2022 2242  EP"", ""A"", ""B
+00016df0: 2222 2922 2020 7c0a 2020 2020 2020 2020  "")"  |.        
+00016e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00016e30: 4865 6c6c 6f2c 576f 726c 6420 2020 2020  Hello,World     
+00016e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+00016e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016e80: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00016e90: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00016ea0: 0a20 2020 2063 6f6c 756d 6e73 203d 205b  .    columns = [
+00016eb0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00016ec0: 2c20 2263 6f6e 6361 745f 7773 2229 2066  , "concat_ws") f
+00016ed0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
+00016ee0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00016ef0: 2822 636f 6e63 6174 5f77 7322 2928 2a63  ("concat_ws")(*c
+00016f00: 6f6c 756d 6e73 290a 0a0a 6465 6620 7472  olumns)...def tr
+00016f10: 616e 736c 6174 6528 0a20 2020 2073 7263  anslate(.    src
+00016f20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c0a  : ColumnOrName,.
+00016f30: 2020 2020 736f 7572 6365 5f61 6c70 6861      source_alpha
+00016f40: 6265 743a 2043 6f6c 756d 6e4f 724e 616d  bet: ColumnOrNam
+00016f50: 652c 0a20 2020 2074 6172 6765 745f 616c  e,.    target_al
+00016f60: 7068 6162 6574 3a20 436f 6c75 6d6e 4f72  phabet: ColumnOr
+00016f70: 4e61 6d65 2c0a 2920 2d3e 2043 6f6c 756d  Name,.) -> Colum
+00016f80: 6e3a 0a20 2020 2022 2222 5472 616e 736c  n:.    """Transl
+00016f90: 6174 6573 2073 7263 2066 726f 6d20 7468  ates src from th
+00016fa0: 6520 6368 6172 6163 7465 7273 2069 6e20  e characters in 
+00016fb0: 736f 7572 6365 5f61 6c70 6861 6265 7420  source_alphabet 
+00016fc0: 746f 2074 6865 2063 6861 7261 6374 6572  to the character
+00016fd0: 7320 696e 0a20 2020 2074 6172 6765 745f  s in.    target_
+00016fe0: 616c 7068 6162 6574 2e20 4561 6368 2063  alphabet. Each c
+00016ff0: 6861 7261 6374 6572 206d 6174 6368 696e  haracter matchin
+00017000: 6720 6120 6368 6172 6163 7465 7220 6174  g a character at
+00017010: 2070 6f73 6974 696f 6e20 6920 696e 2074   position i in t
+00017020: 6865 2073 6f75 7263 655f 616c 7068 6162  he source_alphab
+00017030: 6574 2069 7320 7265 706c 6163 6564 0a20  et is replaced. 
+00017040: 2020 2077 6974 6820 7468 6520 6368 6172     with the char
+00017050: 6163 7465 7220 6174 2070 6f73 6974 696f  acter at positio
+00017060: 6e20 6920 696e 2074 6865 2074 6172 6765  n i in the targe
+00017070: 745f 616c 7068 6162 6574 2e20 4966 2074  t_alphabet. If t
+00017080: 6172 6765 745f 616c 7068 6162 6574 2069  arget_alphabet i
+00017090: 7320 7368 6f72 7465 722c 2061 6e64 2074  s shorter, and t
+000170a0: 6865 7265 2069 7320 6e6f 2063 6f72 7265  here is no corre
+000170b0: 7370 6f6e 6469 6e67 0a20 2020 2063 6861  sponding.    cha
+000170c0: 7261 6374 6572 2074 6865 2063 6861 7261  racter the chara
+000170d0: 6374 6572 2069 7320 6f6d 6974 7465 642e  cter is omitted.
+000170e0: 2074 6172 6765 745f 616c 7068 6162 6574   target_alphabet
+000170f0: 2063 616e 206e 6f74 2062 6520 6c6f 6e67   can not be long
+00017100: 6572 2074 6861 6e20 736f 7572 6365 5f61  er than source_a
+00017110: 6c70 6861 6265 742e 0a0a 2020 2020 4578  lphabet...    Ex
+00017120: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00017130: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00017140: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00017150: 6d65 285b 2261 6263 6465 6622 2c20 2261  me(["abcdef", "a
+00017160: 6262 6122 5d2c 2073 6368 656d 613d 5b22  bba"], schema=["
+00017170: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00017180: 2064 662e 7365 6c65 6374 2874 7261 6e73   df.select(trans
+00017190: 6c61 7465 2863 6f6c 2822 6122 292c 206c  late(col("a"), l
+000171a0: 6974 2822 6162 6322 292c 206c 6974 2822  it("abc"), lit("
+000171b0: 4142 4322 2929 2e61 735f 2822 616e 7322  ABC")).as_("ans"
+000171c0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000171d0: 2020 2020 205b 526f 7728 414e 533d 2741       [Row(ANS='A
+000171e0: 4243 6465 6627 292c 2052 6f77 2841 4e53  BCdef'), Row(ANS
+000171f0: 3d27 4142 4241 2729 5d0a 0a20 2020 2020  ='ABBA')]..     
+00017200: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00017210: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00017220: 7261 6d65 285b 2266 696c 6520 7769 7468  rame(["file with
+00017230: 2073 7061 6365 732e 7478 7422 2c20 225c   spaces.txt", "\
+00017240: 5c74 7465 7374 225d 2c20 7363 6865 6d61  \ttest"], schema
+00017250: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+00017260: 3e3e 3e20 6466 2e73 656c 6563 7428 7472  >>> df.select(tr
+00017270: 616e 736c 6174 6528 636f 6c28 2261 2229  anslate(col("a")
+00017280: 2c20 6c69 7428 2220 5c5c 7422 292c 206c  , lit(" \\t"), l
+00017290: 6974 2822 5f22 2929 2e61 735f 2822 616e  it("_")).as_("an
+000172a0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
+000172b0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+000172c0: 2766 696c 655f 7769 7468 5f73 7061 6365  'file_with_space
+000172d0: 732e 7478 7427 292c 2052 6f77 2841 4e53  s.txt'), Row(ANS
+000172e0: 3d27 7465 7374 2729 5d0a 0a20 2020 2022  ='test')]..    "
+000172f0: 2222 0a20 2020 2073 6f75 7263 6520 3d20  "".    source = 
+00017300: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2873  _to_col_if_str(s
+00017310: 7263 2c20 2274 7261 6e73 6c61 7465 2229  rc, "translate")
+00017320: 0a20 2020 2073 6f75 7263 655f 616c 7068  .    source_alph
+00017330: 6162 6574 203d 205f 746f 5f63 6f6c 5f69  abet = _to_col_i
+00017340: 665f 7374 7228 736f 7572 6365 5f61 6c70  f_str(source_alp
+00017350: 6861 6265 742c 2022 7472 616e 736c 6174  habet, "translat
+00017360: 6522 290a 2020 2020 7461 7267 6574 5f61  e").    target_a
+00017370: 6c70 6861 6265 7420 3d20 5f74 6f5f 636f  lphabet = _to_co
+00017380: 6c5f 6966 5f73 7472 2874 6172 6765 745f  l_if_str(target_
+00017390: 616c 7068 6162 6574 2c20 2274 7261 6e73  alphabet, "trans
+000173a0: 6c61 7465 2229 0a20 2020 2072 6574 7572  late").    retur
+000173b0: 6e20 6275 696c 7469 6e28 2274 7261 6e73  n builtin("trans
+000173c0: 6c61 7465 2229 2873 6f75 7263 652c 2073  late")(source, s
+000173d0: 6f75 7263 655f 616c 7068 6162 6574 2c20  ource_alphabet, 
+000173e0: 7461 7267 6574 5f61 6c70 6861 6265 7429  target_alphabet)
+000173f0: 0a0a 0a64 6566 2063 6f6e 7461 696e 7328  ...def contains(
+00017400: 636f 6c3a 2043 6f6c 756d 6e4f 724e 616d  col: ColumnOrNam
+00017410: 652c 2073 7472 696e 673a 2043 6f6c 756d  e, string: Colum
+00017420: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00017430: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+00017440: 6e73 2069 6620 6063 6f6c 6020 636f 6e74  ns if `col` cont
+00017450: 6169 6e73 2060 7374 7269 6e67 6020 666f  ains `string` fo
+00017460: 7220 6561 6368 2072 6f77 2e20 5365 6520  r each row. See 
+00017470: 6043 4f4e 5441 494e 5320 3c68 7474 7073  `CONTAINS <https
+00017480: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
+00017490: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
+000174a0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
+000174b0: 2f63 6f6e 7461 696e 733e 600a 0a20 2020  /contains>`..   
+000174c0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+000174d0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000174e0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000174f0: 616d 6528 5b5b 312c 325d 2c20 5b33 2c34  ame([[1,2], [3,4
+00017500: 5d2c 205b 352c 355d 205d 2c20 7363 6865  ], [5,5] ], sche
+00017510: 6d61 3d5b 2261 222c 2262 225d 290a 2020  ma=["a","b"]).  
+00017520: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00017530: 6563 7428 636f 6e74 6169 6e73 2863 6f6c  ect(contains(col
+00017540: 2822 6122 292c 2063 6f6c 2822 6222 2929  ("a"), col("b"))
+00017550: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+00017560: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00017570: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00017580: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00017590: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+000175a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000175b0: 7c46 616c 7365 2020 2020 207c 0a20 2020  |False     |.   
+000175c0: 2020 2020 207c 4661 6c73 6520 2020 2020       |False     
+000175d0: 7c0a 2020 2020 2020 2020 7c54 7275 6520  |.        |True 
+000175e0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+000175f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00017600: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00017610: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+00017620: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
+00017630: 6f6c 2c20 2263 6f6e 7461 696e 7322 290a  ol, "contains").
+00017640: 2020 2020 7320 3d20 5f74 6f5f 636f 6c5f      s = _to_col_
+00017650: 6966 5f73 7472 2873 7472 696e 672c 2022  if_str(string, "
+00017660: 636f 6e74 6169 6e73 2229 0a20 2020 2072  contains").    r
+00017670: 6574 7572 6e20 6275 696c 7469 6e28 2263  eturn builtin("c
+00017680: 6f6e 7461 696e 7322 2928 632c 2073 290a  ontains")(c, s).
+00017690: 0a0a 6465 6620 7374 6172 7473 7769 7468  ..def startswith
+000176a0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+000176b0: 6d65 2c20 7374 723a 2043 6f6c 756d 6e4f  me, str: ColumnO
+000176c0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+000176d0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+000176e0: 2074 7275 6520 6966 2063 6f6c 2073 7461   true if col sta
+000176f0: 7274 7320 7769 7468 2073 7472 2e0a 0a20  rts with str... 
+00017700: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00017710: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00017720: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00017730: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00017740: 2e2e 2e20 2020 2020 5b5b 2261 6263 222c  ...     [["abc",
+00017750: 2022 6122 5d2c 205b 2261 6263 222c 2022   "a"], ["abc", "
+00017760: 7322 5d5d 2c0a 2020 2020 2020 2020 2e2e  s"]],.        ..
+00017770: 2e20 2020 2020 7363 6865 6d61 3d5b 2253  .     schema=["S
+00017780: 222c 2022 5022 5d2c 0a20 2020 2020 2020  ", "P"],.       
+00017790: 202e 2e2e 2029 2e73 656c 6563 7428 7374   ... ).select(st
+000177a0: 6172 7473 7769 7468 2863 6f6c 2822 5322  artswith(col("S"
+000177b0: 292c 2063 6f6c 2822 5022 2929 290a 2020  ), col("P"))).  
+000177c0: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+000177d0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+000177e0: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
+000177f0: 5322 2c20 2250 2229 3d54 7275 6529 2c20  S", "P")=True), 
+00017800: 526f 7728 5354 4152 5453 5749 5448 2822  Row(STARTSWITH("
+00017810: 5322 2c20 2250 2229 3d46 616c 7365 295d  S", "P")=False)]
+00017820: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00017830: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00017840: 636f 6c2c 2022 7374 6172 7473 7769 7468  col, "startswith
+00017850: 2229 0a20 2020 2073 203d 205f 746f 5f63  ").    s = _to_c
+00017860: 6f6c 5f69 665f 7374 7228 7374 722c 2022  ol_if_str(str, "
+00017870: 7374 6172 7473 7769 7468 2229 0a20 2020  startswith").   
+00017880: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00017890: 2273 7461 7274 7377 6974 6822 2928 632c  "startswith")(c,
+000178a0: 2073 290a 0a0a 6465 6620 656e 6473 7769   s)...def endswi
+000178b0: 7468 2863 6f6c 3a20 436f 6c75 6d6e 4f72  th(col: ColumnOr
+000178c0: 4e61 6d65 2c20 7374 723a 2043 6f6c 756d  Name, str: Colum
+000178d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000178e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000178f0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00017900: 636f 6c20 656e 6473 2077 6974 6820 7374  col ends with st
+00017910: 722e 0a0a 2020 2020 4578 616d 706c 653a  r...    Example:
+00017920: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00017930: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00017940: 7465 5f64 6174 6166 7261 6d65 285b 2261  te_dataframe(["a
+00017950: 7070 6c65 222c 2022 6261 6e61 6e61 222c  pple", "banana",
+00017960: 2022 7065 6163 6822 5d2c 2073 6368 656d   "peach"], schem
+00017970: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00017980: 203e 3e3e 2064 662e 7365 6c65 6374 2865   >>> df.select(e
+00017990: 6e64 7377 6974 6828 6466 5b22 6122 5d2c  ndswith(df["a"],
+000179a0: 206c 6974 2822 616e 6122 2929 2e61 6c69   lit("ana")).ali
+000179b0: 6173 2822 656e 6473 7769 7468 2229 292e  as("endswith")).
+000179c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000179d0: 2020 5b52 6f77 2845 4e44 5357 4954 483d    [Row(ENDSWITH=
+000179e0: 4661 6c73 6529 2c20 526f 7728 454e 4453  False), Row(ENDS
+000179f0: 5749 5448 3d54 7275 6529 2c20 526f 7728  WITH=True), Row(
+00017a00: 454e 4453 5749 5448 3d46 616c 7365 295d  ENDSWITH=False)]
+00017a10: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00017a20: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00017a30: 636f 6c2c 2022 656e 6473 7769 7468 2229  col, "endswith")
+00017a40: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+00017a50: 5f69 665f 7374 7228 7374 722c 2022 656e  _if_str(str, "en
+00017a60: 6473 7769 7468 2229 0a20 2020 2072 6574  dswith").    ret
+00017a70: 7572 6e20 6275 696c 7469 6e28 2265 6e64  urn builtin("end
+00017a80: 7377 6974 6822 2928 632c 2073 290a 0a0a  swith")(c, s)...
+00017a90: 6465 6620 696e 7365 7274 280a 2020 2020  def insert(.    
+00017aa0: 6261 7365 5f65 7870 723a 2043 6f6c 756d  base_expr: Colum
+00017ab0: 6e4f 724e 616d 652c 0a20 2020 2070 6f73  nOrName,.    pos
+00017ac0: 6974 696f 6e3a 2055 6e69 6f6e 5b43 6f6c  ition: Union[Col
+00017ad0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 206c  umn, int],.    l
+00017ae0: 656e 6774 683a 2055 6e69 6f6e 5b43 6f6c  ength: Union[Col
+00017af0: 756d 6e2c 2069 6e74 5d2c 0a20 2020 2069  umn, int],.    i
+00017b00: 6e73 6572 745f 6578 7072 3a20 436f 6c75  nsert_expr: Colu
+00017b10: 6d6e 4f72 4e61 6d65 2c0a 2920 2d3e 2043  mnOrName,.) -> C
+00017b20: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00017b30: 2020 2052 6570 6c61 6365 7320 6120 7375     Replaces a su
+00017b40: 6273 7472 696e 6720 6f66 2074 6865 2073  bstring of the s
+00017b50: 7065 6369 6669 6564 206c 656e 6774 682c  pecified length,
+00017b60: 2073 7461 7274 696e 6720 6174 2074 6865   starting at the
+00017b70: 2073 7065 6369 6669 6564 2070 6f73 6974   specified posit
+00017b80: 696f 6e2c 0a20 2020 2077 6974 6820 6120  ion,.    with a 
+00017b90: 6e65 7720 7374 7269 6e67 206f 7220 6269  new string or bi
+00017ba0: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
+00017bb0: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+00017bc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00017bd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00017be0: 6166 7261 6d65 285b 2261 6263 225d 2c20  aframe(["abc"], 
+00017bf0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+00017c00: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00017c10: 6563 7428 696e 7365 7274 2864 665b 2261  ect(insert(df["a
+00017c20: 225d 2c20 312c 2032 2c20 6c69 7428 225a  "], 1, 2, lit("Z
+00017c30: 2229 292e 616c 6961 7328 2269 6e73 6572  ")).alias("inser
+00017c40: 7422 2929 2e63 6f6c 6c65 6374 2829 0a20  t")).collect(). 
+00017c50: 2020 2020 2020 205b 526f 7728 494e 5345         [Row(INSE
+00017c60: 5254 3d27 5a63 2729 5d0a 2020 2020 2222  RT='Zc')].    ""
+00017c70: 220a 2020 2020 6220 3d20 5f74 6f5f 636f  ".    b = _to_co
+00017c80: 6c5f 6966 5f73 7472 2862 6173 655f 6578  l_if_str(base_ex
+00017c90: 7072 2c20 2269 6e73 6572 7422 290a 2020  pr, "insert").  
+00017ca0: 2020 6920 3d20 5f74 6f5f 636f 6c5f 6966    i = _to_col_if
+00017cb0: 5f73 7472 2869 6e73 6572 745f 6578 7072  _str(insert_expr
+00017cc0: 2c20 2269 6e73 6572 7422 290a 2020 2020  , "insert").    
+00017cd0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00017ce0: 696e 7365 7274 2229 2862 2c20 6c69 7428  insert")(b, lit(
+00017cf0: 706f 7369 7469 6f6e 292c 206c 6974 286c  position), lit(l
+00017d00: 656e 6774 6829 2c20 6929 0a0a 0a64 6566  ength), i)...def
+00017d10: 206c 6566 7428 7374 725f 6578 7072 3a20   left(str_expr: 
+00017d20: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6c65  ColumnOrName, le
+00017d30: 6e67 7468 3a20 556e 696f 6e5b 436f 6c75  ngth: Union[Colu
+00017d40: 6d6e 2c20 696e 745d 2920 2d3e 2043 6f6c  mn, int]) -> Col
+00017d50: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+00017d60: 726e 7320 6120 6c65 6674 206d 6f73 7420  rns a left most 
+00017d70: 7375 6273 7472 696e 6720 6f66 2060 6073  substring of ``s
+00017d80: 7472 5f65 7870 7260 602e 0a0a 2020 2020  tr_expr``...    
+00017d90: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00017da0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00017db0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00017dc0: 7261 6d65 285b 5b22 6162 6322 5d2c 205b  rame([["abc"], [
+00017dd0: 2264 6566 225d 5d2c 2073 6368 656d 613d  "def"]], schema=
+00017de0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+00017df0: 3e3e 2064 662e 7365 6c65 6374 286c 6566  >> df.select(lef
+00017e00: 7428 636f 6c28 2261 2229 2c20 3229 2e61  t(col("a"), 2).a
+00017e10: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00017e20: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00017e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00017e40: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00017e50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00017e60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c61  -----.        |a
+00017e70: 6220 2020 2020 2020 207c 0a20 2020 2020  b        |.     
+00017e80: 2020 207c 6465 2020 2020 2020 2020 7c0a     |de        |.
+00017e90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00017ea0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00017eb0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00017ec0: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
+00017ed0: 5f69 665f 7374 7228 7374 725f 6578 7072  _if_str(str_expr
+00017ee0: 2c20 226c 6566 7422 290a 2020 2020 7265  , "left").    re
+00017ef0: 7475 726e 2062 7569 6c74 696e 2822 6c65  turn builtin("le
+00017f00: 6674 2229 2873 2c20 6c69 7428 6c65 6e67  ft")(s, lit(leng
+00017f10: 7468 2929 0a0a 0a64 6566 2072 6967 6874  th))...def right
+00017f20: 2873 7472 5f65 7870 723a 2043 6f6c 756d  (str_expr: Colum
+00017f30: 6e4f 724e 616d 652c 206c 656e 6774 683a  nOrName, length:
+00017f40: 2055 6e69 6f6e 5b43 6f6c 756d 6e2c 2069   Union[Column, i
+00017f50: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
+00017f60: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+00017f70: 2072 6967 6874 206d 6f73 7420 7375 6273   right most subs
+00017f80: 7472 696e 6720 6f66 2060 6073 7472 5f65  tring of ``str_e
+00017f90: 7870 7260 602e 0a0a 2020 2020 4578 616d  xpr``...    Exam
+00017fa0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00017fb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00017fc0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00017fd0: 285b 5b22 6162 6322 5d2c 205b 2264 6566  ([["abc"], ["def
+00017fe0: 225d 5d2c 2073 6368 656d 613d 5b22 6122  "]], schema=["a"
+00017ff0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00018000: 662e 7365 6c65 6374 2872 6967 6874 2863  f.select(right(c
+00018010: 6f6c 2822 6122 292c 2032 292e 616c 6961  ol("a"), 2).alia
+00018020: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00018030: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00018040: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00018050: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+00018060: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00018070: 2d2d 0a20 2020 2020 2020 207c 6263 2020  --.        |bc  
+00018080: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00018090: 7c65 6620 2020 2020 2020 207c 0a20 2020  |ef        |.   
+000180a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+000180b0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+000180c0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+000180d0: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
+000180e0: 5f73 7472 2873 7472 5f65 7870 722c 2022  _str(str_expr, "
+000180f0: 7269 6768 7422 290a 2020 2020 7265 7475  right").    retu
+00018100: 726e 2062 7569 6c74 696e 2822 7269 6768  rn builtin("righ
+00018110: 7422 2928 732c 206c 6974 286c 656e 6774  t")(s, lit(lengt
+00018120: 6829 290a 0a0a 6465 6620 6368 6172 2863  h))...def char(c
+00018130: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+00018140: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00018150: 2022 2222 436f 6e76 6572 7473 2061 2055   """Converts a U
+00018160: 6e69 636f 6465 2063 6f64 6520 706f 696e  nicode code poin
+00018170: 7420 2869 6e63 6c75 6469 6e67 2037 2d62  t (including 7-b
+00018180: 6974 2041 5343 4949 2920 696e 746f 2074  it ASCII) into t
+00018190: 6865 2063 6861 7261 6374 6572 2074 6861  he character tha
+000181a0: 740a 2020 2020 6d61 7463 6865 7320 7468  t.    matches th
+000181b0: 6520 696e 7075 7420 556e 6963 6f64 652e  e input Unicode.
+000181c0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+000181d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000181e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000181f0: 5f64 6174 6166 7261 6d65 285b 3833 2c20  _dataframe([83, 
+00018200: 3333 2c20 3136 392c 2038 3336 342c 204e  33, 169, 8364, N
+00018210: 6f6e 655d 2c20 7363 6865 6d61 3d5b 2761  one], schema=['a
+00018220: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00018230: 6466 2e73 656c 6563 7428 6466 2e61 2c20  df.select(df.a, 
+00018240: 6368 6172 2864 662e 6129 2e61 735f 2827  char(df.a).as_('
+00018250: 6368 6172 2729 292e 736f 7274 2864 662e  char')).sort(df.
+00018260: 6129 2e73 686f 7728 290a 2020 2020 2020  a).show().      
+00018270: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00018280: 2d2d 2d0a 2020 2020 2020 2020 7c22 4122  ---.        |"A"
+00018290: 2020 207c 2243 4841 5222 2020 7c0a 2020     |"CHAR"  |.  
+000182a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000182b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000182c0: 7c4e 554c 4c20 207c 4e55 4c4c 2020 2020  |NULL  |NULL    
+000182d0: 7c0a 2020 2020 2020 2020 7c33 3320 2020  |.        |33   
+000182e0: 207c 2120 2020 2020 2020 7c0a 2020 2020   |!       |.    
+000182f0: 2020 2020 7c38 3320 2020 207c 5320 2020      |83    |S   
+00018300: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
+00018310: 3639 2020 207c c2a9 2020 2020 2020 207c  69   |..       |
+00018320: 0a20 2020 2020 2020 207c 3833 3634 2020  .        |8364  
+00018330: 7ce2 82ac 2020 2020 2020 207c 0a20 2020  |...       |.   
+00018340: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00018350: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00018360: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00018370: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00018380: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+00018390: 6368 6172 2229 0a20 2020 2072 6574 7572  char").    retur
+000183a0: 6e20 6275 696c 7469 6e28 2263 6861 7222  n builtin("char"
+000183b0: 2928 6329 0a0a 0a64 6566 2074 6f5f 6368  )(c)...def to_ch
+000183c0: 6172 2863 3a20 436f 6c75 6d6e 4f72 4e61  ar(c: ColumnOrNa
+000183d0: 6d65 2c20 666f 726d 6174 3a20 4f70 7469  me, format: Opti
+000183e0: 6f6e 616c 5b43 6f6c 756d 6e4f 724c 6974  onal[ColumnOrLit
+000183f0: 6572 616c 5374 725d 203d 204e 6f6e 6529  eralStr] = None)
+00018400: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00018410: 2222 2243 6f6e 7665 7274 7320 6120 556e  """Converts a Un
+00018420: 6963 6f64 6520 636f 6465 2070 6f69 6e74  icode code point
+00018430: 2028 696e 636c 7564 696e 6720 372d 6269   (including 7-bi
+00018440: 7420 4153 4349 4929 2069 6e74 6f20 7468  t ASCII) into th
+00018450: 6520 6368 6172 6163 7465 7220 7468 6174  e character that
+00018460: 0a20 2020 206d 6174 6368 6573 2074 6865  .    matches the
+00018470: 2069 6e70 7574 2055 6e69 636f 6465 2e0a   input Unicode..
+00018480: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00018490: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000184a0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000184b0: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
+000184c0: 332c 2034 5d2c 2073 6368 656d 613d 5b27  3, 4], schema=['
+000184d0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
+000184e0: 2064 662e 7365 6c65 6374 2874 6f5f 6368   df.select(to_ch
+000184f0: 6172 2863 6f6c 2827 6127 2929 2e61 735f  ar(col('a')).as_
+00018500: 2827 616e 7327 2929 2e63 6f6c 6c65 6374  ('ans')).collect
+00018510: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00018520: 414e 533d 2731 2729 2c20 526f 7728 414e  ANS='1'), Row(AN
+00018530: 533d 2732 2729 2c20 526f 7728 414e 533d  S='2'), Row(ANS=
+00018540: 2733 2729 2c20 526f 7728 414e 533d 2734  '3'), Row(ANS='4
+00018550: 2729 5d0a 0a20 2020 2045 7861 6d70 6c65  ')]..    Example
+00018560: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00018570: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+00018580: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00018590: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+000185a0: 6461 7461 6672 616d 6528 5b64 6174 6574  dataframe([datet
+000185b0: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+000185c0: 332c 2034 2c20 3136 292c 2064 6174 6574  3, 4, 16), datet
+000185d0: 696d 652e 6461 7465 7469 6d65 2832 3031  ime.datetime(201
+000185e0: 372c 2034 2c20 332c 2032 2c20 3539 2c20  7, 4, 3, 2, 59, 
+000185f0: 3337 2c20 3135 3329 5d2c 2073 6368 656d  37, 153)], schem
+00018600: 613d 5b27 6127 5d29 0a20 2020 2020 2020  a=['a']).       
+00018610: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
+00018620: 6f5f 6368 6172 2863 6f6c 2827 6127 2929  o_char(col('a'))
+00018630: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
+00018640: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00018650: 526f 7728 414e 533d 2732 3032 332d 3034  Row(ANS='2023-04
+00018660: 2d31 3620 3030 3a30 303a 3030 2e30 3030  -16 00:00:00.000
+00018670: 2729 2c20 526f 7728 414e 533d 2732 3031  '), Row(ANS='201
+00018680: 372d 3034 2d30 3320 3032 3a35 393a 3337  7-04-03 02:59:37
+00018690: 2e30 3030 2729 5d0a 0a20 2020 2022 2222  .000')]..    """
+000186a0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+000186b0: 5f69 665f 7374 7228 632c 2022 746f 5f63  _if_str(c, "to_c
+000186c0: 6861 7222 290a 2020 2020 7265 7475 726e  har").    return
+000186d0: 2028 0a20 2020 2020 2020 2062 7569 6c74   (.        built
+000186e0: 696e 2822 746f 5f63 6861 7222 2928 632c  in("to_char")(c,
+000186f0: 206c 6974 2866 6f72 6d61 7429 290a 2020   lit(format)).  
+00018700: 2020 2020 2020 6966 2066 6f72 6d61 7420        if format 
+00018710: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00018720: 2020 2020 656c 7365 2062 7569 6c74 696e      else builtin
+00018730: 2822 746f 5f63 6861 7222 2928 6329 0a20  ("to_char")(c). 
+00018740: 2020 2029 0a0a 0a64 6566 2074 6f5f 7469     )...def to_ti
+00018750: 6d65 2865 3a20 436f 6c75 6d6e 4f72 4e61  me(e: ColumnOrNa
+00018760: 6d65 2c20 666d 743a 204f 7074 696f 6e61  me, fmt: Optiona
+00018770: 6c5b 2243 6f6c 756d 6e22 5d20 3d20 4e6f  l["Column"] = No
+00018780: 6e65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ne) -> Column:. 
+00018790: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
+000187a0: 6e20 696e 7075 7420 6578 7072 6573 7369  n input expressi
+000187b0: 6f6e 2069 6e74 6f20 7468 6520 636f 7272  on into the corr
+000187c0: 6573 706f 6e64 696e 6720 7469 6d65 2e0a  esponding time..
+000187d0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+000187e0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+000187f0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00018800: 6461 7461 6672 616d 6528 5b27 3034 3a31  dataframe(['04:1
+00018810: 353a 3239 2e39 3939 275d 2c20 7363 6865  5:29.999'], sche
+00018820: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00018830: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00018840: 746f 5f74 696d 6528 636f 6c28 2261 2229  to_time(col("a")
+00018850: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00018860: 2020 2020 205b 526f 7728 544f 5f54 494d       [Row(TO_TIM
+00018870: 4528 2241 2229 3d64 6174 6574 696d 652e  E("A")=datetime.
+00018880: 7469 6d65 2834 2c20 3135 2c20 3239 2c20  time(4, 15, 29, 
+00018890: 3939 3930 3030 2929 5d0a 2020 2020 2222  999000))].    ""
+000188a0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+000188b0: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
+000188c0: 7469 6d65 2229 0a20 2020 2072 6574 7572  time").    retur
+000188d0: 6e20 6275 696c 7469 6e28 2274 6f5f 7469  n builtin("to_ti
+000188e0: 6d65 2229 2863 2c20 666d 7429 2069 6620  me")(c, fmt) if 
+000188f0: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
+00018900: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
+00018910: 5f74 696d 6522 2928 6329 0a0a 0a64 6566  _time")(c)...def
+00018920: 2074 6f5f 7469 6d65 7374 616d 7028 653a   to_timestamp(e:
+00018930: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
+00018940: 6d74 3a20 4f70 7469 6f6e 616c 5b22 436f  mt: Optional["Co
+00018950: 6c75 6d6e 225d 203d 204e 6f6e 6529 202d  lumn"] = None) -
+00018960: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00018970: 2243 6f6e 7665 7274 7320 616e 2069 6e70  "Converts an inp
+00018980: 7574 2065 7870 7265 7373 696f 6e20 696e  ut expression in
+00018990: 746f 2074 6865 2063 6f72 7265 7370 6f6e  to the correspon
+000189a0: 6469 6e67 2074 696d 6573 7461 6d70 2e0a  ding timestamp..
+000189b0: 0a20 2020 2050 6572 2064 6566 6175 6c74  .    Per default
+000189c0: 2066 6d74 2069 7320 7365 7420 746f 2061   fmt is set to a
+000189d0: 7574 6f2c 2077 6869 6368 206d 616b 6573  uto, which makes
+000189e0: 2053 6e6f 7766 6c61 6b65 2064 6574 6563   Snowflake detec
+000189f0: 7420 7468 6520 666f 726d 6174 2061 7574  t the format aut
+00018a00: 6f6d 6174 6963 616c 6c79 2e20 5769 7468  omatically. With
+00018a10: 2060 746f 5f74 696d 6573 7461 6d70 6020   `to_timestamp` 
+00018a20: 7374 7269 6e67 730a 2020 2020 6361 6e20  strings.    can 
+00018a30: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+00018a40: 7469 6d65 7374 616d 7073 2e20 5468 6520  timestamps. The 
+00018a50: 666f 726d 6174 2068 6173 2074 6f20 6265  format has to be
+00018a60: 2073 7065 6369 6669 6564 2061 6363 6f72   specified accor
+00018a70: 6469 6e67 2074 6f20 7468 6520 7275 6c65  ding to the rule
+00018a80: 7320 7365 7420 666f 7274 6820 696e 0a20  s set forth in. 
+00018a90: 2020 203c 6874 7470 733a 2f2f 646f 6373     <https://docs
+00018aa0: 2e73 6e6f 7766 6c61 6b65 2e63 6f6d 2f65  .snowflake.com/e
+00018ab0: 6e2f 7371 6c2d 7265 6665 7265 6e63 652f  n/sql-reference/
+00018ac0: 6675 6e63 7469 6f6e 732d 636f 6e76 6572  functions-conver
+00018ad0: 7369 6f6e 2364 6174 652d 616e 642d 7469  sion#date-and-ti
+00018ae0: 6d65 2d66 6f72 6d61 7473 2d69 6e2d 636f  me-formats-in-co
+00018af0: 6e76 6572 7369 6f6e 2d66 756e 6374 696f  nversion-functio
+00018b00: 6e73 3e0a 0a20 2020 2045 7861 6d70 6c65  ns>..    Example
+00018b10: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+00018b20: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00018b30: 7465 5f64 6174 6166 7261 6d65 285b 2732  te_dataframe(['2
+00018b40: 3031 392d 3031 2d33 3120 3031 3a30 323a  019-01-31 01:02:
+00018b50: 3033 2e30 3034 275d 2c20 7363 6865 6d61  03.004'], schema
+00018b60: 3d5b 2761 275d 290a 2020 2020 2020 2020  =['a']).        
+00018b70: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
+00018b80: 5f74 696d 6573 7461 6d70 2863 6f6c 2822  _timestamp(col("
+00018b90: 6122 2929 2e61 735f 2822 616e 7322 2929  a")).as_("ans"))
+00018ba0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00018bb0: 2020 205b 526f 7728 414e 533d 6461 7465     [Row(ANS=date
+00018bc0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+00018bd0: 3139 2c20 312c 2033 312c 2031 2c20 322c  19, 1, 31, 1, 2,
+00018be0: 2033 2c20 3430 3030 2929 5d0a 2020 2020   3, 4000))].    
+00018bf0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00018c00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00018c10: 6672 616d 6528 5b22 3230 3230 2d30 352d  frame(["2020-05-
+00018c20: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
+00018c30: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+00018c40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00018c50: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00018c60: 616d 7028 636f 6c28 2261 2229 2c20 6c69  amp(col("a"), li
+00018c70: 7428 2259 5959 592d 4d4d 2d44 4420 4848  t("YYYY-MM-DD HH
+00018c80: 3234 3a4d 493a 5353 2e46 4633 2229 292e  24:MI:SS.FF3")).
+00018c90: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
+00018ca0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00018cb0: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
+00018cc0: 6461 7465 7469 6d65 2832 3032 302c 2035  datetime(2020, 5
+00018cd0: 2c20 312c 2031 332c 2031 312c 2032 3029  , 1, 13, 11, 20)
+00018ce0: 295d 0a0a 2020 2020 416e 6f74 6865 7220  )]..    Another 
+00018cf0: 6f70 7469 6f6e 2069 7320 746f 2063 6f6e  option is to con
+00018d00: 7665 7274 2064 6174 6573 2069 6e74 6f20  vert dates into 
+00018d10: 7469 6d65 7374 616d 7073 0a0a 2020 2020  timestamps..    
+00018d20: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+00018d30: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+00018d40: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
+00018d50: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00018d60: 7265 6174 6544 6174 6146 7261 6d65 285b  reateDataFrame([
+00018d70: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00018d80: 6528 3230 3232 2c20 3132 2c20 3235 2c20  e(2022, 12, 25, 
+00018d90: 3133 2c20 3539 2c20 3338 2c20 3436 3729  13, 59, 38, 467)
+00018da0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00018db0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00018dc0: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00018dd0: 616d 7028 636f 6c28 2261 2229 2929 2e63  amp(col("a"))).c
+00018de0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00018df0: 205b 526f 7728 544f 5f54 494d 4553 5441   [Row(TO_TIMESTA
+00018e00: 4d50 2822 4122 293d 6461 7465 7469 6d65  MP("A")=datetime
+00018e10: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
+00018e20: 3132 2c20 3235 2c20 3133 2c20 3539 2c20  12, 25, 13, 59, 
+00018e30: 3338 2c20 3436 3729 295d 0a20 2020 2020  38, 467))].     
+00018e40: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00018e50: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
+00018e60: 616d 6528 5b64 6174 6574 696d 652e 6461  ame([datetime.da
+00018e70: 7465 2832 3032 332c 2033 2c20 3129 5d2c  te(2023, 3, 1)],
+00018e80: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00018e90: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00018ea0: 6c65 6374 2874 6f5f 7469 6d65 7374 616d  lect(to_timestam
+00018eb0: 7028 636f 6c28 2261 2229 2929 2e63 6f6c  p(col("a"))).col
+00018ec0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00018ed0: 526f 7728 544f 5f54 494d 4553 5441 4d50  Row(TO_TIMESTAMP
+00018ee0: 2822 4122 293d 6461 7465 7469 6d65 2e64  ("A")=datetime.d
+00018ef0: 6174 6574 696d 6528 3230 3233 2c20 332c  atetime(2023, 3,
+00018f00: 2031 2c20 302c 2030 2929 5d0a 0a20 2020   1, 0, 0))]..   
+00018f10: 2049 6e74 6567 6572 7320 6361 6e20 6265   Integers can be
+00018f20: 2063 6f6e 7665 7274 6564 2069 6e74 6f20   converted into 
+00018f30: 6120 7469 6d65 7374 616d 7020 6173 2077  a timestamp as w
+00018f40: 656c 6c2c 2062 7920 7072 6f76 6964 696e  ell, by providin
+00018f50: 6720 6f70 7469 6f6e 616c 6c79 2061 2073  g optionally a s
+00018f60: 6361 6c65 2061 7320 616e 2069 6e74 6567  cale as an integ
+00018f70: 6572 2061 7320 6c69 6e65 6420 6f75 7420  er as lined out 
+00018f80: 696e 0a20 2020 203c 6874 7470 733a 2f2f  in.    <https://
+00018f90: 646f 6373 2e73 6e6f 7766 6c61 6b65 2e63  docs.snowflake.c
+00018fa0: 6f6d 2f65 6e2f 7371 6c2d 7265 6665 7265  om/en/sql-refere
+00018fb0: 6e63 652f 6675 6e63 7469 6f6e 732f 746f  nce/functions/to
+00018fc0: 5f74 696d 6573 7461 6d70 2375 7361 6765  _timestamp#usage
+00018fd0: 2d6e 6f74 6573 3e2e 2043 7572 7265 6e74  -notes>. Current
+00018fe0: 6c79 2053 6e6f 7770 6172 6b20 646f 6573  ly Snowpark does
+00018ff0: 2073 7570 706f 7274 0a20 2020 2069 6e74   support.    int
+00019000: 6567 6572 7320 696e 2074 6865 2072 616e  egers in the ran
+00019010: 6765 206f 6620 616e 2038 2d62 7974 6520  ge of an 8-byte 
+00019020: 7369 676e 6564 2069 6e74 6567 6572 206f  signed integer o
+00019030: 6e6c 792e 0a0a 2020 2020 4578 616d 706c  nly...    Exampl
+00019040: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00019050: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00019060: 6174 6544 6174 6146 7261 6d65 285b 3230  ateDataFrame([20
+00019070: 2c20 3331 3533 3630 3030 3030 305d 2c20  , 31536000000], 
+00019080: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
+00019090: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000190a0: 6563 7428 746f 5f74 696d 6573 7461 6d70  ect(to_timestamp
+000190b0: 2863 6f6c 2822 6122 2929 292e 636f 6c6c  (col("a"))).coll
+000190c0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+000190d0: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
+000190e0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+000190f0: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
+00019100: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
+00019110: 6f77 2854 4f5f 5449 4d45 5354 414d 5028  ow(TO_TIMESTAMP(
+00019120: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+00019130: 7465 7469 6d65 2832 3936 392c 2035 2c20  tetime(2969, 5, 
+00019140: 332c 2030 2c20 3029 295d 0a20 2020 2020  3, 0, 0))].     
+00019150: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00019160: 2874 6f5f 7469 6d65 7374 616d 7028 636f  (to_timestamp(co
+00019170: 6c28 2261 2229 2c20 6c69 7428 3929 2929  l("a"), lit(9)))
+00019180: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00019190: 2020 205b 526f 7728 544f 5f54 494d 4553     [Row(TO_TIMES
+000191a0: 5441 4d50 2822 4122 2c20 3929 3d64 6174  TAMP("A", 9)=dat
+000191b0: 6574 696d 652e 6461 7465 7469 6d65 2831  etime.datetime(1
+000191c0: 3937 302c 2031 2c20 312c 2030 2c20 3029  970, 1, 1, 0, 0)
+000191d0: 292c 2052 6f77 2854 4f5f 5449 4d45 5354  ), Row(TO_TIMEST
+000191e0: 414d 5028 2241 222c 2039 293d 6461 7465  AMP("A", 9)=date
+000191f0: 7469 6d65 2e64 6174 6574 696d 6528 3139  time.datetime(19
+00019200: 3730 2c20 312c 2031 2c20 302c 2030 2c20  70, 1, 1, 0, 0, 
+00019210: 3331 2c20 3533 3630 3030 2929 5d0a 0a20  31, 536000))].. 
+00019220: 2020 204c 6172 6765 7220 6e75 6d62 6572     Larger number
+00019230: 7320 7374 6f72 6564 2069 6e20 6120 7374  s stored in a st
+00019240: 7269 6e67 2063 616e 2062 6520 616c 736f  ring can be also
+00019250: 2063 6f6e 7665 7274 6564 2076 6961 2074   converted via t
+00019260: 6869 7320 6170 7072 6f61 6368 0a0a 2020  his approach..  
+00019270: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+00019280: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00019290: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+000192a0: 7261 6d65 285b 2732 3027 2c20 2733 3135  rame(['20', '315
+000192b0: 3336 3030 3030 3030 272c 2027 3331 3533  36000000', '3153
+000192c0: 3630 3030 3030 3030 3030 272c 2027 3331  6000000000', '31
+000192d0: 3533 3630 3030 3030 3030 3030 3030 3027  536000000000000'
+000192e0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
+000192f0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00019300: 7365 6c65 6374 2874 6f5f 7469 6d65 7374  select(to_timest
+00019310: 616d 7028 636f 6c28 2261 2229 292e 6173  amp(col("a")).as
+00019320: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
+00019330: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00019340: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
+00019350: 7465 7469 6d65 2831 3937 302c 2031 2c20  tetime(1970, 1, 
+00019360: 312c 2030 2c20 302c 2032 3029 292c 2052  1, 0, 0, 20)), R
+00019370: 6f77 2841 4e53 3d64 6174 6574 696d 652e  ow(ANS=datetime.
+00019380: 6461 7465 7469 6d65 2831 3937 312c 2031  datetime(1971, 1
+00019390: 2c20 312c 2030 2c20 3029 292c 2052 6f77  , 1, 0, 0)), Row
+000193a0: 2841 4e53 3d64 6174 6574 696d 652e 6461  (ANS=datetime.da
+000193b0: 7465 7469 6d65 2831 3937 312c 2031 2c20  tetime(1971, 1, 
+000193c0: 312c 2030 2c20 3029 292c 2052 6f77 2841  1, 0, 0)), Row(A
+000193d0: 4e53 3d64 6174 6574 696d 652e 6461 7465  NS=datetime.date
+000193e0: 7469 6d65 2831 3937 312c 2031 2c20 312c  time(1971, 1, 1,
+000193f0: 2030 2c20 3029 295d 0a20 2020 2022 2222   0, 0))].    """
+00019400: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00019410: 5f69 665f 7374 7228 652c 2022 746f 5f74  _if_str(e, "to_t
+00019420: 696d 6573 7461 6d70 2229 0a20 2020 2072  imestamp").    r
+00019430: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+00019440: 6275 696c 7469 6e28 2274 6f5f 7469 6d65  builtin("to_time
+00019450: 7374 616d 7022 2928 632c 2066 6d74 290a  stamp")(c, fmt).
+00019460: 2020 2020 2020 2020 6966 2066 6d74 2069          if fmt i
+00019470: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+00019480: 2020 2065 6c73 6520 6275 696c 7469 6e28     else builtin(
+00019490: 2274 6f5f 7469 6d65 7374 616d 7022 2928  "to_timestamp")(
+000194a0: 6329 0a20 2020 2029 0a0a 0a64 6566 2074  c).    )...def t
+000194b0: 6f5f 6461 7465 2865 3a20 436f 6c75 6d6e  o_date(e: Column
+000194c0: 4f72 4e61 6d65 2c20 666d 743a 204f 7074  OrName, fmt: Opt
+000194d0: 696f 6e61 6c5b 2243 6f6c 756d 6e22 5d20  ional["Column"] 
+000194e0: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
+000194f0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
+00019500: 7473 2061 6e20 696e 7075 7420 6578 7072  ts an input expr
+00019510: 6573 7369 6f6e 2069 6e74 6f20 6120 6461  ession into a da
+00019520: 7465 2e0a 0a20 2020 2045 7861 6d70 6c65  te...    Example
+00019530: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00019540: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00019550: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
+00019560: 3230 3133 2d30 352d 3137 272c 2027 3230  2013-05-17', '20
+00019570: 3133 2d30 352d 3137 275d 2c20 7363 6865  13-05-17'], sche
+00019580: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00019590: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000195a0: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
+000195b0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
+000195c0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000195d0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
+000195e0: 652e 6461 7465 2832 3031 332c 2035 2c20  e.date(2013, 5, 
+000195f0: 3137 2929 2c20 526f 7728 414e 533d 6461  17)), Row(ANS=da
+00019600: 7465 7469 6d65 2e64 6174 6528 3230 3133  tetime.date(2013
+00019610: 2c20 352c 2031 3729 295d 0a0a 2020 2020  , 5, 17))]..    
+00019620: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00019630: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00019640: 6672 616d 6528 5b27 3331 3533 3630 3030  frame(['31536000
+00019650: 3030 3030 3030 272c 2027 3731 3533 3630  000000', '715360
+00019660: 3034 3030 3030 3030 275d 2c20 7363 6865  04000000'], sche
+00019670: 6d61 3d5b 2761 275d 290a 2020 2020 2020  ma=['a']).      
+00019680: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00019690: 746f 5f64 6174 6528 636f 6c28 2761 2729  to_date(col('a')
+000196a0: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
+000196b0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000196c0: 5b52 6f77 2841 4e53 3d64 6174 6574 696d  [Row(ANS=datetim
+000196d0: 652e 6461 7465 2831 3937 312c 2031 2c20  e.date(1971, 1, 
+000196e0: 3129 292c 2052 6f77 2841 4e53 3d64 6174  1)), Row(ANS=dat
+000196f0: 6574 696d 652e 6461 7465 2831 3937 322c  etime.date(1972,
+00019700: 2034 2c20 3729 295d 0a0a 2020 2020 2222   4, 7))]..    ""
+00019710: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00019720: 6c5f 6966 5f73 7472 2865 2c20 2274 6f5f  l_if_str(e, "to_
+00019730: 6461 7465 2229 0a20 2020 2072 6574 7572  date").    retur
+00019740: 6e20 6275 696c 7469 6e28 2274 6f5f 6461  n builtin("to_da
+00019750: 7465 2229 2863 2c20 666d 7429 2069 6620  te")(c, fmt) if 
+00019760: 666d 7420 6973 206e 6f74 204e 6f6e 6520  fmt is not None 
+00019770: 656c 7365 2062 7569 6c74 696e 2822 746f  else builtin("to
+00019780: 5f64 6174 6522 2928 6329 0a0a 0a64 6566  _date")(c)...def
+00019790: 2063 7572 7265 6e74 5f74 696d 6573 7461   current_timesta
+000197a0: 6d70 2829 202d 3e20 436f 6c75 6d6e 3a0a  mp() -> Column:.
+000197b0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+000197c0: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
+000197d0: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
+000197e0: 7465 6d2e 0a0a 2020 2020 4578 616d 706c  tem...    Exampl
+000197f0: 653a 0a20 2020 2020 2020 203e 3e3e 2069  e:.        >>> i
+00019800: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+00019810: 2020 2020 2020 203e 3e3e 2072 6573 756c         >>> resul
+00019820: 7420 3d20 7365 7373 696f 6e2e 6372 6561  t = session.crea
+00019830: 7465 5f64 6174 6166 7261 6d65 285b 315d  te_dataframe([1]
+00019840: 292e 7365 6c65 6374 2863 7572 7265 6e74  ).select(current
+00019850: 5f74 696d 6573 7461 6d70 2829 292e 636f  _timestamp()).co
+00019860: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00019870: 3e3e 3e20 6173 7365 7274 2069 7369 6e73  >>> assert isins
+00019880: 7461 6e63 6528 7265 7375 6c74 5b30 5d5b  tance(result[0][
+00019890: 2243 5552 5245 4e54 5f54 494d 4553 5441  "CURRENT_TIMESTA
+000198a0: 4d50 2829 225d 2c20 6461 7465 7469 6d65  MP()"], datetime
+000198b0: 2e64 6174 6574 696d 6529 0a20 2020 2022  .datetime).    "
+000198c0: 2222 0a0a 2020 2020 7265 7475 726e 2062  ""..    return b
+000198d0: 7569 6c74 696e 2822 6375 7272 656e 745f  uiltin("current_
+000198e0: 7469 6d65 7374 616d 7022 2928 290a 0a0a  timestamp")()...
+000198f0: 6465 6620 6375 7272 656e 745f 6461 7465  def current_date
+00019900: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
+00019910: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+00019920: 2063 7572 7265 6e74 2064 6174 6520 666f   current date fo
+00019930: 7220 7468 6520 7379 7374 656d 2e0a 0a20  r the system... 
+00019940: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
+00019950: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+00019960: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+00019970: 3e3e 3e20 7265 7375 6c74 203d 2073 6573  >>> result = ses
+00019980: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00019990: 6672 616d 6528 5b31 5d29 2e73 656c 6563  frame([1]).selec
+000199a0: 7428 6375 7272 656e 745f 6461 7465 2829  t(current_date()
+000199b0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+000199c0: 2020 2020 3e3e 3e20 6173 7365 7274 2069      >>> assert i
+000199d0: 7369 6e73 7461 6e63 6528 7265 7375 6c74  sinstance(result
+000199e0: 5b30 5d5b 2243 5552 5245 4e54 5f44 4154  [0]["CURRENT_DAT
+000199f0: 4528 2922 5d2c 2064 6174 6574 696d 652e  E()"], datetime.
+00019a00: 6461 7465 290a 2020 2020 2222 220a 2020  date).    """.  
+00019a10: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00019a20: 2822 6375 7272 656e 745f 6461 7465 2229  ("current_date")
+00019a30: 2829 0a0a 0a64 6566 2063 7572 7265 6e74  ()...def current
+00019a40: 5f74 696d 6528 2920 2d3e 2043 6f6c 756d  _time() -> Colum
+00019a50: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00019a60: 7320 7468 6520 6375 7272 656e 7420 7469  s the current ti
+00019a70: 6d65 2066 6f72 2074 6865 2073 7973 7465  me for the syste
+00019a80: 6d2e 0a0a 2020 2020 4578 616d 706c 653a  m...    Example:
+00019a90: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00019aa0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+00019ab0: 2020 2020 203e 3e3e 2072 6573 756c 7420       >>> result 
+00019ac0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00019ad0: 5f64 6174 6166 7261 6d65 285b 315d 292e  _dataframe([1]).
+00019ae0: 7365 6c65 6374 2863 7572 7265 6e74 5f74  select(current_t
+00019af0: 696d 6528 2929 2e63 6f6c 6c65 6374 2829  ime()).collect()
+00019b00: 0a20 2020 2020 2020 203e 3e3e 2061 7373  .        >>> ass
+00019b10: 6572 7420 6973 696e 7374 616e 6365 2872  ert isinstance(r
+00019b20: 6573 756c 745b 305d 5b22 4355 5252 454e  esult[0]["CURREN
+00019b30: 545f 5449 4d45 2829 225d 2c20 6461 7465  T_TIME()"], date
+00019b40: 7469 6d65 2e74 696d 6529 0a20 2020 2022  time.time).    "
+00019b50: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
+00019b60: 696c 7469 6e28 2263 7572 7265 6e74 5f74  iltin("current_t
+00019b70: 696d 6522 2928 290a 0a0a 6465 6620 686f  ime")()...def ho
+00019b80: 7572 2865 3a20 436f 6c75 6d6e 4f72 4e61  ur(e: ColumnOrNa
+00019b90: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+00019ba0: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
+00019bb0: 6374 7320 7468 6520 686f 7572 2066 726f  cts the hour fro
+00019bc0: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
+00019bd0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+00019be0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00019bf0: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00019c00: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
+00019c10: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00019c20: 7465 5f64 6174 6166 7261 6d65 285b 0a20  te_dataframe([. 
+00019c30: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+00019c40: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+00019c50: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+00019c60: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
+00019c70: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+00019c80: 483a 254d 3a25 532e 2566 2229 2c0a 2020  H:%M:%S.%f"),.  
+00019c90: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
+00019ca0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+00019cb0: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+00019cc0: 382d 3231 2030 313a 3330 3a30 352e 3030  8-21 01:30:05.00
+00019cd0: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+00019ce0: 3a25 4d3a 2553 2e25 6622 290a 2020 2020  :%M:%S.%f").    
+00019cf0: 2020 2020 2e2e 2e20 5d2c 2073 6368 656d      ... ], schem
+00019d00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+00019d10: 203e 3e3e 2064 662e 7365 6c65 6374 2868   >>> df.select(h
+00019d20: 6f75 7228 2261 2229 292e 636f 6c6c 6563  our("a")).collec
+00019d30: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00019d40: 2848 4f55 5228 2241 2229 3d31 3329 2c20  (HOUR("A")=13), 
+00019d50: 526f 7728 484f 5552 2822 4122 293d 3129  Row(HOUR("A")=1)
+00019d60: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00019d70: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00019d80: 2865 2c20 2268 6f75 7222 290a 2020 2020  (e, "hour").    
+00019d90: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00019da0: 686f 7572 2229 2863 290a 0a0a 6465 6620  hour")(c)...def 
+00019db0: 6c61 7374 5f64 6179 2865 3a20 436f 6c75  last_day(e: Colu
+00019dc0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00019dd0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00019de0: 2052 6574 7572 6e73 2074 6865 206c 6173   Returns the las
+00019df0: 7420 6461 7920 6f66 2074 6865 2073 7065  t day of the spe
+00019e00: 6369 6669 6564 2064 6174 6520 7061 7274  cified date part
+00019e10: 2066 6f72 2061 2064 6174 6520 6f72 2074   for a date or t
+00019e20: 696d 6573 7461 6d70 2e0a 2020 2020 436f  imestamp..    Co
+00019e30: 6d6d 6f6e 6c79 2075 7365 6420 746f 2072  mmonly used to r
+00019e40: 6574 7572 6e20 7468 6520 6c61 7374 2064  eturn the last d
+00019e50: 6179 206f 6620 7468 6520 6d6f 6e74 6820  ay of the month 
+00019e60: 666f 7220 6120 6461 7465 206f 7220 7469  for a date or ti
+00019e70: 6d65 7374 616d 702e 0a0a 2020 2020 4578  mestamp...    Ex
+00019e80: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00019e90: 203e 3e3e 2069 6d70 6f72 7420 6461 7465   >>> import date
+00019ea0: 7469 6d65 0a20 2020 2020 2020 203e 3e3e  time.        >>>
+00019eb0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00019ec0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00019ed0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00019ee0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00019ef0: 6d65 2e73 7472 7074 696d 6528 2232 3032  me.strptime("202
+00019f00: 302d 3035 2d30 3120 3133 3a31 313a 3230  0-05-01 13:11:20
+00019f10: 2e30 3030 222c 2022 2559 2d25 6d2d 2564  .000", "%Y-%m-%d
+00019f20: 2025 483a 254d 3a25 532e 2566 2229 2c0a   %H:%M:%S.%f"),.
+00019f30: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00019f40: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00019f50: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+00019f60: 2d30 382d 3231 2030 313a 3330 3a30 352e  -08-21 01:30:05.
+00019f70: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+00019f80: 2548 3a25 4d3a 2553 2e25 6622 290a 2020  %H:%M:%S.%f").  
+00019f90: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
+00019fa0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00019fb0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00019fc0: 286c 6173 745f 6461 7928 2261 2229 292e  (last_day("a")).
+00019fd0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00019fe0: 2020 5b52 6f77 284c 4153 545f 4441 5928    [Row(LAST_DAY(
+00019ff0: 2241 2229 3d64 6174 6574 696d 652e 6461  "A")=datetime.da
+0001a000: 7465 2832 3032 302c 2035 2c20 3331 2929  te(2020, 5, 31))
+0001a010: 2c20 526f 7728 4c41 5354 5f44 4159 2822  , Row(LAST_DAY("
+0001a020: 4122 293d 6461 7465 7469 6d65 2e64 6174  A")=datetime.dat
+0001a030: 6528 3230 3230 2c20 382c 2033 3129 295d  e(2020, 8, 31))]
+0001a040: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0001a050: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001a060: 652c 2022 6c61 7374 5f64 6179 2229 0a20  e, "last_day"). 
+0001a070: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0001a080: 6e28 226c 6173 745f 6461 7922 2928 6329  n("last_day")(c)
+0001a090: 0a0a 0a64 6566 206d 696e 7574 6528 653a  ...def minute(e:
+0001a0a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0001a0b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0001a0c0: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+0001a0d0: 6865 206d 696e 7574 6520 6672 6f6d 2061  he minute from a
+0001a0e0: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
+0001a0f0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
+0001a100: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001a110: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001a120: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001a130: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0001a140: 6461 7461 6672 616d 6528 5b0a 2020 2020  dataframe([.    
+0001a150: 2020 2020 2e2e 2e20 2020 2020 6461 7465      ...     date
+0001a160: 7469 6d65 2e64 6174 6574 696d 652e 7374  time.datetime.st
+0001a170: 7270 7469 6d65 2822 3230 3230 2d30 352d  rptime("2020-05-
+0001a180: 3031 2031 333a 3131 3a32 302e 3030 3022  01 13:11:20.000"
+0001a190: 2c20 2225 592d 256d 2d25 6420 2548 3a25  , "%Y-%m-%d %H:%
+0001a1a0: 4d3a 2553 2e25 6622 292c 0a20 2020 2020  M:%S.%f"),.     
+0001a1b0: 2020 202e 2e2e 2020 2020 2064 6174 6574     ...     datet
+0001a1c0: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+0001a1d0: 7074 696d 6528 2232 3032 302d 3038 2d32  ptime("2020-08-2
+0001a1e0: 3120 3031 3a33 303a 3035 2e30 3030 222c  1 01:30:05.000",
+0001a1f0: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+0001a200: 3a25 532e 2566 2229 0a20 2020 2020 2020  :%S.%f").       
+0001a210: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
+0001a220: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+0001a230: 3e20 6466 2e73 656c 6563 7428 6d69 6e75  > df.select(minu
+0001a240: 7465 2822 6122 2929 2e63 6f6c 6c65 6374  te("a")).collect
+0001a250: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0001a260: 4d49 4e55 5445 2822 4122 293d 3131 292c  MINUTE("A")=11),
+0001a270: 2052 6f77 284d 494e 5554 4528 2241 2229   Row(MINUTE("A")
+0001a280: 3d33 3029 5d0a 2020 2020 2222 220a 2020  =30)].    """.  
+0001a290: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0001a2a0: 5f73 7472 2865 2c20 226d 696e 7574 6522  _str(e, "minute"
+0001a2b0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0001a2c0: 6c74 696e 2822 6d69 6e75 7465 2229 2863  ltin("minute")(c
+0001a2d0: 290a 0a0a 6465 6620 6e65 7874 5f64 6179  )...def next_day
+0001a2e0: 2864 6174 653a 2043 6f6c 756d 6e4f 724e  (date: ColumnOrN
+0001a2f0: 616d 652c 2064 6179 5f6f 665f 7765 656b  ame, day_of_week
+0001a300: 3a20 436f 6c75 6d6e 4f72 4c69 7465 7261  : ColumnOrLitera
+0001a310: 6c29 202d 3e20 436f 6c75 6d6e 3a0a 2020  l) -> Column:.  
+0001a320: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
+0001a330: 7320 7468 6520 6461 7465 206f 6620 7468  s the date of th
+0001a340: 6520 6669 7273 7420 7370 6563 6966 6965  e first specifie
+0001a350: 6420 444f 5720 2864 6179 206f 6620 7765  d DOW (day of we
+0001a360: 656b 2920 7468 6174 206f 6363 7572 7320  ek) that occurs 
+0001a370: 6166 7465 7220 7468 6520 696e 7075 7420  after the input 
+0001a380: 6461 7465 2e0a 0a20 2020 2045 7861 6d70  date...    Examp
+0001a390: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0001a3a0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+0001a3b0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0001a3c0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001a3d0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
+0001a3e0: 2020 2020 2020 2e2e 2e20 2020 2020 2864        ...     (d
+0001a3f0: 6174 6574 696d 652e 6461 7465 2e66 726f  atetime.date.fro
+0001a400: 6d69 736f 666f 726d 6174 2822 3230 3230  misoformat("2020
+0001a410: 2d30 382d 3031 2229 2c20 226d 6f22 292c  -08-01"), "mo"),
+0001a420: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001a430: 2028 6461 7465 7469 6d65 2e64 6174 652e   (datetime.date.
+0001a440: 6672 6f6d 6973 6f66 6f72 6d61 7428 2232  fromisoformat("2
+0001a450: 3032 302d 3132 2d30 3122 292c 2022 7765  020-12-01"), "we
+0001a460: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
+0001a470: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+0001a480: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+0001a490: 3e20 6466 2e73 656c 6563 7428 6e65 7874  > df.select(next
+0001a4a0: 5f64 6179 2822 6122 2c20 636f 6c28 2262  _day("a", col("b
+0001a4b0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+0001a4c0: 2020 2020 2020 205b 526f 7728 4e45 5854         [Row(NEXT
+0001a4d0: 5f44 4159 2822 4122 2c20 2242 2229 3d64  _DAY("A", "B")=d
+0001a4e0: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+0001a4f0: 302c 2038 2c20 3329 292c 2052 6f77 284e  0, 8, 3)), Row(N
+0001a500: 4558 545f 4441 5928 2241 222c 2022 4222  EXT_DAY("A", "B"
+0001a510: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
+0001a520: 3230 3230 2c20 3132 2c20 3229 295d 0a20  2020, 12, 2))]. 
+0001a530: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001a540: 6c65 6374 286e 6578 745f 6461 7928 2261  lect(next_day("a
+0001a550: 222c 2022 6672 2229 292e 636f 6c6c 6563  ", "fr")).collec
+0001a560: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001a570: 284e 4558 545f 4441 5928 2241 222c 2027  (NEXT_DAY("A", '
+0001a580: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
+0001a590: 7465 2832 3032 302c 2038 2c20 3729 292c  te(2020, 8, 7)),
+0001a5a0: 2052 6f77 284e 4558 545f 4441 5928 2241   Row(NEXT_DAY("A
+0001a5b0: 222c 2027 4652 2729 3d64 6174 6574 696d  ", 'FR')=datetim
+0001a5c0: 652e 6461 7465 2832 3032 302c 2031 322c  e.date(2020, 12,
+0001a5d0: 2034 2929 5d0a 2020 2020 2222 220a 2020   4))].    """.  
+0001a5e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+0001a5f0: 5f73 7472 2864 6174 652c 2022 6e65 7874  _str(date, "next
+0001a600: 5f64 6179 2229 0a20 2020 2072 6574 7572  _day").    retur
+0001a610: 6e20 6275 696c 7469 6e28 226e 6578 745f  n builtin("next_
+0001a620: 6461 7922 2928 632c 2043 6f6c 756d 6e2e  day")(c, Column.
+0001a630: 5f74 6f5f 6578 7072 2864 6179 5f6f 665f  _to_expr(day_of_
+0001a640: 7765 656b 2929 0a0a 0a64 6566 2070 7265  week))...def pre
+0001a650: 7669 6f75 735f 6461 7928 6461 7465 3a20  vious_day(date: 
+0001a660: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6461  ColumnOrName, da
+0001a670: 795f 6f66 5f77 6565 6b3a 2043 6f6c 756d  y_of_week: Colum
+0001a680: 6e4f 724c 6974 6572 616c 2920 2d3e 2043  nOrLiteral) -> C
+0001a690: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+0001a6a0: 2020 2052 6574 7572 6e73 2074 6865 2064     Returns the d
+0001a6b0: 6174 6520 6f66 2074 6865 2066 6972 7374  ate of the first
+0001a6c0: 2073 7065 6369 6669 6564 2044 4f57 2028   specified DOW (
+0001a6d0: 6461 7920 6f66 2077 6565 6b29 2074 6861  day of week) tha
+0001a6e0: 7420 6f63 6375 7273 2062 6566 6f72 6520  t occurs before 
+0001a6f0: 7468 6520 696e 7075 7420 6461 7465 2e0a  the input date..
+0001a700: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0001a710: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0001a720: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+0001a730: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001a740: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001a750: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
+0001a760: 2e2e 2e20 2020 2020 2864 6174 6574 696d  ...     (datetim
+0001a770: 652e 6461 7465 2e66 726f 6d69 736f 666f  e.date.fromisofo
+0001a780: 726d 6174 2822 3230 3230 2d30 382d 3031  rmat("2020-08-01
+0001a790: 2229 2c20 226d 6f22 292c 0a20 2020 2020  "), "mo"),.     
+0001a7a0: 2020 202e 2e2e 2020 2020 2028 6461 7465     ...     (date
+0001a7b0: 7469 6d65 2e64 6174 652e 6672 6f6d 6973  time.date.fromis
+0001a7c0: 6f66 6f72 6d61 7428 2232 3032 302d 3132  oformat("2020-12
+0001a7d0: 2d30 3122 292c 2022 7765 2229 2c0a 2020  -01"), "we"),.  
+0001a7e0: 2020 2020 2020 2e2e 2e20 5d2c 2073 6368        ... ], sch
+0001a7f0: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+0001a800: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0001a810: 656c 6563 7428 7072 6576 696f 7573 5f64  elect(previous_d
+0001a820: 6179 2822 6122 2c20 636f 6c28 2262 2229  ay("a", col("b")
+0001a830: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0001a840: 2020 2020 205b 526f 7728 5052 4556 494f       [Row(PREVIO
+0001a850: 5553 5f44 4159 2822 4122 2c20 2242 2229  US_DAY("A", "B")
+0001a860: 3d64 6174 6574 696d 652e 6461 7465 2832  =datetime.date(2
+0001a870: 3032 302c 2037 2c20 3237 2929 2c20 526f  020, 7, 27)), Ro
+0001a880: 7728 5052 4556 494f 5553 5f44 4159 2822  w(PREVIOUS_DAY("
+0001a890: 4122 2c20 2242 2229 3d64 6174 6574 696d  A", "B")=datetim
+0001a8a0: 652e 6461 7465 2832 3032 302c 2031 312c  e.date(2020, 11,
+0001a8b0: 2032 3529 295d 0a20 2020 2020 2020 203e   25))].        >
+0001a8c0: 3e3e 2064 662e 7365 6c65 6374 2870 7265  >> df.select(pre
+0001a8d0: 7669 6f75 735f 6461 7928 2261 222c 2022  vious_day("a", "
+0001a8e0: 6672 2229 292e 636f 6c6c 6563 7428 290a  fr")).collect().
+0001a8f0: 2020 2020 2020 2020 5b52 6f77 2850 5245          [Row(PRE
+0001a900: 5649 4f55 535f 4441 5928 2241 222c 2027  VIOUS_DAY("A", '
+0001a910: 4652 2729 3d64 6174 6574 696d 652e 6461  FR')=datetime.da
+0001a920: 7465 2832 3032 302c 2037 2c20 3331 2929  te(2020, 7, 31))
+0001a930: 2c20 526f 7728 5052 4556 494f 5553 5f44  , Row(PREVIOUS_D
+0001a940: 4159 2822 4122 2c20 2746 5227 293d 6461  AY("A", 'FR')=da
+0001a950: 7465 7469 6d65 2e64 6174 6528 3230 3230  tetime.date(2020
+0001a960: 2c20 3131 2c20 3237 2929 5d0a 2020 2020  , 11, 27))].    
+0001a970: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0001a980: 636f 6c5f 6966 5f73 7472 2864 6174 652c  col_if_str(date,
+0001a990: 2022 7072 6576 696f 7573 5f64 6179 2229   "previous_day")
+0001a9a0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0001a9b0: 7469 6e28 2270 7265 7669 6f75 735f 6461  tin("previous_da
+0001a9c0: 7922 2928 632c 2043 6f6c 756d 6e2e 5f74  y")(c, Column._t
+0001a9d0: 6f5f 6578 7072 2864 6179 5f6f 665f 7765  o_expr(day_of_we
+0001a9e0: 656b 2929 0a0a 0a64 6566 2073 6563 6f6e  ek))...def secon
+0001a9f0: 6428 653a 2043 6f6c 756d 6e4f 724e 616d  d(e: ColumnOrNam
+0001aa00: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0001aa10: 2020 2222 220a 2020 2020 4578 7472 6163    """.    Extrac
+0001aa20: 7473 2074 6865 2073 6563 6f6e 6420 6672  ts the second fr
+0001aa30: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001aa40: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001aa50: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001aa60: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001aa70: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001aa80: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001aa90: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001aaa0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001aab0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001aac0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001aad0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001aae0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001aaf0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001ab00: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001ab10: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001ab20: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001ab30: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001ab40: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001ab50: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001ab60: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001ab70: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001ab80: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001ab90: 7365 636f 6e64 2822 6122 2929 2e63 6f6c  second("a")).col
+0001aba0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0001abb0: 526f 7728 5345 434f 4e44 2822 4122 293d  Row(SECOND("A")=
+0001abc0: 3230 292c 2052 6f77 2853 4543 4f4e 4428  20), Row(SECOND(
+0001abd0: 2241 2229 3d35 295d 0a20 2020 2022 2222  "A")=5)].    """
+0001abe0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0001abf0: 5f69 665f 7374 7228 652c 2022 7365 636f  _if_str(e, "seco
+0001ac00: 6e64 2229 0a20 2020 2072 6574 7572 6e20  nd").    return 
+0001ac10: 6275 696c 7469 6e28 2273 6563 6f6e 6422  builtin("second"
+0001ac20: 2928 6329 0a0a 0a64 6566 206d 6f6e 7468  )(c)...def month
+0001ac30: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0001ac40: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001ac50: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+0001ac60: 7320 7468 6520 6d6f 6e74 6820 6672 6f6d  s the month from
+0001ac70: 2061 2064 6174 6520 6f72 2074 696d 6573   a date or times
+0001ac80: 7461 6d70 2e0a 0a20 2020 2045 7861 6d70  tamp...    Examp
+0001ac90: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0001aca0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+0001acb0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0001acc0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001acd0: 655f 6461 7461 6672 616d 6528 5b0a 2020  e_dataframe([.  
+0001ace0: 2020 2020 2020 2e2e 2e20 2020 2020 6461        ...     da
+0001acf0: 7465 7469 6d65 2e64 6174 6574 696d 652e  tetime.datetime.
+0001ad00: 7374 7270 7469 6d65 2822 3230 3230 2d30  strptime("2020-0
+0001ad10: 352d 3031 2031 333a 3131 3a32 302e 3030  5-01 13:11:20.00
+0001ad20: 3022 2c20 2225 592d 256d 2d25 6420 2548  0", "%Y-%m-%d %H
+0001ad30: 3a25 4d3a 2553 2e25 6622 292c 0a20 2020  :%M:%S.%f"),.   
+0001ad40: 2020 2020 202e 2e2e 2020 2020 2064 6174       ...     dat
+0001ad50: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
+0001ad60: 7472 7074 696d 6528 2232 3032 302d 3038  trptime("2020-08
+0001ad70: 2d32 3120 3031 3a33 303a 3035 2e30 3030  -21 01:30:05.000
+0001ad80: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
+0001ad90: 254d 3a25 532e 2566 2229 0a20 2020 2020  %M:%S.%f").     
+0001ada0: 2020 202e 2e2e 205d 2c20 7363 6865 6d61     ... ], schema
+0001adb0: 3d5b 2261 225d 290a 2020 2020 2020 2020  =["a"]).        
+0001adc0: 3e3e 3e20 6466 2e73 656c 6563 7428 6d6f  >>> df.select(mo
+0001add0: 6e74 6828 2261 2229 292e 636f 6c6c 6563  nth("a")).collec
+0001ade0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001adf0: 284d 4f4e 5448 2822 4122 293d 3529 2c20  (MONTH("A")=5), 
+0001ae00: 526f 7728 4d4f 4e54 4828 2241 2229 3d38  Row(MONTH("A")=8
+0001ae10: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
+0001ae20: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001ae30: 7228 652c 2022 6d6f 6e74 6822 290a 2020  r(e, "month").  
+0001ae40: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001ae50: 2822 6d6f 6e74 6822 2928 6329 0a0a 0a64  ("month")(c)...d
+0001ae60: 6566 206d 6f6e 7468 6e61 6d65 2865 3a20  ef monthname(e: 
+0001ae70: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0001ae80: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0001ae90: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
+0001aea0: 6520 7468 7265 652d 6c65 7474 6572 206d  e three-letter m
+0001aeb0: 6f6e 7468 206e 616d 6520 6672 6f6d 2074  onth name from t
+0001aec0: 6865 2073 7065 6369 6669 6564 2064 6174  he specified dat
+0001aed0: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
+0001aee0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0001aef0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0001af00: 7274 2064 6174 6574 696d 650a 2020 2020  rt datetime.    
+0001af10: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001af20: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0001af30: 6672 616d 6528 5b0a 2020 2020 2020 2020  frame([.        
+0001af40: 2e2e 2e20 2020 2020 6461 7465 7469 6d65  ...     datetime
+0001af50: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
+0001af60: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
+0001af70: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
+0001af80: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+0001af90: 2e25 6622 292c 0a20 2020 2020 2020 202e  .%f"),.        .
+0001afa0: 2e2e 2020 2020 2064 6174 6574 696d 652e  ..     datetime.
+0001afb0: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
+0001afc0: 6528 2232 3032 302d 3038 2d32 3120 3031  e("2020-08-21 01
+0001afd0: 3a33 303a 3035 2e30 3030 222c 2022 2559  :30:05.000", "%Y
+0001afe0: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
+0001aff0: 2566 2229 0a20 2020 2020 2020 202e 2e2e  %f").        ...
+0001b000: 205d 2c20 7363 6865 6d61 3d5b 2261 225d   ], schema=["a"]
+0001b010: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0001b020: 2e73 656c 6563 7428 6d6f 6e74 686e 616d  .select(monthnam
+0001b030: 6528 2261 2229 292e 636f 6c6c 6563 7428  e("a")).collect(
+0001b040: 290a 2020 2020 2020 2020 5b52 6f77 284d  ).        [Row(M
+0001b050: 4f4e 5448 4e41 4d45 2822 4122 293d 274d  ONTHNAME("A")='M
+0001b060: 6179 2729 2c20 526f 7728 4d4f 4e54 484e  ay'), Row(MONTHN
+0001b070: 414d 4528 2241 2229 3d27 4175 6727 295d  AME("A")='Aug')]
+0001b080: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0001b090: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001b0a0: 652c 2022 6d6f 6e74 686e 616d 6522 290a  e, "monthname").
+0001b0b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0001b0c0: 696e 2822 6d6f 6e74 686e 616d 6522 2928  in("monthname")(
+0001b0d0: 6329 0a0a 0a64 6566 2071 7561 7274 6572  c)...def quarter
+0001b0e0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+0001b0f0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001b100: 2022 2222 0a20 2020 2045 7874 7261 6374   """.    Extract
+0001b110: 7320 7468 6520 7175 6172 7465 7220 6672  s the quarter fr
+0001b120: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001b130: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001b140: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001b150: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001b160: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001b170: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001b180: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001b190: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001b1a0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001b1b0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001b1c0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001b1d0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001b1e0: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001b1f0: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001b200: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001b210: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001b220: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001b230: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001b240: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001b250: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001b260: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001b270: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001b280: 7175 6172 7465 7228 2261 2229 292e 636f  quarter("a")).co
+0001b290: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001b2a0: 5b52 6f77 2851 5541 5254 4552 2822 4122  [Row(QUARTER("A"
+0001b2b0: 293d 3229 2c20 526f 7728 5155 4152 5445  )=2), Row(QUARTE
+0001b2c0: 5228 2241 2229 3d33 295d 0a20 2020 2022  R("A")=3)].    "
+0001b2d0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001b2e0: 6f6c 5f69 665f 7374 7228 652c 2022 7175  ol_if_str(e, "qu
+0001b2f0: 6172 7465 7222 290a 2020 2020 7265 7475  arter").    retu
+0001b300: 726e 2062 7569 6c74 696e 2822 7175 6172  rn builtin("quar
+0001b310: 7465 7222 2928 6329 0a0a 0a64 6566 2079  ter")(c)...def y
+0001b320: 6561 7228 653a 2043 6f6c 756d 6e4f 724e  ear(e: ColumnOrN
+0001b330: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0001b340: 2020 2020 2222 220a 2020 2020 4578 7472      """.    Extr
+0001b350: 6163 7473 2074 6865 2079 6561 7220 6672  acts the year fr
+0001b360: 6f6d 2061 2064 6174 6520 6f72 2074 696d  om a date or tim
+0001b370: 6573 7461 6d70 2e0a 0a20 2020 2045 7861  estamp...    Exa
+0001b380: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0001b390: 3e3e 3e20 696d 706f 7274 2064 6174 6574  >>> import datet
+0001b3a0: 696d 650a 2020 2020 2020 2020 3e3e 3e20  ime.        >>> 
+0001b3b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001b3c0: 6174 655f 6461 7461 6672 616d 6528 5b0a  ate_dataframe([.
+0001b3d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001b3e0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001b3f0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
+0001b400: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
+0001b410: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
+0001b420: 2548 3a25 4d3a 2553 2e25 6622 292c 0a20  %H:%M:%S.%f"),. 
+0001b430: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0001b440: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+0001b450: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+0001b460: 3038 2d32 3120 3031 3a33 303a 3035 2e30  08-21 01:30:05.0
+0001b470: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+0001b480: 483a 254d 3a25 532e 2566 2229 0a20 2020  H:%M:%S.%f").   
+0001b490: 2020 2020 202e 2e2e 205d 2c20 7363 6865       ... ], sche
+0001b4a0: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+0001b4b0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001b4c0: 7965 6172 2822 6122 2929 2e63 6f6c 6c65  year("a")).colle
+0001b4d0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+0001b4e0: 7728 5945 4152 2822 4122 293d 3230 3230  w(YEAR("A")=2020
+0001b4f0: 292c 2052 6f77 2859 4541 5228 2241 2229  ), Row(YEAR("A")
+0001b500: 3d32 3032 3029 5d0a 2020 2020 2222 220a  =2020)].    """.
+0001b510: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0001b520: 6966 5f73 7472 2865 2c20 2279 6561 7222  if_str(e, "year"
+0001b530: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0001b540: 6c74 696e 2822 7965 6172 2229 2863 290a  ltin("year")(c).
+0001b550: 0a0a 6465 6620 7379 7364 6174 6528 2920  ..def sysdate() 
+0001b560: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0001b570: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+0001b580: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
+0001b590: 7461 6d70 2066 6f72 2074 6865 2073 7973  tamp for the sys
+0001b5a0: 7465 6d2c 2062 7574 2069 6e20 7468 6520  tem, but in the 
+0001b5b0: 5554 4320 7469 6d65 207a 6f6e 652e 0a0a  UTC time zone...
+0001b5c0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0001b5d0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0001b5e0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0001b5f0: 6174 6166 7261 6d65 285b 315d 2c20 7363  ataframe([1], sc
+0001b600: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0001b610: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0001b620: 7428 7379 7364 6174 6528 2929 2e63 6f6c  t(sysdate()).col
+0001b630: 6c65 6374 2829 2069 7320 6e6f 7420 4e6f  lect() is not No
+0001b640: 6e65 0a20 2020 2020 2020 2054 7275 650a  ne.        True.
+0001b650: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+0001b660: 726e 2062 7569 6c74 696e 2822 7379 7364  rn builtin("sysd
+0001b670: 6174 6522 2928 290a 0a0a 6465 6620 6d6f  ate")()...def mo
+0001b680: 6e74 6873 5f62 6574 7765 656e 2864 6174  nths_between(dat
+0001b690: 6531 3a20 436f 6c75 6d6e 4f72 4e61 6d65  e1: ColumnOrName
+0001b6a0: 2c20 6461 7465 323a 2043 6f6c 756d 6e4f  , date2: ColumnO
+0001b6b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0001b6c0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0001b6d0: 7475 726e 7320 7468 6520 6e75 6d62 6572  turns the number
+0001b6e0: 206f 6620 6d6f 6e74 6873 2062 6574 7765   of months betwe
+0001b6f0: 656e 2074 776f 2044 4154 4520 6f72 2054  en two DATE or T
+0001b700: 494d 4553 5441 4d50 2076 616c 7565 732e  IMESTAMP values.
+0001b710: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0001b720: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001b730: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+0001b740: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0001b750: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0001b760: 6166 7261 6d65 285b 5b0a 2020 2020 2020  aframe([[.      
+0001b770: 2020 2e2e 2e20 2020 2020 6461 7465 7469    ...     dateti
+0001b780: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
+0001b790: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
+0001b7a0: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
+0001b7b0: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+0001b7c0: 2553 2e25 6622 292c 0a20 2020 2020 2020  %S.%f"),.       
+0001b7d0: 202e 2e2e 2020 2020 2064 6174 6574 696d   ...     datetim
+0001b7e0: 652e 6461 7465 7469 6d65 2e73 7472 7074  e.datetime.strpt
+0001b7f0: 696d 6528 2232 3032 302d 3038 2d32 3120  ime("2020-08-21 
+0001b800: 3031 3a33 303a 3035 2e30 3030 222c 2022  01:30:05.000", "
+0001b810: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+0001b820: 532e 2566 2229 0a20 2020 2020 2020 202e  S.%f").        .
+0001b830: 2e2e 205d 5d2c 2073 6368 656d 613d 5b22  .. ]], schema=["
+0001b840: 6122 2c20 2262 225d 290a 2020 2020 2020  a", "b"]).      
+0001b850: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0001b860: 6d6f 6e74 6873 5f62 6574 7765 656e 2822  months_between("
+0001b870: 6122 2c20 2262 2229 292e 636f 6c6c 6563  a", "b")).collec
+0001b880: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0001b890: 284d 4f4e 5448 535f 4245 5457 4545 4e28  (MONTHS_BETWEEN(
+0001b8a0: 2241 222c 2022 4222 293d 4465 6369 6d61  "A", "B")=Decima
+0001b8b0: 6c28 272d 332e 3632 3934 3532 2729 295d  l('-3.629452'))]
+0001b8c0: 0a20 2020 2022 2222 0a20 2020 2063 3120  .    """.    c1 
+0001b8d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001b8e0: 2864 6174 6531 2c20 226d 6f6e 7468 735f  (date1, "months_
+0001b8f0: 6265 7477 6565 6e22 290a 2020 2020 6332  between").    c2
+0001b900: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+0001b910: 7228 6461 7465 322c 2022 6d6f 6e74 6873  r(date2, "months
+0001b920: 5f62 6574 7765 656e 2229 0a20 2020 2072  _between").    r
+0001b930: 6574 7572 6e20 6275 696c 7469 6e28 226d  eturn builtin("m
+0001b940: 6f6e 7468 735f 6265 7477 6565 6e22 2928  onths_between")(
+0001b950: 6331 2c20 6332 290a 0a0a 6465 6620 746f  c1, c2)...def to
+0001b960: 5f67 656f 6772 6170 6879 2865 3a20 436f  _geography(e: Co
+0001b970: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+0001b980: 6f6c 756d 6e3a 0a20 2020 2022 2222 5061  olumn:.    """Pa
+0001b990: 7273 6573 2061 6e20 696e 7075 7420 616e  rses an input an
+0001b9a0: 6420 7265 7475 726e 7320 6120 7661 6c75  d returns a valu
+0001b9b0: 6520 6f66 2074 7970 6520 4745 4f47 5241  e of type GEOGRA
+0001b9c0: 5048 592e 2053 7570 706f 7274 6564 2069  PHY. Supported i
+0001b9d0: 6e70 7574 7320 6172 6520 7374 7269 6e67  nputs are string
+0001b9e0: 7320 696e 0a0a 2020 2020 2020 2020 2d20  s in..        - 
+0001b9f0: 574b 5420 2877 656c 6c2d 6b6e 6f77 6e20  WKT (well-known 
+0001ba00: 7465 7874 292e 0a20 2020 2020 2020 202d  text)..        -
+0001ba10: 2057 4b42 2028 7765 6c6c 2d6b 6e6f 776e   WKB (well-known
+0001ba20: 2062 696e 6172 7929 2069 6e20 6865 7861   binary) in hexa
+0001ba30: 6465 6369 6d61 6c20 666f 726d 6174 2028  decimal format (
+0001ba40: 7769 7468 6f75 7420 6120 6c65 6164 696e  without a leadin
+0001ba50: 6720 3078 292e 0a20 2020 2020 2020 202d  g 0x)..        -
+0001ba60: 2045 574b 5420 2865 7874 656e 6465 6420   EWKT (extended 
+0001ba70: 7765 6c6c 2d6b 6e6f 776e 2074 6578 7429  well-known text)
+0001ba80: 2e0a 2020 2020 2020 2020 2d20 4557 4b42  ..        - EWKB
+0001ba90: 2028 6578 7465 6e64 6564 2077 656c 6c2d   (extended well-
+0001baa0: 6b6e 6f77 6e20 6269 6e61 7279 2920 696e  known binary) in
+0001bab0: 2068 6578 6164 6563 696d 616c 2066 6f72   hexadecimal for
+0001bac0: 6d61 7420 2877 6974 686f 7574 2061 206c  mat (without a l
+0001bad0: 6561 6469 6e67 2030 7829 2e0a 2020 2020  eading 0x)..    
+0001bae0: 2020 2020 2d20 4765 6f4a 534f 4e2e 0a0a      - GeoJSON...
+0001baf0: 2020 2020 666f 726d 6174 2e0a 0a20 2020      format...   
+0001bb00: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0001bb10: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+0001bb20: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0001bb30: 7261 6d65 285b 2750 4f49 4e54 282d 3132  rame(['POINT(-12
+0001bb40: 322e 3335 2033 372e 3535 2927 2c20 2750  2.35 37.55)', 'P
+0001bb50: 4f49 4e54 2832 302e 3932 2034 332e 3333  OINT(20.92 43.33
+0001bb60: 2927 5d2c 2073 6368 656d 613d 5b27 6127  )'], schema=['a'
+0001bb70: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0001bb80: 662e 7365 6c65 6374 2874 6f5f 6765 6f67  f.select(to_geog
+0001bb90: 7261 7068 7928 636f 6c28 2261 2229 2929  raphy(col("a")))
+0001bba0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0001bbb0: 2020 205b 526f 7728 544f 5f47 454f 4752     [Row(TO_GEOGR
+0001bbc0: 4150 4859 2822 4122 293d 277b 5c5c 6e20  APHY("A")='{\\n 
+0001bbd0: 2022 636f 6f72 6469 6e61 7465 7322 3a20   "coordinates": 
+0001bbe0: 5b5c 5c6e 2020 2020 2d31 3232 2e33 352c  [\\n    -122.35,
+0001bbf0: 5c5c 6e20 2020 2033 372e 3535 5c5c 6e20  \\n    37.55\\n 
+0001bc00: 205d 2c5c 5c6e 2020 2274 7970 6522 3a20   ],\\n  "type": 
+0001bc10: 2250 6f69 6e74 225c 5c6e 7d27 292c 2052  "Point"\\n}'), R
+0001bc20: 6f77 2854 4f5f 4745 4f47 5241 5048 5928  ow(TO_GEOGRAPHY(
+0001bc30: 2241 2229 3d27 7b5c 5c6e 2020 2263 6f6f  "A")='{\\n  "coo
+0001bc40: 7264 696e 6174 6573 223a 205b 5c5c 6e20  rdinates": [\\n 
+0001bc50: 2020 2032 302e 3932 2c5c 5c6e 2020 2020     20.92,\\n    
+0001bc60: 3433 2e33 335c 5c6e 2020 5d2c 5c5c 6e20  43.33\\n  ],\\n 
+0001bc70: 2022 7479 7065 223a 2022 506f 696e 7422   "type": "Point"
+0001bc80: 5c5c 6e7d 2729 5d0a 0a20 2020 2042 6573  \\n}')]..    Bes
+0001bc90: 6964 6573 2073 7472 696e 6773 2c20 6269  ides strings, bi
+0001bca0: 6e61 7279 2072 6570 7265 7365 6e74 6174  nary representat
+0001bcb0: 696f 6e20 696e 2057 4b42 2061 6e64 2045  ion in WKB and E
+0001bcc0: 574b 4220 666f 726d 6174 2063 616e 2062  WKB format can b
+0001bcd0: 6520 7061 7273 6564 2c20 6f72 206f 626a  e parsed, or obj
+0001bce0: 6563 7473 2061 6468 6572 696e 6720 746f  ects adhering to
+0001bcf0: 2047 656f 4a53 4f4e 2066 6f72 6d61 742e   GeoJSON format.
+0001bd00: 0a20 2020 2046 6f72 2061 6c6c 2073 7570  .    For all sup
+0001bd10: 706f 7274 6564 2066 6f72 6d61 7473 2063  ported formats c
+0001bd20: 6f6e 6665 7220 6874 7470 733a 2f2f 646f  onfer https://do
+0001bd30: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
+0001bd40: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
+0001bd50: 652f 6461 7461 2d74 7970 6573 2d67 656f  e/data-types-geo
+0001bd60: 7370 6174 6961 6c23 7375 7070 6f72 7465  spatial#supporte
+0001bd70: 642d 6765 6f73 7061 7469 616c 2d6f 626a  d-geospatial-obj
+0001bd80: 6563 742d 7479 7065 732e 0a20 2020 2022  ect-types..    "
+0001bd90: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0001bda0: 6f6c 5f69 665f 7374 7228 652c 2022 746f  ol_if_str(e, "to
+0001bdb0: 5f67 656f 6772 6170 6879 2229 0a20 2020  _geography").   
+0001bdc0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0001bdd0: 2274 6f5f 6765 6f67 7261 7068 7922 2928  "to_geography")(
+0001bde0: 6329 0a0a 0a64 6566 2061 7272 6179 735f  c)...def arrays_
+0001bdf0: 6f76 6572 6c61 7028 6172 7261 7931 3a20  overlap(array1: 
+0001be00: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6172  ColumnOrName, ar
+0001be10: 7261 7932 3a20 436f 6c75 6d6e 4f72 4e61  ray2: ColumnOrNa
+0001be20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0001be30: 2020 2022 2222 436f 6d70 6172 6573 2077     """Compares w
+0001be40: 6865 7468 6572 2074 776f 2041 5252 4159  hether two ARRAY
+0001be50: 7320 6861 7665 2061 7420 6c65 6173 7420  s have at least 
+0001be60: 6f6e 6520 656c 656d 656e 7420 696e 2063  one element in c
+0001be70: 6f6d 6d6f 6e2e 2052 6574 7572 6e73 2054  ommon. Returns T
+0001be80: 5255 450a 2020 2020 6966 2074 6865 7265  RUE.    if there
+0001be90: 2069 7320 6174 206c 6561 7374 206f 6e65   is at least one
+0001bea0: 2065 6c65 6d65 6e74 2069 6e20 636f 6d6d   element in comm
+0001beb0: 6f6e 3b20 6f74 6865 7277 6973 6520 7265  on; otherwise re
+0001bec0: 7475 726e 7320 4641 4c53 452e 2054 6865  turns FALSE. The
+0001bed0: 2066 756e 6374 696f 6e0a 2020 2020 6973   function.    is
+0001bee0: 204e 554c 4c2d 7361 6665 2c20 6d65 616e   NULL-safe, mean
+0001bef0: 696e 6720 6974 2074 7265 6174 7320 4e55  ing it treats NU
+0001bf00: 4c4c 7320 6173 206b 6e6f 776e 2076 616c  LLs as known val
+0001bf10: 7565 7320 666f 7220 636f 6d70 6172 696e  ues for comparin
+0001bf20: 6720 6571 7561 6c69 7479 2e0a 0a20 2020  g equality...   
+0001bf30: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0001bf40: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0001bf50: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+0001bf60: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+0001bf70: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0001bf80: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0001bf90: 616d 6528 5b52 6f77 285b 312c 2032 5d2c  ame([Row([1, 2],
+0001bfa0: 205b 312c 2033 5d29 2c20 526f 7728 5b31   [1, 3]), Row([1
+0001bfb0: 2c20 325d 2c20 5b33 2c20 345d 295d 2c20  , 2], [3, 4])], 
+0001bfc0: 7363 6865 6d61 3d5b 2261 222c 2022 6222  schema=["a", "b"
+0001bfd0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+0001bfe0: 662e 7365 6c65 6374 2861 7272 6179 735f  f.select(arrays_
+0001bff0: 6f76 6572 6c61 7028 2261 222c 2022 6222  overlap("a", "b"
+0001c000: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0001c010: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0001c020: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0001c030: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0001c040: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001c050: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001c060: 207c 5472 7565 2020 2020 2020 7c0a 2020   |True      |.  
+0001c070: 2020 2020 2020 7c46 616c 7365 2020 2020        |False    
+0001c080: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001c090: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001c0a0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0001c0b0: 2222 220a 2020 2020 6131 203d 205f 746f  """.    a1 = _to
+0001c0c0: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
+0001c0d0: 7931 2c20 2261 7272 6179 735f 6f76 6572  y1, "arrays_over
+0001c0e0: 6c61 7022 290a 2020 2020 6132 203d 205f  lap").    a2 = _
+0001c0f0: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
+0001c100: 7261 7932 2c20 2261 7272 6179 735f 6f76  ray2, "arrays_ov
+0001c110: 6572 6c61 7022 290a 2020 2020 7265 7475  erlap").    retu
+0001c120: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
+0001c130: 7973 5f6f 7665 726c 6170 2229 2861 312c  ys_overlap")(a1,
+0001c140: 2061 3229 0a0a 0a64 6566 2061 7272 6179   a2)...def array
+0001c150: 5f64 6973 7469 6e63 7428 636f 6c3a 2043  _distinct(col: C
+0001c160: 6f6c 756d 6e4f 724e 616d 6529 3a0a 2020  olumnOrName):.  
+0001c170: 2020 2222 2254 6865 2066 756e 6374 696f    """The functio
+0001c180: 6e20 6578 636c 7564 6573 2061 6e79 2064  n excludes any d
+0001c190: 7570 6c69 6361 7465 2065 6c65 6d65 6e74  uplicate element
+0001c1a0: 7320 7468 6174 2061 7265 2070 7265 7365  s that are prese
+0001c1b0: 6e74 2069 6e20 7468 6520 696e 7075 7420  nt in the input 
+0001c1c0: 4152 5241 592e 0a20 2020 2054 6865 2066  ARRAY..    The f
+0001c1d0: 756e 6374 696f 6e20 6973 206e 6f74 2067  unction is not g
+0001c1e0: 7561 7261 6e74 6565 6420 746f 2072 6574  uaranteed to ret
+0001c1f0: 7572 6e20 7468 6520 656c 656d 656e 7473  urn the elements
+0001c200: 2069 6e20 7468 6520 4152 5241 5920 696e   in the ARRAY in
+0001c210: 2061 2073 7065 6369 6669 6320 6f72 6465   a specific orde
+0001c220: 722e 0a20 2020 2054 6865 2066 756e 6374  r..    The funct
+0001c230: 696f 6e20 6973 204e 554c 4c20 7361 6665  ion is NULL safe
+0001c240: 2c20 7768 6963 6820 6d65 616e 7320 7468  , which means th
+0001c250: 6174 2069 7420 7472 6561 7473 204e 554c  at it treats NUL
+0001c260: 4c73 2061 7320 6b6e 6f77 6e20 7661 6c75  Ls as known valu
+0001c270: 6573 2077 6865 6e20 6964 656e 7469 6679  es when identify
+0001c280: 696e 6720 6475 706c 6963 6174 6520 656c  ing duplicate el
+0001c290: 656d 656e 7473 2e0a 0a20 2020 2041 7267  ements...    Arg
+0001c2a0: 733a 0a20 2020 2020 2020 2063 6f6c 3a20  s:.        col: 
+0001c2b0: 5468 6520 6172 7261 7920 636f 6c75 6d6e  The array column
+0001c2c0: 0a0a 2020 2020 5265 7475 726e 733a 0a20  ..    Returns:. 
+0001c2d0: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+0001c2e0: 206e 6577 2041 5252 4159 2074 6861 7420   new ARRAY that 
+0001c2f0: 636f 6e74 6169 6e73 206f 6e6c 7920 7468  contains only th
+0001c300: 6520 6469 7374 696e 6374 2065 6c65 6d65  e distinct eleme
+0001c310: 6e74 7320 6672 6f6d 2074 6865 2069 6e70  nts from the inp
+0001c320: 7574 2041 5252 4159 2e0a 0a20 2020 2045  ut ARRAY...    E
+0001c330: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0001c340: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0001c350: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+0001c360: 6e63 7469 6f6e 7320 696d 706f 7274 2061  nctions import a
+0001c370: 7272 6179 5f63 6f6e 7374 7275 6374 2c61  rray_construct,a
+0001c380: 7272 6179 5f64 6973 7469 6e63 742c 6c69  rray_distinct,li
+0001c390: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
+0001c3a0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001c3b0: 6544 6174 6146 7261 6d65 285b 5b22 3122  eDataFrame([["1"
+0001c3c0: 5d5d 2c20 5b22 4122 5d29 0a20 2020 2020  ]], ["A"]).     
+0001c3d0: 2020 203e 3e3e 2064 6620 3d20 6466 2e77     >>> df = df.w
+0001c3e0: 6974 6843 6f6c 756d 6e28 2261 7272 6179  ithColumn("array
+0001c3f0: 222c 2061 7272 6179 5f63 6f6e 7374 7275  ", array_constru
+0001c400: 6374 286c 6974 2831 292c 206c 6974 2831  ct(lit(1), lit(1
+0001c410: 292c 206c 6974 2831 292c 206c 6974 2832  ), lit(1), lit(2
+0001c420: 292c 206c 6974 2833 292c 206c 6974 2832  ), lit(3), lit(2
+0001c430: 292c 206c 6974 2832 2929 290a 2020 2020  ), lit(2))).    
+0001c440: 2020 2020 3e3e 3e20 6466 2e77 6974 6843      >>> df.withC
+0001c450: 6f6c 756d 6e28 2261 7272 6179 5f64 222c  olumn("array_d",
+0001c460: 2061 7272 6179 5f64 6973 7469 6e63 7428   array_distinct(
+0001c470: 2241 5252 4159 2229 292e 7368 6f77 2829  "ARRAY")).show()
+0001c480: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001c490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001c4a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001c4b0: 2241 2220 207c 2241 5252 4159 2220 207c  "A"  |"ARRAY"  |
+0001c4c0: 2241 5252 4159 5f44 2220 207c 0a20 2020  "ARRAY_D"  |.   
+0001c4d0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0001c4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001c4f0: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
+0001c500: 207c 5b20 2020 2020 2020 207c 5b20 2020   |[        |[   
+0001c510: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0001c520: 207c 2020 2020 207c 2020 312c 2020 2020   |     |  1,    
+0001c530: 207c 2020 312c 2020 2020 2020 207c 0a20   |  1,       |. 
+0001c540: 2020 2020 2020 207c 2020 2020 207c 2020         |     |  
+0001c550: 312c 2020 2020 207c 2020 322c 2020 2020  1,     |  2,    
+0001c560: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0001c570: 2020 207c 2020 312c 2020 2020 207c 2020     |  1,     |  
+0001c580: 3320 2020 2020 2020 207c 0a20 2020 2020  3        |.     
+0001c590: 2020 207c 2020 2020 207c 2020 322c 2020     |     |  2,  
+0001c5a0: 2020 207c 5d20 2020 2020 2020 2020 207c     |]          |
+0001c5b0: 0a20 2020 2020 2020 207c 2020 2020 207c  .        |     |
+0001c5c0: 2020 332c 2020 2020 207c 2020 2020 2020    3,     |      
+0001c5d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001c5e0: 2020 2020 207c 2020 322c 2020 2020 207c       |  2,     |
+0001c5f0: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0001c600: 2020 2020 207c 2020 2020 207c 2020 3220       |     |  2 
+0001c610: 2020 2020 207c 2020 2020 2020 2020 2020       |          
+0001c620: 207c 0a20 2020 2020 2020 207c 2020 2020   |.        |    
+0001c630: 207c 5d20 2020 2020 2020 207c 2020 2020   |]        |    
+0001c640: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0001c650: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0001c660: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0001c670: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0001c680: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
+0001c690: 6f6c 203d 205f 746f 5f63 6f6c 5f69 665f  ol = _to_col_if_
+0001c6a0: 7374 7228 636f 6c2c 2022 6172 7261 795f  str(col, "array_
+0001c6b0: 6469 7374 696e 6374 2229 0a20 2020 2072  distinct").    r
+0001c6c0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+0001c6d0: 7272 6179 5f64 6973 7469 6e63 7422 2928  rray_distinct")(
+0001c6e0: 636f 6c29 0a0a 0a64 6566 2061 7272 6179  col)...def array
+0001c6f0: 5f69 6e74 6572 7365 6374 696f 6e28 6172  _intersection(ar
+0001c700: 7261 7931 3a20 436f 6c75 6d6e 4f72 4e61  ray1: ColumnOrNa
+0001c710: 6d65 2c20 6172 7261 7932 3a20 436f 6c75  me, array2: Colu
+0001c720: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0001c730: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
+0001c740: 726e 7320 616e 2061 7272 6179 2074 6861  rns an array tha
+0001c750: 7420 636f 6e74 6169 6e73 2074 6865 206d  t contains the m
+0001c760: 6174 6368 696e 6720 656c 656d 656e 7473  atching elements
+0001c770: 2069 6e20 7468 6520 7477 6f20 696e 7075   in the two inpu
+0001c780: 7420 6172 7261 7973 2e0a 0a20 2020 2054  t arrays...    T
+0001c790: 6865 2066 756e 6374 696f 6e20 6973 204e  he function is N
+0001c7a0: 554c 4c2d 7361 6665 2c20 6d65 616e 696e  ULL-safe, meanin
+0001c7b0: 6720 6974 2074 7265 6174 7320 4e55 4c4c  g it treats NULL
+0001c7c0: 7320 6173 206b 6e6f 776e 2076 616c 7565  s as known value
+0001c7d0: 7320 666f 7220 636f 6d70 6172 696e 6720  s for comparing 
+0001c7e0: 6571 7561 6c69 7479 2e0a 0a20 2020 2041  equality...    A
+0001c7f0: 7267 733a 0a20 2020 2020 2020 2061 7272  rgs:.        arr
+0001c800: 6179 313a 2041 6e20 4152 5241 5920 7468  ay1: An ARRAY th
+0001c810: 6174 2063 6f6e 7461 696e 7320 656c 656d  at contains elem
+0001c820: 656e 7473 2074 6f20 6265 2063 6f6d 7061  ents to be compa
+0001c830: 7265 642e 0a20 2020 2020 2020 2061 7272  red..        arr
+0001c840: 6179 323a 2041 6e20 4152 5241 5920 7468  ay2: An ARRAY th
+0001c850: 6174 2063 6f6e 7461 696e 7320 656c 656d  at contains elem
+0001c860: 656e 7473 2074 6f20 6265 2063 6f6d 7061  ents to be compa
+0001c870: 7265 642e 0a0a 2020 2020 4578 616d 706c  red...    Exampl
+0001c880: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0001c890: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0001c8a0: 6e6f 7770 6172 6b20 696d 706f 7274 2052  nowpark import R
+0001c8b0: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
+0001c8c0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+0001c8d0: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
+0001c8e0: 7728 5b31 2c20 325d 2c20 5b31 2c20 335d  w([1, 2], [1, 3]
+0001c8f0: 295d 2c20 7363 6865 6d61 3d5b 2261 222c  )], schema=["a",
+0001c900: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
+0001c910: 3e3e 2064 662e 7365 6c65 6374 2861 7272  >> df.select(arr
+0001c920: 6179 5f69 6e74 6572 7365 6374 696f 6e28  ay_intersection(
+0001c930: 2261 222c 2022 6222 292e 616c 6961 7328  "a", "b").alias(
+0001c940: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0001c950: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0001c960: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001c970: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
+0001c980: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001c990: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
+0001c9a0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0001c9b0: 2031 2020 2020 2020 207c 0a20 2020 2020   1       |.     
+0001c9c0: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+0001c9d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001c9e0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0001c9f0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0001ca00: 0a20 2020 2061 3120 3d20 5f74 6f5f 636f  .    a1 = _to_co
+0001ca10: 6c5f 6966 5f73 7472 2861 7272 6179 312c  l_if_str(array1,
+0001ca20: 2022 6172 7261 795f 696e 7465 7273 6563   "array_intersec
+0001ca30: 7469 6f6e 2229 0a20 2020 2061 3220 3d20  tion").    a2 = 
+0001ca40: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+0001ca50: 7272 6179 322c 2022 6172 7261 795f 696e  rray2, "array_in
+0001ca60: 7465 7273 6563 7469 6f6e 2229 0a20 2020  tersection").   
+0001ca70: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0001ca80: 2261 7272 6179 5f69 6e74 6572 7365 6374  "array_intersect
+0001ca90: 696f 6e22 2928 6131 2c20 6132 290a 0a0a  ion")(a1, a2)...
+0001caa0: 6465 6620 6172 7261 795f 6765 6e65 7261  def array_genera
+0001cab0: 7465 5f72 616e 6765 280a 2020 2020 7374  te_range(.    st
+0001cac0: 6172 743a 2043 6f6c 756d 6e4f 724e 616d  art: ColumnOrNam
+0001cad0: 652c 2073 746f 703a 2043 6f6c 756d 6e4f  e, stop: ColumnO
+0001cae0: 724e 616d 652c 2073 7465 703a 204f 7074  rName, step: Opt
+0001caf0: 696f 6e61 6c5b 436f 6c75 6d6e 4f72 4e61  ional[ColumnOrNa
+0001cb00: 6d65 5d20 3d20 4e6f 6e65 0a29 202d 3e20  me] = None.) -> 
+0001cb10: 436f 6c75 6d6e 3a0a 2020 2020 2222 2247  Column:.    """G
+0001cb20: 656e 6572 6174 6520 6120 7261 6e67 6520  enerate a range 
+0001cb30: 6f66 2069 6e74 6567 6572 7320 6672 6f6d  of integers from
+0001cb40: 2060 7374 6172 7460 2074 6f20 6073 746f   `start` to `sto
+0001cb50: 7060 2c20 696e 6372 656d 656e 7469 6e67  p`, incrementing
+0001cb60: 2062 7920 6073 7465 7060 2e0a 2020 2020   by `step`..    
+0001cb70: 4966 2060 7374 6570 6020 6973 206e 6f74  If `step` is not
+0001cb80: 2073 6574 2c20 696e 6372 656d 656e 7469   set, incrementi
+0001cb90: 6e67 2062 7920 312e 0a0a 2020 2020 4172  ng by 1...    Ar
+0001cba0: 6773 3a0a 2020 2020 2020 2020 7374 6172  gs:.        star
+0001cbb0: 743a 2074 6865 2063 6f6c 756d 6e20 7468  t: the column th
+0001cbc0: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
+0001cbd0: 696e 7465 6765 7220 746f 2073 7461 7274  integer to start
+0001cbe0: 2077 6974 6820 2869 6e63 6c75 7369 7665   with (inclusive
+0001cbf0: 292e 0a20 2020 2020 2020 2073 746f 703a  )..        stop:
+0001cc00: 2074 6865 2063 6f6c 756d 6e20 7468 6174   the column that
+0001cc10: 2063 6f6e 7461 696e 7320 7468 6520 696e   contains the in
+0001cc20: 7465 6765 7220 746f 2073 746f 7020 2865  teger to stop (e
+0001cc30: 7863 6c75 7369 7665 292e 0a20 2020 2020  xclusive)..     
+0001cc40: 2020 2073 7465 703a 2074 6865 2063 6f6c     step: the col
+0001cc50: 756d 6e20 7468 6174 2063 6f6e 7461 696e  umn that contain
+0001cc60: 7320 7468 6520 696e 7465 6765 7220 746f  s the integer to
+0001cc70: 2069 6e63 7265 6d65 6e74 2e0a 0a20 2020   increment...   
+0001cc80: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+0001cc90: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0001cca0: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+0001ccb0: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+0001ccc0: 2020 3e3e 3e20 6466 3120 3d20 7365 7373    >>> df1 = sess
+0001ccd0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0001cce0: 7261 6d65 285b 282d 322c 2032 295d 2c20  rame([(-2, 2)], 
+0001ccf0: 5b22 6122 2c20 2262 225d 290a 2020 2020  ["a", "b"]).    
+0001cd00: 2020 2020 3e3e 3e20 6466 312e 7365 6c65      >>> df1.sele
+0001cd10: 6374 2861 7272 6179 5f67 656e 6572 6174  ct(array_generat
+0001cd20: 655f 7261 6e67 6528 2261 222c 2022 6222  e_range("a", "b"
+0001cd30: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+0001cd40: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0001cd50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0001cd60: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0001cd70: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001cd80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001cd90: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
+0001cda0: 2020 2020 2020 7c20 202d 322c 2020 2020        |  -2,    
+0001cdb0: 207c 0a20 2020 2020 2020 207c 2020 2d31   |.        |  -1
+0001cdc0: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
+0001cdd0: 7c20 2030 2c20 2020 2020 207c 0a20 2020  |  0,      |.   
+0001cde0: 2020 2020 207c 2020 3120 2020 2020 2020       |  1       
+0001cdf0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+0001ce00: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0001ce10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001ce20: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0001ce30: 2020 2020 2020 2020 3e3e 3e20 6466 3220          >>> df2 
+0001ce40: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001ce50: 5f64 6174 6166 7261 6d65 285b 2834 2c20  _dataframe([(4, 
+0001ce60: 2d34 2c20 2d32 295d 2c20 5b22 6122 2c20  -4, -2)], ["a", 
+0001ce70: 2262 222c 2022 6322 5d29 0a20 2020 2020  "b", "c"]).     
+0001ce80: 2020 203e 3e3e 2064 6632 2e73 656c 6563     >>> df2.selec
+0001ce90: 7428 6172 7261 795f 6765 6e65 7261 7465  t(array_generate
+0001cea0: 5f72 616e 6765 2822 6122 2c20 2262 222c  _range("a", "b",
+0001ceb0: 2022 6322 292e 616c 6961 7328 2272 6573   "c").alias("res
+0001cec0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0001ced0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001cee0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0001cef0: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0001cf00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001cf10: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
+0001cf20: 7c0a 2020 2020 2020 2020 7c20 2034 2c20  |.        |  4, 
+0001cf30: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001cf40: 2020 322c 2020 2020 2020 7c0a 2020 2020    2,      |.    
+0001cf50: 2020 2020 7c20 2030 2c20 2020 2020 207c      |  0,      |
+0001cf60: 0a20 2020 2020 2020 207c 2020 2d32 2020  .        |  -2  
+0001cf70: 2020 2020 7c0a 2020 2020 2020 2020 7c5d      |.        |]
+0001cf80: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0001cf90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0001cfa0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0001cfb0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+0001cfc0: 7374 6172 745f 636f 6c20 3d20 5f74 6f5f  start_col = _to_
+0001cfd0: 636f 6c5f 6966 5f73 7472 2873 7461 7274  col_if_str(start
+0001cfe0: 2c20 2261 7272 6179 5f67 656e 6572 6174  , "array_generat
+0001cff0: 655f 7261 6e67 6522 290a 2020 2020 7374  e_range").    st
+0001d000: 6f70 5f63 6f6c 203d 205f 746f 5f63 6f6c  op_col = _to_col
+0001d010: 5f69 665f 7374 7228 7374 6f70 2c20 2261  _if_str(stop, "a
+0001d020: 7272 6179 5f67 656e 6572 6174 655f 7261  rray_generate_ra
+0001d030: 6e67 6522 290a 2020 2020 6966 2073 7465  nge").    if ste
+0001d040: 7020 6973 204e 6f6e 653a 0a20 2020 2020  p is None:.     
+0001d050: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+0001d060: 6e28 2261 7272 6179 5f67 656e 6572 6174  n("array_generat
+0001d070: 655f 7261 6e67 6522 2928 7374 6172 745f  e_range")(start_
+0001d080: 636f 6c2c 2073 746f 705f 636f 6c29 0a20  col, stop_col). 
+0001d090: 2020 2073 7465 705f 636f 6c20 3d20 5f74     step_col = _t
+0001d0a0: 6f5f 636f 6c5f 6966 5f73 7472 2873 7465  o_col_if_str(ste
+0001d0b0: 702c 2022 6172 7261 795f 6765 6e65 7261  p, "array_genera
+0001d0c0: 7465 5f72 616e 6765 2229 0a20 2020 2072  te_range").    r
+0001d0d0: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+0001d0e0: 7272 6179 5f67 656e 6572 6174 655f 7261  rray_generate_ra
+0001d0f0: 6e67 6522 2928 7374 6172 745f 636f 6c2c  nge")(start_col,
+0001d100: 2073 746f 705f 636f 6c2c 2073 7465 705f   stop_col, step_
+0001d110: 636f 6c29 0a0a 0a64 6566 2073 6571 7565  col)...def seque
+0001d120: 6e63 6528 0a20 2020 2073 7461 7274 3a20  nce(.    start: 
+0001d130: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 7374  ColumnOrName, st
+0001d140: 6f70 3a20 436f 6c75 6d6e 4f72 4e61 6d65  op: ColumnOrName
+0001d150: 2c20 7374 6570 3a20 4f70 7469 6f6e 616c  , step: Optional
+0001d160: 5b43 6f6c 756d 6e4f 724e 616d 655d 203d  [ColumnOrName] =
+0001d170: 204e 6f6e 650a 2920 2d3e 2043 6f6c 756d   None.) -> Colum
+0001d180: 6e3a 0a20 2020 2022 2222 4765 6e65 7261  n:.    """Genera
+0001d190: 7465 2061 2073 6571 7565 6e63 6520 6f66  te a sequence of
+0001d1a0: 2069 6e74 6567 6572 7320 6672 6f6d 2060   integers from `
+0001d1b0: 7374 6172 7460 2074 6f20 6073 746f 7060  start` to `stop`
+0001d1c0: 2c20 696e 6372 656d 656e 7469 6e67 2062  , incrementing b
+0001d1d0: 7920 6073 7465 7060 2e0a 2020 2020 4966  y `step`..    If
+0001d1e0: 2060 7374 6570 6020 6973 206e 6f74 2073   `step` is not s
+0001d1f0: 6574 2c20 696e 6372 656d 656e 7469 6e67  et, incrementing
+0001d200: 2062 7920 3120 6966 2073 7461 7274 2069   by 1 if start i
+0001d210: 7320 6c65 7373 2074 6861 6e20 6f72 2065  s less than or e
+0001d220: 7175 616c 2074 6f20 7374 6f70 2c20 6f74  qual to stop, ot
+0001d230: 6865 7277 6973 6520 2d31 2e0a 0a20 2020  herwise -1...   
+0001d240: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
+0001d250: 7461 7274 3a20 7468 6520 636f 6c75 6d6e  tart: the column
+0001d260: 2074 6861 7420 636f 6e74 6169 6e73 2074   that contains t
+0001d270: 6865 2069 6e74 6567 6572 2074 6f20 7374  he integer to st
+0001d280: 6172 7420 7769 7468 2028 696e 636c 7573  art with (inclus
+0001d290: 6976 6529 2e0a 2020 2020 2020 2020 7374  ive)..        st
+0001d2a0: 6f70 3a20 7468 6520 636f 6c75 6d6e 2074  op: the column t
+0001d2b0: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
+0001d2c0: 2069 6e74 6567 6572 2074 6f20 7374 6f70   integer to stop
+0001d2d0: 2028 696e 636c 7573 6976 6529 2e0a 2020   (inclusive)..  
+0001d2e0: 2020 2020 2020 7374 6570 3a20 7468 6520        step: the 
+0001d2f0: 636f 6c75 6d6e 2074 6861 7420 636f 6e74  column that cont
+0001d300: 6169 6e73 2074 6865 2069 6e74 6567 6572  ains the integer
+0001d310: 2074 6f20 696e 6372 656d 656e 742e 0a0a   to increment...
+0001d320: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+0001d330: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0001d340: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0001d350: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
+0001d360: 2020 2020 203e 3e3e 2064 6631 203d 2073       >>> df1 = s
+0001d370: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0001d380: 7461 6672 616d 6528 5b28 2d32 2c20 3229  taframe([(-2, 2)
+0001d390: 5d2c 205b 2261 222c 2022 6222 5d29 0a20  ], ["a", "b"]). 
+0001d3a0: 2020 2020 2020 203e 3e3e 2064 6631 2e73         >>> df1.s
+0001d3b0: 656c 6563 7428 7365 7175 656e 6365 2822  elect(sequence("
+0001d3c0: 6122 2c20 2262 2229 2e61 6c69 6173 2822  a", "b").alias("
+0001d3d0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0001d3e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001d3f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0001d400: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+0001d410: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+0001d420: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
+0001d430: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0001d440: 2d32 2c20 2020 2020 7c0a 2020 2020 2020  -2,     |.      
+0001d450: 2020 7c20 202d 312c 2020 2020 207c 0a20    |  -1,     |. 
+0001d460: 2020 2020 2020 207c 2020 302c 2020 2020         |  0,    
+0001d470: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+0001d480: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+0001d490: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
+0001d4a0: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+0001d4b0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0001d4c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001d4d0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0001d4e0: 2020 2020 3e3e 3e20 6466 3220 3d20 7365      >>> df2 = se
+0001d4f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0001d500: 6166 7261 6d65 285b 2834 2c20 2d34 2c20  aframe([(4, -4, 
+0001d510: 2d32 295d 2c20 5b22 6122 2c20 2262 222c  -2)], ["a", "b",
+0001d520: 2022 6322 5d29 0a20 2020 2020 2020 203e   "c"]).        >
+0001d530: 3e3e 2064 6632 2e73 656c 6563 7428 7365  >> df2.select(se
+0001d540: 7175 656e 6365 2822 6122 2c20 2262 222c  quence("a", "b",
+0001d550: 2022 6322 292e 616c 6961 7328 2272 6573   "c").alias("res
+0001d560: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
+0001d570: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001d580: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0001d590: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
+0001d5a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0001d5b0: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
+0001d5c0: 7c0a 2020 2020 2020 2020 7c20 2034 2c20  |.        |  4, 
+0001d5d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0001d5e0: 2020 322c 2020 2020 2020 7c0a 2020 2020    2,      |.    
+0001d5f0: 2020 2020 7c20 2030 2c20 2020 2020 207c      |  0,      |
+0001d600: 0a20 2020 2020 2020 207c 2020 2d32 2c20  .        |  -2, 
+0001d610: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0001d620: 202d 3420 2020 2020 207c 0a20 2020 2020   -4      |.     
+0001d630: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+0001d640: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001d650: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0001d660: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0001d670: 0a20 2020 2073 7461 7274 5f63 6f6c 203d  .    start_col =
+0001d680: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001d690: 7374 6172 742c 2022 7365 7175 656e 6365  start, "sequence
+0001d6a0: 2229 0a20 2020 2073 746f 705f 636f 6c20  ").    stop_col 
+0001d6b0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001d6c0: 2873 746f 702c 2022 7365 7175 656e 6365  (stop, "sequence
+0001d6d0: 2229 0a20 2020 2069 6620 7374 6570 2069  ").    if step i
+0001d6e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001d6f0: 7374 6570 203d 2069 6666 2862 7569 6c74  step = iff(built
+0001d700: 696e 2822 7369 676e 2229 2873 746f 705f  in("sign")(stop_
+0001d710: 636f 6c20 2d20 7374 6172 745f 636f 6c29  col - start_col)
+0001d720: 203e 2030 2c20 312c 202d 3129 0a20 2020   > 0, 1, -1).   
+0001d730: 2020 2020 2072 6574 7572 6e20 6275 696c       return buil
+0001d740: 7469 6e28 2261 7272 6179 5f67 656e 6572  tin("array_gener
+0001d750: 6174 655f 7261 6e67 6522 2928 7374 6172  ate_range")(star
+0001d760: 745f 636f 6c2c 2073 746f 705f 636f 6c20  t_col, stop_col 
+0001d770: 2b20 7374 6570 2c20 7374 6570 290a 2020  + step, step).  
+0001d780: 2020 7374 6570 5f63 6f6c 203d 205f 746f    step_col = _to
+0001d790: 5f63 6f6c 5f69 665f 7374 7228 7374 6570  _col_if_str(step
+0001d7a0: 2c20 2273 6571 7565 6e63 6522 290a 2020  , "sequence").  
+0001d7b0: 2020 7374 6570 5f73 6967 6e20 3d20 6966    step_sign = if
+0001d7c0: 6628 6275 696c 7469 6e28 2273 6967 6e22  f(builtin("sign"
+0001d7d0: 2928 7374 6570 5f63 6f6c 2920 3e20 302c  )(step_col) > 0,
+0001d7e0: 2031 2c20 2d31 290a 2020 2020 7265 7475   1, -1).    retu
+0001d7f0: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
+0001d800: 795f 6765 6e65 7261 7465 5f72 616e 6765  y_generate_range
+0001d810: 2229 2873 7461 7274 5f63 6f6c 2c20 7374  ")(start_col, st
+0001d820: 6f70 5f63 6f6c 202b 2073 7465 705f 7369  op_col + step_si
+0001d830: 676e 2c20 7374 6570 5f63 6f6c 290a 0a0a  gn, step_col)...
+0001d840: 6465 6620 6461 7465 5f61 6464 2863 6f6c  def date_add(col
+0001d850: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0001d860: 6e75 6d5f 6f66 5f64 6179 733a 2055 6e69  num_of_days: Uni
+0001d870: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+0001d880: 2069 6e74 5d29 3a0a 2020 2020 2222 220a   int]):.    """.
+0001d890: 2020 2020 4164 6473 2061 206e 756d 6265      Adds a numbe
+0001d8a0: 7220 6f66 2064 6179 7320 746f 2061 2064  r of days to a d
+0001d8b0: 6174 6520 636f 6c75 6d6e 2e0a 0a20 2020  ate column...   
+0001d8c0: 2041 7267 733a 0a20 2020 2020 2020 2063   Args:.        c
+0001d8d0: 6f6c 3a20 5468 6520 636f 6c75 6d6e 2074  ol: The column t
+0001d8e0: 6f20 6164 6420 746f 2e0a 2020 2020 2020  o add to..      
+0001d8f0: 2020 6e75 6d5f 6f66 5f64 6179 733a 2054    num_of_days: T
+0001d900: 6865 206e 756d 6265 7220 6f66 2064 6179  he number of day
+0001d910: 7320 746f 2061 6464 2e0a 0a20 2020 2045  s to add...    E
+0001d920: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0001d930: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0001d940: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
+0001d950: 6e63 7469 6f6e 7320 696d 706f 7274 2064  nctions import d
+0001d960: 6174 655f 6164 642c 2074 6f5f 6461 7465  ate_add, to_date
+0001d970: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0001d980: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0001d990: 4461 7461 4672 616d 6528 5b28 2231 3937  DataFrame([("197
+0001d9a0: 362d 3031 2d30 3622 295d 2c20 5b22 6461  6-01-06")], ["da
+0001d9b0: 7465 225d 290a 2020 2020 2020 2020 3e3e  te"]).        >>
+0001d9c0: 3e20 6466 203d 2064 662e 7769 7468 436f  > df = df.withCo
+0001d9d0: 6c75 6d6e 2822 6461 7465 222c 2074 6f5f  lumn("date", to_
+0001d9e0: 6461 7465 2822 6461 7465 2229 290a 2020  date("date")).  
+0001d9f0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+0001da00: 6466 2e77 6974 6843 6f6c 756d 6e28 2264  df.withColumn("d
+0001da10: 6174 6522 2c20 6461 7465 5f61 6464 2822  ate", date_add("
+0001da20: 6461 7465 222c 2034 2929 2e73 686f 7728  date", 4)).show(
+0001da30: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0001da40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0001da50: 207c 2244 4154 4522 2020 2020 2020 7c0a   |"DATE"      |.
+0001da60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001da70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0001da80: 3139 3736 2d30 312d 3130 2020 7c0a 2020  1976-01-10  |.  
+0001da90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001daa0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0001dab0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0001dac0: 0a20 2020 2023 2043 6f6e 7665 7274 2074  .    # Convert t
+0001dad0: 6865 2069 6e70 7574 2074 6f20 6120 636f  he input to a co
+0001dae0: 6c75 6d6e 2069 6620 6974 2069 7320 6120  lumn if it is a 
+0001daf0: 7374 7269 6e67 0a20 2020 2063 6f6c 203d  string.    col =
+0001db00: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0001db10: 636f 6c2c 2022 6461 7465 5f61 6464 2229  col, "date_add")
+0001db20: 0a20 2020 206e 756d 5f6f 665f 6461 7973  .    num_of_days
+0001db30: 203d 2028 0a20 2020 2020 2020 206c 6974   = (.        lit
+0001db40: 286e 756d 5f6f 665f 6461 7973 290a 2020  (num_of_days).  
+0001db50: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001db60: 6e63 6528 6e75 6d5f 6f66 5f64 6179 732c  nce(num_of_days,
+0001db70: 2069 6e74 290a 2020 2020 2020 2020 656c   int).        el
+0001db80: 7365 205f 746f 5f63 6f6c 5f69 665f 7374  se _to_col_if_st
+0001db90: 7228 6e75 6d5f 6f66 5f64 6179 732c 2022  r(num_of_days, "
+0001dba0: 6461 7465 5f61 6464 2229 0a20 2020 2029  date_add").    )
+0001dbb0: 0a20 2020 2023 2052 6574 7572 6e20 7468  .    # Return th
+0001dbc0: 6520 6461 7465 6164 6420 6675 6e63 7469  e dateadd functi
+0001dbd0: 6f6e 2077 6974 6820 7468 6520 636f 6c75  on with the colu
+0001dbe0: 6d6e 2061 6e64 206e 756d 6265 7220 6f66  mn and number of
+0001dbf0: 2064 6179 730a 2020 2020 7265 7475 726e   days.    return
+0001dc00: 2064 6174 6561 6464 2822 6461 7922 2c20   dateadd("day", 
+0001dc10: 6e75 6d5f 6f66 5f64 6179 732c 2063 6f6c  num_of_days, col
+0001dc20: 290a 0a0a 6465 6620 6461 7465 5f73 7562  )...def date_sub
+0001dc30: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
+0001dc40: 6d65 2c20 6e75 6d5f 6f66 5f64 6179 733a  me, num_of_days:
+0001dc50: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
+0001dc60: 616d 652c 2069 6e74 5d29 3a0a 2020 2020  ame, int]):.    
+0001dc70: 2222 220a 2020 2020 5375 6274 7261 6374  """.    Subtract
+0001dc80: 7320 6120 6e75 6d62 6572 206f 6620 6461  s a number of da
+0001dc90: 7973 2066 726f 6d20 6120 6461 7465 2063  ys from a date c
+0001dca0: 6f6c 756d 6e2e 0a0a 2020 2020 4172 6773  olumn...    Args
+0001dcb0: 3a0a 2020 2020 2020 2020 636f 6c3a 2054  :.        col: T
+0001dcc0: 6865 2063 6f6c 756d 6e20 746f 2073 7562  he column to sub
+0001dcd0: 7472 6163 7420 6672 6f6d 2e0a 2020 2020  tract from..    
+0001dce0: 2020 2020 6e75 6d5f 6f66 5f64 6179 733a      num_of_days:
+0001dcf0: 2054 6865 206e 756d 6265 7220 6f66 2064   The number of d
+0001dd00: 6179 7320 746f 2073 7562 7472 6163 742e  ays to subtract.
+0001dd10: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0001dd20: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001dd30: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0001dd40: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
+0001dd50: 6d70 6f72 7420 6461 7465 5f73 7562 2c20  mport date_sub, 
+0001dd60: 746f 5f64 6174 650a 2020 2020 2020 2020  to_date.        
+0001dd70: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0001dd80: 2e63 7265 6174 6544 6174 6146 7261 6d65  .createDataFrame
+0001dd90: 285b 2822 3139 3736 2d30 312d 3036 2229  ([("1976-01-06")
+0001dda0: 5d2c 205b 2264 6174 6522 5d29 0a20 2020  ], ["date"]).   
+0001ddb0: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
+0001ddc0: 2e77 6974 6843 6f6c 756d 6e28 2264 6174  .withColumn("dat
+0001ddd0: 6522 2c20 746f 5f64 6174 6528 2264 6174  e", to_date("dat
+0001dde0: 6522 2929 0a20 2020 2020 2020 203e 3e3e  e")).        >>>
+0001ddf0: 2064 662e 7769 7468 436f 6c75 6d6e 2822   df.withColumn("
+0001de00: 6461 7465 222c 2064 6174 655f 7375 6228  date", date_sub(
+0001de10: 2264 6174 6522 2c20 3229 292e 7368 6f77  "date", 2)).show
+0001de20: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+0001de30: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001de40: 2020 7c22 4441 5445 2220 2020 2020 207c    |"DATE"      |
+0001de50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001de60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001de70: 7c31 3937 362d 3031 2d30 3420 207c 0a20  |1976-01-04  |. 
+0001de80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001de90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0001dea0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0001deb0: 220a 2020 2020 2320 436f 6e76 6572 7420  ".    # Convert 
+0001dec0: 7468 6520 696e 7075 7420 7061 7261 6d65  the input parame
+0001ded0: 7465 7273 2074 6f20 7468 6520 6170 7072  ters to the appr
+0001dee0: 6f70 7269 6174 6520 7479 7065 0a20 2020  opriate type.   
+0001def0: 2063 6f6c 203d 205f 746f 5f63 6f6c 5f69   col = _to_col_i
+0001df00: 665f 7374 7228 636f 6c2c 2022 6461 7465  f_str(col, "date
+0001df10: 5f73 7562 2229 0a20 2020 206e 756d 5f6f  _sub").    num_o
+0001df20: 665f 6461 7973 203d 2028 0a20 2020 2020  f_days = (.     
+0001df30: 2020 206c 6974 286e 756d 5f6f 665f 6461     lit(num_of_da
+0001df40: 7973 290a 2020 2020 2020 2020 6966 2069  ys).        if i
+0001df50: 7369 6e73 7461 6e63 6528 6e75 6d5f 6f66  sinstance(num_of
+0001df60: 5f64 6179 732c 2069 6e74 290a 2020 2020  _days, int).    
+0001df70: 2020 2020 656c 7365 205f 746f 5f63 6f6c      else _to_col
+0001df80: 5f69 665f 7374 7228 6e75 6d5f 6f66 5f64  _if_str(num_of_d
+0001df90: 6179 732c 2022 6461 7465 5f73 7562 2229  ays, "date_sub")
+0001dfa0: 0a20 2020 2029 0a20 2020 2023 2052 6574  .    ).    # Ret
+0001dfb0: 7572 6e20 7468 6520 6461 7465 2063 6f6c  urn the date col
+0001dfc0: 756d 6e20 7769 7468 2074 6865 206e 756d  umn with the num
+0001dfd0: 6265 7220 6f66 2064 6179 7320 7375 6274  ber of days subt
+0001dfe0: 7261 6374 6564 0a20 2020 2072 6574 7572  racted.    retur
+0001dff0: 6e20 6461 7465 6164 6428 2264 6179 222c  n dateadd("day",
+0001e000: 202d 3120 2a20 6e75 6d5f 6f66 5f64 6179   -1 * num_of_day
+0001e010: 732c 2063 6f6c 290a 0a0a 6465 6620 6461  s, col)...def da
+0001e020: 7465 6469 6666 2870 6172 743a 2073 7472  tediff(part: str
+0001e030: 2c20 636f 6c31 3a20 436f 6c75 6d6e 4f72  , col1: ColumnOr
+0001e040: 4e61 6d65 2c20 636f 6c32 3a20 436f 6c75  Name, col2: Colu
+0001e050: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0001e060: 756d 6e3a 0a20 2020 2022 2222 4361 6c63  umn:.    """Calc
+0001e070: 756c 6174 6573 2074 6865 2064 6966 6665  ulates the diffe
+0001e080: 7265 6e63 6520 6265 7477 6565 6e20 7477  rence between tw
+0001e090: 6f20 6461 7465 2c20 7469 6d65 2c20 6f72  o date, time, or
+0001e0a0: 2074 696d 6573 7461 6d70 2063 6f6c 756d   timestamp colum
+0001e0b0: 6e73 2062 6173 6564 206f 6e20 7468 6520  ns based on the 
+0001e0c0: 6461 7465 206f 7220 7469 6d65 2070 6172  date or time par
+0001e0d0: 7420 7265 7175 6573 7465 642e 0a0a 2020  t requested...  
+0001e0e0: 2020 6053 7570 706f 7274 6564 2064 6174    `Supported dat
+0001e0f0: 6520 616e 6420 7469 6d65 2070 6172 7473  e and time parts
+0001e100: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+0001e110: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+0001e120: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
+0001e130: 6e63 7469 6f6e 732d 6461 7465 2d74 696d  nctions-date-tim
+0001e140: 652e 6874 6d6c 236c 6162 656c 2d73 7570  e.html#label-sup
+0001e150: 706f 7274 6564 2d64 6174 652d 7469 6d65  ported-date-time
+0001e160: 2d70 6172 7473 3e60 5f0a 0a20 2020 2045  -parts>`_..    E
+0001e170: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0001e180: 2020 3e3e 3e20 2320 7965 6172 2064 6966    >>> # year dif
+0001e190: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
+0001e1a0: 7477 6f20 6461 7465 2063 6f6c 756d 6e73  two date columns
+0001e1b0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001e1c0: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+0001e1d0: 2020 2020 203e 3e3e 2064 6174 655f 6466       >>> date_df
+0001e1e0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0001e1f0: 655f 6461 7461 6672 616d 6528 5b5b 6461  e_dataframe([[da
+0001e200: 7465 7469 6d65 2e64 6174 6528 3230 3230  tetime.date(2020
+0001e210: 2c20 312c 2031 292c 2064 6174 6574 696d  , 1, 1), datetim
+0001e220: 652e 6461 7465 2832 3032 312c 2031 2c20  e.date(2021, 1, 
+0001e230: 3129 5d5d 2c20 7363 6865 6d61 3d5b 2264  1)]], schema=["d
+0001e240: 6174 655f 636f 6c31 222c 2022 6461 7465  ate_col1", "date
+0001e250: 5f63 6f6c 3222 5d29 0a20 2020 2020 2020  _col2"]).       
+0001e260: 203e 3e3e 2064 6174 655f 6466 2e73 656c   >>> date_df.sel
+0001e270: 6563 7428 6461 7465 6469 6666 2822 7965  ect(datediff("ye
+0001e280: 6172 222c 2063 6f6c 2822 6461 7465 5f63  ar", col("date_c
+0001e290: 6f6c 3122 292c 2063 6f6c 2822 6461 7465  ol1"), col("date
+0001e2a0: 5f63 6f6c 3222 2929 2e61 6c69 6173 2822  _col2")).alias("
+0001e2b0: 7965 6172 5f64 6966 6622 2929 2e73 686f  year_diff")).sho
+0001e2c0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0001e2d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001e2e0: 2020 2020 7c22 5945 4152 5f44 4946 4622      |"YEAR_DIFF"
+0001e2f0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001e300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001e310: 2020 2020 7c31 2020 2020 2020 2020 2020      |1          
+0001e320: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001e330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0001e340: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0001e350: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0001e360: 2020 2070 6172 743a 2054 6865 2074 696d     part: The tim
+0001e370: 6520 7061 7274 2074 6f20 7573 6520 666f  e part to use fo
+0001e380: 7220 6361 6c63 756c 6174 696e 6720 7468  r calculating th
+0001e390: 6520 6469 6666 6572 656e 6365 0a20 2020  e difference.   
+0001e3a0: 2020 2020 2063 6f6c 313a 2054 6865 2066       col1: The f
+0001e3b0: 6972 7374 2074 696d 6573 7461 6d70 2063  irst timestamp c
+0001e3c0: 6f6c 756d 6e20 6f72 206d 696e 7565 6e64  olumn or minuend
+0001e3d0: 2069 6e20 7468 6520 6461 7465 6469 6666   in the datediff
+0001e3e0: 0a20 2020 2020 2020 2063 6f6c 323a 2054  .        col2: T
+0001e3f0: 6865 2073 6563 6f6e 6420 7469 6d65 7374  he second timest
+0001e400: 616d 7020 636f 6c75 6d6e 206f 7220 7468  amp column or th
+0001e410: 6520 7375 6274 7261 6865 6e64 2069 6e20  e subtrahend in 
+0001e420: 7468 6520 6461 7465 6469 6666 0a20 2020  the datediff.   
+0001e430: 2022 2222 0a20 2020 2069 6620 6e6f 7420   """.    if not 
+0001e440: 6973 696e 7374 616e 6365 2870 6172 742c  isinstance(part,
+0001e450: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
+0001e460: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001e470: 2270 6172 7420 6d75 7374 2062 6520 6120  "part must be a 
+0001e480: 7374 7269 6e67 2229 0a20 2020 2063 3120  string").    c1 
+0001e490: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001e4a0: 2863 6f6c 312c 2022 6461 7465 6469 6666  (col1, "datediff
+0001e4b0: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
+0001e4c0: 636f 6c5f 6966 5f73 7472 2863 6f6c 322c  col_if_str(col2,
+0001e4d0: 2022 6461 7465 6469 6666 2229 0a20 2020   "datediff").   
+0001e4e0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0001e4f0: 2264 6174 6564 6966 6622 2928 7061 7274  "datediff")(part
+0001e500: 2c20 6331 2c20 6332 290a 0a0a 6465 6620  , c1, c2)...def 
+0001e510: 6461 7964 6966 6628 636f 6c31 3a20 436f  daydiff(col1: Co
+0001e520: 6c75 6d6e 4f72 4e61 6d65 2c20 636f 6c32  lumnOrName, col2
+0001e530: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+0001e540: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+0001e550: 2222 4361 6c63 756c 6174 6573 2074 6865  ""Calculates the
+0001e560: 2064 6966 6665 7265 6e63 6520 6265 7477   difference betw
+0001e570: 6565 6e20 7477 6f20 6461 7465 732c 206f  een two dates, o
+0001e580: 7220 7469 6d65 7374 616d 7020 636f 6c75  r timestamp colu
+0001e590: 6d6e 7320 6261 7365 6420 696e 2064 6179  mns based in day
+0001e5a0: 732e 0a20 2020 2054 6865 2072 6573 756c  s..    The resul
+0001e5b0: 7420 7769 6c6c 2072 6566 6c65 6374 2074  t will reflect t
+0001e5c0: 6865 2064 6966 6665 7265 6e63 6520 6265  he difference be
+0001e5d0: 7477 6565 6e20 636f 6c32 202d 2063 6f6c  tween col2 - col
+0001e5e0: 310a 0a20 2020 2045 7861 6d70 6c65 3a3a  1..    Example::
+0001e5f0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001e600: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+0001e610: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
+0001e620: 6d70 6f72 7420 6461 7964 6966 662c 2074  mport daydiff, t
+0001e630: 6f5f 6461 7465 0a20 2020 2020 2020 203e  o_date.        >
+0001e640: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0001e650: 6372 6561 7465 4461 7461 4672 616d 6528  createDataFrame(
+0001e660: 5b28 2232 3031 352d 3034 2d30 3822 2c20  [("2015-04-08", 
+0001e670: 2232 3031 352d 3035 2d31 3022 295d 2c20  "2015-05-10")], 
+0001e680: 5b22 6431 222c 2022 6432 225d 290a 2020  ["d1", "d2"]).  
+0001e690: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+0001e6a0: 6466 2e73 656c 6563 7428 6461 7964 6966  df.select(daydif
+0001e6b0: 6628 746f 5f64 6174 6528 6466 2e64 3229  f(to_date(df.d2)
+0001e6c0: 2c20 746f 5f64 6174 6528 6466 2e64 3129  , to_date(df.d1)
+0001e6d0: 292e 616c 6961 7328 2264 6966 6622 2929  ).alias("diff"))
+0001e6e0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0001e6f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001e700: 2020 207c 2244 4946 4622 2020 7c0a 2020     |"DIFF"  |.  
+0001e710: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001e720: 0a20 2020 2020 2020 207c 3332 2020 2020  .        |32    
+0001e730: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001e740: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0001e750: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0001e760: 2222 0a20 2020 2063 6f6c 3120 3d20 5f74  "".    col1 = _t
+0001e770: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+0001e780: 312c 2022 6461 7964 6966 6622 290a 2020  1, "daydiff").  
+0001e790: 2020 636f 6c32 203d 205f 746f 5f63 6f6c    col2 = _to_col
+0001e7a0: 5f69 665f 7374 7228 636f 6c32 2c20 2264  _if_str(col2, "d
+0001e7b0: 6179 6469 6666 2229 0a20 2020 2072 6574  aydiff").    ret
+0001e7c0: 7572 6e20 6275 696c 7469 6e28 2264 6174  urn builtin("dat
+0001e7d0: 6564 6966 6622 2928 6c69 7428 2264 6179  ediff")(lit("day
+0001e7e0: 2229 2c20 636f 6c32 2c20 636f 6c31 290a  "), col2, col1).
+0001e7f0: 0a0a 6465 6620 7472 756e 6328 653a 2043  ..def trunc(e: C
+0001e800: 6f6c 756d 6e4f 724e 616d 652c 2073 6361  olumnOrName, sca
+0001e810: 6c65 3a20 556e 696f 6e5b 436f 6c75 6d6e  le: Union[Column
+0001e820: 4f72 4e61 6d65 2c20 696e 742c 2066 6c6f  OrName, int, flo
+0001e830: 6174 5d20 3d20 3029 202d 3e20 436f 6c75  at] = 0) -> Colu
+0001e840: 6d6e 3a0a 2020 2020 2222 2252 6f75 6e64  mn:.    """Round
+0001e850: 7320 7468 6520 696e 7075 7420 6578 7072  s the input expr
+0001e860: 6573 7369 6f6e 2064 6f77 6e20 746f 2074  ession down to t
+0001e870: 6865 206e 6561 7265 7374 2028 6f72 2065  he nearest (or e
+0001e880: 7175 616c 2920 696e 7465 6765 7220 636c  qual) integer cl
+0001e890: 6f73 6572 2074 6f20 7a65 726f 2c0a 2020  oser to zero,.  
+0001e8a0: 2020 6f72 2074 6f20 7468 6520 6e65 6172    or to the near
+0001e8b0: 6573 7420 6571 7561 6c20 6f72 2073 6d61  est equal or sma
+0001e8c0: 6c6c 6572 2076 616c 7565 2077 6974 6820  ller value with 
+0001e8d0: 7468 6520 7370 6563 6966 6965 6420 6e75  the specified nu
+0001e8e0: 6d62 6572 206f 660a 2020 2020 706c 6163  mber of.    plac
+0001e8f0: 6573 2061 6674 6572 2074 6865 2064 6563  es after the dec
+0001e900: 696d 616c 2070 6f69 6e74 2e0a 0a20 2020  imal point...   
+0001e910: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0001e920: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0001e930: 7369 6f6e 2e63 7265 6174 6544 6174 6146  sion.createDataF
+0001e940: 7261 6d65 285b 2d31 2e30 2c20 2d30 2e39  rame([-1.0, -0.9
+0001e950: 2c20 2d2e 352c 202d 2e32 2c20 302e 302c  , -.5, -.2, 0.0,
+0001e960: 2030 2e32 2c20 302e 352c 2030 2e39 2c20   0.2, 0.5, 0.9, 
+0001e970: 312e 312c 2033 2e31 3431 3539 5d2c 2073  1.1, 3.14159], s
+0001e980: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0001e990: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0001e9a0: 6374 2874 7275 6e63 2863 6f6c 2822 6122  ct(trunc(col("a"
+0001e9b0: 2929 292e 636f 6c6c 6563 7428 290a 2020  ))).collect().  
+0001e9c0: 2020 2020 2020 5b52 6f77 2854 5255 4e43        [Row(TRUNC
+0001e9d0: 2822 4122 2c20 3029 3d2d 312e 3029 2c20  ("A", 0)=-1.0), 
+0001e9e0: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
+0001e9f0: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
+0001ea00: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
+0001ea10: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
+0001ea20: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
+0001ea30: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
+0001ea40: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
+0001ea50: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
+0001ea60: 4328 2241 222c 2030 293d 302e 3029 2c20  C("A", 0)=0.0), 
+0001ea70: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
+0001ea80: 293d 302e 3029 2c20 526f 7728 5452 554e  )=0.0), Row(TRUN
+0001ea90: 4328 2241 222c 2030 293d 312e 3029 2c20  C("A", 0)=1.0), 
+0001eaa0: 526f 7728 5452 554e 4328 2241 222c 2030  Row(TRUNC("A", 0
+0001eab0: 293d 332e 3029 5d0a 0a20 2020 2020 2020  )=3.0)]..       
+0001eac0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0001ead0: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
+0001eae0: 6528 5b2d 312e 3332 332c 2034 2e35 3637  e([-1.323, 4.567
+0001eaf0: 2c20 302e 3031 3233 5d2c 2073 6368 656d  , 0.0123], schem
+0001eb00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
+0001eb10: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
+0001eb20: 7275 6e63 2863 6f6c 2822 6122 292c 206c  runc(col("a"), l
+0001eb30: 6974 2830 2929 292e 636f 6c6c 6563 7428  it(0))).collect(
+0001eb40: 290a 2020 2020 2020 2020 5b52 6f77 2854  ).        [Row(T
+0001eb50: 5255 4e43 2822 4122 2c20 3029 3d2d 312e  RUNC("A", 0)=-1.
+0001eb60: 3029 2c20 526f 7728 5452 554e 4328 2241  0), Row(TRUNC("A
+0001eb70: 222c 2030 293d 342e 3029 2c20 526f 7728  ", 0)=4.0), Row(
+0001eb80: 5452 554e 4328 2241 222c 2030 293d 302e  TRUNC("A", 0)=0.
+0001eb90: 3029 5d0a 2020 2020 2020 2020 3e3e 3e20  0)].        >>> 
+0001eba0: 6466 2e73 656c 6563 7428 7472 756e 6328  df.select(trunc(
+0001ebb0: 636f 6c28 2261 2229 2c20 6c69 7428 3129  col("a"), lit(1)
+0001ebc0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0001ebd0: 2020 2020 205b 526f 7728 5452 554e 4328       [Row(TRUNC(
+0001ebe0: 2241 222c 2031 293d 2d31 2e33 292c 2052  "A", 1)=-1.3), R
+0001ebf0: 6f77 2854 5255 4e43 2822 4122 2c20 3129  ow(TRUNC("A", 1)
+0001ec00: 3d34 2e35 292c 2052 6f77 2854 5255 4e43  =4.5), Row(TRUNC
+0001ec10: 2822 4122 2c20 3129 3d30 2e30 295d 0a20  ("A", 1)=0.0)]. 
+0001ec20: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001ec30: 6c65 6374 2874 7275 6e63 2863 6f6c 2822  lect(trunc(col("
+0001ec40: 6122 292c 206c 6974 2832 2929 292e 636f  a"), lit(2))).co
+0001ec50: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001ec60: 5b52 6f77 2854 5255 4e43 2822 4122 2c20  [Row(TRUNC("A", 
+0001ec70: 3229 3d2d 312e 3332 292c 2052 6f77 2854  2)=-1.32), Row(T
+0001ec80: 5255 4e43 2822 4122 2c20 3229 3d34 2e35  RUNC("A", 2)=4.5
+0001ec90: 3629 2c20 526f 7728 5452 554e 4328 2241  6), Row(TRUNC("A
+0001eca0: 222c 2032 293d 302e 3031 295d 0a0a 2020  ", 2)=0.01)]..  
+0001ecb0: 2020 4e6f 7465 2074 6861 7420 7468 6520    Note that the 
+0001ecc0: 6675 6e63 7469 6f6e 2060 6074 7275 6e63  function ``trunc
+0001ecd0: 6060 2069 7320 6f76 6572 6c6f 6164 6564  `` is overloaded
+0001ece0: 2077 6974 6820 6060 6461 7465 5f74 7275   with ``date_tru
+0001ecf0: 6e63 6060 2066 6f72 2064 6174 6574 696d  nc`` for datetim
+0001ed00: 6520 7479 7065 732e 2049 7420 616c 6c6f  e types. It allo
+0001ed10: 7773 2074 6f20 726f 756e 6420 6461 7465  ws to round date
+0001ed20: 7469 6d65 0a20 2020 206f 626a 6563 7473  time.    objects
+0001ed30: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0001ed40: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
+0001ed50: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
+0001ed60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0001ed70: 6573 7369 6f6e 2e63 7265 6174 6544 6174  ession.createDat
+0001ed80: 6146 7261 6d65 285b 6461 7465 7469 6d65  aFrame([datetime
+0001ed90: 2e64 6174 6528 3230 3232 2c20 3132 2c20  .date(2022, 12, 
+0001eda0: 3235 292c 2064 6174 6574 696d 652e 6461  25), datetime.da
+0001edb0: 7465 2832 3032 322c 2031 2c20 3130 292c  te(2022, 1, 10),
+0001edc0: 2064 6174 6574 696d 652e 6461 7465 2832   datetime.date(2
+0001edd0: 3032 322c 2037 2c20 3729 5d2c 2073 6368  022, 7, 7)], sch
+0001ede0: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0001edf0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0001ee00: 2874 7275 6e63 2863 6f6c 2822 6122 292c  (trunc(col("a"),
+0001ee10: 206c 6974 2822 5155 4152 5445 5222 2929   lit("QUARTER"))
+0001ee20: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
+0001ee30: 2020 2020 5b52 6f77 2854 5255 4e43 2822      [Row(TRUNC("
+0001ee40: 4122 2c20 2751 5541 5254 4552 2729 3d64  A", 'QUARTER')=d
+0001ee50: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+0001ee60: 322c 2031 302c 2031 2929 2c20 526f 7728  2, 10, 1)), Row(
+0001ee70: 5452 554e 4328 2241 222c 2027 5155 4152  TRUNC("A", 'QUAR
+0001ee80: 5445 5227 293d 6461 7465 7469 6d65 2e64  TER')=datetime.d
+0001ee90: 6174 6528 3230 3232 2c20 312c 2031 2929  ate(2022, 1, 1))
+0001eea0: 2c20 526f 7728 5452 554e 4328 2241 222c  , Row(TRUNC("A",
+0001eeb0: 2027 5155 4152 5445 5227 293d 6461 7465   'QUARTER')=date
+0001eec0: 7469 6d65 2e64 6174 6528 3230 3232 2c20  time.date(2022, 
+0001eed0: 372c 2031 2929 5d0a 0a20 2020 2020 2020  7, 1))]..       
+0001eee0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0001eef0: 6e2e 6372 6561 7465 4461 7461 4672 616d  n.createDataFram
+0001ef00: 6528 5b64 6174 6574 696d 652e 6461 7465  e([datetime.date
+0001ef10: 7469 6d65 2832 3032 322c 2031 322c 2032  time(2022, 12, 2
+0001ef20: 352c 2031 332c 2035 392c 2033 382c 2034  5, 13, 59, 38, 4
+0001ef30: 3637 295d 2c20 7363 6865 6d61 3d5b 2261  67)], schema=["a
+0001ef40: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+0001ef50: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
+0001ef60: 2020 2020 205b 526f 7728 413d 6461 7465       [Row(A=date
+0001ef70: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+0001ef80: 3232 2c20 3132 2c20 3235 2c20 3133 2c20  22, 12, 25, 13, 
+0001ef90: 3539 2c20 3338 2c20 3436 3729 295d 0a20  59, 38, 467))]. 
+0001efa0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001efb0: 6c65 6374 2874 7275 6e63 2863 6f6c 2822  lect(trunc(col("
+0001efc0: 6122 292c 206c 6974 2822 4d49 4e55 5445  a"), lit("MINUTE
+0001efd0: 2229 2929 2e63 6f6c 6c65 6374 2829 0a20  "))).collect(). 
+0001efe0: 2020 2020 2020 205b 526f 7728 5452 554e         [Row(TRUN
+0001eff0: 4328 2241 222c 2027 4d49 4e55 5445 2729  C("A", 'MINUTE')
+0001f000: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+0001f010: 6d65 2832 3032 322c 2031 322c 2032 352c  me(2022, 12, 25,
+0001f020: 2031 332c 2035 3929 295d 0a0a 2020 2020   13, 59))]..    
+0001f030: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+0001f040: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
+0001f050: 7275 6e63 2229 0a20 2020 2073 6361 6c65  runc").    scale
+0001f060: 5f63 6f6c 203d 2028 0a20 2020 2020 2020  _col = (.       
+0001f070: 206c 6974 2873 6361 6c65 290a 2020 2020   lit(scale).    
+0001f080: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001f090: 6528 7363 616c 652c 2028 696e 742c 2066  e(scale, (int, f
+0001f0a0: 6c6f 6174 2929 0a20 2020 2020 2020 2065  loat)).        e
+0001f0b0: 6c73 6520 5f74 6f5f 636f 6c5f 6966 5f73  lse _to_col_if_s
+0001f0c0: 7472 2873 6361 6c65 2c20 2274 7275 6e63  tr(scale, "trunc
+0001f0d0: 2229 0a20 2020 2029 0a20 2020 2072 6574  ").    ).    ret
+0001f0e0: 7572 6e20 6275 696c 7469 6e28 2274 7275  urn builtin("tru
+0001f0f0: 6e63 2229 2863 2c20 7363 616c 655f 636f  nc")(c, scale_co
+0001f100: 6c29 0a0a 0a64 6566 2064 6174 6561 6464  l)...def dateadd
+0001f110: 2870 6172 743a 2073 7472 2c20 636f 6c31  (part: str, col1
+0001f120: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0001f130: 636f 6c32 3a20 436f 6c75 6d6e 4f72 4e61  col2: ColumnOrNa
+0001f140: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0001f150: 2020 2022 2222 4164 6473 2074 6865 2073     """Adds the s
+0001f160: 7065 6369 6669 6564 2076 616c 7565 2066  pecified value f
+0001f170: 6f72 2074 6865 2073 7065 6369 6669 6564  or the specified
+0001f180: 2064 6174 6520 6f72 2074 696d 6520 7061   date or time pa
+0001f190: 7274 2074 6f20 6461 7465 206f 7220 7469  rt to date or ti
+0001f1a0: 6d65 2065 7870 722e 0a0a 2020 2020 6053  me expr...    `S
+0001f1b0: 7570 706f 7274 6564 2064 6174 6520 616e  upported date an
+0001f1c0: 6420 7469 6d65 2070 6172 7473 203c 6874  d time parts <ht
+0001f1d0: 7470 733a 2f2f 646f 6373 2e73 6e6f 7766  tps://docs.snowf
+0001f1e0: 6c61 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d  lake.com/en/sql-
+0001f1f0: 7265 6665 7265 6e63 652f 6675 6e63 7469  reference/functi
+0001f200: 6f6e 732d 6461 7465 2d74 696d 652e 6874  ons-date-time.ht
+0001f210: 6d6c 236c 6162 656c 2d73 7570 706f 7274  ml#label-support
+0001f220: 6564 2d64 6174 652d 7469 6d65 2d70 6172  ed-date-time-par
+0001f230: 7473 3e60 5f0a 0a20 2020 2045 7861 6d70  ts>`_..    Examp
+0001f240: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0001f250: 3e20 2320 6164 6420 6f6e 6520 7965 6172  > # add one year
+0001f260: 206f 6e20 6461 7465 730a 2020 2020 2020   on dates.      
+0001f270: 2020 3e3e 3e20 696d 706f 7274 2064 6174    >>> import dat
+0001f280: 6574 696d 650a 2020 2020 2020 2020 3e3e  etime.        >>
+0001f290: 3e20 6461 7465 5f64 6620 3d20 7365 7373  > date_df = sess
+0001f2a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+0001f2b0: 7261 6d65 285b 5b64 6174 6574 696d 652e  rame([[datetime.
+0001f2c0: 6461 7465 2832 3032 302c 2031 2c20 3129  date(2020, 1, 1)
+0001f2d0: 5d5d 2c20 7363 6865 6d61 3d5b 2264 6174  ]], schema=["dat
+0001f2e0: 655f 636f 6c22 5d29 0a20 2020 2020 2020  e_col"]).       
+0001f2f0: 203e 3e3e 2064 6174 655f 6466 2e73 656c   >>> date_df.sel
+0001f300: 6563 7428 6461 7465 6164 6428 2279 6561  ect(dateadd("yea
+0001f310: 7222 2c20 6c69 7428 3129 2c20 636f 6c28  r", lit(1), col(
+0001f320: 2264 6174 655f 636f 6c22 2929 2e61 6c69  "date_col")).ali
+0001f330: 6173 2822 7965 6172 5f61 6464 6564 2229  as("year_added")
+0001f340: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+0001f350: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0001f360: 2d0a 2020 2020 2020 2020 7c22 5945 4152  -.        |"YEAR
+0001f370: 5f41 4444 4544 2220 207c 0a20 2020 2020  _ADDED"  |.     
+0001f380: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0001f390: 2d2d 2d0a 2020 2020 2020 2020 7c32 3032  ---.        |202
+0001f3a0: 312d 3031 2d30 3120 2020 207c 0a20 2020  1-01-01    |.   
+0001f3b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0001f3c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0001f3d0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2020  LANKLINE>.      
+0001f3e0: 2020 3e3e 3e20 6461 7465 5f64 662e 7365    >>> date_df.se
+0001f3f0: 6c65 6374 2864 6174 6561 6464 2822 6d6f  lect(dateadd("mo
+0001f400: 6e74 6822 2c20 6c69 7428 3129 2c20 636f  nth", lit(1), co
+0001f410: 6c28 2264 6174 655f 636f 6c22 2929 2e61  l("date_col")).a
+0001f420: 6c69 6173 2822 6d6f 6e74 685f 6164 6465  lias("month_adde
+0001f430: 6422 2929 2e73 686f 7728 290a 2020 2020  d")).show().    
+0001f440: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0001f450: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+0001f460: 4d4f 4e54 485f 4144 4445 4422 2020 7c0a  MONTH_ADDED"  |.
+0001f470: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f480: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001f490: 2020 7c32 3032 302d 3032 2d30 3120 2020    |2020-02-01   
+0001f4a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0001f4b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0001f4c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+0001f4d0: 3e0a 2020 2020 2020 2020 3e3e 3e20 6461  >.        >>> da
+0001f4e0: 7465 5f64 662e 7365 6c65 6374 2864 6174  te_df.select(dat
+0001f4f0: 6561 6464 2822 6461 7922 2c20 6c69 7428  eadd("day", lit(
+0001f500: 3129 2c20 636f 6c28 2264 6174 655f 636f  1), col("date_co
+0001f510: 6c22 2929 2e61 6c69 6173 2822 6461 795f  l")).alias("day_
+0001f520: 6164 6465 6422 2929 2e73 686f 7728 290a  added")).show().
+0001f530: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f540: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001f550: 7c22 4441 595f 4144 4445 4422 2020 7c0a  |"DAY_ADDED"  |.
+0001f560: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f570: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001f580: 7c32 3032 302d 3031 2d30 3220 2020 7c0a  |2020-01-02   |.
+0001f590: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f5a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001f5b0: 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20 2020  <BLANKLINE>..   
+0001f5c0: 2041 7267 733a 0a20 2020 2020 2020 2070   Args:.        p
+0001f5d0: 6172 743a 2054 6865 2074 696d 6520 7061  art: The time pa
+0001f5e0: 7274 2074 6f20 7573 6520 666f 7220 7468  rt to use for th
+0001f5f0: 6520 6164 6469 7469 6f6e 0a20 2020 2020  e addition.     
+0001f600: 2020 2063 6f6c 313a 2054 6865 2066 6972     col1: The fir
+0001f610: 7374 2074 696d 6573 7461 6d70 2063 6f6c  st timestamp col
+0001f620: 756d 6e20 6f72 2061 6464 656e 6420 696e  umn or addend in
+0001f630: 2074 6865 2064 6174 6561 6464 0a20 2020   the dateadd.   
+0001f640: 2020 2020 2063 6f6c 323a 2054 6865 2073       col2: The s
+0001f650: 6563 6f6e 6420 7469 6d65 7374 616d 7020  econd timestamp 
+0001f660: 636f 6c75 6d6e 206f 7220 7468 6520 6164  column or the ad
+0001f670: 6465 6e64 2069 6e20 7468 6520 6461 7465  dend in the date
+0001f680: 6164 640a 2020 2020 2222 220a 2020 2020  add.    """.    
+0001f690: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0001f6a0: 6528 7061 7274 2c20 7374 7229 3a0a 2020  e(part, str):.  
+0001f6b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001f6c0: 6545 7272 6f72 2822 7061 7274 206d 7573  eError("part mus
+0001f6d0: 7420 6265 2061 2073 7472 696e 6722 290a  t be a string").
+0001f6e0: 2020 2020 6331 203d 205f 746f 5f63 6f6c      c1 = _to_col
+0001f6f0: 5f69 665f 7374 7228 636f 6c31 2c20 2264  _if_str(col1, "d
+0001f700: 6174 6561 6464 2229 0a20 2020 2063 3220  ateadd").    c2 
+0001f710: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001f720: 2863 6f6c 322c 2022 6461 7465 6164 6422  (col2, "dateadd"
+0001f730: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0001f740: 6c74 696e 2822 6461 7465 6164 6422 2928  ltin("dateadd")(
+0001f750: 7061 7274 2c20 6331 2c20 6332 290a 0a0a  part, c1, c2)...
+0001f760: 6465 6620 6461 7465 5f70 6172 7428 7061  def date_part(pa
+0001f770: 7274 3a20 7374 722c 2065 3a20 436f 6c75  rt: str, e: Colu
+0001f780: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0001f790: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+0001f7a0: 2045 7874 7261 6374 7320 7468 6520 7370   Extracts the sp
+0001f7b0: 6563 6966 6965 6420 6461 7465 206f 7220  ecified date or 
+0001f7c0: 7469 6d65 2070 6172 7420 6672 6f6d 2061  time part from a
+0001f7d0: 2064 6174 652c 2074 696d 652c 206f 7220   date, time, or 
+0001f7e0: 7469 6d65 7374 616d 702e 2053 6565 0a20  timestamp. See. 
+0001f7f0: 2020 2060 4441 5445 5f50 4152 5420 3c68     `DATE_PART <h
+0001f800: 7474 7073 3a2f 2f64 6f63 732e 736e 6f77  ttps://docs.snow
+0001f810: 666c 616b 652e 636f 6d2f 656e 2f73 716c  flake.com/en/sql
+0001f820: 2d72 6566 6572 656e 6365 2f66 756e 6374  -reference/funct
+0001f830: 696f 6e73 2f64 6174 655f 7061 7274 2e68  ions/date_part.h
+0001f840: 746d 6c3e 605f 2066 6f72 2064 6574 6169  tml>`_ for detai
+0001f850: 6c73 2e0a 0a20 2020 2041 7267 733a 0a20  ls...    Args:. 
+0001f860: 2020 2020 2020 2070 6172 743a 2054 6865         part: The
+0001f870: 2074 696d 6520 7061 7274 2074 6f20 7573   time part to us
+0001f880: 6520 666f 7220 7468 6520 6164 6469 7469  e for the additi
+0001f890: 6f6e 2e0a 2020 2020 2020 2020 653a 2054  on..        e: T
+0001f8a0: 6865 2063 6f6c 756d 6e20 6578 7072 6573  he column expres
+0001f8b0: 7369 6f6e 206f 6620 6120 6461 7465 2c20  sion of a date, 
+0001f8c0: 7469 6d65 2c20 6f72 2074 696d 6573 7461  time, or timesta
+0001f8d0: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
+0001f8e0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+0001f8f0: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+0001f900: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0001f910: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0001f920: 6461 7461 6672 616d 6528 5b5b 6461 7465  dataframe([[date
+0001f930: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+0001f940: 3233 2c20 312c 2031 2c20 312c 2031 2c20  23, 1, 1, 1, 1, 
+0001f950: 3129 5d5d 2c20 7363 6865 6d61 3d5b 2274  1)]], schema=["t
+0001f960: 735f 636f 6c22 5d29 0a20 2020 2020 2020  s_col"]).       
+0001f970: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+0001f980: 6174 655f 7061 7274 2822 7965 6172 222c  ate_part("year",
+0001f990: 2063 6f6c 2822 7473 5f63 6f6c 2229 292e   col("ts_col")).
+0001f9a0: 616c 6961 7328 2279 6561 7222 292c 2064  alias("year"), d
+0001f9b0: 6174 655f 7061 7274 2822 6570 6f63 685f  ate_part("epoch_
+0001f9c0: 7365 636f 6e64 222c 2063 6f6c 2822 7473  second", col("ts
+0001f9d0: 5f63 6f6c 2229 292e 616c 6961 7328 2265  _col")).alias("e
+0001f9e0: 706f 6368 5f73 6563 6f6e 6422 2929 2e73  poch_second")).s
+0001f9f0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0001fa00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001fa10: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001fa20: 2020 7c22 5945 4152 2220 207c 2245 504f    |"YEAR"  |"EPO
+0001fa30: 4348 5f53 4543 4f4e 4422 2020 7c0a 2020  CH_SECOND"  |.  
+0001fa40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001fa50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001fa60: 2d0a 2020 2020 2020 2020 7c32 3032 3320  -.        |2023 
+0001fa70: 2020 207c 3136 3732 3533 3438 3631 2020     |1672534861  
+0001fa80: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0001fa90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001faa0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001fab0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+0001fac0: 2020 2222 220a 2020 2020 6966 206e 6f74    """.    if not
+0001fad0: 2069 7369 6e73 7461 6e63 6528 7061 7274   isinstance(part
+0001fae0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+0001faf0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001fb00: 2822 7061 7274 206d 7573 7420 6265 2061  ("part must be a
+0001fb10: 2073 7472 696e 6722 290a 2020 2020 6320   string").    c 
+0001fb20: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001fb30: 2865 2c20 2264 6174 655f 7061 7274 2229  (e, "date_part")
+0001fb40: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+0001fb50: 7469 6e28 2264 6174 655f 7061 7274 2229  tin("date_part")
+0001fb60: 2870 6172 742c 2063 290a 0a0a 6465 6620  (part, c)...def 
+0001fb70: 6461 7465 5f66 726f 6d5f 7061 7274 7328  date_from_parts(
+0001fb80: 0a20 2020 2079 3a20 556e 696f 6e5b 436f  .    y: Union[Co
+0001fb90: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+0001fba0: 2c0a 2020 2020 6d3a 2055 6e69 6f6e 5b43  ,.    m: Union[C
+0001fbb0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+0001fbc0: 5d2c 0a20 2020 2064 3a20 556e 696f 6e5b  ],.    d: Union[
+0001fbd0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+0001fbe0: 745d 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  t],.) -> Column:
+0001fbf0: 0a20 2020 2022 2222 0a20 2020 2043 7265  .    """.    Cre
+0001fc00: 6174 6573 2061 2064 6174 6520 6672 6f6d  ates a date from
+0001fc10: 2069 6e64 6976 6964 7561 6c20 6e75 6d65   individual nume
+0001fc20: 7269 6320 636f 6d70 6f6e 656e 7473 2074  ric components t
+0001fc30: 6861 7420 7265 7072 6573 656e 7420 7468  hat represent th
+0001fc40: 6520 7965 6172 2c20 6d6f 6e74 682c 2061  e year, month, a
+0001fc50: 6e64 2064 6179 206f 6620 7468 6520 6d6f  nd day of the mo
+0001fc60: 6e74 682e 0a0a 2020 2020 4578 616d 706c  nth...    Exampl
+0001fc70: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0001fc80: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0001fc90: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+0001fca0: 3230 3232 2c20 342c 2031 5d5d 2c20 7363  2022, 4, 1]], sc
+0001fcb0: 6865 6d61 3d5b 2279 6561 7222 2c20 226d  hema=["year", "m
+0001fcc0: 6f6e 7468 222c 2022 6461 7922 5d29 0a20  onth", "day"]). 
+0001fcd0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0001fce0: 6c65 6374 2864 6174 655f 6672 6f6d 5f70  lect(date_from_p
+0001fcf0: 6172 7473 2822 7965 6172 222c 2022 6d6f  arts("year", "mo
+0001fd00: 6e74 6822 2c20 2264 6179 2229 292e 636f  nth", "day")).co
+0001fd10: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0001fd20: 5b52 6f77 2844 4154 455f 4652 4f4d 5f50  [Row(DATE_FROM_P
+0001fd30: 4152 5453 2822 5945 4152 222c 2022 4d4f  ARTS("YEAR", "MO
+0001fd40: 4e54 4822 2c20 2244 4159 2229 3d64 6174  NTH", "DAY")=dat
+0001fd50: 6574 696d 652e 6461 7465 2832 3032 322c  etime.date(2022,
+0001fd60: 2034 2c20 3129 295d 0a20 2020 2020 2020   4, 1))].       
+0001fd70: 203e 3e3e 2073 6573 7369 6f6e 2e74 6162   >>> session.tab
+0001fd80: 6c65 2822 6475 616c 2229 2e73 656c 6563  le("dual").selec
+0001fd90: 7428 6461 7465 5f66 726f 6d5f 7061 7274  t(date_from_part
+0001fda0: 7328 3230 3232 2c20 342c 2031 2929 2e63  s(2022, 4, 1)).c
+0001fdb0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0001fdc0: 205b 526f 7728 4441 5445 5f46 524f 4d5f   [Row(DATE_FROM_
+0001fdd0: 5041 5254 5328 3230 3232 2c20 342c 2031  PARTS(2022, 4, 1
+0001fde0: 293d 6461 7465 7469 6d65 2e64 6174 6528  )=datetime.date(
+0001fdf0: 3230 3232 2c20 342c 2031 2929 5d0a 2020  2022, 4, 1))].  
+0001fe00: 2020 2222 220a 2020 2020 795f 636f 6c20    """.    y_col 
+0001fe10: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001fe20: 5f6f 725f 696e 7428 792c 2022 6461 7465  _or_int(y, "date
+0001fe30: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
+0001fe40: 2020 6d5f 636f 6c20 3d20 5f74 6f5f 636f    m_col = _to_co
+0001fe50: 6c5f 6966 5f73 7472 5f6f 725f 696e 7428  l_if_str_or_int(
+0001fe60: 6d2c 2022 6461 7465 5f66 726f 6d5f 7061  m, "date_from_pa
+0001fe70: 7274 7322 290a 2020 2020 645f 636f 6c20  rts").    d_col 
+0001fe80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0001fe90: 5f6f 725f 696e 7428 642c 2022 6461 7465  _or_int(d, "date
+0001fea0: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
+0001feb0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0001fec0: 2822 6461 7465 5f66 726f 6d5f 7061 7274  ("date_from_part
+0001fed0: 7322 2928 795f 636f 6c2c 206d 5f63 6f6c  s")(y_col, m_col
+0001fee0: 2c20 645f 636f 6c29 0a0a 0a64 6566 2064  , d_col)...def d
+0001fef0: 6174 655f 7472 756e 6328 7061 7274 3a20  ate_trunc(part: 
+0001ff00: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 6578  ColumnOrName, ex
+0001ff10: 7072 3a20 436f 6c75 6d6e 4f72 4e61 6d65  pr: ColumnOrName
+0001ff20: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0001ff30: 2022 2222 0a20 2020 2054 7275 6e63 6174   """.    Truncat
+0001ff40: 6573 2061 2044 4154 452c 2054 494d 452c  es a DATE, TIME,
+0001ff50: 206f 7220 5449 4d45 5354 414d 5020 746f   or TIMESTAMP to
+0001ff60: 2074 6865 2073 7065 6369 6669 6564 2070   the specified p
+0001ff70: 7265 6369 7369 6f6e 2e0a 0a20 2020 204e  recision...    N
+0001ff80: 6f74 6520 7468 6174 2074 7275 6e63 6174  ote that truncat
+0001ff90: 696f 6e20 6973 206e 6f74 2074 6865 2073  ion is not the s
+0001ffa0: 616d 6520 6173 2065 7874 7261 6374 696f  ame as extractio
+0001ffb0: 6e2e 2046 6f72 2065 7861 6d70 6c65 3a0a  n. For example:.
+0001ffc0: 2020 2020 2d20 5472 756e 6361 7469 6e67      - Truncating
+0001ffd0: 2061 2074 696d 6573 7461 6d70 2064 6f77   a timestamp dow
+0001ffe0: 6e20 746f 2074 6865 2071 7561 7274 6572  n to the quarter
+0001fff0: 2072 6574 7572 6e73 2074 6865 2074 696d   returns the tim
+00020000: 6573 7461 6d70 2063 6f72 7265 7370 6f6e  estamp correspon
+00020010: 6469 6e67 2074 6f20 6d69 646e 6967 6874  ding to midnight
+00020020: 206f 6620 7468 6520 6669 7273 7420 6461   of the first da
+00020030: 7920 6f66 2074 6865 0a20 2020 2071 7561  y of the.    qua
+00020040: 7274 6572 2066 6f72 2074 6865 2069 6e70  rter for the inp
+00020050: 7574 2074 696d 6573 7461 6d70 2e0a 2020  ut timestamp..  
+00020060: 2020 2d20 4578 7472 6163 7469 6e67 2074    - Extracting t
+00020070: 6865 2071 7561 7274 6572 2064 6174 6520  he quarter date 
+00020080: 7061 7274 2066 726f 6d20 6120 7469 6d65  part from a time
+00020090: 7374 616d 7020 7265 7475 726e 7320 7468  stamp returns th
+000200a0: 6520 7175 6172 7465 7220 6e75 6d62 6572  e quarter number
+000200b0: 206f 6620 7468 6520 7965 6172 2069 6e20   of the year in 
+000200c0: 7468 6520 7469 6d65 7374 616d 702e 0a0a  the timestamp...
+000200d0: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
+000200e0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+000200f0: 2064 6174 6574 696d 650a 2020 2020 2020   datetime.      
+00020100: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00020110: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00020120: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+00020130: 2020 2020 205b 5b64 6174 6574 696d 652e       [[datetime.
+00020140: 6461 7465 7469 6d65 2e73 7472 7074 696d  datetime.strptim
+00020150: 6528 2232 3032 302d 3035 2d30 3120 3133  e("2020-05-01 13
+00020160: 3a31 313a 3230 2e30 3030 222c 2022 2559  :11:20.000", "%Y
+00020170: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
+00020180: 2566 2229 5d5d 2c0a 2020 2020 2020 2020  %f")]],.        
+00020190: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+000201a0: 2261 225d 2c0a 2020 2020 2020 2020 2e2e  "a"],.        ..
+000201b0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+000201c0: 6466 2e73 656c 6563 7428 6461 7465 5f74  df.select(date_t
+000201d0: 7275 6e63 2822 5945 4152 222c 2022 6122  runc("YEAR", "a"
+000201e0: 292c 2064 6174 655f 7472 756e 6328 224d  ), date_trunc("M
+000201f0: 4f4e 5448 222c 2022 6122 292c 2064 6174  ONTH", "a"), dat
+00020200: 655f 7472 756e 6328 2244 4159 222c 2022  e_trunc("DAY", "
+00020210: 6122 2929 2e63 6f6c 6c65 6374 2829 0a20  a")).collect(). 
+00020220: 2020 2020 2020 205b 526f 7728 4441 5445         [Row(DATE
+00020230: 5f54 5255 4e43 2822 5945 4152 222c 2022  _TRUNC("YEAR", "
+00020240: 4122 293d 6461 7465 7469 6d65 2e64 6174  A")=datetime.dat
+00020250: 6574 696d 6528 3230 3230 2c20 312c 2031  etime(2020, 1, 1
+00020260: 2c20 302c 2030 292c 2044 4154 455f 5452  , 0, 0), DATE_TR
+00020270: 554e 4328 224d 4f4e 5448 222c 2022 4122  UNC("MONTH", "A"
+00020280: 293d 6461 7465 7469 6d65 2e64 6174 6574  )=datetime.datet
+00020290: 696d 6528 3230 3230 2c20 352c 2031 2c20  ime(2020, 5, 1, 
+000202a0: 302c 2030 292c 2044 4154 455f 5452 554e  0, 0), DATE_TRUN
+000202b0: 4328 2244 4159 222c 2022 4122 293d 6461  C("DAY", "A")=da
+000202c0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+000202d0: 3230 3230 2c20 352c 2031 2c20 302c 2030  2020, 5, 1, 0, 0
+000202e0: 2929 5d0a 2020 2020 2020 2020 3e3e 3e20  ))].        >>> 
+000202f0: 6466 2e73 656c 6563 7428 6461 7465 5f74  df.select(date_t
+00020300: 7275 6e63 2822 484f 5552 222c 2022 6122  runc("HOUR", "a"
+00020310: 292c 2064 6174 655f 7472 756e 6328 224d  ), date_trunc("M
+00020320: 494e 5554 4522 2c20 2261 2229 2c20 6461  INUTE", "a"), da
+00020330: 7465 5f74 7275 6e63 2822 5345 434f 4e44  te_trunc("SECOND
+00020340: 222c 2022 6122 2929 2e63 6f6c 6c65 6374  ", "a")).collect
+00020350: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00020360: 4441 5445 5f54 5255 4e43 2822 484f 5552  DATE_TRUNC("HOUR
+00020370: 222c 2022 4122 293d 6461 7465 7469 6d65  ", "A")=datetime
+00020380: 2e64 6174 6574 696d 6528 3230 3230 2c20  .datetime(2020, 
+00020390: 352c 2031 2c20 3133 2c20 3029 2c20 4441  5, 1, 13, 0), DA
+000203a0: 5445 5f54 5255 4e43 2822 4d49 4e55 5445  TE_TRUNC("MINUTE
+000203b0: 222c 2022 4122 293d 6461 7465 7469 6d65  ", "A")=datetime
+000203c0: 2e64 6174 6574 696d 6528 3230 3230 2c20  .datetime(2020, 
+000203d0: 352c 2031 2c20 3133 2c20 3131 292c 2044  5, 1, 13, 11), D
+000203e0: 4154 455f 5452 554e 4328 2253 4543 4f4e  ATE_TRUNC("SECON
+000203f0: 4422 2c20 2241 2229 3d64 6174 6574 696d  D", "A")=datetim
+00020400: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
+00020410: 2035 2c20 312c 2031 332c 2031 312c 2032   5, 1, 13, 11, 2
+00020420: 3029 295d 0a20 2020 2020 2020 203e 3e3e  0))].        >>>
+00020430: 2064 662e 7365 6c65 6374 2864 6174 655f   df.select(date_
+00020440: 7472 756e 6328 2251 5541 5254 4552 222c  trunc("QUARTER",
+00020450: 2022 6122 2929 2e63 6f6c 6c65 6374 2829   "a")).collect()
+00020460: 0a20 2020 2020 2020 205b 526f 7728 4441  .        [Row(DA
+00020470: 5445 5f54 5255 4e43 2822 5155 4152 5445  TE_TRUNC("QUARTE
+00020480: 5222 2c20 2241 2229 3d64 6174 6574 696d  R", "A")=datetim
+00020490: 652e 6461 7465 7469 6d65 2832 3032 302c  e.datetime(2020,
+000204a0: 2034 2c20 312c 2030 2c20 3029 295d 0a20   4, 1, 0, 0))]. 
+000204b0: 2020 2022 2222 0a20 2020 2070 6172 745f     """.    part_
+000204c0: 636f 6c20 3d20 5f74 6f5f 636f 6c5f 6966  col = _to_col_if
+000204d0: 5f73 7472 2870 6172 742c 2022 6461 7465  _str(part, "date
+000204e0: 5f74 7275 6e63 2229 0a20 2020 2065 7870  _trunc").    exp
+000204f0: 725f 636f 6c20 3d20 5f74 6f5f 636f 6c5f  r_col = _to_col_
+00020500: 6966 5f73 7472 2865 7870 722c 2022 6461  if_str(expr, "da
+00020510: 7465 5f74 7275 6e63 2229 0a20 2020 2072  te_trunc").    r
+00020520: 6574 7572 6e20 6275 696c 7469 6e28 2264  eturn builtin("d
+00020530: 6174 655f 7472 756e 6322 2928 7061 7274  ate_trunc")(part
+00020540: 5f63 6f6c 2c20 6578 7072 5f63 6f6c 290a  _col, expr_col).
+00020550: 0a0a 6465 6620 6461 796e 616d 6528 653a  ..def dayname(e:
+00020560: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00020570: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00020580: 220a 2020 2020 4578 7472 6163 7473 2074  ".    Extracts t
+00020590: 6865 2074 6872 6565 2d6c 6574 7465 7220  he three-letter 
+000205a0: 6461 792d 6f66 2d77 6565 6b20 6e61 6d65  day-of-week name
+000205b0: 2066 726f 6d20 7468 6520 7370 6563 6966   from the specif
+000205c0: 6965 6420 6461 7465 206f 7220 7469 6d65  ied date or time
+000205d0: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
+000205e0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+000205f0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+00020600: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00020610: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00020620: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+00020630: 2020 2020 202e 2e2e 2020 2020 205b 5b64       ...     [[d
+00020640: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+00020650: 2e73 7472 7074 696d 6528 2232 3032 302d  .strptime("2020-
+00020660: 3035 2d30 3120 3133 3a31 313a 3230 2e30  05-01 13:11:20.0
+00020670: 3030 222c 2022 2559 2d25 6d2d 2564 2025  00", "%Y-%m-%d %
+00020680: 483a 254d 3a25 532e 2566 2229 5d5d 2c0a  H:%M:%S.%f")]],.
+00020690: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+000206a0: 7363 6865 6d61 3d5b 2261 225d 2c0a 2020  schema=["a"],.  
+000206b0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
+000206c0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000206d0: 7428 6461 796e 616d 6528 2261 2229 292e  t(dayname("a")).
+000206e0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+000206f0: 2020 5b52 6f77 2844 4159 4e41 4d45 2822    [Row(DAYNAME("
+00020700: 4122 293d 2746 7269 2729 5d0a 2020 2020  A")='Fri')].    
+00020710: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00020720: 636f 6c5f 6966 5f73 7472 2865 2c20 2264  col_if_str(e, "d
+00020730: 6179 6e61 6d65 2229 0a20 2020 2072 6574  ayname").    ret
+00020740: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
+00020750: 6e61 6d65 2229 2863 290a 0a0a 6465 6620  name")(c)...def 
+00020760: 6461 796f 666d 6f6e 7468 2865 3a20 436f  dayofmonth(e: Co
+00020770: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00020780: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00020790: 2020 2045 7874 7261 6374 7320 7468 6520     Extracts the 
+000207a0: 636f 7272 6573 706f 6e64 696e 6720 6461  corresponding da
+000207b0: 7920 286e 756d 6265 7229 206f 6620 7468  y (number) of th
+000207c0: 6520 6d6f 6e74 6820 6672 6f6d 2061 2064  e month from a d
+000207d0: 6174 6520 6f72 2074 696d 6573 7461 6d70  ate or timestamp
+000207e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000207f0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00020800: 6f72 7420 6461 7465 7469 6d65 0a20 2020  ort datetime.   
+00020810: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00020820: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00020830: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00020840: 2e2e 2e20 2020 2020 5b5b 6461 7465 7469  ...     [[dateti
+00020850: 6d65 2e64 6174 6574 696d 652e 7374 7270  me.datetime.strp
+00020860: 7469 6d65 2822 3230 3230 2d30 352d 3031  time("2020-05-01
+00020870: 2031 333a 3131 3a32 302e 3030 3022 2c20   13:11:20.000", 
+00020880: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
+00020890: 2553 2e25 6622 295d 5d2c 0a20 2020 2020  %S.%f")]],.     
+000208a0: 2020 202e 2e2e 2020 2020 2073 6368 656d     ...     schem
+000208b0: 613d 5b22 6122 5d2c 0a20 2020 2020 2020  a=["a"],.       
+000208c0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
+000208d0: 3e3e 2064 662e 7365 6c65 6374 2864 6179  >> df.select(day
+000208e0: 6f66 6d6f 6e74 6828 2261 2229 292e 636f  ofmonth("a")).co
+000208f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00020900: 5b52 6f77 2844 4159 4f46 4d4f 4e54 4828  [Row(DAYOFMONTH(
+00020910: 2241 2229 3d31 295d 0a20 2020 2022 2222  "A")=1)].    """
+00020920: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00020930: 5f69 665f 7374 7228 652c 2022 6461 796f  _if_str(e, "dayo
+00020940: 666d 6f6e 7468 2229 0a20 2020 2072 6574  fmonth").    ret
+00020950: 7572 6e20 6275 696c 7469 6e28 2264 6179  urn builtin("day
+00020960: 6f66 6d6f 6e74 6822 2928 6329 0a0a 0a64  ofmonth")(c)...d
+00020970: 6566 2064 6179 6f66 7765 656b 2865 3a20  ef dayofweek(e: 
+00020980: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00020990: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000209a0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
+000209b0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+000209c0: 6461 7920 286e 756d 6265 7229 206f 6620  day (number) of 
+000209d0: 7468 6520 7765 656b 2066 726f 6d20 6120  the week from a 
+000209e0: 6461 7465 206f 7220 7469 6d65 7374 616d  date or timestam
+000209f0: 702e 0a0a 2020 2020 4578 616d 706c 653a  p...    Example:
+00020a00: 3a0a 2020 2020 2020 2020 3e3e 3e20 696d  :.        >>> im
+00020a10: 706f 7274 2064 6174 6574 696d 650a 2020  port datetime.  
+00020a20: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00020a30: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00020a40: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
+00020a50: 202e 2e2e 2020 2020 205b 5b64 6174 6574   ...     [[datet
+00020a60: 696d 652e 6461 7465 7469 6d65 2e73 7472  ime.datetime.str
+00020a70: 7074 696d 6528 2232 3032 302d 3035 2d30  ptime("2020-05-0
+00020a80: 3120 3133 3a31 313a 3230 2e30 3030 222c  1 13:11:20.000",
+00020a90: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
+00020aa0: 3a25 532e 2566 2229 5d5d 2c0a 2020 2020  :%S.%f")]],.    
+00020ab0: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+00020ac0: 6d61 3d5b 2261 225d 2c0a 2020 2020 2020  ma=["a"],.      
+00020ad0: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+00020ae0: 3e3e 3e20 6466 2e73 656c 6563 7428 6461  >>> df.select(da
+00020af0: 796f 6677 6565 6b28 2261 2229 292e 636f  yofweek("a")).co
+00020b00: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00020b10: 5b52 6f77 2844 4159 4f46 5745 454b 2822  [Row(DAYOFWEEK("
+00020b20: 4122 293d 3529 5d0a 2020 2020 2222 220a  A")=5)].    """.
+00020b30: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00020b40: 6966 5f73 7472 2865 2c20 2264 6179 6f66  if_str(e, "dayof
+00020b50: 7765 656b 2229 0a20 2020 2072 6574 7572  week").    retur
+00020b60: 6e20 6275 696c 7469 6e28 2264 6179 6f66  n builtin("dayof
+00020b70: 7765 656b 2229 2863 290a 0a0a 6465 6620  week")(c)...def 
+00020b80: 6461 796f 6679 6561 7228 653a 2043 6f6c  dayofyear(e: Col
+00020b90: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00020ba0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00020bb0: 2020 4578 7472 6163 7473 2074 6865 2063    Extracts the c
+00020bc0: 6f72 7265 7370 6f6e 6469 6e67 2064 6179  orresponding day
+00020bd0: 2028 6e75 6d62 6572 2920 6f66 2074 6865   (number) of the
+00020be0: 2079 6561 7220 6672 6f6d 2061 2064 6174   year from a dat
+00020bf0: 6520 6f72 2074 696d 6573 7461 6d70 2e0a  e or timestamp..
+00020c00: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+00020c10: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+00020c20: 7420 6461 7465 7469 6d65 0a20 2020 2020  t datetime.     
+00020c30: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00020c40: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00020c50: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00020c60: 2e20 2020 2020 5b5b 6461 7465 7469 6d65  .     [[datetime
+00020c70: 2e64 6174 6574 696d 652e 7374 7270 7469  .datetime.strpti
+00020c80: 6d65 2822 3230 3230 2d30 352d 3031 2031  me("2020-05-01 1
+00020c90: 333a 3131 3a32 302e 3030 3022 2c20 2225  3:11:20.000", "%
+00020ca0: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+00020cb0: 2e25 6622 295d 5d2c 0a20 2020 2020 2020  .%f")]],.       
+00020cc0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00020cd0: 5b22 6122 5d2c 0a20 2020 2020 2020 202e  ["a"],.        .
+00020ce0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+00020cf0: 2064 662e 7365 6c65 6374 2864 6179 6f66   df.select(dayof
+00020d00: 7965 6172 2822 6122 2929 2e63 6f6c 6c65  year("a")).colle
+00020d10: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00020d20: 7728 4441 594f 4659 4541 5228 2241 2229  w(DAYOFYEAR("A")
+00020d30: 3d31 3232 295d 0a20 2020 2022 2222 0a20  =122)].    """. 
+00020d40: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00020d50: 665f 7374 7228 652c 2022 6461 796f 6679  f_str(e, "dayofy
+00020d60: 6561 7222 290a 2020 2020 7265 7475 726e  ear").    return
+00020d70: 2062 7569 6c74 696e 2822 6461 796f 6679   builtin("dayofy
+00020d80: 6561 7222 2928 6329 0a0a 0a64 6566 2069  ear")(c)...def i
+00020d90: 735f 6172 7261 7928 636f 6c3a 2043 6f6c  s_array(col: Col
+00020da0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00020db0: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00020dc0: 2020 5265 7475 726e 7320 7472 7565 2069    Returns true i
+00020dd0: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
+00020de0: 5641 5249 414e 5420 636f 6c75 6d6e 2063  VARIANT column c
+00020df0: 6f6e 7461 696e 7320 616e 2041 5252 4159  ontains an ARRAY
+00020e00: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
+00020e10: 6d70 6c65 733a 3a0a 0a20 2020 2020 2020  mples::..       
+00020e20: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00020e30: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00020e40: 6d65 285b 5b5b 2265 6c65 6d65 6e74 225d  me([[["element"]
+00020e50: 2c20 5472 7565 5d5d 2c20 7363 6865 6d61  , True]], schema
+00020e60: 3d5b 2261 222c 2022 6222 5d29 0a20 2020  =["a", "b"]).   
+00020e70: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00020e80: 6374 2869 735f 6172 7261 7928 6466 5b22  ct(is_array(df["
+00020e90: 6122 5d29 2e61 6c69 6173 2822 6973 5f61  a"]).alias("is_a
+00020ea0: 7272 6179 5f61 2229 2c20 6973 5f61 7272  rray_a"), is_arr
+00020eb0: 6179 2864 665b 2262 225d 292e 616c 6961  ay(df["b"]).alia
+00020ec0: 7328 2269 735f 6172 7261 795f 6222 2929  s("is_array_b"))
+00020ed0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00020ee0: 2020 205b 526f 7728 4953 5f41 5252 4159     [Row(IS_ARRAY
+00020ef0: 5f41 3d54 7275 652c 2049 535f 4152 5241  _A=True, IS_ARRA
+00020f00: 595f 423d 4661 6c73 6529 5d0a 2020 2020  Y_B=False)].    
+00020f10: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00020f20: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
+00020f30: 2269 735f 6172 7261 7922 290a 2020 2020  "is_array").    
+00020f40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00020f50: 6973 5f61 7272 6179 2229 2863 290a 0a0a  is_array")(c)...
+00020f60: 6465 6620 6973 5f62 6f6f 6c65 616e 2863  def is_boolean(c
+00020f70: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+00020f80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00020f90: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00020fa0: 2074 7275 6520 6966 2074 6865 2073 7065   true if the spe
+00020fb0: 6369 6669 6564 2056 4152 4941 4e54 2063  cified VARIANT c
+00020fc0: 6f6c 756d 6e20 636f 6e74 6169 6e73 2061  olumn contains a
+00020fd0: 2062 6f6f 6c65 616e 2076 616c 7565 2e0a   boolean value..
+00020fe0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00020ff0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00021000: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00021010: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00021020: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
+00021030: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
+00021040: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00021050: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00021060: 7261 6d65 285b 5b54 7275 652c 2027 5827  rame([[True, 'X'
+00021070: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
+00021080: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
+00021090: 3e3e 2064 662e 7365 6c65 6374 2869 735f  >> df.select(is_
+000210a0: 626f 6f6c 6561 6e28 746f 5f76 6172 6961  boolean(to_varia
+000210b0: 6e74 2864 665b 2261 225d 2929 2e61 6c69  nt(df["a"])).ali
+000210c0: 6173 2822 626f 6f6c 6561 6e22 292c 2069  as("boolean"), i
+000210d0: 735f 626f 6f6c 6561 6e28 746f 5f76 6172  s_boolean(to_var
+000210e0: 6961 6e74 2864 665b 2262 225d 2929 2e61  iant(df["b"])).a
+000210f0: 6c69 6173 2822 7661 7263 6861 7222 2929  lias("varchar"))
+00021100: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00021110: 2020 205b 526f 7728 424f 4f4c 4541 4e3d     [Row(BOOLEAN=
+00021120: 5472 7565 2c20 5641 5243 4841 523d 4661  True, VARCHAR=Fa
+00021130: 6c73 6529 5d0a 2020 2020 2222 220a 2020  lse)].    """.  
+00021140: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00021150: 5f73 7472 2863 6f6c 2c20 2269 735f 626f  _str(col, "is_bo
+00021160: 6f6c 6561 6e22 290a 2020 2020 7265 7475  olean").    retu
+00021170: 726e 2062 7569 6c74 696e 2822 6973 5f62  rn builtin("is_b
+00021180: 6f6f 6c65 616e 2229 2863 290a 0a0a 6465  oolean")(c)...de
+00021190: 6620 6973 5f62 696e 6172 7928 636f 6c3a  f is_binary(col:
+000211a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+000211b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000211c0: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
+000211d0: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
+000211e0: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
+000211f0: 6d6e 2063 6f6e 7461 696e 7320 6120 6269  mn contains a bi
+00021200: 6e61 7279 2076 616c 7565 2e0a 0a20 2020  nary value...   
+00021210: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+00021220: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00021230: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00021240: 2e74 7970 6573 2069 6d70 6f72 7420 5374  .types import St
+00021250: 7275 6374 4669 656c 642c 2056 6172 6961  ructField, Varia
+00021260: 6e74 5479 7065 0a20 2020 2020 2020 203e  ntType.        >
+00021270: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00021280: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00021290: 285b 5b62 2273 6e6f 7722 2c20 2273 6e6f  ([[b"snow", "sno
+000212a0: 7722 5d5d 2c20 7363 6865 6d61 3d5b 2261  w"]], schema=["a
+000212b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+000212c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
+000212d0: 735f 6269 6e61 7279 2874 6f5f 7661 7269  s_binary(to_vari
+000212e0: 616e 7428 6466 5b22 6122 5d29 292e 616c  ant(df["a"])).al
+000212f0: 6961 7328 2262 696e 6172 7922 292c 2069  ias("binary"), i
+00021300: 735f 6269 6e61 7279 2874 6f5f 7661 7269  s_binary(to_vari
+00021310: 616e 7428 6466 5b22 6222 5d29 292e 616c  ant(df["b"])).al
+00021320: 6961 7328 2276 6172 6368 6172 2229 292e  ias("varchar")).
+00021330: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00021340: 2020 5b52 6f77 2842 494e 4152 593d 5472    [Row(BINARY=Tr
+00021350: 7565 2c20 5641 5243 4841 523d 4661 6c73  ue, VARCHAR=Fals
+00021360: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00021370: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00021380: 7472 2863 6f6c 2c20 2269 735f 6269 6e61  tr(col, "is_bina
+00021390: 7279 2229 0a20 2020 2072 6574 7572 6e20  ry").    return 
+000213a0: 6275 696c 7469 6e28 2269 735f 6269 6e61  builtin("is_bina
+000213b0: 7279 2229 2863 290a 0a0a 6465 6620 6973  ry")(c)...def is
+000213c0: 5f63 6861 7228 636f 6c3a 2043 6f6c 756d  _char(col: Colum
+000213d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+000213e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+000213f0: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00021400: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
+00021410: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
+00021420: 7461 696e 7320 6120 7374 7269 6e67 2e0a  tains a string..
+00021430: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00021440: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00021450: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00021460: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00021470: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
+00021480: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
+00021490: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000214a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000214b0: 7261 6d65 285b 5b22 6162 6322 2c20 3132  rame([["abc", 12
+000214c0: 335d 5d2c 2073 6368 656d 613d 5b22 6122  3]], schema=["a"
+000214d0: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
+000214e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6973  >>> df.select(is
+000214f0: 5f63 6861 7228 746f 5f76 6172 6961 6e74  _char(to_variant
+00021500: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
+00021510: 2822 7661 7263 6861 7222 292c 2069 735f  ("varchar"), is_
+00021520: 6368 6172 2874 6f5f 7661 7269 616e 7428  char(to_variant(
+00021530: 6466 5b22 6222 5d29 292e 616c 6961 7328  df["b"])).alias(
+00021540: 2269 6e74 2229 292e 636f 6c6c 6563 7428  "int")).collect(
+00021550: 290a 2020 2020 2020 2020 5b52 6f77 2856  ).        [Row(V
+00021560: 4152 4348 4152 3d54 7275 652c 2049 4e54  ARCHAR=True, INT
+00021570: 3d46 616c 7365 295d 0a20 2020 2022 2222  =False)].    """
+00021580: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00021590: 5f69 665f 7374 7228 636f 6c2c 2022 6973  _if_str(col, "is
+000215a0: 5f63 6861 7222 290a 2020 2020 7265 7475  _char").    retu
+000215b0: 726e 2062 7569 6c74 696e 2822 6973 5f63  rn builtin("is_c
+000215c0: 6861 7222 2928 6329 0a0a 0a69 735f 7661  har")(c)...is_va
+000215d0: 7263 6861 7220 3d20 6973 5f63 6861 720a  rchar = is_char.
+000215e0: 0a0a 6465 6620 6973 5f64 6174 6528 636f  ..def is_date(co
+000215f0: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
+00021600: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00021610: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
+00021620: 7472 7565 2069 6620 7468 6520 7370 6563  true if the spec
+00021630: 6966 6965 6420 5641 5249 414e 5420 636f  ified VARIANT co
+00021640: 6c75 6d6e 2063 6f6e 7461 696e 7320 6120  lumn contains a 
+00021650: 6461 7465 2076 616c 7565 2e0a 0a20 2020  date value...   
+00021660: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+00021670: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+00021680: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
+00021690: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+000216a0: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
+000216b0: 6573 2069 6d70 6f72 7420 5374 7275 6374  es import Struct
+000216c0: 4669 656c 642c 2056 6172 6961 6e74 5479  Field, VariantTy
+000216d0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
+000216e0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+000216f0: 7465 5f64 6174 6166 7261 6d65 285b 5b64  te_dataframe([[d
+00021700: 6174 6574 696d 652e 6461 7465 2832 3032  atetime.date(202
+00021710: 332c 2033 2c20 3229 2c20 3132 335d 5d2c  3, 3, 2), 123]],
+00021720: 2073 6368 656d 613d 5b22 6122 2c20 2262   schema=["a", "b
+00021730: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+00021740: 6466 2e73 656c 6563 7428 6973 5f64 6174  df.select(is_dat
+00021750: 6528 746f 5f76 6172 6961 6e74 2864 665b  e(to_variant(df[
+00021760: 2261 225d 2929 2e61 6c69 6173 2822 6461  "a"])).alias("da
+00021770: 7465 2229 2c20 6973 5f64 6174 6528 746f  te"), is_date(to
+00021780: 5f76 6172 6961 6e74 2864 665b 2262 225d  _variant(df["b"]
+00021790: 2929 2e61 6c69 6173 2822 696e 7422 2929  )).alias("int"))
+000217a0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000217b0: 2020 205b 526f 7728 4441 5445 3d54 7275     [Row(DATE=Tru
+000217c0: 652c 2049 4e54 3d46 616c 7365 295d 0a20  e, INT=False)]. 
+000217d0: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+000217e0: 746f 5f63 6f6c 5f69 665f 7374 7228 636f  to_col_if_str(co
+000217f0: 6c2c 2022 6973 5f64 6174 6522 290a 2020  l, "is_date").  
+00021800: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00021810: 2822 6973 5f64 6174 6522 2928 6329 0a0a  ("is_date")(c)..
+00021820: 0a69 735f 6461 7465 5f76 616c 7565 203d  .is_date_value =
+00021830: 2069 735f 6461 7465 0a0a 0a64 6566 2069   is_date...def i
+00021840: 735f 6465 6369 6d61 6c28 636f 6c3a 2043  s_decimal(col: C
+00021850: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00021860: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00021870: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
+00021880: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
+00021890: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
+000218a0: 2063 6f6e 7461 696e 7320 6120 6669 7865   contains a fixe
+000218b0: 642d 706f 696e 7420 6465 6369 6d61 6c20  d-point decimal 
+000218c0: 7661 6c75 6520 6f72 2069 6e74 6567 6572  value or integer
+000218d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
+000218e0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
+000218f0: 6d70 6f72 7420 6465 6369 6d61 6c0a 2020  mport decimal.  
+00021900: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+00021910: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00021920: 6b2e 7479 7065 7320 696d 706f 7274 2053  k.types import S
+00021930: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
+00021940: 616e 7454 7970 650a 2020 2020 2020 2020  antType.        
+00021950: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00021960: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00021970: 6528 5b5b 6465 6369 6d61 6c2e 4465 6369  e([[decimal.Deci
+00021980: 6d61 6c28 3129 2c20 2258 225d 5d2c 2073  mal(1), "X"]], s
+00021990: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
+000219a0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000219b0: 2e73 656c 6563 7428 6973 5f64 6563 696d  .select(is_decim
+000219c0: 616c 2874 6f5f 7661 7269 616e 7428 6466  al(to_variant(df
+000219d0: 5b22 6122 5d29 292e 616c 6961 7328 2264  ["a"])).alias("d
+000219e0: 6563 696d 616c 2229 2c20 6973 5f64 6563  ecimal"), is_dec
+000219f0: 696d 616c 2874 6f5f 7661 7269 616e 7428  imal(to_variant(
+00021a00: 6466 5b22 6222 5d29 292e 616c 6961 7328  df["b"])).alias(
+00021a10: 2276 6172 6368 6172 2229 292e 636f 6c6c  "varchar")).coll
+00021a20: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00021a30: 6f77 2844 4543 494d 414c 3d54 7275 652c  ow(DECIMAL=True,
+00021a40: 2056 4152 4348 4152 3d46 616c 7365 295d   VARCHAR=False)]
+00021a50: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00021a60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00021a70: 636f 6c2c 2022 6973 5f64 6563 696d 616c  col, "is_decimal
+00021a80: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00021a90: 696c 7469 6e28 2269 735f 6465 6369 6d61  iltin("is_decima
+00021aa0: 6c22 2928 6329 0a0a 0a64 6566 2069 735f  l")(c)...def is_
+00021ab0: 646f 7562 6c65 2863 6f6c 3a20 436f 6c75  double(col: Colu
+00021ac0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+00021ad0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00021ae0: 2052 6574 7572 6e73 2074 7275 6520 6966   Returns true if
+00021af0: 2074 6865 2073 7065 6369 6669 6564 2056   the specified V
+00021b00: 4152 4941 4e54 2063 6f6c 756d 6e20 636f  ARIANT column co
+00021b10: 6e74 6169 6e73 2061 2066 6c6f 6174 696e  ntains a floatin
+00021b20: 672d 706f 696e 7420 7661 6c75 652c 2066  g-point value, f
+00021b30: 6978 6564 2d70 6f69 6e74 2064 6563 696d  ixed-point decim
+00021b40: 616c 2c20 6f72 2069 6e74 6567 6572 2e0a  al, or integer..
+00021b50: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
+00021b60: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00021b70: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00021b80: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00021b90: 7420 5374 7275 6374 4669 656c 642c 2056  t StructField, V
+00021ba0: 6172 6961 6e74 5479 7065 0a20 2020 2020  ariantType.     
+00021bb0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00021bc0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00021bd0: 7261 6d65 285b 5b31 2e32 2c20 2258 225d  rame([[1.2, "X"]
+00021be0: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+00021bf0: 2262 225d 290a 2020 2020 2020 2020 3e3e  "b"]).        >>
+00021c00: 3e20 6466 2e73 656c 6563 7428 6973 5f64  > df.select(is_d
+00021c10: 6f75 626c 6528 746f 5f76 6172 6961 6e74  ouble(to_variant
+00021c20: 2864 665b 2261 225d 2929 2e61 6c69 6173  (df["a"])).alias
+00021c30: 2822 646f 7562 6c65 2229 2c20 6973 5f64  ("double"), is_d
+00021c40: 6f75 626c 6528 746f 5f76 6172 6961 6e74  ouble(to_variant
+00021c50: 2864 665b 2262 225d 2929 2e61 6c69 6173  (df["b"])).alias
+00021c60: 2822 7661 7263 6861 7222 2929 2e63 6f6c  ("varchar")).col
+00021c70: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00021c80: 526f 7728 444f 5542 4c45 3d54 7275 652c  Row(DOUBLE=True,
+00021c90: 2056 4152 4348 4152 3d46 616c 7365 295d   VARCHAR=False)]
+00021ca0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00021cb0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00021cc0: 636f 6c2c 2022 6973 5f64 6f75 626c 6522  col, "is_double"
+00021cd0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+00021ce0: 6c74 696e 2822 6973 5f64 6f75 626c 6522  ltin("is_double"
+00021cf0: 2928 6329 0a0a 0a64 6566 2069 735f 7265  )(c)...def is_re
+00021d00: 616c 2863 6f6c 3a20 436f 6c75 6d6e 4f72  al(col: ColumnOr
+00021d10: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+00021d20: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+00021d30: 7572 6e73 2074 7275 6520 6966 2074 6865  urns true if the
+00021d40: 2073 7065 6369 6669 6564 2056 4152 4941   specified VARIA
+00021d50: 4e54 2063 6f6c 756d 6e20 636f 6e74 6169  NT column contai
+00021d60: 6e73 2061 2066 6c6f 6174 696e 672d 706f  ns a floating-po
+00021d70: 696e 7420 7661 6c75 652c 2066 6978 6564  int value, fixed
+00021d80: 2d70 6f69 6e74 2064 6563 696d 616c 2c20  -point decimal, 
+00021d90: 6f72 2069 6e74 6567 6572 2e0a 0a20 2020  or integer...   
+00021da0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00021db0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00021dc0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00021dd0: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00021de0: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
+00021df0: 7265 616c 0a20 2020 2020 2020 203e 3e3e  real.        >>>
+00021e00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00021e10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00021e20: 5b31 2e32 2c20 2258 225d 5d2c 2073 6368  [1.2, "X"]], sch
+00021e30: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+00021e40: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00021e50: 656c 6563 7428 6973 5f72 6561 6c28 746f  elect(is_real(to
+00021e60: 5f76 6172 6961 6e74 2822 6122 2929 2e61  _variant("a")).a
+00021e70: 735f 2822 6122 292c 2069 735f 7265 616c  s_("a"), is_real
+00021e80: 2874 6f5f 7661 7269 616e 7428 2262 2229  (to_variant("b")
+00021e90: 292e 6173 5f28 2262 2229 292e 636f 6c6c  ).as_("b")).coll
+00021ea0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00021eb0: 6f77 2841 3d54 7275 652c 2042 3d46 616c  ow(A=True, B=Fal
+00021ec0: 7365 295d 0a20 2020 2022 2222 0a20 2020  se)].    """.   
+00021ed0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00021ee0: 7374 7228 636f 6c2c 2022 6973 5f72 6561  str(col, "is_rea
+00021ef0: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
+00021f00: 7569 6c74 696e 2822 6973 5f72 6561 6c22  uiltin("is_real"
+00021f10: 2928 6329 0a0a 0a64 6566 2069 735f 696e  )(c)...def is_in
+00021f20: 7465 6765 7228 636f 6c3a 2043 6f6c 756d  teger(col: Colum
+00021f30: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+00021f40: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00021f50: 5265 7475 726e 7320 7472 7565 2069 6620  Returns true if 
+00021f60: 7468 6520 7370 6563 6966 6965 6420 5641  the specified VA
+00021f70: 5249 414e 5420 636f 6c75 6d6e 2063 6f6e  RIANT column con
+00021f80: 7461 696e 7320 6120 696e 7465 6765 7220  tains a integer 
+00021f90: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
+00021fa0: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
+00021fb0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00021fc0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00021fd0: 7320 696d 706f 7274 2053 7472 7563 7446  s import StructF
+00021fe0: 6965 6c64 2c20 5661 7269 616e 7454 7970  ield, VariantTyp
+00021ff0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00022000: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00022010: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
+00022020: 2022 5822 5d5d 2c20 7363 6865 6d61 3d5b   "X"]], schema=[
+00022030: 2261 222c 2022 6222 5d29 0a20 2020 2020  "a", "b"]).     
+00022040: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00022050: 2869 735f 696e 7465 6765 7228 746f 5f76  (is_integer(to_v
+00022060: 6172 6961 6e74 2864 665b 2261 225d 2929  ariant(df["a"]))
+00022070: 2e61 6c69 6173 2822 696e 7422 292c 2069  .alias("int"), i
+00022080: 735f 696e 7465 6765 7228 746f 5f76 6172  s_integer(to_var
+00022090: 6961 6e74 2864 665b 2262 225d 2929 2e61  iant(df["b"])).a
+000220a0: 6c69 6173 2822 7661 7263 6861 7222 2929  lias("varchar"))
+000220b0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000220c0: 2020 205b 526f 7728 494e 543d 5472 7565     [Row(INT=True
+000220d0: 2c20 5641 5243 4841 523d 4661 6c73 6529  , VARCHAR=False)
+000220e0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+000220f0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00022100: 2863 6f6c 2c20 2269 735f 696e 7465 6765  (col, "is_intege
+00022110: 7222 290a 2020 2020 7265 7475 726e 2062  r").    return b
+00022120: 7569 6c74 696e 2822 6973 5f69 6e74 6567  uiltin("is_integ
+00022130: 6572 2229 2863 290a 0a0a 6465 6620 6973  er")(c)...def is
+00022140: 5f6e 756c 6c5f 7661 6c75 6528 636f 6c3a  _null_value(col:
+00022150: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00022160: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00022170: 220a 2020 2020 5265 7475 726e 7320 7472  ".    Returns tr
+00022180: 7565 2069 6620 7468 6520 7370 6563 6966  ue if the specif
+00022190: 6965 6420 5641 5249 414e 5420 636f 6c75  ied VARIANT colu
+000221a0: 6d6e 2063 6f6e 7461 696e 7320 6120 4a53  mn contains a JS
+000221b0: 4f4e 206e 756c 6c20 7661 6c75 652e 0a0a  ON null value...
+000221c0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+000221d0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+000221e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000221f0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+00022200: 6f72 7420 746f 5f76 6172 6961 6e74 2c20  ort to_variant, 
+00022210: 6973 5f6e 756c 6c5f 7661 6c75 650a 2020  is_null_value.  
+00022220: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+00022230: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00022240: 7461 6672 616d 6528 5b5b 7b22 6122 3a20  taframe([[{"a": 
+00022250: 2266 6f6f 227d 5d2c 205b 7b22 6122 3a20  "foo"}], [{"a": 
+00022260: 4e6f 6e65 7d5d 2c20 5b4e 6f6e 655d 5d2c  None}], [None]],
+00022270: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+00022280: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00022290: 6c65 6374 2869 735f 6e75 6c6c 5f76 616c  lect(is_null_val
+000222a0: 7565 2874 6f5f 7661 7269 616e 7428 2261  ue(to_variant("a
+000222b0: 2229 5b22 6122 5d29 2e61 735f 2822 6122  ")["a"]).as_("a"
+000222c0: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+000222d0: 2020 2020 205b 526f 7728 413d 4661 6c73       [Row(A=Fals
+000222e0: 6529 2c20 526f 7728 413d 5472 7565 292c  e), Row(A=True),
+000222f0: 2052 6f77 2841 3d4e 6f6e 6529 5d0a 2020   Row(A=None)].  
+00022300: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00022310: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00022320: 2c20 2269 735f 6e75 6c6c 5f76 616c 7565  , "is_null_value
+00022330: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00022340: 696c 7469 6e28 2269 735f 6e75 6c6c 5f76  iltin("is_null_v
+00022350: 616c 7565 2229 2863 290a 0a0a 6465 6620  alue")(c)...def 
+00022360: 6973 5f6f 626a 6563 7428 636f 6c3a 2043  is_object(col: C
+00022370: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00022380: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
+00022390: 2020 2020 5265 7475 726e 7320 7472 7565      Returns true
+000223a0: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
+000223b0: 6420 5641 5249 414e 5420 636f 6c75 6d6e  d VARIANT column
+000223c0: 2063 6f6e 7461 696e 7320 616e 204f 424a   contains an OBJ
+000223d0: 4543 5420 7661 6c75 652e 0a0a 2020 2020  ECT value...    
+000223e0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000223f0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00022400: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+00022410: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+00022420: 746f 5f76 6172 6961 6e74 2c20 6973 5f6f  to_variant, is_o
+00022430: 626a 6563 740a 2020 2020 2020 2020 3e3e  bject.        >>
+00022440: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00022450: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00022460: 5b5b 5b31 2c20 325d 2c20 7b22 6122 3a20  [[[1, 2], {"a": 
+00022470: 2273 6e6f 7722 7d5d 5d2c 2073 6368 656d  "snow"}]], schem
+00022480: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+00022490: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000224a0: 6563 7428 6973 5f6f 626a 6563 7428 746f  ect(is_object(to
+000224b0: 5f76 6172 6961 6e74 2822 6122 2929 2e61  _variant("a")).a
+000224c0: 735f 2822 6122 292c 2069 735f 6f62 6a65  s_("a"), is_obje
+000224d0: 6374 2874 6f5f 7661 7269 616e 7428 2262  ct(to_variant("b
+000224e0: 2229 292e 6173 5f28 2262 2229 292e 636f  ")).as_("b")).co
+000224f0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00022500: 5b52 6f77 2841 3d46 616c 7365 2c20 423d  [Row(A=False, B=
+00022510: 5472 7565 295d 0a20 2020 2022 2222 0a20  True)].    """. 
+00022520: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00022530: 665f 7374 7228 636f 6c2c 2022 6973 5f6f  f_str(col, "is_o
+00022540: 626a 6563 7422 290a 2020 2020 7265 7475  bject").    retu
+00022550: 726e 2062 7569 6c74 696e 2822 6973 5f6f  rn builtin("is_o
+00022560: 626a 6563 7422 2928 6329 0a0a 0a64 6566  bject")(c)...def
+00022570: 2069 735f 7469 6d65 2863 6f6c 3a20 436f   is_time(col: Co
+00022580: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00022590: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000225a0: 2020 2052 6574 7572 6e73 2074 7275 6520     Returns true 
+000225b0: 6966 2074 6865 2073 7065 6369 6669 6564  if the specified
+000225c0: 2056 4152 4941 4e54 2063 6f6c 756d 6e20   VARIANT column 
+000225d0: 636f 6e74 6169 6e73 2061 2054 494d 4520  contains a TIME 
+000225e0: 7661 6c75 652e 0a0a 2020 2020 4578 616d  value...    Exam
+000225f0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00022600: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
+00022610: 6d65 0a20 2020 2020 2020 203e 3e3e 2066  me.        >>> f
+00022620: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00022630: 6f77 7061 726b 2e66 756e 6374 696f 6e73  owpark.functions
+00022640: 2069 6d70 6f72 7420 746f 5f76 6172 6961   import to_varia
+00022650: 6e74 2c20 6973 5f74 696d 650a 2020 2020  nt, is_time.    
+00022660: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00022670: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00022680: 6672 616d 6528 5b5b 6461 7465 7469 6d65  frame([[datetime
+00022690: 2e74 696d 6528 3130 2c20 3130 292c 2022  .time(10, 10), "
+000226a0: 5822 5d5d 2c20 7363 6865 6d61 3d5b 2261  X"]], schema=["a
+000226b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+000226c0: 203e 3e3e 2064 662e 7365 6c65 6374 2869   >>> df.select(i
+000226d0: 735f 7469 6d65 2874 6f5f 7661 7269 616e  s_time(to_varian
+000226e0: 7428 2261 2229 292e 6173 5f28 2261 2229  t("a")).as_("a")
+000226f0: 2c20 6973 5f74 696d 6528 746f 5f76 6172  , is_time(to_var
+00022700: 6961 6e74 2822 6222 2929 2e61 735f 2822  iant("b")).as_("
+00022710: 6222 2929 2e63 6f6c 6c65 6374 2829 0a20  b")).collect(). 
+00022720: 2020 2020 2020 205b 526f 7728 413d 5472         [Row(A=Tr
+00022730: 7565 2c20 423d 4661 6c73 6529 5d0a 2020  ue, B=False)].  
+00022740: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+00022750: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+00022760: 2c20 2269 735f 7469 6d65 2229 0a20 2020  , "is_time").   
+00022770: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00022780: 2269 735f 7469 6d65 2229 2863 290a 0a0a  "is_time")(c)...
+00022790: 6465 6620 6973 5f74 696d 6573 7461 6d70  def is_timestamp
+000227a0: 5f6c 747a 2863 6f6c 3a20 436f 6c75 6d6e  _ltz(col: Column
+000227b0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+000227c0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+000227d0: 6574 7572 6e73 2074 7275 6520 6966 2074  eturns true if t
+000227e0: 6865 2073 7065 6369 6669 6564 2056 4152  he specified VAR
+000227f0: 4941 4e54 2063 6f6c 756d 6e20 636f 6e74  IANT column cont
+00022800: 6169 6e73 2061 2054 494d 4553 5441 4d50  ains a TIMESTAMP
+00022810: 5f4c 545a 2076 616c 7565 2074 6f20 6265  _LTZ value to be
+00022820: 0a20 2020 2069 6e74 6572 7072 6574 6564  .    interpreted
+00022830: 2075 7369 6e67 2074 6865 206c 6f63 616c   using the local
+00022840: 2074 696d 6520 7a6f 6e65 2e0a 0a20 2020   time zone...   
+00022850: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+00022860: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00022870: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00022880: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00022890: 2074 6f5f 7661 7269 616e 742c 2069 735f   to_variant, is_
+000228a0: 7469 6d65 7374 616d 705f 6c74 7a0a 2020  timestamp_ltz.  
+000228b0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000228c0: 6573 7369 6f6e 2e73 716c 2822 7365 6c65  ession.sql("sele
+000228d0: 6374 2074 6f5f 7469 6d65 7374 616d 705f  ct to_timestamp_
+000228e0: 6e74 7a28 2732 3031 372d 3032 2d32 3420  ntz('2017-02-24 
+000228f0: 3132 3a30 303a 3030 2e34 3536 2729 2061  12:00:00.456') a
+00022900: 7320 7469 6d65 7374 616d 705f 6e74 7a31  s timestamp_ntz1
+00022910: 2c20 220a 2020 2020 2020 2020 2e2e 2e20  , ".        ... 
+00022920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022930: 2022 746f 5f74 696d 6573 7461 6d70 5f6c   "to_timestamp_l
+00022940: 747a 2827 3230 3137 2d30 322d 3234 2031  tz('2017-02-24 1
+00022950: 333a 3030 3a30 302e 3132 3320 2b30 313a  3:00:00.123 +01:
+00022960: 3030 2729 2061 7320 7469 6d65 7374 616d  00') as timestam
+00022970: 705f 6c74 7a31 2c20 220a 2020 2020 2020  p_ltz1, ".      
+00022980: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00022990: 2020 2020 2020 2022 746f 5f74 696d 6573         "to_times
+000229a0: 7461 6d70 5f74 7a28 2732 3031 372d 3032  tamp_tz('2017-02
+000229b0: 2d32 3420 3133 3a30 303a 3030 2e31 3233  -24 13:00:00.123
+000229c0: 202b 3031 3a30 3027 2920 6173 2074 696d   +01:00') as tim
+000229d0: 6573 7461 6d70 5f74 7a31 2229 0a20 2020  estamp_tz1").   
+000229e0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+000229f0: 6374 2869 735f 7469 6d65 7374 616d 705f  ct(is_timestamp_
+00022a00: 6c74 7a28 746f 5f76 6172 6961 6e74 2822  ltz(to_variant("
+00022a10: 7469 6d65 7374 616d 705f 6e74 7a31 2229  timestamp_ntz1")
+00022a20: 292e 6173 5f28 2261 2229 2c0a 2020 2020  ).as_("a"),.    
+00022a30: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00022a40: 2020 6973 5f74 696d 6573 7461 6d70 5f6c    is_timestamp_l
+00022a50: 747a 2874 6f5f 7661 7269 616e 7428 2274  tz(to_variant("t
+00022a60: 696d 6573 7461 6d70 5f6c 747a 3122 2929  imestamp_ltz1"))
+00022a70: 2e61 735f 2822 6222 292c 0a20 2020 2020  .as_("b"),.     
+00022a80: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00022a90: 2069 735f 7469 6d65 7374 616d 705f 6c74   is_timestamp_lt
+00022aa0: 7a28 746f 5f76 6172 6961 6e74 2822 7469  z(to_variant("ti
+00022ab0: 6d65 7374 616d 705f 747a 3122 2929 2e61  mestamp_tz1")).a
+00022ac0: 735f 2822 6322 2929 2e63 6f6c 6c65 6374  s_("c")).collect
+00022ad0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00022ae0: 413d 4661 6c73 652c 2042 3d54 7275 652c  A=False, B=True,
+00022af0: 2043 3d46 616c 7365 295d 0a20 2020 2022   C=False)].    "
+00022b00: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00022b10: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
+00022b20: 6973 5f74 696d 6573 7461 6d70 5f6c 747a  is_timestamp_ltz
+00022b30: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00022b40: 696c 7469 6e28 2269 735f 7469 6d65 7374  iltin("is_timest
+00022b50: 616d 705f 6c74 7a22 2928 6329 0a0a 0a64  amp_ltz")(c)...d
+00022b60: 6566 2069 735f 7469 6d65 7374 616d 705f  ef is_timestamp_
+00022b70: 6e74 7a28 636f 6c3a 2043 6f6c 756d 6e4f  ntz(col: ColumnO
+00022b80: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00022b90: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00022ba0: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
+00022bb0: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
+00022bc0: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
+00022bd0: 696e 7320 6120 5449 4d45 5354 414d 505f  ins a TIMESTAMP_
+00022be0: 4e54 5a20 7661 6c75 6520 7769 7468 206e  NTZ value with n
+00022bf0: 6f20 7469 6d65 207a 6f6e 652e 0a0a 2020  o time zone...  
+00022c00: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+00022c10: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00022c20: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00022c30: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+00022c40: 7420 746f 5f76 6172 6961 6e74 2c20 6973  t to_variant, is
+00022c50: 5f74 696d 6573 7461 6d70 5f6e 747a 0a20  _timestamp_ntz. 
+00022c60: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00022c70: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
+00022c80: 6563 7420 746f 5f74 696d 6573 7461 6d70  ect to_timestamp
+00022c90: 5f6e 747a 2827 3230 3137 2d30 322d 3234  _ntz('2017-02-24
+00022ca0: 2031 323a 3030 3a30 302e 3435 3627 2920   12:00:00.456') 
+00022cb0: 6173 2074 696d 6573 7461 6d70 5f6e 747a  as timestamp_ntz
+00022cc0: 312c 2022 0a20 2020 2020 2020 202e 2e2e  1, ".        ...
+00022cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ce0: 2020 2274 6f5f 7469 6d65 7374 616d 705f    "to_timestamp_
+00022cf0: 6c74 7a28 2732 3031 372d 3032 2d32 3420  ltz('2017-02-24 
+00022d00: 3133 3a30 303a 3030 2e31 3233 202b 3031  13:00:00.123 +01
+00022d10: 3a30 3027 2920 6173 2074 696d 6573 7461  :00') as timesta
+00022d20: 6d70 5f6c 747a 312c 2022 0a20 2020 2020  mp_ltz1, ".     
+00022d30: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00022d40: 2020 2020 2020 2020 2274 6f5f 7469 6d65          "to_time
+00022d50: 7374 616d 705f 747a 2827 3230 3137 2d30  stamp_tz('2017-0
+00022d60: 322d 3234 2031 333a 3030 3a30 302e 3132  2-24 13:00:00.12
+00022d70: 3320 2b30 313a 3030 2729 2061 7320 7469  3 +01:00') as ti
+00022d80: 6d65 7374 616d 705f 747a 3122 290a 2020  mestamp_tz1").  
+00022d90: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00022da0: 6563 7428 6973 5f74 696d 6573 7461 6d70  ect(is_timestamp
+00022db0: 5f6e 747a 2874 6f5f 7661 7269 616e 7428  _ntz(to_variant(
+00022dc0: 2274 696d 6573 7461 6d70 5f6e 747a 3122  "timestamp_ntz1"
+00022dd0: 2929 2e61 735f 2822 6122 292c 0a20 2020  )).as_("a"),.   
+00022de0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00022df0: 2020 2069 735f 7469 6d65 7374 616d 705f     is_timestamp_
+00022e00: 6e74 7a28 746f 5f76 6172 6961 6e74 2822  ntz(to_variant("
+00022e10: 7469 6d65 7374 616d 705f 6c74 7a31 2229  timestamp_ltz1")
+00022e20: 292e 6173 5f28 2262 2229 2c0a 2020 2020  ).as_("b"),.    
+00022e30: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00022e40: 2020 6973 5f74 696d 6573 7461 6d70 5f6e    is_timestamp_n
+00022e50: 747a 2874 6f5f 7661 7269 616e 7428 2274  tz(to_variant("t
+00022e60: 696d 6573 7461 6d70 5f74 7a31 2229 292e  imestamp_tz1")).
+00022e70: 6173 5f28 2263 2229 292e 636f 6c6c 6563  as_("c")).collec
+00022e80: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00022e90: 2841 3d54 7275 652c 2042 3d46 616c 7365  (A=True, B=False
+00022ea0: 2c20 433d 4661 6c73 6529 5d0a 2020 2020  , C=False)].    
+00022eb0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+00022ec0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
+00022ed0: 2269 735f 7469 6d65 7374 616d 705f 6e74  "is_timestamp_nt
+00022ee0: 7a22 290a 2020 2020 7265 7475 726e 2062  z").    return b
+00022ef0: 7569 6c74 696e 2822 6973 5f74 696d 6573  uiltin("is_times
+00022f00: 7461 6d70 5f6e 747a 2229 2863 290a 0a0a  tamp_ntz")(c)...
+00022f10: 6465 6620 6973 5f74 696d 6573 7461 6d70  def is_timestamp
+00022f20: 5f74 7a28 636f 6c3a 2043 6f6c 756d 6e4f  _tz(col: ColumnO
+00022f30: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00022f40: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+00022f50: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
+00022f60: 6520 7370 6563 6966 6965 6420 5641 5249  e specified VARI
+00022f70: 414e 5420 636f 6c75 6d6e 2063 6f6e 7461  ANT column conta
+00022f80: 696e 7320 6120 5449 4d45 5354 414d 505f  ins a TIMESTAMP_
+00022f90: 545a 2076 616c 7565 2077 6974 6820 6120  TZ value with a 
+00022fa0: 7469 6d65 207a 6f6e 652e 0a0a 2020 2020  time zone...    
+00022fb0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00022fc0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00022fd0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+00022fe0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+00022ff0: 746f 5f76 6172 6961 6e74 2c20 6973 5f74  to_variant, is_t
+00023000: 696d 6573 7461 6d70 5f74 7a0a 2020 2020  imestamp_tz.    
+00023010: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00023020: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
+00023030: 2074 6f5f 7469 6d65 7374 616d 705f 6e74   to_timestamp_nt
+00023040: 7a28 2732 3031 372d 3032 2d32 3420 3132  z('2017-02-24 12
+00023050: 3a30 303a 3030 2e34 3536 2729 2061 7320  :00:00.456') as 
+00023060: 7469 6d65 7374 616d 705f 6e74 7a31 2c20  timestamp_ntz1, 
+00023070: 220a 2020 2020 2020 2020 2e2e 2e20 2020  ".        ...   
+00023080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00023090: 746f 5f74 696d 6573 7461 6d70 5f6c 747a  to_timestamp_ltz
+000230a0: 2827 3230 3137 2d30 322d 3234 2031 333a  ('2017-02-24 13:
+000230b0: 3030 3a30 302e 3132 3320 2b30 313a 3030  00:00.123 +01:00
+000230c0: 2729 2061 7320 7469 6d65 7374 616d 705f  ') as timestamp_
+000230d0: 6c74 7a31 2c20 220a 2020 2020 2020 2020  ltz1, ".        
+000230e0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+000230f0: 2020 2020 2022 746f 5f74 696d 6573 7461       "to_timesta
+00023100: 6d70 5f74 7a28 2732 3031 372d 3032 2d32  mp_tz('2017-02-2
+00023110: 3420 3133 3a30 303a 3030 2e31 3233 202b  4 13:00:00.123 +
+00023120: 3031 3a30 3027 2920 6173 2074 696d 6573  01:00') as times
+00023130: 7461 6d70 5f74 7a31 2229 0a20 2020 2020  tamp_tz1").     
+00023140: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00023150: 2869 735f 7469 6d65 7374 616d 705f 747a  (is_timestamp_tz
+00023160: 2874 6f5f 7661 7269 616e 7428 2274 696d  (to_variant("tim
+00023170: 6573 7461 6d70 5f6e 747a 3122 2929 2e61  estamp_ntz1")).a
+00023180: 735f 2822 6122 292c 0a20 2020 2020 2020  s_("a"),.       
+00023190: 202e 2e2e 2020 2020 2020 2020 2020 2069   ...           i
+000231a0: 735f 7469 6d65 7374 616d 705f 747a 2874  s_timestamp_tz(t
+000231b0: 6f5f 7661 7269 616e 7428 2274 696d 6573  o_variant("times
+000231c0: 7461 6d70 5f6c 747a 3122 2929 2e61 735f  tamp_ltz1")).as_
+000231d0: 2822 6222 292c 0a20 2020 2020 2020 202e  ("b"),.        .
+000231e0: 2e2e 2020 2020 2020 2020 2020 2069 735f  ..           is_
+000231f0: 7469 6d65 7374 616d 705f 747a 2874 6f5f  timestamp_tz(to_
+00023200: 7661 7269 616e 7428 2274 696d 6573 7461  variant("timesta
+00023210: 6d70 5f74 7a31 2229 292e 6173 5f28 2263  mp_tz1")).as_("c
+00023220: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00023230: 2020 2020 2020 5b52 6f77 2841 3d46 616c        [Row(A=Fal
+00023240: 7365 2c20 423d 4661 6c73 652c 2043 3d54  se, B=False, C=T
+00023250: 7275 6529 5d0a 2020 2020 2222 220a 2020  rue)].    """.  
+00023260: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
+00023270: 5f73 7472 2863 6f6c 2c20 2269 735f 7469  _str(col, "is_ti
+00023280: 6d65 7374 616d 705f 747a 2229 0a20 2020  mestamp_tz").   
+00023290: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000232a0: 2269 735f 7469 6d65 7374 616d 705f 747a  "is_timestamp_tz
+000232b0: 2229 2863 290a 0a0a 6465 6620 5f63 6f6c  ")(c)...def _col
+000232c0: 756d 6e73 5f66 726f 6d5f 7469 6d65 7374  umns_from_timest
+000232d0: 616d 705f 7061 7274 7328 0a20 2020 2066  amp_parts(.    f
+000232e0: 756e 635f 6e61 6d65 3a20 7374 722c 202a  unc_name: str, *
+000232f0: 6172 6773 3a20 556e 696f 6e5b 436f 6c75  args: Union[Colu
+00023300: 6d6e 4f72 4e61 6d65 2c20 696e 745d 0a29  mnOrName, int].)
+00023310: 202d 3e20 5475 706c 655b 436f 6c75 6d6e   -> Tuple[Column
+00023320: 2c20 2e2e 2e5d 3a0a 2020 2020 6966 206c  , ...]:.    if l
+00023330: 656e 2861 7267 7329 203d 3d20 333a 0a20  en(args) == 3:. 
+00023340: 2020 2020 2020 2079 6561 725f 203d 205f         year_ = _
+00023350: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
+00023360: 5f69 6e74 2861 7267 735b 305d 2c20 6675  _int(args[0], fu
+00023370: 6e63 5f6e 616d 6529 0a20 2020 2020 2020  nc_name).       
+00023380: 206d 6f6e 7468 203d 205f 746f 5f63 6f6c   month = _to_col
+00023390: 5f69 665f 7374 725f 6f72 5f69 6e74 2861  _if_str_or_int(a
+000233a0: 7267 735b 315d 2c20 6675 6e63 5f6e 616d  rgs[1], func_nam
+000233b0: 6529 0a20 2020 2020 2020 2064 6179 203d  e).        day =
+000233c0: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
+000233d0: 6f72 5f69 6e74 2861 7267 735b 325d 2c20  or_int(args[2], 
+000233e0: 6675 6e63 5f6e 616d 6529 0a20 2020 2020  func_name).     
+000233f0: 2020 2072 6574 7572 6e20 7965 6172 5f2c     return year_,
+00023400: 206d 6f6e 7468 2c20 6461 790a 2020 2020   month, day.    
+00023410: 656c 6966 206c 656e 2861 7267 7329 203d  elif len(args) =
+00023420: 3d20 363a 0a20 2020 2020 2020 2079 6561  = 6:.        yea
+00023430: 725f 203d 205f 746f 5f63 6f6c 5f69 665f  r_ = _to_col_if_
+00023440: 7374 725f 6f72 5f69 6e74 2861 7267 735b  str_or_int(args[
+00023450: 305d 2c20 6675 6e63 5f6e 616d 6529 0a20  0], func_name). 
+00023460: 2020 2020 2020 206d 6f6e 7468 203d 205f         month = _
+00023470: 746f 5f63 6f6c 5f69 665f 7374 725f 6f72  to_col_if_str_or
+00023480: 5f69 6e74 2861 7267 735b 315d 2c20 6675  _int(args[1], fu
+00023490: 6e63 5f6e 616d 6529 0a20 2020 2020 2020  nc_name).       
+000234a0: 2064 6179 203d 205f 746f 5f63 6f6c 5f69   day = _to_col_i
+000234b0: 665f 7374 725f 6f72 5f69 6e74 2861 7267  f_str_or_int(arg
+000234c0: 735b 325d 2c20 6675 6e63 5f6e 616d 6529  s[2], func_name)
+000234d0: 0a20 2020 2020 2020 2068 6f75 7220 3d20  .        hour = 
+000234e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
+000234f0: 725f 696e 7428 6172 6773 5b33 5d2c 2066  r_int(args[3], f
+00023500: 756e 635f 6e61 6d65 290a 2020 2020 2020  unc_name).      
+00023510: 2020 6d69 6e75 7465 203d 205f 746f 5f63    minute = _to_c
+00023520: 6f6c 5f69 665f 7374 725f 6f72 5f69 6e74  ol_if_str_or_int
+00023530: 2861 7267 735b 345d 2c20 6675 6e63 5f6e  (args[4], func_n
+00023540: 616d 6529 0a20 2020 2020 2020 2073 6563  ame).        sec
+00023550: 6f6e 6420 3d20 5f74 6f5f 636f 6c5f 6966  ond = _to_col_if
+00023560: 5f73 7472 5f6f 725f 696e 7428 6172 6773  _str_or_int(args
+00023570: 5b35 5d2c 2066 756e 635f 6e61 6d65 290a  [5], func_name).
+00023580: 2020 2020 2020 2020 7265 7475 726e 2079          return y
+00023590: 6561 725f 2c20 6d6f 6e74 682c 2064 6179  ear_, month, day
+000235a0: 2c20 686f 7572 2c20 6d69 6e75 7465 2c20  , hour, minute, 
+000235b0: 7365 636f 6e64 0a20 2020 2065 6c73 653a  second.    else:
+000235c0: 0a20 2020 2020 2020 2023 2053 686f 756c  .        # Shoul
+000235d0: 6420 6e65 7665 7220 6861 7070 656e 2073  d never happen s
+000235e0: 696e 6365 2077 6520 6f6e 6c79 2075 7365  ince we only use
+000235f0: 2074 6869 7320 696e 7465 726e 616c 6c79   this internally
+00023600: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00023610: 616c 7565 4572 726f 7228 6622 496e 636f  alueError(f"Inco
+00023620: 7272 6563 7420 6e75 6d62 6572 206f 6620  rrect number of 
+00023630: 6172 6773 2070 6173 7365 6420 746f 207b  args passed to {
+00023640: 6675 6e63 5f6e 616d 657d 2229 0a0a 0a64  func_name}")...d
+00023650: 6566 205f 7469 6d65 7374 616d 705f 6672  ef _timestamp_fr
+00023660: 6f6d 5f70 6172 7473 5f69 6e74 6572 6e61  om_parts_interna
+00023670: 6c28 0a20 2020 2066 756e 635f 6e61 6d65  l(.    func_name
+00023680: 3a20 7374 722c 202a 6172 6773 3a20 556e  : str, *args: Un
+00023690: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+000236a0: 2c20 696e 745d 2c20 2a2a 6b77 6172 6773  , int], **kwargs
+000236b0: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+000236c0: 4e61 6d65 2c20 696e 745d 0a29 202d 3e20  Name, int].) -> 
+000236d0: 5475 706c 655b 436f 6c75 6d6e 2c20 2e2e  Tuple[Column, ..
+000236e0: 2e5d 3a0a 2020 2020 6e75 6d5f 6172 6773  .]:.    num_args
+000236f0: 203d 206c 656e 2861 7267 7329 0a20 2020   = len(args).   
+00023700: 2069 6620 6e75 6d5f 6172 6773 203d 3d20   if num_args == 
+00023710: 323a 0a20 2020 2020 2020 2023 2065 7870  2:.        # exp
+00023720: 7265 7373 696f 6e20 6d6f 6465 0a20 2020  ression mode.   
+00023730: 2020 2020 2064 6174 655f 6578 7072 203d       date_expr =
+00023740: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00023750: 6172 6773 5b30 5d2c 2066 756e 635f 6e61  args[0], func_na
+00023760: 6d65 290a 2020 2020 2020 2020 7469 6d65  me).        time
+00023770: 5f65 7870 7220 3d20 5f74 6f5f 636f 6c5f  _expr = _to_col_
+00023780: 6966 5f73 7472 2861 7267 735b 315d 2c20  if_str(args[1], 
+00023790: 6675 6e63 5f6e 616d 6529 0a20 2020 2020  func_name).     
+000237a0: 2020 2072 6574 7572 6e20 6461 7465 5f65     return date_e
+000237b0: 7870 722c 2074 696d 655f 6578 7072 0a20  xpr, time_expr. 
+000237c0: 2020 2065 6c69 6620 3620 3c3d 206e 756d     elif 6 <= num
+000237d0: 5f61 7267 7320 3c3d 2038 3a0a 2020 2020  _args <= 8:.    
+000237e0: 2020 2020 2320 7061 7274 7320 6d6f 6465      # parts mode
+000237f0: 0a20 2020 2020 2020 2079 2c20 6d2c 2064  .        y, m, d
+00023800: 2c20 682c 206d 696e 5f2c 2073 203d 205f  , h, min_, s = _
+00023810: 636f 6c75 6d6e 735f 6672 6f6d 5f74 696d  columns_from_tim
+00023820: 6573 7461 6d70 5f70 6172 7473 2866 756e  estamp_parts(fun
+00023830: 635f 6e61 6d65 2c20 2a61 7267 735b 3a36  c_name, *args[:6
+00023840: 5d29 0a20 2020 2020 2020 206e 735f 6172  ]).        ns_ar
+00023850: 6720 3d20 6172 6773 5b36 5d20 6966 206e  g = args[6] if n
+00023860: 756d 5f61 7267 7320 3e3d 2037 2065 6c73  um_args >= 7 els
+00023870: 6520 6b77 6172 6773 2e67 6574 2822 6e61  e kwargs.get("na
+00023880: 6e6f 7365 636f 6e64 7322 290a 2020 2020  noseconds").    
+00023890: 2020 2020 2320 5469 6d65 7a6f 6e65 2069      # Timezone i
+000238a0: 7320 6f6e 6c79 2061 6363 6570 7465 6420  s only accepted 
+000238b0: 696e 2074 696d 6573 7461 6d70 5f66 726f  in timestamp_fro
+000238c0: 6d5f 7061 7274 7320 6675 6e63 7469 6f6e  m_parts function
+000238d0: 0a20 2020 2020 2020 2074 7a5f 6172 6720  .        tz_arg 
+000238e0: 3d20 6172 6773 5b37 5d20 6966 206e 756d  = args[7] if num
+000238f0: 5f61 7267 7320 3d3d 2038 2065 6c73 6520  _args == 8 else 
+00023900: 6b77 6172 6773 2e67 6574 2822 7469 6d65  kwargs.get("time
+00023910: 7a6f 6e65 2229 0a20 2020 2020 2020 2069  zone").        i
+00023920: 6620 747a 5f61 7267 2069 7320 6e6f 7420  f tz_arg is not 
+00023930: 4e6f 6e65 2061 6e64 2066 756e 635f 6e61  None and func_na
+00023940: 6d65 2021 3d20 2274 696d 6573 7461 6d70  me != "timestamp
+00023950: 5f66 726f 6d5f 7061 7274 7322 3a0a 2020  _from_parts":.  
+00023960: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00023970: 5661 6c75 6545 7272 6f72 2866 227b 6675  ValueError(f"{fu
+00023980: 6e63 5f6e 616d 657d 2064 6f65 7320 6e6f  nc_name} does no
+00023990: 7420 6163 6365 7074 2074 696d 657a 6f6e  t accept timezon
+000239a0: 6520 6173 2061 6e20 6172 6775 6d65 6e74  e as an argument
+000239b0: 2229 0a20 2020 2020 2020 206e 7320 3d20  ").        ns = 
+000239c0: 4e6f 6e65 2069 6620 6e73 5f61 7267 2069  None if ns_arg i
+000239d0: 7320 4e6f 6e65 2065 6c73 6520 5f74 6f5f  s None else _to_
+000239e0: 636f 6c5f 6966 5f73 7472 5f6f 725f 696e  col_if_str_or_in
+000239f0: 7428 6e73 5f61 7267 2c20 6675 6e63 5f6e  t(ns_arg, func_n
+00023a00: 616d 6529 0a20 2020 2020 2020 2074 7a20  ame).        tz 
+00023a10: 3d20 4e6f 6e65 2069 6620 747a 5f61 7267  = None if tz_arg
+00023a20: 2069 7320 4e6f 6e65 2065 6c73 6520 5f74   is None else _t
+00023a30: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
+00023a40: 7228 747a 5f61 7267 2c20 6675 6e63 5f6e  r(tz_arg, func_n
+00023a50: 616d 6529 0a20 2020 2020 2020 2069 6620  ame).        if 
+00023a60: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2061  ns is not None a
+00023a70: 6e64 2074 7a20 6973 206e 6f74 204e 6f6e  nd tz is not Non
+00023a80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00023a90: 6574 7572 6e20 792c 206d 2c20 642c 2068  eturn y, m, d, h
+00023aa0: 2c20 6d69 6e5f 2c20 732c 206e 732c 2074  , min_, s, ns, t
+00023ab0: 7a0a 2020 2020 2020 2020 656c 6966 206e  z.        elif n
+00023ac0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00023ad0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00023ae0: 6e20 792c 206d 2c20 642c 2068 2c20 6d69  n y, m, d, h, mi
+00023af0: 6e5f 2c20 732c 206e 730a 2020 2020 2020  n_, s, ns.      
+00023b00: 2020 656c 6966 2074 7a20 6973 206e 6f74    elif tz is not
+00023b10: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00023b20: 2020 2023 2057 6520 6e65 6564 2074 6f20     # We need to 
+00023b30: 6669 6c6c 2069 6e20 6e61 6e6f 7365 636f  fill in nanoseco
+00023b40: 6e64 7320 6173 2030 2074 6f20 6d61 6b65  nds as 0 to make
+00023b50: 2074 6865 2073 716c 2066 756e 6374 696f   the sql functio
+00023b60: 6e20 776f 726b 0a20 2020 2020 2020 2020  n work.         
+00023b70: 2020 2072 6574 7572 6e20 792c 206d 2c20     return y, m, 
+00023b80: 642c 2068 2c20 6d69 6e5f 2c20 732c 206c  d, h, min_, s, l
+00023b90: 6974 2830 292c 2074 7a0a 2020 2020 2020  it(0), tz.      
+00023ba0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00023bb0: 2020 2020 7265 7475 726e 2079 2c20 6d2c      return y, m,
+00023bc0: 2064 2c20 682c 206d 696e 5f2c 2073 0a20   d, h, min_, s. 
+00023bd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00023be0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00023bf0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
+00023c00: 227b 6675 6e63 5f6e 616d 657d 2065 7870  "{func_name} exp
+00023c10: 6563 7465 6420 3220 6f72 2036 2072 6571  ected 2 or 6 req
+00023c20: 7569 7265 6420 6172 6775 6d65 6e74 732c  uired arguments,
+00023c30: 2067 6f74 207b 6e75 6d5f 6172 6773 7d22   got {num_args}"
+00023c40: 0a20 2020 2020 2020 2029 0a0a 0a64 6566  .        )...def
+00023c50: 2074 696d 655f 6672 6f6d 5f70 6172 7473   time_from_parts
+00023c60: 280a 2020 2020 686f 7572 3a20 556e 696f  (.    hour: Unio
+00023c70: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00023c80: 696e 745d 2c0a 2020 2020 6d69 6e75 7465  int],.    minute
+00023c90: 3a20 556e 696f 6e5b 436f 6c75 6d6e 4f72  : Union[ColumnOr
+00023ca0: 4e61 6d65 2c20 696e 745d 2c0a 2020 2020  Name, int],.    
+00023cb0: 7365 636f 6e64 3a20 556e 696f 6e5b 436f  second: Union[Co
+00023cc0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00023cd0: 2c0a 2020 2020 6e61 6e6f 7365 636f 6e64  ,.    nanosecond
+00023ce0: 733a 204f 7074 696f 6e61 6c5b 556e 696f  s: Optional[Unio
+00023cf0: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00023d00: 696e 745d 5d20 3d20 4e6f 6e65 2c0a 2920  int]] = None,.) 
+00023d10: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00023d20: 2222 0a20 2020 2043 7265 6174 6573 2061  "".    Creates a
+00023d30: 2074 696d 6520 6672 6f6d 2069 6e64 6976   time from indiv
+00023d40: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
+00023d50: 6d70 6f6e 656e 7473 2e0a 0a20 2020 2054  mponents...    T
+00023d60: 494d 455f 4652 4f4d 5f50 4152 5453 2069  IME_FROM_PARTS i
+00023d70: 7320 7479 7069 6361 6c6c 7920 7573 6564  s typically used
+00023d80: 2074 6f20 6861 6e64 6c65 2076 616c 7565   to handle value
+00023d90: 7320 696e 2022 6e6f 726d 616c 2220 7261  s in "normal" ra
+00023da0: 6e67 6573 2028 652e 672e 2068 6f75 7273  nges (e.g. hours
+00023db0: 2030 2d32 332c 206d 696e 7574 6573 2030   0-23, minutes 0
+00023dc0: 2d35 3929 2c0a 2020 2020 6275 7420 6974  -59),.    but it
+00023dd0: 2061 6c73 6f20 6861 6e64 6c65 7320 7661   also handles va
+00023de0: 6c75 6573 2066 726f 6d20 6f75 7473 6964  lues from outsid
+00023df0: 6520 7468 6573 6520 7261 6e67 6573 2e20  e these ranges. 
+00023e00: 5468 6973 2061 6c6c 6f77 732c 2066 6f72  This allows, for
+00023e10: 2065 7861 6d70 6c65 2c20 6368 6f6f 7369   example, choosi
+00023e20: 6e67 2074 6865 204e 2d74 6820 6d69 6e75  ng the N-th minu
+00023e30: 7465 0a20 2020 2069 6e20 6120 6461 792c  te.    in a day,
+00023e40: 2077 6869 6368 2063 616e 2062 6520 7573   which can be us
+00023e50: 6564 2074 6f20 7369 6d70 6c69 6679 2073  ed to simplify s
+00023e60: 6f6d 6520 636f 6d70 7574 6174 696f 6e73  ome computations
+00023e70: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00023e80: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00023e90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00023ea0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+00023eb0: 2020 2020 202e 2e2e 2020 2020 205b 5b31       ...     [[1
+00023ec0: 312c 2031 312c 2030 2c20 3938 3736 3534  1, 11, 0, 987654
+00023ed0: 3332 315d 2c20 5b31 302c 2031 302c 2030  321], [10, 10, 0
+00023ee0: 2c20 3938 3736 3534 3332 315d 5d2c 0a20  , 987654321]],. 
+00023ef0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+00023f00: 6368 656d 613d 5b22 686f 7572 222c 2022  chema=["hour", "
+00023f10: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
+00023f20: 222c 2022 6e61 6e6f 7365 636f 6e64 7322  ", "nanoseconds"
+00023f30: 5d2c 0a20 2020 2020 2020 202e 2e2e 2029  ],.        ... )
+00023f40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00023f50: 7365 6c65 6374 2874 696d 655f 6672 6f6d  select(time_from
+00023f60: 5f70 6172 7473 280a 2020 2020 2020 2020  _parts(.        
+00023f70: 2e2e 2e20 2020 2020 2268 6f75 7222 2c20  ...     "hour", 
+00023f80: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+00023f90: 6422 2c20 6e61 6e6f 7365 636f 6e64 733d  d", nanoseconds=
+00023fa0: 226e 616e 6f73 6563 6f6e 6473 220a 2020  "nanoseconds".  
+00023fb0: 2020 2020 2020 2e2e 2e20 292e 616c 6961        ... ).alia
+00023fc0: 7328 2254 494d 455f 4652 4f4d 5f50 4152  s("TIME_FROM_PAR
+00023fd0: 5453 2229 292e 636f 6c6c 6563 7428 290a  TS")).collect().
+00023fe0: 2020 2020 2020 2020 5b52 6f77 2854 494d          [Row(TIM
+00023ff0: 455f 4652 4f4d 5f50 4152 5453 3d64 6174  E_FROM_PARTS=dat
+00024000: 6574 696d 652e 7469 6d65 2831 312c 2031  etime.time(11, 1
+00024010: 312c 2030 2c20 3938 3736 3534 2929 2c20  1, 0, 987654)), 
+00024020: 526f 7728 5449 4d45 5f46 524f 4d5f 5041  Row(TIME_FROM_PA
+00024030: 5254 533d 6461 7465 7469 6d65 2e74 696d  RTS=datetime.tim
+00024040: 6528 3130 2c20 3130 2c20 302c 2039 3837  e(10, 10, 0, 987
+00024050: 3635 3429 295d 0a20 2020 2022 2222 0a20  654))].    """. 
+00024060: 2020 2068 2c20 6d2c 2073 203d 205f 636f     h, m, s = _co
+00024070: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
+00024080: 7461 6d70 5f70 6172 7473 2822 7469 6d65  tamp_parts("time
+00024090: 5f66 726f 6d5f 7061 7274 7322 2c20 686f  _from_parts", ho
+000240a0: 7572 2c20 6d69 6e75 7465 2c20 7365 636f  ur, minute, seco
+000240b0: 6e64 290a 2020 2020 6966 206e 616e 6f73  nd).    if nanos
+000240c0: 6563 6f6e 6473 3a0a 2020 2020 2020 2020  econds:.        
+000240d0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+000240e0: 7469 6d65 5f66 726f 6d5f 7061 7274 7322  time_from_parts"
+000240f0: 2928 0a20 2020 2020 2020 2020 2020 2068  )(.            h
+00024100: 2c20 6d2c 2073 2c20 5f74 6f5f 636f 6c5f  , m, s, _to_col_
+00024110: 6966 5f73 7472 5f6f 725f 696e 7428 6e61  if_str_or_int(na
+00024120: 6e6f 7365 636f 6e64 732c 2022 7469 6d65  noseconds, "time
+00024130: 5f66 726f 6d5f 7061 7274 7322 290a 2020  _from_parts").  
+00024140: 2020 2020 2020 290a 2020 2020 656c 7365        ).    else
+00024150: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00024160: 2062 7569 6c74 696e 2822 7469 6d65 5f66   builtin("time_f
+00024170: 726f 6d5f 7061 7274 7322 2928 682c 206d  rom_parts")(h, m
+00024180: 2c20 7329 0a0a 0a40 6f76 6572 6c6f 6164  , s)...@overload
+00024190: 0a64 6566 2074 696d 6573 7461 6d70 5f66  .def timestamp_f
+000241a0: 726f 6d5f 7061 7274 7328 6461 7465 5f65  rom_parts(date_e
+000241b0: 7870 723a 2043 6f6c 756d 6e4f 724e 616d  xpr: ColumnOrNam
+000241c0: 652c 2074 696d 655f 6578 7072 3a20 436f  e, time_expr: Co
+000241d0: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+000241e0: 6f6c 756d 6e3a 0a20 2020 202e 2e2e 2020  olumn:.    ...  
+000241f0: 2320 7072 6167 6d61 3a20 6e6f 2063 6f76  # pragma: no cov
+00024200: 6572 0a0a 0a40 6f76 6572 6c6f 6164 0a64  er...@overload.d
+00024210: 6566 2074 696d 6573 7461 6d70 5f66 726f  ef timestamp_fro
+00024220: 6d5f 7061 7274 7328 0a20 2020 2079 6561  m_parts(.    yea
+00024230: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
+00024240: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
+00024250: 206d 6f6e 7468 3a20 556e 696f 6e5b 436f   month: Union[Co
+00024260: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+00024270: 2c0a 2020 2020 6461 793a 2055 6e69 6f6e  ,.    day: Union
+00024280: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00024290: 6e74 5d2c 0a20 2020 2068 6f75 723a 2055  nt],.    hour: U
+000242a0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+000242b0: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
+000242c0: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
+000242d0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
+000242e0: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
+000242f0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00024300: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
+00024310: 6f6e 643a 204f 7074 696f 6e61 6c5b 556e  ond: Optional[Un
+00024320: 696f 6e5b 436f 6c75 6d6e 4f72 4e61 6d65  ion[ColumnOrName
+00024330: 2c20 696e 745d 5d20 3d20 4e6f 6e65 2c0a  , int]] = None,.
+00024340: 2020 2020 7469 6d65 7a6f 6e65 3a20 4f70      timezone: Op
+00024350: 7469 6f6e 616c 5b43 6f6c 756d 6e4f 724c  tional[ColumnOrL
+00024360: 6974 6572 616c 5374 725d 203d 204e 6f6e  iteralStr] = Non
+00024370: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
+00024380: 2020 2020 2e2e 2e20 2023 2070 7261 676d      ...  # pragm
+00024390: 613a 206e 6f20 636f 7665 720a 0a0a 6465  a: no cover...de
+000243a0: 6620 7469 6d65 7374 616d 705f 6672 6f6d  f timestamp_from
+000243b0: 5f70 6172 7473 282a 6172 6773 2c20 2a2a  _parts(*args, **
+000243c0: 6b77 6172 6773 2920 2d3e 2043 6f6c 756d  kwargs) -> Colum
+000243d0: 6e3a 0a20 2020 2022 2222 0a20 2020 2043  n:.    """.    C
+000243e0: 7265 6174 6573 2061 2074 696d 6573 7461  reates a timesta
+000243f0: 6d70 2066 726f 6d20 696e 6469 7669 6475  mp from individu
+00024400: 616c 206e 756d 6572 6963 2063 6f6d 706f  al numeric compo
+00024410: 6e65 6e74 732e 2049 6620 6e6f 2074 696d  nents. If no tim
+00024420: 6520 7a6f 6e65 2069 7320 696e 2065 6666  e zone is in eff
+00024430: 6563 742c 0a20 2020 2074 6865 2066 756e  ect,.    the fun
+00024440: 6374 696f 6e20 6361 6e20 6265 2075 7365  ction can be use
+00024450: 6420 746f 2063 7265 6174 6520 6120 7469  d to create a ti
+00024460: 6d65 7374 616d 7020 6672 6f6d 2061 2064  mestamp from a d
+00024470: 6174 6520 6578 7072 6573 7369 6f6e 2061  ate expression a
+00024480: 6e64 2061 2074 696d 6520 6578 7072 6573  nd a time expres
+00024490: 7369 6f6e 2e0a 0a20 2020 2045 7861 6d70  sion...    Examp
+000244a0: 6c65 2031 3a3a 0a0a 2020 2020 2020 2020  le 1::..        
+000244b0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000244c0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+000244d0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+000244e0: 2020 205b 5b32 3032 322c 2034 2c20 312c     [[2022, 4, 1,
+000244f0: 2031 312c 2031 312c 2030 5d2c 205b 3230   11, 11, 0], [20
+00024500: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
+00024510: 312c 2030 5d5d 2c0a 2020 2020 2020 2020  1, 0]],.        
+00024520: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+00024530: 2279 6561 7222 2c20 226d 6f6e 7468 222c  "year", "month",
+00024540: 2022 6461 7922 2c20 2268 6f75 7222 2c20   "day", "hour", 
+00024550: 226d 696e 7574 6522 2c20 2273 6563 6f6e  "minute", "secon
+00024560: 6422 5d2c 0a20 2020 2020 2020 202e 2e2e  d"],.        ...
+00024570: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00024580: 662e 7365 6c65 6374 2874 696d 6573 7461  f.select(timesta
+00024590: 6d70 5f66 726f 6d5f 7061 7274 7328 0a20  mp_from_parts(. 
+000245a0: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+000245b0: 7965 6172 222c 2022 6d6f 6e74 6822 2c20  year", "month", 
+000245c0: 2264 6179 222c 2022 686f 7572 222c 2022  "day", "hour", "
+000245d0: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
+000245e0: 220a 2020 2020 2020 2020 2e2e 2e20 292e  ".        ... ).
+000245f0: 616c 6961 7328 2254 494d 4553 5441 4d50  alias("TIMESTAMP
+00024600: 5f46 524f 4d5f 5041 5254 5322 2929 2e63  _FROM_PARTS")).c
+00024610: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00024620: 205b 526f 7728 5449 4d45 5354 414d 505f   [Row(TIMESTAMP_
+00024630: 4652 4f4d 5f50 4152 5453 3d64 6174 6574  FROM_PARTS=datet
+00024640: 696d 652e 6461 7465 7469 6d65 2832 3032  ime.datetime(202
+00024650: 322c 2034 2c20 312c 2031 312c 2031 3129  2, 4, 1, 11, 11)
+00024660: 292c 2052 6f77 2854 494d 4553 5441 4d50  ), Row(TIMESTAMP
+00024670: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+00024680: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+00024690: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
+000246a0: 3129 295d 0a0a 2020 2020 4578 616d 706c  1))]..    Exampl
+000246b0: 6520 323a 3a0a 0a20 2020 2020 2020 203e  e 2::..        >
+000246c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+000246d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+000246e0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+000246f0: 2020 5b5b 2732 3032 322d 3034 2d30 3127    [['2022-04-01'
+00024700: 2c20 2731 313a 3131 3a30 3027 5d2c 205b  , '11:11:00'], [
+00024710: 2732 3032 322d 3033 2d33 3127 2c20 2731  '2022-03-31', '1
+00024720: 313a 3131 3a30 3027 5d5d 2c0a 2020 2020  1:11:00']],.    
+00024730: 2020 2020 2e2e 2e20 2020 2020 7363 6865      ...     sche
+00024740: 6d61 3d5b 2264 6174 6522 2c20 2274 696d  ma=["date", "tim
+00024750: 6522 5d0a 2020 2020 2020 2020 2e2e 2e20  e"].        ... 
+00024760: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00024770: 2e73 656c 6563 7428 0a20 2020 2020 2020  .select(.       
+00024780: 202e 2e2e 2020 2020 2074 696d 6573 7461   ...     timesta
+00024790: 6d70 5f66 726f 6d5f 7061 7274 7328 746f  mp_from_parts(to
+000247a0: 5f64 6174 6528 2264 6174 6522 292c 2074  _date("date"), t
+000247b0: 6f5f 7469 6d65 2822 7469 6d65 2229 0a20  o_time("time"). 
+000247c0: 2020 2020 2020 202e 2e2e 2029 2e61 6c69         ... ).ali
+000247d0: 6173 2822 5449 4d45 5354 414d 505f 4652  as("TIMESTAMP_FR
+000247e0: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
+000247f0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00024800: 6f77 2854 494d 4553 5441 4d50 5f46 524f  ow(TIMESTAMP_FRO
+00024810: 4d5f 5041 5254 533d 6461 7465 7469 6d65  M_PARTS=datetime
+00024820: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
+00024830: 342c 2031 2c20 3131 2c20 3131 2929 2c20  4, 1, 11, 11)), 
+00024840: 526f 7728 5449 4d45 5354 414d 505f 4652  Row(TIMESTAMP_FR
 00024850: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
 00024860: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
-00024870: 2034 2c20 312c 2031 312c 2031 312c 2074   4, 1, 11, 11, t
-00024880: 7a69 6e66 6f3d 7079 747a 2e46 6978 6564  zinfo=pytz.Fixed
-00024890: 4f66 6673 6574 282d 3432 3029 2929 2c20  Offset(-420))), 
-000248a0: 526f 7728 5449 4d45 5354 414d 505f 545a  Row(TIMESTAMP_TZ
-000248b0: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
-000248c0: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-000248d0: 3232 2c20 332c 2033 312c 2031 312c 2031  22, 3, 31, 11, 1
-000248e0: 312c 2074 7a69 6e66 6f3d 7079 747a 2e46  1, tzinfo=pytz.F
-000248f0: 6978 6564 4f66 6673 6574 282d 3432 3029  ixedOffset(-420)
-00024900: 2929 5d0a 2020 2020 2222 220a 2020 2020  ))].    """.    
-00024910: 6675 6e63 5f6e 616d 6520 3d20 2274 696d  func_name = "tim
-00024920: 6573 7461 6d70 5f74 7a5f 6672 6f6d 5f70  estamp_tz_from_p
-00024930: 6172 7473 220a 2020 2020 792c 206d 2c20  arts".    y, m, 
-00024940: 642c 2068 2c20 6d69 6e5f 2c20 7320 3d20  d, h, min_, s = 
-00024950: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
-00024960: 6d65 7374 616d 705f 7061 7274 7328 0a20  mestamp_parts(. 
-00024970: 2020 2020 2020 2066 756e 635f 6e61 6d65         func_name
-00024980: 2c20 7965 6172 2c20 6d6f 6e74 682c 2064  , year, month, d
-00024990: 6179 2c20 686f 7572 2c20 6d69 6e75 7465  ay, hour, minute
-000249a0: 2c20 7365 636f 6e64 0a20 2020 2029 0a20  , second.    ). 
-000249b0: 2020 206e 7320 3d20 4e6f 6e65 2069 6620     ns = None if 
-000249c0: 6e61 6e6f 7365 636f 6e64 7320 6973 204e  nanoseconds is N
-000249d0: 6f6e 6520 656c 7365 205f 746f 5f63 6f6c  one else _to_col
-000249e0: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
-000249f0: 616e 6f73 6563 6f6e 6473 2c20 6675 6e63  anoseconds, func
-00024a00: 5f6e 616d 6529 0a20 2020 2074 7a20 3d20  _name).    tz = 
-00024a10: 4e6f 6e65 2069 6620 7469 6d65 7a6f 6e65  None if timezone
-00024a20: 2069 7320 4e6f 6e65 2065 6c73 6520 5f74   is None else _t
-00024a30: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
-00024a40: 7228 7469 6d65 7a6f 6e65 2c20 6675 6e63  r(timezone, func
-00024a50: 5f6e 616d 6529 0a20 2020 2069 6620 6e61  _name).    if na
-00024a60: 6e6f 7365 636f 6e64 7320 6973 206e 6f74  noseconds is not
-00024a70: 204e 6f6e 6520 616e 6420 7469 6d65 7a6f   None and timezo
-00024a80: 6e65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ne is not None:.
-00024a90: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00024aa0: 7569 6c74 696e 2866 756e 635f 6e61 6d65  uiltin(func_name
-00024ab0: 2928 792c 206d 2c20 642c 2068 2c20 6d69  )(y, m, d, h, mi
-00024ac0: 6e5f 2c20 732c 206e 732c 2074 7a29 0a20  n_, s, ns, tz). 
-00024ad0: 2020 2065 6c69 6620 6e61 6e6f 7365 636f     elif nanoseco
-00024ae0: 6e64 7320 6973 206e 6f74 204e 6f6e 653a  nds is not None:
-00024af0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00024b00: 6275 696c 7469 6e28 6675 6e63 5f6e 616d  builtin(func_nam
-00024b10: 6529 2879 2c20 6d2c 2064 2c20 682c 206d  e)(y, m, d, h, m
-00024b20: 696e 5f2c 2073 2c20 6e73 290a 2020 2020  in_, s, ns).    
-00024b30: 656c 6966 2074 696d 657a 6f6e 6520 6973  elif timezone is
-00024b40: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00024b50: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00024b60: 6e28 6675 6e63 5f6e 616d 6529 2879 2c20  n(func_name)(y, 
-00024b70: 6d2c 2064 2c20 682c 206d 696e 5f2c 2073  m, d, h, min_, s
-00024b80: 2c20 6c69 7428 3029 2c20 747a 290a 2020  , lit(0), tz).  
-00024b90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00024ba0: 7265 7475 726e 2062 7569 6c74 696e 2866  return builtin(f
-00024bb0: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
-00024bc0: 642c 2068 2c20 6d69 6e5f 2c20 7329 0a0a  d, h, min_, s)..
-00024bd0: 0a64 6566 2077 6565 6b6f 6679 6561 7228  .def weekofyear(
-00024be0: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-00024bf0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00024c00: 2222 220a 2020 2020 4578 7472 6163 7473  """.    Extracts
-00024c10: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-00024c20: 6e67 2077 6565 6b20 286e 756d 6265 7229  ng week (number)
-00024c30: 206f 6620 7468 6520 7965 6172 2066 726f   of the year fro
-00024c40: 6d20 6120 6461 7465 206f 7220 7469 6d65  m a date or time
-00024c50: 7374 616d 702e 0a0a 2020 2020 4578 616d  stamp...    Exam
-00024c60: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00024c70: 3e3e 2069 6d70 6f72 7420 6461 7465 7469  >> import dateti
-00024c80: 6d65 0a20 2020 2020 2020 203e 3e3e 2064  me.        >>> d
-00024c90: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00024ca0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-00024cb0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
-00024cc0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00024cd0: 652e 7374 7270 7469 6d65 2822 3230 3230  e.strptime("2020
-00024ce0: 2d30 352d 3031 2031 333a 3131 3a32 302e  -05-01 13:11:20.
-00024cf0: 3030 3022 2c20 2225 592d 256d 2d25 6420  000", "%Y-%m-%d 
-00024d00: 2548 3a25 4d3a 2553 2e25 6622 295d 5d2c  %H:%M:%S.%f")]],
-00024d10: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00024d20: 2073 6368 656d 613d 5b22 6122 5d2c 0a20   schema=["a"],. 
-00024d30: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00024d40: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00024d50: 6374 2877 6565 6b6f 6679 6561 7228 2261  ct(weekofyear("a
-00024d60: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00024d70: 2020 2020 2020 5b52 6f77 2857 4545 4b4f        [Row(WEEKO
-00024d80: 4659 4541 5228 2241 2229 3d31 3829 5d0a  FYEAR("A")=18)].
-00024d90: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00024da0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-00024db0: 2c20 2277 6565 6b6f 6679 6561 7222 290a  , "weekofyear").
-00024dc0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00024dd0: 696e 2822 7765 656b 6f66 7965 6172 2229  in("weekofyear")
-00024de0: 2863 290a 0a0a 6465 6620 7479 7065 6f66  (c)...def typeof
-00024df0: 2863 6f6c 3a20 436f 6c75 6d6e 4f72 4e61  (col: ColumnOrNa
-00024e00: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00024e10: 2020 2022 2222 5265 706f 7274 7320 7468     """Reports th
-00024e20: 6520 7479 7065 206f 6620 6120 7661 6c75  e type of a valu
-00024e30: 6520 7374 6f72 6564 2069 6e20 6120 5641  e stored in a VA
-00024e40: 5249 414e 5420 636f 6c75 6d6e 2e20 5468  RIANT column. Th
-00024e50: 6520 7479 7065 2069 7320 7265 7475 726e  e type is return
-00024e60: 6564 2061 7320 6120 7374 7269 6e67 2e0a  ed as a string..
-00024e70: 0a20 2020 2046 6f72 2063 6f6c 756d 6e73  .    For columns
-00024e80: 2077 6865 7265 2061 6c6c 2072 6f77 7320   where all rows 
-00024e90: 7368 6172 6520 7468 6520 7361 6d65 2074  share the same t
-00024ea0: 7970 652c 2074 6865 2072 6573 756c 7420  ype, the result 
-00024eb0: 6f66 2060 7479 7065 6f66 6020 6973 2074  of `typeof` is t
-00024ec0: 6865 2075 6e64 6572 6c79 696e 6720 536e  he underlying Sn
-00024ed0: 6f77 666c 616b 6520 636f 6c75 6d6e 2074  owflake column t
-00024ee0: 7970 652e 0a0a 2020 2020 4578 616d 706c  ype...    Exampl
-00024ef0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-00024f00: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-00024f10: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-00024f20: 312c 2032 2c20 335d 2c20 7363 6865 6d61  1, 2, 3], schema
-00024f30: 3d5b 2241 225d 290a 2020 2020 2020 2020  =["A"]).        
-00024f40: 3e3e 3e20 6466 2e73 656c 6563 7428 7479  >>> df.select(ty
-00024f50: 7065 6f66 2863 6f6c 2822 4122 2929 2e61  peof(col("A")).a
-00024f60: 735f 2822 616e 7322 2929 2e63 6f6c 6c65  s_("ans")).colle
-00024f70: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00024f80: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
-00024f90: 2c20 526f 7728 414e 533d 2749 4e54 4547  , Row(ANS='INTEG
-00024fa0: 4552 2729 2c20 526f 7728 414e 533d 2749  ER'), Row(ANS='I
-00024fb0: 4e54 4547 4552 2729 5d0a 0a20 2020 2046  NTEGER')]..    F
-00024fc0: 6f72 2063 6f6c 756d 6e73 206f 6620 5641  or columns of VA
-00024fd0: 5249 414e 5420 7479 7065 2c20 7468 6520  RIANT type, the 
-00024fe0: 756e 6465 726c 7969 6e67 2073 746f 7265  underlying store
-00024ff0: 6420 7479 7065 2069 7320 7265 7475 726e  d type is return
-00025000: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
-00025010: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00025020: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00025030: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-00025040: 706f 7274 2056 6172 6961 6e74 5479 7065  port VariantType
-00025050: 2c20 5374 7275 6374 5479 7065 2c20 5374  , StructType, St
-00025060: 7275 6374 4669 656c 640a 2020 2020 2020  ructField.      
-00025070: 2020 3e3e 3e20 7363 6865 6d61 203d 2053    >>> schema = S
-00025080: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
-00025090: 7446 6965 6c64 2822 4122 2c20 5661 7269  tField("A", Vari
-000250a0: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
-000250b0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-000250c0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-000250d0: 6166 7261 6d65 285b 312c 2033 2e31 2c20  aframe([1, 3.1, 
-000250e0: 2774 6573 7427 5d2c 2073 6368 656d 613d  'test'], schema=
-000250f0: 7363 6865 6d61 290a 2020 2020 2020 2020  schema).        
-00025100: 3e3e 3e20 6466 2e73 656c 6563 7428 7479  >>> df.select(ty
-00025110: 7065 6f66 2863 6f6c 2822 4122 2929 2e61  peof(col("A")).a
-00025120: 735f 2822 616e 7322 2929 2e63 6f6c 6c65  s_("ans")).colle
-00025130: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-00025140: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
-00025150: 2c20 526f 7728 414e 533d 2744 4543 494d  , Row(ANS='DECIM
-00025160: 414c 2729 2c20 526f 7728 414e 533d 2756  AL'), Row(ANS='V
-00025170: 4152 4348 4152 2729 5d0a 0a20 2020 2022  ARCHAR')]..    "
-00025180: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00025190: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-000251a0: 7479 7065 6f66 2229 0a20 2020 2072 6574  typeof").    ret
-000251b0: 7572 6e20 6275 696c 7469 6e28 2274 7970  urn builtin("typ
-000251c0: 656f 6622 2928 6329 0a0a 0a64 6566 2063  eof")(c)...def c
-000251d0: 6865 636b 5f6a 736f 6e28 636f 6c3a 2043  heck_json(col: C
-000251e0: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-000251f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-00025200: 6865 636b 7320 7468 6520 7661 6c69 6469  hecks the validi
-00025210: 7479 206f 6620 6120 4a53 4f4e 2064 6f63  ty of a JSON doc
-00025220: 756d 656e 742e 0a20 2020 2049 6620 7468  ument..    If th
-00025230: 6520 696e 7075 7420 7374 7269 6e67 2069  e input string i
-00025240: 7320 6120 7661 6c69 6420 4a53 4f4e 2064  s a valid JSON d
-00025250: 6f63 756d 656e 7420 6f72 2061 204e 554c  ocument or a NUL
-00025260: 4c20 2869 2e65 2e20 6e6f 2065 7272 6f72  L (i.e. no error
-00025270: 2077 6f75 6c64 206f 6363 7572 2077 6865   would occur whe
-00025280: 6e0a 2020 2020 7061 7273 696e 6720 7468  n.    parsing th
-00025290: 6520 696e 7075 7420 7374 7269 6e67 292c  e input string),
-000252a0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-000252b0: 7475 726e 7320 4e55 4c4c 2e0a 2020 2020  turns NULL..    
-000252c0: 496e 2063 6173 6520 6f66 2061 204a 534f  In case of a JSO
-000252d0: 4e20 7061 7273 696e 6720 6572 726f 722c  N parsing error,
-000252e0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
-000252f0: 7475 726e 7320 6120 7374 7269 6e67 2074  turns a string t
-00025300: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
-00025310: 2065 7272 6f72 0a20 2020 206d 6573 7361   error.    messa
-00025320: 6765 2e0a 0a20 2020 2045 7861 6d70 6c65  ge...    Example
-00025330: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00025340: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00025350: 6174 655f 6461 7461 6672 616d 6528 5b22  ate_dataframe(["
-00025360: 7b27 5661 6c69 644b 6579 3127 3a20 2756  {'ValidKey1': 'V
-00025370: 616c 6964 5661 6c75 6531 277d 222c 2022  alidValue1'}", "
-00025380: 7b27 4d61 6c66 6f72 6d65 6420 2d2d 206d  {'Malformed -- m
-00025390: 6973 7369 6e67 2076 616c 273a 7d22 2c20  issing val':}", 
-000253a0: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b27  None], schema=['
-000253b0: 6127 5d29 0a20 2020 2020 2020 203e 3e3e  a']).        >>>
-000253c0: 2064 662e 7365 6c65 6374 2863 6865 636b   df.select(check
-000253d0: 5f6a 736f 6e28 6466 2e61 2929 2e73 686f  _json(df.a)).sho
-000253e0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-000253f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00025400: 2d2d 2d0a 2020 2020 2020 2020 7c22 4348  ---.        |"CH
-00025410: 4543 4b5f 4a53 4f4e 2822 2241 2222 2922  ECK_JSON(""A"")"
-00025420: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00025430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00025440: 2d2d 2d0a 2020 2020 2020 2020 7c4e 554c  ---.        |NUL
-00025450: 4c20 2020 2020 2020 2020 2020 2020 2020  L               
-00025460: 2020 7c0a 2020 2020 2020 2020 7c6d 6973    |.        |mis
-00025470: 706c 6163 6564 207d 2c20 706f 7320 3239  placed }, pos 29
-00025480: 2020 7c0a 2020 2020 2020 2020 7c4e 554c    |.        |NUL
-00025490: 4c20 2020 2020 2020 2020 2020 2020 2020  L               
-000254a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000254b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000254c0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-000254d0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-000254e0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-000254f0: 6966 5f73 7472 2863 6f6c 2c20 2263 6865  if_str(col, "che
-00025500: 636b 5f6a 736f 6e22 290a 2020 2020 7265  ck_json").    re
-00025510: 7475 726e 2062 7569 6c74 696e 2822 6368  turn builtin("ch
-00025520: 6563 6b5f 6a73 6f6e 2229 2863 290a 0a0a  eck_json")(c)...
-00025530: 6465 6620 6368 6563 6b5f 786d 6c28 636f  def check_xml(co
-00025540: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
-00025550: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00025560: 2222 2243 6865 636b 7320 7468 6520 7661  """Checks the va
-00025570: 6c69 6469 7479 206f 6620 616e 2058 4d4c  lidity of an XML
-00025580: 2064 6f63 756d 656e 742e 0a20 2020 2049   document..    I
-00025590: 6620 7468 6520 696e 7075 7420 7374 7269  f the input stri
-000255a0: 6e67 2069 7320 6120 7661 6c69 6420 584d  ng is a valid XM
-000255b0: 4c20 646f 6375 6d65 6e74 206f 7220 6120  L document or a 
-000255c0: 4e55 4c4c 2028 692e 652e 206e 6f20 6572  NULL (i.e. no er
-000255d0: 726f 7220 776f 756c 6420 6f63 6375 7220  ror would occur 
-000255e0: 7768 656e 2070 6172 7369 6e67 0a20 2020  when parsing.   
-000255f0: 2074 6865 2069 6e70 7574 2073 7472 696e   the input strin
-00025600: 6729 2c20 7468 6520 6675 6e63 7469 6f6e  g), the function
-00025610: 2072 6574 7572 6e73 204e 554c 4c2e 0a20   returns NULL.. 
-00025620: 2020 2049 6e20 6361 7365 206f 6620 616e     In case of an
-00025630: 2058 4d4c 2070 6172 7369 6e67 2065 7272   XML parsing err
-00025640: 6f72 2c20 7468 6520 6f75 7470 7574 2073  or, the output s
-00025650: 7472 696e 6720 636f 6e74 6169 6e73 2074  tring contains t
-00025660: 6865 2065 7272 6f72 206d 6573 7361 6765  he error message
-00025670: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00025680: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-00025690: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-000256a0: 655f 6461 7461 6672 616d 6528 5b22 3c6e  e_dataframe(["<n
-000256b0: 616d 653e 2056 616c 6964 203c 2f6e 616d  ame> Valid </nam
-000256c0: 653e 222c 2022 3c6e 616d 653e 2049 6e76  e>", "<name> Inv
-000256d0: 616c 6964 203c 2f57 524f 4e47 5f43 4c4f  alid </WRONG_CLO
-000256e0: 5349 4e47 5f54 4147 3e22 2c20 4e6f 6e65  SING_TAG>", None
-000256f0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
-00025700: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00025710: 7365 6c65 6374 2863 6865 636b 5f78 6d6c  select(check_xml
-00025720: 2864 662e 6129 292e 7368 6f77 2829 0a20  (df.a)).show(). 
-00025730: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00025740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00025750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00025760: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00025770: 2020 207c 2243 4845 434b 5f58 4d4c 2822     |"CHECK_XML("
-00025780: 2241 2222 2922 2020 2020 2020 2020 2020  "A"")"          
-00025790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000257a0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-000257b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000257c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000257d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000257e0: 2d2d 0a20 2020 2020 2020 207c 4e55 4c4c  --.        |NULL
-000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025810: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-00025820: 2020 2020 2020 207c 6e6f 206f 7065 6e69         |no openi
-00025830: 6e67 2074 6167 2066 6f72 203c 2f57 524f  ng tag for </WRO
-00025840: 4e47 5f43 4c4f 5349 4e47 5f54 4147 3e2c  NG_CLOSING_TAG>,
-00025850: 2070 6f73 2033 3520 207c 0a20 2020 2020   pos 35  |.     
-00025860: 2020 207c 4e55 4c4c 2020 2020 2020 2020     |NULL        
-00025870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025890: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-000258a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000258b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000258c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000258d0: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-000258e0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-000258f0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
-00025900: 665f 7374 7228 636f 6c2c 2022 6368 6563  f_str(col, "chec
-00025910: 6b5f 786d 6c22 290a 2020 2020 7265 7475  k_xml").    retu
-00025920: 726e 2062 7569 6c74 696e 2822 6368 6563  rn builtin("chec
-00025930: 6b5f 786d 6c22 2928 6329 0a0a 0a64 6566  k_xml")(c)...def
-00025940: 206a 736f 6e5f 6578 7472 6163 745f 7061   json_extract_pa
-00025950: 7468 5f74 6578 7428 636f 6c3a 2043 6f6c  th_text(col: Col
-00025960: 756d 6e4f 724e 616d 652c 2070 6174 683a  umnOrName, path:
-00025970: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-00025980: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-00025990: 220a 2020 2020 5061 7273 6573 2061 204a  ".    Parses a J
-000259a0: 534f 4e20 7374 7269 6e67 2061 6e64 2072  SON string and r
-000259b0: 6574 7572 6e73 2074 6865 2076 616c 7565  eturns the value
-000259c0: 206f 6620 616e 2065 6c65 6d65 6e74 2061   of an element a
-000259d0: 7420 6120 7370 6563 6966 6965 6420 7061  t a specified pa
-000259e0: 7468 2069 6e20 7468 6520 7265 7375 6c74  th in the result
-000259f0: 696e 670a 2020 2020 4a53 4f4e 2064 6f63  ing.    JSON doc
-00025a00: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
-00025a10: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00025a20: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00025a30: 652e 736e 6f77 7061 726b 2e66 756e 6374  e.snowpark.funct
-00025a40: 696f 6e73 2069 6d70 6f72 7420 6a73 6f6e  ions import json
-00025a50: 5f65 7874 7261 6374 5f70 6174 685f 7465  _extract_path_te
-00025a60: 7874 2c20 746f 5f76 6172 6961 6e74 0a20  xt, to_variant. 
-00025a70: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00025a80: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00025a90: 6174 6166 7261 6d65 285b 5b7b 2261 223a  ataframe([[{"a":
-00025aa0: 2022 666f 6f22 7d2c 2022 6122 5d2c 205b   "foo"}, "a"], [
-00025ab0: 7b22 6122 3a20 4e6f 6e65 7d2c 2022 6122  {"a": None}, "a"
-00025ac0: 5d2c 205b 7b22 6122 3a20 2266 6f6f 227d  ], [{"a": "foo"}
-00025ad0: 2c20 2262 225d 2c20 5b4e 6f6e 652c 2022  , "b"], [None, "
-00025ae0: 6122 5d5d 2c20 7363 6865 6d61 3d5b 226b  a"]], schema=["k
-00025af0: 222c 2022 7622 5d29 0a20 2020 2020 2020  ", "v"]).       
-00025b00: 203e 3e3e 2064 662e 7365 6c65 6374 286a   >>> df.select(j
-00025b10: 736f 6e5f 6578 7472 6163 745f 7061 7468  son_extract_path
-00025b20: 5f74 6578 7428 746f 5f76 6172 6961 6e74  _text(to_variant
-00025b30: 2822 6b22 292c 2022 7622 292e 6173 5f28  ("k"), "v").as_(
-00025b40: 2272 6573 2229 292e 636f 6c6c 6563 7428  "res")).collect(
-00025b50: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
-00025b60: 4553 3d27 666f 6f27 292c 2052 6f77 2852  ES='foo'), Row(R
-00025b70: 4553 3d4e 6f6e 6529 2c20 526f 7728 5245  ES=None), Row(RE
-00025b80: 533d 4e6f 6e65 292c 2052 6f77 2852 4553  S=None), Row(RES
-00025b90: 3d4e 6f6e 6529 5d0a 2020 2020 2222 220a  =None)].    """.
-00025ba0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00025bb0: 6966 5f73 7472 2863 6f6c 2c20 226a 736f  if_str(col, "jso
-00025bc0: 6e5f 6578 7472 6163 745f 7061 7468 5f74  n_extract_path_t
-00025bd0: 6578 7422 290a 2020 2020 7020 3d20 5f74  ext").    p = _t
-00025be0: 6f5f 636f 6c5f 6966 5f73 7472 2870 6174  o_col_if_str(pat
-00025bf0: 682c 2022 6a73 6f6e 5f65 7874 7261 6374  h, "json_extract
-00025c00: 5f70 6174 685f 7465 7874 2229 0a20 2020  _path_text").   
-00025c10: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00025c20: 226a 736f 6e5f 6578 7472 6163 745f 7061  "json_extract_pa
-00025c30: 7468 5f74 6578 7422 2928 632c 2070 290a  th_text")(c, p).
-00025c40: 0a0a 6465 6620 7061 7273 655f 6a73 6f6e  ..def parse_json
-00025c50: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-00025c60: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00025c70: 2022 2222 5061 7273 6520 7468 6520 7661   """Parse the va
-00025c80: 6c75 6520 6f66 2074 6865 2073 7065 6369  lue of the speci
-00025c90: 6669 6564 2063 6f6c 756d 6e20 6173 2061  fied column as a
-00025ca0: 204a 534f 4e20 7374 7269 6e67 2061 6e64   JSON string and
-00025cb0: 2072 6574 7572 6e73 2074 6865 0a20 2020   returns the.   
-00025cc0: 2072 6573 756c 7469 6e67 204a 534f 4e20   resulting JSON 
-00025cd0: 646f 6375 6d65 6e74 2e0a 0a20 2020 2045  document...    E
-00025ce0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00025cf0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00025d00: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00025d10: 616d 6528 5b5b 277b 226b 6579 223a 2022  ame([['{"key": "
-00025d20: 3122 7d27 5d5d 2c20 7363 6865 6d61 3d5b  1"}']], schema=[
-00025d30: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
-00025d40: 3e20 6466 2e73 656c 6563 7428 7061 7273  > df.select(pars
-00025d50: 655f 6a73 6f6e 2864 665b 2261 225d 292e  e_json(df["a"]).
-00025d60: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00025d70: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00025d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00025d90: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00025da0: 5422 2020 2020 2020 7c0a 2020 2020 2020  T"      |.      
-00025db0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00025dc0: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
-00025dd0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00025de0: 2020 2020 7c20 2022 6b65 7922 3a20 2231      |  "key": "1
-00025df0: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
-00025e00: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-00025e10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00025e20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00025e30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00025e40: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00025e50: 6f6c 5f69 665f 7374 7228 652c 2022 7061  ol_if_str(e, "pa
-00025e60: 7273 655f 6a73 6f6e 2229 0a20 2020 2072  rse_json").    r
-00025e70: 6574 7572 6e20 6275 696c 7469 6e28 2270  eturn builtin("p
-00025e80: 6172 7365 5f6a 736f 6e22 2928 6329 0a0a  arse_json")(c)..
-00025e90: 0a64 6566 2070 6172 7365 5f78 6d6c 2865  .def parse_xml(e
-00025ea0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-00025eb0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00025ec0: 2222 5061 7273 6520 7468 6520 7661 6c75  ""Parse the valu
-00025ed0: 6520 6f66 2074 6865 2073 7065 6369 6669  e of the specifi
-00025ee0: 6564 2063 6f6c 756d 6e20 6173 2061 204a  ed column as a J
-00025ef0: 534f 4e20 7374 7269 6e67 2061 6e64 2072  SON string and r
-00025f00: 6574 7572 6e73 2074 6865 0a20 2020 2072  eturns the.    r
-00025f10: 6573 756c 7469 6e67 2058 4d4c 2064 6f63  esulting XML doc
-00025f20: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
-00025f30: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-00025f40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00025f50: 7371 6c28 0a20 2020 2020 2020 202e 2e2e  sql(.        ...
-00025f60: 2020 2020 2022 7365 6c65 6374 2028 636f       "select (co
-00025f70: 6c75 6d6e 3129 2061 7320 7620 6672 6f6d  lumn1) as v from
-00025f80: 2076 616c 7565 7320 2827 3c74 313e 666f   values ('<t1>fo
-00025f90: 6f3c 7432 3e62 6172 3c2f 7432 3e3c 7433  o<t2>bar</t2><t3
-00025fa0: 3e3c 2f74 333e 3c2f 7431 3e27 292c 2022  ></t3></t1>'), "
-00025fb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00025fc0: 2022 2827 3c74 313e 3c2f 7431 3e27 2922   "('<t1></t1>')"
-00025fd0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-00025fe0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-00025ff0: 6c65 6374 2870 6172 7365 5f78 6d6c 2822  lect(parse_xml("
-00026000: 7622 292e 616c 6961 7328 2272 6573 756c  v").alias("resul
-00026010: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
-00026020: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00026030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00026040: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
-00026050: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00026060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00026070: 2020 2020 207c 3c74 313e 2020 2020 2020       |<t1>      
-00026080: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00026090: 7c20 2066 6f6f 2020 2020 2020 2020 2020  |  foo          
-000260a0: 207c 0a20 2020 2020 2020 207c 2020 3c74   |.        |  <t
-000260b0: 323e 6261 723c 2f74 323e 2020 7c0a 2020  2>bar</t2>  |.  
-000260c0: 2020 2020 2020 7c20 203c 7433 3e3c 2f74        |  <t3></t
-000260d0: 333e 2020 2020 207c 0a20 2020 2020 2020  3>     |.       
-000260e0: 207c 3c2f 7431 3e20 2020 2020 2020 2020   |</t1>         
-000260f0: 2020 7c0a 2020 2020 2020 2020 7c3c 7431    |.        |<t1
-00026100: 3e3c 2f74 313e 2020 2020 2020 207c 0a20  ></t1>       |. 
-00026110: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00026120: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00026130: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00026140: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-00026150: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-00026160: 2270 6172 7365 5f78 6d6c 2229 0a20 2020  "parse_xml").   
-00026170: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
-00026180: 2270 6172 7365 5f78 6d6c 2229 2863 290a  "parse_xml")(c).
-00026190: 0a0a 6465 6620 7374 7269 705f 6e75 6c6c  ..def strip_null
-000261a0: 5f76 616c 7565 2863 6f6c 3a20 436f 6c75  _value(col: Colu
-000261b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-000261c0: 756d 6e3a 0a20 2020 2022 2222 436f 6e76  umn:.    """Conv
-000261d0: 6572 7473 2061 204a 534f 4e20 226e 756c  erts a JSON "nul
-000261e0: 6c22 2076 616c 7565 2069 6e20 7468 6520  l" value in the 
-000261f0: 7370 6563 6966 6965 6420 636f 6c75 6d6e  specified column
-00026200: 2074 6f20 6120 5351 4c20 4e55 4c4c 2076   to a SQL NULL v
-00026210: 616c 7565 2e0a 2020 2020 416c 6c20 6f74  alue..    All ot
-00026220: 6865 7220 5641 5249 414e 5420 7661 6c75  her VARIANT valu
-00026230: 6573 2069 6e20 7468 6520 636f 6c75 6d6e  es in the column
-00026240: 2061 7265 2072 6574 7572 6e65 6420 756e   are returned un
-00026250: 6368 616e 6765 642e 0a0a 2020 2020 4578  changed...    Ex
-00026260: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00026270: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00026280: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00026290: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
-000262a0: 2020 205b 226e 756c 6c22 2c20 2231 225d     ["null", "1"]
-000262b0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-000262c0: 2020 7363 6865 6d61 3d5b 2253 225d 2c0a    schema=["S"],.
-000262d0: 2020 2020 2020 2020 2e2e 2e20 292e 7365          ... ).se
-000262e0: 6c65 6374 2873 7472 6970 5f6e 756c 6c5f  lect(strip_null_
-000262f0: 7661 6c75 6528 7061 7273 655f 6a73 6f6e  value(parse_json
-00026300: 2863 6f6c 2822 5322 2929 292e 6173 5f28  (col("S"))).as_(
-00026310: 2242 2229 292e 7768 6572 6528 0a20 2020  "B")).where(.   
-00026320: 2020 2020 202e 2e2e 2020 2020 2073 716c       ...     sql
-00026330: 5f65 7870 7228 2242 2069 7320 6e75 6c6c  _expr("B is null
-00026340: 2229 0a20 2020 2020 2020 202e 2e2e 2029  ").        ... )
-00026350: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00026360: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00026370: 2020 5b52 6f77 2842 3d4e 6f6e 6529 5d0a    [Row(B=None)].
-00026380: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00026390: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-000263a0: 6f6c 2c20 2273 7472 6970 5f6e 756c 6c5f  ol, "strip_null_
-000263b0: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
-000263c0: 726e 2062 7569 6c74 696e 2822 7374 7269  rn builtin("stri
-000263d0: 705f 6e75 6c6c 5f76 616c 7565 2229 2863  p_null_value")(c
-000263e0: 290a 0a0a 6465 6620 6172 7261 795f 6167  )...def array_ag
-000263f0: 6728 636f 6c3a 2043 6f6c 756d 6e4f 724e  g(col: ColumnOrN
-00026400: 616d 652c 2069 735f 6469 7374 696e 6374  ame, is_distinct
-00026410: 3a20 626f 6f6c 203d 2046 616c 7365 2920  : bool = False) 
-00026420: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-00026430: 2222 5265 7475 726e 7320 7468 6520 696e  ""Returns the in
-00026440: 7075 7420 7661 6c75 6573 2c20 7069 766f  put values, pivo
-00026450: 7465 6420 696e 746f 2061 6e20 4152 5241  ted into an ARRA
-00026460: 592e 2049 6620 7468 6520 696e 7075 7420  Y. If the input 
-00026470: 6973 2065 6d70 7479 2c20 616e 2065 6d70  is empty, an emp
-00026480: 7479 0a20 2020 2041 5252 4159 2069 7320  ty.    ARRAY is 
-00026490: 7265 7475 726e 6564 2e0a 0a20 2020 2045  returned...    E
-000264a0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-000264b0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000264c0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000264d0: 6d65 285b 5b31 5d2c 205b 325d 2c20 5b33  me([[1], [2], [3
-000264e0: 5d2c 205b 315d 5d2c 2073 6368 656d 613d  ], [1]], schema=
-000264f0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
-00026500: 3e3e 2064 662e 7365 6c65 6374 2861 7272  >> df.select(arr
-00026510: 6179 5f61 6767 2822 6122 2c20 5472 7565  ay_agg("a", True
-00026520: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00026530: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00026540: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00026550: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00026560: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00026570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00026580: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
-00026590: 2020 2020 2020 7c20 2031 2c20 2020 2020        |  1,     
-000265a0: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
-000265b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-000265c0: 7c20 2033 2020 2020 2020 207c 0a20 2020  |  3       |.   
-000265d0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
-000265e0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-000265f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00026600: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00026610: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-00026620: 6f6c 5f69 665f 7374 7228 636f 6c2c 2022  ol_if_str(col, "
-00026630: 6172 7261 795f 6167 6722 290a 2020 2020  array_agg").    
-00026640: 7265 7475 726e 205f 6361 6c6c 5f66 756e  return _call_fun
-00026650: 6374 696f 6e28 2261 7272 6179 5f61 6767  ction("array_agg
-00026660: 222c 2069 735f 6469 7374 696e 6374 2c20  ", is_distinct, 
-00026670: 6329 0a0a 0a64 6566 2061 7272 6179 5f61  c)...def array_a
-00026680: 7070 656e 6428 6172 7261 793a 2043 6f6c  ppend(array: Col
-00026690: 756d 6e4f 724e 616d 652c 2065 6c65 6d65  umnOrName, eleme
-000266a0: 6e74 3a20 436f 6c75 6d6e 4f72 4e61 6d65  nt: ColumnOrName
-000266b0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-000266c0: 2022 2222 5265 7475 726e 7320 616e 2041   """Returns an A
-000266d0: 5252 4159 2063 6f6e 7461 696e 696e 6720  RRAY containing 
-000266e0: 616c 6c20 656c 656d 656e 7473 2066 726f  all elements fro
-000266f0: 6d20 7468 6520 736f 7572 6365 2041 5252  m the source ARR
-00026700: 4159 2061 7320 7765 6c6c 2061 7320 7468  AY as well as th
-00026710: 6520 6e65 7720 656c 656d 656e 742e 0a20  e new element.. 
-00026720: 2020 2054 6865 206e 6577 2065 6c65 6d65     The new eleme
-00026730: 6e74 2069 7320 6c6f 6361 7465 6420 6174  nt is located at
-00026740: 2065 6e64 206f 6620 7468 6520 4152 5241   end of the ARRA
-00026750: 592e 0a0a 2020 2020 4172 6773 3a0a 2020  Y...    Args:.  
-00026760: 2020 2020 2020 6172 7261 793a 2054 6865        array: The
-00026770: 2063 6f6c 756d 6e20 636f 6e74 6169 6e69   column containi
-00026780: 6e67 2074 6865 2073 6f75 7263 6520 4152  ng the source AR
-00026790: 5241 592e 0a20 2020 2020 2020 2065 6c65  RAY..        ele
-000267a0: 6d65 6e74 3a20 5468 6520 636f 6c75 6d6e  ment: The column
-000267b0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000267c0: 656c 656d 656e 7420 746f 2062 6520 6170  element to be ap
-000267d0: 7065 6e64 6564 2e20 5468 6520 656c 656d  pended. The elem
-000267e0: 656e 7420 6d61 7920 6265 206f 6620 616c  ent may be of al
-000267f0: 6d6f 7374 0a20 2020 2020 2020 2020 2020  most.           
-00026800: 2061 6e79 2064 6174 6120 7479 7065 2e20   any data type. 
-00026810: 5468 6520 6461 7461 2074 7970 6520 646f  The data type do
-00026820: 6573 206e 6f74 206e 6565 6420 746f 206d  es not need to m
-00026830: 6174 6368 2074 6865 2064 6174 6120 7479  atch the data ty
-00026840: 7065 2873 2920 6f66 2074 6865 0a20 2020  pe(s) of the.   
-00026850: 2020 2020 2020 2020 2065 7869 7374 696e           existin
-00026860: 6720 656c 656d 656e 7473 2069 6e20 7468  g elements in th
-00026870: 6520 4152 5241 592e 0a0a 2020 2020 4578  e ARRAY...    Ex
-00026880: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-00026890: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000268a0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
-000268b0: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
-000268c0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-000268d0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-000268e0: 285b 526f 7728 613d 5b31 2c20 322c 2033  ([Row(a=[1, 2, 3
-000268f0: 5d29 5d29 0a20 2020 2020 2020 203e 3e3e  ])]).        >>>
-00026900: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
-00026910: 5f61 7070 656e 6428 2261 222c 206c 6974  _append("a", lit
-00026920: 2834 2929 2e61 6c69 6173 2822 7265 7375  (4)).alias("resu
-00026930: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00026940: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00026950: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00026960: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00026970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00026980: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
-00026990: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
-000269a0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-000269b0: 2032 2c20 2020 2020 207c 0a20 2020 2020   2,      |.     
-000269c0: 2020 207c 2020 332c 2020 2020 2020 7c0a     |  3,      |.
-000269d0: 2020 2020 2020 2020 7c20 2034 2020 2020          |  4    
-000269e0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-000269f0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00026a00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00026a10: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-00026a20: 453e 0a20 2020 2022 2222 0a20 2020 2061  E>.    """.    a
-00026a30: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00026a40: 7228 6172 7261 792c 2022 6172 7261 795f  r(array, "array_
-00026a50: 6170 7065 6e64 2229 0a20 2020 2065 203d  append").    e =
-00026a60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-00026a70: 656c 656d 656e 742c 2022 6172 7261 795f  element, "array_
-00026a80: 6170 7065 6e64 2229 0a20 2020 2072 6574  append").    ret
-00026a90: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
-00026aa0: 6179 5f61 7070 656e 6422 2928 612c 2065  ay_append")(a, e
-00026ab0: 290a 0a0a 6465 6620 6172 7261 795f 6361  )...def array_ca
-00026ac0: 7428 6172 7261 7931 3a20 436f 6c75 6d6e  t(array1: Column
-00026ad0: 4f72 4e61 6d65 2c20 6172 7261 7932 3a20  OrName, array2: 
-00026ae0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00026af0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00026b00: 5265 7475 726e 7320 7468 6520 636f 6e63  Returns the conc
-00026b10: 6174 656e 6174 696f 6e20 6f66 2074 776f  atenation of two
-00026b20: 2041 5252 4159 732e 0a0a 2020 2020 4172   ARRAYs...    Ar
-00026b30: 6773 3a0a 2020 2020 2020 2020 6172 7261  gs:.        arra
-00026b40: 7931 3a20 436f 6c75 6d6e 2063 6f6e 7461  y1: Column conta
-00026b50: 696e 696e 6720 7468 6520 736f 7572 6365  ining the source
-00026b60: 2041 5252 4159 2e0a 2020 2020 2020 2020   ARRAY..        
-00026b70: 6172 7261 7932 3a20 436f 6c75 6d6e 2063  array2: Column c
-00026b80: 6f6e 7461 696e 696e 6720 7468 6520 4152  ontaining the AR
-00026b90: 5241 5920 746f 2062 6520 6170 7065 6e64  RAY to be append
-00026ba0: 6564 2074 6f20 6172 7261 7931 2e0a 0a20  ed to array1... 
-00026bb0: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-00026bc0: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00026bd0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00026be0: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
-00026bf0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-00026c00: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-00026c10: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
-00026c20: 2032 2c20 335d 2c20 623d 5b34 2c20 355d   2, 3], b=[4, 5]
-00026c30: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
-00026c40: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
-00026c50: 6361 7428 2261 222c 2022 6222 292e 616c  cat("a", "b").al
-00026c60: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-00026c70: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00026c80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00026c90: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-00026ca0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00026cb0: 2d2d 2d2d 0a20 2020 2020 2020 207c 5b20  ----.        |[ 
-00026cc0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00026cd0: 2020 7c20 2031 2c20 2020 2020 207c 0a20    |  1,      |. 
-00026ce0: 2020 2020 2020 207c 2020 322c 2020 2020         |  2,    
-00026cf0: 2020 7c0a 2020 2020 2020 2020 7c20 2033    |.        |  3
-00026d00: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-00026d10: 207c 2020 342c 2020 2020 2020 7c0a 2020   |  4,      |.  
-00026d20: 2020 2020 2020 7c20 2035 2020 2020 2020        |  5      
-00026d30: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
-00026d40: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00026d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00026d60: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-00026d70: 0a20 2020 2022 2222 0a20 2020 2061 3120  .    """.    a1 
-00026d80: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00026d90: 2861 7272 6179 312c 2022 6172 7261 795f  (array1, "array_
-00026da0: 6361 7422 290a 2020 2020 6132 203d 205f  cat").    a2 = _
-00026db0: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
-00026dc0: 7261 7932 2c20 2261 7272 6179 5f63 6174  ray2, "array_cat
-00026dd0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-00026de0: 696c 7469 6e28 2261 7272 6179 5f63 6174  iltin("array_cat
-00026df0: 2229 2861 312c 2061 3229 0a0a 0a64 6566  ")(a1, a2)...def
-00026e00: 2061 7272 6179 5f63 6f6d 7061 6374 2861   array_compact(a
-00026e10: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
-00026e20: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-00026e30: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-00026e40: 636f 6d70 6163 7465 6420 4152 5241 5920  compacted ARRAY 
-00026e50: 7769 7468 206d 6973 7369 6e67 2061 6e64  with missing and
-00026e60: 206e 756c 6c20 7661 6c75 6573 2072 656d   null values rem
-00026e70: 6f76 6564 2c0a 2020 2020 6566 6665 6374  oved,.    effect
-00026e80: 6976 656c 7920 636f 6e76 6572 7469 6e67  ively converting
-00026e90: 2073 7061 7273 6520 6172 7261 7973 2069   sparse arrays i
-00026ea0: 6e74 6f20 6465 6e73 6520 6172 7261 7973  nto dense arrays
-00026eb0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00026ec0: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
-00026ed0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
-00026ee0: 6520 736f 7572 6365 2041 5252 4159 2074  e source ARRAY t
-00026ef0: 6f20 6265 2063 6f6d 7061 6374 6564 0a0a  o be compacted..
-00026f00: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-00026f10: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00026f20: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00026f30: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
-00026f40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00026f50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00026f60: 6166 7261 6d65 285b 526f 7728 613d 5b31  aframe([Row(a=[1
-00026f70: 2c20 4e6f 6e65 2c20 335d 295d 290a 2020  , None, 3])]).  
-00026f80: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00026f90: 6563 7428 2261 222c 2061 7272 6179 5f63  ect("a", array_c
-00026fa0: 6f6d 7061 6374 2822 6122 292e 616c 6961  ompact("a").alia
-00026fb0: 7328 2263 6f6d 7061 6374 6564 2229 292e  s("compacted")).
-00026fc0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-00026fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00026fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00026ff0: 207c 2241 2220 2020 2020 207c 2243 4f4d   |"A"      |"COM
-00027000: 5041 4354 4544 2220 207c 0a20 2020 2020  PACTED"  |.     
-00027010: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00027020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00027030: 2020 2020 207c 5b20 2020 2020 2020 207c       |[        |
-00027040: 5b20 2020 2020 2020 2020 2020 207c 0a20  [            |. 
-00027050: 2020 2020 2020 207c 2020 312c 2020 2020         |  1,    
-00027060: 207c 2020 312c 2020 2020 2020 2020 207c   |  1,         |
-00027070: 0a20 2020 2020 2020 207c 2020 6e75 6c6c  .        |  null
-00027080: 2c20 207c 2020 3320 2020 2020 2020 2020  ,  |  3         
-00027090: 207c 0a20 2020 2020 2020 207c 2020 3320   |.        |  3 
-000270a0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
-000270b0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-000270c0: 2020 2020 2020 207c 2020 2020 2020 2020         |        
-000270d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-000270e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000270f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00027100: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
-00027110: 2022 2222 0a20 2020 2061 203d 205f 746f   """.    a = _to
-00027120: 5f63 6f6c 5f69 665f 7374 7228 6172 7261  _col_if_str(arra
-00027130: 792c 2022 6172 7261 795f 636f 6d70 6163  y, "array_compac
-00027140: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
-00027150: 7569 6c74 696e 2822 6172 7261 795f 636f  uiltin("array_co
-00027160: 6d70 6163 7422 2928 6129 0a0a 0a64 6566  mpact")(a)...def
-00027170: 2061 7272 6179 5f63 6f6e 7374 7275 6374   array_construct
-00027180: 282a 636f 6c73 3a20 436f 6c75 6d6e 4f72  (*cols: ColumnOr
-00027190: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-000271a0: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-000271b0: 616e 2041 5252 4159 2063 6f6e 7374 7275  an ARRAY constru
-000271c0: 6374 6564 2066 726f 6d20 7a65 726f 2c20  cted from zero, 
-000271d0: 6f6e 652c 206f 7220 6d6f 7265 2069 6e70  one, or more inp
-000271e0: 7574 732e 0a0a 2020 2020 4172 6773 3a0a  uts...    Args:.
-000271f0: 2020 2020 2020 2020 636f 6c73 3a20 436f          cols: Co
-00027200: 6c75 6d6e 7320 636f 6e74 6169 6e69 6e67  lumns containing
-00027210: 2074 6865 2076 616c 7565 7320 286f 7220   the values (or 
-00027220: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
-00027230: 2065 7661 6c75 6174 6520 746f 2076 616c   evaluate to val
-00027240: 7565 7329 2e20 5468 650a 2020 2020 2020  ues). The.      
-00027250: 2020 2020 2020 7661 6c75 6573 2064 6f20        values do 
-00027260: 6e6f 7420 616c 6c20 6e65 6564 2074 6f20  not all need to 
-00027270: 6265 206f 6620 7468 6520 7361 6d65 2064  be of the same d
-00027280: 6174 6120 7479 7065 2e0a 0a20 2020 2045  ata type...    E
-00027290: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-000272a0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-000272b0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-000272c0: 6d65 285b 5b31 2c20 325d 2c20 5b33 2c20  me([[1, 2], [3, 
-000272d0: 345d 5d2c 2073 6368 656d 613d 5b22 6122  4]], schema=["a"
-000272e0: 2c20 2262 225d 290a 2020 2020 2020 2020  , "b"]).        
-000272f0: 3e3e 3e20 6466 2e73 656c 6563 7428 6172  >>> df.select(ar
-00027300: 7261 795f 636f 6e73 7472 7563 7428 2261  ray_construct("a
-00027310: 222c 2022 6222 292e 616c 6961 7328 2272  ", "b").alias("r
-00027320: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
-00027330: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00027340: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-00027350: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
-00027360: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00027370: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
-00027380: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
-00027390: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-000273a0: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
-000273b0: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
-000273c0: 207c 0a20 2020 2020 2020 207c 5b20 2020   |.        |[   
-000273d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-000273e0: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
-000273f0: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
-00027400: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00027410: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00027420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00027430: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00027440: 2020 2020 2222 220a 2020 2020 6373 203d      """.    cs =
-00027450: 205b 5f74 6f5f 636f 6c5f 6966 5f73 7472   [_to_col_if_str
-00027460: 2863 2c20 2261 7272 6179 5f63 6f6e 7374  (c, "array_const
-00027470: 7275 6374 2229 2066 6f72 2063 2069 6e20  ruct") for c in 
-00027480: 636f 6c73 5d0a 2020 2020 7265 7475 726e  cols].    return
-00027490: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
-000274a0: 636f 6e73 7472 7563 7422 2928 2a63 7329  construct")(*cs)
-000274b0: 0a0a 0a64 6566 2061 7272 6179 5f63 6f6e  ...def array_con
-000274c0: 7374 7275 6374 5f63 6f6d 7061 6374 282a  struct_compact(*
-000274d0: 636f 6c73 3a20 436f 6c75 6d6e 4f72 4e61  cols: ColumnOrNa
-000274e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-000274f0: 2020 2022 2222 5265 7475 726e 7320 616e     """Returns an
-00027500: 2041 5252 4159 2063 6f6e 7374 7275 6374   ARRAY construct
-00027510: 6564 2066 726f 6d20 7a65 726f 2c20 6f6e  ed from zero, on
-00027520: 652c 206f 7220 6d6f 7265 2069 6e70 7574  e, or more input
-00027530: 732e 0a20 2020 2054 6865 2063 6f6e 7374  s..    The const
-00027540: 7275 6374 6564 2041 5252 4159 206f 6d69  ructed ARRAY omi
-00027550: 7473 2061 6e79 204e 554c 4c20 696e 7075  ts any NULL inpu
-00027560: 7420 7661 6c75 6573 2e0a 0a20 2020 2041  t values...    A
-00027570: 7267 733a 0a20 2020 2020 2020 2063 6f6c  rgs:.        col
-00027580: 733a 2043 6f6c 756d 6e73 2063 6f6e 7461  s: Columns conta
-00027590: 696e 696e 6720 7468 6520 7661 6c75 6573  ining the values
-000275a0: 2028 6f72 2065 7870 7265 7373 696f 6e73   (or expressions
-000275b0: 2074 6861 7420 6576 616c 7561 7465 2074   that evaluate t
-000275c0: 6f20 7661 6c75 6573 292e 2054 6865 0a20  o values). The. 
-000275d0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-000275e0: 7320 646f 206e 6f74 2061 6c6c 206e 6565  s do not all nee
-000275f0: 6420 746f 2062 6520 6f66 2074 6865 2073  d to be of the s
-00027600: 616d 6520 6461 7461 2074 7970 652e 0a0a  ame data type...
-00027610: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-00027620: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00027630: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00027640: 7461 6672 616d 6528 5b5b 312c 204e 6f6e  taframe([[1, Non
-00027650: 652c 2032 5d2c 205b 332c 204e 6f6e 652c  e, 2], [3, None,
-00027660: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
-00027670: 222c 2022 6222 2c20 2263 225d 290a 2020  ", "b", "c"]).  
-00027680: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00027690: 6563 7428 6172 7261 795f 636f 6e73 7472  ect(array_constr
-000276a0: 7563 745f 636f 6d70 6163 7428 2261 222c  uct_compact("a",
-000276b0: 2022 6222 2c20 2263 2229 2e61 6c69 6173   "b", "c").alias
-000276c0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-000276d0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-000276e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000276f0: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-00027700: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00027710: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
-00027720: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00027730: 2020 312c 2020 2020 2020 7c0a 2020 2020    1,      |.    
-00027740: 2020 2020 7c20 2032 2020 2020 2020 207c      |  2       |
-00027750: 0a20 2020 2020 2020 207c 5d20 2020 2020  .        |]     
-00027760: 2020 2020 7c0a 2020 2020 2020 2020 7c5b      |.        |[
-00027770: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00027780: 2020 207c 2020 332c 2020 2020 2020 7c0a     |  3,      |.
-00027790: 2020 2020 2020 2020 7c20 2034 2020 2020          |  4    
-000277a0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-000277b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000277c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000277d0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000277e0: 453e 0a20 2020 2022 2222 0a20 2020 2063  E>.    """.    c
-000277f0: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
-00027800: 7374 7228 632c 2022 6172 7261 795f 636f  str(c, "array_co
-00027810: 6e73 7472 7563 745f 636f 6d70 6163 7422  nstruct_compact"
-00027820: 2920 666f 7220 6320 696e 2063 6f6c 735d  ) for c in cols]
-00027830: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
-00027840: 7469 6e28 2261 7272 6179 5f63 6f6e 7374  tin("array_const
-00027850: 7275 6374 5f63 6f6d 7061 6374 2229 282a  ruct_compact")(*
-00027860: 6373 290a 0a0a 6465 6620 6172 7261 795f  cs)...def array_
-00027870: 636f 6e74 6169 6e73 2876 6172 6961 6e74  contains(variant
-00027880: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00027890: 6172 7261 793a 2043 6f6c 756d 6e4f 724e  array: ColumnOrN
-000278a0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-000278b0: 2020 2020 2222 2252 6574 7572 6e73 2054      """Returns T
-000278c0: 7275 6520 6966 2074 6865 2073 7065 6369  rue if the speci
-000278d0: 6669 6564 2056 4152 4941 4e54 2069 7320  fied VARIANT is 
-000278e0: 666f 756e 6420 696e 2074 6865 2073 7065  found in the spe
-000278f0: 6369 6669 6564 2041 5252 4159 2e0a 0a20  cified ARRAY... 
-00027900: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00027910: 2076 6172 6961 6e74 3a20 436f 6c75 6d6e   variant: Column
-00027920: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00027930: 5641 5249 414e 5420 746f 2066 696e 642e  VARIANT to find.
-00027940: 0a20 2020 2020 2020 2061 7272 6179 3a20  .        array: 
-00027950: 436f 6c75 6d6e 2063 6f6e 7461 696e 696e  Column containin
-00027960: 6720 7468 6520 4152 5241 5920 746f 2073  g the ARRAY to s
-00027970: 6561 7263 682e 0a0a 2020 2020 4578 616d  earch...    Exam
-00027980: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
-00027990: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
-000279a0: 2e73 6e6f 7770 6172 6b20 696d 706f 7274  .snowpark import
-000279b0: 2052 6f77 0a20 2020 2020 2020 203e 3e3e   Row.        >>>
-000279c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000279d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
-000279e0: 526f 7728 5b31 2c20 325d 292c 2052 6f77  Row([1, 2]), Row
-000279f0: 285b 312c 2033 5d29 5d2c 2073 6368 656d  ([1, 3])], schem
-00027a00: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-00027a10: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-00027a20: 7272 6179 5f63 6f6e 7461 696e 7328 6c69  rray_contains(li
-00027a30: 7428 3229 2c20 2261 2229 2e61 6c69 6173  t(2), "a").alias
-00027a40: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-00027a50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00027a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00027a70: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-00027a80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00027a90: 2d0a 2020 2020 2020 2020 7c54 7275 6520  -.        |True 
-00027aa0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-00027ab0: 4661 6c73 6520 2020 2020 7c0a 2020 2020  False     |.    
-00027ac0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00027ad0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-00027ae0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-00027af0: 2076 203d 205f 746f 5f63 6f6c 5f69 665f   v = _to_col_if_
-00027b00: 7374 7228 7661 7269 616e 742c 2022 6172  str(variant, "ar
-00027b10: 7261 795f 636f 6e74 6169 6e73 2229 0a20  ray_contains"). 
-00027b20: 2020 2061 203d 205f 746f 5f63 6f6c 5f69     a = _to_col_i
-00027b30: 665f 7374 7228 6172 7261 792c 2022 6172  f_str(array, "ar
-00027b40: 7261 795f 636f 6e74 6169 6e73 2229 0a20  ray_contains"). 
-00027b50: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00027b60: 6e28 2261 7272 6179 5f63 6f6e 7461 696e  n("array_contain
-00027b70: 7322 2928 762c 2061 290a 0a0a 6465 6620  s")(v, a)...def 
-00027b80: 6172 7261 795f 696e 7365 7274 280a 2020  array_insert(.  
-00027b90: 2020 6172 7261 793a 2043 6f6c 756d 6e4f    array: ColumnO
-00027ba0: 724e 616d 652c 2070 6f73 3a20 436f 6c75  rName, pos: Colu
-00027bb0: 6d6e 4f72 4e61 6d65 2c20 656c 656d 656e  mnOrName, elemen
-00027bc0: 743a 2043 6f6c 756d 6e4f 724e 616d 650a  t: ColumnOrName.
-00027bd0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-00027be0: 2022 2222 5265 7475 726e 7320 616e 2041   """Returns an A
-00027bf0: 5252 4159 2063 6f6e 7461 696e 696e 6720  RRAY containing 
-00027c00: 616c 6c20 656c 656d 656e 7473 2066 726f  all elements fro
-00027c10: 6d20 7468 6520 736f 7572 6365 2041 5252  m the source ARR
-00027c20: 4159 2061 7320 7765 6c6c 2061 7320 7468  AY as well as th
-00027c30: 6520 6e65 7720 656c 656d 656e 742e 0a0a  e new element...
-00027c40: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00027c50: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
-00027c60: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
-00027c70: 6f75 7263 6520 4152 5241 592e 0a20 2020  ource ARRAY..   
-00027c80: 2020 2020 2070 6f73 3a20 436f 6c75 6d6e       pos: Column
-00027c90: 2063 6f6e 7461 696e 696e 6720 6120 287a   containing a (z
-00027ca0: 6572 6f2d 6261 7365 6429 2070 6f73 6974  ero-based) posit
-00027cb0: 696f 6e20 696e 2074 6865 2073 6f75 7263  ion in the sourc
-00027cc0: 6520 4152 5241 592e 0a20 2020 2020 2020  e ARRAY..       
-00027cd0: 2020 2020 2054 6865 206e 6577 2065 6c65       The new ele
-00027ce0: 6d65 6e74 2069 7320 696e 7365 7274 6564  ment is inserted
-00027cf0: 2061 7420 7468 6973 2070 6f73 6974 696f   at this positio
-00027d00: 6e2e 2054 6865 206f 7269 6769 6e61 6c20  n. The original 
-00027d10: 656c 656d 656e 7420 6672 6f6d 2074 6869  element from thi
-00027d20: 730a 2020 2020 2020 2020 2020 2020 706f  s.            po
-00027d30: 7369 7469 6f6e 2028 6966 2061 6e79 2920  sition (if any) 
-00027d40: 616e 6420 616c 6c20 7375 6273 6571 7565  and all subseque
-00027d50: 6e74 2065 6c65 6d65 6e74 7320 2869 6620  nt elements (if 
-00027d60: 616e 7929 2061 7265 2073 6869 6674 6564  any) are shifted
-00027d70: 2062 7920 6f6e 6520 706f 7369 7469 6f6e   by one position
-00027d80: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00027d90: 7468 6520 7269 6768 7420 696e 2074 6865  the right in the
-00027da0: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
-00027db0: 2028 692e 652e 2069 6e73 6572 7469 6e67   (i.e. inserting
-00027dc0: 2061 7420 706f 7369 7469 6f6e 2030 2068   at position 0 h
-00027dd0: 6173 2074 6865 2073 616d 650a 2020 2020  as the same.    
-00027de0: 2020 2020 2020 2020 6566 6665 6374 2061          effect a
-00027df0: 7320 7573 696e 6720 6172 7261 795f 7072  s using array_pr
-00027e00: 6570 656e 6429 2e0a 2020 2020 2020 2020  epend)..        
-00027e10: 2020 2020 4120 6e65 6761 7469 7665 2070      A negative p
-00027e20: 6f73 6974 696f 6e20 6973 2069 6e74 6572  osition is inter
-00027e30: 7072 6574 6564 2061 7320 616e 2069 6e64  preted as an ind
-00027e40: 6578 2066 726f 6d20 7468 6520 6261 636b  ex from the back
-00027e50: 206f 6620 7468 6520 6172 7261 7920 2865   of the array (e
-00027e60: 2e67 2e0a 2020 2020 2020 2020 2020 2020  .g..            
-00027e70: 2d31 2072 6573 756c 7473 2069 6e20 696e  -1 results in in
-00027e80: 7365 7274 696f 6e20 6265 666f 7265 2074  sertion before t
-00027e90: 6865 206c 6173 7420 656c 656d 656e 7420  he last element 
-00027ea0: 696e 2074 6865 2061 7272 6179 292e 0a20  in the array).. 
-00027eb0: 2020 2020 2020 2065 6c65 6d65 6e74 3a20         element: 
-00027ec0: 436f 6c75 6d6e 2063 6f6e 7461 696e 696e  Column containin
-00027ed0: 6720 7468 6520 656c 656d 656e 7420 746f  g the element to
-00027ee0: 2062 6520 696e 7365 7274 6564 2e20 5468   be inserted. Th
-00027ef0: 6520 6e65 7720 656c 656d 656e 7420 6973  e new element is
-00027f00: 206c 6f63 6174 6564 2061 740a 2020 2020   located at.    
-00027f10: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
-00027f20: 2070 6f73 2e20 5468 6520 7265 6c61 7469   pos. The relati
-00027f30: 7665 206f 7264 6572 206f 6620 7468 6520  ve order of the 
-00027f40: 6f74 6865 7220 656c 656d 656e 7473 2066  other elements f
-00027f50: 726f 6d20 7468 6520 736f 7572 6365 0a20  rom the source. 
-00027f60: 2020 2020 2020 2020 2020 2061 7272 6179             array
-00027f70: 2069 7320 7072 6573 6572 7665 642e 0a0a   is preserved...
-00027f80: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-00027f90: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-00027fa0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-00027fb0: 6b20 696d 706f 7274 2052 6f77 0a20 2020  k import Row.   
-00027fc0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00027fd0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00027fe0: 6166 7261 6d65 285b 526f 7728 5b31 2c20  aframe([Row([1, 
-00027ff0: 325d 292c 2052 6f77 285b 312c 2033 5d29  2]), Row([1, 3])
-00028000: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-00028010: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00028020: 7365 6c65 6374 2861 7272 6179 5f69 6e73  select(array_ins
-00028030: 6572 7428 2261 222c 206c 6974 2830 292c  ert("a", lit(0),
-00028040: 206c 6974 2831 3029 292e 616c 6961 7328   lit(10)).alias(
-00028050: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00028060: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00028070: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00028080: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00028090: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-000280a0: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
-000280b0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-000280c0: 2031 302c 2020 2020 207c 0a20 2020 2020   10,     |.     
-000280d0: 2020 207c 2020 312c 2020 2020 2020 7c0a     |  1,      |.
-000280e0: 2020 2020 2020 2020 7c20 2032 2020 2020          |  2    
-000280f0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-00028100: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00028110: 2020 7c5b 2020 2020 2020 2020 207c 0a20    |[         |. 
-00028120: 2020 2020 2020 207c 2020 3130 2c20 2020         |  10,   
-00028130: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
-00028140: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-00028150: 207c 2020 3320 2020 2020 2020 7c0a 2020   |  3       |.  
-00028160: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
-00028170: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-00028180: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00028190: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-000281a0: 2222 220a 2020 2020 6120 3d20 5f74 6f5f  """.    a = _to_
-000281b0: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
-000281c0: 2c20 2261 7272 6179 5f69 6e73 6572 7422  , "array_insert"
-000281d0: 290a 2020 2020 7020 3d20 5f74 6f5f 636f  ).    p = _to_co
-000281e0: 6c5f 6966 5f73 7472 2870 6f73 2c20 2261  l_if_str(pos, "a
-000281f0: 7272 6179 5f69 6e73 6572 7422 290a 2020  rray_insert").  
-00028200: 2020 6520 3d20 5f74 6f5f 636f 6c5f 6966    e = _to_col_if
-00028210: 5f73 7472 2865 6c65 6d65 6e74 2c20 2261  _str(element, "a
-00028220: 7272 6179 5f69 6e73 6572 7422 290a 2020  rray_insert").  
-00028230: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-00028240: 2822 6172 7261 795f 696e 7365 7274 2229  ("array_insert")
-00028250: 2861 2c20 702c 2065 290a 0a0a 6465 6620  (a, p, e)...def 
-00028260: 6172 7261 795f 706f 7369 7469 6f6e 2876  array_position(v
-00028270: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-00028280: 4e61 6d65 2c20 6172 7261 793a 2043 6f6c  Name, array: Col
-00028290: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000282a0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-000282b0: 7572 6e73 2074 6865 2069 6e64 6578 206f  urns the index o
-000282c0: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
-000282d0: 7272 656e 6365 206f 6620 616e 2065 6c65  rrence of an ele
-000282e0: 6d65 6e74 2069 6e20 616e 2041 5252 4159  ment in an ARRAY
-000282f0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-00028300: 2020 2020 2076 6172 6961 6e74 3a20 436f       variant: Co
-00028310: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-00028320: 7468 6520 5641 5249 414e 5420 7661 6c75  the VARIANT valu
-00028330: 6520 7468 6174 2079 6f75 2077 616e 7420  e that you want 
-00028340: 746f 2066 696e 642e 2054 6865 2066 756e  to find. The fun
-00028350: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-00028360: 2020 7365 6172 6368 6573 2066 6f72 2074    searches for t
-00028370: 6865 2066 6972 7374 206f 6363 7572 7265  he first occurre
-00028380: 6e63 6520 6f66 2074 6869 7320 7661 6c75  nce of this valu
-00028390: 6520 696e 2074 6865 2061 7272 6179 2e0a  e in the array..
-000283a0: 2020 2020 2020 2020 6172 7261 793a 2043          array: C
-000283b0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
-000283c0: 2074 6865 2041 5252 4159 2074 6f20 6265   the ARRAY to be
-000283d0: 2073 6561 7263 6865 642e 0a0a 2020 2020   searched...    
-000283e0: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
-000283f0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-00028400: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
-00028410: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
-00028420: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-00028430: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00028440: 6d65 285b 526f 7728 5b32 2c20 315d 292c  me([Row([2, 1]),
-00028450: 2052 6f77 285b 312c 2033 5d29 5d2c 2073   Row([1, 3])], s
-00028460: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-00028470: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00028480: 6374 2861 7272 6179 5f70 6f73 6974 696f  ct(array_positio
-00028490: 6e28 6c69 7428 3129 2c20 2261 2229 2e61  n(lit(1), "a").a
-000284a0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-000284b0: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-000284c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000284d0: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
-000284e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000284f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
-00028500: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
-00028510: 2020 207c 3020 2020 2020 2020 2020 7c0a     |0         |.
-00028520: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00028530: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00028540: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-00028550: 0a20 2020 2076 203d 205f 746f 5f63 6f6c  .    v = _to_col
-00028560: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
-00028570: 2022 6172 7261 795f 706f 7369 7469 6f6e   "array_position
-00028580: 2229 0a20 2020 2061 203d 205f 746f 5f63  ").    a = _to_c
-00028590: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
-000285a0: 2022 6172 7261 795f 706f 7369 7469 6f6e   "array_position
-000285b0: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
-000285c0: 696c 7469 6e28 2261 7272 6179 5f70 6f73  iltin("array_pos
-000285d0: 6974 696f 6e22 2928 762c 2061 290a 0a0a  ition")(v, a)...
-000285e0: 6465 6620 6172 7261 795f 7072 6570 656e  def array_prepen
-000285f0: 6428 6172 7261 793a 2043 6f6c 756d 6e4f  d(array: ColumnO
-00028600: 724e 616d 652c 2065 6c65 6d65 6e74 3a20  rName, element: 
-00028610: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00028620: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00028630: 5265 7475 726e 7320 616e 2041 5252 4159  Returns an ARRAY
-00028640: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00028650: 6e65 7720 656c 656d 656e 7420 6173 2077  new element as w
-00028660: 656c 6c20 6173 2061 6c6c 2065 6c65 6d65  ell as all eleme
-00028670: 6e74 7320 6672 6f6d 2074 6865 2073 6f75  nts from the sou
-00028680: 7263 6520 4152 5241 592e 0a20 2020 2054  rce ARRAY..    T
-00028690: 6865 206e 6577 2065 6c65 6d65 6e74 2069  he new element i
-000286a0: 7320 706f 7369 7469 6f6e 6564 2061 7420  s positioned at 
-000286b0: 7468 6520 6265 6769 6e6e 696e 6720 6f66  the beginning of
-000286c0: 2074 6865 2041 5252 4159 2e0a 0a20 2020   the ARRAY...   
-000286d0: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
-000286e0: 7272 6179 2043 6f6c 756d 6e20 636f 6e74  rray Column cont
-000286f0: 6169 6e69 6e67 2074 6865 2073 6f75 7263  aining the sourc
-00028700: 6520 4152 5241 592e 0a20 2020 2020 2020  e ARRAY..       
-00028710: 2065 6c65 6d65 6e74 2043 6f6c 756d 6e20   element Column 
-00028720: 636f 6e74 6169 6e69 6e67 2074 6865 2065  containing the e
-00028730: 6c65 6d65 6e74 2074 6f20 6265 2070 7265  lement to be pre
-00028740: 7065 6e64 6564 2e0a 0a20 2020 2045 7861  pended...    Exa
-00028750: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-00028760: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-00028770: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
-00028780: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
-00028790: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000287a0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000287b0: 5b52 6f77 2861 3d5b 312c 2032 2c20 335d  [Row(a=[1, 2, 3]
-000287c0: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
-000287d0: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
-000287e0: 7072 6570 656e 6428 2261 222c 206c 6974  prepend("a", lit
-000287f0: 2834 2929 2e61 6c69 6173 2822 7265 7375  (4)).alias("resu
-00028800: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
-00028810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00028820: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
-00028830: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
-00028840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00028850: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
-00028860: 0a20 2020 2020 2020 207c 2020 342c 2020  .        |  4,  
-00028870: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00028880: 2031 2c20 2020 2020 207c 0a20 2020 2020   1,      |.     
-00028890: 2020 207c 2020 322c 2020 2020 2020 7c0a     |  2,      |.
-000288a0: 2020 2020 2020 2020 7c20 2033 2020 2020          |  3    
-000288b0: 2020 207c 0a20 2020 2020 2020 207c 5d20     |.        |] 
-000288c0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00024870: 2033 2c20 3331 2c20 3131 2c20 3131 2929   3, 31, 11, 11))
+00024880: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
+00024890: 7475 726e 2062 7569 6c74 696e 2822 7469  turn builtin("ti
+000248a0: 6d65 7374 616d 705f 6672 6f6d 5f70 6172  mestamp_from_par
+000248b0: 7473 2229 280a 2020 2020 2020 2020 2a5f  ts")(.        *_
+000248c0: 7469 6d65 7374 616d 705f 6672 6f6d 5f70  timestamp_from_p
+000248d0: 6172 7473 5f69 6e74 6572 6e61 6c28 2274  arts_internal("t
+000248e0: 696d 6573 7461 6d70 5f66 726f 6d5f 7061  imestamp_from_pa
+000248f0: 7274 7322 2c20 2a61 7267 732c 202a 2a6b  rts", *args, **k
+00024900: 7761 7267 7329 0a20 2020 2029 0a0a 0a64  wargs).    )...d
+00024910: 6566 2074 696d 6573 7461 6d70 5f6c 747a  ef timestamp_ltz
+00024920: 5f66 726f 6d5f 7061 7274 7328 0a20 2020  _from_parts(.   
+00024930: 2079 6561 723a 2055 6e69 6f6e 5b43 6f6c   year: Union[Col
+00024940: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
+00024950: 0a20 2020 206d 6f6e 7468 3a20 556e 696f  .    month: Unio
+00024960: 6e5b 436f 6c75 6d6e 4f72 4e61 6d65 2c20  n[ColumnOrName, 
+00024970: 696e 745d 2c0a 2020 2020 6461 793a 2055  int],.    day: U
+00024980: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00024990: 652c 2069 6e74 5d2c 0a20 2020 2068 6f75  e, int],.    hou
+000249a0: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
+000249b0: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
+000249c0: 206d 696e 7574 653a 2055 6e69 6f6e 5b43   minute: Union[C
+000249d0: 6f6c 756d 6e4f 724e 616d 652c 2069 6e74  olumnOrName, int
+000249e0: 5d2c 0a20 2020 2073 6563 6f6e 643a 2055  ],.    second: U
+000249f0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00024a00: 652c 2069 6e74 5d2c 0a20 2020 206e 616e  e, int],.    nan
+00024a10: 6f73 6563 6f6e 6473 3a20 4f70 7469 6f6e  oseconds: Option
+00024a20: 616c 5b55 6e69 6f6e 5b43 6f6c 756d 6e4f  al[Union[ColumnO
+00024a30: 724e 616d 652c 2069 6e74 5d5d 203d 204e  rName, int]] = N
+00024a40: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
+00024a50: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
+00024a60: 6561 7465 7320 6120 7469 6d65 7374 616d  eates a timestam
+00024a70: 7020 6672 6f6d 2069 6e64 6976 6964 7561  p from individua
+00024a80: 6c20 6e75 6d65 7269 6320 636f 6d70 6f6e  l numeric compon
+00024a90: 656e 7473 2e0a 0a20 2020 2045 7861 6d70  ents...    Examp
+00024aa0: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00024ab0: 3e20 696d 706f 7274 2064 6174 6574 696d  > import datetim
+00024ac0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+00024ad0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00024ae0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+00024af0: 2020 2020 202e 2e2e 2020 2020 205b 5b32       ...     [[2
+00024b00: 3032 322c 2034 2c20 312c 2031 312c 2031  022, 4, 1, 11, 1
+00024b10: 312c 2030 5d2c 205b 3230 3232 2c20 332c  1, 0], [2022, 3,
+00024b20: 2033 312c 2031 312c 2031 312c 2030 5d5d   31, 11, 11, 0]]
+00024b30: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00024b40: 2020 7363 6865 6d61 3d5b 2279 6561 7222    schema=["year"
+00024b50: 2c20 226d 6f6e 7468 222c 2022 6461 7922  , "month", "day"
+00024b60: 2c20 2268 6f75 7222 2c20 226d 696e 7574  , "hour", "minut
+00024b70: 6522 2c20 2273 6563 6f6e 6422 5d2c 0a20  e", "second"],. 
+00024b80: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00024b90: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00024ba0: 6374 2874 696d 6573 7461 6d70 5f6c 747a  ct(timestamp_ltz
+00024bb0: 5f66 726f 6d5f 7061 7274 7328 0a20 2020  _from_parts(.   
+00024bc0: 2020 2020 202e 2e2e 2020 2020 2022 7965       ...     "ye
+00024bd0: 6172 222c 2022 6d6f 6e74 6822 2c20 2264  ar", "month", "d
+00024be0: 6179 222c 2022 686f 7572 222c 2022 6d69  ay", "hour", "mi
+00024bf0: 6e75 7465 222c 2022 7365 636f 6e64 220a  nute", "second".
+00024c00: 2020 2020 2020 2020 2e2e 2e20 292e 616c          ... ).al
+00024c10: 6961 7328 2254 494d 4553 5441 4d50 5f4c  ias("TIMESTAMP_L
+00024c20: 545a 5f46 524f 4d5f 5041 5254 5322 2929  TZ_FROM_PARTS"))
+00024c30: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00024c40: 2020 205b 526f 7728 5449 4d45 5354 414d     [Row(TIMESTAM
+00024c50: 505f 4c54 5a5f 4652 4f4d 5f50 4152 5453  P_LTZ_FROM_PARTS
+00024c60: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+00024c70: 6d65 2832 3032 322c 2034 2c20 312c 2031  me(2022, 4, 1, 1
+00024c80: 312c 2031 312c 2074 7a69 6e66 6f3d 3c44  1, 11, tzinfo=<D
+00024c90: 7374 547a 496e 666f 2027 416d 6572 6963  stTzInfo 'Americ
+00024ca0: 612f 4c6f 735f 416e 6765 6c65 7327 2050  a/Los_Angeles' P
+00024cb0: 4454 2d31 2064 6179 2c20 3137 3a30 303a  DT-1 day, 17:00:
+00024cc0: 3030 2044 5354 3e29 292c 2052 6f77 2854  00 DST>)), Row(T
+00024cd0: 494d 4553 5441 4d50 5f4c 545a 5f46 524f  IMESTAMP_LTZ_FRO
+00024ce0: 4d5f 5041 5254 533d 6461 7465 7469 6d65  M_PARTS=datetime
+00024cf0: 2e64 6174 6574 696d 6528 3230 3232 2c20  .datetime(2022, 
+00024d00: 332c 2033 312c 2031 312c 2031 312c 2074  3, 31, 11, 11, t
+00024d10: 7a69 6e66 6f3d 3c44 7374 547a 496e 666f  zinfo=<DstTzInfo
+00024d20: 2027 416d 6572 6963 612f 4c6f 735f 416e   'America/Los_An
+00024d30: 6765 6c65 7327 2050 4454 2d31 2064 6179  geles' PDT-1 day
+00024d40: 2c20 3137 3a30 303a 3030 2044 5354 3e29  , 17:00:00 DST>)
+00024d50: 295d 0a20 2020 2022 2222 0a20 2020 2066  )].    """.    f
+00024d60: 756e 635f 6e61 6d65 203d 2022 7469 6d65  unc_name = "time
+00024d70: 7374 616d 705f 6c74 7a5f 6672 6f6d 5f70  stamp_ltz_from_p
+00024d80: 6172 7473 220a 2020 2020 792c 206d 2c20  arts".    y, m, 
+00024d90: 642c 2068 2c20 6d69 6e5f 2c20 7320 3d20  d, h, min_, s = 
+00024da0: 5f63 6f6c 756d 6e73 5f66 726f 6d5f 7469  _columns_from_ti
+00024db0: 6d65 7374 616d 705f 7061 7274 7328 0a20  mestamp_parts(. 
+00024dc0: 2020 2020 2020 2066 756e 635f 6e61 6d65         func_name
+00024dd0: 2c20 7965 6172 2c20 6d6f 6e74 682c 2064  , year, month, d
+00024de0: 6179 2c20 686f 7572 2c20 6d69 6e75 7465  ay, hour, minute
+00024df0: 2c20 7365 636f 6e64 0a20 2020 2029 0a20  , second.    ). 
+00024e00: 2020 206e 7320 3d20 4e6f 6e65 2069 6620     ns = None if 
+00024e10: 6e61 6e6f 7365 636f 6e64 7320 6973 204e  nanoseconds is N
+00024e20: 6f6e 6520 656c 7365 205f 746f 5f63 6f6c  one else _to_col
+00024e30: 5f69 665f 7374 725f 6f72 5f69 6e74 286e  _if_str_or_int(n
+00024e40: 616e 6f73 6563 6f6e 6473 2c20 6675 6e63  anoseconds, func
+00024e50: 5f6e 616d 6529 0a20 2020 2072 6574 7572  _name).    retur
+00024e60: 6e20 280a 2020 2020 2020 2020 6275 696c  n (.        buil
+00024e70: 7469 6e28 6675 6e63 5f6e 616d 6529 2879  tin(func_name)(y
+00024e80: 2c20 6d2c 2064 2c20 682c 206d 696e 5f2c  , m, d, h, min_,
+00024e90: 2073 290a 2020 2020 2020 2020 6966 206e   s).        if n
+00024ea0: 7320 6973 204e 6f6e 650a 2020 2020 2020  s is None.      
+00024eb0: 2020 656c 7365 2062 7569 6c74 696e 2866    else builtin(f
+00024ec0: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
+00024ed0: 642c 2068 2c20 6d69 6e5f 2c20 732c 206e  d, h, min_, s, n
+00024ee0: 7329 0a20 2020 2029 0a0a 0a40 6f76 6572  s).    )...@over
+00024ef0: 6c6f 6164 0a64 6566 2074 696d 6573 7461  load.def timesta
+00024f00: 6d70 5f6e 747a 5f66 726f 6d5f 7061 7274  mp_ntz_from_part
+00024f10: 7328 0a20 2020 2064 6174 655f 6578 7072  s(.    date_expr
+00024f20: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+00024f30: 7469 6d65 5f65 7870 723a 2043 6f6c 756d  time_expr: Colum
+00024f40: 6e4f 724e 616d 650a 2920 2d3e 2043 6f6c  nOrName.) -> Col
+00024f50: 756d 6e3a 0a20 2020 202e 2e2e 2020 2320  umn:.    ...  # 
+00024f60: 7072 6167 6d61 3a20 6e6f 2063 6f76 6572  pragma: no cover
+00024f70: 0a0a 0a40 6f76 6572 6c6f 6164 0a64 6566  ...@overload.def
+00024f80: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
+00024f90: 726f 6d5f 7061 7274 7328 0a20 2020 2079  rom_parts(.    y
+00024fa0: 6561 723a 2055 6e69 6f6e 5b43 6f6c 756d  ear: Union[Colum
+00024fb0: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
+00024fc0: 2020 206d 6f6e 7468 3a20 556e 696f 6e5b     month: Union[
+00024fd0: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 696e  ColumnOrName, in
+00024fe0: 745d 2c0a 2020 2020 6461 793a 2055 6e69  t],.    day: Uni
+00024ff0: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00025000: 2069 6e74 5d2c 0a20 2020 2068 6f75 723a   int],.    hour:
+00025010: 2055 6e69 6f6e 5b43 6f6c 756d 6e4f 724e   Union[ColumnOrN
+00025020: 616d 652c 2069 6e74 5d2c 0a20 2020 206d  ame, int],.    m
+00025030: 696e 7574 653a 2055 6e69 6f6e 5b43 6f6c  inute: Union[Col
+00025040: 756d 6e4f 724e 616d 652c 2069 6e74 5d2c  umnOrName, int],
+00025050: 0a20 2020 2073 6563 6f6e 643a 2055 6e69  .    second: Uni
+00025060: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
+00025070: 2069 6e74 5d2c 0a20 2020 206e 616e 6f73   int],.    nanos
+00025080: 6563 6f6e 643a 204f 7074 696f 6e61 6c5b  econd: Optional[
+00025090: 556e 696f 6e5b 436f 6c75 6d6e 4f72 4e61  Union[ColumnOrNa
+000250a0: 6d65 2c20 696e 745d 5d20 3d20 4e6f 6e65  me, int]] = None
+000250b0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+000250c0: 2020 202e 2e2e 2020 2320 7072 6167 6d61     ...  # pragma
+000250d0: 3a20 6e6f 2063 6f76 6572 0a0a 0a64 6566  : no cover...def
+000250e0: 2074 696d 6573 7461 6d70 5f6e 747a 5f66   timestamp_ntz_f
+000250f0: 726f 6d5f 7061 7274 7328 2a61 7267 732c  rom_parts(*args,
+00025100: 202a 2a6b 7761 7267 7329 202d 3e20 436f   **kwargs) -> Co
+00025110: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
+00025120: 2020 4372 6561 7465 7320 6120 7469 6d65    Creates a time
+00025130: 7374 616d 7020 6672 6f6d 2069 6e64 6976  stamp from indiv
+00025140: 6964 7561 6c20 6e75 6d65 7269 6320 636f  idual numeric co
+00025150: 6d70 6f6e 656e 7473 2e20 5468 6520 6675  mponents. The fu
+00025160: 6e63 7469 6f6e 2063 616e 2062 6520 7573  nction can be us
+00025170: 6564 2074 6f0a 2020 2020 6372 6561 7465  ed to.    create
+00025180: 2061 2074 696d 6573 7461 6d70 2066 726f   a timestamp fro
+00025190: 6d20 6120 6461 7465 2065 7870 7265 7373  m a date express
+000251a0: 696f 6e20 616e 6420 6120 7469 6d65 2065  ion and a time e
+000251b0: 7870 7265 7373 696f 6e2e 0a0a 2020 2020  xpression...    
+000251c0: 4578 616d 706c 6520 313a 3a0a 0a20 2020  Example 1::..   
+000251d0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000251e0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000251f0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+00025200: 2e2e 2e20 2020 2020 5b5b 3230 3232 2c20  ...     [[2022, 
+00025210: 342c 2031 2c20 3131 2c20 3131 2c20 305d  4, 1, 11, 11, 0]
+00025220: 2c20 5b32 3032 322c 2033 2c20 3331 2c20  , [2022, 3, 31, 
+00025230: 3131 2c20 3131 2c20 305d 5d2c 0a20 2020  11, 11, 0]],.   
+00025240: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
+00025250: 656d 613d 5b22 7965 6172 222c 2022 6d6f  ema=["year", "mo
+00025260: 6e74 6822 2c20 2264 6179 222c 2022 686f  nth", "day", "ho
+00025270: 7572 222c 2022 6d69 6e75 7465 222c 2022  ur", "minute", "
+00025280: 7365 636f 6e64 225d 2c0a 2020 2020 2020  second"],.      
+00025290: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+000252a0: 3e3e 3e20 6466 2e73 656c 6563 7428 7469  >>> df.select(ti
+000252b0: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
+000252c0: 5f70 6172 7473 280a 2020 2020 2020 2020  _parts(.        
+000252d0: 2e2e 2e20 2020 2020 2279 6561 7222 2c20  ...     "year", 
+000252e0: 226d 6f6e 7468 222c 2022 6461 7922 2c20  "month", "day", 
+000252f0: 2268 6f75 7222 2c20 226d 696e 7574 6522  "hour", "minute"
+00025300: 2c20 2273 6563 6f6e 6422 0a20 2020 2020  , "second".     
+00025310: 2020 202e 2e2e 2029 2e61 6c69 6173 2822     ... ).alias("
+00025320: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
+00025330: 4f4d 5f50 4152 5453 2229 292e 636f 6c6c  OM_PARTS")).coll
+00025340: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00025350: 6f77 2854 494d 4553 5441 4d50 5f4e 545a  ow(TIMESTAMP_NTZ
+00025360: 5f46 524f 4d5f 5041 5254 533d 6461 7465  _FROM_PARTS=date
+00025370: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
+00025380: 3232 2c20 342c 2031 2c20 3131 2c20 3131  22, 4, 1, 11, 11
+00025390: 2929 2c20 526f 7728 5449 4d45 5354 414d  )), Row(TIMESTAM
+000253a0: 505f 4e54 5a5f 4652 4f4d 5f50 4152 5453  P_NTZ_FROM_PARTS
+000253b0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+000253c0: 6d65 2832 3032 322c 2033 2c20 3331 2c20  me(2022, 3, 31, 
+000253d0: 3131 2c20 3131 2929 5d0a 0a20 2020 2045  11, 11))]..    E
+000253e0: 7861 6d70 6c65 2032 3a3a 0a0a 2020 2020  xample 2::..    
+000253f0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00025400: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00025410: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+00025420: 2e2e 2020 2020 205b 5b27 3230 3232 2d30  ..     [['2022-0
+00025430: 342d 3031 272c 2027 3131 3a31 313a 3030  4-01', '11:11:00
+00025440: 275d 2c20 5b27 3230 3232 2d30 332d 3331  '], ['2022-03-31
+00025450: 272c 2027 3131 3a31 313a 3030 275d 5d2c  ', '11:11:00']],
+00025460: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00025470: 2073 6368 656d 613d 5b22 6461 7465 222c   schema=["date",
+00025480: 2022 7469 6d65 225d 0a20 2020 2020 2020   "time"].       
+00025490: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
+000254a0: 3e3e 2064 662e 7365 6c65 6374 280a 2020  >> df.select(.  
+000254b0: 2020 2020 2020 2e2e 2e20 2020 2020 7469        ...     ti
+000254c0: 6d65 7374 616d 705f 6e74 7a5f 6672 6f6d  mestamp_ntz_from
+000254d0: 5f70 6172 7473 2874 6f5f 6461 7465 2822  _parts(to_date("
+000254e0: 6461 7465 2229 2c20 746f 5f74 696d 6528  date"), to_time(
+000254f0: 2274 696d 6522 290a 2020 2020 2020 2020  "time").        
+00025500: 2e2e 2e20 292e 616c 6961 7328 2254 494d  ... ).alias("TIM
+00025510: 4553 5441 4d50 5f4e 545a 5f46 524f 4d5f  ESTAMP_NTZ_FROM_
+00025520: 5041 5254 5322 2929 2e63 6f6c 6c65 6374  PARTS")).collect
+00025530: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00025540: 5449 4d45 5354 414d 505f 4e54 5a5f 4652  TIMESTAMP_NTZ_FR
+00025550: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
+00025560: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
+00025570: 2034 2c20 312c 2031 312c 2031 3129 292c   4, 1, 11, 11)),
+00025580: 2052 6f77 2854 494d 4553 5441 4d50 5f4e   Row(TIMESTAMP_N
+00025590: 545a 5f46 524f 4d5f 5041 5254 533d 6461  TZ_FROM_PARTS=da
+000255a0: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
+000255b0: 3230 3232 2c20 332c 2033 312c 2031 312c  2022, 3, 31, 11,
+000255c0: 2031 3129 295d 0a20 2020 2022 2222 0a20   11))].    """. 
+000255d0: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
+000255e0: 6e28 2274 696d 6573 7461 6d70 5f6e 747a  n("timestamp_ntz
+000255f0: 5f66 726f 6d5f 7061 7274 7322 2928 0a20  _from_parts")(. 
+00025600: 2020 2020 2020 202a 5f74 696d 6573 7461         *_timesta
+00025610: 6d70 5f66 726f 6d5f 7061 7274 735f 696e  mp_from_parts_in
+00025620: 7465 726e 616c 2822 7469 6d65 7374 616d  ternal("timestam
+00025630: 705f 6e74 7a5f 6672 6f6d 5f70 6172 7473  p_ntz_from_parts
+00025640: 222c 202a 6172 6773 2c20 2a2a 6b77 6172  ", *args, **kwar
+00025650: 6773 290a 2020 2020 290a 0a0a 6465 6620  gs).    )...def 
+00025660: 7469 6d65 7374 616d 705f 747a 5f66 726f  timestamp_tz_fro
+00025670: 6d5f 7061 7274 7328 0a20 2020 2079 6561  m_parts(.    yea
+00025680: 723a 2055 6e69 6f6e 5b43 6f6c 756d 6e4f  r: Union[ColumnO
+00025690: 724e 616d 652c 2069 6e74 5d2c 0a20 2020  rName, int],.   
+000256a0: 206d 6f6e 7468 3a20 556e 696f 6e5b 436f   month: Union[Co
+000256b0: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
+000256c0: 2c0a 2020 2020 6461 793a 2055 6e69 6f6e  ,.    day: Union
+000256d0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+000256e0: 6e74 5d2c 0a20 2020 2068 6f75 723a 2055  nt],.    hour: U
+000256f0: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00025700: 652c 2069 6e74 5d2c 0a20 2020 206d 696e  e, int],.    min
+00025710: 7574 653a 2055 6e69 6f6e 5b43 6f6c 756d  ute: Union[Colum
+00025720: 6e4f 724e 616d 652c 2069 6e74 5d2c 0a20  nOrName, int],. 
+00025730: 2020 2073 6563 6f6e 643a 2055 6e69 6f6e     second: Union
+00025740: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00025750: 6e74 5d2c 0a20 2020 206e 616e 6f73 6563  nt],.    nanosec
+00025760: 6f6e 6473 3a20 4f70 7469 6f6e 616c 5b55  onds: Optional[U
+00025770: 6e69 6f6e 5b43 6f6c 756d 6e4f 724e 616d  nion[ColumnOrNam
+00025780: 652c 2069 6e74 5d5d 203d 204e 6f6e 652c  e, int]] = None,
+00025790: 0a20 2020 2074 696d 657a 6f6e 653a 204f  .    timezone: O
+000257a0: 7074 696f 6e61 6c5b 436f 6c75 6d6e 4f72  ptional[ColumnOr
+000257b0: 4c69 7465 7261 6c53 7472 5d20 3d20 4e6f  LiteralStr] = No
+000257c0: 6e65 2c0a 2920 2d3e 2043 6f6c 756d 6e3a  ne,.) -> Column:
+000257d0: 0a20 2020 2022 2222 0a20 2020 2043 7265  .    """.    Cre
+000257e0: 6174 6573 2061 2074 696d 6573 7461 6d70  ates a timestamp
+000257f0: 2066 726f 6d20 696e 6469 7669 6475 616c   from individual
+00025800: 206e 756d 6572 6963 2063 6f6d 706f 6e65   numeric compone
+00025810: 6e74 7320 616e 6420 6120 7374 7269 6e67  nts and a string
+00025820: 2074 696d 657a 6f6e 652e 0a0a 2020 2020   timezone...    
+00025830: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+00025840: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00025850: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00025860: 7261 6d65 280a 2020 2020 2020 2020 2e2e  rame(.        ..
+00025870: 2e20 2020 2020 5b5b 3230 3232 2c20 342c  .     [[2022, 4,
+00025880: 2031 2c20 3131 2c20 3131 2c20 302c 2027   1, 11, 11, 0, '
+00025890: 416d 6572 6963 612f 4c6f 735f 416e 6765  America/Los_Ange
+000258a0: 6c65 7327 5d2c 205b 3230 3232 2c20 332c  les'], [2022, 3,
+000258b0: 2033 312c 2031 312c 2031 312c 2030 2c20   31, 11, 11, 0, 
+000258c0: 2741 6d65 7269 6361 2f4c 6f73 5f41 6e67  'America/Los_Ang
+000258d0: 656c 6573 275d 5d2c 0a20 2020 2020 2020  eles']],.       
+000258e0: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+000258f0: 5b22 7965 6172 222c 2022 6d6f 6e74 6822  ["year", "month"
+00025900: 2c20 2264 6179 222c 2022 686f 7572 222c  , "day", "hour",
+00025910: 2022 6d69 6e75 7465 222c 2022 7365 636f   "minute", "seco
+00025920: 6e64 222c 2022 7469 6d65 7a6f 6e65 225d  nd", "timezone"]
+00025930: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
+00025940: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00025950: 656c 6563 7428 7469 6d65 7374 616d 705f  elect(timestamp_
+00025960: 747a 5f66 726f 6d5f 7061 7274 7328 0a20  tz_from_parts(. 
+00025970: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+00025980: 7965 6172 222c 2022 6d6f 6e74 6822 2c20  year", "month", 
+00025990: 2264 6179 222c 2022 686f 7572 222c 2022  "day", "hour", "
+000259a0: 6d69 6e75 7465 222c 2022 7365 636f 6e64  minute", "second
+000259b0: 222c 2074 696d 657a 6f6e 653d 2274 696d  ", timezone="tim
+000259c0: 657a 6f6e 6522 0a20 2020 2020 2020 202e  ezone".        .
+000259d0: 2e2e 2029 2e61 6c69 6173 2822 5449 4d45  .. ).alias("TIME
+000259e0: 5354 414d 505f 545a 5f46 524f 4d5f 5041  STAMP_TZ_FROM_PA
+000259f0: 5254 5322 2929 2e63 6f6c 6c65 6374 2829  RTS")).collect()
+00025a00: 0a20 2020 2020 2020 205b 526f 7728 5449  .        [Row(TI
+00025a10: 4d45 5354 414d 505f 545a 5f46 524f 4d5f  MESTAMP_TZ_FROM_
+00025a20: 5041 5254 533d 6461 7465 7469 6d65 2e64  PARTS=datetime.d
+00025a30: 6174 6574 696d 6528 3230 3232 2c20 342c  atetime(2022, 4,
+00025a40: 2031 2c20 3131 2c20 3131 2c20 747a 696e   1, 11, 11, tzin
+00025a50: 666f 3d70 7974 7a2e 4669 7865 644f 6666  fo=pytz.FixedOff
+00025a60: 7365 7428 2d34 3230 2929 292c 2052 6f77  set(-420))), Row
+00025a70: 2854 494d 4553 5441 4d50 5f54 5a5f 4652  (TIMESTAMP_TZ_FR
+00025a80: 4f4d 5f50 4152 5453 3d64 6174 6574 696d  OM_PARTS=datetim
+00025a90: 652e 6461 7465 7469 6d65 2832 3032 322c  e.datetime(2022,
+00025aa0: 2033 2c20 3331 2c20 3131 2c20 3131 2c20   3, 31, 11, 11, 
+00025ab0: 747a 696e 666f 3d70 7974 7a2e 4669 7865  tzinfo=pytz.Fixe
+00025ac0: 644f 6666 7365 7428 2d34 3230 2929 295d  dOffset(-420)))]
+00025ad0: 0a20 2020 2022 2222 0a20 2020 2066 756e  .    """.    fun
+00025ae0: 635f 6e61 6d65 203d 2022 7469 6d65 7374  c_name = "timest
+00025af0: 616d 705f 747a 5f66 726f 6d5f 7061 7274  amp_tz_from_part
+00025b00: 7322 0a20 2020 2079 2c20 6d2c 2064 2c20  s".    y, m, d, 
+00025b10: 682c 206d 696e 5f2c 2073 203d 205f 636f  h, min_, s = _co
+00025b20: 6c75 6d6e 735f 6672 6f6d 5f74 696d 6573  lumns_from_times
+00025b30: 7461 6d70 5f70 6172 7473 280a 2020 2020  tamp_parts(.    
+00025b40: 2020 2020 6675 6e63 5f6e 616d 652c 2079      func_name, y
+00025b50: 6561 722c 206d 6f6e 7468 2c20 6461 792c  ear, month, day,
+00025b60: 2068 6f75 722c 206d 696e 7574 652c 2073   hour, minute, s
+00025b70: 6563 6f6e 640a 2020 2020 290a 2020 2020  econd.    ).    
+00025b80: 6e73 203d 204e 6f6e 6520 6966 206e 616e  ns = None if nan
+00025b90: 6f73 6563 6f6e 6473 2069 7320 4e6f 6e65  oseconds is None
+00025ba0: 2065 6c73 6520 5f74 6f5f 636f 6c5f 6966   else _to_col_if
+00025bb0: 5f73 7472 5f6f 725f 696e 7428 6e61 6e6f  _str_or_int(nano
+00025bc0: 7365 636f 6e64 732c 2066 756e 635f 6e61  seconds, func_na
+00025bd0: 6d65 290a 2020 2020 747a 203d 204e 6f6e  me).    tz = Non
+00025be0: 6520 6966 2074 696d 657a 6f6e 6520 6973  e if timezone is
+00025bf0: 204e 6f6e 6520 656c 7365 205f 746f 5f63   None else _to_c
+00025c00: 6f6c 5f69 665f 7371 6c5f 6578 7072 2874  ol_if_sql_expr(t
+00025c10: 696d 657a 6f6e 652c 2066 756e 635f 6e61  imezone, func_na
+00025c20: 6d65 290a 2020 2020 6966 206e 616e 6f73  me).    if nanos
+00025c30: 6563 6f6e 6473 2069 7320 6e6f 7420 4e6f  econds is not No
+00025c40: 6e65 2061 6e64 2074 696d 657a 6f6e 6520  ne and timezone 
+00025c50: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00025c60: 2020 2020 2072 6574 7572 6e20 6275 696c       return buil
+00025c70: 7469 6e28 6675 6e63 5f6e 616d 6529 2879  tin(func_name)(y
+00025c80: 2c20 6d2c 2064 2c20 682c 206d 696e 5f2c  , m, d, h, min_,
+00025c90: 2073 2c20 6e73 2c20 747a 290a 2020 2020   s, ns, tz).    
+00025ca0: 656c 6966 206e 616e 6f73 6563 6f6e 6473  elif nanoseconds
+00025cb0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00025cc0: 2020 2020 2020 7265 7475 726e 2062 7569        return bui
+00025cd0: 6c74 696e 2866 756e 635f 6e61 6d65 2928  ltin(func_name)(
+00025ce0: 792c 206d 2c20 642c 2068 2c20 6d69 6e5f  y, m, d, h, min_
+00025cf0: 2c20 732c 206e 7329 0a20 2020 2065 6c69  , s, ns).    eli
+00025d00: 6620 7469 6d65 7a6f 6e65 2069 7320 6e6f  f timezone is no
+00025d10: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00025d20: 7265 7475 726e 2062 7569 6c74 696e 2866  return builtin(f
+00025d30: 756e 635f 6e61 6d65 2928 792c 206d 2c20  unc_name)(y, m, 
+00025d40: 642c 2068 2c20 6d69 6e5f 2c20 732c 206c  d, h, min_, s, l
+00025d50: 6974 2830 292c 2074 7a29 0a20 2020 2065  it(0), tz).    e
+00025d60: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+00025d70: 7572 6e20 6275 696c 7469 6e28 6675 6e63  urn builtin(func
+00025d80: 5f6e 616d 6529 2879 2c20 6d2c 2064 2c20  _name)(y, m, d, 
+00025d90: 682c 206d 696e 5f2c 2073 290a 0a0a 6465  h, min_, s)...de
+00025da0: 6620 7765 656b 6f66 7965 6172 2865 3a20  f weekofyear(e: 
+00025db0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00025dc0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00025dd0: 0a20 2020 2045 7874 7261 6374 7320 7468  .    Extracts th
+00025de0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+00025df0: 7765 656b 2028 6e75 6d62 6572 2920 6f66  week (number) of
+00025e00: 2074 6865 2079 6561 7220 6672 6f6d 2061   the year from a
+00025e10: 2064 6174 6520 6f72 2074 696d 6573 7461   date or timesta
+00025e20: 6d70 2e0a 0a20 2020 2045 7861 6d70 6c65  mp...    Example
+00025e30: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00025e40: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+00025e50: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+00025e60: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+00025e70: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00025e80: 2020 202e 2e2e 2020 2020 205b 5b64 6174     ...     [[dat
+00025e90: 6574 696d 652e 6461 7465 7469 6d65 2e73  etime.datetime.s
+00025ea0: 7472 7074 696d 6528 2232 3032 302d 3035  trptime("2020-05
+00025eb0: 2d30 3120 3133 3a31 313a 3230 2e30 3030  -01 13:11:20.000
+00025ec0: 222c 2022 2559 2d25 6d2d 2564 2025 483a  ", "%Y-%m-%d %H:
+00025ed0: 254d 3a25 532e 2566 2229 5d5d 2c0a 2020  %M:%S.%f")]],.  
+00025ee0: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+00025ef0: 6865 6d61 3d5b 2261 225d 2c0a 2020 2020  hema=["a"],.    
+00025f00: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
+00025f10: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00025f20: 7765 656b 6f66 7965 6172 2822 6122 2929  weekofyear("a"))
+00025f30: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00025f40: 2020 205b 526f 7728 5745 454b 4f46 5945     [Row(WEEKOFYE
+00025f50: 4152 2822 4122 293d 3138 295d 0a20 2020  AR("A")=18)].   
+00025f60: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00025f70: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00025f80: 7765 656b 6f66 7965 6172 2229 0a20 2020  weekofyear").   
+00025f90: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00025fa0: 2277 6565 6b6f 6679 6561 7222 2928 6329  "weekofyear")(c)
+00025fb0: 0a0a 0a64 6566 2074 7970 656f 6628 636f  ...def typeof(co
+00025fc0: 6c3a 2043 6f6c 756d 6e4f 724e 616d 6529  l: ColumnOrName)
+00025fd0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00025fe0: 2222 2252 6570 6f72 7473 2074 6865 2074  """Reports the t
+00025ff0: 7970 6520 6f66 2061 2076 616c 7565 2073  ype of a value s
+00026000: 746f 7265 6420 696e 2061 2056 4152 4941  tored in a VARIA
+00026010: 4e54 2063 6f6c 756d 6e2e 2054 6865 2074  NT column. The t
+00026020: 7970 6520 6973 2072 6574 7572 6e65 6420  ype is returned 
+00026030: 6173 2061 2073 7472 696e 672e 0a0a 2020  as a string...  
+00026040: 2020 466f 7220 636f 6c75 6d6e 7320 7768    For columns wh
+00026050: 6572 6520 616c 6c20 726f 7773 2073 6861  ere all rows sha
+00026060: 7265 2074 6865 2073 616d 6520 7479 7065  re the same type
+00026070: 2c20 7468 6520 7265 7375 6c74 206f 6620  , the result of 
+00026080: 6074 7970 656f 6660 2069 7320 7468 6520  `typeof` is the 
+00026090: 756e 6465 726c 7969 6e67 2053 6e6f 7766  underlying Snowf
+000260a0: 6c61 6b65 2063 6f6c 756d 6e20 7479 7065  lake column type
+000260b0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000260c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+000260d0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+000260e0: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+000260f0: 322c 2033 5d2c 2073 6368 656d 613d 5b22  2, 3], schema=["
+00026100: 4122 5d29 0a20 2020 2020 2020 203e 3e3e  A"]).        >>>
+00026110: 2064 662e 7365 6c65 6374 2874 7970 656f   df.select(typeo
+00026120: 6628 636f 6c28 2241 2229 292e 6173 5f28  f(col("A")).as_(
+00026130: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+00026140: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00026150: 4e53 3d27 494e 5445 4745 5227 292c 2052  NS='INTEGER'), R
+00026160: 6f77 2841 4e53 3d27 494e 5445 4745 5227  ow(ANS='INTEGER'
+00026170: 292c 2052 6f77 2841 4e53 3d27 494e 5445  ), Row(ANS='INTE
+00026180: 4745 5227 295d 0a0a 2020 2020 466f 7220  GER')]..    For 
+00026190: 636f 6c75 6d6e 7320 6f66 2056 4152 4941  columns of VARIA
+000261a0: 4e54 2074 7970 652c 2074 6865 2075 6e64  NT type, the und
+000261b0: 6572 6c79 696e 6720 7374 6f72 6564 2074  erlying stored t
+000261c0: 7970 6520 6973 2072 6574 7572 6e65 642e  ype is returned.
+000261d0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+000261e0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+000261f0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+00026200: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
+00026210: 7420 5661 7269 616e 7454 7970 652c 2053  t VariantType, S
+00026220: 7472 7563 7454 7970 652c 2053 7472 7563  tructType, Struc
+00026230: 7446 6965 6c64 0a20 2020 2020 2020 203e  tField.        >
+00026240: 3e3e 2073 6368 656d 6120 3d20 5374 7275  >> schema = Stru
+00026250: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
+00026260: 656c 6428 2241 222c 2056 6172 6961 6e74  eld("A", Variant
+00026270: 5479 7065 2829 295d 290a 2020 2020 2020  Type())]).      
+00026280: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00026290: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000262a0: 616d 6528 5b31 2c20 332e 312c 2027 7465  ame([1, 3.1, 'te
+000262b0: 7374 275d 2c20 7363 6865 6d61 3d73 6368  st'], schema=sch
+000262c0: 656d 6129 0a20 2020 2020 2020 203e 3e3e  ema).        >>>
+000262d0: 2064 662e 7365 6c65 6374 2874 7970 656f   df.select(typeo
+000262e0: 6628 636f 6c28 2241 2229 292e 6173 5f28  f(col("A")).as_(
+000262f0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+00026300: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00026310: 4e53 3d27 494e 5445 4745 5227 292c 2052  NS='INTEGER'), R
+00026320: 6f77 2841 4e53 3d27 4445 4349 4d41 4c27  ow(ANS='DECIMAL'
+00026330: 292c 2052 6f77 2841 4e53 3d27 5641 5243  ), Row(ANS='VARC
+00026340: 4841 5227 295d 0a0a 2020 2020 2222 220a  HAR')]..    """.
+00026350: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00026360: 6966 5f73 7472 2863 6f6c 2c20 2274 7970  if_str(col, "typ
+00026370: 656f 6622 290a 2020 2020 7265 7475 726e  eof").    return
+00026380: 2062 7569 6c74 696e 2822 7479 7065 6f66   builtin("typeof
+00026390: 2229 2863 290a 0a0a 6465 6620 6368 6563  ")(c)...def chec
+000263a0: 6b5f 6a73 6f6e 2863 6f6c 3a20 436f 6c75  k_json(col: Colu
+000263b0: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+000263c0: 756d 6e3a 0a20 2020 2022 2222 4368 6563  umn:.    """Chec
+000263d0: 6b73 2074 6865 2076 616c 6964 6974 7920  ks the validity 
+000263e0: 6f66 2061 204a 534f 4e20 646f 6375 6d65  of a JSON docume
+000263f0: 6e74 2e0a 2020 2020 4966 2074 6865 2069  nt..    If the i
+00026400: 6e70 7574 2073 7472 696e 6720 6973 2061  nput string is a
+00026410: 2076 616c 6964 204a 534f 4e20 646f 6375   valid JSON docu
+00026420: 6d65 6e74 206f 7220 6120 4e55 4c4c 2028  ment or a NULL (
+00026430: 692e 652e 206e 6f20 6572 726f 7220 776f  i.e. no error wo
+00026440: 756c 6420 6f63 6375 7220 7768 656e 0a20  uld occur when. 
+00026450: 2020 2070 6172 7369 6e67 2074 6865 2069     parsing the i
+00026460: 6e70 7574 2073 7472 696e 6729 2c20 7468  nput string), th
+00026470: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+00026480: 6e73 204e 554c 4c2e 0a20 2020 2049 6e20  ns NULL..    In 
+00026490: 6361 7365 206f 6620 6120 4a53 4f4e 2070  case of a JSON p
+000264a0: 6172 7369 6e67 2065 7272 6f72 2c20 7468  arsing error, th
+000264b0: 6520 6675 6e63 7469 6f6e 2072 6574 7572  e function retur
+000264c0: 6e73 2061 2073 7472 696e 6720 7468 6174  ns a string that
+000264d0: 2063 6f6e 7461 696e 7320 7468 6520 6572   contains the er
+000264e0: 726f 720a 2020 2020 6d65 7373 6167 652e  ror.    message.
+000264f0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00026500: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00026510: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00026520: 5f64 6174 6166 7261 6d65 285b 227b 2756  _dataframe(["{'V
+00026530: 616c 6964 4b65 7931 273a 2027 5661 6c69  alidKey1': 'Vali
+00026540: 6456 616c 7565 3127 7d22 2c20 227b 274d  dValue1'}", "{'M
+00026550: 616c 666f 726d 6564 202d 2d20 6d69 7373  alformed -- miss
+00026560: 696e 6720 7661 6c27 3a7d 222c 204e 6f6e  ing val':}", Non
+00026570: 655d 2c20 7363 6865 6d61 3d5b 2761 275d  e], schema=['a']
+00026580: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00026590: 2e73 656c 6563 7428 6368 6563 6b5f 6a73  .select(check_js
+000265a0: 6f6e 2864 662e 6129 292e 7368 6f77 2829  on(df.a)).show()
+000265b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000265c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000265d0: 0a20 2020 2020 2020 207c 2243 4845 434b  .        |"CHECK
+000265e0: 5f4a 534f 4e28 2222 4122 2229 2220 207c  _JSON(""A"")"  |
+000265f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00026600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026610: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
+00026620: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00026630: 0a20 2020 2020 2020 207c 6d69 7370 6c61  .        |mispla
+00026640: 6365 6420 7d2c 2070 6f73 2032 3920 207c  ced }, pos 29  |
+00026650: 0a20 2020 2020 2020 207c 4e55 4c4c 2020  .        |NULL  
+00026660: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00026670: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00026680: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026690: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+000266a0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+000266b0: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+000266c0: 7374 7228 636f 6c2c 2022 6368 6563 6b5f  str(col, "check_
+000266d0: 6a73 6f6e 2229 0a20 2020 2072 6574 7572  json").    retur
+000266e0: 6e20 6275 696c 7469 6e28 2263 6865 636b  n builtin("check
+000266f0: 5f6a 736f 6e22 2928 6329 0a0a 0a64 6566  _json")(c)...def
+00026700: 2063 6865 636b 5f78 6d6c 2863 6f6c 3a20   check_xml(col: 
+00026710: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+00026720: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+00026730: 4368 6563 6b73 2074 6865 2076 616c 6964  Checks the valid
+00026740: 6974 7920 6f66 2061 6e20 584d 4c20 646f  ity of an XML do
+00026750: 6375 6d65 6e74 2e0a 2020 2020 4966 2074  cument..    If t
+00026760: 6865 2069 6e70 7574 2073 7472 696e 6720  he input string 
+00026770: 6973 2061 2076 616c 6964 2058 4d4c 2064  is a valid XML d
+00026780: 6f63 756d 656e 7420 6f72 2061 204e 554c  ocument or a NUL
+00026790: 4c20 2869 2e65 2e20 6e6f 2065 7272 6f72  L (i.e. no error
+000267a0: 2077 6f75 6c64 206f 6363 7572 2077 6865   would occur whe
+000267b0: 6e20 7061 7273 696e 670a 2020 2020 7468  n parsing.    th
+000267c0: 6520 696e 7075 7420 7374 7269 6e67 292c  e input string),
+000267d0: 2074 6865 2066 756e 6374 696f 6e20 7265   the function re
+000267e0: 7475 726e 7320 4e55 4c4c 2e0a 2020 2020  turns NULL..    
+000267f0: 496e 2063 6173 6520 6f66 2061 6e20 584d  In case of an XM
+00026800: 4c20 7061 7273 696e 6720 6572 726f 722c  L parsing error,
+00026810: 2074 6865 206f 7574 7075 7420 7374 7269   the output stri
+00026820: 6e67 2063 6f6e 7461 696e 7320 7468 6520  ng contains the 
+00026830: 6572 726f 7220 6d65 7373 6167 652e 0a0a  error message...
+00026840: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00026850: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00026860: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+00026870: 6174 6166 7261 6d65 285b 223c 6e61 6d65  ataframe(["<name
+00026880: 3e20 5661 6c69 6420 3c2f 6e61 6d65 3e22  > Valid </name>"
+00026890: 2c20 223c 6e61 6d65 3e20 496e 7661 6c69  , "<name> Invali
+000268a0: 6420 3c2f 5752 4f4e 475f 434c 4f53 494e  d </WRONG_CLOSIN
+000268b0: 475f 5441 473e 222c 204e 6f6e 655d 2c20  G_TAG>", None], 
+000268c0: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
+000268d0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000268e0: 6563 7428 6368 6563 6b5f 786d 6c28 6466  ect(check_xml(df
+000268f0: 2e61 2929 2e73 686f 7728 290a 2020 2020  .a)).show().    
+00026900: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00026910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026930: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00026940: 7c22 4348 4543 4b5f 584d 4c28 2222 4122  |"CHECK_XML(""A"
+00026950: 2229 2220 2020 2020 2020 2020 2020 2020  ")"             
+00026960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026970: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00026980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000269a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000269b0: 2020 2020 2020 2020 7c4e 554c 4c20 2020          |NULL   
+000269c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269e0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+000269f0: 2020 2020 7c6e 6f20 6f70 656e 696e 6720      |no opening 
+00026a00: 7461 6720 666f 7220 3c2f 5752 4f4e 475f  tag for </WRONG_
+00026a10: 434c 4f53 494e 475f 5441 473e 2c20 706f  CLOSING_TAG>, po
+00026a20: 7320 3335 2020 7c0a 2020 2020 2020 2020  s 35  |.        
+00026a30: 7c4e 554c 4c20 2020 2020 2020 2020 2020  |NULL           
+00026a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00026a70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00026a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00026aa0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+00026ab0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+00026ac0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+00026ad0: 7472 2863 6f6c 2c20 2263 6865 636b 5f78  tr(col, "check_x
+00026ae0: 6d6c 2229 0a20 2020 2072 6574 7572 6e20  ml").    return 
+00026af0: 6275 696c 7469 6e28 2263 6865 636b 5f78  builtin("check_x
+00026b00: 6d6c 2229 2863 290a 0a0a 6465 6620 6a73  ml")(c)...def js
+00026b10: 6f6e 5f65 7874 7261 6374 5f70 6174 685f  on_extract_path_
+00026b20: 7465 7874 2863 6f6c 3a20 436f 6c75 6d6e  text(col: Column
+00026b30: 4f72 4e61 6d65 2c20 7061 7468 3a20 436f  OrName, path: Co
+00026b40: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00026b50: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00026b60: 2020 2050 6172 7365 7320 6120 4a53 4f4e     Parses a JSON
+00026b70: 2073 7472 696e 6720 616e 6420 7265 7475   string and retu
+00026b80: 726e 7320 7468 6520 7661 6c75 6520 6f66  rns the value of
+00026b90: 2061 6e20 656c 656d 656e 7420 6174 2061   an element at a
+00026ba0: 2073 7065 6369 6669 6564 2070 6174 6820   specified path 
+00026bb0: 696e 2074 6865 2072 6573 756c 7469 6e67  in the resulting
+00026bc0: 0a20 2020 204a 534f 4e20 646f 6375 6d65  .    JSON docume
+00026bd0: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
+00026be0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00026bf0: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00026c00: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
+00026c10: 7320 696d 706f 7274 206a 736f 6e5f 6578  s import json_ex
+00026c20: 7472 6163 745f 7061 7468 5f74 6578 742c  tract_path_text,
+00026c30: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
+00026c40: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00026c50: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00026c60: 6672 616d 6528 5b5b 7b22 6122 3a20 2266  frame([[{"a": "f
+00026c70: 6f6f 227d 2c20 2261 225d 2c20 5b7b 2261  oo"}, "a"], [{"a
+00026c80: 223a 204e 6f6e 657d 2c20 2261 225d 2c20  ": None}, "a"], 
+00026c90: 5b7b 2261 223a 2022 666f 6f22 7d2c 2022  [{"a": "foo"}, "
+00026ca0: 6222 5d2c 205b 4e6f 6e65 2c20 2261 225d  b"], [None, "a"]
+00026cb0: 5d2c 2073 6368 656d 613d 5b22 6b22 2c20  ], schema=["k", 
+00026cc0: 2276 225d 290a 2020 2020 2020 2020 3e3e  "v"]).        >>
+00026cd0: 3e20 6466 2e73 656c 6563 7428 6a73 6f6e  > df.select(json
+00026ce0: 5f65 7874 7261 6374 5f70 6174 685f 7465  _extract_path_te
+00026cf0: 7874 2874 6f5f 7661 7269 616e 7428 226b  xt(to_variant("k
+00026d00: 2229 2c20 2276 2229 2e61 735f 2822 7265  "), "v").as_("re
+00026d10: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
+00026d20: 2020 2020 2020 205b 526f 7728 5245 533d         [Row(RES=
+00026d30: 2766 6f6f 2729 2c20 526f 7728 5245 533d  'foo'), Row(RES=
+00026d40: 4e6f 6e65 292c 2052 6f77 2852 4553 3d4e  None), Row(RES=N
+00026d50: 6f6e 6529 2c20 526f 7728 5245 533d 4e6f  one), Row(RES=No
+00026d60: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
+00026d70: 2063 203d 205f 746f 5f63 6f6c 5f69 665f   c = _to_col_if_
+00026d80: 7374 7228 636f 6c2c 2022 6a73 6f6e 5f65  str(col, "json_e
+00026d90: 7874 7261 6374 5f70 6174 685f 7465 7874  xtract_path_text
+00026da0: 2229 0a20 2020 2070 203d 205f 746f 5f63  ").    p = _to_c
+00026db0: 6f6c 5f69 665f 7374 7228 7061 7468 2c20  ol_if_str(path, 
+00026dc0: 226a 736f 6e5f 6578 7472 6163 745f 7061  "json_extract_pa
+00026dd0: 7468 5f74 6578 7422 290a 2020 2020 7265  th_text").    re
+00026de0: 7475 726e 2062 7569 6c74 696e 2822 6a73  turn builtin("js
+00026df0: 6f6e 5f65 7874 7261 6374 5f70 6174 685f  on_extract_path_
+00026e00: 7465 7874 2229 2863 2c20 7029 0a0a 0a64  text")(c, p)...d
+00026e10: 6566 2070 6172 7365 5f6a 736f 6e28 653a  ef parse_json(e:
+00026e20: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00026e30: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00026e40: 2250 6172 7365 2074 6865 2076 616c 7565  "Parse the value
+00026e50: 206f 6620 7468 6520 7370 6563 6966 6965   of the specifie
+00026e60: 6420 636f 6c75 6d6e 2061 7320 6120 4a53  d column as a JS
+00026e70: 4f4e 2073 7472 696e 6720 616e 6420 7265  ON string and re
+00026e80: 7475 726e 7320 7468 650a 2020 2020 7265  turns the.    re
+00026e90: 7375 6c74 696e 6720 4a53 4f4e 2064 6f63  sulting JSON doc
+00026ea0: 756d 656e 742e 0a0a 2020 2020 4578 616d  ument...    Exam
+00026eb0: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
+00026ec0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+00026ed0: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
+00026ee0: 285b 5b27 7b22 6b65 7922 3a20 2231 227d  ([['{"key": "1"}
+00026ef0: 275d 5d2c 2073 6368 656d 613d 5b22 6122  ']], schema=["a"
+00026f00: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
+00026f10: 662e 7365 6c65 6374 2870 6172 7365 5f6a  f.select(parse_j
+00026f20: 736f 6e28 6466 5b22 6122 5d29 2e61 6c69  son(df["a"]).ali
+00026f30: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+00026f40: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00026f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00026f60: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00026f70: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00026f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00026f90: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+00026fa0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00026fb0: 207c 2020 226b 6579 223a 2022 3122 2020   |  "key": "1"  
+00026fc0: 7c0a 2020 2020 2020 2020 7c7d 2020 2020  |.        |}    
+00026fd0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00026fe0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+00026ff0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00027000: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+00027010: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+00027020: 6966 5f73 7472 2865 2c20 2270 6172 7365  if_str(e, "parse
+00027030: 5f6a 736f 6e22 290a 2020 2020 7265 7475  _json").    retu
+00027040: 726e 2062 7569 6c74 696e 2822 7061 7273  rn builtin("pars
+00027050: 655f 6a73 6f6e 2229 2863 290a 0a0a 6465  e_json")(c)...de
+00027060: 6620 7061 7273 655f 786d 6c28 653a 2043  f parse_xml(e: C
+00027070: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+00027080: 436f 6c75 6d6e 3a0a 2020 2020 2222 2250  Column:.    """P
+00027090: 6172 7365 2074 6865 2076 616c 7565 206f  arse the value o
+000270a0: 6620 7468 6520 7370 6563 6966 6965 6420  f the specified 
+000270b0: 636f 6c75 6d6e 2061 7320 6120 4a53 4f4e  column as a JSON
+000270c0: 2073 7472 696e 6720 616e 6420 7265 7475   string and retu
+000270d0: 726e 7320 7468 650a 2020 2020 7265 7375  rns the.    resu
+000270e0: 6c74 696e 6720 584d 4c20 646f 6375 6d65  lting XML docume
+000270f0: 6e74 2e0a 0a20 2020 2045 7861 6d70 6c65  nt...    Example
+00027100: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00027110: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+00027120: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+00027130: 2020 2273 656c 6563 7420 2863 6f6c 756d    "select (colum
+00027140: 6e31 2920 6173 2076 2066 726f 6d20 7661  n1) as v from va
+00027150: 6c75 6573 2028 273c 7431 3e66 6f6f 3c74  lues ('<t1>foo<t
+00027160: 323e 6261 723c 2f74 323e 3c74 333e 3c2f  2>bar</t2><t3></
+00027170: 7433 3e3c 2f74 313e 2729 2c20 220a 2020  t3></t1>'), ".  
+00027180: 2020 2020 2020 2e2e 2e20 2020 2020 2228        ...     "(
+00027190: 273c 7431 3e3c 2f74 313e 2729 220a 2020  '<t1></t1>')".  
+000271a0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
+000271b0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+000271c0: 7428 7061 7273 655f 786d 6c28 2276 2229  t(parse_xml("v")
+000271d0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+000271e0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+000271f0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00027200: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00027210: 5355 4c54 2220 2020 2020 2020 207c 0a20  SULT"        |. 
+00027220: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00027230: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00027240: 2020 7c3c 7431 3e20 2020 2020 2020 2020    |<t1>         
+00027250: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+00027260: 666f 6f20 2020 2020 2020 2020 2020 7c0a  foo           |.
+00027270: 2020 2020 2020 2020 7c20 203c 7432 3e62          |  <t2>b
+00027280: 6172 3c2f 7432 3e20 207c 0a20 2020 2020  ar</t2>  |.     
+00027290: 2020 207c 2020 3c74 333e 3c2f 7433 3e20     |  <t3></t3> 
+000272a0: 2020 2020 7c0a 2020 2020 2020 2020 7c3c      |.        |<
+000272b0: 2f74 313e 2020 2020 2020 2020 2020 207c  /t1>           |
+000272c0: 0a20 2020 2020 2020 207c 3c74 313e 3c2f  .        |<t1></
+000272d0: 7431 3e20 2020 2020 2020 7c0a 2020 2020  t1>       |.    
+000272e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000272f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+00027300: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+00027310: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+00027320: 6f6c 5f69 665f 7374 7228 652c 2022 7061  ol_if_str(e, "pa
+00027330: 7273 655f 786d 6c22 290a 2020 2020 7265  rse_xml").    re
+00027340: 7475 726e 2062 7569 6c74 696e 2822 7061  turn builtin("pa
+00027350: 7273 655f 786d 6c22 2928 6329 0a0a 0a64  rse_xml")(c)...d
+00027360: 6566 2073 7472 6970 5f6e 756c 6c5f 7661  ef strip_null_va
+00027370: 6c75 6528 636f 6c3a 2043 6f6c 756d 6e4f  lue(col: ColumnO
+00027380: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+00027390: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
+000273a0: 7320 6120 4a53 4f4e 2022 6e75 6c6c 2220  s a JSON "null" 
+000273b0: 7661 6c75 6520 696e 2074 6865 2073 7065  value in the spe
+000273c0: 6369 6669 6564 2063 6f6c 756d 6e20 746f  cified column to
+000273d0: 2061 2053 514c 204e 554c 4c20 7661 6c75   a SQL NULL valu
+000273e0: 652e 0a20 2020 2041 6c6c 206f 7468 6572  e..    All other
+000273f0: 2056 4152 4941 4e54 2076 616c 7565 7320   VARIANT values 
+00027400: 696e 2074 6865 2063 6f6c 756d 6e20 6172  in the column ar
+00027410: 6520 7265 7475 726e 6564 2075 6e63 6861  e returned uncha
+00027420: 6e67 6564 2e0a 0a20 2020 2045 7861 6d70  nged...    Examp
+00027430: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00027440: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00027450: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
+00027460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00027470: 5b22 6e75 6c6c 222c 2022 3122 5d2c 0a20  ["null", "1"],. 
+00027480: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
+00027490: 6368 656d 613d 5b22 5322 5d2c 0a20 2020  chema=["S"],.   
+000274a0: 2020 2020 202e 2e2e 2029 2e73 656c 6563       ... ).selec
+000274b0: 7428 7374 7269 705f 6e75 6c6c 5f76 616c  t(strip_null_val
+000274c0: 7565 2870 6172 7365 5f6a 736f 6e28 636f  ue(parse_json(co
+000274d0: 6c28 2253 2229 2929 2e61 735f 2822 4222  l("S"))).as_("B"
+000274e0: 2929 2e77 6865 7265 280a 2020 2020 2020  )).where(.      
+000274f0: 2020 2e2e 2e20 2020 2020 7371 6c5f 6578    ...     sql_ex
+00027500: 7072 2822 4220 6973 206e 756c 6c22 290a  pr("B is null").
+00027510: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+00027520: 2020 2020 2020 3e3e 3e20 6466 2e63 6f6c        >>> df.col
+00027530: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00027540: 526f 7728 423d 4e6f 6e65 295d 0a20 2020  Row(B=None)].   
+00027550: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00027560: 5f63 6f6c 5f69 665f 7374 7228 636f 6c2c  _col_if_str(col,
+00027570: 2022 7374 7269 705f 6e75 6c6c 5f76 616c   "strip_null_val
+00027580: 7565 2229 0a20 2020 2072 6574 7572 6e20  ue").    return 
+00027590: 6275 696c 7469 6e28 2273 7472 6970 5f6e  builtin("strip_n
+000275a0: 756c 6c5f 7661 6c75 6522 2928 6329 0a0a  ull_value")(c)..
+000275b0: 0a64 6566 2061 7272 6179 5f61 6767 2863  .def array_agg(c
+000275c0: 6f6c 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ol: ColumnOrName
+000275d0: 2c20 6973 5f64 6973 7469 6e63 743a 2062  , is_distinct: b
+000275e0: 6f6f 6c20 3d20 4661 6c73 6529 202d 3e20  ool = False) -> 
+000275f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
+00027600: 6574 7572 6e73 2074 6865 2069 6e70 7574  eturns the input
+00027610: 2076 616c 7565 732c 2070 6976 6f74 6564   values, pivoted
+00027620: 2069 6e74 6f20 616e 2041 5252 4159 2e20   into an ARRAY. 
+00027630: 4966 2074 6865 2069 6e70 7574 2069 7320  If the input is 
+00027640: 656d 7074 792c 2061 6e20 656d 7074 790a  empty, an empty.
+00027650: 2020 2020 4152 5241 5920 6973 2072 6574      ARRAY is ret
+00027660: 7572 6e65 642e 0a0a 2020 2020 4578 616d  urned...    Exam
+00027670: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00027680: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00027690: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+000276a0: 5b5b 315d 2c20 5b32 5d2c 205b 335d 2c20  [[1], [2], [3], 
+000276b0: 5b31 5d5d 2c20 7363 6865 6d61 3d5b 2261  [1]], schema=["a
+000276c0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
+000276d0: 6466 2e73 656c 6563 7428 6172 7261 795f  df.select(array_
+000276e0: 6167 6728 2261 222c 2054 7275 6529 2e61  agg("a", True).a
+000276f0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+00027700: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+00027710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00027720: 2020 2020 7c22 5245 5355 4c54 2220 207c      |"RESULT"  |
+00027730: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00027740: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c5b  -----.        |[
+00027750: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00027760: 2020 207c 2020 312c 2020 2020 2020 7c0a     |  1,      |.
+00027770: 2020 2020 2020 2020 7c20 2032 2c20 2020          |  2,   
+00027780: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+00027790: 3320 2020 2020 2020 7c0a 2020 2020 2020  3       |.      
+000277a0: 2020 7c5d 2020 2020 2020 2020 207c 0a20    |]         |. 
+000277b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000277c0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+000277d0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+000277e0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+000277f0: 6966 5f73 7472 2863 6f6c 2c20 2261 7272  if_str(col, "arr
+00027800: 6179 5f61 6767 2229 0a20 2020 2072 6574  ay_agg").    ret
+00027810: 7572 6e20 5f63 616c 6c5f 6675 6e63 7469  urn _call_functi
+00027820: 6f6e 2822 6172 7261 795f 6167 6722 2c20  on("array_agg", 
+00027830: 6973 5f64 6973 7469 6e63 742c 2063 290a  is_distinct, c).
+00027840: 0a0a 6465 6620 6172 7261 795f 6170 7065  ..def array_appe
+00027850: 6e64 2861 7272 6179 3a20 436f 6c75 6d6e  nd(array: Column
+00027860: 4f72 4e61 6d65 2c20 656c 656d 656e 743a  OrName, element:
+00027870: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00027880: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00027890: 2252 6574 7572 6e73 2061 6e20 4152 5241  "Returns an ARRA
+000278a0: 5920 636f 6e74 6169 6e69 6e67 2061 6c6c  Y containing all
+000278b0: 2065 6c65 6d65 6e74 7320 6672 6f6d 2074   elements from t
+000278c0: 6865 2073 6f75 7263 6520 4152 5241 5920  he source ARRAY 
+000278d0: 6173 2077 656c 6c20 6173 2074 6865 206e  as well as the n
+000278e0: 6577 2065 6c65 6d65 6e74 2e0a 2020 2020  ew element..    
+000278f0: 5468 6520 6e65 7720 656c 656d 656e 7420  The new element 
+00027900: 6973 206c 6f63 6174 6564 2061 7420 656e  is located at en
+00027910: 6420 6f66 2074 6865 2041 5252 4159 2e0a  d of the ARRAY..
+00027920: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00027930: 2020 2061 7272 6179 3a20 5468 6520 636f     array: The co
+00027940: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+00027950: 7468 6520 736f 7572 6365 2041 5252 4159  the source ARRAY
+00027960: 2e0a 2020 2020 2020 2020 656c 656d 656e  ..        elemen
+00027970: 743a 2054 6865 2063 6f6c 756d 6e20 636f  t: The column co
+00027980: 6e74 6169 6e69 6e67 2074 6865 2065 6c65  ntaining the ele
+00027990: 6d65 6e74 2074 6f20 6265 2061 7070 656e  ment to be appen
+000279a0: 6465 642e 2054 6865 2065 6c65 6d65 6e74  ded. The element
+000279b0: 206d 6179 2062 6520 6f66 2061 6c6d 6f73   may be of almos
+000279c0: 740a 2020 2020 2020 2020 2020 2020 616e  t.            an
+000279d0: 7920 6461 7461 2074 7970 652e 2054 6865  y data type. The
+000279e0: 2064 6174 6120 7479 7065 2064 6f65 7320   data type does 
+000279f0: 6e6f 7420 6e65 6564 2074 6f20 6d61 7463  not need to matc
+00027a00: 6820 7468 6520 6461 7461 2074 7970 6528  h the data type(
+00027a10: 7329 206f 6620 7468 650a 2020 2020 2020  s) of the.      
+00027a20: 2020 2020 2020 6578 6973 7469 6e67 2065        existing e
+00027a30: 6c65 6d65 6e74 7320 696e 2074 6865 2041  lements in the A
+00027a40: 5252 4159 2e0a 0a20 2020 2045 7861 6d70  RRAY...    Examp
+00027a50: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+00027a60: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+00027a70: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
+00027a80: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
+00027a90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00027aa0: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
+00027ab0: 6f77 2861 3d5b 312c 2032 2c20 335d 295d  ow(a=[1, 2, 3])]
+00027ac0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00027ad0: 2e73 656c 6563 7428 6172 7261 795f 6170  .select(array_ap
+00027ae0: 7065 6e64 2822 6122 2c20 6c69 7428 3429  pend("a", lit(4)
+00027af0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+00027b00: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+00027b10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00027b20: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00027b30: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00027b40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00027b50: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
+00027b60: 2020 2020 2020 7c20 2031 2c20 2020 2020        |  1,     
+00027b70: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
+00027b80: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00027b90: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
+00027ba0: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
+00027bb0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00027bc0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00027bd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00027be0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00027bf0: 2020 2020 2222 220a 2020 2020 6120 3d20      """.    a = 
+00027c00: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+00027c10: 7272 6179 2c20 2261 7272 6179 5f61 7070  rray, "array_app
+00027c20: 656e 6422 290a 2020 2020 6520 3d20 5f74  end").    e = _t
+00027c30: 6f5f 636f 6c5f 6966 5f73 7472 2865 6c65  o_col_if_str(ele
+00027c40: 6d65 6e74 2c20 2261 7272 6179 5f61 7070  ment, "array_app
+00027c50: 656e 6422 290a 2020 2020 7265 7475 726e  end").    return
+00027c60: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
+00027c70: 6170 7065 6e64 2229 2861 2c20 6529 0a0a  append")(a, e)..
+00027c80: 0a64 6566 2061 7272 6179 5f63 6174 2861  .def array_cat(a
+00027c90: 7272 6179 313a 2043 6f6c 756d 6e4f 724e  rray1: ColumnOrN
+00027ca0: 616d 652c 2061 7272 6179 323a 2043 6f6c  ame, array2: Col
+00027cb0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00027cc0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00027cd0: 7572 6e73 2074 6865 2063 6f6e 6361 7465  urns the concate
+00027ce0: 6e61 7469 6f6e 206f 6620 7477 6f20 4152  nation of two AR
+00027cf0: 5241 5973 2e0a 0a20 2020 2041 7267 733a  RAYs...    Args:
+00027d00: 0a20 2020 2020 2020 2061 7272 6179 313a  .        array1:
+00027d10: 2043 6f6c 756d 6e20 636f 6e74 6169 6e69   Column containi
+00027d20: 6e67 2074 6865 2073 6f75 7263 6520 4152  ng the source AR
+00027d30: 5241 592e 0a20 2020 2020 2020 2061 7272  RAY..        arr
+00027d40: 6179 323a 2043 6f6c 756d 6e20 636f 6e74  ay2: Column cont
+00027d50: 6169 6e69 6e67 2074 6865 2041 5252 4159  aining the ARRAY
+00027d60: 2074 6f20 6265 2061 7070 656e 6465 6420   to be appended 
+00027d70: 746f 2061 7272 6179 312e 0a0a 2020 2020  to array1...    
+00027d80: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+00027d90: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00027da0: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
+00027db0: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
+00027dc0: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00027dd0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00027de0: 6d65 285b 526f 7728 613d 5b31 2c20 322c  me([Row(a=[1, 2,
+00027df0: 2033 5d2c 2062 3d5b 342c 2035 5d29 5d29   3], b=[4, 5])])
+00027e00: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00027e10: 7365 6c65 6374 2861 7272 6179 5f63 6174  select(array_cat
+00027e20: 2822 6122 2c20 2262 2229 2e61 6c69 6173  ("a", "b").alias
+00027e30: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
+00027e40: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
+00027e50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00027e60: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
+00027e70: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00027e80: 2d0a 2020 2020 2020 2020 7c5b 2020 2020  -.        |[    
+00027e90: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00027ea0: 2020 312c 2020 2020 2020 7c0a 2020 2020    1,      |.    
+00027eb0: 2020 2020 7c20 2032 2c20 2020 2020 207c      |  2,      |
+00027ec0: 0a20 2020 2020 2020 207c 2020 332c 2020  .        |  3,  
+00027ed0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00027ee0: 2034 2c20 2020 2020 207c 0a20 2020 2020   4,      |.     
+00027ef0: 2020 207c 2020 3520 2020 2020 2020 7c0a     |  5       |.
+00027f00: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
+00027f10: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00027f20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00027f30: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00027f40: 2020 2222 220a 2020 2020 6131 203d 205f    """.    a1 = _
+00027f50: 746f 5f63 6f6c 5f69 665f 7374 7228 6172  to_col_if_str(ar
+00027f60: 7261 7931 2c20 2261 7272 6179 5f63 6174  ray1, "array_cat
+00027f70: 2229 0a20 2020 2061 3220 3d20 5f74 6f5f  ").    a2 = _to_
+00027f80: 636f 6c5f 6966 5f73 7472 2861 7272 6179  col_if_str(array
+00027f90: 322c 2022 6172 7261 795f 6361 7422 290a  2, "array_cat").
+00027fa0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00027fb0: 696e 2822 6172 7261 795f 6361 7422 2928  in("array_cat")(
+00027fc0: 6131 2c20 6132 290a 0a0a 6465 6620 6172  a1, a2)...def ar
+00027fd0: 7261 795f 636f 6d70 6163 7428 6172 7261  ray_compact(arra
+00027fe0: 793a 2043 6f6c 756d 6e4f 724e 616d 6529  y: ColumnOrName)
+00027ff0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00028000: 2222 2252 6574 7572 6e73 2061 2063 6f6d  """Returns a com
+00028010: 7061 6374 6564 2041 5252 4159 2077 6974  pacted ARRAY wit
+00028020: 6820 6d69 7373 696e 6720 616e 6420 6e75  h missing and nu
+00028030: 6c6c 2076 616c 7565 7320 7265 6d6f 7665  ll values remove
+00028040: 642c 0a20 2020 2065 6666 6563 7469 7665  d,.    effective
+00028050: 6c79 2063 6f6e 7665 7274 696e 6720 7370  ly converting sp
+00028060: 6172 7365 2061 7272 6179 7320 696e 746f  arse arrays into
+00028070: 2064 656e 7365 2061 7272 6179 732e 0a0a   dense arrays...
+00028080: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00028090: 2020 6172 7261 793a 2043 6f6c 756d 6e20    array: Column 
+000280a0: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
+000280b0: 6f75 7263 6520 4152 5241 5920 746f 2062  ource ARRAY to b
+000280c0: 6520 636f 6d70 6163 7465 640a 0a20 2020  e compacted..   
+000280d0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+000280e0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+000280f0: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+00028100: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+00028110: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00028120: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00028130: 616d 6528 5b52 6f77 2861 3d5b 312c 204e  ame([Row(a=[1, N
+00028140: 6f6e 652c 2033 5d29 5d29 0a20 2020 2020  one, 3])]).     
+00028150: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00028160: 2822 6122 2c20 6172 7261 795f 636f 6d70  ("a", array_comp
+00028170: 6163 7428 2261 2229 2e61 6c69 6173 2822  act("a").alias("
+00028180: 636f 6d70 6163 7465 6422 2929 2e73 686f  compacted")).sho
+00028190: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+000281a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000281b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+000281c0: 4122 2020 2020 2020 7c22 434f 4d50 4143  A"      |"COMPAC
+000281d0: 5445 4422 2020 7c0a 2020 2020 2020 2020  TED"  |.        
+000281e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000281f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00028200: 2020 7c5b 2020 2020 2020 2020 7c5b 2020    |[        |[  
+00028210: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+00028220: 2020 2020 7c20 2031 2c20 2020 2020 7c20      |  1,     | 
+00028230: 2031 2c20 2020 2020 2020 2020 7c0a 2020   1,         |.  
+00028240: 2020 2020 2020 7c20 206e 756c 6c2c 2020        |  null,  
+00028250: 7c20 2033 2020 2020 2020 2020 2020 7c0a  |  3          |.
+00028260: 2020 2020 2020 2020 7c20 2033 2020 2020          |  3    
+00028270: 2020 7c5d 2020 2020 2020 2020 2020 2020    |]            
+00028280: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00028290: 2020 2020 7c20 2020 2020 2020 2020 2020      |           
+000282a0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000282b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000282c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+000282d0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+000282e0: 220a 2020 2020 6120 3d20 5f74 6f5f 636f  ".    a = _to_co
+000282f0: 6c5f 6966 5f73 7472 2861 7272 6179 2c20  l_if_str(array, 
+00028300: 2261 7272 6179 5f63 6f6d 7061 6374 2229  "array_compact")
+00028310: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+00028320: 7469 6e28 2261 7272 6179 5f63 6f6d 7061  tin("array_compa
+00028330: 6374 2229 2861 290a 0a0a 6465 6620 6172  ct")(a)...def ar
+00028340: 7261 795f 636f 6e73 7472 7563 7428 2a63  ray_construct(*c
+00028350: 6f6c 733a 2043 6f6c 756d 6e4f 724e 616d  ols: ColumnOrNam
+00028360: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+00028370: 2020 2222 2252 6574 7572 6e73 2061 6e20    """Returns an 
+00028380: 4152 5241 5920 636f 6e73 7472 7563 7465  ARRAY constructe
+00028390: 6420 6672 6f6d 207a 6572 6f2c 206f 6e65  d from zero, one
+000283a0: 2c20 6f72 206d 6f72 6520 696e 7075 7473  , or more inputs
+000283b0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+000283c0: 2020 2020 2063 6f6c 733a 2043 6f6c 756d       cols: Colum
+000283d0: 6e73 2063 6f6e 7461 696e 696e 6720 7468  ns containing th
+000283e0: 6520 7661 6c75 6573 2028 6f72 2065 7870  e values (or exp
+000283f0: 7265 7373 696f 6e73 2074 6861 7420 6576  ressions that ev
+00028400: 616c 7561 7465 2074 6f20 7661 6c75 6573  aluate to values
+00028410: 292e 2054 6865 0a20 2020 2020 2020 2020  ). The.         
+00028420: 2020 2076 616c 7565 7320 646f 206e 6f74     values do not
+00028430: 2061 6c6c 206e 6565 6420 746f 2062 6520   all need to be 
+00028440: 6f66 2074 6865 2073 616d 6520 6461 7461  of the same data
+00028450: 2074 7970 652e 0a0a 2020 2020 4578 616d   type...    Exam
+00028460: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+00028470: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00028480: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00028490: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
+000284a0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+000284b0: 6222 5d29 0a20 2020 2020 2020 203e 3e3e  b"]).        >>>
+000284c0: 2064 662e 7365 6c65 6374 2861 7272 6179   df.select(array
+000284d0: 5f63 6f6e 7374 7275 6374 2822 6122 2c20  _construct("a", 
+000284e0: 2262 2229 2e61 6c69 6173 2822 7265 7375  "b").alias("resu
+000284f0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00028500: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00028510: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00028520: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+00028530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00028540: 2020 2020 7c5b 2020 2020 2020 2020 207c      |[         |
+00028550: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
+00028560: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00028570: 2032 2020 2020 2020 207c 0a20 2020 2020   2       |.     
+00028580: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+00028590: 2020 2020 2020 2020 7c5b 2020 2020 2020          |[      
+000285a0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+000285b0: 332c 2020 2020 2020 7c0a 2020 2020 2020  3,      |.      
+000285c0: 2020 7c20 2034 2020 2020 2020 207c 0a20    |  4       |. 
+000285d0: 2020 2020 2020 207c 5d20 2020 2020 2020         |]       
+000285e0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000285f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00028600: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+00028610: 2022 2222 0a20 2020 2063 7320 3d20 5b5f   """.    cs = [_
+00028620: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
+00028630: 2022 6172 7261 795f 636f 6e73 7472 7563   "array_construc
+00028640: 7422 2920 666f 7220 6320 696e 2063 6f6c  t") for c in col
+00028650: 735d 0a20 2020 2072 6574 7572 6e20 6275  s].    return bu
+00028660: 696c 7469 6e28 2261 7272 6179 5f63 6f6e  iltin("array_con
+00028670: 7374 7275 6374 2229 282a 6373 290a 0a0a  struct")(*cs)...
+00028680: 6465 6620 6172 7261 795f 636f 6e73 7472  def array_constr
+00028690: 7563 745f 636f 6d70 6163 7428 2a63 6f6c  uct_compact(*col
+000286a0: 733a 2043 6f6c 756d 6e4f 724e 616d 6529  s: ColumnOrName)
+000286b0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+000286c0: 2222 2252 6574 7572 6e73 2061 6e20 4152  """Returns an AR
+000286d0: 5241 5920 636f 6e73 7472 7563 7465 6420  RAY constructed 
+000286e0: 6672 6f6d 207a 6572 6f2c 206f 6e65 2c20  from zero, one, 
+000286f0: 6f72 206d 6f72 6520 696e 7075 7473 2e0a  or more inputs..
+00028700: 2020 2020 5468 6520 636f 6e73 7472 7563      The construc
+00028710: 7465 6420 4152 5241 5920 6f6d 6974 7320  ted ARRAY omits 
+00028720: 616e 7920 4e55 4c4c 2069 6e70 7574 2076  any NULL input v
+00028730: 616c 7565 732e 0a0a 2020 2020 4172 6773  alues...    Args
+00028740: 3a0a 2020 2020 2020 2020 636f 6c73 3a20  :.        cols: 
+00028750: 436f 6c75 6d6e 7320 636f 6e74 6169 6e69  Columns containi
+00028760: 6e67 2074 6865 2076 616c 7565 7320 286f  ng the values (o
+00028770: 7220 6578 7072 6573 7369 6f6e 7320 7468  r expressions th
+00028780: 6174 2065 7661 6c75 6174 6520 746f 2076  at evaluate to v
+00028790: 616c 7565 7329 2e20 5468 650a 2020 2020  alues). The.    
+000287a0: 2020 2020 2020 2020 7661 6c75 6573 2064          values d
+000287b0: 6f20 6e6f 7420 616c 6c20 6e65 6564 2074  o not all need t
+000287c0: 6f20 6265 206f 6620 7468 6520 7361 6d65  o be of the same
+000287d0: 2064 6174 6120 7479 7065 2e0a 0a20 2020   data type...   
+000287e0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+000287f0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+00028800: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00028810: 7261 6d65 285b 5b31 2c20 4e6f 6e65 2c20  rame([[1, None, 
+00028820: 325d 2c20 5b33 2c20 4e6f 6e65 2c20 345d  2], [3, None, 4]
+00028830: 5d2c 2073 6368 656d 613d 5b22 6122 2c20  ], schema=["a", 
+00028840: 2262 222c 2022 6322 5d29 0a20 2020 2020  "b", "c"]).     
+00028850: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00028860: 2861 7272 6179 5f63 6f6e 7374 7275 6374  (array_construct
+00028870: 5f63 6f6d 7061 6374 2822 6122 2c20 2262  _compact("a", "b
+00028880: 222c 2022 6322 292e 616c 6961 7328 2272  ", "c").alias("r
+00028890: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+000288a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000288b0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+000288c0: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
 000288d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-000288e0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000288f0: 453e 0a20 2020 2022 2222 0a20 2020 2061  E>.    """.    a
-00028900: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00028910: 7228 6172 7261 792c 2022 6172 7261 795f  r(array, "array_
-00028920: 7072 6570 656e 6422 290a 2020 2020 6520  prepend").    e 
-00028930: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00028940: 2865 6c65 6d65 6e74 2c20 2261 7272 6179  (element, "array
-00028950: 5f70 7265 7065 6e64 2229 0a20 2020 2072  _prepend").    r
-00028960: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
-00028970: 7272 6179 5f70 7265 7065 6e64 2229 2861  rray_prepend")(a
-00028980: 2c20 6529 0a0a 0a64 6566 2061 7272 6179  , e)...def array
-00028990: 5f73 697a 6528 6172 7261 793a 2043 6f6c  _size(array: Col
-000289a0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-000289b0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-000289c0: 7572 6e73 2074 6865 2073 697a 6520 6f66  urns the size of
-000289d0: 2074 6865 2069 6e70 7574 2041 5252 4159   the input ARRAY
-000289e0: 2e0a 0a20 2020 2049 6620 7468 6520 7370  ...    If the sp
-000289f0: 6563 6966 6965 6420 636f 6c75 6d6e 2063  ecified column c
-00028a00: 6f6e 7461 696e 7320 6120 5641 5249 414e  ontains a VARIAN
-00028a10: 5420 7661 6c75 6520 7468 6174 2063 6f6e  T value that con
-00028a20: 7461 696e 7320 616e 2041 5252 4159 2c20  tains an ARRAY, 
-00028a30: 7468 6520 7369 7a65 206f 6620 7468 6520  the size of the 
-00028a40: 4152 5241 590a 2020 2020 6973 2072 6574  ARRAY.    is ret
-00028a50: 7572 6e65 643b 206f 7468 6572 7769 7365  urned; otherwise
-00028a60: 2c20 4e55 4c4c 2069 7320 7265 7475 726e  , NULL is return
-00028a70: 6564 2069 6620 7468 6520 7661 6c75 6520  ed if the value 
-00028a80: 6973 206e 6f74 2061 6e20 4152 5241 592e  is not an ARRAY.
-00028a90: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00028aa0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00028ab0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00028ac0: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
-00028ad0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00028ae0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00028af0: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
-00028b00: 5b31 2c20 322c 2033 5d29 5d29 0a20 2020  [1, 2, 3])]).   
-00028b10: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00028b20: 6374 2861 7272 6179 5f73 697a 6528 2261  ct(array_size("a
-00028b30: 2229 2e61 6c69 6173 2822 7265 7375 6c74  ").alias("result
-00028b40: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-00028b50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-00028b60: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-00028b70: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-00028b80: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00028b90: 2020 7c33 2020 2020 2020 2020 207c 0a20    |3         |. 
-00028ba0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00028bb0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00028bc0: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00028bd0: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
-00028be0: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
-00028bf0: 7272 6179 5f73 697a 6522 290a 2020 2020  rray_size").    
-00028c00: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-00028c10: 6172 7261 795f 7369 7a65 2229 2861 290a  array_size")(a).
-00028c20: 0a0a 6465 6620 6172 7261 795f 736c 6963  ..def array_slic
-00028c30: 6528 6172 7261 793a 2043 6f6c 756d 6e4f  e(array: ColumnO
-00028c40: 724e 616d 652c 2066 726f 6d5f 3a20 436f  rName, from_: Co
-00028c50: 6c75 6d6e 4f72 4e61 6d65 2c20 746f 3a20  lumnOrName, to: 
-00028c60: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00028c70: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00028c80: 5265 7475 726e 7320 616e 2041 5252 4159  Returns an ARRAY
-00028c90: 2063 6f6e 7374 7275 6374 6564 2066 726f   constructed fro
-00028ca0: 6d20 6120 7370 6563 6966 6965 6420 7375  m a specified su
-00028cb0: 6273 6574 206f 6620 656c 656d 656e 7473  bset of elements
-00028cc0: 206f 6620 7468 6520 696e 7075 7420 4152   of the input AR
-00028cd0: 5241 592e 0a0a 2020 2020 4172 6773 3a0a  RAY...    Args:.
-00028ce0: 2020 2020 2020 2020 6172 7261 793a 2043          array: C
-00028cf0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
-00028d00: 2074 6865 2073 6f75 7263 6520 4152 5241   the source ARRA
-00028d10: 592e 0a20 2020 2020 2020 2066 726f 6d5f  Y..        from_
-00028d20: 3a20 436f 6c75 6d6e 2063 6f6e 7461 696e  : Column contain
-00028d30: 696e 6720 6120 706f 7369 7469 6f6e 2069  ing a position i
-00028d40: 6e20 7468 6520 736f 7572 6365 2041 5252  n the source ARR
-00028d50: 4159 2e20 5468 6520 706f 7369 7469 6f6e  AY. The position
-00028d60: 206f 6620 7468 6520 6669 7273 740a 2020   of the first.  
-00028d70: 2020 2020 2020 2020 2020 656c 656d 656e            elemen
-00028d80: 7420 6973 2030 2e20 456c 656d 656e 7473  t is 0. Elements
-00028d90: 2066 726f 6d20 706f 7369 7469 6f6e 7320   from positions 
-00028da0: 6c65 7373 2074 6861 6e20 7468 6973 2070  less than this p
-00028db0: 6172 616d 6574 6572 2061 7265 0a20 2020  arameter are.   
-00028dc0: 2020 2020 2020 2020 206e 6f74 2069 6e63           not inc
-00028dd0: 6c75 6465 6420 696e 2074 6865 2072 6573  luded in the res
-00028de0: 756c 7469 6e67 2041 5252 4159 2e0a 2020  ulting ARRAY..  
-00028df0: 2020 2020 2020 746f 3a20 436f 6c75 6d6e        to: Column
-00028e00: 2063 6f6e 7461 696e 696e 6720 6120 706f   containing a po
-00028e10: 7369 7469 6f6e 2069 6e20 7468 6520 736f  sition in the so
-00028e20: 7572 6365 2041 5252 4159 2e20 456c 656d  urce ARRAY. Elem
-00028e30: 656e 7473 2066 726f 6d20 706f 7369 7469  ents from positi
-00028e40: 6f6e 7320 6571 7561 6c20 746f 0a20 2020  ons equal to.   
-00028e50: 2020 2020 2020 2020 206f 7220 6772 6561           or grea
-00028e60: 7465 7220 7468 616e 2074 6869 7320 7061  ter than this pa
-00028e70: 7261 6d65 7465 7220 6172 6520 6e6f 7420  rameter are not 
-00028e80: 696e 636c 7564 6564 2069 6e20 7468 6520  included in the 
-00028e90: 7265 7375 6c74 696e 6720 6172 7261 792e  resulting array.
-00028ea0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00028eb0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00028ec0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00028ed0: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
-00028ee0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00028ef0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00028f00: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
-00028f10: 5b31 2c20 322c 2033 2c20 342c 2035 5d29  [1, 2, 3, 4, 5])
-00028f20: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00028f30: 662e 7365 6c65 6374 2861 7272 6179 5f73  f.select(array_s
-00028f40: 6c69 6365 2822 6122 2c20 6c69 7428 3129  lice("a", lit(1)
-00028f50: 2c20 6c69 7428 3329 292e 616c 6961 7328  , lit(3)).alias(
-00028f60: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00028f70: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00028f80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00028f90: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00028fa0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00028fb0: 0a20 2020 2020 2020 207c 5b20 2020 2020  .        |[     
-00028fc0: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
-00028fd0: 2032 2c20 2020 2020 207c 0a20 2020 2020   2,      |.     
-00028fe0: 2020 207c 2020 3320 2020 2020 2020 7c0a     |  3       |.
-00028ff0: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
-00029000: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00029010: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00029020: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00029030: 2020 2222 220a 2020 2020 6120 3d20 5f74    """.    a = _t
-00029040: 6f5f 636f 6c5f 6966 5f73 7472 2861 7272  o_col_if_str(arr
-00029050: 6179 2c20 2261 7272 6179 5f73 6c69 6365  ay, "array_slice
-00029060: 2229 0a20 2020 2066 203d 205f 746f 5f63  ").    f = _to_c
-00029070: 6f6c 5f69 665f 7374 7228 6672 6f6d 5f2c  ol_if_str(from_,
-00029080: 2022 6172 7261 795f 736c 6963 6522 290a   "array_slice").
-00029090: 2020 2020 7420 3d20 5f74 6f5f 636f 6c5f      t = _to_col_
-000290a0: 6966 5f73 7472 2874 6f2c 2022 6172 7261  if_str(to, "arra
-000290b0: 795f 736c 6963 6522 290a 2020 2020 7265  y_slice").    re
-000290c0: 7475 726e 2062 7569 6c74 696e 2822 6172  turn builtin("ar
-000290d0: 7261 795f 736c 6963 6522 2928 612c 2066  ray_slice")(a, f
-000290e0: 2c20 7429 0a0a 0a64 6566 2061 7272 6179  , t)...def array
-000290f0: 5f74 6f5f 7374 7269 6e67 2861 7272 6179  _to_string(array
-00029100: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-00029110: 7365 7061 7261 746f 723a 2043 6f6c 756d  separator: Colum
-00029120: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-00029130: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-00029140: 6e73 2061 6e20 696e 7075 7420 4152 5241  ns an input ARRA
-00029150: 5920 636f 6e76 6572 7465 6420 746f 2061  Y converted to a
-00029160: 2073 7472 696e 6720 6279 2063 6173 7469   string by casti
-00029170: 6e67 2061 6c6c 2076 616c 7565 7320 746f  ng all values to
-00029180: 2073 7472 696e 6773 2028 7573 696e 670a   strings (using.
-00029190: 2020 2020 544f 5f56 4152 4348 4152 2920      TO_VARCHAR) 
-000291a0: 616e 6420 636f 6e63 6174 656e 6174 696e  and concatenatin
-000291b0: 6720 7468 656d 2028 7573 696e 6720 7468  g them (using th
-000291c0: 6520 7374 7269 6e67 2066 726f 6d20 7468  e string from th
-000291d0: 6520 7365 636f 6e64 2061 7267 756d 656e  e second argumen
-000291e0: 7420 746f 2073 6570 6172 6174 650a 2020  t to separate.  
-000291f0: 2020 7468 6520 656c 656d 656e 7473 292e    the elements).
-00029200: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00029210: 2020 2020 6172 7261 793a 2043 6f6c 756d      array: Colum
-00029220: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
-00029230: 2041 5252 4159 206f 6620 656c 656d 656e   ARRAY of elemen
-00029240: 7473 2074 6f20 636f 6e76 6572 7420 746f  ts to convert to
-00029250: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
-00029260: 2020 2073 6570 6172 6174 6f72 3a20 436f     separator: Co
-00029270: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
-00029280: 7468 6520 7374 7269 6e67 2074 6f20 7075  the string to pu
-00029290: 7420 6265 7477 6565 6e20 6561 6368 2065  t between each e
-000292a0: 6c65 6d65 6e74 2028 652e 672e 2061 2073  lement (e.g. a s
-000292b0: 7061 6365 2c0a 2020 2020 2020 2020 2020  pace,.          
-000292c0: 2020 636f 6d6d 612c 206f 7220 6f74 6865    comma, or othe
-000292d0: 7220 6875 6d61 6e2d 7265 6164 6162 6c65  r human-readable
-000292e0: 2073 6570 6172 6174 6f72 292e 0a0a 2020   separator)...  
-000292f0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-00029300: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-00029310: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b20  wflake.snowpark 
-00029320: 696d 706f 7274 2052 6f77 0a20 2020 2020  import Row.     
-00029330: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-00029340: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-00029350: 7261 6d65 285b 526f 7728 613d 5b31 2c20  rame([Row(a=[1, 
-00029360: 5472 7565 2c20 2273 225d 295d 290a 2020  True, "s"])]).  
-00029370: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00029380: 6563 7428 6172 7261 795f 746f 5f73 7472  ect(array_to_str
-00029390: 696e 6728 2261 222c 206c 6974 2822 2c22  ing("a", lit(","
-000293a0: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
-000293b0: 2229 292e 7368 6f77 2829 0a20 2020 2020  ")).show().     
-000293c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
-000293d0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-000293e0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-000293f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00029400: 2020 7c31 2c74 7275 652c 7320 207c 0a20    |1,true,s  |. 
-00029410: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00029420: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00029430: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00029440: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
-00029450: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
-00029460: 7272 6179 5f74 6f5f 7374 7269 6e67 2229  rray_to_string")
-00029470: 0a20 2020 2073 203d 205f 746f 5f63 6f6c  .    s = _to_col
-00029480: 5f69 665f 7374 7228 7365 7061 7261 746f  _if_str(separato
-00029490: 722c 2022 6172 7261 795f 746f 5f73 7472  r, "array_to_str
-000294a0: 696e 6722 290a 2020 2020 7265 7475 726e  ing").    return
-000294b0: 2062 7569 6c74 696e 2822 6172 7261 795f   builtin("array_
-000294c0: 746f 5f73 7472 696e 6722 2928 612c 2073  to_string")(a, s
-000294d0: 290a 0a0a 6465 6620 6f62 6a65 6374 5f61  )...def object_a
-000294e0: 6767 286b 6579 3a20 436f 6c75 6d6e 4f72  gg(key: ColumnOr
-000294f0: 4e61 6d65 2c20 7661 6c75 653a 2043 6f6c  Name, value: Col
-00029500: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-00029510: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-00029520: 7572 6e73 206f 6e65 204f 424a 4543 5420  urns one OBJECT 
-00029530: 7065 7220 6772 6f75 702e 2046 6f72 2065  per group. For e
-00029540: 6163 6820 6b65 792d 7661 6c75 6520 696e  ach key-value in
-00029550: 7075 7420 7061 6972 2c20 7768 6572 6520  put pair, where 
-00029560: 6b65 7920 6d75 7374 2062 6520 6120 5641  key must be a VA
-00029570: 5243 4841 520a 2020 2020 616e 6420 7661  RCHAR.    and va
-00029580: 6c75 6520 6d75 7374 2062 6520 6120 5641  lue must be a VA
-00029590: 5249 414e 542c 2074 6865 2072 6573 756c  RIANT, the resul
-000295a0: 7469 6e67 204f 424a 4543 5420 636f 6e74  ting OBJECT cont
-000295b0: 6169 6e73 2061 206b 6579 2d76 616c 7565  ains a key-value
-000295c0: 2066 6965 6c64 2e0a 0a20 2020 2045 7861   field...    Exa
-000295d0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-000295e0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000295f0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-00029600: 7320 696d 706f 7274 2053 7472 7563 7454  s import StructT
-00029610: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
-00029620: 2c20 5661 7269 616e 7454 7970 652c 2053  , VariantType, S
-00029630: 7472 696e 6754 7970 650a 2020 2020 2020  tringType.      
-00029640: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00029650: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00029660: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-00029670: 2020 2020 205b 5b22 6e61 6d65 222c 2022       [["name", "
-00029680: 4a6f 6522 5d2c 205b 227a 6970 222c 2022  Joe"], ["zip", "
-00029690: 3938 3030 3422 5d5d 2c0a 2020 2020 2020  98004"]],.      
-000296a0: 2020 2e2e 2e20 2020 2020 7363 6865 6d61    ...     schema
-000296b0: 3d53 7472 7563 7454 7970 6528 5b53 7472  =StructType([Str
-000296c0: 7563 7446 6965 6c64 2822 6b22 2c20 5374  uctField("k", St
-000296d0: 7269 6e67 5479 7065 2829 292c 2053 7472  ringType()), Str
-000296e0: 7563 7446 6965 6c64 2822 7622 2c20 5661  uctField("v", Va
-000296f0: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
-00029700: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00029710: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00029720: 6374 286f 626a 6563 745f 6167 6728 636f  ct(object_agg(co
-00029730: 6c28 226b 2229 2c20 636f 6c28 2276 2229  l("k"), col("v")
-00029740: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00029750: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00029760: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00029770: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00029780: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
-00029790: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-000297a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000297b0: 0a20 2020 2020 2020 207c 7b20 2020 2020  .        |{     
-000297c0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-000297d0: 2020 2020 2020 7c20 2022 6e61 6d65 223a        |  "name":
-000297e0: 2022 4a6f 6522 2c20 207c 0a20 2020 2020   "Joe",  |.     
-000297f0: 2020 207c 2020 227a 6970 223a 2022 3938     |  "zip": "98
-00029800: 3030 3422 2020 7c0a 2020 2020 2020 2020  004"  |.        
-00029810: 7c7d 2020 2020 2020 2020 2020 2020 2020  |}              
-00029820: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
-00029830: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029840: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-00029850: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-00029860: 2020 6b20 3d20 5f74 6f5f 636f 6c5f 6966    k = _to_col_if
-00029870: 5f73 7472 286b 6579 2c20 226f 626a 6563  _str(key, "objec
-00029880: 745f 6167 6722 290a 2020 2020 7620 3d20  t_agg").    v = 
-00029890: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2876  _to_col_if_str(v
-000298a0: 616c 7565 2c20 226f 626a 6563 745f 6167  alue, "object_ag
-000298b0: 6722 290a 2020 2020 7265 7475 726e 2062  g").    return b
-000298c0: 7569 6c74 696e 2822 6f62 6a65 6374 5f61  uiltin("object_a
-000298d0: 6767 2229 286b 2c20 7629 0a0a 0a64 6566  gg")(k, v)...def
-000298e0: 206f 626a 6563 745f 636f 6e73 7472 7563   object_construc
-000298f0: 7428 2a6b 6579 5f76 616c 7565 733a 2043  t(*key_values: C
-00029900: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-00029910: 436f 6c75 6d6e 3a0a 2020 2020 2222 2252  Column:.    """R
-00029920: 6574 7572 6e73 2061 6e20 4f42 4a45 4354  eturns an OBJECT
-00029930: 2063 6f6e 7374 7275 6374 6564 2066 726f   constructed fro
-00029940: 6d20 7468 6520 6172 6775 6d65 6e74 732e  m the arguments.
-00029950: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00029960: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00029970: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00029980: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00029990: 7420 5374 7275 6374 5479 7065 2c20 5374  t StructType, St
-000299a0: 7275 6374 4669 656c 642c 2056 6172 6961  ructField, Varia
-000299b0: 6e74 5479 7065 2c20 5374 7269 6e67 5479  ntType, StringTy
-000299c0: 7065 0a20 2020 2020 2020 203e 3e3e 2064  pe.        >>> d
-000299d0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-000299e0: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-000299f0: 2020 2020 2020 2e2e 2e20 2020 2020 5b5b        ...     [[
-00029a00: 226e 616d 6522 2c20 224a 6f65 225d 2c20  "name", "Joe"], 
-00029a10: 5b22 7a69 7022 2c20 2239 3830 3034 225d  ["zip", "98004"]
-00029a20: 2c5b 2261 6765 222c 204e 6f6e 655d 2c20  ,["age", None], 
-00029a30: 5b4e 6f6e 652c 2022 7661 6c75 6522 5d5d  [None, "value"]]
-00029a40: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00029a50: 2020 7363 6865 6d61 3d53 7472 7563 7454    schema=StructT
-00029a60: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
-00029a70: 2822 6b22 2c20 5374 7269 6e67 5479 7065  ("k", StringType
-00029a80: 2829 292c 2053 7472 7563 7446 6965 6c64  ()), StructField
-00029a90: 2822 7622 2c20 5661 7269 616e 7454 7970  ("v", VariantTyp
-00029aa0: 6528 2929 5d29 0a20 2020 2020 2020 202e  e())]).        .
-00029ab0: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-00029ac0: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
-00029ad0: 745f 636f 6e73 7472 7563 7428 636f 6c28  t_construct(col(
-00029ae0: 226b 2229 2c20 636f 6c28 2276 2229 292e  "k"), col("v")).
-00029af0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-00029b00: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-00029b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029b20: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
-00029b30: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
-00029b40: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00029b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00029b60: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
-00029b70: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-00029b80: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
-00029b90: 4a6f 6522 2020 207c 0a20 2020 2020 2020  Joe"   |.       
-00029ba0: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-00029bb0: 2020 2020 7c0a 2020 2020 2020 2020 7c7b      |.        |{
-00029bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bd0: 207c 0a20 2020 2020 2020 207c 2020 227a   |.        |  "z
-00029be0: 6970 223a 2022 3938 3030 3422 2020 7c0a  ip": "98004"  |.
-00029bf0: 2020 2020 2020 2020 7c7d 2020 2020 2020          |}      
-00029c00: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-00029c10: 2020 2020 207c 7b7d 2020 2020 2020 2020       |{}        
-00029c20: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00029c30: 2020 7c7b 7d20 2020 2020 2020 2020 2020    |{}           
-00029c40: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-00029c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029c60: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
-00029c70: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
-00029c80: 2020 2020 6b76 7320 3d20 5b5f 746f 5f63      kvs = [_to_c
-00029c90: 6f6c 5f69 665f 7374 7228 6b76 2c20 226f  ol_if_str(kv, "o
-00029ca0: 626a 6563 745f 636f 6e73 7472 7563 7422  bject_construct"
-00029cb0: 2920 666f 7220 6b76 2069 6e20 6b65 795f  ) for kv in key_
-00029cc0: 7661 6c75 6573 5d0a 2020 2020 7265 7475  values].    retu
-00029cd0: 726e 2062 7569 6c74 696e 2822 6f62 6a65  rn builtin("obje
-00029ce0: 6374 5f63 6f6e 7374 7275 6374 2229 282a  ct_construct")(*
-00029cf0: 6b76 7329 0a0a 0a64 6566 206f 626a 6563  kvs)...def objec
-00029d00: 745f 636f 6e73 7472 7563 745f 6b65 6570  t_construct_keep
-00029d10: 5f6e 756c 6c28 2a6b 6579 5f76 616c 7565  _null(*key_value
-00029d20: 733a 2043 6f6c 756d 6e4f 724e 616d 6529  s: ColumnOrName)
-00029d30: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00029d40: 2222 2252 6574 7572 6e73 2061 6e20 6f62  """Returns an ob
-00029d50: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
-00029d60: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
-00029d70: 7468 6520 696e 7075 7420 2869 2e65 2e20  the input (i.e. 
-00029d80: 736f 7572 6365 2920 6f62 6a65 6374 2077  source) object w
-00029d90: 6974 6820 6f6e 6520 6f72 206d 6f72 650a  ith one or more.
-00029da0: 2020 2020 6b65 7973 2072 656d 6f76 6564      keys removed
-00029db0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00029dc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00029dd0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00029de0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
-00029df0: 7274 2053 7472 7563 7454 7970 652c 2053  rt StructType, S
-00029e00: 7472 7563 7446 6965 6c64 2c20 5661 7269  tructField, Vari
-00029e10: 616e 7454 7970 652c 2053 7472 696e 6754  antType, StringT
-00029e20: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
-00029e30: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00029e40: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
-00029e50: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
-00029e60: 5b22 6b65 795f 3122 2c20 226f 6e65 225d  ["key_1", "one"]
-00029e70: 2c20 5b22 6b65 795f 3222 2c20 4e6f 6e65  , ["key_2", None
-00029e80: 5d5d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]],.        ... 
-00029e90: 2020 2020 7363 6865 6d61 3d53 7472 7563      schema=Struc
-00029ea0: 7454 7970 6528 5b53 7472 7563 7446 6965  tType([StructFie
-00029eb0: 6c64 2822 6b22 2c20 5374 7269 6e67 5479  ld("k", StringTy
-00029ec0: 7065 2829 292c 2053 7472 7563 7446 6965  pe()), StructFie
-00029ed0: 6c64 2822 7622 2c20 5661 7269 616e 7454  ld("v", VariantT
-00029ee0: 7970 6528 2929 5d29 0a20 2020 2020 2020  ype())]).       
-00029ef0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-00029f00: 3e3e 2064 662e 7365 6c65 6374 286f 626a  >> df.select(obj
-00029f10: 6563 745f 636f 6e73 7472 7563 745f 6b65  ect_construct_ke
-00029f20: 6570 5f6e 756c 6c28 636f 6c28 226b 2229  ep_null(col("k")
-00029f30: 2c20 636f 6c28 2276 2229 292e 616c 6961  , col("v")).alia
-00029f40: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
-00029f50: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
-00029f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00029f70: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-00029f80: 5422 2020 2020 2020 2020 2020 7c0a 2020  T"          |.  
-00029f90: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00029fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00029fb0: 2020 207c 7b20 2020 2020 2020 2020 2020     |{           
-00029fc0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00029fd0: 7c20 2022 6b65 795f 3122 3a20 226f 6e65  |  "key_1": "one
-00029fe0: 2220 207c 0a20 2020 2020 2020 207c 7d20  "  |.        |} 
-00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a000: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
-0002a010: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-0002a020: 2020 2020 2020 207c 2020 226b 6579 5f32         |  "key_2
-0002a030: 223a 206e 756c 6c20 2020 7c0a 2020 2020  ": null   |.    
-0002a040: 2020 2020 7c7d 2020 2020 2020 2020 2020      |}          
-0002a050: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-0002a060: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0002a070: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0002a080: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0002a090: 220a 2020 2020 6b76 7320 3d20 5b5f 746f  ".    kvs = [_to
-0002a0a0: 5f63 6f6c 5f69 665f 7374 7228 6b76 2c20  _col_if_str(kv, 
-0002a0b0: 226f 626a 6563 745f 636f 6e73 7472 7563  "object_construc
-0002a0c0: 745f 6b65 6570 5f6e 756c 6c22 2920 666f  t_keep_null") fo
-0002a0d0: 7220 6b76 2069 6e20 6b65 795f 7661 6c75  r kv in key_valu
-0002a0e0: 6573 5d0a 2020 2020 7265 7475 726e 2062  es].    return b
-0002a0f0: 7569 6c74 696e 2822 6f62 6a65 6374 5f63  uiltin("object_c
-0002a100: 6f6e 7374 7275 6374 5f6b 6565 705f 6e75  onstruct_keep_nu
-0002a110: 6c6c 2229 282a 6b76 7329 0a0a 0a64 6566  ll")(*kvs)...def
-0002a120: 206f 626a 6563 745f 6465 6c65 7465 286f   object_delete(o
-0002a130: 626a 3a20 436f 6c75 6d6e 4f72 4e61 6d65  bj: ColumnOrName
-0002a140: 2c20 6b65 7931 3a20 436f 6c75 6d6e 4f72  , key1: ColumnOr
-0002a150: 4e61 6d65 2c20 2a6b 6579 733a 2043 6f6c  Name, *keys: Col
-0002a160: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0002a170: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
-0002a180: 7572 6e73 2061 6e20 6f62 6a65 6374 2063  urns an object c
-0002a190: 6f6e 7369 7374 696e 6720 6f66 2074 6865  onsisting of the
-0002a1a0: 2069 6e70 7574 206f 626a 6563 7420 7769   input object wi
-0002a1b0: 7468 206f 6e65 206f 7220 6d6f 7265 206b  th one or more k
-0002a1c0: 6579 7320 7265 6d6f 7665 642e 0a20 2020  eys removed..   
-0002a1d0: 2054 6865 2069 6e70 7574 206b 6579 206d   The input key m
-0002a1e0: 7573 7420 6e6f 7420 6578 6973 7420 696e  ust not exist in
-0002a1f0: 2074 6865 206f 626a 6563 742e 0a0a 2020   the object...  
-0002a200: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-0002a210: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0002a220: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0002a230: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
-0002a240: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
-0002a250: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-0002a260: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
-0002a270: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
-0002a280: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
-0002a290: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
-0002a2a0: 2066 726f 6d20 220a 2020 2020 2020 2020   from ".        
-0002a2b0: 2e2e 2e20 2020 2020 2276 616c 7565 7328  ...     "values(
-0002a2c0: 2761 6765 272c 2032 312c 2027 7a69 7027  'age', 21, 'zip'
-0002a2d0: 2c20 3231 3032 312c 2027 6e61 6d65 272c  , 21021, 'name',
-0002a2e0: 2027 4a6f 6527 292c 220a 2020 2020 2020   'Joe'),".      
-0002a2f0: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
-0002a300: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
-0002a310: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
-0002a320: 7927 2920 6173 2054 2861 2c62 2c63 2c64  y') as T(a,b,c,d
-0002a330: 2c65 2c66 2922 0a20 2020 2020 2020 202e  ,e,f)".        .
-0002a340: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0002a350: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
-0002a360: 745f 6465 6c65 7465 2863 6f6c 2822 6f62  t_delete(col("ob
-0002a370: 6a22 292c 206c 6974 2822 6167 6522 2929  j"), lit("age"))
-0002a380: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
-0002a390: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
-0002a3a0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-0002a3b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-0002a3c0: 5245 5355 4c54 2220 2020 2020 2020 2020  RESULT"         
-0002a3d0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0002a3e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0002a3f0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
-0002a400: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0002a410: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
-0002a420: 224a 6f65 222c 2020 7c0a 2020 2020 2020  "Joe",  |.      
-0002a430: 2020 7c20 2022 7a69 7022 3a20 3231 3032    |  "zip": 2102
-0002a440: 3120 2020 207c 0a20 2020 2020 2020 207c  1    |.        |
-0002a450: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
-0002a460: 2020 7c0a 2020 2020 2020 2020 7c7b 2020    |.        |{  
-0002a470: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-0002a480: 0a20 2020 2020 2020 207c 2020 226e 616d  .        |  "nam
-0002a490: 6522 3a20 224a 6179 222c 2020 7c0a 2020  e": "Jay",  |.  
-0002a4a0: 2020 2020 2020 7c20 2022 7a69 7022 3a20        |  "zip": 
-0002a4b0: 3934 3032 3120 2020 207c 0a20 2020 2020  94021    |.     
-0002a4c0: 2020 207c 7d20 2020 2020 2020 2020 2020     |}           
-0002a4d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002a4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002a4f0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0002a500: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0002a510: 0a20 2020 206f 203d 205f 746f 5f63 6f6c  .    o = _to_col
-0002a520: 5f69 665f 7374 7228 6f62 6a2c 2022 6f62  _if_str(obj, "ob
-0002a530: 6a65 6374 5f64 656c 6574 6522 290a 2020  ject_delete").  
-0002a540: 2020 6b31 203d 205f 746f 5f63 6f6c 5f69    k1 = _to_col_i
-0002a550: 665f 7374 7228 6b65 7931 2c20 226f 626a  f_str(key1, "obj
-0002a560: 6563 745f 6465 6c65 7465 2229 0a20 2020  ect_delete").   
-0002a570: 206b 7320 3d20 5b5f 746f 5f63 6f6c 5f69   ks = [_to_col_i
-0002a580: 665f 7374 7228 6b2c 2022 6f62 6a65 6374  f_str(k, "object
-0002a590: 5f64 656c 6574 6522 2920 666f 7220 6b20  _delete") for k 
-0002a5a0: 696e 206b 6579 735d 0a20 2020 2072 6574  in keys].    ret
-0002a5b0: 7572 6e20 6275 696c 7469 6e28 226f 626a  urn builtin("obj
-0002a5c0: 6563 745f 6465 6c65 7465 2229 286f 2c20  ect_delete")(o, 
-0002a5d0: 6b31 2c20 2a6b 7329 0a0a 0a64 6566 206f  k1, *ks)...def o
-0002a5e0: 626a 6563 745f 696e 7365 7274 280a 2020  bject_insert(.  
-0002a5f0: 2020 6f62 6a3a 2043 6f6c 756d 6e4f 724e    obj: ColumnOrN
-0002a600: 616d 652c 0a20 2020 206b 6579 3a20 436f  ame,.    key: Co
-0002a610: 6c75 6d6e 4f72 4e61 6d65 2c0a 2020 2020  lumnOrName,.    
-0002a620: 7661 6c75 653a 2043 6f6c 756d 6e4f 724e  value: ColumnOrN
-0002a630: 616d 652c 0a20 2020 2075 7064 6174 655f  ame,.    update_
-0002a640: 666c 6167 3a20 4f70 7469 6f6e 616c 5b43  flag: Optional[C
-0002a650: 6f6c 756d 6e4f 724e 616d 655d 203d 204e  olumnOrName] = N
-0002a660: 6f6e 652c 0a29 202d 3e20 436f 6c75 6d6e  one,.) -> Column
-0002a670: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
-0002a680: 2061 6e20 6f62 6a65 6374 2063 6f6e 7369   an object consi
-0002a690: 7374 696e 6720 6f66 2074 6865 2069 6e70  sting of the inp
-0002a6a0: 7574 206f 626a 6563 7420 7769 7468 2061  ut object with a
-0002a6b0: 206e 6577 206b 6579 2d76 616c 7565 2070   new key-value p
-0002a6c0: 6169 7220 696e 7365 7274 6564 2028 6f72  air inserted (or
-0002a6d0: 2061 6e0a 2020 2020 6578 6973 7469 6e67   an.    existing
-0002a6e0: 206b 6579 2075 7064 6174 6564 2077 6974   key updated wit
-0002a6f0: 6820 6120 6e65 7720 7661 6c75 6529 2e0a  h a new value)..
-0002a700: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
-0002a710: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002a720: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002a730: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
-0002a740: 6f72 7420 6c69 740a 2020 2020 2020 2020  ort lit.        
-0002a750: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002a760: 2e73 716c 280a 2020 2020 2020 2020 2e2e  .sql(.        ..
-0002a770: 2e20 2020 2020 2273 656c 6563 7420 6f62  .     "select ob
-0002a780: 6a65 6374 5f63 6f6e 7374 7275 6374 2861  ject_construct(a
-0002a790: 2c62 2c63 2c64 2c65 2c66 2920 6173 206f  ,b,c,d,e,f) as o
-0002a7a0: 626a 2c20 6b2c 2076 2066 726f 6d20 220a  bj, k, v from ".
-0002a7b0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002a7c0: 2276 616c 7565 7328 2761 6765 272c 2032  "values('age', 2
-0002a7d0: 312c 2027 7a69 7027 2c20 3231 3032 312c  1, 'zip', 21021,
-0002a7e0: 2027 6e61 6d65 272c 2027 4a6f 6527 2c20   'name', 'Joe', 
-0002a7f0: 2761 6765 272c 2030 292c 220a 2020 2020  'age', 0),".    
-0002a800: 2020 2020 2e2e 2e20 2020 2020 2228 2761      ...     "('a
-0002a810: 6765 272c 2032 362c 2027 7a69 7027 2c20  ge', 26, 'zip', 
-0002a820: 3934 3032 312c 2027 6e61 6d65 272c 2027  94021, 'name', '
-0002a830: 4a61 7927 2c20 2761 6765 272c 2030 2920  Jay', 'age', 0) 
-0002a840: 6173 2054 2861 2c62 2c63 2c64 2c65 2c66  as T(a,b,c,d,e,f
-0002a850: 2c6b 2c76 2922 0a20 2020 2020 2020 202e  ,k,v)".        .
-0002a860: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
-0002a870: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
-0002a880: 745f 696e 7365 7274 2863 6f6c 2822 6f62  t_insert(col("ob
-0002a890: 6a22 292c 206c 6974 2822 6b65 7922 292c  j"), lit("key"),
-0002a8a0: 206c 6974 2822 7622 2929 2e61 6c69 6173   lit("v")).alias
-0002a8b0: 2822 7265 7375 6c74 2229 292e 7368 6f77  ("result")).show
-0002a8c0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0002a8d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0002a8e0: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-0002a8f0: 2220 2020 2020 2020 2020 207c 0a20 2020  "          |.   
-0002a900: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0002a910: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002a920: 2020 7c7b 2020 2020 2020 2020 2020 2020    |{            
-0002a930: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0002a940: 2020 2261 6765 223a 2032 312c 2020 2020    "age": 21,    
-0002a950: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
-0002a960: 6b65 7922 3a20 2276 222c 2020 2020 207c  key": "v",     |
-0002a970: 0a20 2020 2020 2020 207c 2020 226e 616d  .        |  "nam
-0002a980: 6522 3a20 224a 6f65 222c 2020 7c0a 2020  e": "Joe",  |.  
-0002a990: 2020 2020 2020 7c20 2022 7a69 7022 3a20        |  "zip": 
-0002a9a0: 3231 3032 3120 2020 207c 0a20 2020 2020  21021    |.     
-0002a9b0: 2020 207c 7d20 2020 2020 2020 2020 2020     |}           
-0002a9c0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-0002a9d0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
-0002a9e0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
-0002a9f0: 2261 6765 223a 2032 362c 2020 2020 2020  "age": 26,      
-0002aa00: 7c0a 2020 2020 2020 2020 7c20 2022 6b65  |.        |  "ke
-0002aa10: 7922 3a20 2276 222c 2020 2020 207c 0a20  y": "v",     |. 
-0002aa20: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
-0002aa30: 3a20 224a 6179 222c 2020 7c0a 2020 2020  : "Jay",  |.    
-0002aa40: 2020 2020 7c20 2022 7a69 7022 3a20 3934      |  "zip": 94
-0002aa50: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
-0002aa60: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
-0002aa70: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002aa80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002aa90: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-0002aaa0: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-0002aab0: 2020 206f 203d 205f 746f 5f63 6f6c 5f69     o = _to_col_i
-0002aac0: 665f 7374 7228 6f62 6a2c 2022 6f62 6a65  f_str(obj, "obje
-0002aad0: 6374 5f69 6e73 6572 7422 290a 2020 2020  ct_insert").    
-0002aae0: 6b20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  k = _to_col_if_s
-0002aaf0: 7472 286b 6579 2c20 226f 626a 6563 745f  tr(key, "object_
-0002ab00: 696e 7365 7274 2229 0a20 2020 2076 203d  insert").    v =
-0002ab10: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002ab20: 7661 6c75 652c 2022 6f62 6a65 6374 5f69  value, "object_i
-0002ab30: 6e73 6572 7422 290a 2020 2020 7566 203d  nsert").    uf =
-0002ab40: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002ab50: 7570 6461 7465 5f66 6c61 672c 2022 7570  update_flag, "up
-0002ab60: 6461 7465 5f66 6c61 6722 2920 6966 2075  date_flag") if u
-0002ab70: 7064 6174 655f 666c 6167 2069 7320 6e6f  pdate_flag is no
-0002ab80: 7420 4e6f 6e65 2065 6c73 6520 4e6f 6e65  t None else None
-0002ab90: 0a20 2020 2069 6620 7566 2069 7320 6e6f  .    if uf is no
-0002aba0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0002abb0: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002abc0: 6f62 6a65 6374 5f69 6e73 6572 7422 2928  object_insert")(
-0002abd0: 6f2c 206b 2c20 762c 2075 6629 0a20 2020  o, k, v, uf).   
-0002abe0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-0002abf0: 6574 7572 6e20 6275 696c 7469 6e28 226f  eturn builtin("o
-0002ac00: 626a 6563 745f 696e 7365 7274 2229 286f  bject_insert")(o
-0002ac10: 2c20 6b2c 2076 290a 0a0a 6465 6620 6f62  , k, v)...def ob
-0002ac20: 6a65 6374 5f70 6963 6b28 6f62 6a3a 2043  ject_pick(obj: C
-0002ac30: 6f6c 756d 6e4f 724e 616d 652c 206b 6579  olumnOrName, key
-0002ac40: 313a 2043 6f6c 756d 6e4f 724e 616d 652c  1: ColumnOrName,
-0002ac50: 202a 6b65 7973 3a20 436f 6c75 6d6e 4f72   *keys: ColumnOr
-0002ac60: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002ac70: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
-0002ac80: 6120 6e65 7720 4f42 4a45 4354 2063 6f6e  a new OBJECT con
-0002ac90: 7461 696e 696e 6720 736f 6d65 206f 6620  taining some of 
-0002aca0: 7468 6520 6b65 792d 7661 6c75 6520 7061  the key-value pa
-0002acb0: 6972 7320 6672 6f6d 2061 6e20 6578 6973  irs from an exis
-0002acc0: 7469 6e67 206f 626a 6563 742e 0a0a 2020  ting object...  
-0002acd0: 2020 546f 2069 6465 6e74 6966 7920 7468    To identify th
-0002ace0: 6520 6b65 792d 7661 6c75 6520 7061 6972  e key-value pair
-0002acf0: 7320 746f 2069 6e63 6c75 6465 2069 6e20  s to include in 
-0002ad00: 7468 6520 6e65 7720 6f62 6a65 6374 2c20  the new object, 
-0002ad10: 7061 7373 2069 6e20 7468 6520 6b65 7973  pass in the keys
-0002ad20: 2061 7320 6172 6775 6d65 6e74 732c 0a20   as arguments,. 
-0002ad30: 2020 206f 7220 7061 7373 2069 6e20 616e     or pass in an
-0002ad40: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-0002ad50: 6720 7468 6520 6b65 7973 2e0a 0a20 2020  g the keys...   
-0002ad60: 2049 6620 6120 7370 6563 6966 6965 6420   If a specified 
-0002ad70: 6b65 7920 6973 206e 6f74 2070 7265 7365  key is not prese
-0002ad80: 6e74 2069 6e20 7468 6520 696e 7075 7420  nt in the input 
-0002ad90: 6f62 6a65 6374 2c20 7468 6520 6b65 7920  object, the key 
-0002ada0: 6973 2069 676e 6f72 6564 2e0a 0a20 2020  is ignored...   
-0002adb0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0002adc0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0002add0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-0002ade0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-0002adf0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
-0002ae00: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-0002ae10: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-0002ae20: 2020 2273 656c 6563 7420 6f62 6a65 6374    "select object
-0002ae30: 5f63 6f6e 7374 7275 6374 2861 2c62 2c63  _construct(a,b,c
-0002ae40: 2c64 2c65 2c66 2920 6173 206f 626a 2c20  ,d,e,f) as obj, 
-0002ae50: 6b2c 2076 2066 726f 6d20 220a 2020 2020  k, v from ".    
-0002ae60: 2020 2020 2e2e 2e20 2020 2020 2276 616c      ...     "val
-0002ae70: 7565 7328 2761 6765 272c 2032 312c 2027  ues('age', 21, '
-0002ae80: 7a69 7027 2c20 3231 3032 312c 2027 6e61  zip', 21021, 'na
-0002ae90: 6d65 272c 2027 4a6f 6527 2c20 2761 6765  me', 'Joe', 'age
-0002aea0: 272c 2030 292c 220a 2020 2020 2020 2020  ', 0),".        
-0002aeb0: 2e2e 2e20 2020 2020 2228 2761 6765 272c  ...     "('age',
-0002aec0: 2032 362c 2027 7a69 7027 2c20 3934 3032   26, 'zip', 9402
-0002aed0: 312c 2027 6e61 6d65 272c 2027 4a61 7927  1, 'name', 'Jay'
-0002aee0: 2c20 2761 6765 272c 2030 2920 6173 2054  , 'age', 0) as T
-0002aef0: 2861 2c62 2c63 2c64 2c65 2c66 2c6b 2c76  (a,b,c,d,e,f,k,v
-0002af00: 2922 0a20 2020 2020 2020 202e 2e2e 2029  )".        ... )
-0002af10: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002af20: 7365 6c65 6374 286f 626a 6563 745f 7069  select(object_pi
-0002af30: 636b 2863 6f6c 2822 6f62 6a22 292c 2063  ck(col("obj"), c
-0002af40: 6f6c 2822 6b22 292c 206c 6974 2822 6e61  ol("k"), lit("na
-0002af50: 6d65 2229 292e 616c 6961 7328 2272 6573  me")).alias("res
-0002af60: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0002af70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0002af80: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002af90: 2020 7c22 5245 5355 4c54 2220 2020 2020    |"RESULT"     
-0002afa0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002afb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002afc0: 2d0a 2020 2020 2020 2020 7c7b 2020 2020  -.        |{    
-0002afd0: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-0002afe0: 2020 2020 2020 7c20 2022 6167 6522 3a20        |  "age": 
-0002aff0: 3231 2c20 2020 2020 7c0a 2020 2020 2020  21,     |.      
-0002b000: 2020 7c20 2022 6e61 6d65 223a 2022 4a6f    |  "name": "Jo
-0002b010: 6522 2020 7c0a 2020 2020 2020 2020 7c7d  e"  |.        |}
-0002b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b030: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
-0002b040: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
-0002b050: 2020 2020 2020 7c20 2022 6167 6522 3a20        |  "age": 
-0002b060: 3236 2c20 2020 2020 7c0a 2020 2020 2020  26,     |.      
-0002b070: 2020 7c20 2022 6e61 6d65 223a 2022 4a61    |  "name": "Ja
-0002b080: 7922 2020 7c0a 2020 2020 2020 2020 7c7d  y"  |.        |}
-0002b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0a0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002b0b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0002b0c0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-0002b0d0: 3e0a 2020 2020 2222 220a 2020 2020 6f20  >.    """.    o 
-0002b0e0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-0002b0f0: 286f 626a 2c20 226f 626a 6563 745f 7069  (obj, "object_pi
-0002b100: 636b 2229 0a20 2020 206b 3120 3d20 5f74  ck").    k1 = _t
-0002b110: 6f5f 636f 6c5f 6966 5f73 7472 286b 6579  o_col_if_str(key
-0002b120: 312c 2022 6f62 6a65 6374 5f70 6963 6b22  1, "object_pick"
-0002b130: 290a 2020 2020 6b73 203d 205b 5f74 6f5f  ).    ks = [_to_
-0002b140: 636f 6c5f 6966 5f73 7472 286b 2c20 226f  col_if_str(k, "o
-0002b150: 626a 6563 745f 7069 636b 2229 2066 6f72  bject_pick") for
-0002b160: 206b 2069 6e20 6b65 7973 5d0a 2020 2020   k in keys].    
-0002b170: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002b180: 6f62 6a65 6374 5f70 6963 6b22 2928 6f2c  object_pick")(o,
-0002b190: 206b 312c 202a 6b73 290a 0a0a 6465 6620   k1, *ks)...def 
-0002b1a0: 6173 6328 633a 2043 6f6c 756d 6e4f 724e  asc(c: ColumnOrN
-0002b1b0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
-0002b1c0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-0002b1d0: 2043 6f6c 756d 6e20 6578 7072 6573 7369   Column expressi
-0002b1e0: 6f6e 2077 6974 6820 7661 6c75 6573 2073  on with values s
-0002b1f0: 6f72 7465 6420 696e 2061 7363 656e 6469  orted in ascendi
-0002b200: 6e67 206f 7264 6572 2e0a 0a20 2020 2045  ng order...    E
-0002b210: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0002b220: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0002b230: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-0002b240: 616d 6528 5b4e 6f6e 652c 2033 2c20 322c  ame([None, 3, 2,
-0002b250: 2031 2c20 4e6f 6e65 5d2c 2073 6368 656d   1, None], schem
-0002b260: 613d 5b22 6122 5d29 0a20 2020 2020 2020  a=["a"]).       
-0002b270: 203e 3e3e 2064 662e 736f 7274 2861 7363   >>> df.sort(asc
-0002b280: 2864 665b 2261 225d 2929 2e63 6f6c 6c65  (df["a"])).colle
-0002b290: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0002b2a0: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-0002b2b0: 3d4e 6f6e 6529 2c20 526f 7728 413d 3129  =None), Row(A=1)
-0002b2c0: 2c20 526f 7728 413d 3229 2c20 526f 7728  , Row(A=2), Row(
-0002b2d0: 413d 3329 5d0a 2020 2020 2222 220a 2020  A=3)].    """.  
-0002b2e0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0002b2f0: 5f73 7472 2863 2c20 2261 7363 2229 0a20  _str(c, "asc"). 
-0002b300: 2020 2072 6574 7572 6e20 632e 6173 6328     return c.asc(
-0002b310: 290a 0a0a 6465 6620 6173 635f 6e75 6c6c  )...def asc_null
-0002b320: 735f 6669 7273 7428 633a 2043 6f6c 756d  s_first(c: Colum
-0002b330: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002b340: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
-0002b350: 6e73 2061 2043 6f6c 756d 6e20 6578 7072  ns a Column expr
-0002b360: 6573 7369 6f6e 2077 6974 6820 7661 6c75  ession with valu
-0002b370: 6573 2073 6f72 7465 6420 696e 2061 7363  es sorted in asc
-0002b380: 656e 6469 6e67 206f 7264 6572 0a20 2020  ending order.   
-0002b390: 2028 6e75 6c6c 2076 616c 7565 7320 736f   (null values so
-0002b3a0: 7274 6564 2062 6566 6f72 6520 6e6f 6e2d  rted before non-
-0002b3b0: 6e75 6c6c 2076 616c 7565 7329 2e0a 0a20  null values)... 
-0002b3c0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0002b3d0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-0002b3e0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-0002b3f0: 7461 6672 616d 6528 5b4e 6f6e 652c 2033  taframe([None, 3
-0002b400: 2c20 322c 2031 2c20 4e6f 6e65 5d2c 2073  , 2, 1, None], s
-0002b410: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
-0002b420: 2020 2020 203e 3e3e 2064 662e 736f 7274       >>> df.sort
-0002b430: 2861 7363 5f6e 756c 6c73 5f66 6972 7374  (asc_nulls_first
-0002b440: 2864 665b 2261 225d 2929 2e63 6f6c 6c65  (df["a"])).colle
-0002b450: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
-0002b460: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
-0002b470: 3d4e 6f6e 6529 2c20 526f 7728 413d 3129  =None), Row(A=1)
-0002b480: 2c20 526f 7728 413d 3229 2c20 526f 7728  , Row(A=2), Row(
-0002b490: 413d 3329 5d0a 2020 2020 2222 220a 2020  A=3)].    """.  
-0002b4a0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0002b4b0: 5f73 7472 2863 2c20 2261 7363 5f6e 756c  _str(c, "asc_nul
-0002b4c0: 6c73 5f66 6972 7374 2229 0a20 2020 2072  ls_first").    r
-0002b4d0: 6574 7572 6e20 632e 6173 635f 6e75 6c6c  eturn c.asc_null
-0002b4e0: 735f 6669 7273 7428 290a 0a0a 6465 6620  s_first()...def 
-0002b4f0: 6173 635f 6e75 6c6c 735f 6c61 7374 2863  asc_nulls_last(c
-0002b500: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
-0002b510: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0002b520: 2222 5265 7475 726e 7320 6120 436f 6c75  ""Returns a Colu
-0002b530: 6d6e 2065 7870 7265 7373 696f 6e20 7769  mn expression wi
-0002b540: 7468 2076 616c 7565 7320 736f 7274 6564  th values sorted
-0002b550: 2069 6e20 6173 6365 6e64 696e 6720 6f72   in ascending or
-0002b560: 6465 720a 2020 2020 286e 756c 6c20 7661  der.    (null va
-0002b570: 6c75 6573 2073 6f72 7465 6420 6166 7465  lues sorted afte
-0002b580: 7220 6e6f 6e2d 6e75 6c6c 2076 616c 7565  r non-null value
-0002b590: 7329 2e0a 0a20 2020 2045 7861 6d70 6c65  s)...    Example
-0002b5a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0002b5b0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002b5c0: 6174 655f 6461 7461 6672 616d 6528 5b4e  ate_dataframe([N
-0002b5d0: 6f6e 652c 2033 2c20 322c 2031 2c20 4e6f  one, 3, 2, 1, No
-0002b5e0: 6e65 5d2c 2073 6368 656d 613d 5b22 6122  ne], schema=["a"
-0002b5f0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0002b600: 662e 736f 7274 2861 7363 5f6e 756c 6c73  f.sort(asc_nulls
-0002b610: 5f6c 6173 7428 6466 5b22 6122 5d29 292e  _last(df["a"])).
-0002b620: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002b630: 2020 5b52 6f77 2841 3d31 292c 2052 6f77    [Row(A=1), Row
-0002b640: 2841 3d32 292c 2052 6f77 2841 3d33 292c  (A=2), Row(A=3),
-0002b650: 2052 6f77 2841 3d4e 6f6e 6529 2c20 526f   Row(A=None), Ro
-0002b660: 7728 413d 4e6f 6e65 295d 0a20 2020 2022  w(A=None)].    "
-0002b670: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0002b680: 6f6c 5f69 665f 7374 7228 632c 2022 6173  ol_if_str(c, "as
-0002b690: 635f 6e75 6c6c 735f 6c61 7374 2229 0a20  c_nulls_last"). 
-0002b6a0: 2020 2072 6574 7572 6e20 632e 6173 635f     return c.asc_
-0002b6b0: 6e75 6c6c 735f 6c61 7374 2829 0a0a 0a64  nulls_last()...d
-0002b6c0: 6566 2064 6573 6328 633a 2043 6f6c 756d  ef desc(c: Colum
-0002b6d0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002b6e0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-0002b6f0: 5265 7475 726e 7320 6120 436f 6c75 6d6e  Returns a Column
-0002b700: 2065 7870 7265 7373 696f 6e20 7769 7468   expression with
-0002b710: 2076 616c 7565 7320 736f 7274 6564 2069   values sorted i
-0002b720: 6e20 6465 7363 656e 6469 6e67 206f 7264  n descending ord
-0002b730: 6572 2e0a 0a20 2020 2045 7861 6d70 6c65  er...    Example
-0002b740: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0002b750: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002b760: 6174 655f 6461 7461 6672 616d 6528 5b31  ate_dataframe([1
-0002b770: 2c20 322c 2033 2c20 4e6f 6e65 2c20 4e6f  , 2, 3, None, No
-0002b780: 6e65 5d2c 2073 6368 656d 613d 5b22 6122  ne], schema=["a"
-0002b790: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0002b7a0: 662e 736f 7274 2864 6573 6328 6466 5b22  f.sort(desc(df["
-0002b7b0: 6122 5d29 292e 636f 6c6c 6563 7428 290a  a"])).collect().
-0002b7c0: 2020 2020 2020 2020 5b52 6f77 2841 3d33          [Row(A=3
-0002b7d0: 292c 2052 6f77 2841 3d32 292c 2052 6f77  ), Row(A=2), Row
-0002b7e0: 2841 3d31 292c 2052 6f77 2841 3d4e 6f6e  (A=1), Row(A=Non
-0002b7f0: 6529 2c20 526f 7728 413d 4e6f 6e65 295d  e), Row(A=None)]
-0002b800: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002b810: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002b820: 632c 2022 6465 7363 2229 0a20 2020 2072  c, "desc").    r
-0002b830: 6574 7572 6e20 632e 6465 7363 2829 0a0a  eturn c.desc()..
-0002b840: 0a64 6566 2064 6573 635f 6e75 6c6c 735f  .def desc_nulls_
-0002b850: 6669 7273 7428 633a 2043 6f6c 756d 6e4f  first(c: ColumnO
-0002b860: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002b870: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-0002b880: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
-0002b890: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
-0002b8a0: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
-0002b8b0: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
-0002b8c0: 0a20 2020 2028 6e75 6c6c 2076 616c 7565  .    (null value
-0002b8d0: 7320 736f 7274 6564 2062 6566 6f72 6520  s sorted before 
-0002b8e0: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
-0002b8f0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002b900: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
-0002b910: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0002b920: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
-0002b930: 322c 2033 2c20 4e6f 6e65 2c20 4e6f 6e65  2, 3, None, None
-0002b940: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0002b950: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002b960: 736f 7274 2864 6573 635f 6e75 6c6c 735f  sort(desc_nulls_
-0002b970: 6669 7273 7428 6466 5b22 6122 5d29 292e  first(df["a"])).
-0002b980: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002b990: 2020 5b52 6f77 2841 3d4e 6f6e 6529 2c20    [Row(A=None), 
-0002b9a0: 526f 7728 413d 4e6f 6e65 292c 2052 6f77  Row(A=None), Row
-0002b9b0: 2841 3d33 292c 2052 6f77 2841 3d32 292c  (A=3), Row(A=2),
-0002b9c0: 2052 6f77 2841 3d31 295d 0a20 2020 2022   Row(A=1)].    "
-0002b9d0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0002b9e0: 6f6c 5f69 665f 7374 7228 632c 2022 6465  ol_if_str(c, "de
-0002b9f0: 7363 5f6e 756c 6c73 5f66 6972 7374 2229  sc_nulls_first")
-0002ba00: 0a20 2020 2072 6574 7572 6e20 632e 6465  .    return c.de
-0002ba10: 7363 5f6e 756c 6c73 5f66 6972 7374 2829  sc_nulls_first()
-0002ba20: 0a0a 0a64 6566 2064 6573 635f 6e75 6c6c  ...def desc_null
-0002ba30: 735f 6c61 7374 2863 3a20 436f 6c75 6d6e  s_last(c: Column
-0002ba40: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0002ba50: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-0002ba60: 6574 7572 6e73 2061 2043 6f6c 756d 6e20  eturns a Column 
-0002ba70: 6578 7072 6573 7369 6f6e 2077 6974 6820  expression with 
-0002ba80: 7661 6c75 6573 2073 6f72 7465 6420 696e  values sorted in
-0002ba90: 2064 6573 6365 6e64 696e 6720 6f72 6465   descending orde
-0002baa0: 720a 2020 2020 286e 756c 6c20 7661 6c75  r.    (null valu
-0002bab0: 6573 2073 6f72 7465 6420 6166 7465 7220  es sorted after 
-0002bac0: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
-0002bad0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0002bae0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002baf0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002bb00: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
-0002bb10: 2c20 332c 204e 6f6e 652c 204e 6f6e 655d  , 3, None, None]
-0002bb20: 2c20 7363 6865 6d61 3d5b 2261 225d 290a  , schema=["a"]).
-0002bb30: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002bb40: 6f72 7428 6465 7363 5f6e 756c 6c73 5f6c  ort(desc_nulls_l
-0002bb50: 6173 7428 6466 5b22 6122 5d29 292e 636f  ast(df["a"])).co
-0002bb60: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0002bb70: 5b52 6f77 2841 3d33 292c 2052 6f77 2841  [Row(A=3), Row(A
-0002bb80: 3d32 292c 2052 6f77 2841 3d31 292c 2052  =2), Row(A=1), R
-0002bb90: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
-0002bba0: 413d 4e6f 6e65 295d 0a20 2020 2022 2222  A=None)].    """
-0002bbb0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002bbc0: 5f69 665f 7374 7228 632c 2022 6465 7363  _if_str(c, "desc
-0002bbd0: 5f6e 756c 6c73 5f6c 6173 7422 290a 2020  _nulls_last").  
-0002bbe0: 2020 7265 7475 726e 2063 2e64 6573 635f    return c.desc_
-0002bbf0: 6e75 6c6c 735f 6c61 7374 2829 0a0a 0a64  nulls_last()...d
-0002bc00: 6566 2061 735f 6172 7261 7928 7661 7269  ef as_array(vari
-0002bc10: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
-0002bc20: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
-0002bc30: 2020 2222 2243 6173 7473 2061 2056 4152    """Casts a VAR
-0002bc40: 4941 4e54 2076 616c 7565 2074 6f20 616e  IANT value to an
-0002bc50: 2061 7272 6179 2e0a 0a20 2020 2045 7861   array...    Exa
-0002bc60: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
-0002bc70: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0002bc80: 7371 6c28 2273 656c 6563 7420 6172 7261  sql("select arra
-0002bc90: 795f 636f 6e73 7472 7563 7428 312c 2032  y_construct(1, 2
-0002bca0: 293a 3a76 6172 6961 6e74 2061 7320 6122  )::variant as a"
-0002bcb0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002bcc0: 2e73 656c 6563 7428 6173 5f61 7272 6179  .select(as_array
-0002bcd0: 2822 6122 292e 616c 6961 7328 2272 6573  ("a").alias("res
-0002bce0: 756c 7422 2929 2e73 686f 7728 290a 2020  ult")).show().  
-0002bcf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0002bd00: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
-0002bd10: 554c 5422 2020 7c0a 2020 2020 2020 2020  ULT"  |.        
-0002bd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002bd30: 2020 2020 207c 5b20 2020 2020 2020 2020       |[         
-0002bd40: 7c0a 2020 2020 2020 2020 7c20 2031 2c20  |.        |  1, 
-0002bd50: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0002bd60: 2020 3220 2020 2020 2020 7c0a 2020 2020    2       |.    
-0002bd70: 2020 2020 7c5d 2020 2020 2020 2020 207c      |]         |
-0002bd80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002bd90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0002bda0: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
-0002bdb0: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0002bdc0: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
-0002bdd0: 2c20 2261 735f 6172 7261 7922 290a 2020  , "as_array").  
-0002bde0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0002bdf0: 2822 6173 5f61 7272 6179 2229 2863 290a  ("as_array")(c).
-0002be00: 0a0a 6465 6620 6173 5f62 696e 6172 7928  ..def as_binary(
-0002be10: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
-0002be20: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002be30: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
-0002be40: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
-0002be50: 6f20 6120 6269 6e61 7279 2073 7472 696e  o a binary strin
-0002be60: 672e 0a0a 2020 2020 4578 616d 706c 653a  g...    Example:
-0002be70: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-0002be80: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-0002be90: 7365 6c65 6374 2074 6f5f 6269 6e61 7279  select to_binary
-0002bea0: 2827 4630 4135 2729 3a3a 7661 7269 616e  ('F0A5')::varian
-0002beb0: 7420 6173 2061 2229 0a20 2020 2020 2020  t as a").       
-0002bec0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
-0002bed0: 735f 6269 6e61 7279 2822 6122 292e 616c  s_binary("a").al
-0002bee0: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-0002bef0: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-0002bf00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002bf10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002bf20: 207c 2252 4553 554c 5422 2020 2020 2020   |"RESULT"      
-0002bf30: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
-0002bf40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002bf50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002bf60: 2020 2020 2020 207c 6279 7465 6172 7261         |bytearra
-0002bf70: 7928 6227 5c78 6630 5c78 6135 2729 2020  y(b'\xf0\xa5')  
-0002bf80: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002bf90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002bfa0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0002bfb0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0002bfc0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002bfd0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
-0002bfe0: 2022 6173 5f62 696e 6172 7922 290a 2020   "as_binary").  
-0002bff0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
-0002c000: 2822 6173 5f62 696e 6172 7922 2928 6329  ("as_binary")(c)
-0002c010: 0a0a 0a64 6566 2061 735f 6368 6172 2876  ...def as_char(v
-0002c020: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-0002c030: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002c040: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-0002c050: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002c060: 2061 2073 7472 696e 672e 0a0a 2020 2020   a string...    
-0002c070: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0002c080: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0002c090: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-0002c0a0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-0002c0b0: 6173 5f63 6861 722c 2074 6f5f 7661 7269  as_char, to_vari
-0002c0c0: 616e 740a 2020 2020 2020 2020 3e3e 3e20  ant.        >>> 
-0002c0d0: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
-0002c0e0: 2822 7365 6c65 6374 2027 736f 6d65 2073  ("select 'some s
-0002c0f0: 7472 696e 6727 2061 7320 6368 6172 2229  tring' as char")
-0002c100: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002c110: 6368 6172 5f76 203d 2074 6f5f 7661 7269  char_v = to_vari
-0002c120: 616e 7428 6466 2e63 6861 7229 0a20 2020  ant(df.char).   
-0002c130: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002c140: 6374 2864 662e 6368 6172 5f76 2e61 735f  ct(df.char_v.as_
-0002c150: 2822 6368 6172 2229 292e 636f 6c6c 6563  ("char")).collec
-0002c160: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
-0002c170: 2864 662e 6368 6172 292e 636f 6c6c 6563  (df.char).collec
-0002c180: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-0002c190: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0002c1a0: 2e73 656c 6563 7428 6173 5f63 6861 7228  .select(as_char(
-0002c1b0: 6466 2e63 6861 725f 7629 2e61 735f 2822  df.char_v).as_("
-0002c1c0: 6368 6172 2229 292e 636f 6c6c 6563 7428  char")).collect(
-0002c1d0: 2920 3d3d 2064 662e 7365 6c65 6374 2864  ) == df.select(d
-0002c1e0: 662e 6368 6172 292e 636f 6c6c 6563 7428  f.char).collect(
-0002c1f0: 290a 2020 2020 2020 2020 5472 7565 0a20  ).        True. 
-0002c200: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0002c210: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-0002c220: 7269 616e 742c 2022 6173 5f63 6861 7222  riant, "as_char"
-0002c230: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002c240: 6c74 696e 2822 6173 5f63 6861 7222 2928  ltin("as_char")(
-0002c250: 6329 0a0a 0a64 6566 2061 735f 7661 7263  c)...def as_varc
-0002c260: 6861 7228 7661 7269 616e 743a 2043 6f6c  har(variant: Col
-0002c270: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
-0002c280: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
-0002c290: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
-0002c2a0: 7565 2074 6f20 6120 7374 7269 6e67 2e0a  ue to a string..
-0002c2b0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0002c2c0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-0002c2d0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-0002c2e0: 6172 6b2e 6675 6e63 7469 6f6e 7320 696d  ark.functions im
-0002c2f0: 706f 7274 2061 735f 7661 7263 6861 722c  port as_varchar,
-0002c300: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
-0002c310: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002c320: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
-0002c330: 2027 736f 6d65 2073 7472 696e 6727 2061   'some string' a
-0002c340: 7320 6368 6172 2229 0a20 2020 2020 2020  s char").       
-0002c350: 203e 3e3e 2064 662e 6368 6172 5f76 203d   >>> df.char_v =
-0002c360: 2074 6f5f 7661 7269 616e 7428 6466 2e63   to_variant(df.c
-0002c370: 6861 7229 0a20 2020 2020 2020 203e 3e3e  har).        >>>
-0002c380: 2064 662e 7365 6c65 6374 2864 662e 6368   df.select(df.ch
-0002c390: 6172 5f76 2e61 735f 2822 6368 6172 2229  ar_v.as_("char")
-0002c3a0: 292e 636f 6c6c 6563 7428 2920 3d3d 2064  ).collect() == d
-0002c3b0: 662e 7365 6c65 6374 2864 662e 6368 6172  f.select(df.char
-0002c3c0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0002c3d0: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
-0002c3e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002c3f0: 6173 5f76 6172 6368 6172 2864 662e 6368  as_varchar(df.ch
-0002c400: 6172 5f76 292e 6173 5f28 2263 6861 7222  ar_v).as_("char"
-0002c410: 2929 2e63 6f6c 6c65 6374 2829 203d 3d20  )).collect() == 
-0002c420: 6466 2e73 656c 6563 7428 6466 2e63 6861  df.select(df.cha
-0002c430: 7229 2e63 6f6c 6c65 6374 2829 0a20 2020  r).collect().   
-0002c440: 2020 2020 2054 7275 650a 2020 2020 2222       True.    ""
-0002c450: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0002c460: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
-0002c470: 2c20 2261 735f 7661 7263 6861 7222 290a  , "as_varchar").
-0002c480: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002c490: 696e 2822 6173 5f76 6172 6368 6172 2229  in("as_varchar")
-0002c4a0: 2863 290a 0a0a 6465 6620 6173 5f64 6174  (c)...def as_dat
-0002c4b0: 6528 7661 7269 616e 743a 2043 6f6c 756d  e(variant: Colum
-0002c4c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
-0002c4d0: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
-0002c4e0: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
-0002c4f0: 2074 6f20 6120 6461 7465 2e0a 0a20 2020   to a date...   
-0002c500: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0002c510: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0002c520: 696f 6e2e 7371 6c28 2273 656c 6563 7420  ion.sql("select 
-0002c530: 6461 7465 2732 3032 302d 312d 3127 3a3a  date'2020-1-1'::
-0002c540: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
-0002c550: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002c560: 6c65 6374 2861 735f 6461 7465 2822 6122  lect(as_date("a"
-0002c570: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-0002c580: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-0002c590: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0002c5a0: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0002c5b0: 5422 2020 2020 7c0a 2020 2020 2020 2020  T"    |.        
-0002c5c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-0002c5d0: 2020 2020 2020 207c 3230 3230 2d30 312d         |2020-01-
-0002c5e0: 3031 2020 7c0a 2020 2020 2020 2020 2d2d  01  |.        --
-0002c5f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002c600: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
-0002c610: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
-0002c620: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002c630: 7661 7269 616e 742c 2022 6173 5f64 6174  variant, "as_dat
-0002c640: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
-0002c650: 7569 6c74 696e 2822 6173 5f64 6174 6522  uiltin("as_date"
-0002c660: 2928 6329 0a0a 0a64 6566 2063 6173 7428  )(c)...def cast(
-0002c670: 636f 6c75 6d6e 3a20 436f 6c75 6d6e 4f72  column: ColumnOr
-0002c680: 4e61 6d65 2c20 746f 3a20 556e 696f 6e5b  Name, to: Union[
-0002c690: 7374 722c 2044 6174 6154 7970 655d 2920  str, DataType]) 
-0002c6a0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0002c6b0: 2222 436f 6e76 6572 7473 2061 2076 616c  ""Converts a val
-0002c6c0: 7565 206f 6620 6f6e 6520 6461 7461 2074  ue of one data t
-0002c6d0: 7970 6520 696e 746f 2061 6e6f 7468 6572  ype into another
-0002c6e0: 2064 6174 6120 7479 7065 2e0a 2020 2020   data type..    
-0002c6f0: 5468 6520 7365 6d61 6e74 6963 7320 6f66  The semantics of
-0002c700: 2043 4153 5420 6172 6520 7468 6520 7361   CAST are the sa
-0002c710: 6d65 2061 7320 7468 6520 7365 6d61 6e74  me as the semant
-0002c720: 6963 7320 6f66 2074 6865 2063 6f72 7265  ics of the corre
-0002c730: 7370 6f6e 6469 6e67 2074 6f20 6461 7461  sponding to data
-0002c740: 7479 7065 2063 6f6e 7665 7273 696f 6e20  type conversion 
-0002c750: 6675 6e63 7469 6f6e 732e 0a20 2020 2049  functions..    I
-0002c760: 6620 7468 6520 6361 7374 2069 7320 6e6f  f the cast is no
-0002c770: 7420 706f 7373 6962 6c65 2c20 6120 6060  t possible, a ``
-0002c780: 536e 6f77 7061 726b 5351 4c45 7863 6570  SnowparkSQLExcep
-0002c790: 7469 6f6e 6060 2065 7863 6570 7469 6f6e  tion`` exception
-0002c7a0: 2069 7320 7468 726f 776e 2e0a 0a20 2020   is thrown...   
-0002c7b0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0002c7c0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0002c7d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0002c7e0: 7479 7065 7320 696d 706f 7274 2044 6563  types import Dec
-0002c7f0: 696d 616c 5479 7065 2c20 496e 7465 6765  imalType, Intege
-0002c800: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
-0002c810: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0002c820: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0002c830: 5b5b 312e 3534 3332 5d5d 2c20 7363 6865  [[1.5432]], sche
-0002c840: 6d61 3d5b 2264 225d 290a 2020 2020 2020  ma=["d"]).      
-0002c850: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002c860: 6361 7374 2864 662e 642c 2044 6563 696d  cast(df.d, Decim
-0002c870: 616c 5479 7065 2831 352c 2032 2929 2e61  alType(15, 2)).a
-0002c880: 735f 2822 4445 4349 4d41 4c22 292c 2063  s_("DECIMAL"), c
-0002c890: 6173 7428 6466 2e64 2c20 496e 7465 6765  ast(df.d, Intege
-0002c8a0: 7254 7970 6528 2929 2e61 735f 2822 494e  rType()).as_("IN
-0002c8b0: 5422 2929 2e73 686f 7728 290a 2020 2020  T")).show().    
-0002c8c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002c8d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002c8e0: 2020 7c22 4445 4349 4d41 4c22 2020 7c22    |"DECIMAL"  |"
-0002c8f0: 494e 5422 2020 7c0a 2020 2020 2020 2020  INT"  |.        
-0002c900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c910: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c31  -----.        |1
-0002c920: 2e35 3420 2020 2020 2020 7c32 2020 2020  .54       |2    
-0002c930: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-0002c940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002c950: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
-0002c960: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
-0002c970: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-0002c980: 5f73 7472 2863 6f6c 756d 6e2c 2022 6361  _str(column, "ca
-0002c990: 7374 2229 0a20 2020 2072 6574 7572 6e20  st").    return 
-0002c9a0: 632e 6361 7374 2874 6f29 0a0a 0a64 6566  c.cast(to)...def
-0002c9b0: 2074 7279 5f63 6173 7428 636f 6c75 6d6e   try_cast(column
-0002c9c0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
-0002c9d0: 746f 3a20 556e 696f 6e5b 7374 722c 2044  to: Union[str, D
-0002c9e0: 6174 6154 7970 655d 2920 2d3e 2043 6f6c  ataType]) -> Col
-0002c9f0: 756d 6e3a 0a20 2020 2022 2222 4120 7370  umn:.    """A sp
-0002ca00: 6563 6961 6c20 7665 7273 696f 6e20 6f66  ecial version of
-0002ca10: 2043 4153 5420 666f 7220 6120 7375 6273   CAST for a subs
-0002ca20: 6574 206f 6620 6461 7461 2074 7970 6520  et of data type 
-0002ca30: 636f 6e76 6572 7369 6f6e 732e 0a20 2020  conversions..   
-0002ca40: 2049 7420 7065 7266 6f72 6d73 2074 6865   It performs the
-0002ca50: 2073 616d 6520 6f70 6572 6174 696f 6e20   same operation 
-0002ca60: 2869 2e65 2e20 636f 6e76 6572 7473 2061  (i.e. converts a
-0002ca70: 2076 616c 7565 206f 6620 6f6e 6520 6461   value of one da
-0002ca80: 7461 2074 7970 6520 696e 746f 2061 6e6f  ta type into ano
-0002ca90: 7468 6572 2064 6174 6120 7479 7065 292c  ther data type),
-0002caa0: 0a20 2020 2062 7574 2072 6574 7572 6e73  .    but returns
-0002cab0: 2061 204e 554c 4c20 7661 6c75 6520 696e   a NULL value in
-0002cac0: 7374 6561 6420 6f66 2072 6169 7369 6e67  stead of raising
-0002cad0: 2061 6e20 6572 726f 7220 7768 656e 2074   an error when t
-0002cae0: 6865 2063 6f6e 7665 7273 696f 6e20 6361  he conversion ca
-0002caf0: 6e20 6e6f 7420 6265 2070 6572 666f 726d  n not be perform
-0002cb00: 6564 2e0a 0a20 2020 2054 6865 2060 6063  ed...    The ``c
-0002cb10: 6f6c 756d 6e60 6020 6172 6775 6d65 6e74  olumn`` argument
-0002cb20: 206d 7573 7420 6265 2061 2073 7472 696e   must be a strin
-0002cb30: 6720 636f 6c75 6d6e 2069 6e20 536e 6f77  g column in Snow
-0002cb40: 666c 616b 652e 0a0a 2020 2020 4578 616d  flake...    Exam
-0002cb50: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-0002cb60: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0002cb70: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-0002cb80: 2069 6d70 6f72 7420 496e 7465 6765 7254   import IntegerT
-0002cb90: 7970 652c 2046 6c6f 6174 5479 7065 0a20  ype, FloatType. 
-0002cba0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002cbb0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0002cbc0: 6174 6166 7261 6d65 285b 2730 272c 2027  ataframe(['0', '
-0002cbd0: 2d31 3227 2c20 2732 3227 2c20 2731 3030  -12', '22', '100
-0002cbe0: 3127 5d2c 2073 6368 656d 613d 5b22 6122  1'], schema=["a"
-0002cbf0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0002cc00: 662e 7365 6c65 6374 2874 7279 5f63 6173  f.select(try_cas
-0002cc10: 7428 636f 6c28 2261 2229 2c20 496e 7465  t(col("a"), Inte
-0002cc20: 6765 7254 7970 6528 2929 2e61 735f 2827  gerType()).as_('
-0002cc30: 616e 7327 2929 2e63 6f6c 6c65 6374 2829  ans')).collect()
-0002cc40: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-0002cc50: 533d 3029 2c20 526f 7728 414e 533d 2d31  S=0), Row(ANS=-1
-0002cc60: 3229 2c20 526f 7728 414e 533d 3232 292c  2), Row(ANS=22),
-0002cc70: 2052 6f77 2841 4e53 3d31 3030 3129 5d0a   Row(ANS=1001)].
-0002cc80: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
-0002cc90: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-0002cca0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
-0002ccb0: 6461 7461 6672 616d 6528 5b27 302e 3132  dataframe(['0.12
-0002ccc0: 272c 2027 5553 4420 3237 2e39 3027 2c20  ', 'USD 27.90', 
-0002ccd0: 2731 332e 3937 2055 5344 272c 2027 e282  '13.97 USD', '..
-0002cce0: ac39 372e 3027 2c20 2731 372c 2d27 5d2c  .97.0', '17,-'],
-0002ccf0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
-0002cd00: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002cd10: 6c65 6374 2874 7279 5f63 6173 7428 636f  lect(try_cast(co
-0002cd20: 6c28 2261 2229 2c20 466c 6f61 7454 7970  l("a"), FloatTyp
-0002cd30: 6528 2929 2e61 735f 2827 616e 7327 2929  e()).as_('ans'))
-0002cd40: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-0002cd50: 2020 205b 526f 7728 414e 533d 302e 3132     [Row(ANS=0.12
-0002cd60: 292c 2052 6f77 2841 4e53 3d4e 6f6e 6529  ), Row(ANS=None)
-0002cd70: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
-0002cd80: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
-0002cd90: 526f 7728 414e 533d 4e6f 6e65 295d 0a0a  Row(ANS=None)]..
-0002cda0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0002cdb0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2863  _to_col_if_str(c
-0002cdc0: 6f6c 756d 6e2c 2022 7472 795f 6361 7374  olumn, "try_cast
-0002cdd0: 2229 0a20 2020 2072 6574 7572 6e20 632e  ").    return c.
-0002cde0: 7472 795f 6361 7374 2874 6f29 0a0a 0a64  try_cast(to)...d
-0002cdf0: 6566 205f 6173 5f64 6563 696d 616c 5f6f  ef _as_decimal_o
-0002ce00: 725f 6e75 6d62 6572 280a 2020 2020 6361  r_number(.    ca
-0002ce10: 7374 5f74 7970 653a 2073 7472 2c0a 2020  st_type: str,.  
-0002ce20: 2020 7661 7269 616e 743a 2043 6f6c 756d    variant: Colum
-0002ce30: 6e4f 724e 616d 652c 0a20 2020 2070 7265  nOrName,.    pre
-0002ce40: 6369 7369 6f6e 3a20 4f70 7469 6f6e 616c  cision: Optional
-0002ce50: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-0002ce60: 2020 7363 616c 653a 204f 7074 696f 6e61    scale: Optiona
-0002ce70: 6c5b 696e 745d 203d 204e 6f6e 652c 0a29  l[int] = None,.)
-0002ce80: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0002ce90: 2222 2248 656c 7065 7220 6675 6e63 7469  """Helper functi
-0002cea0: 6f6e 2074 6861 7420 6361 7374 7320 6120  on that casts a 
-0002ceb0: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002cec0: 2061 2064 6563 696d 616c 206f 7220 6e75   a decimal or nu
-0002ced0: 6d62 6572 2e22 2222 0a20 2020 2063 203d  mber.""".    c =
-0002cee0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
-0002cef0: 7661 7269 616e 742c 2063 6173 745f 7479  variant, cast_ty
-0002cf00: 7065 290a 2020 2020 6966 2073 6361 6c65  pe).    if scale
-0002cf10: 2061 6e64 206e 6f74 2070 7265 6369 7369   and not precisi
-0002cf20: 6f6e 3a0a 2020 2020 2020 2020 7261 6973  on:.        rais
-0002cf30: 6520 5661 6c75 6545 7272 6f72 2822 4361  e ValueError("Ca
-0002cf40: 6e6e 6f74 2064 6566 696e 6520 7363 616c  nnot define scal
-0002cf50: 6520 7769 7468 6f75 7420 7072 6563 6973  e without precis
-0002cf60: 696f 6e22 290a 2020 2020 6966 2070 7265  ion").    if pre
-0002cf70: 6369 7369 6f6e 2061 6e64 2073 6361 6c65  cision and scale
-0002cf80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0002cf90: 2062 7569 6c74 696e 2863 6173 745f 7479   builtin(cast_ty
-0002cfa0: 7065 2928 632c 206c 6974 2870 7265 6369  pe)(c, lit(preci
-0002cfb0: 7369 6f6e 292c 206c 6974 2873 6361 6c65  sion), lit(scale
-0002cfc0: 2929 0a20 2020 2065 6c69 6620 7072 6563  )).    elif prec
-0002cfd0: 6973 696f 6e3a 0a20 2020 2020 2020 2072  ision:.        r
-0002cfe0: 6574 7572 6e20 6275 696c 7469 6e28 6361  eturn builtin(ca
-0002cff0: 7374 5f74 7970 6529 2863 2c20 6c69 7428  st_type)(c, lit(
-0002d000: 7072 6563 6973 696f 6e29 290a 2020 2020  precision)).    
-0002d010: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
-0002d020: 7475 726e 2062 7569 6c74 696e 2863 6173  turn builtin(cas
-0002d030: 745f 7479 7065 2928 6329 0a0a 0a64 6566  t_type)(c)...def
-0002d040: 2061 735f 6465 6369 6d61 6c28 0a20 2020   as_decimal(.   
-0002d050: 2076 6172 6961 6e74 3a20 436f 6c75 6d6e   variant: Column
-0002d060: 4f72 4e61 6d65 2c0a 2020 2020 7072 6563  OrName,.    prec
-0002d070: 6973 696f 6e3a 204f 7074 696f 6e61 6c5b  ision: Optional[
-0002d080: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
-0002d090: 2073 6361 6c65 3a20 4f70 7469 6f6e 616c   scale: Optional
-0002d0a0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2920  [int] = None,.) 
-0002d0b0: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
-0002d0c0: 2222 4361 7374 7320 6120 5641 5249 414e  ""Casts a VARIAN
-0002d0d0: 5420 7661 6c75 6520 746f 2061 2066 6978  T value to a fix
-0002d0e0: 6564 2d70 6f69 6e74 2064 6563 696d 616c  ed-point decimal
-0002d0f0: 2028 646f 6573 206e 6f74 206d 6174 6368   (does not match
-0002d100: 2066 6c6f 6174 696e 672d 706f 696e 7420   floating-point 
-0002d110: 7661 6c75 6573 292e 0a0a 2020 2020 4578  values)...    Ex
-0002d120: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-0002d130: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0002d140: 2e73 716c 2822 7365 6c65 6374 2031 2e32  .sql("select 1.2
-0002d150: 3334 353a 3a76 6172 6961 6e74 2061 7320  345::variant as 
-0002d160: 6122 290a 2020 2020 2020 2020 3e3e 3e20  a").        >>> 
-0002d170: 6466 2e73 656c 6563 7428 6173 5f64 6563  df.select(as_dec
-0002d180: 696d 616c 2822 6122 2c20 342c 2031 292e  imal("a", 4, 1).
-0002d190: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
-0002d1a0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0002d1b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0002d1c0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0002d1d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0002d1e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002d1f0: 312e 3220 2020 2020 2020 7c0a 2020 2020  1.2       |.    
-0002d200: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002d210: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0002d220: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0002d230: 2072 6574 7572 6e20 5f61 735f 6465 6369   return _as_deci
-0002d240: 6d61 6c5f 6f72 5f6e 756d 6265 7228 2261  mal_or_number("a
-0002d250: 735f 6465 6369 6d61 6c22 2c20 7661 7269  s_decimal", vari
-0002d260: 616e 742c 2070 7265 6369 7369 6f6e 2c20  ant, precision, 
-0002d270: 7363 616c 6529 0a0a 0a64 6566 2061 735f  scale)...def as_
-0002d280: 6e75 6d62 6572 280a 2020 2020 7661 7269  number(.    vari
-0002d290: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
-0002d2a0: 652c 0a20 2020 2070 7265 6369 7369 6f6e  e,.    precision
-0002d2b0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-0002d2c0: 3d20 4e6f 6e65 2c0a 2020 2020 7363 616c  = None,.    scal
-0002d2d0: 653a 204f 7074 696f 6e61 6c5b 696e 745d  e: Optional[int]
-0002d2e0: 203d 204e 6f6e 652c 0a29 202d 3e20 436f   = None,.) -> Co
-0002d2f0: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
-0002d300: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
-0002d310: 7565 2074 6f20 6120 6669 7865 642d 706f  ue to a fixed-po
-0002d320: 696e 7420 6465 6369 6d61 6c20 2864 6f65  int decimal (doe
-0002d330: 7320 6e6f 7420 6d61 7463 6820 666c 6f61  s not match floa
-0002d340: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
-0002d350: 7329 2e0a 0a20 2020 2045 7861 6d70 6c65  s)...    Example
-0002d360: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
-0002d370: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
-0002d380: 2273 656c 6563 7420 312e 3233 3435 3a3a  "select 1.2345::
-0002d390: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
-0002d3a0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002d3b0: 6c65 6374 2861 735f 6e75 6d62 6572 2822  lect(as_number("
-0002d3c0: 6122 2c20 342c 2031 292e 616c 6961 7328  a", 4, 1).alias(
-0002d3d0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0002d3e0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0002d3f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002d400: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0002d410: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002d420: 0a20 2020 2020 2020 207c 312e 3220 2020  .        |1.2   
-0002d430: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002d440: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002d450: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0002d460: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-0002d470: 6e20 5f61 735f 6465 6369 6d61 6c5f 6f72  n _as_decimal_or
-0002d480: 5f6e 756d 6265 7228 2261 735f 6e75 6d62  _number("as_numb
-0002d490: 6572 222c 2076 6172 6961 6e74 2c20 7072  er", variant, pr
-0002d4a0: 6563 6973 696f 6e2c 2073 6361 6c65 290a  ecision, scale).
-0002d4b0: 0a0a 6465 6620 6173 5f64 6f75 626c 6528  ..def as_double(
-0002d4c0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
-0002d4d0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002d4e0: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
-0002d4f0: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
-0002d500: 6f20 6120 666c 6f61 7469 6e67 2d70 6f69  o a floating-poi
-0002d510: 6e74 2076 616c 7565 2e0a 0a20 2020 2045  nt value...    E
-0002d520: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002d530: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
-0002d540: 6e2e 7371 6c28 2273 656c 6563 7420 312e  n.sql("select 1.
-0002d550: 3233 3435 3a3a 7661 7269 616e 7420 6173  2345::variant as
-0002d560: 2061 2229 0a20 2020 2020 2020 203e 3e3e   a").        >>>
-0002d570: 2064 662e 7365 6c65 6374 2861 735f 646f   df.select(as_do
-0002d580: 7562 6c65 2822 6122 292e 616c 6961 7328  uble("a").alias(
-0002d590: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-0002d5a0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-0002d5b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0002d5c0: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-0002d5d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0002d5e0: 0a20 2020 2020 2020 207c 312e 3233 3435  .        |1.2345
-0002d5f0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
-0002d600: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002d610: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0002d620: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0002d630: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
-0002d640: 7269 616e 742c 2022 6173 5f64 6f75 626c  riant, "as_doubl
-0002d650: 6522 290a 2020 2020 7265 7475 726e 2062  e").    return b
-0002d660: 7569 6c74 696e 2822 6173 5f64 6f75 626c  uiltin("as_doubl
-0002d670: 6522 2928 6329 0a0a 0a64 6566 2061 735f  e")(c)...def as_
-0002d680: 7265 616c 2876 6172 6961 6e74 3a20 436f  real(variant: Co
-0002d690: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
-0002d6a0: 6f6c 756d 6e3a 0a20 2020 2022 2222 4361  olumn:.    """Ca
-0002d6b0: 7374 7320 6120 5641 5249 414e 5420 7661  sts a VARIANT va
-0002d6c0: 6c75 6520 746f 2061 2066 6c6f 6174 696e  lue to a floatin
-0002d6d0: 672d 706f 696e 7420 7661 6c75 652e 0a0a  g-point value...
-0002d6e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-0002d6f0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002d700: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002d710: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
-0002d720: 5661 7269 616e 7454 7970 652c 2053 7472  VariantType, Str
-0002d730: 7563 7454 7970 652c 2053 7472 7563 7446  uctType, StructF
-0002d740: 6965 6c64 2c20 446f 7562 6c65 5479 7065  ield, DoubleType
-0002d750: 0a20 2020 2020 2020 203e 3e3e 2073 6368  .        >>> sch
-0002d760: 656d 613d 5374 7275 6374 5479 7065 285b  ema=StructType([
-0002d770: 5374 7275 6374 4669 656c 6428 2272 6164  StructField("rad
-0002d780: 6975 7322 2c20 446f 7562 6c65 5479 7065  ius", DoubleType
-0002d790: 2829 292c 2020 5374 7275 6374 4669 656c  ()),  StructFiel
-0002d7a0: 6428 2272 6164 6975 735f 7622 2c20 5661  d("radius_v", Va
-0002d7b0: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
-0002d7c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002d7d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-0002d7e0: 6174 6166 7261 6d65 2864 6174 613d 5b5b  ataframe(data=[[
-0002d7f0: 322e 302c 204e 6f6e 655d 5d2c 2073 6368  2.0, None]], sch
-0002d800: 656d 613d 7363 6865 6d61 290a 2020 2020  ema=schema).    
-0002d810: 2020 2020 3e3e 3e20 6466 2e72 6164 6975      >>> df.radiu
-0002d820: 735f 7620 3d20 746f 5f76 6172 6961 6e74  s_v = to_variant
-0002d830: 2864 662e 7261 6469 7573 290a 2020 2020  (df.radius).    
-0002d840: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002d850: 7428 6466 2e72 6164 6975 735f 762e 6173  t(df.radius_v.as
-0002d860: 5f28 2272 6164 6975 735f 7622 292c 2064  _("radius_v"), d
-0002d870: 662e 7261 6469 7573 292e 636f 6c6c 6563  f.radius).collec
-0002d880: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-0002d890: 2852 4144 4955 535f 563d 2732 2e30 3030  (RADIUS_V='2.000
-0002d8a0: 3030 3030 3030 3030 3030 3030 652b 3030  000000000000e+00
-0002d8b0: 272c 2052 4144 4955 533d 322e 3029 5d0a  ', RADIUS=2.0)].
-0002d8c0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002d8d0: 656c 6563 7428 6173 5f72 6561 6c28 6466  elect(as_real(df
-0002d8e0: 2e72 6164 6975 735f 7629 2e61 735f 2822  .radius_v).as_("
-0002d8f0: 7265 616c 5f72 6164 6975 735f 7622 292c  real_radius_v"),
-0002d900: 2064 662e 7261 6469 7573 292e 636f 6c6c   df.radius).coll
-0002d910: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-0002d920: 6f77 2852 4541 4c5f 5241 4449 5553 5f56  ow(REAL_RADIUS_V
-0002d930: 3d32 2e30 2c20 5241 4449 5553 3d32 2e30  =2.0, RADIUS=2.0
-0002d940: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0002d950: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0002d960: 7228 7661 7269 616e 742c 2022 6173 5f72  r(variant, "as_r
-0002d970: 6561 6c22 290a 2020 2020 7265 7475 726e  eal").    return
-0002d980: 2062 7569 6c74 696e 2822 6173 5f72 6561   builtin("as_rea
-0002d990: 6c22 2928 6329 0a0a 0a64 6566 2061 735f  l")(c)...def as_
-0002d9a0: 696e 7465 6765 7228 7661 7269 616e 743a  integer(variant:
-0002d9b0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
-0002d9c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
-0002d9d0: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
-0002d9e0: 2076 616c 7565 2074 6f20 616e 2069 6e74   value to an int
-0002d9f0: 6567 6572 2e0a 0a20 2020 2045 7861 6d70  eger...    Examp
-0002da00: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
-0002da10: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
-0002da20: 6c28 2273 656c 6563 7420 312e 3233 3435  l("select 1.2345
-0002da30: 3a3a 7661 7269 616e 7420 6173 2061 2229  ::variant as a")
-0002da40: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002da50: 7365 6c65 6374 2861 735f 696e 7465 6765  select(as_intege
-0002da60: 7228 2261 2229 2e61 6c69 6173 2822 7265  r("a").alias("re
-0002da70: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
-0002da80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002da90: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
-0002daa0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
-0002dab0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
-0002dac0: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
-0002dad0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0002dae0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002daf0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
-0002db00: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
-0002db10: 636f 6c5f 6966 5f73 7472 2876 6172 6961  col_if_str(varia
-0002db20: 6e74 2c20 2261 735f 696e 7465 6765 7222  nt, "as_integer"
-0002db30: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002db40: 6c74 696e 2822 6173 5f69 6e74 6567 6572  ltin("as_integer
-0002db50: 2229 2863 290a 0a0a 6465 6620 6173 5f6f  ")(c)...def as_o
-0002db60: 626a 6563 7428 7661 7269 616e 743a 2043  bject(variant: C
-0002db70: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0002db80: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0002db90: 6173 7473 2061 2056 4152 4941 4e54 2076  asts a VARIANT v
-0002dba0: 616c 7565 2074 6f20 616e 206f 626a 6563  alue to an objec
-0002dbb0: 742e 0a0a 2020 2020 4578 616d 706c 653a  t...    Example:
-0002dbc0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
-0002dbd0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-0002dbe0: 7365 6c65 6374 206f 626a 6563 745f 636f  select object_co
-0002dbf0: 6e73 7472 7563 7428 2741 272c 312c 2742  nstruct('A',1,'B
-0002dc00: 272c 2742 4242 4227 293a 3a76 6172 6961  ','BBBB')::varia
-0002dc10: 6e74 2061 7320 6122 290a 2020 2020 2020  nt as a").      
-0002dc20: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002dc30: 6173 5f6f 626a 6563 7428 2261 2229 2e61  as_object("a").a
-0002dc40: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
-0002dc50: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
-0002dc60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002dc70: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
-0002dc80: 5422 2020 2020 2020 207c 0a20 2020 2020  T"       |.     
-0002dc90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-0002dca0: 2d2d 2d2d 0a20 2020 2020 2020 207c 7b20  ----.        |{ 
-0002dcb0: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
-0002dcc0: 2020 2020 2020 207c 2020 2241 223a 2031         |  "A": 1
-0002dcd0: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
-0002dce0: 207c 2020 2242 223a 2022 4242 4242 2220   |  "B": "BBBB" 
-0002dcf0: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
-0002dd00: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
-0002dd10: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0002dd20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-0002dd30: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-0002dd40: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
-0002dd50: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
-0002dd60: 742c 2022 6173 5f6f 626a 6563 7422 290a  t, "as_object").
-0002dd70: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002dd80: 696e 2822 6173 5f6f 626a 6563 7422 2928  in("as_object")(
-0002dd90: 6329 0a0a 0a64 6566 2061 735f 7469 6d65  c)...def as_time
-0002dda0: 2876 6172 6961 6e74 3a20 436f 6c75 6d6e  (variant: Column
-0002ddb0: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-0002ddc0: 6e3a 0a20 2020 2022 2222 4361 7374 7320  n:.    """Casts 
-0002ddd0: 6120 5641 5249 414e 5420 7661 6c75 6520  a VARIANT value 
-0002dde0: 746f 2061 2074 696d 6520 7661 6c75 652e  to a time value.
-0002ddf0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0002de00: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0002de10: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-0002de20: 7061 726b 2e66 756e 6374 696f 6e73 2069  park.functions i
-0002de30: 6d70 6f72 7420 6173 5f74 696d 652c 2074  mport as_time, t
-0002de40: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
-0002de50: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-0002de60: 6f6e 2e73 716c 2822 7365 6c65 6374 2054  on.sql("select T
-0002de70: 4f5f 5449 4d45 2827 3132 3a33 343a 3536  O_TIME('12:34:56
-0002de80: 2729 2061 7320 616c 6172 6d22 290a 2020  ') as alarm").  
-0002de90: 2020 2020 2020 3e3e 3e20 6466 2e61 6c61        >>> df.ala
-0002dea0: 726d 5f76 203d 2074 6f5f 7661 7269 616e  rm_v = to_varian
-0002deb0: 7428 6466 2e61 6c61 726d 290a 2020 2020  t(df.alarm).    
-0002dec0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002ded0: 7428 6466 2e61 6c61 726d 5f76 2e61 735f  t(df.alarm_v.as_
-0002dee0: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
-0002def0: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
-0002df00: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
-0002df10: 6563 7428 290a 2020 2020 2020 2020 4661  ect().        Fa
-0002df20: 6c73 650a 2020 2020 2020 2020 3e3e 3e20  lse.        >>> 
-0002df30: 6466 2e73 656c 6563 7428 6173 5f74 696d  df.select(as_tim
-0002df40: 6528 6466 2e61 6c61 726d 5f76 292e 6173  e(df.alarm_v).as
-0002df50: 5f28 2261 6c61 726d 2229 292e 636f 6c6c  _("alarm")).coll
-0002df60: 6563 7428 2920 3d3d 2064 662e 7365 6c65  ect() == df.sele
-0002df70: 6374 2864 662e 616c 6172 6d29 2e63 6f6c  ct(df.alarm).col
-0002df80: 6c65 6374 2829 0a20 2020 2020 2020 2054  lect().        T
-0002df90: 7275 650a 2020 2020 2222 220a 2020 2020  rue.    """.    
-0002dfa0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
-0002dfb0: 7472 2876 6172 6961 6e74 2c20 2261 735f  tr(variant, "as_
-0002dfc0: 7469 6d65 2229 0a20 2020 2072 6574 7572  time").    retur
-0002dfd0: 6e20 6275 696c 7469 6e28 2261 735f 7469  n builtin("as_ti
-0002dfe0: 6d65 2229 2863 290a 0a0a 6465 6620 6173  me")(c)...def as
-0002dff0: 5f74 696d 6573 7461 6d70 5f6c 747a 2876  _timestamp_ltz(v
-0002e000: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-0002e010: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002e020: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-0002e030: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002e040: 2061 2054 494d 4553 5441 4d50 2077 6974   a TIMESTAMP wit
-0002e050: 6820 6120 6c6f 6361 6c20 7469 6d65 7a6f  h a local timezo
-0002e060: 6e65 2e0a 0a20 2020 2045 7861 6d70 6c65  ne...    Example
-0002e070: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0002e080: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0002e090: 6e6f 7770 6172 6b2e 6675 6e63 7469 6f6e  nowpark.function
-0002e0a0: 7320 696d 706f 7274 2061 735f 7469 6d65  s import as_time
-0002e0b0: 7374 616d 705f 6c74 7a2c 2074 6f5f 7661  stamp_ltz, to_va
-0002e0c0: 7269 616e 740a 2020 2020 2020 2020 3e3e  riant.        >>
-0002e0d0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
-0002e0e0: 716c 2822 7365 6c65 6374 2054 4f5f 5449  ql("select TO_TI
-0002e0f0: 4d45 5354 414d 505f 4c54 5a28 2732 3031  MESTAMP_LTZ('201
-0002e100: 382d 3130 2d31 3020 3132 3a33 343a 3536  8-10-10 12:34:56
-0002e110: 2729 2061 7320 616c 6172 6d22 290a 2020  ') as alarm").  
-0002e120: 2020 2020 2020 3e3e 3e20 6466 2e61 6c61        >>> df.ala
-0002e130: 726d 5f76 203d 2074 6f5f 7661 7269 616e  rm_v = to_varian
-0002e140: 7428 6466 2e61 6c61 726d 290a 2020 2020  t(df.alarm).    
-0002e150: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002e160: 7428 6466 2e61 6c61 726d 5f76 2e61 735f  t(df.alarm_v.as_
-0002e170: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
-0002e180: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
-0002e190: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
-0002e1a0: 6563 7428 290a 2020 2020 2020 2020 4661  ect().        Fa
-0002e1b0: 6c73 650a 2020 2020 2020 2020 3e3e 3e20  lse.        >>> 
-0002e1c0: 6466 2e73 656c 6563 7428 6173 5f74 696d  df.select(as_tim
-0002e1d0: 6573 7461 6d70 5f6c 747a 2864 662e 616c  estamp_ltz(df.al
-0002e1e0: 6172 6d5f 7629 2e61 735f 2822 616c 6172  arm_v).as_("alar
-0002e1f0: 6d22 2929 2e63 6f6c 6c65 6374 2829 203d  m")).collect() =
-0002e200: 3d20 6466 2e73 656c 6563 7428 6466 2e61  = df.select(df.a
-0002e210: 6c61 726d 292e 636f 6c6c 6563 7428 290a  larm).collect().
-0002e220: 2020 2020 2020 2020 5472 7565 0a20 2020          True.   
-0002e230: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
-0002e240: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
-0002e250: 616e 742c 2022 6173 5f74 696d 6573 7461  ant, "as_timesta
-0002e260: 6d70 5f6c 747a 2229 0a20 2020 2072 6574  mp_ltz").    ret
-0002e270: 7572 6e20 6275 696c 7469 6e28 2261 735f  urn builtin("as_
-0002e280: 7469 6d65 7374 616d 705f 6c74 7a22 2928  timestamp_ltz")(
-0002e290: 6329 0a0a 0a64 6566 2061 735f 7469 6d65  c)...def as_time
-0002e2a0: 7374 616d 705f 6e74 7a28 7661 7269 616e  stamp_ntz(varian
-0002e2b0: 743a 2043 6f6c 756d 6e4f 724e 616d 6529  t: ColumnOrName)
-0002e2c0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0002e2d0: 2222 2243 6173 7473 2061 2056 4152 4941  """Casts a VARIA
-0002e2e0: 4e54 2076 616c 7565 2074 6f20 6120 5449  NT value to a TI
-0002e2f0: 4d45 5354 414d 5020 7769 7468 206e 6f20  MESTAMP with no 
-0002e300: 7469 6d65 7a6f 6e65 2e0a 0a20 2020 2045  timezone...    E
-0002e310: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0002e320: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0002e330: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 6675  lake.snowpark.fu
-0002e340: 6e63 7469 6f6e 7320 696d 706f 7274 2061  nctions import a
-0002e350: 735f 7469 6d65 7374 616d 705f 6e74 7a2c  s_timestamp_ntz,
-0002e360: 2074 6f5f 7661 7269 616e 740a 2020 2020   to_variant.    
-0002e370: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002e380: 7369 6f6e 2e73 716c 2822 7365 6c65 6374  sion.sql("select
-0002e390: 2054 4f5f 5449 4d45 5354 414d 505f 4e54   TO_TIMESTAMP_NT
-0002e3a0: 5a28 2732 3031 382d 3130 2d31 3020 3132  Z('2018-10-10 12
-0002e3b0: 3a33 343a 3536 2729 2061 7320 616c 6172  :34:56') as alar
-0002e3c0: 6d22 290a 2020 2020 2020 2020 3e3e 3e20  m").        >>> 
-0002e3d0: 6466 2e61 6c61 726d 5f76 203d 2074 6f5f  df.alarm_v = to_
-0002e3e0: 7661 7269 616e 7428 6466 2e61 6c61 726d  variant(df.alarm
-0002e3f0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002e400: 2e73 656c 6563 7428 6466 2e61 6c61 726d  .select(df.alarm
-0002e410: 5f76 2e61 735f 2822 616c 6172 6d22 2929  _v.as_("alarm"))
-0002e420: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
-0002e430: 2e73 656c 6563 7428 6466 2e61 6c61 726d  .select(df.alarm
-0002e440: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0002e450: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
-0002e460: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002e470: 6173 5f74 696d 6573 7461 6d70 5f6e 747a  as_timestamp_ntz
-0002e480: 2864 662e 616c 6172 6d5f 7629 2e61 735f  (df.alarm_v).as_
-0002e490: 2822 616c 6172 6d22 2929 2e63 6f6c 6c65  ("alarm")).colle
-0002e4a0: 6374 2829 203d 3d20 6466 2e73 656c 6563  ct() == df.selec
-0002e4b0: 7428 6466 2e61 6c61 726d 292e 636f 6c6c  t(df.alarm).coll
-0002e4c0: 6563 7428 290a 2020 2020 2020 2020 5472  ect().        Tr
-0002e4d0: 7565 0a20 2020 2022 2222 0a20 2020 2063  ue.    """.    c
-0002e4e0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0002e4f0: 7228 7661 7269 616e 742c 2022 6173 5f74  r(variant, "as_t
-0002e500: 696d 6573 7461 6d70 5f6e 747a 2229 0a20  imestamp_ntz"). 
-0002e510: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0002e520: 6e28 2261 735f 7469 6d65 7374 616d 705f  n("as_timestamp_
-0002e530: 6e74 7a22 2928 6329 0a0a 0a64 6566 2061  ntz")(c)...def a
-0002e540: 735f 7469 6d65 7374 616d 705f 747a 2876  s_timestamp_tz(v
-0002e550: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
-0002e560: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
-0002e570: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
-0002e580: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002e590: 2061 2054 494d 4553 5441 4d50 2077 6974   a TIMESTAMP wit
-0002e5a0: 6820 6120 7469 6d65 7a6f 6e65 2e0a 0a20  h a timezone... 
-0002e5b0: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
-0002e5c0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0002e5d0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002e5e0: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-0002e5f0: 7274 2061 735f 7469 6d65 7374 616d 705f  rt as_timestamp_
-0002e600: 747a 2c20 746f 5f76 6172 6961 6e74 0a20  tz, to_variant. 
-0002e610: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0002e620: 7365 7373 696f 6e2e 7371 6c28 2273 656c  session.sql("sel
-0002e630: 6563 7420 544f 5f54 494d 4553 5441 4d50  ect TO_TIMESTAMP
-0002e640: 5f54 5a28 2732 3031 382d 3130 2d31 3020  _TZ('2018-10-10 
-0002e650: 3132 3a33 343a 3536 202b 3030 3030 2729  12:34:56 +0000')
-0002e660: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
-0002e670: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
-0002e680: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
-0002e690: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
-0002e6a0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-0002e6b0: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
-0002e6c0: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
-0002e6d0: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
-0002e6e0: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
-0002e6f0: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
-0002e700: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
-0002e710: 2e73 656c 6563 7428 6173 5f74 696d 6573  .select(as_times
-0002e720: 7461 6d70 5f74 7a28 6466 2e61 6c61 726d  tamp_tz(df.alarm
-0002e730: 5f76 292e 6173 5f28 2261 6c61 726d 2229  _v).as_("alarm")
-0002e740: 292e 636f 6c6c 6563 7428 2920 3d3d 2064  ).collect() == d
-0002e750: 662e 7365 6c65 6374 2864 662e 616c 6172  f.select(df.alar
-0002e760: 6d29 2e63 6f6c 6c65 6374 2829 0a20 2020  m).collect().   
-0002e770: 2020 2020 2054 7275 650a 2020 2020 2222       True.    ""
-0002e780: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
-0002e790: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
-0002e7a0: 2c20 2261 735f 7469 6d65 7374 616d 705f  , "as_timestamp_
-0002e7b0: 747a 2229 0a20 2020 2072 6574 7572 6e20  tz").    return 
-0002e7c0: 6275 696c 7469 6e28 2261 735f 7469 6d65  builtin("as_time
-0002e7d0: 7374 616d 705f 747a 2229 2863 290a 0a0a  stamp_tz")(c)...
-0002e7e0: 6465 6620 746f 5f62 696e 6172 7928 653a  def to_binary(e:
-0002e7f0: 2043 6f6c 756d 6e4f 724e 616d 652c 2066   ColumnOrName, f
-0002e800: 6d74 3a20 4f70 7469 6f6e 616c 5b73 7472  mt: Optional[str
-0002e810: 5d20 3d20 4e6f 6e65 2920 2d3e 2043 6f6c  ] = None) -> Col
-0002e820: 756d 6e3a 0a20 2020 2022 2222 436f 6e76  umn:.    """Conv
-0002e830: 6572 7473 2074 6865 2069 6e70 7574 2065  erts the input e
-0002e840: 7870 7265 7373 696f 6e20 746f 2061 2062  xpression to a b
-0002e850: 696e 6172 7920 7661 6c75 652e 2046 6f72  inary value. For
-0002e860: 204e 554c 4c20 696e 7075 742c 2074 6865   NULL input, the
-0002e870: 206f 7574 7075 7420 6973 204e 554c 4c2e   output is NULL.
-0002e880: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-0002e890: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002e8a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002e8b0: 5f64 6174 6166 7261 6d65 285b 2730 3027  _dataframe(['00'
-0002e8c0: 2c20 2736 3727 2c20 2730 3331 3227 5d2c  , '67', '0312'],
-0002e8d0: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
-0002e8e0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
-0002e8f0: 6c65 6374 2874 6f5f 6269 6e61 7279 2863  lect(to_binary(c
-0002e900: 6f6c 2827 6127 2929 2e61 735f 2827 616e  ol('a')).as_('an
-0002e910: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
-0002e920: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
-0002e930: 6279 7465 6172 7261 7928 6227 5c5c 7830  bytearray(b'\\x0
-0002e940: 3027 2929 2c20 526f 7728 414e 533d 6279  0')), Row(ANS=by
-0002e950: 7465 6172 7261 7928 6227 6727 2929 2c20  tearray(b'g')), 
-0002e960: 526f 7728 414e 533d 6279 7465 6172 7261  Row(ANS=bytearra
-0002e970: 7928 6227 5c5c 7830 335c 5c78 3132 2729  y(b'\\x03\\x12')
-0002e980: 295d 0a0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-0002e990: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002e9a0: 6174 655f 6461 7461 6672 616d 6528 5b27  ate_dataframe(['
-0002e9b0: 6147 5673 6247 383d 272c 2027 6432 3979  aGVsbG8=', 'd29y
-0002e9c0: 6247 513d 272c 2027 4951 3d3d 275d 2c20  bGQ=', 'IQ=='], 
-0002e9d0: 7363 6865 6d61 3d5b 2761 275d 290a 2020  schema=['a']).  
-0002e9e0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-0002e9f0: 6563 7428 746f 5f62 696e 6172 7928 636f  ect(to_binary(co
-0002ea00: 6c28 2761 2729 2c20 2742 4153 4536 3427  l('a'), 'BASE64'
-0002ea10: 292e 6173 5f28 2761 6e73 2729 292e 636f  ).as_('ans')).co
-0002ea20: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0002ea30: 5b52 6f77 2841 4e53 3d62 7974 6561 7272  [Row(ANS=bytearr
-0002ea40: 6179 2862 2768 656c 6c6f 2729 292c 2052  ay(b'hello')), R
-0002ea50: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
-0002ea60: 2862 2777 6f72 6c64 2729 292c 2052 6f77  (b'world')), Row
-0002ea70: 2841 4e53 3d62 7974 6561 7272 6179 2862  (ANS=bytearray(b
-0002ea80: 2721 2729 295d 0a0a 2020 2020 2020 2020  '!'))]..        
-0002ea90: 3e3e 3e20 6466 2e73 656c 6563 7428 746f  >>> df.select(to
-0002eaa0: 5f62 696e 6172 7928 636f 6c28 2761 2729  _binary(col('a')
-0002eab0: 2c20 2755 5446 2d38 2729 2e61 735f 2827  , 'UTF-8').as_('
-0002eac0: 616e 7327 2929 2e63 6f6c 6c65 6374 2829  ans')).collect()
-0002ead0: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
-0002eae0: 533d 6279 7465 6172 7261 7928 6227 6147  S=bytearray(b'aG
-0002eaf0: 5673 6247 383d 2729 292c 2052 6f77 2841  VsbG8=')), Row(A
-0002eb00: 4e53 3d62 7974 6561 7272 6179 2862 2764  NS=bytearray(b'd
-0002eb10: 3239 7962 4751 3d27 2929 2c20 526f 7728  29ybGQ=')), Row(
-0002eb20: 414e 533d 6279 7465 6172 7261 7928 6227  ANS=bytearray(b'
-0002eb30: 4951 3d3d 2729 295d 0a20 2020 2022 2222  IQ=='))].    """
-0002eb40: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-0002eb50: 5f69 665f 7374 7228 652c 2022 746f 5f62  _if_str(e, "to_b
-0002eb60: 696e 6172 7922 290a 2020 2020 7265 7475  inary").    retu
-0002eb70: 726e 2062 7569 6c74 696e 2822 746f 5f62  rn builtin("to_b
-0002eb80: 696e 6172 7922 2928 632c 2066 6d74 2920  inary")(c, fmt) 
-0002eb90: 6966 2066 6d74 2065 6c73 6520 6275 696c  if fmt else buil
-0002eba0: 7469 6e28 2274 6f5f 6269 6e61 7279 2229  tin("to_binary")
-0002ebb0: 2863 290a 0a0a 6465 6620 746f 5f61 7272  (c)...def to_arr
-0002ebc0: 6179 2865 3a20 436f 6c75 6d6e 4f72 4e61  ay(e: ColumnOrNa
-0002ebd0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
-0002ebe0: 2020 2022 2222 436f 6e76 6572 7473 2061     """Converts a
-0002ebf0: 6e79 2076 616c 7565 2074 6f20 616e 2041  ny value to an A
-0002ec00: 5252 4159 2076 616c 7565 206f 7220 4e55  RRAY value or NU
-0002ec10: 4c4c 2028 6966 2069 6e70 7574 2069 7320  LL (if input is 
-0002ec20: 4e55 4c4c 292e 0a0a 2020 2020 4578 616d  NULL)...    Exam
-0002ec30: 706c 653a 3a0a 0a20 2020 2020 2020 203e  ple::..        >
-0002ec40: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0002ec50: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-0002ec60: 285b 312c 2032 2c20 332c 2034 5d2c 2073  ([1, 2, 3, 4], s
-0002ec70: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
-0002ec80: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-0002ec90: 6374 2874 6f5f 6172 7261 7928 636f 6c28  ct(to_array(col(
-0002eca0: 2761 2729 292e 6173 5f28 2761 6e73 2729  'a')).as_('ans')
-0002ecb0: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-0002ecc0: 2020 2020 5b52 6f77 2841 4e53 3d27 5b5c      [Row(ANS='[\
-0002ecd0: 5c6e 2020 315c 5c6e 5d27 292c 2052 6f77  \n  1\\n]'), Row
-0002ece0: 2841 4e53 3d27 5b5c 5c6e 2020 325c 5c6e  (ANS='[\\n  2\\n
-0002ecf0: 5d27 292c 2052 6f77 2841 4e53 3d27 5b5c  ]'), Row(ANS='[\
-0002ed00: 5c6e 2020 335c 5c6e 5d27 292c 2052 6f77  \n  3\\n]'), Row
-0002ed10: 2841 4e53 3d27 5b5c 5c6e 2020 345c 5c6e  (ANS='[\\n  4\\n
-0002ed20: 5d27 295d 0a0a 0a20 2020 2020 2020 203e  ]')]...        >
-0002ed30: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
-0002ed40: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
-0002ed50: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
-0002ed60: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-0002ed70: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-0002ed80: 5b52 6f77 2861 3d5b 312c 2032 2c20 335d  [Row(a=[1, 2, 3]
-0002ed90: 292c 2052 6f77 2861 3d4e 6f6e 6529 5d29  ), Row(a=None)])
-0002eda0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0002edb0: 7365 6c65 6374 2874 6f5f 6172 7261 7928  select(to_array(
-0002edc0: 636f 6c28 2761 2729 292e 6173 5f28 2761  col('a')).as_('a
-0002edd0: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
-0002ede0: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-0002edf0: 3d27 5b5c 5c6e 2020 312c 5c5c 6e20 2032  ='[\\n  1,\\n  2
-0002ee00: 2c5c 5c6e 2020 335c 5c6e 5d27 292c 2052  ,\\n  3\\n]'), R
-0002ee10: 6f77 2841 4e53 3d4e 6f6e 6529 5d0a 2020  ow(ANS=None)].  
-0002ee20: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
-0002ee30: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
-0002ee40: 2274 6f5f 6172 7261 7922 290a 2020 2020  "to_array").    
-0002ee50: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002ee60: 746f 5f61 7272 6179 2229 2863 290a 0a0a  to_array")(c)...
-0002ee70: 6465 6620 746f 5f6a 736f 6e28 653a 2043  def to_json(e: C
-0002ee80: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
-0002ee90: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
-0002eea0: 6f6e 7665 7274 7320 616e 7920 5641 5249  onverts any VARI
-0002eeb0: 414e 5420 7661 6c75 6520 746f 2061 2073  ANT value to a s
-0002eec0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
-0002eed0: 2074 6865 204a 534f 4e20 7265 7072 6573   the JSON repres
-0002eee0: 656e 7461 7469 6f6e 206f 6620 7468 650a  entation of the.
-0002eef0: 2020 2020 7661 6c75 652e 2049 6620 7468      value. If th
-0002ef00: 6520 696e 7075 7420 6973 204e 554c 4c2c  e input is NULL,
-0002ef10: 2074 6865 2072 6573 756c 7420 6973 2061   the result is a
-0002ef20: 6c73 6f20 4e55 4c4c 2e0a 0a20 2020 2045  lso NULL...    E
-0002ef30: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
-0002ef40: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0002ef50: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-0002ef60: 6573 2069 6d70 6f72 7420 5661 7269 616e  es import Varian
-0002ef70: 7454 7970 652c 2053 7472 7563 7446 6965  tType, StructFie
-0002ef80: 6c64 2c20 5374 7275 6374 5479 7065 0a20  ld, StructType. 
-0002ef90: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0002efa0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0002efb0: 726b 2069 6d70 6f72 7420 526f 770a 2020  rk import Row.  
-0002efc0: 2020 2020 2020 3e3e 3e20 7363 6865 6d61        >>> schema
-0002efd0: 203d 2053 7472 7563 7454 7970 6528 5b53   = StructType([S
-0002efe0: 7472 7563 7446 6965 6c64 2822 6122 2c20  tructField("a", 
-0002eff0: 5661 7269 616e 7454 7970 6528 2929 5d29  VariantType())])
-0002f000: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0002f010: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0002f020: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
-0002f030: 613d 4e6f 6e65 292c 526f 7728 613d 3132  a=None),Row(a=12
-0002f040: 292c 526f 7728 613d 332e 3134 3129 2c52  ),Row(a=3.141),R
-0002f050: 6f77 2861 3d7b 2761 273a 3130 2c27 6227  ow(a={'a':10,'b'
-0002f060: 3a32 307d 292c 526f 7728 613d 5b31 2c32  :20}),Row(a=[1,2
-0002f070: 332c 3435 365d 295d 2c20 7363 6865 6d61  3,456])], schema
-0002f080: 3d73 6368 656d 6129 0a20 2020 2020 2020  =schema).       
-0002f090: 203e 3e3e 2064 662e 7365 6c65 6374 2874   >>> df.select(t
-0002f0a0: 6f5f 6a73 6f6e 2863 6f6c 2822 6122 2929  o_json(col("a"))
-0002f0b0: 2e61 735f 2827 616e 7327 2929 2e63 6f6c  .as_('ans')).col
-0002f0c0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-0002f0d0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
-0002f0e0: 6f77 2841 4e53 3d27 3132 2729 2c20 526f  ow(ANS='12'), Ro
-0002f0f0: 7728 414e 533d 2733 2e31 3431 2729 2c20  w(ANS='3.141'), 
-0002f100: 526f 7728 414e 533d 277b 2261 223a 3130  Row(ANS='{"a":10
-0002f110: 2c22 6222 3a32 307d 2729 2c20 526f 7728  ,"b":20}'), Row(
-0002f120: 414e 533d 275b 312c 3233 2c34 3536 5d27  ANS='[1,23,456]'
-0002f130: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0002f140: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0002f150: 7228 652c 2022 746f 5f6a 736f 6e22 290a  r(e, "to_json").
-0002f160: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-0002f170: 696e 2822 746f 5f6a 736f 6e22 2928 6329  in("to_json")(c)
-0002f180: 0a0a 0a64 6566 2074 6f5f 6f62 6a65 6374  ...def to_object
-0002f190: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0002f1a0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0002f1b0: 2022 2222 436f 6e76 6572 7473 2061 6e79   """Converts any
-0002f1c0: 2076 616c 7565 2074 6f20 6120 4f42 4a45   value to a OBJE
-0002f1d0: 4354 2076 616c 7565 206f 7220 4e55 4c4c  CT value or NULL
-0002f1e0: 2028 6966 2069 6e70 7574 2069 7320 4e55   (if input is NU
-0002f1f0: 4c4c 292e 0a0a 2020 2020 4578 616d 706c  LL)...    Exampl
-0002f200: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-0002f210: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0002f220: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0002f230: 706f 7274 2056 6172 6961 6e74 5479 7065  port VariantType
-0002f240: 2c20 5374 7275 6374 4669 656c 642c 2053  , StructField, S
-0002f250: 7472 7563 7454 7970 650a 2020 2020 2020  tructType.      
-0002f260: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-0002f270: 6c61 6b65 2e73 6e6f 7770 6172 6b20 696d  lake.snowpark im
-0002f280: 706f 7274 2052 6f77 0a20 2020 2020 2020  port Row.       
-0002f290: 203e 3e3e 2073 6368 656d 6120 3d20 5374   >>> schema = St
-0002f2a0: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
-0002f2b0: 4669 656c 6428 2261 222c 2056 6172 6961  Field("a", Varia
-0002f2c0: 6e74 5479 7065 2829 295d 290a 2020 2020  ntType())]).    
-0002f2d0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002f2e0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002f2f0: 6672 616d 6528 5b22 7b27 6127 3a31 302c  frame(["{'a':10,
-0002f300: 2762 273a 3230 7d22 2c20 4e6f 6e65 5d2c  'b':20}", None],
-0002f310: 2073 6368 656d 613d 7363 6865 6d61 290a   schema=schema).
-0002f320: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0002f330: 656c 6563 7428 746f 5f6f 626a 6563 7428  elect(to_object(
-0002f340: 636f 6c28 2261 2229 292e 6173 5f28 2761  col("a")).as_('a
-0002f350: 6e73 2729 292e 636f 6c6c 6563 7428 290a  ns')).collect().
-0002f360: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-0002f370: 3d27 7b5c 5c6e 2020 2261 223a 2031 302c  ='{\\n  "a": 10,
-0002f380: 5c5c 6e20 2022 6222 3a20 3230 5c5c 6e7d  \\n  "b": 20\\n}
-0002f390: 2729 2c20 526f 7728 414e 533d 4e6f 6e65  '), Row(ANS=None
-0002f3a0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-0002f3b0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-0002f3c0: 7228 652c 2022 746f 5f6f 626a 6563 7422  r(e, "to_object"
-0002f3d0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-0002f3e0: 6c74 696e 2822 746f 5f6f 626a 6563 7422  ltin("to_object"
-0002f3f0: 2928 6329 0a0a 0a64 6566 2074 6f5f 7661  )(c)...def to_va
-0002f400: 7269 616e 7428 653a 2043 6f6c 756d 6e4f  riant(e: ColumnO
-0002f410: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-0002f420: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
-0002f430: 7320 616e 7920 7661 6c75 6520 746f 2061  s any value to a
-0002f440: 2056 4152 4941 4e54 2076 616c 7565 206f   VARIANT value o
-0002f450: 7220 4e55 4c4c 2028 6966 2069 6e70 7574  r NULL (if input
-0002f460: 2069 7320 4e55 4c4c 292e 0a0a 2020 2020   is NULL)...    
-0002f470: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0002f480: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0002f490: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0002f4a0: 7261 6d65 285b 312c 2032 2c20 332c 2034  rame([1, 2, 3, 4
-0002f4b0: 5d2c 2073 6368 656d 613d 5b27 6127 5d29  ], schema=['a'])
-0002f4c0: 0a20 2020 2020 2020 203e 3e3e 2064 665f  .        >>> df_
-0002f4d0: 636f 6e76 203d 2064 662e 7365 6c65 6374  conv = df.select
-0002f4e0: 2874 6f5f 7661 7269 616e 7428 636f 6c28  (to_variant(col(
-0002f4f0: 2261 2229 292e 6173 5f28 2261 6e73 2229  "a")).as_("ans")
-0002f500: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0002f510: 5f63 6f6e 762e 636f 6c6c 6563 7428 290a  _conv.collect().
-0002f520: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-0002f530: 3d27 3127 292c 2052 6f77 2841 4e53 3d27  ='1'), Row(ANS='
-0002f540: 3227 292c 2052 6f77 2841 4e53 3d27 3327  2'), Row(ANS='3'
-0002f550: 292c 2052 6f77 2841 4e53 3d27 3427 295d  ), Row(ANS='4')]
-0002f560: 0a0a 2020 2020 2020 2020 4166 7465 7220  ..        After 
-0002f570: 636f 6e76 6572 7369 6f6e 2076 6961 2074  conversion via t
-0002f580: 6f5f 7661 7269 616e 742c 2061 6e6f 7468  o_variant, anoth
-0002f590: 6572 2076 6172 6961 6e74 2064 6174 6166  er variant dataf
-0002f5a0: 7261 6d65 2063 616e 2062 6520 6d65 7267  rame can be merg
-0002f5b0: 6564 2e0a 0a20 2020 2020 2020 203e 3e3e  ed...        >>>
-0002f5c0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
-0002f5d0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
-0002f5e0: 6d70 6f72 7420 5661 7269 616e 7454 7970  mport VariantTyp
-0002f5f0: 652c 2053 7472 7563 7446 6965 6c64 2c20  e, StructField, 
-0002f600: 5374 7275 6374 5479 7065 0a20 2020 2020  StructType.     
-0002f610: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0002f620: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
-0002f630: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
-0002f640: 2020 3e3e 3e20 7363 6865 6d61 203d 2053    >>> schema = S
-0002f650: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
-0002f660: 7446 6965 6c64 2822 6122 2c20 5661 7269  tField("a", Vari
-0002f670: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
-0002f680: 2020 2020 203e 3e3e 2064 665f 6f74 6865       >>> df_othe
-0002f690: 7220 3d20 7365 7373 696f 6e2e 6372 6561  r = session.crea
-0002f6a0: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
-0002f6b0: 7728 613d 3130 292c 2052 6f77 2861 3d27  w(a=10), Row(a='
-0002f6c0: 7465 7374 2729 2c20 526f 7728 613d 7b27  test'), Row(a={'
-0002f6d0: 6127 3a20 3130 2c20 2762 273a 2032 307d  a': 10, 'b': 20}
-0002f6e0: 292c 2052 6f77 2861 3d5b 312c 2032 2c20  ), Row(a=[1, 2, 
-0002f6f0: 335d 295d 2c20 7363 6865 6d61 3d73 6368  3])], schema=sch
-0002f700: 656d 6129 0a20 2020 2020 2020 203e 3e3e  ema).        >>>
-0002f710: 2064 665f 636f 6e76 2e75 6e69 6f6e 2864   df_conv.union(d
-0002f720: 665f 6f74 6865 7229 2e73 656c 6563 7428  f_other).select(
-0002f730: 7479 7065 6f66 2863 6f6c 2822 616e 7322  typeof(col("ans"
-0002f740: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
-0002f750: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-0002f760: 205b 526f 7728 414e 533d 2749 4e54 4547   [Row(ANS='INTEG
-0002f770: 4552 2729 2c20 526f 7728 414e 533d 2749  ER'), Row(ANS='I
-0002f780: 4e54 4547 4552 2729 2c20 526f 7728 414e  NTEGER'), Row(AN
-0002f790: 533d 2749 4e54 4547 4552 2729 2c20 526f  S='INTEGER'), Ro
-0002f7a0: 7728 414e 533d 2749 4e54 4547 4552 2729  w(ANS='INTEGER')
-0002f7b0: 2c20 526f 7728 414e 533d 2749 4e54 4547  , Row(ANS='INTEG
-0002f7c0: 4552 2729 2c20 526f 7728 414e 533d 2756  ER'), Row(ANS='V
-0002f7d0: 4152 4348 4152 2729 2c20 526f 7728 414e  ARCHAR'), Row(AN
-0002f7e0: 533d 274f 424a 4543 5427 292c 2052 6f77  S='OBJECT'), Row
-0002f7f0: 2841 4e53 3d27 4152 5241 5927 295d 0a20  (ANS='ARRAY')]. 
-0002f800: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
-0002f810: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
-0002f820: 2022 746f 5f76 6172 6961 6e74 2229 0a20   "to_variant"). 
-0002f830: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-0002f840: 6e28 2274 6f5f 7661 7269 616e 7422 2928  n("to_variant")(
-0002f850: 6329 0a0a 0a64 6566 2074 6f5f 786d 6c28  c)...def to_xml(
-0002f860: 653a 2043 6f6c 756d 6e4f 724e 616d 6529  e: ColumnOrName)
-0002f870: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-0002f880: 2222 2243 6f6e 7665 7274 7320 616e 7920  """Converts any 
-0002f890: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
-0002f8a0: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
-0002f8b0: 6e69 6e67 2074 6865 2058 4d4c 2072 6570  ning the XML rep
-0002f8c0: 7265 7365 6e74 6174 696f 6e20 6f66 2074  resentation of t
-0002f8d0: 6865 0a20 2020 2076 616c 7565 2e20 4966  he.    value. If
-0002f8e0: 2074 6865 2069 6e70 7574 2069 7320 4e55   the input is NU
-0002f8f0: 4c4c 2c20 7468 6520 7265 7375 6c74 2069  LL, the result i
-0002f900: 7320 616c 736f 204e 554c 4c2e 0a0a 2020  s also NULL...  
-0002f910: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
-0002f920: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0002f930: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0002f940: 7479 7065 7320 696d 706f 7274 2056 6172  types import Var
-0002f950: 6961 6e74 5479 7065 2c20 5374 7275 6374  iantType, Struct
-0002f960: 4669 656c 642c 2053 7472 7563 7454 7970  Field, StructTyp
-0002f970: 650a 2020 2020 2020 2020 3e3e 3e20 6672  e.        >>> fr
-0002f980: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-0002f990: 7770 6172 6b20 696d 706f 7274 2052 6f77  wpark import Row
-0002f9a0: 0a20 2020 2020 2020 203e 3e3e 2073 6368  .        >>> sch
-0002f9b0: 656d 6120 3d20 5374 7275 6374 5479 7065  ema = StructType
-0002f9c0: 285b 5374 7275 6374 4669 656c 6428 2261  ([StructField("a
-0002f9d0: 222c 2056 6172 6961 6e74 5479 7065 2829  ", VariantType()
-0002f9e0: 295d 290a 2020 2020 2020 2020 3e3e 3e20  )]).        >>> 
-0002f9f0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-0002fa00: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
-0002fa10: 6f77 2861 3d31 3029 2c20 526f 7728 613d  ow(a=10), Row(a=
-0002fa20: 2774 6573 7427 292c 2052 6f77 2861 3d7b  'test'), Row(a={
-0002fa30: 2761 273a 2031 302c 2027 6227 3a20 3230  'a': 10, 'b': 20
-0002fa40: 7d29 2c20 526f 7728 613d 5b31 2c20 322c  }), Row(a=[1, 2,
-0002fa50: 2033 5d29 5d2c 2073 6368 656d 613d 7363   3])], schema=sc
-0002fa60: 6865 6d61 290a 2020 2020 2020 2020 3e3e  hema).        >>
-0002fa70: 3e20 6466 2e73 656c 6563 7428 746f 5f78  > df.select(to_x
-0002fa80: 6d6c 2863 6f6c 2822 4122 2929 2e61 735f  ml(col("A")).as_
-0002fa90: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
-0002faa0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0002fab0: 414e 533d 273c 536e 6f77 666c 616b 6544  ANS='<SnowflakeD
-0002fac0: 6174 6120 7479 7065 3d22 494e 5445 4745  ata type="INTEGE
-0002fad0: 5222 3e31 303c 2f53 6e6f 7766 6c61 6b65  R">10</Snowflake
-0002fae0: 4461 7461 3e27 292c 2052 6f77 2841 4e53  Data>'), Row(ANS
-0002faf0: 3d27 3c53 6e6f 7766 6c61 6b65 4461 7461  ='<SnowflakeData
-0002fb00: 2074 7970 653d 2256 4152 4348 4152 223e   type="VARCHAR">
-0002fb10: 7465 7374 3c2f 536e 6f77 666c 616b 6544  test</SnowflakeD
-0002fb20: 6174 613e 2729 2c20 526f 7728 414e 533d  ata>'), Row(ANS=
-0002fb30: 273c 536e 6f77 666c 616b 6544 6174 6120  '<SnowflakeData 
-0002fb40: 7479 7065 3d22 4f42 4a45 4354 223e 3c61  type="OBJECT"><a
-0002fb50: 2074 7970 653d 2249 4e54 4547 4552 223e   type="INTEGER">
-0002fb60: 3130 3c2f 613e 3c62 2074 7970 653d 2249  10</a><b type="I
-0002fb70: 4e54 4547 4552 223e 3230 3c2f 623e 3c2f  NTEGER">20</b></
-0002fb80: 536e 6f77 666c 616b 6544 6174 613e 2729  SnowflakeData>')
-0002fb90: 2c20 526f 7728 414e 533d 273c 536e 6f77  , Row(ANS='<Snow
-0002fba0: 666c 616b 6544 6174 6120 7479 7065 3d22  flakeData type="
-0002fbb0: 4152 5241 5922 3e3c 6520 7479 7065 3d22  ARRAY"><e type="
-0002fbc0: 494e 5445 4745 5222 3e31 3c2f 653e 3c65  INTEGER">1</e><e
-0002fbd0: 2074 7970 653d 2249 4e54 4547 4552 223e   type="INTEGER">
-0002fbe0: 323c 2f65 3e3c 6520 7479 7065 3d22 494e  2</e><e type="IN
-0002fbf0: 5445 4745 5222 3e33 3c2f 653e 3c2f 536e  TEGER">3</e></Sn
-0002fc00: 6f77 666c 616b 6544 6174 613e 2729 5d0a  owflakeData>')].
-0002fc10: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-0002fc20: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
-0002fc30: 2c20 2274 6f5f 786d 6c22 290a 2020 2020  , "to_xml").    
-0002fc40: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
-0002fc50: 746f 5f78 6d6c 2229 2863 290a 0a0a 6465  to_xml")(c)...de
-0002fc60: 6620 6765 745f 6967 6e6f 7265 5f63 6173  f get_ignore_cas
-0002fc70: 6528 6f62 6a3a 2043 6f6c 756d 6e4f 724e  e(obj: ColumnOrN
-0002fc80: 616d 652c 2066 6965 6c64 3a20 436f 6c75  ame, field: Colu
-0002fc90: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0002fca0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-0002fcb0: 2045 7874 7261 6374 7320 6120 6669 656c   Extracts a fiel
-0002fcc0: 6420 7661 6c75 6520 6672 6f6d 2061 6e20  d value from an 
-0002fcd0: 6f62 6a65 6374 2e20 5265 7475 726e 7320  object. Returns 
-0002fce0: 4e55 4c4c 2069 6620 6569 7468 6572 206f  NULL if either o
-0002fcf0: 6620 7468 6520 6172 6775 6d65 6e74 7320  f the arguments 
-0002fd00: 6973 204e 554c 4c2e 0a20 2020 2054 6869  is NULL..    Thi
-0002fd10: 7320 6675 6e63 7469 6f6e 2069 7320 7369  s function is si
-0002fd20: 6d69 6c61 7220 746f 203a 6d65 7468 3a60  milar to :meth:`
-0002fd30: 6765 7460 2062 7574 2061 7070 6c69 6573  get` but applies
-0002fd40: 2063 6173 652d 696e 7365 6e73 6974 6976   case-insensitiv
-0002fd50: 6520 6d61 7463 6869 6e67 2074 6f20 6669  e matching to fi
-0002fd60: 656c 6420 6e61 6d65 732e 0a0a 2020 2020  eld names...    
-0002fd70: 4578 616d 706c 6573 3a3a 0a0a 2020 2020  Examples::..    
-0002fd80: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-0002fd90: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-0002fda0: 6672 616d 6528 5b7b 2261 223a 207b 2261  frame([{"a": {"a
-0002fdb0: 6122 3a20 312c 2022 6262 223a 2032 2c20  a": 1, "bb": 2, 
-0002fdc0: 2263 6322 3a20 337d 7d5d 290a 2020 2020  "cc": 3}}]).    
-0002fdd0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-0002fde0: 7428 6765 745f 6967 6e6f 7265 5f63 6173  t(get_ignore_cas
-0002fdf0: 6528 6466 5b22 6122 5d2c 206c 6974 2822  e(df["a"], lit("
-0002fe00: 4141 2229 292e 616c 6961 7328 2267 6574  AA")).alias("get
-0002fe10: 5f69 676e 6f72 655f 6361 7365 2229 292e  _ignore_case")).
-0002fe20: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-0002fe30: 2020 5b52 6f77 2847 4554 5f49 474e 4f52    [Row(GET_IGNOR
-0002fe40: 455f 4341 5345 3d27 3127 295d 0a20 2020  E_CASE='1')].   
-0002fe50: 2022 2222 0a20 2020 2063 3120 3d20 5f74   """.    c1 = _t
-0002fe60: 6f5f 636f 6c5f 6966 5f73 7472 286f 626a  o_col_if_str(obj
-0002fe70: 2c20 2267 6574 5f69 676e 6f72 655f 6361  , "get_ignore_ca
-0002fe80: 7365 2229 0a20 2020 2063 3220 3d20 5f74  se").    c2 = _t
-0002fe90: 6f5f 636f 6c5f 6966 5f73 7472 2866 6965  o_col_if_str(fie
-0002fea0: 6c64 2c20 2267 6574 5f69 676e 6f72 655f  ld, "get_ignore_
-0002feb0: 6361 7365 2229 0a20 2020 2072 6574 7572  case").    retur
-0002fec0: 6e20 6275 696c 7469 6e28 2267 6574 5f69  n builtin("get_i
-0002fed0: 676e 6f72 655f 6361 7365 2229 2863 312c  gnore_case")(c1,
-0002fee0: 2063 3229 0a0a 0a64 6566 206f 626a 6563   c2)...def objec
-0002fef0: 745f 6b65 7973 286f 626a 3a20 436f 6c75  t_keys(obj: Colu
-0002ff00: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
-0002ff10: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-0002ff20: 726e 7320 616e 2061 7272 6179 2063 6f6e  rns an array con
-0002ff30: 7461 696e 696e 6720 7468 6520 6c69 7374  taining the list
-0002ff40: 206f 6620 6b65 7973 2069 6e20 7468 6520   of keys in the 
-0002ff50: 696e 7075 7420 6f62 6a65 6374 2e0a 0a0a  input object....
-0002ff60: 2020 2020 4578 616d 706c 653a 3a0a 2020      Example::.  
-0002ff70: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
-0002ff80: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0002ff90: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
-0002ffa0: 7274 206c 6974 0a20 2020 2020 2020 203e  rt lit.        >
-0002ffb0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-0002ffc0: 7371 6c28 0a20 2020 2020 2020 202e 2e2e  sql(.        ...
-0002ffd0: 2020 2020 2022 7365 6c65 6374 206f 626a       "select obj
-0002ffe0: 6563 745f 636f 6e73 7472 7563 7428 612c  ect_construct(a,
-0002fff0: 622c 632c 642c 652c 6629 2061 7320 6f62  b,c,d,e,f) as ob
-00030000: 6a2c 206b 2c20 7620 6672 6f6d 2022 0a20  j, k, v from ". 
-00030010: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
-00030020: 7661 6c75 6573 2827 6167 6527 2c20 3231  values('age', 21
-00030030: 2c20 277a 6970 272c 2032 3130 3231 2c20  , 'zip', 21021, 
-00030040: 276e 616d 6527 2c20 274a 6f65 272c 2027  'name', 'Joe', '
-00030050: 6167 6527 2c20 3029 2c22 0a20 2020 2020  age', 0),".     
-00030060: 2020 202e 2e2e 2020 2020 2022 2827 6167     ...     "('ag
-00030070: 6527 2c20 3236 2c20 277a 6970 272c 2039  e', 26, 'zip', 9
-00030080: 3430 3231 2c20 276e 616d 6527 2c20 274a  4021, 'name', 'J
-00030090: 6179 272c 2027 6167 6527 2c20 3029 2061  ay', 'age', 0) a
-000300a0: 7320 5428 612c 622c 632c 642c 652c 662c  s T(a,b,c,d,e,f,
-000300b0: 6b2c 7629 220a 2020 2020 2020 2020 2e2e  k,v)".        ..
-000300c0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-000300d0: 6466 2e73 656c 6563 7428 6f62 6a65 6374  df.select(object
-000300e0: 5f6b 6579 7328 636f 6c28 226f 626a 2229  _keys(col("obj")
-000300f0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00030100: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00030110: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a    -------------.
-00030120: 2020 2020 2020 2020 7c22 5245 5355 4c54          |"RESULT
-00030130: 2220 2020 7c0a 2020 2020 2020 2020 2d2d  "   |.        --
-00030140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00030150: 2020 2020 7c5b 2020 2020 2020 2020 2020      |[          
-00030160: 7c0a 2020 2020 2020 2020 7c20 2022 6167  |.        |  "ag
-00030170: 6522 2c20 2020 7c0a 2020 2020 2020 2020  e",   |.        
-00030180: 7c20 2022 6e61 6d65 222c 2020 7c0a 2020  |  "name",  |.  
-00030190: 2020 2020 2020 7c20 2022 7a69 7022 2020        |  "zip"  
-000301a0: 2020 7c0a 2020 2020 2020 2020 7c5d 2020    |.        |]  
-000301b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000301c0: 2020 7c5b 2020 2020 2020 2020 2020 7c0a    |[          |.
-000301d0: 2020 2020 2020 2020 7c20 2022 6167 6522          |  "age"
-000301e0: 2c20 2020 7c0a 2020 2020 2020 2020 7c20  ,   |.        | 
-000301f0: 2022 6e61 6d65 222c 2020 7c0a 2020 2020   "name",  |.    
-00030200: 2020 2020 7c20 2022 7a69 7022 2020 2020      |  "zip"    
-00030210: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
-00030220: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00030230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00030240: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
-00030250: 3e0a 2020 2020 2222 220a 2020 2020 6320  >.    """.    c 
-00030260: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-00030270: 286f 626a 2c20 226f 626a 6563 745f 6b65  (obj, "object_ke
-00030280: 7973 2229 0a20 2020 2072 6574 7572 6e20  ys").    return 
-00030290: 6275 696c 7469 6e28 226f 626a 6563 745f  builtin("object_
-000302a0: 6b65 7973 2229 2863 290a 0a0a 6465 6620  keys")(c)...def 
-000302b0: 786d 6c67 6574 280a 2020 2020 786d 6c3a  xmlget(.    xml:
-000302c0: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
-000302d0: 2020 2074 6167 3a20 436f 6c75 6d6e 4f72     tag: ColumnOr
-000302e0: 4e61 6d65 2c0a 2020 2020 696e 7374 616e  Name,.    instan
-000302f0: 6365 5f6e 756d 3a20 556e 696f 6e5b 436f  ce_num: Union[Co
-00030300: 6c75 6d6e 4f72 4e61 6d65 2c20 696e 745d  lumnOrName, int]
-00030310: 203d 2030 2c0a 2920 2d3e 2043 6f6c 756d   = 0,.) -> Colum
-00030320: 6e3a 0a20 2020 2022 2222 4578 7472 6163  n:.    """Extrac
-00030330: 7473 2061 6e20 584d 4c20 656c 656d 656e  ts an XML elemen
-00030340: 7420 6f62 6a65 6374 2028 6f66 7465 6e20  t object (often 
-00030350: 7265 6665 7272 6564 2074 6f20 6173 2073  referred to as s
-00030360: 696d 706c 7920 6120 7461 6729 2066 726f  imply a tag) fro
-00030370: 6d20 6120 636f 6e74 656e 7420 6f66 206f  m a content of o
-00030380: 7574 6572 0a20 2020 2058 4d4c 2065 6c65  uter.    XML ele
-00030390: 6d65 6e74 206f 626a 6563 7420 6279 2074  ment object by t
-000303a0: 6865 206e 616d 6520 6f66 2074 6865 2074  he name of the t
-000303b0: 6167 2061 6e64 2069 7473 2069 6e73 7461  ag and its insta
-000303c0: 6e63 6520 6e75 6d62 6572 2028 636f 756e  nce number (coun
-000303d0: 7469 6e67 2066 726f 6d20 3029 2e0a 0a20  ting from 0)... 
-000303e0: 2020 2054 6865 2066 6f6c 6c6f 7769 6e67     The following
-000303f0: 2065 7861 6d70 6c65 2072 6574 7572 6e73   example returns
-00030400: 2074 6865 2066 6972 7374 2069 6e6e 6572   the first inner
-00030410: 206c 6576 656c 2028 6c65 7665 6c32 2920   level (level2) 
-00030420: 6672 6f6d 2074 6865 2058 4d4c 206f 626a  from the XML obj
-00030430: 6563 7420 6372 6561 7465 6420 7669 6120  ect created via 
-00030440: 6070 6172 7365 5f78 6d6c 602e 0a0a 2020  `parse_xml`...  
-00030450: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00030460: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00030470: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00030480: 6166 7261 6d65 285b 273c 6c65 7665 6c31  aframe(['<level1
-00030490: 2061 7474 7231 3d22 6122 3e31 3c6c 6576   attr1="a">1<lev
-000304a0: 656c 3220 6174 7472 323d 2262 223e 323c  el2 attr2="b">2<
-000304b0: 6c65 7665 6c33 3e33 613c 2f6c 6576 656c  level3>3a</level
-000304c0: 333e 3c6c 6576 656c 333e 3362 3c2f 6c65  3><level3>3b</le
-000304d0: 7665 6c33 3e3c 2f6c 6576 656c 323e 3c2f  vel3></level2></
-000304e0: 6c65 7665 6c31 3e27 5d2c 2073 6368 656d  level1>'], schem
-000304f0: 613d 5b22 7374 7222 5d29 2e73 656c 6563  a=["str"]).selec
-00030500: 7428 7061 7273 655f 786d 6c28 2273 7472  t(parse_xml("str
-00030510: 2229 2e61 735f 2822 6f62 6a22 2929 0a20  ").as_("obj")). 
-00030520: 2020 2020 2020 203e 3e3e 2064 662e 636f         >>> df.co
-00030530: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00030540: 5b52 6f77 284f 424a 3d27 3c6c 6576 656c  [Row(OBJ='<level
-00030550: 3120 6174 7472 313d 2261 223e 5c5c 6e20  1 attr1="a">\\n 
-00030560: 2031 5c5c 6e20 203c 6c65 7665 6c32 2061   1\\n  <level2 a
-00030570: 7474 7232 3d22 6222 3e5c 5c6e 2020 2020  ttr2="b">\\n    
-00030580: 325c 5c6e 2020 2020 3c6c 6576 656c 333e  2\\n    <level3>
-00030590: 3361 3c2f 6c65 7665 6c33 3e5c 5c6e 2020  3a</level3>\\n  
-000305a0: 2020 3c6c 6576 656c 333e 3362 3c2f 6c65    <level3>3b</le
-000305b0: 7665 6c33 3e5c 5c6e 2020 3c2f 6c65 7665  vel3>\\n  </leve
-000305c0: 6c32 3e5c 5c6e 3c2f 6c65 7665 6c31 3e27  l2>\\n</level1>'
-000305d0: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
-000305e0: 662e 7365 6c65 6374 2878 6d6c 6765 7428  f.select(xmlget(
-000305f0: 226f 626a 222c 206c 6974 2822 6c65 7665  "obj", lit("leve
-00030600: 6c32 2229 292e 6173 5f28 2261 6e73 2229  l2")).as_("ans")
-00030610: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00030620: 2020 2020 5b52 6f77 2841 4e53 3d27 3c6c      [Row(ANS='<l
-00030630: 6576 656c 3220 6174 7472 323d 2262 223e  evel2 attr2="b">
-00030640: 5c5c 6e20 2032 5c5c 6e20 203c 6c65 7665  \\n  2\\n  <leve
-00030650: 6c33 3e33 613c 2f6c 6576 656c 333e 5c5c  l3>3a</level3>\\
-00030660: 6e20 203c 6c65 7665 6c33 3e33 623c 2f6c  n  <level3>3b</l
-00030670: 6576 656c 333e 5c5c 6e3c 2f6c 6576 656c  evel3>\\n</level
-00030680: 323e 2729 5d0a 0a20 2020 2057 6865 6e20  2>')]..    When 
-00030690: 6d75 6c74 6970 6c65 2074 6167 7320 6578  multiple tags ex
-000306a0: 6973 7420 6174 2061 206c 6576 656c 2c20  ist at a level, 
-000306b0: 696e 7374 616e 6365 5f6e 756d 2063 616e  instance_num can
-000306c0: 2062 6520 7573 6564 2074 6f20 6469 7374   be used to dist
-000306d0: 696e 6775 6973 6820 7768 6963 6820 656c  inguish which el
-000306e0: 656d 656e 7420 746f 2072 6574 7572 6e2e  ement to return.
-000306f0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-00030700: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00030710: 7365 6c65 6374 2878 6d6c 6765 7428 786d  select(xmlget(xm
-00030720: 6c67 6574 2822 6f62 6a22 2c20 6c69 7428  lget("obj", lit(
-00030730: 226c 6576 656c 3222 2929 2c20 6c69 7428  "level2")), lit(
-00030740: 226c 6576 656c 3322 292c 206c 6974 2830  "level3"), lit(0
-00030750: 2929 2e61 735f 2822 616e 7322 2929 2e63  )).as_("ans")).c
-00030760: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00030770: 205b 526f 7728 414e 533d 273c 6c65 7665   [Row(ANS='<leve
-00030780: 6c33 3e33 613c 2f6c 6576 656c 333e 2729  l3>3a</level3>')
-00030790: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-000307a0: 2e73 656c 6563 7428 786d 6c67 6574 2878  .select(xmlget(x
-000307b0: 6d6c 6765 7428 226f 626a 222c 206c 6974  mlget("obj", lit
-000307c0: 2822 6c65 7665 6c32 2229 292c 206c 6974  ("level2")), lit
-000307d0: 2822 6c65 7665 6c33 2229 2c20 6c69 7428  ("level3"), lit(
-000307e0: 3129 292e 6173 5f28 2261 6e73 2229 292e  1)).as_("ans")).
-000307f0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00030800: 2020 5b52 6f77 2841 4e53 3d27 3c6c 6576    [Row(ANS='<lev
-00030810: 656c 333e 3362 3c2f 6c65 7665 6c33 3e27  el3>3b</level3>'
-00030820: 295d 0a20 2020 2020 2020 203e 3e3e 2064  )].        >>> d
-00030830: 662e 7365 6c65 6374 2878 6d6c 6765 7428  f.select(xmlget(
-00030840: 226f 626a 222c 206c 6974 2822 6c65 7665  "obj", lit("leve
-00030850: 6c32 2229 2c20 6c69 7428 3529 292e 6173  l2"), lit(5)).as
-00030860: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
-00030870: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00030880: 2841 4e53 3d4e 6f6e 6529 5d0a 0a20 2020  (ANS=None)]..   
-00030890: 2049 6e20 6f72 6465 7220 746f 2067 6574   In order to get
-000308a0: 2074 6865 2074 6167 6e61 6d65 2c20 7468   the tagname, th
-000308b0: 6520 7661 6c75 6520 6f66 2061 6e20 6174  e value of an at
-000308c0: 7472 6962 7574 6520 6f72 2074 6865 2063  tribute or the c
-000308d0: 6f6e 7465 6e74 2077 6974 6869 6e20 6120  ontent within a 
-000308e0: 7461 6720 7468 6520 6067 6574 6020 6675  tag the `get` fu
-000308f0: 6e63 7469 6f6e 2063 616e 2062 6520 7573  nction can be us
-00030900: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
-00030910: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00030920: 6466 2e73 656c 6563 7428 6765 7428 786d  df.select(get(xm
-00030930: 6c67 6574 2822 6f62 6a22 2c20 6c69 7428  lget("obj", lit(
-00030940: 226c 6576 656c 3222 2929 2c20 6c69 7428  "level2")), lit(
-00030950: 2240 2229 292e 6173 5f28 2261 6e73 2229  "@")).as_("ans")
-00030960: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00030970: 2020 2020 5b52 6f77 2841 4e53 3d27 226c      [Row(ANS='"l
-00030980: 6576 656c 3222 2729 5d0a 2020 2020 2020  evel2"')].      
-00030990: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000309a0: 6765 7428 786d 6c67 6574 2822 6f62 6a22  get(xmlget("obj"
-000309b0: 2c20 6c69 7428 226c 6576 656c 3222 2929  , lit("level2"))
-000309c0: 2c20 6c69 7428 2224 2229 292e 6173 5f28  , lit("$")).as_(
-000309d0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
-000309e0: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
-000309f0: 4e53 3d27 5b5c 5c6e 2020 322c 5c5c 6e20  NS='[\\n  2,\\n 
-00030a00: 207b 5c5c 6e20 2020 2022 2422 3a20 2233   {\\n    "$": "3
-00030a10: 6122 2c5c 5c6e 2020 2020 2240 223a 2022  a",\\n    "@": "
-00030a20: 6c65 7665 6c33 225c 5c6e 2020 7d2c 5c5c  level3"\\n  },\\
-00030a30: 6e20 207b 5c5c 6e20 2020 2022 2422 3a20  n  {\\n    "$": 
-00030a40: 2233 6222 2c5c 5c6e 2020 2020 2240 223a  "3b",\\n    "@":
-00030a50: 2022 6c65 7665 6c33 225c 5c6e 2020 7d5c   "level3"\\n  }\
-00030a60: 5c6e 5d27 295d 0a20 2020 2020 2020 203e  \n]')].        >
-00030a70: 3e3e 2064 662e 7365 6c65 6374 2867 6574  >> df.select(get
-00030a80: 2878 6d6c 6765 7428 786d 6c67 6574 2822  (xmlget(xmlget("
-00030a90: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
-00030aa0: 3222 2929 2c20 6c69 7428 226c 6576 656c  2")), lit("level
-00030ab0: 3322 2929 2c20 6c69 7428 2224 2229 292e  3")), lit("$")).
-00030ac0: 6173 5f28 2261 6e73 2229 292e 636f 6c6c  as_("ans")).coll
-00030ad0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00030ae0: 6f77 2841 4e53 3d27 2233 6122 2729 5d0a  ow(ANS='"3a"')].
-00030af0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-00030b00: 656c 6563 7428 6765 7428 786d 6c67 6574  elect(get(xmlget
-00030b10: 2822 6f62 6a22 2c20 6c69 7428 226c 6576  ("obj", lit("lev
-00030b20: 656c 3222 2929 2c20 6c69 7428 2240 6174  el2")), lit("@at
-00030b30: 7472 3222 2929 2e61 735f 2822 616e 7322  tr2")).as_("ans"
-00030b40: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-00030b50: 2020 2020 205b 526f 7728 414e 533d 2722       [Row(ANS='"
-00030b60: 6222 2729 5d0a 2020 2020 2222 220a 2020  b"')].    """.  
-00030b70: 2020 6331 203d 205f 746f 5f63 6f6c 5f69    c1 = _to_col_i
-00030b80: 665f 7374 7228 786d 6c2c 2022 786d 6c67  f_str(xml, "xmlg
-00030b90: 6574 2229 0a20 2020 2063 3220 3d20 5f74  et").    c2 = _t
-00030ba0: 6f5f 636f 6c5f 6966 5f73 7472 2874 6167  o_col_if_str(tag
-00030bb0: 2c20 2278 6d6c 6765 7422 290a 2020 2020  , "xmlget").    
-00030bc0: 6333 203d 2028 0a20 2020 2020 2020 2069  c3 = (.        i
-00030bd0: 6e73 7461 6e63 655f 6e75 6d0a 2020 2020  nstance_num.    
-00030be0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00030bf0: 6528 696e 7374 616e 6365 5f6e 756d 2c20  e(instance_num, 
-00030c00: 696e 7429 0a20 2020 2020 2020 2065 6c73  int).        els
-00030c10: 6520 5f74 6f5f 636f 6c5f 6966 5f73 7472  e _to_col_if_str
-00030c20: 2869 6e73 7461 6e63 655f 6e75 6d2c 2022  (instance_num, "
-00030c30: 786d 6c67 6574 2229 0a20 2020 2029 0a20  xmlget").    ). 
-00030c40: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00030c50: 6e28 2278 6d6c 6765 7422 2928 6331 2c20  n("xmlget")(c1, 
-00030c60: 6332 2c20 6333 290a 0a0a 6465 6620 6765  c2, c3)...def ge
-00030c70: 745f 7061 7468 2863 6f6c 3a20 436f 6c75  t_path(col: Colu
-00030c80: 6d6e 4f72 4e61 6d65 2c20 7061 7468 3a20  mnOrName, path: 
-00030c90: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
-00030ca0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00030cb0: 0a20 2020 2045 7874 7261 6374 7320 6120  .    Extracts a 
-00030cc0: 7661 6c75 6520 6672 6f6d 2073 656d 692d  value from semi-
-00030cd0: 7374 7275 6374 7572 6564 2064 6174 6120  structured data 
-00030ce0: 7573 696e 6720 6120 7061 7468 206e 616d  using a path nam
-00030cf0: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
-00030d00: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00030d10: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00030d20: 6174 655f 6461 7461 6672 616d 6528 5b7b  ate_dataframe([{
-00030d30: 2261 223a 207b 2261 6122 3a20 7b22 6464  "a": {"aa": {"dd
-00030d40: 223a 2034 7d2c 2022 6262 223a 2032 2c20  ": 4}, "bb": 2, 
-00030d50: 2263 6322 3a20 337d 7d5d 290a 2020 2020  "cc": 3}}]).    
-00030d60: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
-00030d70: 7428 6765 745f 7061 7468 2864 665b 2261  t(get_path(df["a
-00030d80: 225d 2c20 6c69 7428 2261 612e 6464 2229  "], lit("aa.dd")
-00030d90: 292e 616c 6961 7328 2267 6574 5f70 6174  ).alias("get_pat
-00030da0: 6822 2929 2e63 6f6c 6c65 6374 2829 0a20  h")).collect(). 
-00030db0: 2020 2020 2020 205b 526f 7728 4745 545f         [Row(GET_
-00030dc0: 5041 5448 3d27 3427 295d 0a20 2020 2022  PATH='4')].    "
-00030dd0: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
-00030de0: 636f 6c5f 6966 5f73 7472 2863 6f6c 2c20  col_if_str(col, 
-00030df0: 2267 6574 5f70 6174 6822 290a 2020 2020  "get_path").    
-00030e00: 6332 203d 205f 746f 5f63 6f6c 5f69 665f  c2 = _to_col_if_
-00030e10: 7374 7228 7061 7468 2c20 2267 6574 5f70  str(path, "get_p
-00030e20: 6174 6822 290a 2020 2020 7265 7475 726e  ath").    return
-00030e30: 2062 7569 6c74 696e 2822 6765 745f 7061   builtin("get_pa
-00030e40: 7468 2229 2863 312c 2063 3229 0a0a 0a64  th")(c1, c2)...d
-00030e50: 6566 2067 6574 2863 6f6c 313a 2055 6e69  ef get(col1: Uni
-00030e60: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-00030e70: 2069 6e74 5d2c 2063 6f6c 323a 2055 6e69   int], col2: Uni
-00030e80: 6f6e 5b43 6f6c 756d 6e4f 724e 616d 652c  on[ColumnOrName,
-00030e90: 2069 6e74 5d29 202d 3e20 436f 6c75 6d6e   int]) -> Column
-00030ea0: 3a0a 2020 2020 2222 2245 7874 7261 6374  :.    """Extract
-00030eb0: 7320 6120 7661 6c75 6520 6672 6f6d 2061  s a value from a
-00030ec0: 6e20 6f62 6a65 6374 206f 7220 6172 7261  n object or arra
-00030ed0: 793b 2072 6574 7572 6e73 204e 554c 4c20  y; returns NULL 
-00030ee0: 6966 2065 6974 6865 7220 6f66 2074 6865  if either of the
-00030ef0: 2061 7267 756d 656e 7473 2069 7320 4e55   arguments is NU
-00030f00: 4c4c 2e0a 0a20 2020 2045 7861 6d70 6c65  LL...    Example
-00030f10: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-00030f20: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00030f30: 6174 6544 6174 6146 7261 6d65 285b 285b  ateDataFrame([([
-00030f40: 312c 2032 2c20 335d 2c29 2c20 285b 5d2c  1, 2, 3],), ([],
-00030f50: 295d 2c20 5b22 6461 7461 225d 290a 2020  )], ["data"]).  
-00030f60: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00030f70: 6563 7428 6765 7428 6466 2e64 6174 612c  ect(get(df.data,
-00030f80: 2031 292e 6173 5f28 2269 6478 3122 2929   1).as_("idx1"))
-00030f90: 2e73 6f72 7428 636f 6c28 2269 6478 3122  .sort(col("idx1"
-00030fa0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00030fb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00030fc0: 2020 2020 207c 2249 4458 3122 2020 7c0a       |"IDX1"  |.
-00030fd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00030fe0: 2d2d 0a20 2020 2020 2020 207c 4e55 4c4c  --.        |NULL
-00030ff0: 2020 2020 7c0a 2020 2020 2020 2020 7c32      |.        |2
-00031000: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00031010: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00031020: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00031030: 2020 2020 2222 220a 2020 2020 6331 203d      """.    c1 =
-00031040: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
-00031050: 6f72 5f69 6e74 2863 6f6c 312c 2022 6765  or_int(col1, "ge
-00031060: 7422 290a 2020 2020 6332 203d 205f 746f  t").    c2 = _to
-00031070: 5f63 6f6c 5f69 665f 7374 725f 6f72 5f69  _col_if_str_or_i
-00031080: 6e74 2863 6f6c 322c 2022 6765 7422 290a  nt(col2, "get").
-00031090: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-000310a0: 696e 2822 6765 7422 2928 6331 2c20 6332  in("get")(c1, c2
-000310b0: 290a 0a0a 6465 6620 7768 656e 2863 6f6e  )...def when(con
-000310c0: 6469 7469 6f6e 3a20 436f 6c75 6d6e 4f72  dition: ColumnOr
-000310d0: 5371 6c45 7870 722c 2076 616c 7565 3a20  SqlExpr, value: 
-000310e0: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c29  ColumnOrLiteral)
-000310f0: 202d 3e20 4361 7365 4578 7072 3a0a 2020   -> CaseExpr:.  
-00031100: 2020 2222 2257 6f72 6b73 206c 696b 6520    """Works like 
-00031110: 6120 6361 7363 6164 696e 6720 6966 2d74  a cascading if-t
-00031120: 6865 6e2d 656c 7365 2073 7461 7465 6d65  hen-else stateme
-00031130: 6e74 2e0a 2020 2020 4120 7365 7269 6573  nt..    A series
-00031140: 206f 6620 636f 6e64 6974 696f 6e73 2061   of conditions a
-00031150: 7265 2065 7661 6c75 6174 6564 2069 6e20  re evaluated in 
-00031160: 7365 7175 656e 6365 2e0a 2020 2020 5768  sequence..    Wh
-00031170: 656e 2061 2063 6f6e 6469 7469 6f6e 2065  en a condition e
-00031180: 7661 6c75 6174 6573 2074 6f20 5452 5545  valuates to TRUE
-00031190: 2c20 7468 6520 6576 616c 7561 7469 6f6e  , the evaluation
-000311a0: 2073 746f 7073 2061 6e64 2074 6865 2061   stops and the a
-000311b0: 7373 6f63 6961 7465 640a 2020 2020 7265  ssociated.    re
-000311c0: 7375 6c74 2028 6166 7465 7220 5448 454e  sult (after THEN
-000311d0: 2920 6973 2072 6574 7572 6e65 642e 2049  ) is returned. I
-000311e0: 6620 6e6f 6e65 206f 6620 7468 6520 636f  f none of the co
-000311f0: 6e64 6974 696f 6e73 2065 7661 6c75 6174  nditions evaluat
-00031200: 6520 746f 2054 5255 452c 0a20 2020 2074  e to TRUE,.    t
-00031210: 6865 6e20 7468 6520 7265 7375 6c74 2061  hen the result a
-00031220: 6674 6572 2074 6865 206f 7074 696f 6e61  fter the optiona
-00031230: 6c20 4f54 4845 5257 4953 4520 6973 2072  l OTHERWISE is r
-00031240: 6574 7572 6e65 642c 2069 6620 7072 6573  eturned, if pres
-00031250: 656e 743b 0a20 2020 206f 7468 6572 7769  ent;.    otherwi
-00031260: 7365 204e 554c 4c20 6973 2072 6574 7572  se NULL is retur
-00031270: 6e65 642e 0a0a 2020 2020 4172 6773 3a0a  ned...    Args:.
-00031280: 2020 2020 2020 2020 636f 6e64 6974 696f          conditio
-00031290: 6e3a 2041 203a 636c 6173 733a 6043 6f6c  n: A :class:`Col
-000312a0: 756d 6e60 2065 7870 7265 7373 696f 6e20  umn` expression 
-000312b0: 6f72 2053 514c 2074 6578 7420 7265 7072  or SQL text repr
-000312c0: 6573 656e 7469 6e67 2074 6865 2073 7065  esenting the spe
-000312d0: 6369 6669 6564 2063 6f6e 6469 7469 6f6e  cified condition
-000312e0: 2e0a 2020 2020 2020 2020 7661 6c75 653a  ..        value:
-000312f0: 2041 203a 636c 6173 733a 6043 6f6c 756d   A :class:`Colum
-00031300: 6e60 2065 7870 7265 7373 696f 6e20 6f72  n` expression or
-00031310: 2061 206c 6974 6572 616c 2076 616c 7565   a literal value
-00031320: 2c20 7768 6963 6820 7769 6c6c 2062 6520  , which will be 
-00031330: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00031340: 2020 2020 2069 6620 6060 636f 6e64 6974       if ``condit
-00031350: 696f 6e60 6020 6973 2074 7275 652e 0a0a  ion`` is true...
-00031360: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00031370: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00031380: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
-00031390: 6174 6166 7261 6d65 285b 312c 204e 6f6e  ataframe([1, Non
-000313a0: 652c 2032 2c20 332c 204e 6f6e 652c 2035  e, 2, 3, None, 5
-000313b0: 2c20 365d 2c20 7363 6865 6d61 3d5b 2261  , 6], schema=["a
-000313c0: 225d 290a 2020 2020 2020 2020 3e3e 3e20  "]).        >>> 
-000313d0: 6466 2e63 6f6c 6c65 6374 2829 0a20 2020  df.collect().   
-000313e0: 2020 2020 205b 526f 7728 413d 3129 2c20       [Row(A=1), 
-000313f0: 526f 7728 413d 4e6f 6e65 292c 2052 6f77  Row(A=None), Row
-00031400: 2841 3d32 292c 2052 6f77 2841 3d33 292c  (A=2), Row(A=3),
-00031410: 2052 6f77 2841 3d4e 6f6e 6529 2c20 526f   Row(A=None), Ro
-00031420: 7728 413d 3529 2c20 526f 7728 413d 3629  w(A=5), Row(A=6)
-00031430: 5d0a 2020 2020 2020 2020 3e3e 3e20 6466  ].        >>> df
-00031440: 2e73 656c 6563 7428 7768 656e 2863 6f6c  .select(when(col
-00031450: 2822 6122 2920 2520 3220 3d3d 2030 2c20  ("a") % 2 == 0, 
-00031460: 6c69 7428 2265 7665 6e22 2929 2e61 735f  lit("even")).as_
-00031470: 2822 616e 7322 2929 2e63 6f6c 6c65 6374  ("ans")).collect
-00031480: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-00031490: 414e 533d 4e6f 6e65 292c 2052 6f77 2841  ANS=None), Row(A
-000314a0: 4e53 3d4e 6f6e 6529 2c20 526f 7728 414e  NS=None), Row(AN
-000314b0: 533d 2765 7665 6e27 292c 2052 6f77 2841  S='even'), Row(A
-000314c0: 4e53 3d4e 6f6e 6529 2c20 526f 7728 414e  NS=None), Row(AN
-000314d0: 533d 4e6f 6e65 292c 2052 6f77 2841 4e53  S=None), Row(ANS
-000314e0: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
-000314f0: 2765 7665 6e27 295d 0a0a 2020 2020 4d75  'even')]..    Mu
-00031500: 6c74 6970 6c65 2077 6865 6e20 7374 6174  ltiple when stat
-00031510: 656d 656e 7473 2063 616e 2062 6520 6368  ements can be ch
-00031520: 616e 6765 6420 616e 6420 606f 7468 6572  anged and `other
-00031530: 7769 7365 602f 6065 6c73 655f 6020 7573  wise`/`else_` us
-00031540: 6564 2074 6f20 6372 6561 7465 2065 7870  ed to create exp
-00031550: 7265 7373 696f 6e73 2073 696d 696c 6172  ressions similar
-00031560: 2074 6f20 6060 4341 5345 2057 4845 4e20   to ``CASE WHEN 
-00031570: 2e2e 2e20 454c 5345 202e 2e2e 2045 4e44  ... ELSE ... END
-00031580: 6060 2069 6e20 5351 4c2e 0a0a 2020 2020  `` in SQL...    
-00031590: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000315a0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-000315b0: 2877 6865 6e28 636f 6c28 2261 2229 2025  (when(col("a") %
-000315c0: 2032 203d 3d20 302c 206c 6974 2822 6576   2 == 0, lit("ev
-000315d0: 656e 2229 292e 7768 656e 2863 6f6c 2822  en")).when(col("
-000315e0: 6122 2920 2520 3220 3d3d 2031 2c20 6c69  a") % 2 == 1, li
-000315f0: 7428 226f 6464 2229 292e 6173 5f28 2261  t("odd")).as_("a
-00031600: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
-00031610: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
-00031620: 3d27 6f64 6427 292c 2052 6f77 2841 4e53  ='odd'), Row(ANS
-00031630: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
-00031640: 2765 7665 6e27 292c 2052 6f77 2841 4e53  'even'), Row(ANS
-00031650: 3d27 6f64 6427 292c 2052 6f77 2841 4e53  ='odd'), Row(ANS
-00031660: 3d4e 6f6e 6529 2c20 526f 7728 414e 533d  =None), Row(ANS=
-00031670: 276f 6464 2729 2c20 526f 7728 414e 533d  'odd'), Row(ANS=
-00031680: 2765 7665 6e27 295d 0a20 2020 2020 2020  'even')].       
-00031690: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
-000316a0: 6865 6e28 636f 6c28 2261 2229 2025 2032  hen(col("a") % 2
-000316b0: 203d 3d20 302c 206c 6974 2822 6576 656e   == 0, lit("even
-000316c0: 2229 292e 7768 656e 2863 6f6c 2822 6122  ")).when(col("a"
-000316d0: 2920 2520 3220 3d3d 2031 2c20 6c69 7428  ) % 2 == 1, lit(
-000316e0: 226f 6464 2229 292e 6f74 6865 7277 6973  "odd")).otherwis
-000316f0: 6528 6c69 7428 2275 6e6b 6e6f 776e 2229  e(lit("unknown")
-00031700: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
-00031710: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00031720: 5b52 6f77 2841 4e53 3d27 6f64 6427 292c  [Row(ANS='odd'),
-00031730: 2052 6f77 2841 4e53 3d27 756e 6b6e 6f77   Row(ANS='unknow
-00031740: 6e27 292c 2052 6f77 2841 4e53 3d27 6576  n'), Row(ANS='ev
-00031750: 656e 2729 2c20 526f 7728 414e 533d 276f  en'), Row(ANS='o
-00031760: 6464 2729 2c20 526f 7728 414e 533d 2775  dd'), Row(ANS='u
-00031770: 6e6b 6e6f 776e 2729 2c20 526f 7728 414e  nknown'), Row(AN
-00031780: 533d 276f 6464 2729 2c20 526f 7728 414e  S='odd'), Row(AN
-00031790: 533d 2765 7665 6e27 295d 0a20 2020 2022  S='even')].    "
-000317a0: 2222 0a20 2020 2072 6574 7572 6e20 4361  "".    return Ca
-000317b0: 7365 4578 7072 280a 2020 2020 2020 2020  seExpr(.        
-000317c0: 4361 7365 5768 656e 280a 2020 2020 2020  CaseWhen(.      
-000317d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-000317e0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-000317f0: 2020 2020 2020 2020 2020 2020 2020 5f74                _t
-00031800: 6f5f 636f 6c5f 6966 5f73 716c 5f65 7870  o_col_if_sql_exp
-00031810: 7228 636f 6e64 6974 696f 6e2c 2022 7768  r(condition, "wh
-00031820: 656e 2229 2e5f 6578 7072 6573 7369 6f6e  en")._expression
-00031830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00031840: 2020 2020 2020 436f 6c75 6d6e 2e5f 746f        Column._to
-00031850: 5f65 7870 7228 7661 6c75 6529 2c0a 2020  _expr(value),.  
-00031860: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00031870: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00031880: 2020 2020 2020 290a 2020 2020 290a 0a0a        ).    )...
-00031890: 6465 6620 6966 6628 0a20 2020 2063 6f6e  def iff(.    con
-000318a0: 6469 7469 6f6e 3a20 436f 6c75 6d6e 4f72  dition: ColumnOr
-000318b0: 5371 6c45 7870 722c 0a20 2020 2065 7870  SqlExpr,.    exp
-000318c0: 7231 3a20 436f 6c75 6d6e 4f72 4c69 7465  r1: ColumnOrLite
-000318d0: 7261 6c2c 0a20 2020 2065 7870 7232 3a20  ral,.    expr2: 
-000318e0: 436f 6c75 6d6e 4f72 4c69 7465 7261 6c2c  ColumnOrLiteral,
-000318f0: 0a29 202d 3e20 436f 6c75 6d6e 3a0a 2020  .) -> Column:.  
-00031900: 2020 2222 220a 2020 2020 5265 7475 726e    """.    Return
-00031910: 7320 6f6e 6520 6f66 2074 776f 2073 7065  s one of two spe
-00031920: 6369 6669 6564 2065 7870 7265 7373 696f  cified expressio
-00031930: 6e73 2c20 6465 7065 6e64 696e 6720 6f6e  ns, depending on
-00031940: 2061 2063 6f6e 6469 7469 6f6e 2e0a 2020   a condition..  
-00031950: 2020 5468 6973 2069 7320 6571 7569 7661    This is equiva
-00031960: 6c65 6e74 2074 6f20 616e 2060 6069 662d  lent to an ``if-
-00031970: 7468 656e 2d65 6c73 6560 6020 6578 7072  then-else`` expr
-00031980: 6573 7369 6f6e 2e0a 0a20 2020 2041 7267  ession...    Arg
-00031990: 733a 0a20 2020 2020 2020 2063 6f6e 6469  s:.        condi
-000319a0: 7469 6f6e 3a20 4120 3a63 6c61 7373 3a60  tion: A :class:`
-000319b0: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
-000319c0: 6f6e 206f 7220 5351 4c20 7465 7874 2072  on or SQL text r
-000319d0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-000319e0: 7370 6563 6966 6965 6420 636f 6e64 6974  specified condit
-000319f0: 696f 6e2e 0a20 2020 2020 2020 2065 7870  ion..        exp
-00031a00: 7231 3a20 4120 3a63 6c61 7373 3a60 436f  r1: A :class:`Co
-00031a10: 6c75 6d6e 6020 6578 7072 6573 7369 6f6e  lumn` expression
-00031a20: 206f 7220 6120 6c69 7465 7261 6c20 7661   or a literal va
-00031a30: 6c75 652c 2077 6869 6368 2077 696c 6c20  lue, which will 
-00031a40: 6265 2072 6574 7572 6e65 640a 2020 2020  be returned.    
-00031a50: 2020 2020 2020 2020 6966 2060 6063 6f6e          if ``con
-00031a60: 6469 7469 6f6e 6060 2069 7320 7472 7565  dition`` is true
-00031a70: 2e0a 2020 2020 2020 2020 6578 7072 323a  ..        expr2:
-00031a80: 2041 203a 636c 6173 733a 6043 6f6c 756d   A :class:`Colum
-00031a90: 6e60 2065 7870 7265 7373 696f 6e20 6f72  n` expression or
-00031aa0: 2061 206c 6974 6572 616c 2076 616c 7565   a literal value
-00031ab0: 2c20 7768 6963 6820 7769 6c6c 2062 6520  , which will be 
-00031ac0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00031ad0: 2020 2020 2069 6620 6060 636f 6e64 6974       if ``condit
-00031ae0: 696f 6e60 6020 6973 2066 616c 7365 2e0a  ion`` is false..
-00031af0: 0a20 2020 2045 7861 6d70 6c65 733a 3a0a  .    Examples::.
-00031b00: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00031b10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00031b20: 5f64 6174 6166 7261 6d65 285b 5472 7565  _dataframe([True
-00031b30: 2c20 4661 6c73 652c 204e 6f6e 655d 2c20  , False, None], 
-00031b40: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
-00031b50: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00031b60: 6563 7428 6966 6628 6466 5b22 6122 5d2c  ect(iff(df["a"],
-00031b70: 206c 6974 2822 7472 7565 2229 2c20 6c69   lit("true"), li
-00031b80: 7428 2266 616c 7365 2229 292e 616c 6961  t("false")).alia
-00031b90: 7328 2269 6666 2229 292e 636f 6c6c 6563  s("iff")).collec
-00031ba0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00031bb0: 2849 4646 3d27 7472 7565 2729 2c20 526f  (IFF='true'), Ro
-00031bc0: 7728 4946 463d 2766 616c 7365 2729 2c20  w(IFF='false'), 
-00031bd0: 526f 7728 4946 463d 2766 616c 7365 2729  Row(IFF='false')
-00031be0: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
-00031bf0: 7475 726e 2062 7569 6c74 696e 2822 6966  turn builtin("if
-00031c00: 6622 2928 5f74 6f5f 636f 6c5f 6966 5f73  f")(_to_col_if_s
-00031c10: 716c 5f65 7870 7228 636f 6e64 6974 696f  ql_expr(conditio
-00031c20: 6e2c 2022 6966 6622 292c 2065 7870 7231  n, "iff"), expr1
-00031c30: 2c20 6578 7072 3229 0a0a 0a64 6566 2069  , expr2)...def i
-00031c40: 6e5f 280a 2020 2020 636f 6c73 3a20 4c69  n_(.    cols: Li
-00031c50: 7374 5b43 6f6c 756d 6e4f 724e 616d 655d  st[ColumnOrName]
-00031c60: 2c0a 2020 2020 2a76 616c 733a 2055 6e69  ,.    *vals: Uni
-00031c70: 6f6e 5b22 736e 6f77 666c 616b 652e 736e  on["snowflake.sn
-00031c80: 6f77 7061 726b 2e44 6174 6146 7261 6d65  owpark.DataFrame
-00031c90: 222c 204c 6974 6572 616c 5479 7065 2c20  ", LiteralType, 
-00031ca0: 4974 6572 6162 6c65 5b4c 6974 6572 616c  Iterable[Literal
-00031cb0: 5479 7065 5d5d 2c0a 2920 2d3e 2043 6f6c  Type]],.) -> Col
-00031cc0: 756d 6e3a 0a20 2020 2022 2222 5265 7475  umn:.    """Retu
-00031cd0: 726e 7320 6120 636f 6e64 6974 696f 6e61  rns a conditiona
-00031ce0: 6c20 6578 7072 6573 7369 6f6e 2074 6861  l expression tha
-00031cf0: 7420 796f 7520 6361 6e20 7061 7373 2074  t you can pass t
-00031d00: 6f20 7468 6520 6669 6c74 6572 206f 7220  o the filter or 
-00031d10: 7768 6572 6520 6d65 7468 6f64 7320 746f  where methods to
-00031d20: 0a20 2020 2070 6572 666f 726d 2074 6865  .    perform the
-00031d30: 2065 7175 6976 616c 656e 7420 6f66 2061   equivalent of a
-00031d40: 2057 4845 5245 202e 2e2e 2049 4e20 7175   WHERE ... IN qu
-00031d50: 6572 7920 7468 6174 206d 6174 6368 6573  ery that matches
-00031d60: 2072 6f77 7320 636f 6e74 6169 6e69 6e67   rows containing
-00031d70: 2061 2073 6571 7565 6e63 6520 6f66 0a20   a sequence of. 
-00031d80: 2020 2076 616c 7565 732e 0a0a 2020 2020     values...    
-00031d90: 5468 6520 6578 7072 6573 7369 6f6e 2065  The expression e
-00031da0: 7661 6c75 6174 6573 2074 6f20 7472 7565  valuates to true
-00031db0: 2069 6620 7468 6520 7661 6c75 6573 2069   if the values i
-00031dc0: 6e20 6120 726f 7720 6d61 7463 6865 7320  n a row matches 
-00031dd0: 7468 6520 7661 6c75 6573 2069 6e20 6f6e  the values in on
-00031de0: 6520 6f66 0a20 2020 2074 6865 2073 7065  e of.    the spe
-00031df0: 6369 6669 6564 2073 6571 7565 6e63 6573  cified sequences
-00031e00: 2e0a 0a20 2020 2054 6865 2066 6f6c 6c6f  ...    The follo
-00031e10: 7769 6e67 2063 6f64 6520 7265 7475 726e  wing code return
-00031e20: 7320 6120 4461 7461 4672 616d 6520 7468  s a DataFrame th
-00031e30: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
-00031e40: 726f 7773 2069 6e20 7768 6963 680a 2020  rows in which.  
-00031e50: 2020 7468 6520 636f 6c75 6d6e 7320 6063    the columns `c
-00031e60: 3160 2061 6e64 2060 6332 6020 636f 6e74  1` and `c2` cont
-00031e70: 6169 6e20 7468 6520 7661 6c75 6573 3a0a  ain the values:.
-00031e80: 2020 2020 2d20 6031 6020 616e 6420 6022      - `1` and `"
-00031e90: 6122 602c 206f 720a 2020 2020 2d20 6032  a"`, or.    - `2
-00031ea0: 6020 616e 6420 6022 6222 600a 2020 2020  ` and `"b"`.    
-00031eb0: 5468 6973 2069 7320 6571 7569 7661 6c65  This is equivale
-00031ec0: 6e74 2074 6f20 6060 5345 4c45 4354 202a  nt to ``SELECT *
-00031ed0: 2046 524f 4d20 7461 626c 6520 5748 4552   FROM table WHER
-00031ee0: 4520 2863 312c 2063 3229 2049 4e20 2828  E (c1, c2) IN ((
-00031ef0: 312c 2027 6127 292c 2028 322c 2027 6227  1, 'a'), (2, 'b'
-00031f00: 2929 6060 2e0a 0a20 2020 2045 7861 6d70  ))``...    Examp
-00031f10: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
-00031f20: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-00031f30: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00031f40: 5b5b 312c 2022 6122 5d2c 205b 322c 2022  [[1, "a"], [2, "
-00031f50: 6222 5d2c 205b 332c 2022 6322 5d5d 2c20  b"], [3, "c"]], 
-00031f60: 7363 6865 6d61 3d5b 2263 6f6c 3122 2c20  schema=["col1", 
-00031f70: 2263 6f6c 3222 5d29 0a20 2020 2020 2020  "col2"]).       
-00031f80: 203e 3e3e 2064 662e 6669 6c74 6572 2869   >>> df.filter(i
-00031f90: 6e5f 285b 636f 6c28 2263 6f6c 3122 292c  n_([col("col1"),
-00031fa0: 2063 6f6c 2822 636f 6c32 2229 5d2c 205b   col("col2")], [
-00031fb0: 5b31 2c20 2261 225d 2c20 5b32 2c20 2262  [1, "a"], [2, "b
-00031fc0: 225d 5d29 292e 7368 6f77 2829 0a20 2020  "]])).show().   
-00031fd0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-00031fe0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00031ff0: 207c 2243 4f4c 3122 2020 7c22 434f 4c32   |"COL1"  |"COL2
-00032000: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-00032010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00032020: 0a20 2020 2020 2020 207c 3120 2020 2020  .        |1     
-00032030: 2020 7c61 2020 2020 2020 207c 0a20 2020    |a       |.   
-00032040: 2020 2020 207c 3220 2020 2020 2020 7c62       |2       |b
-00032050: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00032060: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00032070: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-00032080: 414e 4b4c 494e 453e 0a0a 2020 2020 5468  ANKLINE>..    Th
-00032090: 6520 666f 6c6c 6f77 696e 6720 636f 6465  e following code
-000320a0: 2072 6574 7572 6e73 2061 2044 6174 6146   returns a DataF
-000320b0: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
-000320c0: 6e73 2074 6865 2072 6f77 7320 7768 6572  ns the rows wher
-000320d0: 650a 2020 2020 7468 6520 7661 6c75 6573  e.    the values
-000320e0: 206f 6620 7468 6520 636f 6c75 6d6e 7320   of the columns 
-000320f0: 6063 3160 2061 6e64 2060 6332 6020 696e  `c1` and `c2` in
-00032100: 2060 6466 3260 206d 6174 6368 2074 6865   `df2` match the
-00032110: 2076 616c 7565 7320 6f66 2074 6865 2063   values of the c
-00032120: 6f6c 756d 6e73 0a20 2020 2060 6160 2061  olumns.    `a` a
-00032130: 6e64 2060 6260 2069 6e20 6064 6631 602e  nd `b` in `df1`.
-00032140: 2054 6869 7320 6973 2065 7175 6976 616c   This is equival
-00032150: 656e 7420 746f 0a20 2020 2060 6053 454c  ent to.    ``SEL
-00032160: 4543 5420 2a20 4652 4f4d 2074 6162 6c65  ECT * FROM table
-00032170: 3220 5748 4552 4520 2863 312c 2063 3229  2 WHERE (c1, c2)
-00032180: 2049 4e20 2853 454c 4543 5420 612c 2062   IN (SELECT a, b
-00032190: 2046 524f 4d20 7461 626c 6531 2960 602e   FROM table1)``.
-000321a0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
-000321b0: 0a20 2020 2020 2020 203e 3e3e 2064 6631  .        >>> df1
-000321c0: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
-000321d0: 7365 6c65 6374 2031 2c20 2761 2722 290a  select 1, 'a'").
-000321e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e66          >>> df.f
-000321f0: 696c 7465 7228 696e 5f28 5b63 6f6c 2822  ilter(in_([col("
-00032200: 636f 6c31 2229 2c20 636f 6c28 2263 6f6c  col1"), col("col
-00032210: 3222 295d 2c20 6466 3129 292e 7368 6f77  2")], df1)).show
-00032220: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-00032230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-00032240: 2020 2020 2020 207c 2243 4f4c 3122 2020         |"COL1"  
-00032250: 7c22 434f 4c32 2220 207c 0a20 2020 2020  |"COL2"  |.     
-00032260: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
-00032270: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00032280: 3120 2020 2020 2020 7c61 2020 2020 2020  1       |a      
-00032290: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-000322a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
-000322b0: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
-000322c0: 453e 0a0a 2020 2020 4172 6773 3a3a 0a20  E>..    Args::. 
-000322d0: 2020 2020 2020 2063 6f6c 733a 2041 206c         cols: A l
-000322e0: 6973 7420 6f66 2074 6865 2063 6f6c 756d  ist of the colum
-000322f0: 6e73 2074 6f20 636f 6d70 6172 6520 666f  ns to compare fo
-00032300: 7220 7468 6520 494e 206f 7065 7261 7469  r the IN operati
-00032310: 6f6e 2e0a 2020 2020 2020 2020 7661 6c73  on..        vals
-00032320: 3a20 4120 6c69 7374 2063 6f6e 7461 696e  : A list contain
-00032330: 696e 6720 7468 6520 7661 6c75 6573 2074  ing the values t
-00032340: 6f20 636f 6d70 6172 6520 666f 7220 7468  o compare for th
-00032350: 6520 494e 206f 7065 7261 7469 6f6e 2e0a  e IN operation..
-00032360: 2020 2020 2222 220a 2020 2020 7661 6c73      """.    vals
-00032370: 203d 2070 6172 7365 5f70 6f73 6974 696f   = parse_positio
-00032380: 6e61 6c5f 6172 6773 5f74 6f5f 6c69 7374  nal_args_to_list
-00032390: 282a 7661 6c73 290a 2020 2020 636f 6c75  (*vals).    colu
-000323a0: 6d6e 7320 3d20 5b5f 746f 5f63 6f6c 5f69  mns = [_to_col_i
-000323b0: 665f 7374 7228 632c 2022 696e 5f22 2920  f_str(c, "in_") 
-000323c0: 666f 7220 6320 696e 2063 6f6c 735d 0a20  for c in cols]. 
-000323d0: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
-000323e0: 284d 756c 7469 706c 6545 7870 7265 7373  (MultipleExpress
-000323f0: 696f 6e28 5b63 2e5f 6578 7072 6573 7369  ion([c._expressi
-00032400: 6f6e 2066 6f72 2063 2069 6e20 636f 6c75  on for c in colu
-00032410: 6d6e 735d 2929 2e69 6e5f 2876 616c 7329  mns])).in_(vals)
-00032420: 0a0a 0a64 6566 2063 756d 655f 6469 7374  ...def cume_dist
-00032430: 2829 202d 3e20 436f 6c75 6d6e 3a0a 2020  () -> Column:.  
-00032440: 2020 2222 220a 2020 2020 4669 6e64 7320    """.    Finds 
-00032450: 7468 6520 6375 6d75 6c61 7469 7665 2064  the cumulative d
-00032460: 6973 7472 6962 7574 696f 6e20 6f66 2061  istribution of a
-00032470: 2076 616c 7565 2077 6974 6820 7265 6761   value with rega
-00032480: 7264 2074 6f20 6f74 6865 7220 7661 6c75  rd to other valu
-00032490: 6573 0a20 2020 2077 6974 6869 6e20 7468  es.    within th
-000324a0: 6520 7361 6d65 2077 696e 646f 7720 7061  e same window pa
-000324b0: 7274 6974 696f 6e2e 0a0a 2020 2020 4578  rtition...    Ex
-000324c0: 616d 706c 653a 0a0a 2020 2020 2020 2020  ample:..        
-000324d0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-000324e0: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
-000324f0: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
-00032500: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00032510: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00032520: 7061 726b 2e74 7970 6573 2069 6d70 6f72  park.types impor
-00032530: 7420 4465 6369 6d61 6c54 7970 650a 2020  t DecimalType.  
-00032540: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00032550: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00032560: 7461 6672 616d 6528 5b5b 312c 2032 5d2c  taframe([[1, 2],
-00032570: 205b 312c 2032 5d2c 205b 312c 335d 2c20   [1, 2], [1,3], 
-00032580: 5b34 2c20 355d 2c20 5b32 2c20 335d 2c20  [4, 5], [2, 3], 
-00032590: 5b33 2c20 345d 2c20 5b34 2c20 375d 2c20  [3, 4], [4, 7], 
-000325a0: 5b33 2c37 5d2c 205b 342c 355d 5d2c 2073  [3,7], [4,5]], s
-000325b0: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
-000325c0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-000325d0: 2e73 656c 6563 7428 6375 6d65 5f64 6973  .select(cume_dis
-000325e0: 7428 292e 6f76 6572 2857 696e 646f 772e  t().over(Window.
-000325f0: 6f72 6465 725f 6279 2822 6122 2929 2e63  order_by("a")).c
-00032600: 6173 7428 4465 6369 6d61 6c54 7970 6528  ast(DecimalType(
-00032610: 7363 616c 653d 3329 292e 616c 6961 7328  scale=3)).alias(
-00032620: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
-00032630: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00032640: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-00032650: 2252 4553 554c 5422 2020 7c0a 2020 2020  "RESULT"  |.    
-00032660: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-00032670: 0a20 2020 2020 2020 207c 302e 3333 3320  .        |0.333 
-00032680: 2020 2020 7c0a 2020 2020 2020 2020 7c30      |.        |0
-00032690: 2e33 3333 2020 2020 207c 0a20 2020 2020  .333     |.     
-000326a0: 2020 207c 302e 3333 3320 2020 2020 7c0a     |0.333     |.
-000326b0: 2020 2020 2020 2020 7c30 2e34 3434 2020          |0.444  
-000326c0: 2020 207c 0a20 2020 2020 2020 207c 302e     |.        |0.
-000326d0: 3636 3720 2020 2020 7c0a 2020 2020 2020  667     |.      
-000326e0: 2020 7c30 2e36 3637 2020 2020 207c 0a20    |0.667     |. 
-000326f0: 2020 2020 2020 207c 312e 3030 3020 2020         |1.000   
-00032700: 2020 7c0a 2020 2020 2020 2020 7c31 2e30    |.        |1.0
-00032710: 3030 2020 2020 207c 0a20 2020 2020 2020  00     |.       
-00032720: 207c 312e 3030 3020 2020 2020 7c0a 2020   |1.000     |.  
-00032730: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00032740: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00032750: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00032760: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00032770: 6e28 2263 756d 655f 6469 7374 2229 2829  n("cume_dist")()
-00032780: 0a0a 0a64 6566 2072 616e 6b28 2920 2d3e  ...def rank() ->
-00032790: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-000327a0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
-000327b0: 2072 616e 6b20 6f66 2061 2076 616c 7565   rank of a value
-000327c0: 2077 6974 6869 6e20 616e 206f 7264 6572   within an order
-000327d0: 6564 2067 726f 7570 206f 6620 7661 6c75  ed group of valu
-000327e0: 6573 2e0a 2020 2020 5468 6520 7261 6e6b  es..    The rank
-000327f0: 2076 616c 7565 2073 7461 7274 7320 6174   value starts at
-00032800: 2031 2061 6e64 2063 6f6e 7469 6e75 6573   1 and continues
-00032810: 2075 702e 0a0a 2020 2020 4578 616d 706c   up...    Exampl
-00032820: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
-00032830: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-00032840: 6e6f 7770 6172 6b2e 7769 6e64 6f77 2069  nowpark.window i
-00032850: 6d70 6f72 7420 5769 6e64 6f77 0a20 2020  mport Window.   
-00032860: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
-00032870: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
-00032880: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
-00032890: 2e2e 2e20 2020 2020 5b0a 2020 2020 2020  ...     [.      
-000328a0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
-000328b0: 2c20 322c 2031 5d2c 0a20 2020 2020 2020  , 2, 1],.       
-000328c0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
-000328d0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
-000328e0: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
-000328f0: 312c 2031 305d 2c0a 2020 2020 2020 2020  1, 10],.        
-00032900: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
-00032910: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
-00032920: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
-00032930: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
-00032940: 2e20 2020 2020 5d2c 0a20 2020 2020 2020  .     ],.       
-00032950: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
-00032960: 5b22 7822 2c20 2279 222c 2022 7a22 5d0a  ["x", "y", "z"].
-00032970: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
-00032980: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
-00032990: 6563 7428 7261 6e6b 2829 2e6f 7665 7228  ect(rank().over(
-000329a0: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
-000329b0: 5f62 7928 636f 6c28 2258 2229 292e 6f72  _by(col("X")).or
-000329c0: 6465 725f 6279 2863 6f6c 2822 5922 2929  der_by(col("Y"))
-000329d0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-000329e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-000329f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00032a00: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00032a10: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00032a20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00032a30: 207c 3120 2020 2020 2020 2020 7c0a 2020   |1         |.  
-00032a40: 2020 2020 2020 7c32 2020 2020 2020 2020        |2        
-00032a50: 207c 0a20 2020 2020 2020 207c 3220 2020   |.        |2   
-00032a60: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00032a70: 7c31 2020 2020 2020 2020 207c 0a20 2020  |1         |.   
-00032a80: 2020 2020 207c 3120 2020 2020 2020 2020       |1         
-00032a90: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00032aa0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00032ab0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00032ac0: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00032ad0: 696c 7469 6e28 2272 616e 6b22 2928 290a  iltin("rank")().
-00032ae0: 0a0a 6465 6620 7065 7263 656e 745f 7261  ..def percent_ra
-00032af0: 6e6b 2829 202d 3e20 436f 6c75 6d6e 3a0a  nk() -> Column:.
-00032b00: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-00032b10: 726e 7320 7468 6520 7265 6c61 7469 7665  rns the relative
-00032b20: 2072 616e 6b20 6f66 2061 2076 616c 7565   rank of a value
-00032b30: 2077 6974 6869 6e20 6120 6772 6f75 7020   within a group 
-00032b40: 6f66 2076 616c 7565 732c 2073 7065 6369  of values, speci
-00032b50: 6669 6564 2061 7320 6120 7065 7263 656e  fied as a percen
-00032b60: 7461 6765 0a20 2020 2072 616e 6769 6e67  tage.    ranging
-00032b70: 2066 726f 6d20 302e 3020 746f 2031 2e30   from 0.0 to 1.0
-00032b80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00032b90: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00032ba0: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
-00032bb0: 7061 726b 2e77 696e 646f 7720 696d 706f  park.window impo
-00032bc0: 7274 2057 696e 646f 770a 2020 2020 2020  rt Window.      
-00032bd0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00032be0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00032bf0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
-00032c00: 2020 2020 205b 0a20 2020 2020 2020 202e       [.        .
-00032c10: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
-00032c20: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
-00032c30: 2e20 2020 2020 2020 2020 5b31 2c20 322c  .         [1, 2,
-00032c40: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
-00032c50: 2020 2020 2020 2020 205b 322c 2031 2c20           [2, 1, 
-00032c60: 3130 5d2c 0a20 2020 2020 2020 202e 2e2e  10],.        ...
-00032c70: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
-00032c80: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
-00032c90: 2020 2020 2020 2020 5b32 2c20 322c 2033          [2, 2, 3
-00032ca0: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-00032cb0: 2020 205d 2c0a 2020 2020 2020 2020 2e2e     ],.        ..
-00032cc0: 2e20 2020 2020 7363 6865 6d61 3d5b 2278  .     schema=["x
-00032cd0: 222c 2022 7922 2c20 227a 225d 0a20 2020  ", "y", "z"].   
-00032ce0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-00032cf0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00032d00: 2870 6572 6365 6e74 5f72 616e 6b28 292e  (percent_rank().
-00032d10: 6f76 6572 2857 696e 646f 772e 7061 7274  over(Window.part
-00032d20: 6974 696f 6e5f 6279 2822 7822 292e 6f72  ition_by("x").or
-00032d30: 6465 725f 6279 2863 6f6c 2822 7922 2929  der_by(col("y"))
-00032d40: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
-00032d50: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
-00032d60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
-00032d70: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
-00032d80: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
-00032d90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00032da0: 207c 302e 3020 2020 2020 2020 7c0a 2020   |0.0       |.  
-00032db0: 2020 2020 2020 7c30 2e35 2020 2020 2020        |0.5      
-00032dc0: 207c 0a20 2020 2020 2020 207c 302e 3520   |.        |0.5 
-00032dd0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
-00032de0: 7c30 2e30 2020 2020 2020 207c 0a20 2020  |0.0       |.   
-00032df0: 2020 2020 207c 302e 3020 2020 2020 2020       |0.0       
-00032e00: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00032e10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
-00032e20: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
-00032e30: 2222 0a20 2020 2072 6574 7572 6e20 6275  "".    return bu
-00032e40: 696c 7469 6e28 2270 6572 6365 6e74 5f72  iltin("percent_r
-00032e50: 616e 6b22 2928 290a 0a0a 6465 6620 6465  ank")()...def de
-00032e60: 6e73 655f 7261 6e6b 2829 202d 3e20 436f  nse_rank() -> Co
-00032e70: 6c75 6d6e 3a0a 2020 2020 2222 220a 2020  lumn:.    """.  
-00032e80: 2020 5265 7475 726e 7320 7468 6520 7261    Returns the ra
-00032e90: 6e6b 206f 6620 6120 7661 6c75 6520 7769  nk of a value wi
-00032ea0: 7468 696e 2061 2067 726f 7570 206f 6620  thin a group of 
-00032eb0: 7661 6c75 6573 2c20 7769 7468 6f75 7420  values, without 
-00032ec0: 6761 7073 2069 6e20 7468 6520 7261 6e6b  gaps in the rank
-00032ed0: 732e 0a20 2020 2054 6865 2072 616e 6b20  s..    The rank 
-00032ee0: 7661 6c75 6520 7374 6172 7473 2061 7420  value starts at 
-00032ef0: 3120 616e 6420 636f 6e74 696e 7565 7320  1 and continues 
-00032f00: 7570 2073 6571 7565 6e74 6961 6c6c 792e  up sequentially.
-00032f10: 0a20 2020 2049 6620 7477 6f20 7661 6c75  .    If two valu
-00032f20: 6573 2061 7265 2074 6865 2073 616d 652c  es are the same,
-00032f30: 2074 6865 7920 7769 6c6c 2068 6176 6520   they will have 
-00032f40: 7468 6520 7361 6d65 2072 616e 6b2e 0a0a  the same rank...
-00032f50: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00032f60: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-00032f70: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00032f80: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
-00032f90: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
-00032fa0: 3e3e 3e20 7769 6e64 6f77 203d 2057 696e  >>> window = Win
-00032fb0: 646f 772e 6f72 6465 725f 6279 2822 6b65  dow.order_by("ke
-00032fc0: 7922 290a 2020 2020 2020 2020 3e3e 3e20  y").        >>> 
-00032fd0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
-00032fe0: 6174 655f 6461 7461 6672 616d 6528 5b28  ate_dataframe([(
-00032ff0: 312c 2022 3122 292c 2028 322c 2022 3222  1, "1"), (2, "2"
-00033000: 292c 2028 312c 2022 3322 292c 2028 322c  ), (1, "3"), (2,
-00033010: 2022 3422 295d 2c20 7363 6865 6d61 3d5b   "4")], schema=[
-00033020: 226b 6579 222c 2022 7661 6c75 6522 5d29  "key", "value"])
-00033030: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00033040: 7365 6c65 6374 2864 656e 7365 5f72 616e  select(dense_ran
-00033050: 6b28 292e 6f76 6572 2877 696e 646f 7729  k().over(window)
-00033060: 2e61 735f 2822 6465 6e73 655f 7261 6e6b  .as_("dense_rank
-00033070: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00033080: 2020 2020 2020 5b52 6f77 2844 454e 5345        [Row(DENSE
-00033090: 5f52 414e 4b3d 3129 2c20 526f 7728 4445  _RANK=1), Row(DE
-000330a0: 4e53 455f 5241 4e4b 3d31 292c 2052 6f77  NSE_RANK=1), Row
-000330b0: 2844 454e 5345 5f52 414e 4b3d 3229 2c20  (DENSE_RANK=2), 
-000330c0: 526f 7728 4445 4e53 455f 5241 4e4b 3d32  Row(DENSE_RANK=2
-000330d0: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
-000330e0: 6574 7572 6e20 6275 696c 7469 6e28 2264  eturn builtin("d
-000330f0: 656e 7365 5f72 616e 6b22 2928 290a 0a0a  ense_rank")()...
-00033100: 6465 6620 726f 775f 6e75 6d62 6572 2829  def row_number()
-00033110: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00033120: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00033130: 6120 756e 6971 7565 2072 6f77 206e 756d  a unique row num
-00033140: 6265 7220 666f 7220 6561 6368 2072 6f77  ber for each row
-00033150: 2077 6974 6869 6e20 6120 7769 6e64 6f77   within a window
-00033160: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
-00033170: 5468 6520 726f 7720 6e75 6d62 6572 2073  The row number s
-00033180: 7461 7274 7320 6174 2031 2061 6e64 2063  tarts at 1 and c
-00033190: 6f6e 7469 6e75 6573 2075 7020 7365 7175  ontinues up sequ
-000331a0: 656e 7469 616c 6c79 2e0a 0a20 2020 2045  entially...    E
-000331b0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-000331c0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
-000331d0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7769  lake.snowpark.wi
-000331e0: 6e64 6f77 2069 6d70 6f72 7420 5769 6e64  ndow import Wind
-000331f0: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
-00033200: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00033210: 7465 5f64 6174 6166 7261 6d65 280a 2020  te_dataframe(.  
-00033220: 2020 2020 2020 2e2e 2e20 2020 2020 5b0a        ...     [.
-00033230: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033240: 2020 2020 5b31 2c20 322c 2031 5d2c 0a20      [1, 2, 1],. 
-00033250: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00033260: 2020 205b 312c 2032 2c20 335d 2c0a 2020     [1, 2, 3],.  
-00033270: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00033280: 2020 5b32 2c20 312c 2031 305d 2c0a 2020    [2, 1, 10],.  
-00033290: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-000332a0: 2020 5b32 2c20 322c 2031 5d2c 0a20 2020    [2, 2, 1],.   
-000332b0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000332c0: 205b 322c 2032 2c20 335d 2c0a 2020 2020   [2, 2, 3],.    
-000332d0: 2020 2020 2e2e 2e20 2020 2020 5d2c 0a20      ...     ],. 
-000332e0: 2020 2020 2020 202e 2e2e 2020 2020 2073         ...     s
-000332f0: 6368 656d 613d 5b22 7822 2c20 2279 222c  chema=["x", "y",
-00033300: 2022 7a22 5d0a 2020 2020 2020 2020 2e2e   "z"].        ..
-00033310: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-00033320: 6466 2e73 656c 6563 7428 726f 775f 6e75  df.select(row_nu
-00033330: 6d62 6572 2829 2e6f 7665 7228 5769 6e64  mber().over(Wind
-00033340: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
-00033350: 636f 6c28 2258 2229 292e 6f72 6465 725f  col("X")).order_
-00033360: 6279 2863 6f6c 2822 5922 2929 292e 616c  by(col("Y"))).al
-00033370: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
-00033380: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
-00033390: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000333a0: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
-000333b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000333c0: 2d2d 2d2d 0a20 2020 2020 2020 207c 3120  ----.        |1 
-000333d0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-000333e0: 2020 7c32 2020 2020 2020 2020 207c 0a20    |2         |. 
-000333f0: 2020 2020 2020 207c 3320 2020 2020 2020         |3       
-00033400: 2020 7c0a 2020 2020 2020 2020 7c31 2020    |.        |1  
-00033410: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
-00033420: 207c 3220 2020 2020 2020 2020 7c0a 2020   |2         |.  
-00033430: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00033440: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
-00033450: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
-00033460: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00033470: 6e28 2272 6f77 5f6e 756d 6265 7222 2928  n("row_number")(
-00033480: 290a 0a0a 6465 6620 6c61 6728 0a20 2020  )...def lag(.   
-00033490: 2065 3a20 436f 6c75 6d6e 4f72 4e61 6d65   e: ColumnOrName
-000334a0: 2c0a 2020 2020 6f66 6673 6574 3a20 696e  ,.    offset: in
-000334b0: 7420 3d20 312c 0a20 2020 2064 6566 6175  t = 1,.    defau
-000334c0: 6c74 5f76 616c 7565 3a20 4f70 7469 6f6e  lt_value: Option
-000334d0: 616c 5b43 6f6c 756d 6e4f 724c 6974 6572  al[ColumnOrLiter
-000334e0: 616c 5d20 3d20 4e6f 6e65 2c0a 2020 2020  al] = None,.    
-000334f0: 6967 6e6f 7265 5f6e 756c 6c73 3a20 626f  ignore_nulls: bo
-00033500: 6f6c 203d 2046 616c 7365 2c0a 2920 2d3e  ol = False,.) ->
-00033510: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
-00033520: 0a20 2020 2041 6363 6573 7365 7320 6461  .    Accesses da
-00033530: 7461 2069 6e20 6120 7072 6576 696f 7573  ta in a previous
-00033540: 2072 6f77 2069 6e20 7468 6520 7361 6d65   row in the same
-00033550: 2072 6573 756c 7420 7365 7420 7769 7468   result set with
-00033560: 6f75 7420 6861 7669 6e67 2074 6f0a 2020  out having to.  
-00033570: 2020 6a6f 696e 2074 6865 2074 6162 6c65    join the table
-00033580: 2074 6f20 6974 7365 6c66 2e0a 0a20 2020   to itself...   
-00033590: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-000335a0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-000335b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000335c0: 7769 6e64 6f77 2069 6d70 6f72 7420 5769  window import Wi
-000335d0: 6e64 6f77 0a20 2020 2020 2020 203e 3e3e  ndow.        >>>
-000335e0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
-000335f0: 6561 7465 5f64 6174 6166 7261 6d65 280a  eate_dataframe(.
-00033600: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033610: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
-00033620: 2020 2020 2020 5b31 2c20 322c 2031 5d2c        [1, 2, 1],
-00033630: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033640: 2020 2020 205b 312c 2032 2c20 335d 2c0a       [1, 2, 3],.
-00033650: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033660: 2020 2020 5b32 2c20 312c 2031 305d 2c0a      [2, 1, 10],.
-00033670: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033680: 2020 2020 5b32 2c20 322c 2031 5d2c 0a20      [2, 2, 1],. 
-00033690: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-000336a0: 2020 205b 322c 2032 2c20 335d 2c0a 2020     [2, 2, 3],.  
-000336b0: 2020 2020 2020 2e2e 2e20 2020 2020 5d2c        ...     ],
-000336c0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-000336d0: 2073 6368 656d 613d 5b22 7822 2c20 2279   schema=["x", "y
-000336e0: 222c 2022 7a22 5d0a 2020 2020 2020 2020  ", "z"].        
-000336f0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-00033700: 3e20 6466 2e73 656c 6563 7428 6c61 6728  > df.select(lag(
-00033710: 225a 2229 2e6f 7665 7228 5769 6e64 6f77  "Z").over(Window
-00033720: 2e70 6172 7469 7469 6f6e 5f62 7928 636f  .partition_by(co
-00033730: 6c28 2258 2229 292e 6f72 6465 725f 6279  l("X")).order_by
-00033740: 2863 6f6c 2822 5922 2929 292e 616c 6961  (col("Y"))).alia
-00033750: 7328 2272 6573 756c 7422 2929 2e63 6f6c  s("result")).col
-00033760: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-00033770: 526f 7728 5245 5355 4c54 3d4e 6f6e 6529  Row(RESULT=None)
-00033780: 2c20 526f 7728 5245 5355 4c54 3d31 3029  , Row(RESULT=10)
-00033790: 2c20 526f 7728 5245 5355 4c54 3d31 292c  , Row(RESULT=1),
-000337a0: 2052 6f77 2852 4553 554c 543d 4e6f 6e65   Row(RESULT=None
-000337b0: 292c 2052 6f77 2852 4553 554c 543d 3129  ), Row(RESULT=1)
-000337c0: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
-000337d0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
-000337e0: 2865 2c20 226c 6167 2229 0a20 2020 2072  (e, "lag").    r
-000337f0: 6574 7572 6e20 436f 6c75 6d6e 280a 2020  eturn Column(.  
-00033800: 2020 2020 2020 4c61 6728 632e 5f65 7870        Lag(c._exp
-00033810: 7265 7373 696f 6e2c 206f 6666 7365 742c  ression, offset,
-00033820: 2043 6f6c 756d 6e2e 5f74 6f5f 6578 7072   Column._to_expr
-00033830: 2864 6566 6175 6c74 5f76 616c 7565 292c  (default_value),
-00033840: 2069 676e 6f72 655f 6e75 6c6c 7329 0a20   ignore_nulls). 
-00033850: 2020 2029 0a0a 0a64 6566 206c 6561 6428     )...def lead(
-00033860: 0a20 2020 2065 3a20 436f 6c75 6d6e 4f72  .    e: ColumnOr
-00033870: 4e61 6d65 2c0a 2020 2020 6f66 6673 6574  Name,.    offset
-00033880: 3a20 696e 7420 3d20 312c 0a20 2020 2064  : int = 1,.    d
-00033890: 6566 6175 6c74 5f76 616c 7565 3a20 4f70  efault_value: Op
-000338a0: 7469 6f6e 616c 5b55 6e69 6f6e 5b43 6f6c  tional[Union[Col
-000338b0: 756d 6e2c 204c 6974 6572 616c 5479 7065  umn, LiteralType
-000338c0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2069  ]] = None,.    i
-000338d0: 676e 6f72 655f 6e75 6c6c 733a 2062 6f6f  gnore_nulls: boo
-000338e0: 6c20 3d20 4661 6c73 652c 0a29 202d 3e20  l = False,.) -> 
-000338f0: 436f 6c75 6d6e 3a0a 2020 2020 2222 220a  Column:.    """.
-00033900: 2020 2020 4163 6365 7373 6573 2064 6174      Accesses dat
-00033910: 6120 696e 2061 2073 7562 7365 7175 656e  a in a subsequen
-00033920: 7420 726f 7720 696e 2074 6865 2073 616d  t row in the sam
-00033930: 6520 7265 7375 6c74 2073 6574 2077 6974  e result set wit
-00033940: 686f 7574 2068 6176 696e 6720 746f 0a20  hout having to. 
-00033950: 2020 206a 6f69 6e20 7468 6520 7461 626c     join the tabl
-00033960: 6520 746f 2069 7473 656c 662e 0a0a 2020  e to itself...  
-00033970: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00033980: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-00033990: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-000339a0: 2e77 696e 646f 7720 696d 706f 7274 2057  .window import W
-000339b0: 696e 646f 770a 2020 2020 2020 2020 3e3e  indow.        >>
-000339c0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
-000339d0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000339e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-000339f0: 205b 0a20 2020 2020 2020 202e 2e2e 2020   [.        ...  
-00033a00: 2020 2020 2020 205b 312c 2032 2c20 315d         [1, 2, 1]
-00033a10: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00033a20: 2020 2020 2020 5b31 2c20 322c 2033 5d2c        [1, 2, 3],
-00033a30: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033a40: 2020 2020 205b 322c 2031 2c20 3130 5d2c       [2, 1, 10],
-00033a50: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033a60: 2020 2020 205b 322c 2032 2c20 315d 2c0a       [2, 2, 1],.
-00033a70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00033a80: 2020 2020 5b32 2c20 322c 2033 5d2c 0a20      [2, 2, 3],. 
-00033a90: 2020 2020 2020 202e 2e2e 2020 2020 205d         ...     ]
-00033aa0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00033ab0: 2020 7363 6865 6d61 3d5b 2278 222c 2022    schema=["x", "
-00033ac0: 7922 2c20 227a 225d 0a20 2020 2020 2020  y", "z"].       
-00033ad0: 202e 2e2e 2029 0a20 2020 2020 2020 203e   ... ).        >
-00033ae0: 3e3e 2064 662e 7365 6c65 6374 286c 6561  >> df.select(lea
-00033af0: 6428 225a 2229 2e6f 7665 7228 5769 6e64  d("Z").over(Wind
-00033b00: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
-00033b10: 636f 6c28 2258 2229 292e 6f72 6465 725f  col("X")).order_
-00033b20: 6279 2863 6f6c 2822 5922 2929 292e 616c  by(col("Y"))).al
-00033b30: 6961 7328 2272 6573 756c 7422 2929 2e63  ias("result")).c
-00033b40: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-00033b50: 205b 526f 7728 5245 5355 4c54 3d31 292c   [Row(RESULT=1),
-00033b60: 2052 6f77 2852 4553 554c 543d 3329 2c20   Row(RESULT=3), 
-00033b70: 526f 7728 5245 5355 4c54 3d4e 6f6e 6529  Row(RESULT=None)
-00033b80: 2c20 526f 7728 5245 5355 4c54 3d33 292c  , Row(RESULT=3),
-00033b90: 2052 6f77 2852 4553 554c 543d 4e6f 6e65   Row(RESULT=None
-00033ba0: 295d 0a20 2020 2022 2222 0a20 2020 2063  )].    """.    c
-00033bb0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
-00033bc0: 7228 652c 2022 6c65 6164 2229 0a20 2020  r(e, "lead").   
-00033bd0: 2072 6574 7572 6e20 436f 6c75 6d6e 280a   return Column(.
-00033be0: 2020 2020 2020 2020 4c65 6164 2863 2e5f          Lead(c._
-00033bf0: 6578 7072 6573 7369 6f6e 2c20 6f66 6673  expression, offs
-00033c00: 6574 2c20 436f 6c75 6d6e 2e5f 746f 5f65  et, Column._to_e
-00033c10: 7870 7228 6465 6661 756c 745f 7661 6c75  xpr(default_valu
-00033c20: 6529 2c20 6967 6e6f 7265 5f6e 756c 6c73  e), ignore_nulls
-00033c30: 290a 2020 2020 290a 0a0a 6465 6620 6c61  ).    )...def la
-00033c40: 7374 5f76 616c 7565 280a 2020 2020 653a  st_value(.    e:
-00033c50: 2043 6f6c 756d 6e4f 724e 616d 652c 0a20   ColumnOrName,. 
-00033c60: 2020 2069 676e 6f72 655f 6e75 6c6c 733a     ignore_nulls:
-00033c70: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a29   bool = False,.)
-00033c80: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
-00033c90: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
-00033ca0: 7468 6520 6c61 7374 2076 616c 7565 2077  the last value w
-00033cb0: 6974 6869 6e20 616e 206f 7264 6572 6564  ithin an ordered
-00033cc0: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
-00033cd0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-00033ce0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00033cf0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
-00033d00: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
-00033d10: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
-00033d20: 2020 203e 3e3e 2077 696e 646f 7720 3d20     >>> window = 
-00033d30: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
-00033d40: 5f62 7928 2263 6f6c 756d 6e31 2229 2e6f  _by("column1").o
-00033d50: 7264 6572 5f62 7928 2263 6f6c 756d 6e32  rder_by("column2
-00033d60: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
-00033d70: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00033d80: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
-00033d90: 2c20 3130 5d2c 205b 312c 2031 315d 2c20  , 10], [1, 11], 
-00033da0: 5b32 2c20 3230 5d2c 205b 322c 2032 315d  [2, 20], [2, 21]
-00033db0: 5d2c 2073 6368 656d 613d 5b22 636f 6c75  ], schema=["colu
-00033dc0: 6d6e 3122 2c20 2263 6f6c 756d 6e32 225d  mn1", "column2"]
-00033dd0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-00033de0: 2e73 656c 6563 7428 6466 5b22 636f 6c75  .select(df["colu
-00033df0: 6d6e 3122 5d2c 2064 665b 2263 6f6c 756d  mn1"], df["colum
-00033e00: 6e32 225d 2c20 6c61 7374 5f76 616c 7565  n2"], last_value
-00033e10: 2864 665b 2263 6f6c 756d 6e32 225d 292e  (df["column2"]).
-00033e20: 6f76 6572 2877 696e 646f 7729 2e61 735f  over(window).as_
-00033e30: 2822 636f 6c75 6d6e 325f 6c61 7374 2229  ("column2_last")
-00033e40: 292e 636f 6c6c 6563 7428 290a 2020 2020  ).collect().    
-00033e50: 2020 2020 5b52 6f77 2843 4f4c 554d 4e31      [Row(COLUMN1
-00033e60: 3d31 2c20 434f 4c55 4d4e 323d 3130 2c20  =1, COLUMN2=10, 
-00033e70: 434f 4c55 4d4e 325f 4c41 5354 3d31 3129  COLUMN2_LAST=11)
-00033e80: 2c20 526f 7728 434f 4c55 4d4e 313d 312c  , Row(COLUMN1=1,
-00033e90: 2043 4f4c 554d 4e32 3d31 312c 2043 4f4c   COLUMN2=11, COL
-00033ea0: 554d 4e32 5f4c 4153 543d 3131 292c 2052  UMN2_LAST=11), R
-00033eb0: 6f77 2843 4f4c 554d 4e31 3d32 2c20 434f  ow(COLUMN1=2, CO
-00033ec0: 4c55 4d4e 323d 3230 2c20 434f 4c55 4d4e  LUMN2=20, COLUMN
-00033ed0: 325f 4c41 5354 3d32 3129 2c20 526f 7728  2_LAST=21), Row(
-00033ee0: 434f 4c55 4d4e 313d 322c 2043 4f4c 554d  COLUMN1=2, COLUM
-00033ef0: 4e32 3d32 312c 2043 4f4c 554d 4e32 5f4c  N2=21, COLUMN2_L
-00033f00: 4153 543d 3231 295d 0a20 2020 2022 2222  AST=21)].    """
-00033f10: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
-00033f20: 5f69 665f 7374 7228 652c 2022 6c61 7374  _if_str(e, "last
-00033f30: 5f76 616c 7565 2229 0a20 2020 2072 6574  _value").    ret
-00033f40: 7572 6e20 436f 6c75 6d6e 284c 6173 7456  urn Column(LastV
-00033f50: 616c 7565 2863 2e5f 6578 7072 6573 7369  alue(c._expressi
-00033f60: 6f6e 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  on, None, None, 
-00033f70: 6967 6e6f 7265 5f6e 756c 6c73 2929 0a0a  ignore_nulls))..
-00033f80: 0a64 6566 2066 6972 7374 5f76 616c 7565  .def first_value
-00033f90: 280a 2020 2020 653a 2043 6f6c 756d 6e4f  (.    e: ColumnO
-00033fa0: 724e 616d 652c 0a20 2020 2069 676e 6f72  rName,.    ignor
-00033fb0: 655f 6e75 6c6c 733a 2062 6f6f 6c20 3d20  e_nulls: bool = 
-00033fc0: 4661 6c73 652c 0a29 202d 3e20 436f 6c75  False,.) -> Colu
-00033fd0: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
-00033fe0: 5265 7475 726e 7320 7468 6520 6669 7273  Returns the firs
-00033ff0: 7420 7661 6c75 6520 7769 7468 696e 2061  t value within a
-00034000: 6e20 6f72 6465 7265 6420 6772 6f75 7020  n ordered group 
-00034010: 6f66 2076 616c 7565 732e 0a0a 2020 2020  of values...    
-00034020: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-00034030: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-00034040: 666c 616b 652e 736e 6f77 7061 726b 2e77  flake.snowpark.w
-00034050: 696e 646f 7720 696d 706f 7274 2057 696e  indow import Win
-00034060: 646f 770a 2020 2020 2020 2020 3e3e 3e20  dow.        >>> 
-00034070: 7769 6e64 6f77 203d 2057 696e 646f 772e  window = Window.
-00034080: 7061 7274 6974 696f 6e5f 6279 2822 636f  partition_by("co
-00034090: 6c75 6d6e 3122 292e 6f72 6465 725f 6279  lumn1").order_by
-000340a0: 2822 636f 6c75 6d6e 3222 290a 2020 2020  ("column2").    
-000340b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
-000340c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
-000340d0: 6672 616d 6528 5b5b 312c 2031 305d 2c20  frame([[1, 10], 
-000340e0: 5b31 2c20 3131 5d2c 205b 322c 2032 305d  [1, 11], [2, 20]
-000340f0: 2c20 5b32 2c20 3231 5d5d 2c20 7363 6865  , [2, 21]], sche
-00034100: 6d61 3d5b 2263 6f6c 756d 6e31 222c 2022  ma=["column1", "
-00034110: 636f 6c75 6d6e 3222 5d29 0a20 2020 2020  column2"]).     
-00034120: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
-00034130: 2864 665b 2263 6f6c 756d 6e31 225d 2c20  (df["column1"], 
-00034140: 6466 5b22 636f 6c75 6d6e 3222 5d2c 2066  df["column2"], f
-00034150: 6972 7374 5f76 616c 7565 2864 665b 2263  irst_value(df["c
-00034160: 6f6c 756d 6e32 225d 292e 6f76 6572 2877  olumn2"]).over(w
-00034170: 696e 646f 7729 2e61 735f 2822 636f 6c75  indow).as_("colu
-00034180: 6d6e 325f 6669 7273 7422 2929 2e63 6f6c  mn2_first")).col
-00034190: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
-000341a0: 526f 7728 434f 4c55 4d4e 313d 312c 2043  Row(COLUMN1=1, C
-000341b0: 4f4c 554d 4e32 3d31 302c 2043 4f4c 554d  OLUMN2=10, COLUM
-000341c0: 4e32 5f46 4952 5354 3d31 3029 2c20 526f  N2_FIRST=10), Ro
-000341d0: 7728 434f 4c55 4d4e 313d 312c 2043 4f4c  w(COLUMN1=1, COL
-000341e0: 554d 4e32 3d31 312c 2043 4f4c 554d 4e32  UMN2=11, COLUMN2
-000341f0: 5f46 4952 5354 3d31 3029 2c20 526f 7728  _FIRST=10), Row(
-00034200: 434f 4c55 4d4e 313d 322c 2043 4f4c 554d  COLUMN1=2, COLUM
-00034210: 4e32 3d32 302c 2043 4f4c 554d 4e32 5f46  N2=20, COLUMN2_F
-00034220: 4952 5354 3d32 3029 2c20 526f 7728 434f  IRST=20), Row(CO
-00034230: 4c55 4d4e 313d 322c 2043 4f4c 554d 4e32  LUMN1=2, COLUMN2
-00034240: 3d32 312c 2043 4f4c 554d 4e32 5f46 4952  =21, COLUMN2_FIR
-00034250: 5354 3d32 3029 5d0a 2020 2020 2222 220a  ST=20)].    """.
-00034260: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
-00034270: 6966 5f73 7472 2865 2c20 226c 6173 745f  if_str(e, "last_
-00034280: 7661 6c75 6522 290a 2020 2020 7265 7475  value").    retu
-00034290: 726e 2043 6f6c 756d 6e28 4669 7273 7456  rn Column(FirstV
-000342a0: 616c 7565 2863 2e5f 6578 7072 6573 7369  alue(c._expressi
-000342b0: 6f6e 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  on, None, None, 
-000342c0: 6967 6e6f 7265 5f6e 756c 6c73 2929 0a0a  ignore_nulls))..
-000342d0: 0a64 6566 206e 7469 6c65 2865 3a20 556e  .def ntile(e: Un
-000342e0: 696f 6e5b 696e 742c 2043 6f6c 756d 6e4f  ion[int, ColumnO
-000342f0: 724e 616d 655d 2920 2d3e 2043 6f6c 756d  rName]) -> Colum
-00034300: 6e3a 0a20 2020 2022 2222 0a20 2020 2044  n:.    """.    D
-00034310: 6976 6964 6573 2061 6e20 6f72 6465 7265  ivides an ordere
-00034320: 6420 6461 7461 2073 6574 2065 7175 616c  d data set equal
-00034330: 6c79 2069 6e74 6f20 7468 6520 6e75 6d62  ly into the numb
-00034340: 6572 206f 6620 6275 636b 6574 7320 7370  er of buckets sp
-00034350: 6563 6966 6965 6420 6279 206e 2e0a 2020  ecified by n..  
-00034360: 2020 4275 636b 6574 7320 6172 6520 7365    Buckets are se
-00034370: 7175 656e 7469 616c 6c79 206e 756d 6265  quentially numbe
-00034380: 7265 6420 3120 7468 726f 7567 6820 6e2e  red 1 through n.
-00034390: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-000343a0: 2020 2020 653a 2054 6865 2064 6573 6972      e: The desir
-000343b0: 6564 206e 756d 6265 7220 6f66 2062 7563  ed number of buc
-000343c0: 6b65 7473 3b20 6d75 7374 2062 6520 6120  kets; must be a 
-000343d0: 706f 7369 7469 7665 2069 6e74 6567 6572  positive integer
-000343e0: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
-000343f0: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
-00034400: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-00034410: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
-00034420: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
-00034430: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-00034440: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-00034450: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
-00034460: 2020 2020 2e2e 2e20 2020 2020 5b5b 2243      ...     [["C
-00034470: 222c 2022 5350 5922 2c20 335d 2c20 5b22  ", "SPY", 3], ["
-00034480: 4322 2c20 2241 4150 4c22 2c20 3130 5d2c  C", "AAPL", 10],
-00034490: 205b 224e 222c 2022 5350 5922 2c20 355d   ["N", "SPY", 5]
-000344a0: 2c20 5b22 4e22 2c20 2241 4150 4c22 2c20  , ["N", "AAPL", 
-000344b0: 375d 2c20 5b22 5122 2c20 224d 5346 5422  7], ["Q", "MSFT"
-000344c0: 2c20 335d 5d2c 0a20 2020 2020 2020 202e  , 3]],.        .
-000344d0: 2e2e 2020 2020 2073 6368 656d 613d 5b22  ..     schema=["
-000344e0: 6578 6368 616e 6765 222c 2022 7379 6d62  exchange", "symb
-000344f0: 6f6c 222c 2022 7368 6172 6573 225d 0a20  ol", "shares"]. 
-00034500: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
-00034510: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
-00034520: 6374 2863 6f6c 2822 6578 6368 616e 6765  ct(col("exchange
-00034530: 2229 2c20 636f 6c28 2273 796d 626f 6c22  "), col("symbol"
-00034540: 292c 206e 7469 6c65 2833 292e 6f76 6572  ), ntile(3).over
-00034550: 2857 696e 646f 772e 7061 7274 6974 696f  (Window.partitio
-00034560: 6e5f 6279 2822 6578 6368 616e 6765 2229  n_by("exchange")
-00034570: 2e6f 7264 6572 5f62 7928 2273 6861 7265  .order_by("share
-00034580: 7322 2929 2e61 6c69 6173 2822 6e74 696c  s")).alias("ntil
-00034590: 655f 3322 2929 2e73 686f 7728 290a 2020  e_3")).show().  
-000345a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000345b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000345c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000345d0: 2020 2020 7c22 4558 4348 414e 4745 2220      |"EXCHANGE" 
-000345e0: 207c 2253 594d 424f 4c22 2020 7c22 4e54   |"SYMBOL"  |"NT
-000345f0: 494c 455f 3322 2020 7c0a 2020 2020 2020  ILE_3"  |.      
-00034600: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-00034610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00034620: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00034630: 7c51 2020 2020 2020 2020 2020 207c 4d53  |Q           |MS
-00034640: 4654 2020 2020 2020 7c31 2020 2020 2020  FT      |1      
-00034650: 2020 2020 7c0a 2020 2020 2020 2020 7c4e      |.        |N
-00034660: 2020 2020 2020 2020 2020 207c 5350 5920             |SPY 
-00034670: 2020 2020 2020 7c31 2020 2020 2020 2020        |1        
-00034680: 2020 7c0a 2020 2020 2020 2020 7c4e 2020    |.        |N  
-00034690: 2020 2020 2020 2020 207c 4141 504c 2020           |AAPL  
-000346a0: 2020 2020 7c32 2020 2020 2020 2020 2020      |2          
-000346b0: 7c0a 2020 2020 2020 2020 7c43 2020 2020  |.        |C    
-000346c0: 2020 2020 2020 207c 5350 5920 2020 2020         |SPY     
-000346d0: 2020 7c31 2020 2020 2020 2020 2020 7c0a    |1          |.
-000346e0: 2020 2020 2020 2020 7c43 2020 2020 2020          |C      
-000346f0: 2020 2020 207c 4141 504c 2020 2020 2020       |AAPL      
-00034700: 7c32 2020 2020 2020 2020 2020 7c0a 2020  |2          |.  
-00034710: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00034720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00034730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00034740: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00034750: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
-00034760: 5f74 6f5f 636f 6c5f 6966 5f73 7472 5f6f  _to_col_if_str_o
-00034770: 725f 696e 7428 652c 2022 6e74 696c 6522  r_int(e, "ntile"
-00034780: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
-00034790: 6c74 696e 2822 6e74 696c 6522 2928 6329  ltin("ntile")(c)
-000347a0: 0a0a 0a64 6566 2070 6572 6365 6e74 696c  ...def percentil
-000347b0: 655f 636f 6e74 2870 6572 6365 6e74 696c  e_cont(percentil
-000347c0: 653a 2066 6c6f 6174 2920 2d3e 2043 6f6c  e: float) -> Col
-000347d0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-000347e0: 2052 6574 7572 6e20 6120 7065 7263 656e   Return a percen
-000347f0: 7469 6c65 2076 616c 7565 2062 6173 6564  tile value based
-00034800: 206f 6e20 6120 636f 6e74 696e 756f 7573   on a continuous
-00034810: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
-00034820: 2074 6865 0a20 2020 2069 6e70 7574 2063   the.    input c
-00034830: 6f6c 756d 6e2e 2049 6620 6e6f 2069 6e70  olumn. If no inp
-00034840: 7574 2072 6f77 206c 6965 7320 6578 6163  ut row lies exac
-00034850: 746c 7920 6174 2074 6865 2064 6573 6972  tly at the desir
-00034860: 6564 2070 6572 6365 6e74 696c 652c 0a20  ed percentile,. 
-00034870: 2020 2074 6865 2072 6573 756c 7420 6973     the result is
-00034880: 2063 616c 6375 6c61 7465 6420 7573 696e   calculated usin
-00034890: 6720 6c69 6e65 6172 2069 6e74 6572 706f  g linear interpo
-000348a0: 6c61 7469 6f6e 206f 6620 7468 6520 7477  lation of the tw
-000348b0: 6f20 6e65 6172 6573 740a 2020 2020 696e  o nearest.    in
-000348c0: 7075 7420 7661 6c75 6573 2e20 4e55 4c4c  put values. NULL
-000348d0: 2076 616c 7565 7320 6172 6520 6967 6e6f   values are igno
-000348e0: 7265 6420 696e 2074 6865 2063 616c 6375  red in the calcu
-000348f0: 6c61 7469 6f6e 2e0a 0a20 2020 2041 7267  lation...    Arg
-00034900: 733a 0a20 2020 2020 2020 2070 6572 6365  s:.        perce
-00034910: 6e74 696c 653a 2074 6865 2070 6572 6365  ntile: the perce
-00034920: 6e74 696c 6520 6f66 2074 6865 2076 616c  ntile of the val
-00034930: 7565 2074 6861 7420 796f 7520 7761 6e74  ue that you want
-00034940: 2074 6f20 6669 6e64 2e0a 2020 2020 2020   to find..      
-00034950: 2020 2020 2020 5468 6520 7065 7263 656e        The percen
-00034960: 7469 6c65 206d 7573 7420 6265 2061 2063  tile must be a c
-00034970: 6f6e 7374 616e 7420 6265 7477 6565 6e20  onstant between 
-00034980: 302e 3020 616e 6420 312e 302e 2046 6f72  0.0 and 1.0. For
-00034990: 2065 7861 6d70 6c65 2c0a 2020 2020 2020   example,.      
-000349a0: 2020 2020 2020 6966 2079 6f75 2077 616e        if you wan
-000349b0: 7420 746f 2066 696e 6420 7468 6520 7661  t to find the va
-000349c0: 6c75 6520 6174 2074 6865 2039 3074 6820  lue at the 90th 
-000349d0: 7065 7263 656e 7469 6c65 2c20 7370 6563  percentile, spec
-000349e0: 6966 7920 302e 392e 0a0a 2020 2020 4578  ify 0.9...    Ex
-000349f0: 616d 706c 653a 0a0a 2020 2020 2020 2020  ample:..        
-00034a00: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-00034a10: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-00034a20: 6528 5b0a 2020 2020 2020 2020 2e2e 2e20  e([.        ... 
-00034a30: 2020 2020 2830 2c20 3029 2c20 2830 2c20      (0, 0), (0, 
-00034a40: 3130 292c 2028 302c 2032 3029 2c20 2830  10), (0, 20), (0
-00034a50: 2c20 3330 292c 2028 302c 2034 3029 2c0a  , 30), (0, 40),.
-00034a60: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00034a70: 2831 2c20 3130 292c 2028 312c 2032 3029  (1, 10), (1, 20)
-00034a80: 2c20 2832 2c20 3130 292c 2028 322c 2032  , (2, 10), (2, 2
-00034a90: 3029 2c20 2832 2c20 3235 292c 0a20 2020  0), (2, 25),.   
-00034aa0: 2020 2020 202e 2e2e 2020 2020 2028 322c       ...     (2,
-00034ab0: 2033 3029 2c20 2833 2c20 3630 292c 2028   30), (3, 60), (
-00034ac0: 342c 204e 6f6e 6529 0a20 2020 2020 2020  4, None).       
-00034ad0: 202e 2e2e 205d 2c20 7363 6865 6d61 3d5b   ... ], schema=[
-00034ae0: 226b 222c 2022 7622 5d29 0a20 2020 2020  "k", "v"]).     
-00034af0: 2020 203e 3e3e 2064 662e 6772 6f75 705f     >>> df.group_
-00034b00: 6279 2822 6b22 292e 6167 6728 7065 7263  by("k").agg(perc
-00034b10: 656e 7469 6c65 5f63 6f6e 7428 302e 3235  entile_cont(0.25
-00034b20: 292e 7769 7468 696e 5f67 726f 7570 2822  ).within_group("
-00034b30: 7622 292e 6173 5f28 2270 6572 6365 6e74  v").as_("percent
-00034b40: 696c 6522 2929 2e73 6f72 7428 226b 2229  ile")).sort("k")
-00034b50: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
-00034b60: 2020 205b 526f 7728 4b3d 302c 2050 4552     [Row(K=0, PER
-00034b70: 4345 4e54 494c 453d 4465 6369 6d61 6c28  CENTILE=Decimal(
-00034b80: 2731 302e 3030 3027 2929 2c20 5c0a 526f  '10.000')), \.Ro
-00034b90: 7728 4b3d 312c 2050 4552 4345 4e54 494c  w(K=1, PERCENTIL
-00034ba0: 453d 4465 6369 6d61 6c28 2731 322e 3530  E=Decimal('12.50
-00034bb0: 3027 2929 2c20 5c0a 526f 7728 4b3d 322c  0')), \.Row(K=2,
-00034bc0: 2050 4552 4345 4e54 494c 453d 4465 6369   PERCENTILE=Deci
-00034bd0: 6d61 6c28 2731 372e 3530 3027 2929 2c20  mal('17.500')), 
-00034be0: 5c0a 526f 7728 4b3d 332c 2050 4552 4345  \.Row(K=3, PERCE
-00034bf0: 4e54 494c 453d 4465 6369 6d61 6c28 2736  NTILE=Decimal('6
-00034c00: 302e 3030 3027 2929 2c20 5c0a 526f 7728  0.000')), \.Row(
-00034c10: 4b3d 342c 2050 4552 4345 4e54 494c 453d  K=4, PERCENTILE=
-00034c20: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
-00034c30: 2020 2072 6574 7572 6e20 6275 696c 7469     return builti
-00034c40: 6e28 2270 6572 6365 6e74 696c 655f 636f  n("percentile_co
-00034c50: 6e74 2229 2870 6572 6365 6e74 696c 6529  nt")(percentile)
-00034c60: 0a0a 0a64 6566 2067 7265 6174 6573 7428  ...def greatest(
-00034c70: 2a63 6f6c 756d 6e73 3a20 436f 6c75 6d6e  *columns: Column
-00034c80: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
-00034c90: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
-00034ca0: 6574 7572 6e73 2074 6865 206c 6172 6765  eturns the large
-00034cb0: 7374 2076 616c 7565 2066 726f 6d20 6120  st value from a 
-00034cc0: 6c69 7374 206f 6620 6578 7072 6573 7369  list of expressi
-00034cd0: 6f6e 732e 0a20 2020 2049 6620 616e 7920  ons..    If any 
-00034ce0: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
-00034cf0: 7661 6c75 6573 2069 7320 4e55 4c4c 2c20  values is NULL, 
-00034d00: 7468 6520 7265 7375 6c74 2069 7320 4e55  the result is NU
-00034d10: 4c4c 2e0a 2020 2020 4752 4541 5445 5354  LL..    GREATEST
-00034d20: 2073 7570 706f 7274 7320 616c 6c20 6461   supports all da
-00034d30: 7461 2074 7970 6573 2c20 696e 636c 7564  ta types, includ
-00034d40: 696e 6720 5641 5249 414e 542e 0a0a 2020  ing VARIANT...  
-00034d50: 2020 4578 616d 706c 6573 3a3a 0a0a 2020    Examples::..  
-00034d60: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
-00034d70: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
-00034d80: 7461 6672 616d 6528 5b5b 312c 2032 2c20  taframe([[1, 2, 
-00034d90: 335d 2c20 5b32 2c20 342c 202d 315d 2c20  3], [2, 4, -1], 
-00034da0: 5b33 2c20 362c 204e 6f6e 655d 5d2c 2073  [3, 6, None]], s
-00034db0: 6368 656d 613d 5b22 6122 2c20 2262 222c  chema=["a", "b",
-00034dc0: 2022 6322 5d29 0a20 2020 2020 2020 203e   "c"]).        >
-00034dd0: 3e3e 2064 662e 7365 6c65 6374 2867 7265  >> df.select(gre
-00034de0: 6174 6573 7428 6466 5b22 6122 5d2c 2064  atest(df["a"], d
-00034df0: 665b 2262 225d 2c20 6466 5b22 6322 5d29  f["b"], df["c"])
-00034e00: 2e61 6c69 6173 2822 6772 6561 7465 7374  .alias("greatest
-00034e10: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
-00034e20: 2020 2020 2020 5b52 6f77 2847 5245 4154        [Row(GREAT
-00034e30: 4553 543d 3329 2c20 526f 7728 4752 4541  EST=3), Row(GREA
-00034e40: 5445 5354 3d34 292c 2052 6f77 2847 5245  TEST=4), Row(GRE
-00034e50: 4154 4553 543d 4e6f 6e65 295d 0a20 2020  ATEST=None)].   
-00034e60: 2022 2222 0a20 2020 2063 203d 205b 5f74   """.    c = [_t
-00034e70: 6f5f 636f 6c5f 6966 5f73 7472 2865 782c  o_col_if_str(ex,
-00034e80: 2022 6772 6561 7465 7374 2229 2066 6f72   "greatest") for
-00034e90: 2065 7820 696e 2063 6f6c 756d 6e73 5d0a   ex in columns].
-00034ea0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
-00034eb0: 696e 2822 6772 6561 7465 7374 2229 282a  in("greatest")(*
-00034ec0: 6329 0a0a 0a64 6566 206c 6561 7374 282a  c)...def least(*
-00034ed0: 636f 6c75 6d6e 733a 2043 6f6c 756d 6e4f  columns: ColumnO
-00034ee0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
-00034ef0: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
-00034f00: 7475 726e 7320 7468 6520 736d 616c 6c65  turns the smalle
-00034f10: 7374 2076 616c 7565 2066 726f 6d20 6120  st value from a 
-00034f20: 6c69 7374 206f 6620 6578 7072 6573 7369  list of expressi
-00034f30: 6f6e 732e 0a20 2020 2049 6620 616e 7920  ons..    If any 
-00034f40: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
-00034f50: 7661 6c75 6573 2069 7320 4e55 4c4c 2c20  values is NULL, 
-00034f60: 7468 6520 7265 7375 6c74 2069 7320 4e55  the result is NU
-00034f70: 4c4c 2e0a 2020 2020 4c45 4153 5420 7375  LL..    LEAST su
-00034f80: 7070 6f72 7473 2061 6c6c 2064 6174 6120  pports all data 
-00034f90: 7479 7065 732c 2069 6e63 6c75 6469 6e67  types, including
-00034fa0: 2056 4152 4941 4e54 2e0a 0a20 2020 2045   VARIANT...    E
-00034fb0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-00034fc0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
-00034fd0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
-00034fe0: 616d 6528 5b5b 312c 2032 2c20 335d 2c20  ame([[1, 2, 3], 
-00034ff0: 5b32 2c20 342c 202d 315d 2c20 5b33 2c20  [2, 4, -1], [3, 
-00035000: 362c 204e 6f6e 655d 5d2c 2073 6368 656d  6, None]], schem
-00035010: 613d 5b22 6122 2c20 2262 222c 2022 6322  a=["a", "b", "c"
-00035020: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-00035030: 662e 7365 6c65 6374 286c 6561 7374 2864  f.select(least(d
-00035040: 665b 2261 225d 2c20 6466 5b22 6222 5d2c  f["a"], df["b"],
-00035050: 2064 665b 2263 225d 292e 616c 6961 7328   df["c"]).alias(
-00035060: 226c 6561 7374 2229 292e 636f 6c6c 6563  "least")).collec
-00035070: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
-00035080: 284c 4541 5354 3d31 292c 2052 6f77 284c  (LEAST=1), Row(L
-00035090: 4541 5354 3d2d 3129 2c20 526f 7728 4c45  EAST=-1), Row(LE
-000350a0: 4153 543d 4e6f 6e65 295d 0a20 2020 2022  AST=None)].    "
-000350b0: 2222 0a20 2020 2063 203d 205b 5f74 6f5f  "".    c = [_to_
-000350c0: 636f 6c5f 6966 5f73 7472 2865 782c 2022  col_if_str(ex, "
-000350d0: 6c65 6173 7422 2920 666f 7220 6578 2069  least") for ex i
-000350e0: 6e20 636f 6c75 6d6e 735d 0a20 2020 2072  n columns].    r
-000350f0: 6574 7572 6e20 6275 696c 7469 6e28 226c  eturn builtin("l
-00035100: 6561 7374 2229 282a 6329 0a0a 0a64 6566  east")(*c)...def
-00035110: 206c 6973 7461 6767 2865 3a20 436f 6c75   listagg(e: Colu
-00035120: 6d6e 4f72 4e61 6d65 2c20 6465 6c69 6d69  mnOrName, delimi
-00035130: 7465 723a 2073 7472 203d 2022 222c 2069  ter: str = "", i
-00035140: 735f 6469 7374 696e 6374 3a20 626f 6f6c  s_distinct: bool
-00035150: 203d 2046 616c 7365 2920 2d3e 2043 6f6c   = False) -> Col
-00035160: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
-00035170: 2052 6574 7572 6e73 2074 6865 2063 6f6e   Returns the con
-00035180: 6361 7465 6e61 7465 6420 696e 7075 7420  catenated input 
-00035190: 7661 6c75 6573 2c20 7365 7061 7261 7465  values, separate
-000351a0: 6420 6279 2060 6465 6c69 6d69 7465 7260  d by `delimiter`
-000351b0: 2073 7472 696e 672e 0a20 2020 2053 6565   string..    See
-000351c0: 2060 4c49 5354 4147 4720 3c68 7474 7073   `LISTAGG <https
-000351d0: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
-000351e0: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
-000351f0: 6572 656e 6365 2f66 756e 6374 696f 6e73  erence/functions
-00035200: 2f6c 6973 7461 6767 2e68 746d 6c3e 605f  /listagg.html>`_
-00035210: 2066 6f72 2064 6574 6169 6c73 2e0a 0a20   for details... 
-00035220: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00035230: 2065 3a20 4120 3a63 6c61 7373 3a60 436f   e: A :class:`Co
-00035240: 6c75 6d6e 6020 6f62 6a65 6374 206f 7220  lumn` object or 
-00035250: 636f 6c75 6d6e 206e 616d 6520 7468 6174  column name that
-00035260: 2064 6574 6572 6d69 6e65 7320 7468 6520   determines the 
-00035270: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
-00035280: 2020 2074 6f20 6265 2070 7574 2069 6e74     to be put int
-00035290: 6f20 7468 6520 6c69 7374 2e0a 2020 2020  o the list..    
-000352a0: 2020 2020 6465 6c69 6d69 7465 723a 2041      delimiter: A
-000352b0: 2073 7472 696e 6720 6465 6c69 6d69 7465   string delimite
-000352c0: 722e 0a20 2020 2020 2020 2069 735f 6469  r..        is_di
-000352d0: 7374 696e 6374 3a20 5768 6574 6865 7220  stinct: Whether 
-000352e0: 7468 6520 696e 7075 7420 6578 7072 6573  the input expres
-000352f0: 7369 6f6e 2069 7320 6469 7374 696e 6374  sion is distinct
-00035300: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
-00035310: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00035320: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00035330: 7465 5f64 6174 6166 7261 6d65 285b 312c  te_dataframe([1,
-00035340: 2032 2c20 332c 2032 2c20 342c 2035 5d2c   2, 3, 2, 4, 5],
-00035350: 2073 6368 656d 613d 5b22 636f 6c22 5d29   schema=["col"])
-00035360: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-00035370: 7365 6c65 6374 286c 6973 7461 6767 2822  select(listagg("
-00035380: 636f 6c22 2c20 222c 2229 2e77 6974 6869  col", ",").withi
-00035390: 6e5f 6772 6f75 7028 6466 5b22 636f 6c22  n_group(df["col"
-000353a0: 5d2e 6173 6328 2929 2e61 735f 2822 7265  ].asc()).as_("re
-000353b0: 7375 6c74 2229 292e 636f 6c6c 6563 7428  sult")).collect(
-000353c0: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
-000353d0: 4553 554c 543d 2731 2c32 2c32 2c33 2c34  ESULT='1,2,2,3,4
-000353e0: 2c35 2729 5d0a 2020 2020 2222 220a 2020  ,5')].    """.  
-000353f0: 2020 6320 3d20 5f74 6f5f 636f 6c5f 6966    c = _to_col_if
-00035400: 5f73 7472 2865 2c20 226c 6973 7461 6767  _str(e, "listagg
-00035410: 2229 0a20 2020 2072 6574 7572 6e20 436f  ").    return Co
-00035420: 6c75 6d6e 284c 6973 7441 6767 2863 2e5f  lumn(ListAgg(c._
-00035430: 6578 7072 6573 7369 6f6e 2c20 6465 6c69  expression, deli
-00035440: 6d69 7465 722c 2069 735f 6469 7374 696e  miter, is_distin
-00035450: 6374 2929 0a0a 0a64 6566 2077 6865 6e5f  ct))...def when_
-00035460: 6d61 7463 6865 6428 0a20 2020 2063 6f6e  matched(.    con
-00035470: 6469 7469 6f6e 3a20 4f70 7469 6f6e 616c  dition: Optional
-00035480: 5b43 6f6c 756d 6e5d 203d 204e 6f6e 652c  [Column] = None,
-00035490: 0a29 202d 3e20 2273 6e6f 7766 6c61 6b65  .) -> "snowflake
-000354a0: 2e73 6e6f 7770 6172 6b2e 7461 626c 652e  .snowpark.table.
-000354b0: 5768 656e 4d61 7463 6865 6443 6c61 7573  WhenMatchedClaus
-000354c0: 6522 3a0a 2020 2020 2222 220a 2020 2020  e":.    """.    
-000354d0: 5370 6563 6966 6965 7320 6120 6d61 7463  Specifies a matc
-000354e0: 6865 6420 636c 6175 7365 2066 6f72 2074  hed clause for t
-000354f0: 6865 203a 6d65 7468 3a60 5461 626c 652e  he :meth:`Table.
-00035500: 6d65 7267 6520 3c73 6e6f 7766 6c61 6b65  merge <snowflake
-00035510: 2e73 6e6f 7770 6172 6b2e 5461 626c 652e  .snowpark.Table.
-00035520: 6d65 7267 653e 6020 6163 7469 6f6e 2e0a  merge>` action..
-00035530: 2020 2020 5365 6520 3a63 6c61 7373 3a60      See :class:`
-00035540: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00035550: 6172 6b2e 7461 626c 652e 5768 656e 4d61  ark.table.WhenMa
-00035560: 7463 6865 6443 6c61 7573 6560 2066 6f72  tchedClause` for
-00035570: 2064 6574 6169 6c73 2e0a 0a20 2020 2043   details...    C
-00035580: 6f6e 7665 6e69 656e 6365 2066 756e 6374  onvenience funct
-00035590: 696f 6e20 746f 2063 7265 6174 6520 6120  ion to create a 
-000355a0: 6e65 7720 5768 656e 4d61 7463 6865 6443  new WhenMatchedC
-000355b0: 6c61 7573 6520 696e 7374 616e 6365 2077  lause instance w
-000355c0: 6869 6368 2069 7320 7265 7175 6972 6564  hich is required
-000355d0: 2074 6f67 6574 6865 7220 7769 7468 2061   together with a
-000355e0: 6e20 6163 7469 6f6e 2077 6865 6e20 6d65  n action when me
-000355f0: 7267 696e 670a 2020 2020 6120 536e 6f77  rging.    a Snow
-00035600: 7061 726b 2074 6162 6c65 2077 6974 6820  park table with 
-00035610: 6120 536e 6f77 7061 726b 2044 6174 6146  a Snowpark DataF
-00035620: 7261 6d65 2028 7365 6520 736e 6f77 666c  rame (see snowfl
-00035630: 616b 652e 736e 6f77 7061 726b 2e54 6162  ake.snowpark.Tab
-00035640: 6c65 2e6d 6572 6765 2066 6f72 206d 6f72  le.merge for mor
-00035650: 6520 6465 7461 696c 7329 2e0a 0a20 2020  e details)...   
-00035660: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-00035670: 2020 2020 3e3e 3e20 7461 7267 6574 5f64      >>> target_d
-00035680: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-00035690: 7465 5f64 6174 6166 7261 6d65 285b 2831  te_dataframe([(1
-000356a0: 302c 2022 6f6c 6422 292c 2028 3130 2c20  0, "old"), (10, 
-000356b0: 2274 6f6f 5f6f 6c64 2229 2c20 2831 312c  "too_old"), (11,
-000356c0: 2022 6f6c 6422 295d 2c20 7363 6865 6d61   "old")], schema
-000356d0: 3d5b 226b 6579 222c 2022 7661 6c75 6522  =["key", "value"
-000356e0: 5d29 0a20 2020 2020 2020 203e 3e3e 2074  ]).        >>> t
-000356f0: 6172 6765 745f 6466 2e77 7269 7465 2e73  arget_df.write.s
-00035700: 6176 655f 6173 5f74 6162 6c65 2822 6d79  ave_as_table("my
-00035710: 5f74 6162 6c65 222c 206d 6f64 653d 226f  _table", mode="o
-00035720: 7665 7277 7269 7465 222c 2074 6162 6c65  verwrite", table
-00035730: 5f74 7970 653d 2274 656d 706f 7261 7279  _type="temporary
-00035740: 2229 0a20 2020 2020 2020 203e 3e3e 2074  ").        >>> t
-00035750: 6172 6765 7420 3d20 7365 7373 696f 6e2e  arget = session.
-00035760: 7461 626c 6528 226d 795f 7461 626c 6522  table("my_table"
-00035770: 290a 2020 2020 2020 2020 3e3e 3e20 736f  ).        >>> so
-00035780: 7572 6365 203d 2073 6573 7369 6f6e 2e63  urce = session.c
-00035790: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-000357a0: 5b28 3130 2c20 226e 6577 2229 2c20 2831  [(10, "new"), (1
-000357b0: 322c 2022 6e65 7722 292c 2028 3133 2c20  2, "new"), (13, 
-000357c0: 226f 6c64 2229 5d2c 2073 6368 656d 613d  "old")], schema=
-000357d0: 5b22 6b65 7922 2c20 2276 616c 7565 225d  ["key", "value"]
-000357e0: 290a 2020 2020 2020 2020 3e3e 3e20 7461  ).        >>> ta
-000357f0: 7267 6574 2e6d 6572 6765 2873 6f75 7263  rget.merge(sourc
-00035800: 652c 2028 7461 7267 6574 5b22 6b65 7922  e, (target["key"
-00035810: 5d20 3d3d 2073 6f75 7263 655b 226b 6579  ] == source["key
-00035820: 225d 2920 2620 2874 6172 6765 745b 2276  "]) & (target["v
-00035830: 616c 7565 225d 203d 3d20 2274 6f6f 5f6f  alue"] == "too_o
-00035840: 6c64 2229 2c0a 2020 2020 2020 2020 2e2e  ld"),.        ..
-00035850: 2e20 2020 2020 2020 2020 2020 2020 205b  .              [
-00035860: 7768 656e 5f6d 6174 6368 6564 2829 2e75  when_matched().u
-00035870: 7064 6174 6528 7b22 7661 6c75 6522 3a20  pdate({"value": 
-00035880: 736f 7572 6365 5b22 7661 6c75 6522 5d7d  source["value"]}
-00035890: 295d 290a 2020 2020 2020 2020 4d65 7267  )]).        Merg
-000358a0: 6552 6573 756c 7428 726f 7773 5f69 6e73  eResult(rows_ins
-000358b0: 6572 7465 643d 302c 2072 6f77 735f 7570  erted=0, rows_up
-000358c0: 6461 7465 643d 312c 2072 6f77 735f 6465  dated=1, rows_de
-000358d0: 6c65 7465 643d 3029 0a20 2020 2020 2020  leted=0).       
-000358e0: 203e 3e3e 2074 6172 6765 742e 636f 6c6c   >>> target.coll
-000358f0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
-00035900: 6f77 284b 4559 3d31 302c 2056 414c 5545  ow(KEY=10, VALUE
-00035910: 3d27 6f6c 6427 292c 2052 6f77 284b 4559  ='old'), Row(KEY
-00035920: 3d31 302c 2056 414c 5545 3d27 6e65 7727  =10, VALUE='new'
-00035930: 292c 2052 6f77 284b 4559 3d31 312c 2056  ), Row(KEY=11, V
-00035940: 414c 5545 3d27 6f6c 6427 295d 0a0a 2020  ALUE='old')]..  
-00035950: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00035960: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
-00035970: 6172 6b2e 7461 626c 652e 5768 656e 4d61  ark.table.WhenMa
-00035980: 7463 6865 6443 6c61 7573 6528 636f 6e64  tchedClause(cond
-00035990: 6974 696f 6e29 0a0a 0a64 6566 2077 6865  ition)...def whe
-000359a0: 6e5f 6e6f 745f 6d61 7463 6865 6428 0a20  n_not_matched(. 
-000359b0: 2020 2063 6f6e 6469 7469 6f6e 3a20 4f70     condition: Op
-000359c0: 7469 6f6e 616c 5b43 6f6c 756d 6e5d 203d  tional[Column] =
-000359d0: 204e 6f6e 652c 0a29 202d 3e20 2273 6e6f   None,.) -> "sno
-000359e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-000359f0: 7461 626c 652e 5768 656e 4e6f 744d 6174  table.WhenNotMat
-00035a00: 6368 6564 436c 6175 7365 223a 0a20 2020  chedClause":.   
-00035a10: 2022 2222 0a20 2020 2053 7065 6369 6669   """.    Specifi
-00035a20: 6573 2061 206e 6f74 2d6d 6174 6368 6564  es a not-matched
-00035a30: 2063 6c61 7573 6520 666f 7220 7468 6520   clause for the 
-00035a40: 3a6d 6574 683a 6054 6162 6c65 2e6d 6572  :meth:`Table.mer
-00035a50: 6765 203c 736e 6f77 666c 616b 652e 736e  ge <snowflake.sn
-00035a60: 6f77 7061 726b 2e54 6162 6c65 2e6d 6572  owpark.Table.mer
-00035a70: 6765 3e60 2061 6374 696f 6e2e 0a20 2020  ge>` action..   
-00035a80: 2053 6565 203a 636c 6173 733a 607e 736e   See :class:`~sn
-00035a90: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-00035aa0: 2e74 6162 6c65 2e57 6865 6e4e 6f74 4d61  .table.WhenNotMa
-00035ab0: 7463 6865 6443 6c61 7573 6560 2066 6f72  tchedClause` for
-00035ac0: 2064 6574 6169 6c73 2e0a 0a20 2020 2043   details...    C
-00035ad0: 6f6e 7665 6e69 656e 6365 2066 756e 6374  onvenience funct
-00035ae0: 696f 6e20 746f 2063 7265 6174 6520 6120  ion to create a 
-00035af0: 6e65 7720 5768 656e 4e6f 744d 6174 6368  new WhenNotMatch
-00035b00: 6564 436c 6175 7365 2069 6e73 7461 6e63  edClause instanc
-00035b10: 6520 7768 6963 6820 6973 2072 6571 7569  e which is requi
-00035b20: 7265 6420 746f 6765 7468 6572 2077 6974  red together wit
-00035b30: 6820 616e 2061 6374 696f 6e20 7768 656e  h an action when
-00035b40: 206d 6572 6769 6e67 0a20 2020 2061 2053   merging.    a S
-00035b50: 6e6f 7770 6172 6b20 7461 626c 6520 7769  nowpark table wi
-00035b60: 7468 2061 2053 6e6f 7770 6172 6b20 4461  th a Snowpark Da
-00035b70: 7461 4672 616d 6520 2873 6565 2073 6e6f  taFrame (see sno
-00035b80: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-00035b90: 5461 626c 652e 6d65 7267 6520 666f 7220  Table.merge for 
-00035ba0: 6d6f 7265 2064 6574 6169 6c73 292e 0a0a  more details)...
-00035bb0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-00035bc0: 2020 2020 2020 203e 3e3e 2074 6172 6765         >>> targe
-00035bd0: 745f 6466 203d 2073 6573 7369 6f6e 2e63  t_df = session.c
-00035be0: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
-00035bf0: 5b28 3130 2c20 226f 6c64 2229 2c20 2831  [(10, "old"), (1
-00035c00: 302c 2022 746f 6f5f 6f6c 6422 292c 2028  0, "too_old"), (
-00035c10: 3131 2c20 226f 6c64 2229 5d2c 2073 6368  11, "old")], sch
-00035c20: 656d 613d 5b22 6b65 7922 2c20 2276 616c  ema=["key", "val
-00035c30: 7565 225d 290a 2020 2020 2020 2020 3e3e  ue"]).        >>
-00035c40: 3e20 7461 7267 6574 5f64 662e 7772 6974  > target_df.writ
-00035c50: 652e 7361 7665 5f61 735f 7461 626c 6528  e.save_as_table(
-00035c60: 226d 795f 7461 626c 6522 2c20 6d6f 6465  "my_table", mode
-00035c70: 3d22 6f76 6572 7772 6974 6522 2c20 7461  ="overwrite", ta
-00035c80: 626c 655f 7479 7065 3d22 7465 6d70 6f72  ble_type="tempor
-00035c90: 6172 7922 290a 2020 2020 2020 2020 3e3e  ary").        >>
-00035ca0: 3e20 7461 7267 6574 203d 2073 6573 7369  > target = sessi
-00035cb0: 6f6e 2e74 6162 6c65 2822 6d79 5f74 6162  on.table("my_tab
-00035cc0: 6c65 2229 0a20 2020 2020 2020 203e 3e3e  le").        >>>
-00035cd0: 2073 6f75 7263 6520 3d20 7365 7373 696f   source = sessio
-00035ce0: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
-00035cf0: 6d65 285b 2831 302c 2022 6e65 7722 292c  me([(10, "new"),
-00035d00: 2028 3132 2c20 226e 6577 2229 2c20 2831   (12, "new"), (1
-00035d10: 332c 2022 6f6c 6422 295d 2c20 7363 6865  3, "old")], sche
-00035d20: 6d61 3d5b 226b 6579 222c 2022 7661 6c75  ma=["key", "valu
-00035d30: 6522 5d29 0a20 2020 2020 2020 203e 3e3e  e"]).        >>>
-00035d40: 2074 6172 6765 742e 6d65 7267 6528 736f   target.merge(so
-00035d50: 7572 6365 2c20 2874 6172 6765 745b 226b  urce, (target["k
-00035d60: 6579 225d 203d 3d20 736f 7572 6365 5b22  ey"] == source["
-00035d70: 6b65 7922 5d29 2026 2028 7461 7267 6574  key"]) & (target
-00035d80: 5b22 7661 6c75 6522 5d20 3d3d 2022 746f  ["value"] == "to
-00035d90: 6f5f 6f6c 6422 292c 0a20 2020 2020 2020  o_old"),.       
-00035da0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00035db0: 2020 5b77 6865 6e5f 6e6f 745f 6d61 7463    [when_not_matc
-00035dc0: 6865 6428 292e 696e 7365 7274 287b 226b  hed().insert({"k
-00035dd0: 6579 223a 2073 6f75 7263 655b 226b 6579  ey": source["key
-00035de0: 225d 7d29 5d29 0a20 2020 2020 2020 204d  "]})]).        M
-00035df0: 6572 6765 5265 7375 6c74 2872 6f77 735f  ergeResult(rows_
-00035e00: 696e 7365 7274 6564 3d32 2c20 726f 7773  inserted=2, rows
-00035e10: 5f75 7064 6174 6564 3d30 2c20 726f 7773  _updated=0, rows
-00035e20: 5f64 656c 6574 6564 3d30 290a 2020 2020  _deleted=0).    
-00035e30: 2020 2020 3e3e 3e20 7461 7267 6574 2e73      >>> target.s
-00035e40: 6f72 7428 636f 6c28 226b 6579 2229 2c20  ort(col("key"), 
-00035e50: 636f 6c28 2276 616c 7565 2229 292e 636f  col("value")).co
-00035e60: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00035e70: 5b52 6f77 284b 4559 3d31 302c 2056 414c  [Row(KEY=10, VAL
-00035e80: 5545 3d27 6f6c 6427 292c 2052 6f77 284b  UE='old'), Row(K
-00035e90: 4559 3d31 302c 2056 414c 5545 3d27 746f  EY=10, VALUE='to
-00035ea0: 6f5f 6f6c 6427 292c 2052 6f77 284b 4559  o_old'), Row(KEY
-00035eb0: 3d31 312c 2056 414c 5545 3d27 6f6c 6427  =11, VALUE='old'
-00035ec0: 292c 2052 6f77 284b 4559 3d31 322c 2056  ), Row(KEY=12, V
-00035ed0: 414c 5545 3d4e 6f6e 6529 2c20 526f 7728  ALUE=None), Row(
-00035ee0: 4b45 593d 3133 2c20 5641 4c55 453d 4e6f  KEY=13, VALUE=No
-00035ef0: 6e65 295d 0a20 2020 2022 2222 0a20 2020  ne)].    """.   
-00035f00: 2072 6574 7572 6e20 736e 6f77 666c 616b   return snowflak
-00035f10: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
-00035f20: 2e57 6865 6e4e 6f74 4d61 7463 6865 6443  .WhenNotMatchedC
-00035f30: 6c61 7573 6528 636f 6e64 6974 696f 6e29  lause(condition)
-00035f40: 0a0a 0a64 6566 2075 6466 280a 2020 2020  ...def udf(.    
-00035f50: 6675 6e63 3a20 4f70 7469 6f6e 616c 5b43  func: Optional[C
-00035f60: 616c 6c61 626c 655d 203d 204e 6f6e 652c  allable] = None,
-00035f70: 0a20 2020 202a 2c0a 2020 2020 7265 7475  .    *,.    retu
-00035f80: 726e 5f74 7970 653a 204f 7074 696f 6e61  rn_type: Optiona
-00035f90: 6c5b 4461 7461 5479 7065 5d20 3d20 4e6f  l[DataType] = No
-00035fa0: 6e65 2c0a 2020 2020 696e 7075 745f 7479  ne,.    input_ty
-00035fb0: 7065 733a 204f 7074 696f 6e61 6c5b 4c69  pes: Optional[Li
-00035fc0: 7374 5b44 6174 6154 7970 655d 5d20 3d20  st[DataType]] = 
-00035fd0: 4e6f 6e65 2c0a 2020 2020 6e61 6d65 3a20  None,.    name: 
-00035fe0: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
-00035ff0: 7472 2c20 4974 6572 6162 6c65 5b73 7472  tr, Iterable[str
-00036000: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
-00036010: 6973 5f70 6572 6d61 6e65 6e74 3a20 626f  is_permanent: bo
-00036020: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00036030: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
-00036040: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00036050: 4e6f 6e65 2c0a 2020 2020 696d 706f 7274  None,.    import
-00036060: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-00036070: 5b55 6e69 6f6e 5b73 7472 2c20 5475 706c  [Union[str, Tupl
-00036080: 655b 7374 722c 2073 7472 5d5d 5d5d 203d  e[str, str]]]] =
-00036090: 204e 6f6e 652c 0a20 2020 2070 6163 6b61   None,.    packa
-000360a0: 6765 733a 204f 7074 696f 6e61 6c5b 4c69  ges: Optional[Li
-000360b0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 4d6f  st[Union[str, Mo
-000360c0: 6475 6c65 5479 7065 5d5d 5d20 3d20 4e6f  duleType]]] = No
-000360d0: 6e65 2c0a 2020 2020 7265 706c 6163 653a  ne,.    replace:
-000360e0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-000360f0: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
-00036100: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00036110: 2020 2020 7365 7373 696f 6e3a 204f 7074      session: Opt
-00036120: 696f 6e61 6c5b 2273 6e6f 7766 6c61 6b65  ional["snowflake
-00036130: 2e73 6e6f 7770 6172 6b2e 7365 7373 696f  .snowpark.sessio
-00036140: 6e2e 5365 7373 696f 6e22 5d20 3d20 4e6f  n.Session"] = No
-00036150: 6e65 2c0a 2020 2020 7061 7261 6c6c 656c  ne,.    parallel
-00036160: 3a20 696e 7420 3d20 342c 0a20 2020 206d  : int = 4,.    m
-00036170: 6178 5f62 6174 6368 5f73 697a 653a 204f  ax_batch_size: O
-00036180: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-00036190: 6f6e 652c 0a20 2020 2073 7461 7465 6d65  one,.    stateme
-000361a0: 6e74 5f70 6172 616d 733a 204f 7074 696f  nt_params: Optio
-000361b0: 6e61 6c5b 4469 6374 5b73 7472 2c20 7374  nal[Dict[str, st
-000361c0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-000361d0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
-000361e0: 6c61 793a 2062 6f6f 6c20 3d20 5472 7565  lay: bool = True
-000361f0: 2c0a 2020 2020 7374 7269 6374 3a20 626f  ,.    strict: bo
-00036200: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00036210: 7365 6375 7265 3a20 626f 6f6c 203d 2046  secure: bool = F
-00036220: 616c 7365 2c0a 2920 2d3e 2055 6e69 6f6e  alse,.) -> Union
-00036230: 5b55 7365 7244 6566 696e 6564 4675 6e63  [UserDefinedFunc
-00036240: 7469 6f6e 2c20 6675 6e63 746f 6f6c 732e  tion, functools.
-00036250: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
-00036260: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
-00036270: 686f 6e20 6675 6e63 7469 6f6e 2061 7320  hon function as 
-00036280: 6120 536e 6f77 666c 616b 6520 5079 7468  a Snowflake Pyth
-00036290: 6f6e 2055 4446 2061 6e64 2072 6574 7572  on UDF and retur
-000362a0: 6e73 2074 6865 2055 4446 2e0a 0a20 2020  ns the UDF...   
-000362b0: 2049 7420 6361 6e20 6265 2075 7365 6420   It can be used 
-000362c0: 6173 2065 6974 6865 7220 6120 6675 6e63  as either a func
-000362d0: 7469 6f6e 2063 616c 6c20 6f72 2061 2064  tion call or a d
-000362e0: 6563 6f72 6174 6f72 2e20 496e 206d 6f73  ecorator. In mos
-000362f0: 7420 6361 7365 7320 796f 7520 776f 726b  t cases you work
-00036300: 2077 6974 6820 6120 7369 6e67 6c65 2073   with a single s
-00036310: 6573 7369 6f6e 2e0a 2020 2020 5468 6973  ession..    This
-00036320: 2066 756e 6374 696f 6e20 7573 6573 2074   function uses t
-00036330: 6861 7420 7365 7373 696f 6e20 746f 2072  hat session to r
-00036340: 6567 6973 7465 7220 7468 6520 5544 462e  egister the UDF.
-00036350: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
-00036360: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
-00036370: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
-00036380: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
-00036390: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
-000363a0: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
-000363b0: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
-000363c0: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
-000363d0: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
-000363e0: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
-000363f0: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
-00036400: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
-00036410: 7365 2060 6073 6573 7369 6f6e 2e75 6466  se ``session.udf
-00036420: 2e72 6567 6973 7465 7260 6020 696e 7374  .register`` inst
-00036430: 6561 642e 2053 6565 2065 7861 6d70 6c65  ead. See example
-00036440: 730a 2020 2020 696e 203a 636c 6173 733a  s.    in :class:
-00036450: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-00036460: 7061 726b 2e75 6466 2e55 4446 5265 6769  park.udf.UDFRegi
-00036470: 7374 7261 7469 6f6e 602e 0a0a 2020 2020  stration`...    
-00036480: 4172 6773 3a0a 2020 2020 2020 2020 6675  Args:.        fu
-00036490: 6e63 3a20 4120 5079 7468 6f6e 2066 756e  nc: A Python fun
-000364a0: 6374 696f 6e20 7573 6564 2066 6f72 2063  ction used for c
-000364b0: 7265 6174 696e 6720 7468 6520 5544 462e  reating the UDF.
-000364c0: 0a20 2020 2020 2020 2072 6574 7572 6e5f  .        return_
-000364d0: 7479 7065 3a20 4120 3a63 6c61 7373 3a60  type: A :class:`
-000364e0: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-000364f0: 6172 6b2e 7479 7065 732e 4461 7461 5479  ark.types.DataTy
-00036500: 7065 6020 7265 7072 6573 656e 7469 6e67  pe` representing
-00036510: 2074 6865 2072 6574 7572 6e20 6461 7461   the return data
-00036520: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
-00036530: 6520 6f66 2074 6865 2055 4446 2e20 4f70  e of the UDF. Op
-00036540: 7469 6f6e 616c 2069 6620 7479 7065 2068  tional if type h
-00036550: 696e 7473 2061 7265 2070 726f 7669 6465  ints are provide
-00036560: 642e 0a20 2020 2020 2020 2069 6e70 7574  d..        input
-00036570: 5f74 7970 6573 3a20 4120 6c69 7374 206f  _types: A list o
-00036580: 6620 3a63 6c61 7373 3a60 7e73 6e6f 7766  f :class:`~snowf
-00036590: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
-000365a0: 7065 732e 4461 7461 5479 7065 600a 2020  pes.DataType`.  
-000365b0: 2020 2020 2020 2020 2020 7265 7072 6573            repres
-000365c0: 656e 7469 6e67 2074 6865 2069 6e70 7574  enting the input
-000365d0: 2064 6174 6120 7479 7065 7320 6f66 2074   data types of t
-000365e0: 6865 2055 4446 2e20 4f70 7469 6f6e 616c  he UDF. Optional
-000365f0: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
-00036600: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
-00036610: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
-00036620: 206e 616d 653a 2041 2073 7472 696e 6720   name: A string 
-00036630: 6f72 206c 6973 7420 6f66 2073 7472 696e  or list of strin
-00036640: 6773 2074 6861 7420 7370 6563 6966 7920  gs that specify 
-00036650: 7468 6520 6e61 6d65 206f 7220 6675 6c6c  the name or full
-00036660: 792d 7175 616c 6966 6965 640a 2020 2020  y-qualified.    
-00036670: 2020 2020 2020 2020 6f62 6a65 6374 2069          object i
-00036680: 6465 6e74 6966 6965 7220 2864 6174 6162  dentifier (datab
-00036690: 6173 6520 6e61 6d65 2c20 7363 6865 6d61  ase name, schema
-000366a0: 206e 616d 652c 2061 6e64 2066 756e 6374   name, and funct
-000366b0: 696f 6e20 6e61 6d65 2920 666f 720a 2020  ion name) for.  
-000366c0: 2020 2020 2020 2020 2020 7468 6520 5544            the UD
-000366d0: 4620 696e 2053 6e6f 7766 6c61 6b65 2c20  F in Snowflake, 
-000366e0: 7768 6963 6820 616c 6c6f 7773 2079 6f75  which allows you
-000366f0: 2074 6f20 6361 6c6c 2074 6869 7320 5544   to call this UD
-00036700: 4620 696e 2061 2053 514c 0a20 2020 2020  F in a SQL.     
-00036710: 2020 2020 2020 2063 6f6d 6d61 6e64 206f         command o
-00036720: 7220 7669 6120 3a66 756e 633a 6063 616c  r via :func:`cal
-00036730: 6c5f 7564 6628 2960 2e20 4966 2069 7420  l_udf()`. If it 
-00036740: 6973 206e 6f74 2070 726f 7669 6465 642c  is not provided,
-00036750: 2061 206e 616d 6520 7769 6c6c 0a20 2020   a name will.   
-00036760: 2020 2020 2020 2020 2062 6520 6175 746f           be auto
-00036770: 6d61 7469 6361 6c6c 7920 6765 6e65 7261  matically genera
-00036780: 7465 6420 666f 7220 7468 6520 5544 462e  ted for the UDF.
-00036790: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
-000367a0: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
-000367b0: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
-000367c0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
-000367d0: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
-000367e0: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
-000367f0: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
-00036800: 2061 2070 6572 6d61 6e65 6e74 2055 4446   a permanent UDF
-00036810: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-00036820: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
-00036830: 2020 2020 2020 2020 4966 2069 7420 6973          If it is
-00036840: 2060 6054 7275 6560 602c 2061 2076 616c   ``True``, a val
-00036850: 6964 2060 6073 7461 6765 5f6c 6f63 6174  id ``stage_locat
-00036860: 696f 6e60 6020 6d75 7374 2062 6520 7072  ion`` must be pr
-00036870: 6f76 6964 6564 2e0a 2020 2020 2020 2020  ovided..        
-00036880: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
-00036890: 5468 6520 7374 6167 6520 6c6f 6361 7469  The stage locati
-000368a0: 6f6e 2077 6865 7265 2074 6865 2050 7974  on where the Pyt
-000368b0: 686f 6e20 6669 6c65 2066 6f72 2074 6865  hon file for the
-000368c0: 2055 4446 0a20 2020 2020 2020 2020 2020   UDF.           
-000368d0: 2061 6e64 2069 7473 2064 6570 656e 6465   and its depende
-000368e0: 6e63 6965 7320 7368 6f75 6c64 2062 6520  ncies should be 
-000368f0: 7570 6c6f 6164 6564 2e20 5468 6520 7374  uploaded. The st
-00036900: 6167 6520 6c6f 6361 7469 6f6e 206d 7573  age location mus
-00036910: 7420 6265 2073 7065 6369 6669 6564 0a20  t be specified. 
-00036920: 2020 2020 2020 2020 2020 2077 6865 6e20             when 
-00036930: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
-00036940: 2069 7320 6060 5472 7565 6060 2c20 616e   is ``True``, an
-00036950: 6420 6974 2077 696c 6c20 6265 2069 676e  d it will be ign
-00036960: 6f72 6564 2077 6865 6e0a 2020 2020 2020  ored when.      
-00036970: 2020 2020 2020 6060 6973 5f70 6572 6d61        ``is_perma
-00036980: 6e65 6e74 6060 2069 7320 6060 4661 6c73  nent`` is ``Fals
-00036990: 6560 602e 2049 7420 6361 6e20 6265 2061  e``. It can be a
-000369a0: 6e79 2073 7461 6765 206f 7468 6572 2074  ny stage other t
-000369b0: 6861 6e20 7465 6d70 6f72 6172 790a 2020  han temporary.  
-000369c0: 2020 2020 2020 2020 2020 7374 6167 6573            stages
-000369d0: 2061 6e64 2065 7874 6572 6e61 6c20 7374   and external st
-000369e0: 6167 6573 2e0a 2020 2020 2020 2020 696d  ages..        im
-000369f0: 706f 7274 733a 2041 206c 6973 7420 6f66  ports: A list of
-00036a00: 2069 6d70 6f72 7473 2074 6861 7420 6f6e   imports that on
-00036a10: 6c79 2061 7070 6c79 2074 6f20 7468 6973  ly apply to this
-00036a20: 2055 4446 2e20 596f 7520 6361 6e20 7573   UDF. You can us
-00036a30: 6520 6120 7374 7269 6e67 2074 6f0a 2020  e a string to.  
-00036a40: 2020 2020 2020 2020 2020 7265 7072 6573            repres
-00036a50: 656e 7420 6120 6669 6c65 2070 6174 6820  ent a file path 
-00036a60: 2873 696d 696c 6172 2074 6f20 7468 6520  (similar to the 
-00036a70: 6060 7061 7468 6060 2061 7267 756d 656e  ``path`` argumen
-00036a80: 7420 696e 0a20 2020 2020 2020 2020 2020  t in.           
-00036a90: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
-00036aa0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
-00036ab0: 696f 6e2e 6164 645f 696d 706f 7274 6029  ion.add_import`)
-00036ac0: 2069 6e20 7468 6973 206c 6973 742c 206f   in this list, o
-00036ad0: 7220 6120 7475 706c 6520 6f66 2074 776f  r a tuple of two
-00036ae0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00036af0: 696e 6773 2074 6f20 7265 7072 6573 656e  ings to represen
-00036b00: 7420 6120 6669 6c65 2070 6174 6820 616e  t a file path an
-00036b10: 6420 616e 2069 6d70 6f72 7420 7061 7468  d an import path
-00036b20: 2028 7369 6d69 6c61 7220 746f 2074 6865   (similar to the
-00036b30: 2060 6069 6d70 6f72 745f 7061 7468 6060   ``import_path``
-00036b40: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-00036b50: 756d 656e 7420 696e 203a 6d65 7468 3a60  ument in :meth:`
-00036b60: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00036b70: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
-00036b80: 696d 706f 7274 6029 2e20 5468 6573 6520  import`). These 
-00036b90: 5544 462d 6c65 7665 6c20 696d 706f 7274  UDF-level import
-00036ba0: 730a 2020 2020 2020 2020 2020 2020 7769  s.            wi
-00036bb0: 6c6c 206f 7665 7272 6964 6520 7468 6520  ll override the 
-00036bc0: 7365 7373 696f 6e2d 6c65 7665 6c20 696d  session-level im
-00036bd0: 706f 7274 7320 6164 6465 6420 6279 0a20  ports added by. 
-00036be0: 2020 2020 2020 2020 2020 203a 6d65 7468             :meth
-00036bf0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-00036c00: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
-00036c10: 645f 696d 706f 7274 602e 204e 6f74 6520  d_import`. Note 
-00036c20: 7468 6174 2061 6e20 656d 7074 7920 6c69  that an empty li
-00036c30: 7374 206d 6561 6e73 0a20 2020 2020 2020  st means.       
-00036c40: 2020 2020 206e 6f20 696d 706f 7274 2066       no import f
-00036c50: 6f72 2074 6869 7320 5544 462c 2061 6e64  or this UDF, and
-00036c60: 2060 604e 6f6e 6560 6020 6f72 206e 6f74   ``None`` or not
-00036c70: 2073 7065 6369 6679 696e 6720 7468 6973   specifying this
-00036c80: 2070 6172 616d 6574 6572 206d 6561 6e73   parameter means
-00036c90: 2075 7369 6e67 0a20 2020 2020 2020 2020   using.         
-00036ca0: 2020 2073 6573 7369 6f6e 2d6c 6576 656c     session-level
-00036cb0: 2069 6d70 6f72 7473 2e0a 2020 2020 2020   imports..      
-00036cc0: 2020 7061 636b 6167 6573 3a20 4120 6c69    packages: A li
-00036cd0: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
-00036ce0: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
-00036cf0: 6f20 7468 6973 2055 4446 2e20 5468 6573  o this UDF. Thes
-00036d00: 6520 5544 462d 6c65 7665 6c20 7061 636b  e UDF-level pack
-00036d10: 6167 6573 0a20 2020 2020 2020 2020 2020  ages.           
-00036d20: 2077 696c 6c20 6f76 6572 7269 6465 2074   will override t
-00036d30: 6865 2073 6573 7369 6f6e 2d6c 6576 656c  he session-level
-00036d40: 2070 6163 6b61 6765 7320 6164 6465 6420   packages added 
-00036d50: 6279 0a20 2020 2020 2020 2020 2020 203a  by.            :
-00036d60: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
-00036d70: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
-00036d80: 6e2e 6164 645f 7061 636b 6167 6573 6020  n.add_packages` 
-00036d90: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00036da0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
-00036db0: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
-00036dc0: 6f6e 2e61 6464 5f72 6571 7569 7265 6d65  on.add_requireme
-00036dd0: 6e74 7360 2e20 4e6f 7465 2074 6861 7420  nts`. Note that 
-00036de0: 616e 2065 6d70 7479 206c 6973 7420 6d65  an empty list me
-00036df0: 616e 730a 2020 2020 2020 2020 2020 2020  ans.            
-00036e00: 6e6f 2070 6163 6b61 6765 2066 6f72 2074  no package for t
-00036e10: 6869 7320 5544 462c 2061 6e64 2060 604e  his UDF, and ``N
-00036e20: 6f6e 6560 6020 6f72 206e 6f74 2073 7065  one`` or not spe
-00036e30: 6369 6679 696e 6720 7468 6973 2070 6172  cifying this par
-00036e40: 616d 6574 6572 206d 6561 6e73 2075 7369  ameter means usi
-00036e50: 6e67 0a20 2020 2020 2020 2020 2020 2073  ng.            s
-00036e60: 6573 7369 6f6e 2d6c 6576 656c 2070 6163  ession-level pac
-00036e70: 6b61 6765 732e 0a20 2020 2020 2020 2072  kages..        r
-00036e80: 6570 6c61 6365 3a20 5768 6574 6865 7220  eplace: Whether 
-00036e90: 746f 2072 6570 6c61 6365 2061 2055 4446  to replace a UDF
-00036ea0: 2074 6861 7420 616c 7265 6164 7920 7761   that already wa
-00036eb0: 7320 7265 6769 7374 6572 6564 2e20 5468  s registered. Th
-00036ec0: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
-00036ed0: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
-00036ee0: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
-00036ef0: 616c 7365 6060 2c20 6174 7465 6d70 7469  alse``, attempti
-00036f00: 6e67 2074 6f20 7265 6769 7374 6572 2061  ng to register a
-00036f10: 2055 4446 2077 6974 6820 6120 6e61 6d65   UDF with a name
-00036f20: 2074 6861 7420 616c 7265 6164 7920 6578   that already ex
-00036f30: 6973 7473 0a20 2020 2020 2020 2020 2020  ists.           
-00036f40: 2072 6573 756c 7473 2069 6e20 6120 6060   results in a ``
-00036f50: 536e 6f77 7061 726b 5351 4c45 7863 6570  SnowparkSQLExcep
-00036f60: 7469 6f6e 6060 2065 7863 6570 7469 6f6e  tion`` exception
-00036f70: 2062 6569 6e67 2074 6872 6f77 6e2e 2049   being thrown. I
-00036f80: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
-00036f90: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
-00036fa0: 2065 7869 7374 696e 6720 5544 4620 7769   existing UDF wi
-00036fb0: 7468 2074 6865 2073 616d 6520 6e61 6d65  th the same name
-00036fc0: 2069 7320 6f76 6572 7772 6974 7465 6e2e   is overwritten.
-00036fd0: 0a20 2020 2020 2020 2069 665f 6e6f 745f  .        if_not_
-00036fe0: 6578 6973 7473 3a20 5768 6574 6865 7220  exists: Whether 
-00036ff0: 746f 2073 6b69 7020 6372 6561 7469 6f6e  to skip creation
-00037000: 206f 6620 6120 5544 4620 7768 656e 206f   of a UDF when o
-00037010: 6e65 2077 6974 6820 7468 6520 7361 6d65  ne with the same
-00037020: 2073 6967 6e61 7475 7265 2061 6c72 6561   signature alrea
-00037030: 6479 2065 7869 7374 732e 0a20 2020 2020  dy exists..     
-00037040: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
-00037050: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-00037060: 2060 6069 665f 6e6f 745f 6578 6973 7473   ``if_not_exists
-00037070: 6060 2061 6e64 2060 6072 6570 6c61 6365  `` and ``replace
-00037080: 6060 2061 7265 206d 7574 7561 6c6c 7920  `` are mutually 
-00037090: 6578 636c 7573 6976 650a 2020 2020 2020  exclusive.      
-000370a0: 2020 2020 2020 616e 6420 6120 6060 5661        and a ``Va
-000370b0: 6c75 6545 7272 6f72 6060 2069 7320 7261  lueError`` is ra
-000370c0: 6973 6564 2077 6865 6e20 626f 7468 2061  ised when both a
-000370d0: 7265 2073 6574 2e20 4966 2069 7420 6973  re set. If it is
-000370e0: 2060 6054 7275 6560 6020 616e 6420 6120   ``True`` and a 
-000370f0: 5544 4620 7769 7468 0a20 2020 2020 2020  UDF with.       
-00037100: 2020 2020 2074 6865 2073 616d 6520 7369       the same si
-00037110: 676e 6174 7572 6520 6578 6973 7473 2c20  gnature exists, 
-00037120: 7468 6520 5544 4620 6372 6561 7469 6f6e  the UDF creation
-00037130: 2069 7320 736b 6970 7065 642e 0a20 2020   is skipped..   
-00037140: 2020 2020 2073 6573 7369 6f6e 3a20 5573       session: Us
-00037150: 6520 7468 6973 2073 6573 7369 6f6e 2074  e this session t
-00037160: 6f20 7265 6769 7374 6572 2074 6865 2055  o register the U
-00037170: 4446 2e20 4966 2069 7427 7320 6e6f 7420  DF. If it's not 
-00037180: 7370 6563 6966 6965 642c 2074 6865 2073  specified, the s
-00037190: 6573 7369 6f6e 2074 6861 7420 796f 7520  ession that you 
-000371a0: 6372 6561 7465 6420 6265 666f 7265 2063  created before c
-000371b0: 616c 6c69 6e67 2074 6869 7320 6675 6e63  alling this func
-000371c0: 7469 6f6e 2077 696c 6c20 6265 2075 7365  tion will be use
-000371d0: 642e 0a20 2020 2020 2020 2020 2020 2059  d..            Y
-000371e0: 6f75 206e 6565 6420 746f 2073 7065 6369  ou need to speci
-000371f0: 6679 2074 6869 7320 7061 7261 6d65 7465  fy this paramete
-00037200: 7220 6966 2079 6f75 2068 6176 6520 6372  r if you have cr
-00037210: 6561 7465 6420 6d75 6c74 6970 6c65 2073  eated multiple s
-00037220: 6573 7369 6f6e 7320 6265 666f 7265 2063  essions before c
-00037230: 616c 6c69 6e67 2074 6869 7320 6d65 7468  alling this meth
-00037240: 6f64 2e0a 2020 2020 2020 2020 7061 7261  od..        para
-00037250: 6c6c 656c 3a20 5468 6520 6e75 6d62 6572  llel: The number
-00037260: 206f 6620 7468 7265 6164 7320 746f 2075   of threads to u
-00037270: 7365 2066 6f72 2075 706c 6f61 6469 6e67  se for uploading
-00037280: 2055 4446 2066 696c 6573 2077 6974 6820   UDF files with 
-00037290: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-000372a0: 6050 5554 203c 6874 7470 733a 2f2f 646f  `PUT <https://do
-000372b0: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
-000372c0: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
-000372d0: 652f 7371 6c2f 7075 742e 6874 6d6c 2370  e/sql/put.html#p
-000372e0: 7574 3e60 5f0a 2020 2020 2020 2020 2020  ut>`_.          
-000372f0: 2020 636f 6d6d 616e 642e 2054 6865 2064    command. The d
-00037300: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-00037310: 3420 616e 6420 7375 7070 6f72 7465 6420  4 and supported 
-00037320: 7661 6c75 6573 2061 7265 2066 726f 6d20  values are from 
-00037330: 3120 746f 2039 392e 0a20 2020 2020 2020  1 to 99..       
-00037340: 2020 2020 2049 6e63 7265 6173 696e 6720       Increasing 
-00037350: 7468 6520 6e75 6d62 6572 206f 6620 7468  the number of th
-00037360: 7265 6164 7320 6361 6e20 696d 7072 6f76  reads can improv
-00037370: 6520 7065 7266 6f72 6d61 6e63 6520 7768  e performance wh
-00037380: 656e 2075 706c 6f61 6469 6e67 0a20 2020  en uploading.   
-00037390: 2020 2020 2020 2020 206c 6172 6765 2055           large U
-000373a0: 4446 2066 696c 6573 2e0a 2020 2020 2020  DF files..      
-000373b0: 2020 6d61 785f 6261 7463 685f 7369 7a65    max_batch_size
-000373c0: 3a20 5468 6520 6d61 7869 6d75 6d20 6e75  : The maximum nu
-000373d0: 6d62 6572 206f 6620 726f 7773 2070 6572  mber of rows per
-000373e0: 2069 6e70 7574 2050 616e 6461 7320 4461   input Pandas Da
-000373f0: 7461 4672 616d 6520 6f72 2050 616e 6461  taFrame or Panda
-00037400: 7320 5365 7269 6573 0a20 2020 2020 2020  s Series.       
-00037410: 2020 2020 2069 6e73 6964 6520 6120 7665       inside a ve
-00037420: 6374 6f72 697a 6564 2055 4446 2e20 4265  ctorized UDF. Be
-00037430: 6361 7573 6520 6120 7665 6374 6f72 697a  cause a vectoriz
-00037440: 6564 2055 4446 2077 696c 6c20 6265 2065  ed UDF will be e
-00037450: 7865 6375 7465 6420 7769 7468 696e 2061  xecuted within a
-00037460: 2074 696d 6520 6c69 6d69 742c 0a20 2020   time limit,.   
-00037470: 2020 2020 2020 2020 2077 6869 6368 2069           which i
-00037480: 7320 6036 3060 2073 6563 6f6e 6473 2c20  s `60` seconds, 
-00037490: 7468 6973 206f 7074 696f 6e61 6c20 6172  this optional ar
-000374a0: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
-000374b0: 6564 2074 6f20 7265 6475 6365 2074 6865  ed to reduce the
-000374c0: 2072 756e 6e69 6e67 2074 696d 6520 6f66   running time of
-000374d0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
-000374e0: 7279 2062 6174 6368 2062 7920 7365 7474  ry batch by sett
-000374f0: 696e 6720 6120 736d 616c 6c65 7220 6261  ing a smaller ba
-00037500: 7463 6820 7369 7a65 2e20 4e6f 7465 2074  tch size. Note t
-00037510: 6861 7420 7365 7474 696e 6720 6120 6c61  hat setting a la
-00037520: 7267 6572 2076 616c 7565 2064 6f65 7320  rger value does 
-00037530: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
-00037540: 6775 6172 616e 7465 6520 7468 6174 2053  guarantee that S
-00037550: 6e6f 7766 6c61 6b65 2077 696c 6c20 656e  nowflake will en
-00037560: 636f 6465 2062 6174 6368 6573 2077 6974  code batches wit
-00037570: 6820 7468 6520 7370 6563 6966 6965 6420  h the specified 
-00037580: 6e75 6d62 6572 206f 6620 726f 7773 2e20  number of rows. 
-00037590: 4974 2077 696c 6c0a 2020 2020 2020 2020  It will.        
-000375a0: 2020 2020 6265 2069 676e 6f72 6564 2077      be ignored w
-000375b0: 6865 6e20 7265 6769 7374 6572 696e 6720  hen registering 
-000375c0: 6120 6e6f 6e2d 7665 6374 6f72 697a 6564  a non-vectorized
-000375d0: 2055 4446 2e0a 2020 2020 2020 2020 7374   UDF..        st
-000375e0: 6174 656d 656e 745f 7061 7261 6d73 3a20  atement_params: 
-000375f0: 4469 6374 696f 6e61 7279 206f 6620 7374  Dictionary of st
-00037600: 6174 656d 656e 7420 6c65 7665 6c20 7061  atement level pa
-00037610: 7261 6d65 7465 7273 2074 6f20 6265 2073  rameters to be s
-00037620: 6574 2077 6869 6c65 2065 7865 6375 7469  et while executi
-00037630: 6e67 2074 6869 7320 6163 7469 6f6e 2e0a  ng this action..
-00037640: 2020 2020 2020 2020 736f 7572 6365 5f63          source_c
-00037650: 6f64 655f 6469 7370 6c61 793a 2044 6973  ode_display: Dis
-00037660: 706c 6179 2074 6865 2073 6f75 7263 6520  play the source 
-00037670: 636f 6465 206f 6620 7468 6520 5544 4620  code of the UDF 
-00037680: 6066 756e 6360 2061 7320 636f 6d6d 656e  `func` as commen
-00037690: 7473 2069 6e20 7468 6520 6765 6e65 7261  ts in the genera
-000376a0: 7465 6420 7363 7269 7074 2e0a 2020 2020  ted script..    
-000376b0: 2020 2020 2020 2020 5468 6520 736f 7572          The sour
-000376c0: 6365 2063 6f64 6520 6973 2064 796e 616d  ce code is dynam
-000376d0: 6963 616c 6c79 2067 656e 6572 6174 6564  ically generated
-000376e0: 2074 6865 7265 666f 7265 2069 7420 6d61   therefore it ma
-000376f0: 7920 6e6f 7420 6265 2069 6465 6e74 6963  y not be identic
-00037700: 616c 2074 6f20 686f 7720 7468 650a 2020  al to how the.  
-00037710: 2020 2020 2020 2020 2020 6066 756e 6360            `func`
-00037720: 2069 7320 6f72 6967 696e 616c 6c79 2064   is originally d
-00037730: 6566 696e 6564 2e20 5468 6520 6465 6661  efined. The defa
-00037740: 756c 7420 6973 2060 6054 7275 6560 602e  ult is ``True``.
-00037750: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00037760: 6974 2069 7320 6060 4661 6c73 6560 602c  it is ``False``,
-00037770: 2073 6f75 7263 6520 636f 6465 2077 696c   source code wil
-00037780: 6c20 6e6f 7420 6265 2067 656e 6572 6174  l not be generat
-00037790: 6564 206f 7220 6469 7370 6c61 7965 642e  ed or displayed.
-000377a0: 0a20 2020 2020 2020 2073 7472 6963 743a  .        strict:
-000377b0: 2057 6865 7468 6572 2074 6865 2063 7265   Whether the cre
-000377c0: 6174 6564 2055 4446 2069 7320 7374 7269  ated UDF is stri
-000377d0: 6374 2e20 4120 7374 7269 6374 2055 4446  ct. A strict UDF
-000377e0: 2077 696c 6c20 6e6f 7420 696e 766f 6b65   will not invoke
-000377f0: 2074 6865 2055 4446 2069 6620 616e 7920   the UDF if any 
-00037800: 696e 7075 7420 6973 0a20 2020 2020 2020  input is.       
-00037810: 2020 2020 206e 756c 6c2e 2049 6e73 7465       null. Inste
-00037820: 6164 2c20 6120 6e75 6c6c 2076 616c 7565  ad, a null value
-00037830: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
-00037840: 7265 7475 726e 6564 2066 6f72 2074 6861  returned for tha
-00037850: 7420 726f 772e 204e 6f74 6520 7468 6174  t row. Note that
-00037860: 2074 6865 2055 4446 206d 6967 6874 0a20   the UDF might. 
-00037870: 2020 2020 2020 2020 2020 2073 7469 6c6c             still
-00037880: 2072 6574 7572 6e20 6e75 6c6c 2066 6f72   return null for
-00037890: 206e 6f6e 2d6e 756c 6c20 696e 7075 7473   non-null inputs
-000378a0: 2e0a 2020 2020 2020 2020 7365 6375 7265  ..        secure
-000378b0: 3a20 5768 6574 6865 7220 7468 6520 6372  : Whether the cr
-000378c0: 6561 7465 6420 5544 4620 6973 2073 6563  eated UDF is sec
-000378d0: 7572 652e 2046 6f72 206d 6f72 6520 696e  ure. For more in
-000378e0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
-000378f0: 7365 6375 7265 2066 756e 6374 696f 6e73  secure functions
-00037900: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00037910: 6520 6053 6563 7572 6520 5544 4673 203c  e `Secure UDFs <
-00037920: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
-00037930: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
-00037940: 6c2d 7265 6665 7265 6e63 652f 7564 662d  l-reference/udf-
-00037950: 7365 6375 7265 2e68 746d 6c3e 605f 2e0a  secure.html>`_..
-00037960: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
-00037970: 2020 2020 2020 4120 5544 4620 6675 6e63        A UDF func
-00037980: 7469 6f6e 2074 6861 7420 6361 6e20 6265  tion that can be
-00037990: 2063 616c 6c65 6420 7769 7468 203a 636c   called with :cl
-000379a0: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
-000379b0: 736e 6f77 7061 726b 2e43 6f6c 756d 6e60  snowpark.Column`
-000379c0: 2065 7870 7265 7373 696f 6e73 2e0a 0a20   expressions... 
-000379d0: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
-000379e0: 2031 2e20 5768 656e 2074 7970 6520 6869   1. When type hi
-000379f0: 6e74 7320 6172 6520 7072 6f76 6964 6564  nts are provided
-00037a00: 2061 6e64 2061 7265 2063 6f6d 706c 6574   and are complet
-00037a10: 6520 666f 7220 6120 6675 6e63 7469 6f6e  e for a function
-00037a20: 2c0a 2020 2020 2020 2020 6060 7265 7475  ,.        ``retu
-00037a30: 726e 5f74 7970 6560 6020 616e 6420 6060  rn_type`` and ``
-00037a40: 696e 7075 745f 7479 7065 7360 6020 6172  input_types`` ar
-00037a50: 6520 6f70 7469 6f6e 616c 2061 6e64 2077  e optional and w
-00037a60: 696c 6c20 6265 2069 676e 6f72 6564 2e0a  ill be ignored..
-00037a70: 2020 2020 2020 2020 5365 6520 6465 7461          See deta
-00037a80: 696c 7320 6f66 2073 7570 706f 7274 6564  ils of supported
-00037a90: 2064 6174 6120 7479 7065 7320 666f 7220   data types for 
-00037aa0: 5544 4673 2069 6e0a 2020 2020 2020 2020  UDFs in.        
-00037ab0: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
-00037ac0: 6b65 2e73 6e6f 7770 6172 6b2e 7564 662e  ke.snowpark.udf.
-00037ad0: 5544 4652 6567 6973 7472 6174 696f 6e60  UDFRegistration`
-00037ae0: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00037af0: 2059 6f75 2063 616e 2075 7365 2075 7365   You can use use
-00037b00: 203a 6174 7472 3a60 7e73 6e6f 7766 6c61   :attr:`~snowfla
-00037b10: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-00037b20: 732e 5661 7269 616e 7460 2074 6f0a 2020  s.Variant` to.  
-00037b30: 2020 2020 2020 2020 2020 2020 616e 6e6f              anno
-00037b40: 7461 7465 2061 2076 6172 6961 6e74 2c20  tate a variant, 
-00037b50: 616e 6420 7573 6520 3a61 7474 723a 607e  and use :attr:`~
-00037b60: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-00037b70: 726b 2e74 7970 6573 2e47 656f 6772 6170  rk.types.Geograp
-00037b80: 6879 600a 2020 2020 2020 2020 2020 2020  hy`.            
-00037b90: 2020 746f 2061 6e6e 6f74 6174 6520 6120    to annotate a 
-00037ba0: 6765 6f67 7261 7068 7920 7768 656e 2064  geography when d
-00037bb0: 6566 696e 696e 6720 6120 5544 462e 0a0a  efining a UDF...
-00037bc0: 2020 2020 2020 2020 2020 2020 2d20 596f              - Yo
-00037bd0: 7520 6361 6e20 7573 6520 7573 6520 3a61  u can use use :a
-00037be0: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
-00037bf0: 736e 6f77 7061 726b 2e74 7970 6573 2e50  snowpark.types.P
-00037c00: 616e 6461 7353 6572 6965 7360 2074 6f20  andasSeries` to 
-00037c10: 616e 6e6f 7461 7465 0a20 2020 2020 2020  annotate.       
-00037c20: 2020 2020 2020 2061 2050 616e 6461 7320         a Pandas 
-00037c30: 5365 7269 6573 2c20 616e 6420 7573 6520  Series, and use 
-00037c40: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
-00037c50: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00037c60: 2e50 616e 6461 7344 6174 6146 7261 6d65  .PandasDataFrame
-00037c70: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-00037c80: 746f 2061 6e6e 6f74 6174 6520 6120 5061  to annotate a Pa
-00037c90: 6e64 6173 2044 6174 6146 7261 6d65 2077  ndas DataFrame w
-00037ca0: 6865 6e20 6465 6669 6e69 6e67 2061 2076  hen defining a v
-00037cb0: 6563 746f 7269 7a65 6420 5544 462e 0a20  ectorized UDF.. 
-00037cc0: 2020 2020 2020 2020 2020 2020 204e 6f74               Not
-00037cd0: 6520 7468 6174 2074 6865 7920 6172 6520  e that they are 
-00037ce0: 6765 6e65 7269 6320 7479 7065 7320 736f  generic types so
-00037cf0: 2079 6f75 2063 616e 2073 7065 6369 6679   you can specify
-00037d00: 2074 6865 2065 6c65 6d65 6e74 2074 7970   the element typ
-00037d10: 6520 696e 2061 0a20 2020 2020 2020 2020  e in a.         
-00037d20: 2020 2020 2050 616e 6461 7320 5365 7269       Pandas Seri
-00037d30: 6573 2061 6e64 2044 6174 6146 7261 6d65  es and DataFrame
-00037d40: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00037d50: 203a 636c 6173 733a 6074 7970 696e 672e   :class:`typing.
-00037d60: 556e 696f 6e60 2069 7320 6e6f 7420 6120  Union` is not a 
-00037d70: 7661 6c69 6420 7479 7065 2061 6e6e 6f74  valid type annot
-00037d80: 6174 696f 6e20 666f 7220 5544 4673 2c0a  ation for UDFs,.
-00037d90: 2020 2020 2020 2020 2020 2020 2020 6275                bu
-00037da0: 7420 3a63 6c61 7373 3a60 7479 7069 6e67  t :class:`typing
-00037db0: 2e4f 7074 696f 6e61 6c60 2063 616e 2062  .Optional` can b
-00037dc0: 6520 7573 6564 2074 6f20 696e 6469 6361  e used to indica
-00037dd0: 7465 2074 6865 206f 7074 696f 6e61 6c20  te the optional 
-00037de0: 7479 7065 2e0a 0a20 2020 2020 2020 2020  type...         
-00037df0: 2020 202d 2054 7970 6520 6869 6e74 7320     - Type hints 
-00037e00: 6172 6520 6e6f 7420 7375 7070 6f72 7465  are not supporte
-00037e10: 6420 6f6e 2066 756e 6374 696f 6e73 2064  d on functions d
-00037e20: 6563 6f72 6174 6564 2077 6974 6820 6465  ecorated with de
-00037e30: 636f 7261 746f 7273 2e0a 0a20 2020 2020  corators...     
-00037e40: 2020 2032 2e20 4120 7465 6d70 6f72 6172     2. A temporar
-00037e50: 7920 5544 4620 2877 6865 6e20 6060 6973  y UDF (when ``is
-00037e60: 5f70 6572 6d61 6e65 6e74 6060 2069 7320  _permanent`` is 
-00037e70: 6060 4661 6c73 6560 6029 2069 7320 7363  ``False``) is sc
-00037e80: 6f70 6564 2074 6f20 7468 6973 2060 6073  oped to this ``s
-00037e90: 6573 7369 6f6e 6060 0a20 2020 2020 2020  ession``.       
-00037ea0: 2061 6e64 2061 6c6c 2055 4446 2072 656c   and all UDF rel
-00037eb0: 6174 6564 2066 696c 6573 2077 696c 6c20  ated files will 
-00037ec0: 6265 2075 706c 6f61 6465 6420 746f 2061  be uploaded to a
-00037ed0: 2074 656d 706f 7261 7279 2073 6573 7369   temporary sessi
-00037ee0: 6f6e 2073 7461 6765 0a20 2020 2020 2020  on stage.       
-00037ef0: 2028 3a66 756e 633a 6073 6573 7369 6f6e   (:func:`session
-00037f00: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
-00037f10: 6765 2829 203c 736e 6f77 666c 616b 652e  ge() <snowflake.
-00037f20: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
-00037f30: 2e67 6574 5f73 6573 7369 6f6e 5f73 7461  .get_session_sta
-00037f40: 6765 3e60 292e 0a20 2020 2020 2020 2046  ge>`)..        F
-00037f50: 6f72 2061 2070 6572 6d61 6e65 6e74 2055  or a permanent U
-00037f60: 4446 2c20 7468 6573 6520 6669 6c65 7320  DF, these files 
-00037f70: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
-00037f80: 2074 6f20 7468 6520 7374 6167 6520 7468   to the stage th
-00037f90: 6174 2079 6f75 2070 726f 7669 6465 2e0a  at you provide..
-00037fa0: 0a20 2020 2020 2020 2033 2e20 4279 2064  .        3. By d
-00037fb0: 6566 6175 6c74 2c20 5544 4620 7265 6769  efault, UDF regi
-00037fc0: 7374 7261 7469 6f6e 2066 6169 6c73 2069  stration fails i
-00037fd0: 6620 6120 6675 6e63 7469 6f6e 2077 6974  f a function wit
-00037fe0: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
-00037ff0: 6973 2061 6c72 6561 6479 0a20 2020 2020  is already.     
-00038000: 2020 2072 6567 6973 7465 7265 642e 2049     registered. I
-00038010: 6e76 6f6b 696e 6720 3a66 756e 633a 6075  nvoking :func:`u
-00038020: 6466 6020 7769 7468 2060 6072 6570 6c61  df` with ``repla
-00038030: 6365 6060 2073 6574 2074 6f20 6060 5472  ce`` set to ``Tr
-00038040: 7565 6060 2077 696c 6c20 6f76 6572 7772  ue`` will overwr
-00038050: 6974 6520 7468 650a 2020 2020 2020 2020  ite the.        
-00038060: 7072 6576 696f 7573 6c79 2072 6567 6973  previously regis
-00038070: 7465 7265 6420 6675 6e63 7469 6f6e 2e0a  tered function..
-00038080: 0a20 2020 2020 2020 2034 2e20 5768 656e  .        4. When
-00038090: 2072 6567 6973 7465 7269 6e67 2061 2076   registering a v
-000380a0: 6563 746f 7269 7a65 6420 5544 462c 2060  ectorized UDF, `
-000380b0: 6070 616e 6461 7360 6020 6c69 6272 6172  `pandas`` librar
-000380c0: 7920 7769 6c6c 2062 6520 6164 6465 6420  y will be added 
-000380d0: 6173 2061 2070 6163 6b61 6765 0a20 2020  as a package.   
-000380e0: 2020 2020 2061 7574 6f6d 6174 6963 616c       automatical
-000380f0: 6c79 2c20 7769 7468 2074 6865 206c 6174  ly, with the lat
-00038100: 6573 7420 7665 7273 696f 6e20 6f6e 2074  est version on t
-00038110: 6865 2053 6e6f 7766 6c61 6b65 2073 6572  he Snowflake ser
-00038120: 7665 722e 2049 6620 796f 7520 646f 6e27  ver. If you don'
-00038130: 7420 7761 6e74 2074 6f0a 2020 2020 2020  t want to.      
-00038140: 2020 7573 6520 7468 6973 2076 6572 7369    use this versi
-00038150: 6f6e 2c20 796f 7520 6361 6e20 6f76 6572  on, you can over
-00038160: 7772 6974 6520 6974 2062 7920 6164 6469  write it by addi
-00038170: 6e67 2060 7061 6e64 6173 6020 7769 7468  ng `pandas` with
-00038180: 2073 7065 6369 6669 6320 7665 7273 696f   specific versio
-00038190: 6e0a 2020 2020 2020 2020 7265 7175 6972  n.        requir
-000381a0: 656d 656e 7420 7573 696e 6720 6060 7061  ement using ``pa
-000381b0: 636b 6167 6560 6020 6172 6775 6d65 6e74  ckage`` argument
-000381c0: 206f 7220 3a6d 6574 683a 607e 736e 6f77   or :meth:`~snow
-000381d0: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
-000381e0: 6573 7369 6f6e 2e61 6464 5f70 6163 6b61  ession.add_packa
-000381f0: 6765 7360 2e0a 0a20 2020 2053 6565 2041  ges`...    See A
-00038200: 6c73 6f3a 0a20 2020 2020 2020 203a 636c  lso:.        :cl
-00038210: 6173 733a 607e 736e 6f77 666c 616b 652e  ass:`~snowflake.
-00038220: 736e 6f77 7061 726b 2e75 6466 2e55 4446  snowpark.udf.UDF
-00038230: 5265 6769 7374 7261 7469 6f6e 600a 0a20  Registration`.. 
-00038240: 2020 2055 4446 7320 6361 6e20 6265 2063     UDFs can be c
-00038250: 7265 6174 6564 2061 7320 616e 6f6e 796d  reated as anonym
-00038260: 6f75 7320 5544 4673 0a0a 2020 2020 4578  ous UDFs..    Ex
-00038270: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00038280: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-00038290: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-000382a0: 6573 2069 6d70 6f72 7420 496e 7465 6765  es import Intege
-000382b0: 7254 7970 650a 2020 2020 2020 2020 3e3e  rType.        >>
-000382c0: 3e20 6164 645f 6f6e 6520 3d20 7564 6628  > add_one = udf(
-000382d0: 6c61 6d62 6461 2078 3a20 782b 312c 2072  lambda x: x+1, r
-000382e0: 6574 7572 6e5f 7479 7065 3d49 6e74 6567  eturn_type=Integ
-000382f0: 6572 5479 7065 2829 2c20 696e 7075 745f  erType(), input_
-00038300: 7479 7065 733d 5b49 6e74 6567 6572 5479  types=[IntegerTy
-00038310: 7065 2829 5d29 0a20 2020 2020 2020 203e  pe()]).        >
-00038320: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
-00038330: 6372 6561 7465 5f64 6174 6166 7261 6d65  create_dataframe
-00038340: 285b 312c 2032 2c20 335d 2c20 7363 6865  ([1, 2, 3], sche
-00038350: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
-00038360: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-00038370: 6164 645f 6f6e 6528 636f 6c28 2261 2229  add_one(col("a")
-00038380: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
-00038390: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-000383a0: 5b52 6f77 2841 4e53 3d32 292c 2052 6f77  [Row(ANS=2), Row
-000383b0: 2841 4e53 3d33 292c 2052 6f77 2841 4e53  (ANS=3), Row(ANS
-000383c0: 3d34 295d 0a0a 2020 2020 6f72 2061 7320  =4)]..    or as 
-000383d0: 6e61 6d65 6420 5544 4673 2074 6861 7420  named UDFs that 
-000383e0: 6172 6520 6163 6365 7373 6962 6c65 2069  are accessible i
-000383f0: 6e20 7468 6520 7361 6d65 2073 6573 7369  n the same sessi
-00038400: 6f6e 2e20 496e 7374 6561 6420 6f66 2063  on. Instead of c
-00038410: 616c 6c69 6e67 2060 7564 6660 2061 7320  alling `udf` as 
-00038420: 6675 6e63 7469 6f6e 2c20 6974 2063 616e  function, it can
-00038430: 2062 6520 616c 736f 2075 7365 640a 2020   be also used.  
-00038440: 2020 6173 2061 2064 6563 6f72 6174 6f72    as a decorator
-00038450: 3a0a 0a20 2020 2045 7861 6d70 6c65 3a3a  :..    Example::
-00038460: 0a0a 2020 2020 2020 2020 3e3e 3e20 4075  ..        >>> @u
-00038470: 6466 286e 616d 653d 226d 696e 7573 5f6f  df(name="minus_o
-00038480: 6e65 222c 2072 6570 6c61 6365 3d54 7275  ne", replace=Tru
-00038490: 6529 0a20 2020 2020 2020 202e 2e2e 2064  e).        ... d
-000384a0: 6566 206d 696e 7573 5f6f 6e65 2878 3a20  ef minus_one(x: 
-000384b0: 696e 7429 202d 3e20 696e 743a 0a20 2020  int) -> int:.   
-000384c0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-000384d0: 7572 6e20 7820 2d20 310a 2020 2020 2020  urn x - 1.      
-000384e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
-000384f0: 6d69 6e75 735f 6f6e 6528 636f 6c28 2261  minus_one(col("a
-00038500: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
-00038510: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00038520: 2020 5b52 6f77 2841 4e53 3d30 292c 2052    [Row(ANS=0), R
-00038530: 6f77 2841 4e53 3d31 292c 2052 6f77 2841  ow(ANS=1), Row(A
-00038540: 4e53 3d32 295d 0a20 2020 2020 2020 203e  NS=2)].        >
-00038550: 3e3e 2073 6573 7369 6f6e 2e73 716c 2822  >> session.sql("
-00038560: 5345 4c45 4354 206d 696e 7573 5f6f 6e65  SELECT minus_one
-00038570: 2831 3029 2229 2e63 6f6c 6c65 6374 2829  (10)").collect()
-00038580: 0a20 2020 2020 2020 205b 526f 7728 4d49  .        [Row(MI
-00038590: 4e55 535f 4f4e 4528 3130 293d 3929 5d0a  NUS_ONE(10)=9)].
-000385a0: 0a20 2020 2022 2222 0a20 2020 2073 6573  .    """.    ses
-000385b0: 7369 6f6e 203d 2073 6573 7369 6f6e 206f  sion = session o
-000385c0: 7220 736e 6f77 666c 616b 652e 736e 6f77  r snowflake.snow
-000385d0: 7061 726b 2e73 6573 7369 6f6e 2e5f 6765  park.session._ge
-000385e0: 745f 6163 7469 7665 5f73 6573 7369 6f6e  t_active_session
-000385f0: 2829 0a20 2020 2069 6620 6675 6e63 2069  ().    if func i
-00038600: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00038610: 7265 7475 726e 2066 756e 6374 6f6f 6c73  return functools
-00038620: 2e70 6172 7469 616c 280a 2020 2020 2020  .partial(.      
-00038630: 2020 2020 2020 7365 7373 696f 6e2e 7564        session.ud
-00038640: 662e 7265 6769 7374 6572 2c0a 2020 2020  f.register,.    
-00038650: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
-00038660: 7970 653d 7265 7475 726e 5f74 7970 652c  ype=return_type,
-00038670: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-00038680: 7574 5f74 7970 6573 3d69 6e70 7574 5f74  ut_types=input_t
-00038690: 7970 6573 2c0a 2020 2020 2020 2020 2020  ypes,.          
-000386a0: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
-000386b0: 2020 2020 2020 2020 2069 735f 7065 726d           is_perm
-000386c0: 616e 656e 743d 6973 5f70 6572 6d61 6e65  anent=is_permane
-000386d0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-000386e0: 7374 6167 655f 6c6f 6361 7469 6f6e 3d73  stage_location=s
-000386f0: 7461 6765 5f6c 6f63 6174 696f 6e2c 0a20  tage_location,. 
-00038700: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-00038710: 7473 3d69 6d70 6f72 7473 2c0a 2020 2020  ts=imports,.    
-00038720: 2020 2020 2020 2020 7061 636b 6167 6573          packages
-00038730: 3d70 6163 6b61 6765 732c 0a20 2020 2020  =packages,.     
-00038740: 2020 2020 2020 2072 6570 6c61 6365 3d72         replace=r
-00038750: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
-00038760: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
-00038770: 733d 6966 5f6e 6f74 5f65 7869 7374 732c  s=if_not_exists,
-00038780: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00038790: 616c 6c65 6c3d 7061 7261 6c6c 656c 2c0a  allel=parallel,.
-000387a0: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-000387b0: 6261 7463 685f 7369 7a65 3d6d 6178 5f62  batch_size=max_b
-000387c0: 6174 6368 5f73 697a 652c 0a20 2020 2020  atch_size,.     
-000387d0: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
-000387e0: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
-000387f0: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
-00038800: 2020 2020 2020 736f 7572 6365 5f63 6f64        source_cod
-00038810: 655f 6469 7370 6c61 793d 736f 7572 6365  e_display=source
-00038820: 5f63 6f64 655f 6469 7370 6c61 792c 0a20  _code_display,. 
-00038830: 2020 2020 2020 2020 2020 2073 7472 6963             stric
-00038840: 743d 7374 7269 6374 2c0a 2020 2020 2020  t=strict,.      
-00038850: 2020 2020 2020 7365 6375 7265 3d73 6563        secure=sec
-00038860: 7572 652c 0a20 2020 2020 2020 2029 0a20  ure,.        ). 
-00038870: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00038880: 2072 6574 7572 6e20 7365 7373 696f 6e2e   return session.
-00038890: 7564 662e 7265 6769 7374 6572 280a 2020  udf.register(.  
-000388a0: 2020 2020 2020 2020 2020 6675 6e63 2c0a            func,.
-000388b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000388c0: 726e 5f74 7970 653d 7265 7475 726e 5f74  rn_type=return_t
-000388d0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-000388e0: 2069 6e70 7574 5f74 7970 6573 3d69 6e70   input_types=inp
-000388f0: 7574 5f74 7970 6573 2c0a 2020 2020 2020  ut_types,.      
-00038900: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
-00038910: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-00038920: 7065 726d 616e 656e 743d 6973 5f70 6572  permanent=is_per
-00038930: 6d61 6e65 6e74 2c0a 2020 2020 2020 2020  manent,.        
-00038940: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
-00038950: 6f6e 3d73 7461 6765 5f6c 6f63 6174 696f  on=stage_locatio
-00038960: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
-00038970: 6d70 6f72 7473 3d69 6d70 6f72 7473 2c0a  mports=imports,.
-00038980: 2020 2020 2020 2020 2020 2020 7061 636b              pack
-00038990: 6167 6573 3d70 6163 6b61 6765 732c 0a20  ages=packages,. 
-000389a0: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
-000389b0: 6365 3d72 6570 6c61 6365 2c0a 2020 2020  ce=replace,.    
-000389c0: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
-000389d0: 7869 7374 733d 6966 5f6e 6f74 5f65 7869  xists=if_not_exi
-000389e0: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
-000389f0: 2070 6172 616c 6c65 6c3d 7061 7261 6c6c   parallel=parall
-00038a00: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
-00038a10: 6d61 785f 6261 7463 685f 7369 7a65 3d6d  max_batch_size=m
-00038a20: 6178 5f62 6174 6368 5f73 697a 652c 0a20  ax_batch_size,. 
-00038a30: 2020 2020 2020 2020 2020 2073 7461 7465             state
-00038a40: 6d65 6e74 5f70 6172 616d 733d 7374 6174  ment_params=stat
-00038a50: 656d 656e 745f 7061 7261 6d73 2c0a 2020  ement_params,.  
-00038a60: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00038a70: 5f63 6f64 655f 6469 7370 6c61 793d 736f  _code_display=so
-00038a80: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-00038a90: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
-00038aa0: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
-00038ab0: 2020 2020 2020 2020 2020 7365 6375 7265            secure
-00038ac0: 3d73 6563 7572 652c 0a20 2020 2020 2020  =secure,.       
-00038ad0: 2029 0a0a 0a64 6566 2075 6474 6628 0a20   )...def udtf(. 
-00038ae0: 2020 2068 616e 646c 6572 3a20 4f70 7469     handler: Opti
-00038af0: 6f6e 616c 5b43 616c 6c61 626c 655d 203d  onal[Callable] =
-00038b00: 204e 6f6e 652c 0a20 2020 202a 2c0a 2020   None,.    *,.  
-00038b10: 2020 6f75 7470 7574 5f73 6368 656d 613a    output_schema:
-00038b20: 2055 6e69 6f6e 5b53 7472 7563 7454 7970   Union[StructTyp
-00038b30: 652c 204c 6973 745b 7374 725d 5d2c 0a20  e, List[str]],. 
-00038b40: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
-00038b50: 4f70 7469 6f6e 616c 5b4c 6973 745b 4461  Optional[List[Da
-00038b60: 7461 5479 7065 5d5d 203d 204e 6f6e 652c  taType]] = None,
-00038b70: 0a20 2020 206e 616d 653a 204f 7074 696f  .    name: Optio
-00038b80: 6e61 6c5b 556e 696f 6e5b 7374 722c 2049  nal[Union[str, I
-00038b90: 7465 7261 626c 655b 7374 725d 5d5d 203d  terable[str]]] =
-00038ba0: 204e 6f6e 652c 0a20 2020 2069 735f 7065   None,.    is_pe
-00038bb0: 726d 616e 656e 743a 2062 6f6f 6c20 3d20  rmanent: bool = 
-00038bc0: 4661 6c73 652c 0a20 2020 2073 7461 6765  False,.    stage
-00038bd0: 5f6c 6f63 6174 696f 6e3a 204f 7074 696f  _location: Optio
-00038be0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00038bf0: 0a20 2020 2069 6d70 6f72 7473 3a20 4f70  .    imports: Op
-00038c00: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
-00038c10: 6e5b 7374 722c 2054 7570 6c65 5b73 7472  n[str, Tuple[str
-00038c20: 2c20 7374 725d 5d5d 5d20 3d20 4e6f 6e65  , str]]]] = None
-00038c30: 2c0a 2020 2020 7061 636b 6167 6573 3a20  ,.    packages: 
-00038c40: 4f70 7469 6f6e 616c 5b4c 6973 745b 556e  Optional[List[Un
-00038c50: 696f 6e5b 7374 722c 204d 6f64 756c 6554  ion[str, ModuleT
-00038c60: 7970 655d 5d5d 203d 204e 6f6e 652c 0a20  ype]]] = None,. 
-00038c70: 2020 2072 6570 6c61 6365 3a20 626f 6f6c     replace: bool
-00038c80: 203d 2046 616c 7365 2c0a 2020 2020 6966   = False,.    if
-00038c90: 5f6e 6f74 5f65 7869 7374 733a 2062 6f6f  _not_exists: boo
-00038ca0: 6c20 3d20 4661 6c73 652c 0a20 2020 2073  l = False,.    s
-00038cb0: 6573 7369 6f6e 3a20 4f70 7469 6f6e 616c  ession: Optional
-00038cc0: 5b22 736e 6f77 666c 616b 652e 736e 6f77  ["snowflake.snow
-00038cd0: 7061 726b 2e73 6573 7369 6f6e 2e53 6573  park.session.Ses
-00038ce0: 7369 6f6e 225d 203d 204e 6f6e 652c 0a20  sion"] = None,. 
-00038cf0: 2020 2070 6172 616c 6c65 6c3a 2069 6e74     parallel: int
-00038d00: 203d 2034 2c0a 2020 2020 7374 6174 656d   = 4,.    statem
-00038d10: 656e 745f 7061 7261 6d73 3a20 4f70 7469  ent_params: Opti
-00038d20: 6f6e 616c 5b44 6963 745b 7374 722c 2073  onal[Dict[str, s
-00038d30: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-00038d40: 2073 7472 6963 743a 2062 6f6f 6c20 3d20   strict: bool = 
-00038d50: 4661 6c73 652c 0a20 2020 2073 6563 7572  False,.    secur
-00038d60: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-00038d70: 0a29 202d 3e20 556e 696f 6e5b 5573 6572  .) -> Union[User
-00038d80: 4465 6669 6e65 6454 6162 6c65 4675 6e63  DefinedTableFunc
-00038d90: 7469 6f6e 2c20 6675 6e63 746f 6f6c 732e  tion, functools.
-00038da0: 7061 7274 6961 6c5d 3a0a 2020 2020 2222  partial]:.    ""
-00038db0: 2252 6567 6973 7465 7273 2061 2050 7974  "Registers a Pyt
-00038dc0: 686f 6e20 636c 6173 7320 6173 2061 2053  hon class as a S
-00038dd0: 6e6f 7766 6c61 6b65 2050 7974 686f 6e20  nowflake Python 
-00038de0: 5544 5446 2061 6e64 2072 6574 7572 6e73  UDTF and returns
-00038df0: 2074 6865 2055 4454 462e 0a0a 2020 2020   the UDTF...    
-00038e00: 4974 2063 616e 2062 6520 7573 6564 2061  It can be used a
-00038e10: 7320 6569 7468 6572 2061 2066 756e 6374  s either a funct
-00038e20: 696f 6e20 6361 6c6c 206f 7220 6120 6465  ion call or a de
-00038e30: 636f 7261 746f 722e 2049 6e20 6d6f 7374  corator. In most
-00038e40: 2063 6173 6573 2079 6f75 2077 6f72 6b20   cases you work 
-00038e50: 7769 7468 2061 2073 696e 676c 6520 7365  with a single se
-00038e60: 7373 696f 6e2e 0a20 2020 2054 6869 7320  ssion..    This 
-00038e70: 6675 6e63 7469 6f6e 2075 7365 7320 7468  function uses th
-00038e80: 6174 2073 6573 7369 6f6e 2074 6f20 7265  at session to re
-00038e90: 6769 7374 6572 2074 6865 2055 4454 462e  gister the UDTF.
-00038ea0: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
-00038eb0: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
-00038ec0: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
-00038ed0: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
-00038ee0: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
-00038ef0: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
-00038f00: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
-00038f10: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
-00038f20: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
-00038f30: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
-00038f40: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
-00038f50: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
-00038f60: 7365 2060 6073 6573 7369 6f6e 2e75 6474  se ``session.udt
-00038f70: 662e 7265 6769 7374 6572 6060 2069 6e73  f.register`` ins
-00038f80: 7465 6164 2e20 5365 6520 6578 616d 706c  tead. See exampl
-00038f90: 6573 0a20 2020 2069 6e20 3a63 6c61 7373  es.    in :class
-00038fa0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-00038fb0: 7770 6172 6b2e 7564 7466 2e55 4454 4652  wpark.udtf.UDTFR
-00038fc0: 6567 6973 7472 6174 696f 6e60 2e0a 0a20  egistration`... 
-00038fd0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00038fe0: 2068 616e 646c 6572 3a20 4120 5079 7468   handler: A Pyth
-00038ff0: 6f6e 2063 6c61 7373 2075 7365 6420 666f  on class used fo
-00039000: 7220 6372 6561 7469 6e67 2074 6865 2055  r creating the U
-00039010: 4454 462e 0a20 2020 2020 2020 206f 7574  DTF..        out
-00039020: 7075 745f 7363 6865 6d61 3a20 4120 6c69  put_schema: A li
-00039030: 7374 206f 6620 636f 6c75 6d6e 206e 616d  st of column nam
-00039040: 6573 2c20 6f72 2061 203a 636c 6173 733a  es, or a :class:
-00039050: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
-00039060: 7061 726b 2e74 7970 6573 2e53 7472 7563  park.types.Struc
-00039070: 7454 7970 6560 2069 6e73 7461 6e63 6520  tType` instance 
-00039080: 7468 6174 2072 6570 7265 7365 6e74 7320  that represents 
-00039090: 7468 6520 7461 626c 6520 6675 6e63 7469  the table functi
-000390a0: 6f6e 2773 2063 6f6c 756d 6e73 2e0a 2020  on's columns..  
-000390b0: 2020 2020 2020 2049 6620 6120 6c69 7374         If a list
-000390c0: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
-000390d0: 2069 7320 7072 6f76 6964 6564 2c20 7468   is provided, th
-000390e0: 6520 6060 7072 6f63 6573 7360 6020 6d65  e ``process`` me
-000390f0: 7468 6f64 206f 6620 7468 6520 6861 6e64  thod of the hand
-00039100: 6c65 7220 636c 6173 7320 6d75 7374 2068  ler class must h
-00039110: 6176 6520 7265 7475 726e 2074 7970 6520  ave return type 
-00039120: 6869 6e74 7320 746f 2069 6e64 6963 6174  hints to indicat
-00039130: 6520 7468 6520 6f75 7470 7574 2073 6368  e the output sch
-00039140: 656d 6120 6461 7461 2074 7970 6573 2e0a  ema data types..
-00039150: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
-00039160: 7065 733a 2041 206c 6973 7420 6f66 203a  pes: A list of :
-00039170: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-00039180: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-00039190: 2e44 6174 6154 7970 6560 0a20 2020 2020  .DataType`.     
-000391a0: 2020 2020 2020 2072 6570 7265 7365 6e74         represent
-000391b0: 696e 6720 7468 6520 696e 7075 7420 6461  ing the input da
-000391c0: 7461 2074 7970 6573 206f 6620 7468 6520  ta types of the 
-000391d0: 5544 5446 2e20 4f70 7469 6f6e 616c 2069  UDTF. Optional i
-000391e0: 660a 2020 2020 2020 2020 2020 2020 7479  f.            ty
-000391f0: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
-00039200: 7669 6465 642e 0a20 2020 2020 2020 206e  vided..        n
-00039210: 616d 653a 2041 2073 7472 696e 6720 6f72  ame: A string or
-00039220: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-00039230: 2074 6861 7420 7370 6563 6966 7920 7468   that specify th
-00039240: 6520 6e61 6d65 206f 7220 6675 6c6c 792d  e name or fully-
-00039250: 7175 616c 6966 6965 640a 2020 2020 2020  qualified.      
-00039260: 2020 2020 2020 6f62 6a65 6374 2069 6465        object ide
-00039270: 6e74 6966 6965 7220 2864 6174 6162 6173  ntifier (databas
-00039280: 6520 6e61 6d65 2c20 7363 6865 6d61 206e  e name, schema n
-00039290: 616d 652c 2061 6e64 2066 756e 6374 696f  ame, and functio
-000392a0: 6e20 6e61 6d65 2920 666f 720a 2020 2020  n name) for.    
-000392b0: 2020 2020 2020 2020 7468 6520 5544 5446          the UDTF
-000392c0: 2069 6e20 536e 6f77 666c 616b 652c 2077   in Snowflake, w
-000392d0: 6869 6368 2061 6c6c 6f77 7320 796f 7520  hich allows you 
-000392e0: 746f 2063 616c 6c20 7468 6973 2055 4454  to call this UDT
-000392f0: 4620 696e 2061 2053 514c 0a20 2020 2020  F in a SQL.     
-00039300: 2020 2020 2020 2063 6f6d 6d61 6e64 206f         command o
-00039310: 7220 7669 6120 3a66 756e 633a 6063 616c  r via :func:`cal
-00039320: 6c5f 7564 7466 2829 602e 2049 6620 6974  l_udtf()`. If it
-00039330: 2069 7320 6e6f 7420 7072 6f76 6964 6564   is not provided
-00039340: 2c20 6120 6e61 6d65 2077 696c 6c0a 2020  , a name will.  
-00039350: 2020 2020 2020 2020 2020 6265 2061 7574            be aut
-00039360: 6f6d 6174 6963 616c 6c79 2067 656e 6572  omatically gener
-00039370: 6174 6564 2066 6f72 2074 6865 2055 4454  ated for the UDT
-00039380: 462e 2041 206e 616d 6520 6d75 7374 2062  F. A name must b
-00039390: 6520 7370 6563 6966 6965 6420 7768 656e  e specified when
-000393a0: 0a20 2020 2020 2020 2020 2020 2060 6069  .            ``i
-000393b0: 735f 7065 726d 616e 656e 7460 6020 6973  s_permanent`` is
-000393c0: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
-000393d0: 2020 2069 735f 7065 726d 616e 656e 743a     is_permanent:
-000393e0: 2057 6865 7468 6572 2074 6f20 6372 6561   Whether to crea
-000393f0: 7465 2061 2070 6572 6d61 6e65 6e74 2055  te a permanent U
-00039400: 4454 462e 2054 6865 2064 6566 6175 6c74  DTF. The default
-00039410: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
-00039420: 2020 2020 2020 2020 2020 2049 6620 6974             If it
-00039430: 2069 7320 6060 5472 7565 6060 2c20 6120   is ``True``, a 
-00039440: 7661 6c69 6420 6060 7374 6167 655f 6c6f  valid ``stage_lo
-00039450: 6361 7469 6f6e 6060 206d 7573 7420 6265  cation`` must be
-00039460: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
-00039470: 2020 2073 7461 6765 5f6c 6f63 6174 696f     stage_locatio
-00039480: 6e3a 2054 6865 2073 7461 6765 206c 6f63  n: The stage loc
-00039490: 6174 696f 6e20 7768 6572 6520 7468 6520  ation where the 
-000394a0: 5079 7468 6f6e 2066 696c 6520 666f 7220  Python file for 
-000394b0: 7468 6520 5544 5446 0a20 2020 2020 2020  the UDTF.       
-000394c0: 2020 2020 2061 6e64 2069 7473 2064 6570       and its dep
-000394d0: 656e 6465 6e63 6965 7320 7368 6f75 6c64  endencies should
-000394e0: 2062 6520 7570 6c6f 6164 6564 2e20 5468   be uploaded. Th
-000394f0: 6520 7374 6167 6520 6c6f 6361 7469 6f6e  e stage location
-00039500: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-00039510: 6564 0a20 2020 2020 2020 2020 2020 2077  ed.            w
-00039520: 6865 6e20 6060 6973 5f70 6572 6d61 6e65  hen ``is_permane
-00039530: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
-00039540: 2c20 616e 6420 6974 2077 696c 6c20 6265  , and it will be
-00039550: 2069 676e 6f72 6564 2077 6865 6e0a 2020   ignored when.  
-00039560: 2020 2020 2020 2020 2020 6060 6973 5f70            ``is_p
-00039570: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
-00039580: 4661 6c73 6560 602e 2049 7420 6361 6e20  False``. It can 
-00039590: 6265 2061 6e79 2073 7461 6765 206f 7468  be any stage oth
-000395a0: 6572 2074 6861 6e20 7465 6d70 6f72 6172  er than temporar
-000395b0: 790a 2020 2020 2020 2020 2020 2020 7374  y.            st
-000395c0: 6167 6573 2061 6e64 2065 7874 6572 6e61  ages and externa
-000395d0: 6c20 7374 6167 6573 2e0a 2020 2020 2020  l stages..      
-000395e0: 2020 696d 706f 7274 733a 2041 206c 6973    imports: A lis
-000395f0: 7420 6f66 2069 6d70 6f72 7473 2074 6861  t of imports tha
-00039600: 7420 6f6e 6c79 2061 7070 6c79 2074 6f20  t only apply to 
-00039610: 7468 6973 2055 4454 462e 2059 6f75 2063  this UDTF. You c
-00039620: 616e 2075 7365 2061 2073 7472 696e 6720  an use a string 
-00039630: 746f 0a20 2020 2020 2020 2020 2020 2072  to.            r
-00039640: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
-00039650: 7061 7468 2028 7369 6d69 6c61 7220 746f  path (similar to
-00039660: 2074 6865 2060 6070 6174 6860 6020 6172   the ``path`` ar
-00039670: 6775 6d65 6e74 2069 6e0a 2020 2020 2020  gument in.      
-00039680: 2020 2020 2020 3a6d 6574 683a 607e 736e        :meth:`~sn
-00039690: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-000396a0: 2e53 6573 7369 6f6e 2e61 6464 5f69 6d70  .Session.add_imp
-000396b0: 6f72 7460 2920 696e 2074 6869 7320 6c69  ort`) in this li
-000396c0: 7374 2c20 6f72 2061 2074 7570 6c65 206f  st, or a tuple o
-000396d0: 6620 7477 6f0a 2020 2020 2020 2020 2020  f two.          
-000396e0: 2020 7374 7269 6e67 7320 746f 2072 6570    strings to rep
-000396f0: 7265 7365 6e74 2061 2066 696c 6520 7061  resent a file pa
-00039700: 7468 2061 6e64 2061 6e20 696d 706f 7274  th and an import
-00039710: 2070 6174 6820 2873 696d 696c 6172 2074   path (similar t
-00039720: 6f20 7468 6520 6060 696d 706f 7274 5f70  o the ``import_p
-00039730: 6174 6860 600a 2020 2020 2020 2020 2020  ath``.          
-00039740: 2020 6172 6775 6d65 6e74 2069 6e20 3a6d    argument in :m
-00039750: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
-00039760: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
-00039770: 2e61 6464 5f69 6d70 6f72 7460 292e 2054  .add_import`). T
-00039780: 6865 7365 2055 4454 462d 6c65 7665 6c20  hese UDTF-level 
-00039790: 696d 706f 7274 730a 2020 2020 2020 2020  imports.        
-000397a0: 2020 2020 7769 6c6c 206f 7665 7272 6964      will overrid
-000397b0: 6520 7468 6520 7365 7373 696f 6e2d 6c65  e the session-le
-000397c0: 7665 6c20 696d 706f 7274 7320 6164 6465  vel imports adde
-000397d0: 6420 6279 0a20 2020 2020 2020 2020 2020  d by.           
-000397e0: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
-000397f0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
-00039800: 696f 6e2e 6164 645f 696d 706f 7274 602e  ion.add_import`.
-00039810: 0a20 2020 2020 2020 2070 6163 6b61 6765  .        package
-00039820: 733a 2041 206c 6973 7420 6f66 2070 6163  s: A list of pac
-00039830: 6b61 6765 7320 7468 6174 206f 6e6c 7920  kages that only 
-00039840: 6170 706c 7920 746f 2074 6869 7320 5544  apply to this UD
-00039850: 5446 2e20 5468 6573 6520 5544 5446 2d6c  TF. These UDTF-l
-00039860: 6576 656c 2070 6163 6b61 6765 730a 2020  evel packages.  
-00039870: 2020 2020 2020 2020 2020 7769 6c6c 206f            will o
-00039880: 7665 7272 6964 6520 7468 6520 7365 7373  verride the sess
-00039890: 696f 6e2d 6c65 7665 6c20 7061 636b 6167  ion-level packag
-000398a0: 6573 2061 6464 6564 2062 790a 2020 2020  es added by.    
-000398b0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
-000398c0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-000398d0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f70  rk.Session.add_p
-000398e0: 6163 6b61 6765 7360 2061 6e64 0a20 2020  ackages` and.   
-000398f0: 2020 2020 2020 2020 203a 6d65 7468 3a60           :meth:`
-00039900: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-00039910: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
-00039920: 7265 7175 6972 656d 656e 7473 602e 0a20  requirements`.. 
-00039930: 2020 2020 2020 2072 6570 6c61 6365 3a20         replace: 
-00039940: 5768 6574 6865 7220 746f 2072 6570 6c61  Whether to repla
-00039950: 6365 2061 2055 4454 4620 7468 6174 2061  ce a UDTF that a
-00039960: 6c72 6561 6479 2077 6173 2072 6567 6973  lready was regis
-00039970: 7465 7265 642e 2054 6865 2064 6566 6175  tered. The defau
-00039980: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-00039990: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-000399a0: 6974 2069 7320 6060 4661 6c73 6560 602c  it is ``False``,
-000399b0: 2061 7474 656d 7074 696e 6720 746f 2072   attempting to r
-000399c0: 6567 6973 7465 7220 6120 5544 5446 2077  egister a UDTF w
-000399d0: 6974 6820 6120 6e61 6d65 2074 6861 7420  ith a name that 
-000399e0: 616c 7265 6164 7920 6578 6973 7473 0a20  already exists. 
-000399f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00039a00: 7473 2069 6e20 6120 6060 536e 6f77 7061  ts in a ``Snowpa
-00039a10: 726b 5351 4c45 7863 6570 7469 6f6e 6060  rkSQLException``
-00039a20: 2065 7863 6570 7469 6f6e 2062 6569 6e67   exception being
-00039a30: 2074 6872 6f77 6e2e 2049 6620 6974 2069   thrown. If it i
-00039a40: 7320 6060 5472 7565 6060 2c0a 2020 2020  s ``True``,.    
-00039a50: 2020 2020 2020 2020 616e 2065 7869 7374          an exist
-00039a60: 696e 6720 5544 5446 2077 6974 6820 7468  ing UDTF with th
-00039a70: 6520 7361 6d65 206e 616d 6520 6973 206f  e same name is o
-00039a80: 7665 7277 7269 7474 656e 2e0a 2020 2020  verwritten..    
-00039a90: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
-00039aa0: 733a 2057 6865 7468 6572 2074 6f20 736b  s: Whether to sk
-00039ab0: 6970 2063 7265 6174 696f 6e20 6f66 2061  ip creation of a
-00039ac0: 2055 4454 4620 7768 656e 206f 6e65 2077   UDTF when one w
-00039ad0: 6974 6820 7468 6520 7361 6d65 2073 6967  ith the same sig
-00039ae0: 6e61 7475 7265 2061 6c72 6561 6479 2065  nature already e
-00039af0: 7869 7374 732e 0a20 2020 2020 2020 2020  xists..         
-00039b00: 2020 2054 6865 2064 6566 6175 6c74 2069     The default i
-00039b10: 7320 6060 4661 6c73 6560 602e 2060 6069  s ``False``. ``i
-00039b20: 665f 6e6f 745f 6578 6973 7473 6060 2061  f_not_exists`` a
-00039b30: 6e64 2060 6072 6570 6c61 6365 6060 2061  nd ``replace`` a
-00039b40: 7265 206d 7574 7561 6c6c 7920 6578 636c  re mutually excl
-00039b50: 7573 6976 650a 2020 2020 2020 2020 2020  usive.          
-00039b60: 2020 616e 6420 6120 6060 5661 6c75 6545    and a ``ValueE
-00039b70: 7272 6f72 6060 2069 7320 7261 6973 6564  rror`` is raised
-00039b80: 2077 6865 6e20 626f 7468 2061 7265 2073   when both are s
-00039b90: 6574 2e20 4966 2069 7420 6973 2060 6054  et. If it is ``T
-00039ba0: 7275 6560 6020 616e 6420 6120 5544 5446  rue`` and a UDTF
-00039bb0: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
-00039bc0: 2020 7468 6520 7361 6d65 2073 6967 6e61    the same signa
-00039bd0: 7475 7265 2065 7869 7374 732c 2074 6865  ture exists, the
-00039be0: 2055 4454 4620 6372 6561 7469 6f6e 2069   UDTF creation i
-00039bf0: 7320 736b 6970 7065 642e 0a20 2020 2020  s skipped..     
-00039c00: 2020 2073 6573 7369 6f6e 3a20 5573 6520     session: Use 
-00039c10: 7468 6973 2073 6573 7369 6f6e 2074 6f20  this session to 
-00039c20: 7265 6769 7374 6572 2074 6865 2055 4454  register the UDT
-00039c30: 462e 2049 6620 6974 2773 206e 6f74 2073  F. If it's not s
-00039c40: 7065 6369 6669 6564 2c20 7468 6520 7365  pecified, the se
-00039c50: 7373 696f 6e20 7468 6174 2079 6f75 2063  ssion that you c
-00039c60: 7265 6174 6564 2062 6566 6f72 6520 6361  reated before ca
-00039c70: 6c6c 696e 6720 7468 6973 2066 756e 6374  lling this funct
-00039c80: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-00039c90: 2e0a 2020 2020 2020 2020 2020 2020 596f  ..            Yo
-00039ca0: 7520 6e65 6564 2074 6f20 7370 6563 6966  u need to specif
-00039cb0: 7920 7468 6973 2070 6172 616d 6574 6572  y this parameter
-00039cc0: 2069 6620 796f 7520 6861 7665 2063 7265   if you have cre
-00039cd0: 6174 6564 206d 756c 7469 706c 6520 7365  ated multiple se
-00039ce0: 7373 696f 6e73 2062 6566 6f72 6520 6361  ssions before ca
-00039cf0: 6c6c 696e 6720 7468 6973 206d 6574 686f  lling this metho
-00039d00: 642e 0a20 2020 2020 2020 2070 6172 616c  d..        paral
-00039d10: 6c65 6c3a 2054 6865 206e 756d 6265 7220  lel: The number 
-00039d20: 6f66 2074 6872 6561 6473 2074 6f20 7573  of threads to us
-00039d30: 6520 666f 7220 7570 6c6f 6164 696e 6720  e for uploading 
-00039d40: 5544 5446 2066 696c 6573 2077 6974 6820  UDTF files with 
-00039d50: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00039d60: 6050 5554 203c 6874 7470 733a 2f2f 646f  `PUT <https://do
-00039d70: 6373 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  cs.snowflake.com
-00039d80: 2f65 6e2f 7371 6c2d 7265 6665 7265 6e63  /en/sql-referenc
-00039d90: 652f 7371 6c2f 7075 742e 6874 6d6c 2370  e/sql/put.html#p
-00039da0: 7574 3e60 5f0a 2020 2020 2020 2020 2020  ut>`_.          
-00039db0: 2020 636f 6d6d 616e 642e 2054 6865 2064    command. The d
-00039dc0: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-00039dd0: 3420 616e 6420 7375 7070 6f72 7465 6420  4 and supported 
-00039de0: 7661 6c75 6573 2061 7265 2066 726f 6d20  values are from 
-00039df0: 3120 746f 2039 392e 0a20 2020 2020 2020  1 to 99..       
-00039e00: 2020 2020 2049 6e63 7265 6173 696e 6720       Increasing 
-00039e10: 7468 6520 6e75 6d62 6572 206f 6620 7468  the number of th
-00039e20: 7265 6164 7320 6361 6e20 696d 7072 6f76  reads can improv
-00039e30: 6520 7065 7266 6f72 6d61 6e63 6520 7768  e performance wh
-00039e40: 656e 2075 706c 6f61 6469 6e67 0a20 2020  en uploading.   
-00039e50: 2020 2020 2020 2020 206c 6172 6765 2055           large U
-00039e60: 4454 4620 6669 6c65 732e 0a20 2020 2020  DTF files..     
-00039e70: 2020 2073 7461 7465 6d65 6e74 5f70 6172     statement_par
-00039e80: 616d 733a 2044 6963 7469 6f6e 6172 7920  ams: Dictionary 
-00039e90: 6f66 2073 7461 7465 6d65 6e74 206c 6576  of statement lev
-00039ea0: 656c 2070 6172 616d 6574 6572 7320 746f  el parameters to
-00039eb0: 2062 6520 7365 7420 7768 696c 6520 6578   be set while ex
-00039ec0: 6563 7574 696e 6720 7468 6973 2061 6374  ecuting this act
-00039ed0: 696f 6e2e 0a20 2020 2020 2020 2073 7472  ion..        str
-00039ee0: 6963 743a 2057 6865 7468 6572 2074 6865  ict: Whether the
-00039ef0: 2063 7265 6174 6564 2055 4454 4620 6973   created UDTF is
-00039f00: 2073 7472 6963 742e 2041 2073 7472 6963   strict. A stric
-00039f10: 7420 5544 5446 2077 696c 6c20 6e6f 7420  t UDTF will not 
-00039f20: 696e 766f 6b65 2074 6865 2055 4454 4620  invoke the UDTF 
-00039f30: 6966 2061 6e79 2069 6e70 7574 2069 730a  if any input is.
-00039f40: 2020 2020 2020 2020 2020 2020 6e75 6c6c              null
-00039f50: 2e20 496e 7374 6561 642c 2061 206e 756c  . Instead, a nul
-00039f60: 6c20 7661 6c75 6520 7769 6c6c 2061 6c77  l value will alw
-00039f70: 6179 7320 6265 2072 6574 7572 6e65 6420  ays be returned 
-00039f80: 666f 7220 7468 6174 2072 6f77 2e20 4e6f  for that row. No
-00039f90: 7465 2074 6861 7420 7468 6520 5544 5446  te that the UDTF
-00039fa0: 206d 6967 6874 0a20 2020 2020 2020 2020   might.         
-00039fb0: 2020 2073 7469 6c6c 2072 6574 7572 6e20     still return 
-00039fc0: 6e75 6c6c 2066 6f72 206e 6f6e 2d6e 756c  null for non-nul
-00039fd0: 6c20 696e 7075 7473 2e0a 2020 2020 2020  l inputs..      
-00039fe0: 2020 7365 6375 7265 3a20 5768 6574 6865    secure: Whethe
-00039ff0: 7220 7468 6520 6372 6561 7465 6420 5544  r the created UD
-0003a000: 5446 2069 7320 7365 6375 7265 2e20 466f  TF is secure. Fo
-0003a010: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-0003a020: 6f6e 2061 626f 7574 2073 6563 7572 6520  on about secure 
-0003a030: 6675 6e63 7469 6f6e 732c 0a20 2020 2020  functions,.     
-0003a040: 2020 2020 2020 2073 6565 2060 5365 6375         see `Secu
-0003a050: 7265 2055 4446 7320 3c68 7474 7073 3a2f  re UDFs <https:/
-0003a060: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
-0003a070: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
-0003a080: 656e 6365 2f75 6466 2d73 6563 7572 652e  ence/udf-secure.
-0003a090: 6874 6d6c 3e60 5f2e 0a0a 2020 2020 5265  html>`_...    Re
-0003a0a0: 7475 726e 733a 0a20 2020 2020 2020 2041  turns:.        A
-0003a0b0: 2055 4454 4620 6675 6e63 7469 6f6e 2074   UDTF function t
-0003a0c0: 6861 7420 6361 6e20 6265 2063 616c 6c65  hat can be calle
-0003a0d0: 6420 7769 7468 203a 636c 6173 733a 607e  d with :class:`~
-0003a0e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
-0003a0f0: 726b 2e43 6f6c 756d 6e60 2065 7870 7265  rk.Column` expre
-0003a100: 7373 696f 6e73 2e0a 0a20 2020 204e 6f74  ssions...    Not
-0003a110: 653a 0a20 2020 2020 2020 2031 2e20 5768  e:.        1. Wh
-0003a120: 656e 2074 7970 6520 6869 6e74 7320 6172  en type hints ar
-0003a130: 6520 7072 6f76 6964 6564 2061 6e64 2061  e provided and a
-0003a140: 7265 2063 6f6d 706c 6574 6520 666f 7220  re complete for 
-0003a150: 6120 6675 6e63 7469 6f6e 2c0a 2020 2020  a function,.    
-0003a160: 2020 2020 6060 7265 7475 726e 5f74 7970      ``return_typ
-0003a170: 6560 6020 616e 6420 6060 696e 7075 745f  e`` and ``input_
-0003a180: 7479 7065 7360 6020 6172 6520 6f70 7469  types`` are opti
-0003a190: 6f6e 616c 2061 6e64 2077 696c 6c20 6265  onal and will be
-0003a1a0: 2069 676e 6f72 6564 2e0a 2020 2020 2020   ignored..      
-0003a1b0: 2020 5365 6520 6465 7461 696c 7320 6f66    See details of
-0003a1c0: 2073 7570 706f 7274 6564 2064 6174 6120   supported data 
-0003a1d0: 7479 7065 7320 666f 7220 5544 5446 7320  types for UDTFs 
-0003a1e0: 696e 0a20 2020 2020 2020 203a 636c 6173  in.        :clas
-0003a1f0: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
-0003a200: 6f77 7061 726b 2e75 6474 662e 5544 5446  owpark.udtf.UDTF
-0003a210: 5265 6769 7374 7261 7469 6f6e 602e 0a0a  Registration`...
-0003a220: 2020 2020 2020 2020 2020 2020 2d20 596f              - Yo
-0003a230: 7520 6361 6e20 7573 6520 7573 6520 3a61  u can use use :a
-0003a240: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
-0003a250: 736e 6f77 7061 726b 2e74 7970 6573 2e56  snowpark.types.V
-0003a260: 6172 6961 6e74 6020 746f 0a20 2020 2020  ariant` to.     
-0003a270: 2020 2020 2020 2020 2061 6e6e 6f74 6174           annotat
-0003a280: 6520 6120 7661 7269 616e 742c 2061 6e64  e a variant, and
-0003a290: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
-0003a2a0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003a2b0: 7479 7065 732e 4765 6f67 7261 7068 7960  types.Geography`
-0003a2c0: 0a20 2020 2020 2020 2020 2020 2020 2074  .              t
-0003a2d0: 6f20 616e 6e6f 7461 7465 2061 2067 656f  o annotate a geo
-0003a2e0: 6772 6170 6879 2077 6865 6e20 6465 6669  graphy when defi
-0003a2f0: 6e69 6e67 2061 2055 4454 462e 0a0a 2020  ning a UDTF...  
-0003a300: 2020 2020 2020 2020 2020 2d20 3a63 6c61            - :cla
-0003a310: 7373 3a60 7479 7069 6e67 2e55 6e69 6f6e  ss:`typing.Union
-0003a320: 6020 6973 206e 6f74 2061 2076 616c 6964  ` is not a valid
-0003a330: 2074 7970 6520 616e 6e6f 7461 7469 6f6e   type annotation
-0003a340: 2066 6f72 2055 4454 4673 2c0a 2020 2020   for UDTFs,.    
-0003a350: 2020 2020 2020 2020 2020 6275 7420 3a63            but :c
-0003a360: 6c61 7373 3a60 7479 7069 6e67 2e4f 7074  lass:`typing.Opt
-0003a370: 696f 6e61 6c60 2063 616e 2062 6520 7573  ional` can be us
-0003a380: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
-0003a390: 6865 206f 7074 696f 6e61 6c20 7479 7065  he optional type
-0003a3a0: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
-0003a3b0: 2054 7970 6520 6869 6e74 7320 6172 6520   Type hints are 
-0003a3c0: 6e6f 7420 7375 7070 6f72 7465 6420 6f6e  not supported on
-0003a3d0: 2066 756e 6374 696f 6e73 2064 6563 6f72   functions decor
-0003a3e0: 6174 6564 2077 6974 6820 6465 636f 7261  ated with decora
-0003a3f0: 746f 7273 2e0a 0a20 2020 2020 2020 2032  tors...        2
-0003a400: 2e20 4120 7465 6d70 6f72 6172 7920 5544  . A temporary UD
-0003a410: 5446 2028 7768 656e 2060 6069 735f 7065  TF (when ``is_pe
-0003a420: 726d 616e 656e 7460 6020 6973 2060 6046  rmanent`` is ``F
-0003a430: 616c 7365 6060 2920 6973 2073 636f 7065  alse``) is scope
-0003a440: 6420 746f 2074 6869 7320 6060 7365 7373  d to this ``sess
-0003a450: 696f 6e60 600a 2020 2020 2020 2020 616e  ion``.        an
-0003a460: 6420 616c 6c20 5544 5446 2072 656c 6174  d all UDTF relat
-0003a470: 6564 2066 696c 6573 2077 696c 6c20 6265  ed files will be
-0003a480: 2075 706c 6f61 6465 6420 746f 2061 2074   uploaded to a t
-0003a490: 656d 706f 7261 7279 2073 6573 7369 6f6e  emporary session
-0003a4a0: 2073 7461 6765 0a20 2020 2020 2020 2028   stage.        (
-0003a4b0: 3a66 756e 633a 6073 6573 7369 6f6e 2e67  :func:`session.g
-0003a4c0: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
-0003a4d0: 2829 203c 736e 6f77 666c 616b 652e 736e  () <snowflake.sn
-0003a4e0: 6f77 7061 726b 2e53 6573 7369 6f6e 2e67  owpark.Session.g
-0003a4f0: 6574 5f73 6573 7369 6f6e 5f73 7461 6765  et_session_stage
-0003a500: 3e60 292e 0a20 2020 2020 2020 2046 6f72  >`)..        For
-0003a510: 2061 2070 6572 6d61 6e65 6e74 2055 4454   a permanent UDT
-0003a520: 462c 2074 6865 7365 2066 696c 6573 2077  F, these files w
-0003a530: 696c 6c20 6265 2075 706c 6f61 6465 6420  ill be uploaded 
-0003a540: 746f 2074 6865 2073 7461 6765 2074 6861  to the stage tha
-0003a550: 7420 796f 7520 7370 6563 6966 792e 0a0a  t you specify...
-0003a560: 2020 2020 2020 2020 332e 2042 7920 6465          3. By de
-0003a570: 6661 756c 742c 2055 4454 4620 7265 6769  fault, UDTF regi
-0003a580: 7374 7261 7469 6f6e 2066 6169 6c73 2069  stration fails i
-0003a590: 6620 6120 6675 6e63 7469 6f6e 2077 6974  f a function wit
-0003a5a0: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
-0003a5b0: 6973 2061 6c72 6561 6479 0a20 2020 2020  is already.     
-0003a5c0: 2020 2072 6567 6973 7465 7265 642e 2049     registered. I
-0003a5d0: 6e76 6f6b 696e 6720 3a66 756e 633a 6075  nvoking :func:`u
-0003a5e0: 6474 6660 2077 6974 6820 6060 7265 706c  dtf` with ``repl
-0003a5f0: 6163 6560 6020 7365 7420 746f 2060 6054  ace`` set to ``T
-0003a600: 7275 6560 6020 7769 6c6c 206f 7665 7277  rue`` will overw
-0003a610: 7269 7465 2074 6865 0a20 2020 2020 2020  rite the.       
-0003a620: 2070 7265 7669 6f75 736c 7920 7265 6769   previously regi
-0003a630: 7374 6572 6564 2066 756e 6374 696f 6e2e  stered function.
-0003a640: 0a0a 2020 2020 5365 6520 416c 736f 3a0a  ..    See Also:.
-0003a650: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-0003a660: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-0003a670: 6172 6b2e 7564 7466 2e55 4454 4652 6567  ark.udtf.UDTFReg
-0003a680: 6973 7472 6174 696f 6e60 0a0a 0a20 2020  istration`...   
-0003a690: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0003a6a0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
-0003a6b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003a6c0: 7479 7065 7320 696d 706f 7274 2049 6e74  types import Int
-0003a6d0: 6567 6572 5479 7065 2c20 5374 7275 6374  egerType, Struct
-0003a6e0: 4669 656c 642c 2053 7472 7563 7454 7970  Field, StructTyp
-0003a6f0: 650a 2020 2020 2020 2020 3e3e 3e20 636c  e.        >>> cl
-0003a700: 6173 7320 5072 696d 6553 6965 7665 3a0a  ass PrimeSieve:.
-0003a710: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003a720: 6465 6620 7072 6f63 6573 7328 7365 6c66  def process(self
-0003a730: 2c20 6e29 3a0a 2020 2020 2020 2020 2e2e  , n):.        ..
-0003a740: 2e20 2020 2020 2020 2020 6973 5f70 7269  .         is_pri
-0003a750: 6d65 203d 205b 5472 7565 5d20 2a20 286e  me = [True] * (n
-0003a760: 202b 2031 290a 2020 2020 2020 2020 2e2e   + 1).        ..
-0003a770: 2e20 2020 2020 2020 2020 6973 5f70 7269  .         is_pri
-0003a780: 6d65 5b30 5d20 3d20 4661 6c73 650a 2020  me[0] = False.  
-0003a790: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0003a7a0: 2020 6973 5f70 7269 6d65 5b31 5d20 3d20    is_prime[1] = 
-0003a7b0: 4661 6c73 650a 2020 2020 2020 2020 2e2e  False.        ..
-0003a7c0: 2e20 2020 2020 2020 2020 7020 3d20 320a  .         p = 2.
-0003a7d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003a7e0: 2020 2020 7768 696c 6520 7020 2a20 7020      while p * p 
-0003a7f0: 3c3d 206e 3a0a 2020 2020 2020 2020 2e2e  <= n:.        ..
-0003a800: 2e20 2020 2020 2020 2020 2020 2020 6966  .             if
-0003a810: 2069 735f 7072 696d 655b 705d 3a0a 2020   is_prime[p]:.  
-0003a820: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0003a830: 2020 2020 2020 2020 2020 2320 7365 7420            # set 
-0003a840: 616c 6c20 6d75 6c74 6970 6c65 7320 6f66  all multiples of
-0003a850: 2070 2074 6f20 4661 6c73 650a 2020 2020   p to False.    
-0003a860: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0003a870: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0003a880: 2072 616e 6765 2870 202a 2070 2c20 6e20   range(p * p, n 
-0003a890: 2b20 312c 2070 293a 0a20 2020 2020 2020  + 1, p):.       
-0003a8a0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0003a8b0: 2020 2020 2020 2020 2069 735f 7072 696d           is_prim
-0003a8c0: 655b 695d 203d 2046 616c 7365 0a20 2020  e[i] = False.   
-0003a8d0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003a8e0: 2020 2020 2070 202b 3d20 310a 2020 2020       p += 1.    
-0003a8f0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0003a900: 2320 7969 656c 6420 616c 6c20 7072 696d  # yield all prim
-0003a910: 6520 6e75 6d62 6572 730a 2020 2020 2020  e numbers.      
-0003a920: 2020 2e2e 2e20 2020 2020 2020 2020 666f    ...         fo
-0003a930: 7220 7020 696e 2072 616e 6765 2832 2c20  r p in range(2, 
-0003a940: 6e20 2b20 3129 3a0a 2020 2020 2020 2020  n + 1):.        
-0003a950: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0003a960: 6966 2069 735f 7072 696d 655b 705d 3a0a  if is_prime[p]:.
-0003a970: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003a980: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-0003a990: 6420 2870 2c29 0a20 2020 2020 2020 203e  d (p,).        >
-0003a9a0: 3e3e 2070 7269 6d65 5f75 6474 6620 3d20  >> prime_udtf = 
-0003a9b0: 7564 7466 2850 7269 6d65 5369 6576 652c  udtf(PrimeSieve,
-0003a9c0: 206f 7574 7075 745f 7363 6865 6d61 3d53   output_schema=S
-0003a9d0: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
-0003a9e0: 7446 6965 6c64 2822 6e75 6d62 6572 222c  tField("number",
-0003a9f0: 2049 6e74 6567 6572 5479 7065 2829 295d   IntegerType())]
-0003aa00: 292c 2069 6e70 7574 5f74 7970 6573 3d5b  ), input_types=[
-0003aa10: 496e 7465 6765 7254 7970 6528 295d 290a  IntegerType()]).
-0003aa20: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
-0003aa30: 696f 6e2e 7461 626c 655f 6675 6e63 7469  ion.table_functi
-0003aa40: 6f6e 2870 7269 6d65 5f75 6474 6628 6c69  on(prime_udtf(li
-0003aa50: 7428 3230 2929 292e 636f 6c6c 6563 7428  t(20))).collect(
-0003aa60: 290a 2020 2020 2020 2020 5b52 6f77 284e  ).        [Row(N
-0003aa70: 554d 4245 523d 3229 2c20 526f 7728 4e55  UMBER=2), Row(NU
-0003aa80: 4d42 4552 3d33 292c 2052 6f77 284e 554d  MBER=3), Row(NUM
-0003aa90: 4245 523d 3529 2c20 526f 7728 4e55 4d42  BER=5), Row(NUMB
-0003aaa0: 4552 3d37 292c 2052 6f77 284e 554d 4245  ER=7), Row(NUMBE
-0003aab0: 523d 3131 292c 2052 6f77 284e 554d 4245  R=11), Row(NUMBE
-0003aac0: 523d 3133 292c 2052 6f77 284e 554d 4245  R=13), Row(NUMBE
-0003aad0: 523d 3137 292c 2052 6f77 284e 554d 4245  R=17), Row(NUMBE
-0003aae0: 523d 3139 295d 0a0a 2020 2020 2020 2020  R=19)]..        
-0003aaf0: 496e 7374 6561 6420 6f66 2063 616c 6c69  Instead of calli
-0003ab00: 6e67 2060 7564 7466 6020 6974 2069 7320  ng `udtf` it is 
-0003ab10: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
-0003ab20: 2075 7365 2075 6474 6620 6173 2061 2064   use udtf as a d
-0003ab30: 6563 6f72 6174 6f72 2e0a 0a20 2020 2045  ecorator...    E
-0003ab40: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-0003ab50: 2020 3e3e 3e20 4075 6474 6628 6e61 6d65    >>> @udtf(name
-0003ab60: 3d22 616c 745f 696e 7422 2c72 6570 6c61  ="alt_int",repla
-0003ab70: 6365 3d54 7275 652c 206f 7574 7075 745f  ce=True, output_
-0003ab80: 7363 6865 6d61 3d53 7472 7563 7454 7970  schema=StructTyp
-0003ab90: 6528 5b53 7472 7563 7446 6965 6c64 2822  e([StructField("
-0003aba0: 6e75 6d62 6572 222c 2049 6e74 6567 6572  number", Integer
-0003abb0: 5479 7065 2829 295d 292c 2069 6e70 7574  Type())]), input
-0003abc0: 5f74 7970 6573 3d5b 496e 7465 6765 7254  _types=[IntegerT
-0003abd0: 7970 6528 295d 290a 2020 2020 2020 2020  ype()]).        
-0003abe0: 2e2e 2e20 636c 6173 7320 416c 7465 726e  ... class Altern
-0003abf0: 6174 6f72 3a0a 2020 2020 2020 2020 2e2e  ator:.        ..
-0003ac00: 2e20 2020 2020 6465 6620 5f5f 696e 6974  .     def __init
-0003ac10: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-0003ac20: 2020 2e2e 2e20 2020 2020 2020 2020 7365    ...         se
-0003ac30: 6c66 2e5f 706f 7369 7469 7665 203d 2054  lf._positive = T
-0003ac40: 7275 650a 2020 2020 2020 2020 2e2e 2e0a  rue.        ....
-0003ac50: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003ac60: 6465 6620 7072 6f63 6573 7328 7365 6c66  def process(self
-0003ac70: 2c20 6e29 3a0a 2020 2020 2020 2020 2e2e  , n):.        ..
-0003ac80: 2e20 2020 2020 2020 2020 666f 7220 6920  .         for i 
-0003ac90: 696e 2072 616e 6765 286e 293a 0a20 2020  in range(n):.   
-0003aca0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003acb0: 2020 2020 2069 6620 7365 6c66 2e5f 706f       if self._po
-0003acc0: 7369 7469 7665 3a0a 2020 2020 2020 2020  sitive:.        
-0003acd0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0003ace0: 2020 2020 7969 656c 6420 2831 2c29 0a20      yield (1,). 
-0003acf0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0003ad00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003ad10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0003ad20: 2020 2020 2020 2020 2079 6965 6c64 2028           yield (
-0003ad30: 2d31 2c29 0a20 2020 2020 2020 202e 2e2e  -1,).        ...
-0003ad40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003ad50: 662e 5f70 6f73 6974 6976 6520 3d20 6e6f  f._positive = no
-0003ad60: 7420 7365 6c66 2e5f 706f 7369 7469 7665  t self._positive
-0003ad70: 0a20 2020 2020 2020 203e 3e3e 2073 6573  .        >>> ses
-0003ad80: 7369 6f6e 2e74 6162 6c65 5f66 756e 6374  sion.table_funct
-0003ad90: 696f 6e28 2261 6c74 5f69 6e74 222c 206c  ion("alt_int", l
-0003ada0: 6974 2833 2929 2e63 6f6c 6c65 6374 2829  it(3)).collect()
-0003adb0: 0a20 2020 2020 2020 205b 526f 7728 4e55  .        [Row(NU
-0003adc0: 4d42 4552 3d31 292c 2052 6f77 284e 554d  MBER=1), Row(NUM
-0003add0: 4245 523d 2d31 292c 2052 6f77 284e 554d  BER=-1), Row(NUM
-0003ade0: 4245 523d 3129 5d0a 2020 2020 2020 2020  BER=1)].        
-0003adf0: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
-0003ae00: 655f 6675 6e63 7469 6f6e 2822 616c 745f  e_function("alt_
-0003ae10: 696e 7422 2c20 6c69 7428 3229 292e 636f  int", lit(2)).co
-0003ae20: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-0003ae30: 5b52 6f77 284e 554d 4245 523d 3129 2c20  [Row(NUMBER=1), 
-0003ae40: 526f 7728 4e55 4d42 4552 3d2d 3129 5d0a  Row(NUMBER=-1)].
-0003ae50: 2020 2020 2020 2020 3e3e 3e20 7365 7373          >>> sess
-0003ae60: 696f 6e2e 7461 626c 655f 6675 6e63 7469  ion.table_functi
-0003ae70: 6f6e 2822 616c 745f 696e 7422 2c20 6c69  on("alt_int", li
-0003ae80: 7428 3129 292e 636f 6c6c 6563 7428 290a  t(1)).collect().
-0003ae90: 2020 2020 2020 2020 5b52 6f77 284e 554d          [Row(NUM
-0003aea0: 4245 523d 3129 5d0a 2020 2020 2222 220a  BER=1)].    """.
-0003aeb0: 2020 2020 7365 7373 696f 6e20 3d20 7365      session = se
-0003aec0: 7373 696f 6e20 6f72 2073 6e6f 7766 6c61  ssion or snowfla
-0003aed0: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
-0003aee0: 696f 6e2e 5f67 6574 5f61 6374 6976 655f  ion._get_active_
-0003aef0: 7365 7373 696f 6e28 290a 2020 2020 6966  session().    if
-0003af00: 2068 616e 646c 6572 2069 7320 4e6f 6e65   handler is None
-0003af10: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0003af20: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
-0003af30: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0003af40: 7365 7373 696f 6e2e 7564 7466 2e72 6567  session.udtf.reg
-0003af50: 6973 7465 722c 0a20 2020 2020 2020 2020  ister,.         
-0003af60: 2020 206f 7574 7075 745f 7363 6865 6d61     output_schema
-0003af70: 3d6f 7574 7075 745f 7363 6865 6d61 2c0a  =output_schema,.
-0003af80: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0003af90: 745f 7479 7065 733d 696e 7075 745f 7479  t_types=input_ty
-0003afa0: 7065 732c 0a20 2020 2020 2020 2020 2020  pes,.           
-0003afb0: 206e 616d 653d 6e61 6d65 2c0a 2020 2020   name=name,.    
-0003afc0: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
-0003afd0: 6e65 6e74 3d69 735f 7065 726d 616e 656e  nent=is_permanen
-0003afe0: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
-0003aff0: 7461 6765 5f6c 6f63 6174 696f 6e3d 7374  tage_location=st
-0003b000: 6167 655f 6c6f 6361 7469 6f6e 2c0a 2020  age_location,.  
-0003b010: 2020 2020 2020 2020 2020 696d 706f 7274            import
-0003b020: 733d 696d 706f 7274 732c 0a20 2020 2020  s=imports,.     
-0003b030: 2020 2020 2020 2070 6163 6b61 6765 733d         packages=
-0003b040: 7061 636b 6167 6573 2c0a 2020 2020 2020  packages,.      
-0003b050: 2020 2020 2020 7265 706c 6163 653d 7265        replace=re
-0003b060: 706c 6163 652c 0a20 2020 2020 2020 2020  place,.         
-0003b070: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
-0003b080: 3d69 665f 6e6f 745f 6578 6973 7473 2c0a  =if_not_exists,.
-0003b090: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0003b0a0: 6c6c 656c 3d70 6172 616c 6c65 6c2c 0a20  llel=parallel,. 
-0003b0b0: 2020 2020 2020 2020 2020 2073 7461 7465             state
-0003b0c0: 6d65 6e74 5f70 6172 616d 733d 7374 6174  ment_params=stat
-0003b0d0: 656d 656e 745f 7061 7261 6d73 2c0a 2020  ement_params,.  
-0003b0e0: 2020 2020 2020 2020 2020 7374 7269 6374            strict
-0003b0f0: 3d73 7472 6963 742c 0a20 2020 2020 2020  =strict,.       
-0003b100: 2020 2020 2073 6563 7572 653d 7365 6375       secure=secu
-0003b110: 7265 2c0a 2020 2020 2020 2020 290a 2020  re,.        ).  
-0003b120: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003b130: 7265 7475 726e 2073 6573 7369 6f6e 2e75  return session.u
-0003b140: 6474 662e 7265 6769 7374 6572 280a 2020  dtf.register(.  
-0003b150: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
-0003b160: 722c 0a20 2020 2020 2020 2020 2020 206f  r,.            o
-0003b170: 7574 7075 745f 7363 6865 6d61 3d6f 7574  utput_schema=out
-0003b180: 7075 745f 7363 6865 6d61 2c0a 2020 2020  put_schema,.    
-0003b190: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
-0003b1a0: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
-0003b1b0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0003b1c0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
-0003b1d0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
-0003b1e0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
-0003b1f0: 2020 2020 2020 2020 2020 2073 7461 6765             stage
-0003b200: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
-0003b210: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
-0003b220: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
-0003b230: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
-0003b240: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
-0003b250: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
-0003b260: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
-0003b270: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-0003b280: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
-0003b290: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
-0003b2a0: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
-0003b2b0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
-0003b2c0: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
-0003b2d0: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
-0003b2e0: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
-0003b2f0: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
-0003b300: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-0003b310: 2073 6563 7572 653d 7365 6375 7265 2c0a   secure=secure,.
-0003b320: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
-0003b330: 7061 6e64 6173 5f75 6466 280a 2020 2020  pandas_udf(.    
-0003b340: 6675 6e63 3a20 4f70 7469 6f6e 616c 5b43  func: Optional[C
-0003b350: 616c 6c61 626c 655d 203d 204e 6f6e 652c  allable] = None,
-0003b360: 0a20 2020 202a 2c0a 2020 2020 7265 7475  .    *,.    retu
-0003b370: 726e 5f74 7970 653a 204f 7074 696f 6e61  rn_type: Optiona
-0003b380: 6c5b 4461 7461 5479 7065 5d20 3d20 4e6f  l[DataType] = No
-0003b390: 6e65 2c0a 2020 2020 696e 7075 745f 7479  ne,.    input_ty
-0003b3a0: 7065 733a 204f 7074 696f 6e61 6c5b 4c69  pes: Optional[Li
-0003b3b0: 7374 5b44 6174 6154 7970 655d 5d20 3d20  st[DataType]] = 
-0003b3c0: 4e6f 6e65 2c0a 2020 2020 6e61 6d65 3a20  None,.    name: 
-0003b3d0: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b73  Optional[Union[s
-0003b3e0: 7472 2c20 4974 6572 6162 6c65 5b73 7472  tr, Iterable[str
-0003b3f0: 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ]]] = None,.    
-0003b400: 6973 5f70 6572 6d61 6e65 6e74 3a20 626f  is_permanent: bo
-0003b410: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0003b420: 7374 6167 655f 6c6f 6361 7469 6f6e 3a20  stage_location: 
-0003b430: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0003b440: 4e6f 6e65 2c0a 2020 2020 696d 706f 7274  None,.    import
-0003b450: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-0003b460: 5b55 6e69 6f6e 5b73 7472 2c20 5475 706c  [Union[str, Tupl
-0003b470: 655b 7374 722c 2073 7472 5d5d 5d5d 203d  e[str, str]]]] =
-0003b480: 204e 6f6e 652c 0a20 2020 2070 6163 6b61   None,.    packa
-0003b490: 6765 733a 204f 7074 696f 6e61 6c5b 4c69  ges: Optional[Li
-0003b4a0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 4d6f  st[Union[str, Mo
-0003b4b0: 6475 6c65 5479 7065 5d5d 5d20 3d20 4e6f  duleType]]] = No
-0003b4c0: 6e65 2c0a 2020 2020 7265 706c 6163 653a  ne,.    replace:
-0003b4d0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0003b4e0: 2020 2069 665f 6e6f 745f 6578 6973 7473     if_not_exists
-0003b4f0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0003b500: 2020 2020 7365 7373 696f 6e3a 204f 7074      session: Opt
-0003b510: 696f 6e61 6c5b 2273 6e6f 7766 6c61 6b65  ional["snowflake
-0003b520: 2e73 6e6f 7770 6172 6b2e 7365 7373 696f  .snowpark.sessio
-0003b530: 6e2e 5365 7373 696f 6e22 5d20 3d20 4e6f  n.Session"] = No
-0003b540: 6e65 2c0a 2020 2020 7061 7261 6c6c 656c  ne,.    parallel
-0003b550: 3a20 696e 7420 3d20 342c 0a20 2020 206d  : int = 4,.    m
-0003b560: 6178 5f62 6174 6368 5f73 697a 653a 204f  ax_batch_size: O
-0003b570: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
-0003b580: 6f6e 652c 0a20 2020 2073 7461 7465 6d65  one,.    stateme
-0003b590: 6e74 5f70 6172 616d 733a 204f 7074 696f  nt_params: Optio
-0003b5a0: 6e61 6c5b 4469 6374 5b73 7472 2c20 7374  nal[Dict[str, st
-0003b5b0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-0003b5c0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
-0003b5d0: 6c61 793a 2062 6f6f 6c20 3d20 5472 7565  lay: bool = True
-0003b5e0: 2c0a 2920 2d3e 2055 6e69 6f6e 5b55 7365  ,.) -> Union[Use
-0003b5f0: 7244 6566 696e 6564 4675 6e63 7469 6f6e  rDefinedFunction
-0003b600: 2c20 6675 6e63 746f 6f6c 732e 7061 7274  , functools.part
-0003b610: 6961 6c5d 3a0a 2020 2020 2222 220a 2020  ial]:.    """.  
-0003b620: 2020 5265 6769 7374 6572 7320 6120 5079    Registers a Py
-0003b630: 7468 6f6e 2066 756e 6374 696f 6e20 6173  thon function as
-0003b640: 2061 2076 6563 746f 7269 7a65 6420 5544   a vectorized UD
-0003b650: 4620 616e 6420 7265 7475 726e 7320 7468  F and returns th
-0003b660: 6520 5544 462e 0a20 2020 2054 6865 2061  e UDF..    The a
-0003b670: 7267 756d 656e 7473 2c20 7265 7475 726e  rguments, return
-0003b680: 2076 616c 7565 2061 6e64 2075 7361 6765   value and usage
-0003b690: 206f 6620 7468 6973 2066 756e 6374 696f   of this functio
-0003b6a0: 6e20 6172 6520 6578 6163 746c 7920 7468  n are exactly th
-0003b6b0: 6520 7361 6d65 2061 730a 2020 2020 3a66  e same as.    :f
-0003b6c0: 756e 633a 6075 6466 602c 2062 7574 2074  unc:`udf`, but t
-0003b6d0: 6869 7320 6675 6e63 7469 6f6e 2063 616e  his function can
-0003b6e0: 206f 6e6c 7920 6265 2075 7365 6420 666f   only be used fo
-0003b6f0: 7220 7265 6769 7374 6572 696e 6720 7665  r registering ve
-0003b700: 6374 6f72 697a 6564 2055 4446 732e 0a20  ctorized UDFs.. 
-0003b710: 2020 2053 6565 2065 7861 6d70 6c65 7320     See examples 
-0003b720: 696e 203a 636c 6173 733a 607e 736e 6f77  in :class:`~snow
-0003b730: 666c 616b 652e 736e 6f77 7061 726b 2e75  flake.snowpark.u
-0003b740: 6466 2e55 4446 5265 6769 7374 7261 7469  df.UDFRegistrati
-0003b750: 6f6e 602e 0a0a 2020 2020 5365 6520 416c  on`...    See Al
-0003b760: 736f 3a0a 2020 2020 2020 2020 2d20 3a66  so:.        - :f
-0003b770: 756e 633a 6075 6466 600a 2020 2020 2020  unc:`udf`.      
-0003b780: 2020 2d20 3a6d 6574 683a 6055 4446 5265    - :meth:`UDFRe
-0003b790: 6769 7374 7261 7469 6f6e 2e72 6567 6973  gistration.regis
-0003b7a0: 7465 7228 2920 3c73 6e6f 7766 6c61 6b65  ter() <snowflake
-0003b7b0: 2e73 6e6f 7770 6172 6b2e 7564 662e 5544  .snowpark.udf.UD
-0003b7c0: 4652 6567 6973 7472 6174 696f 6e2e 7265  FRegistration.re
-0003b7d0: 6769 7374 6572 3e60 0a0a 2020 2020 4578  gister>`..    Ex
-0003b7e0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-0003b7f0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
-0003b800: 616b 652e 736e 6f77 7061 726b 2e74 7970  ake.snowpark.typ
-0003b810: 6573 2069 6d70 6f72 7420 5061 6e64 6173  es import Pandas
-0003b820: 5365 7269 6573 5479 7065 2c20 5061 6e64  SeriesType, Pand
-0003b830: 6173 4461 7461 4672 616d 6554 7970 652c  asDataFrameType,
-0003b840: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
-0003b850: 2020 2020 203e 3e3e 2061 6464 5f6f 6e65       >>> add_one
-0003b860: 5f64 665f 7061 6e64 6173 5f75 6466 203d  _df_pandas_udf =
-0003b870: 2070 616e 6461 735f 7564 6628 0a20 2020   pandas_udf(.   
-0003b880: 2020 2020 202e 2e2e 2020 2020 206c 616d       ...     lam
-0003b890: 6264 6120 6466 3a20 6466 5b30 5d20 2b20  bda df: df[0] + 
-0003b8a0: 6466 5b31 5d20 2b20 312c 0a20 2020 2020  df[1] + 1,.     
-0003b8b0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
-0003b8c0: 6e5f 7479 7065 3d50 616e 6461 7353 6572  n_type=PandasSer
-0003b8d0: 6965 7354 7970 6528 496e 7465 6765 7254  iesType(IntegerT
-0003b8e0: 7970 6528 2929 2c0a 2020 2020 2020 2020  ype()),.        
-0003b8f0: 2e2e 2e20 2020 2020 696e 7075 745f 7479  ...     input_ty
-0003b900: 7065 733d 5b50 616e 6461 7344 6174 6146  pes=[PandasDataF
-0003b910: 7261 6d65 5479 7065 285b 496e 7465 6765  rameType([Intege
-0003b920: 7254 7970 6528 292c 2049 6e74 6567 6572  rType(), Integer
-0003b930: 5479 7065 2829 5d29 5d0a 2020 2020 2020  Type()])].      
-0003b940: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
-0003b950: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
-0003b960: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
-0003b970: 6528 5b5b 312c 2032 5d2c 205b 332c 2034  e([[1, 2], [3, 4
-0003b980: 5d5d 2c20 7363 6865 6d61 3d5b 2261 222c  ]], schema=["a",
-0003b990: 2022 6222 5d29 0a20 2020 2020 2020 203e   "b"]).        >
-0003b9a0: 3e3e 2064 662e 7365 6c65 6374 2861 6464  >> df.select(add
-0003b9b0: 5f6f 6e65 5f64 665f 7061 6e64 6173 5f75  _one_df_pandas_u
-0003b9c0: 6466 2822 6122 2c20 2262 2229 2e61 6c69  df("a", "b").ali
-0003b9d0: 6173 2822 7265 7375 6c74 2229 292e 6f72  as("result")).or
-0003b9e0: 6465 725f 6279 2822 7265 7375 6c74 2229  der_by("result")
-0003b9f0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0003ba00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-0003ba10: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
-0003ba20: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-0003ba30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
-0003ba40: 3420 2020 2020 2020 2020 7c0a 2020 2020  4         |.    
-0003ba50: 2020 2020 7c38 2020 2020 2020 2020 207c      |8         |
-0003ba60: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003ba70: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
-0003ba80: 4c41 4e4b 4c49 4e45 3e0a 0a20 2020 206f  LANKLINE>..    o
-0003ba90: 7220 6173 206e 616d 6564 2050 616e 6461  r as named Panda
-0003baa0: 7320 5544 4673 2074 6861 7420 6172 6520  s UDFs that are 
-0003bab0: 6163 6365 7369 626c 6520 696e 2074 6865  accesible in the
-0003bac0: 2073 616d 6520 7365 7373 696f 6e2e 2049   same session. I
-0003bad0: 6e73 7465 6164 206f 6620 6361 6c6c 696e  nstead of callin
-0003bae0: 6720 6070 616e 6461 735f 7564 6660 2061  g `pandas_udf` a
-0003baf0: 7320 6675 6e63 7469 6f6e 2c0a 2020 2020  s function,.    
-0003bb00: 6974 2063 616e 2062 6520 616c 736f 2075  it can be also u
-0003bb10: 7365 6420 6173 2061 2064 6563 6f72 6174  sed as a decorat
-0003bb20: 6f72 3a0a 0a20 2020 2045 7861 6d70 6c65  or:..    Example
-0003bb30: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0003bb40: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
-0003bb50: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
-0003bb60: 706f 7274 2050 616e 6461 7353 6572 6965  port PandasSerie
-0003bb70: 7354 7970 652c 2050 616e 6461 7344 6174  sType, PandasDat
-0003bb80: 6146 7261 6d65 5479 7065 2c20 496e 7465  aFrameType, Inte
-0003bb90: 6765 7254 7970 650a 2020 2020 2020 2020  gerType.        
-0003bba0: 3e3e 3e20 4070 616e 6461 735f 7564 6628  >>> @pandas_udf(
-0003bbb0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0003bbc0: 2072 6574 7572 6e5f 7479 7065 3d50 616e   return_type=Pan
-0003bbd0: 6461 7353 6572 6965 7354 7970 6528 496e  dasSeriesType(In
-0003bbe0: 7465 6765 7254 7970 6528 2929 2c0a 2020  tegerType()),.  
-0003bbf0: 2020 2020 2020 2e2e 2e20 2020 2020 696e        ...     in
-0003bc00: 7075 745f 7479 7065 733d 5b50 616e 6461  put_types=[Panda
-0003bc10: 7344 6174 6146 7261 6d65 5479 7065 285b  sDataFrameType([
-0003bc20: 496e 7465 6765 7254 7970 6528 292c 2049  IntegerType(), I
-0003bc30: 6e74 6567 6572 5479 7065 2829 5d29 5d2c  ntegerType()])],
-0003bc40: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-0003bc50: 2020 2020 2020 202e 2e2e 2064 6566 2061         ... def a
-0003bc60: 6464 5f6f 6e65 5f64 665f 7061 6e64 6173  dd_one_df_pandas
-0003bc70: 5f75 6466 2864 6629 3a0a 2020 2020 2020  _udf(df):.      
-0003bc80: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
-0003bc90: 2064 665b 305d 202b 2064 665b 315d 202b   df[0] + df[1] +
-0003bca0: 2031 0a20 2020 2020 2020 203e 3e3e 2064   1.        >>> d
-0003bcb0: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
-0003bcc0: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
-0003bcd0: 2c20 325d 2c20 5b33 2c20 345d 5d2c 2073  , 2], [3, 4]], s
-0003bce0: 6368 656d 613d 5b22 6122 2c20 2262 225d  chema=["a", "b"]
-0003bcf0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0003bd00: 2e73 656c 6563 7428 6164 645f 6f6e 655f  .select(add_one_
-0003bd10: 6466 5f70 616e 6461 735f 7564 6628 2261  df_pandas_udf("a
-0003bd20: 222c 2022 6222 292e 616c 6961 7328 2272  ", "b").alias("r
-0003bd30: 6573 756c 7422 2929 2e6f 7264 6572 5f62  esult")).order_b
-0003bd40: 7928 2272 6573 756c 7422 292e 7368 6f77  y("result").show
-0003bd50: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0003bd60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003bd70: 7c22 5245 5355 4c54 2220 207c 0a20 2020  |"RESULT"  |.   
-0003bd80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0003bd90: 2d0a 2020 2020 2020 2020 7c34 2020 2020  -.        |4    
-0003bda0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
-0003bdb0: 3820 2020 2020 2020 2020 7c0a 2020 2020  8         |.    
-0003bdc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0003bdd0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
-0003bde0: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
-0003bdf0: 2073 6573 7369 6f6e 203d 2073 6573 7369   session = sessi
-0003be00: 6f6e 206f 7220 736e 6f77 666c 616b 652e  on or snowflake.
-0003be10: 736e 6f77 7061 726b 2e73 6573 7369 6f6e  snowpark.session
-0003be20: 2e5f 6765 745f 6163 7469 7665 5f73 6573  ._get_active_ses
-0003be30: 7369 6f6e 2829 0a20 2020 2069 6620 6675  sion().    if fu
-0003be40: 6e63 2069 7320 4e6f 6e65 3a0a 2020 2020  nc is None:.    
-0003be50: 2020 2020 7265 7475 726e 2066 756e 6374      return funct
-0003be60: 6f6f 6c73 2e70 6172 7469 616c 280a 2020  ools.partial(.  
-0003be70: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
-0003be80: 6e2e 7564 662e 7265 6769 7374 6572 2c0a  n.udf.register,.
-0003be90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003bea0: 726e 5f74 7970 653d 7265 7475 726e 5f74  rn_type=return_t
-0003beb0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0003bec0: 2069 6e70 7574 5f74 7970 6573 3d69 6e70   input_types=inp
-0003bed0: 7574 5f74 7970 6573 2c0a 2020 2020 2020  ut_types,.      
-0003bee0: 2020 2020 2020 6e61 6d65 3d6e 616d 652c        name=name,
-0003bef0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-0003bf00: 7065 726d 616e 656e 743d 6973 5f70 6572  permanent=is_per
-0003bf10: 6d61 6e65 6e74 2c0a 2020 2020 2020 2020  manent,.        
-0003bf20: 2020 2020 7374 6167 655f 6c6f 6361 7469      stage_locati
-0003bf30: 6f6e 3d73 7461 6765 5f6c 6f63 6174 696f  on=stage_locatio
-0003bf40: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
-0003bf50: 6d70 6f72 7473 3d69 6d70 6f72 7473 2c0a  mports=imports,.
-0003bf60: 2020 2020 2020 2020 2020 2020 7061 636b              pack
-0003bf70: 6167 6573 3d70 6163 6b61 6765 732c 0a20  ages=packages,. 
-0003bf80: 2020 2020 2020 2020 2020 2072 6570 6c61             repla
-0003bf90: 6365 3d72 6570 6c61 6365 2c0a 2020 2020  ce=replace,.    
-0003bfa0: 2020 2020 2020 2020 6966 5f6e 6f74 5f65          if_not_e
-0003bfb0: 7869 7374 733d 6966 5f6e 6f74 5f65 7869  xists=if_not_exi
-0003bfc0: 7374 732c 0a20 2020 2020 2020 2020 2020  sts,.           
-0003bfd0: 2070 6172 616c 6c65 6c3d 7061 7261 6c6c   parallel=parall
-0003bfe0: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
-0003bff0: 6d61 785f 6261 7463 685f 7369 7a65 3d6d  max_batch_size=m
-0003c000: 6178 5f62 6174 6368 5f73 697a 652c 0a20  ax_batch_size,. 
-0003c010: 2020 2020 2020 2020 2020 205f 6672 6f6d             _from
-0003c020: 5f70 616e 6461 735f 7564 665f 6675 6e63  _pandas_udf_func
-0003c030: 7469 6f6e 3d54 7275 652c 0a20 2020 2020  tion=True,.     
-0003c040: 2020 2020 2020 2073 7461 7465 6d65 6e74         statement
-0003c050: 5f70 6172 616d 733d 7374 6174 656d 656e  _params=statemen
-0003c060: 745f 7061 7261 6d73 2c0a 2020 2020 2020  t_params,.      
-0003c070: 2020 2020 2020 736f 7572 6365 5f63 6f64        source_cod
-0003c080: 655f 6469 7370 6c61 793d 736f 7572 6365  e_display=source
-0003c090: 5f63 6f64 655f 6469 7370 6c61 792c 0a20  _code_display,. 
-0003c0a0: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
-0003c0b0: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-0003c0c0: 6e20 7365 7373 696f 6e2e 7564 662e 7265  n session.udf.re
-0003c0d0: 6769 7374 6572 280a 2020 2020 2020 2020  gister(.        
-0003c0e0: 2020 2020 6675 6e63 2c0a 2020 2020 2020      func,.      
-0003c0f0: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
-0003c100: 653d 7265 7475 726e 5f74 7970 652c 0a20  e=return_type,. 
-0003c110: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-0003c120: 5f74 7970 6573 3d69 6e70 7574 5f74 7970  _types=input_typ
-0003c130: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0003c140: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
-0003c150: 2020 2020 2020 2069 735f 7065 726d 616e         is_perman
-0003c160: 656e 743d 6973 5f70 6572 6d61 6e65 6e74  ent=is_permanent
-0003c170: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-0003c180: 6167 655f 6c6f 6361 7469 6f6e 3d73 7461  age_location=sta
-0003c190: 6765 5f6c 6f63 6174 696f 6e2c 0a20 2020  ge_location,.   
-0003c1a0: 2020 2020 2020 2020 2069 6d70 6f72 7473           imports
-0003c1b0: 3d69 6d70 6f72 7473 2c0a 2020 2020 2020  =imports,.      
-0003c1c0: 2020 2020 2020 7061 636b 6167 6573 3d70        packages=p
-0003c1d0: 6163 6b61 6765 732c 0a20 2020 2020 2020  ackages,.       
-0003c1e0: 2020 2020 2072 6570 6c61 6365 3d72 6570       replace=rep
-0003c1f0: 6c61 6365 2c0a 2020 2020 2020 2020 2020  lace,.          
-0003c200: 2020 6966 5f6e 6f74 5f65 7869 7374 733d    if_not_exists=
-0003c210: 6966 5f6e 6f74 5f65 7869 7374 732c 0a20  if_not_exists,. 
-0003c220: 2020 2020 2020 2020 2020 2070 6172 616c             paral
-0003c230: 6c65 6c3d 7061 7261 6c6c 656c 2c0a 2020  lel=parallel,.  
-0003c240: 2020 2020 2020 2020 2020 6d61 785f 6261            max_ba
-0003c250: 7463 685f 7369 7a65 3d6d 6178 5f62 6174  tch_size=max_bat
-0003c260: 6368 5f73 697a 652c 0a20 2020 2020 2020  ch_size,.       
-0003c270: 2020 2020 205f 6672 6f6d 5f70 616e 6461       _from_panda
-0003c280: 735f 7564 665f 6675 6e63 7469 6f6e 3d54  s_udf_function=T
-0003c290: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0003c2a0: 2073 7461 7465 6d65 6e74 5f70 6172 616d   statement_param
-0003c2b0: 733d 7374 6174 656d 656e 745f 7061 7261  s=statement_para
-0003c2c0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-0003c2d0: 736f 7572 6365 5f63 6f64 655f 6469 7370  source_code_disp
-0003c2e0: 6c61 793d 736f 7572 6365 5f63 6f64 655f  lay=source_code_
-0003c2f0: 6469 7370 6c61 792c 0a20 2020 2020 2020  display,.       
-0003c300: 2029 0a0a 0a64 6566 2063 616c 6c5f 7564   )...def call_ud
-0003c310: 6628 0a20 2020 2075 6466 5f6e 616d 653a  f(.    udf_name:
-0003c320: 2073 7472 2c0a 2020 2020 2a61 7267 733a   str,.    *args:
-0003c330: 2043 6f6c 756d 6e4f 724c 6974 6572 616c   ColumnOrLiteral
-0003c340: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
-0003c350: 2020 2022 2222 4361 6c6c 7320 6120 7573     """Calls a us
-0003c360: 6572 2d64 6566 696e 6564 2066 756e 6374  er-defined funct
-0003c370: 696f 6e20 2855 4446 2920 6279 206e 616d  ion (UDF) by nam
-0003c380: 652e 0a0a 2020 2020 4172 6773 3a0a 2020  e...    Args:.  
-0003c390: 2020 2020 2020 7564 665f 6e61 6d65 3a20        udf_name: 
-0003c3a0: 5468 6520 6e61 6d65 206f 6620 5544 4620  The name of UDF 
-0003c3b0: 696e 2053 6e6f 7766 6c61 6b65 2e0a 2020  in Snowflake..  
-0003c3c0: 2020 2020 2020 6172 6773 3a20 4172 6775        args: Argu
-0003c3d0: 6d65 6e74 7320 6361 6e20 6265 2069 6e20  ments can be in 
-0003c3e0: 7477 6f20 7479 7065 733a 0a0a 2020 2020  two types:..    
-0003c3f0: 2020 2020 2020 2020 2d20 3a63 6c61 7373          - :class
-0003c400: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-0003c410: 7770 6172 6b2e 436f 6c75 6d6e 602c 206f  wpark.Column`, o
-0003c420: 720a 2020 2020 2020 2020 2020 2020 2d20  r.            - 
-0003c430: 4261 7369 6320 5079 7468 6f6e 2074 7970  Basic Python typ
-0003c440: 6573 2c20 7768 6963 6820 6172 6520 636f  es, which are co
-0003c450: 6e76 6572 7465 6420 746f 2053 6e6f 7770  nverted to Snowp
-0003c460: 6172 6b20 6c69 7465 7261 6c73 2e0a 0a20  ark literals... 
-0003c470: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
-0003c480: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
-0003c490: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0003c4a0: 2e74 7970 6573 2069 6d70 6f72 7420 496e  .types import In
-0003c4b0: 7465 6765 7254 7970 650a 2020 2020 2020  tegerType.      
-0003c4c0: 2020 3e3e 3e20 7564 665f 6465 6620 3d20    >>> udf_def = 
-0003c4d0: 7365 7373 696f 6e2e 7564 662e 7265 6769  session.udf.regi
-0003c4e0: 7374 6572 286c 616d 6264 6120 782c 2079  ster(lambda x, y
-0003c4f0: 3a20 7820 2b20 792c 206e 616d 653d 2261  : x + y, name="a
-0003c500: 6464 5f63 6f6c 756d 6e73 222c 2069 6e70  dd_columns", inp
-0003c510: 7574 5f74 7970 6573 3d5b 496e 7465 6765  ut_types=[Intege
-0003c520: 7254 7970 6528 292c 2049 6e74 6567 6572  rType(), Integer
-0003c530: 5479 7065 2829 5d2c 2072 6574 7572 6e5f  Type()], return_
-0003c540: 7479 7065 3d49 6e74 6567 6572 5479 7065  type=IntegerType
-0003c550: 2829 2c20 7265 706c 6163 653d 5472 7565  (), replace=True
-0003c560: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
-0003c570: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
-0003c580: 655f 6461 7461 6672 616d 6528 5b5b 312c  e_dataframe([[1,
-0003c590: 2032 5d5d 2c20 7363 6865 6d61 3d5b 2261   2]], schema=["a
-0003c5a0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
-0003c5b0: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
-0003c5c0: 616c 6c5f 7564 6628 2261 6464 5f63 6f6c  all_udf("add_col
-0003c5d0: 756d 6e73 222c 2063 6f6c 2822 6122 292c  umns", col("a"),
-0003c5e0: 2063 6f6c 2822 6222 2929 292e 7368 6f77   col("b"))).show
-0003c5f0: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0003c600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c610: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0003c620: 2020 207c 2241 4444 5f43 4f4c 554d 4e53     |"ADD_COLUMNS
-0003c630: 2822 2241 2222 2c20 2222 4222 2229 2220  (""A"", ""B"")" 
-0003c640: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0003c650: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c660: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0003c670: 2020 207c 3320 2020 2020 2020 2020 2020     |3           
-0003c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c690: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
-0003c6a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003c6b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0003c6c0: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
-0003c6d0: 2020 2022 2222 0a0a 2020 2020 7661 6c69     """..    vali
-0003c6e0: 6461 7465 5f6f 626a 6563 745f 6e61 6d65  date_object_name
-0003c6f0: 2875 6466 5f6e 616d 6529 0a20 2020 2072  (udf_name).    r
-0003c700: 6574 7572 6e20 5f63 616c 6c5f 6675 6e63  eturn _call_func
-0003c710: 7469 6f6e 2875 6466 5f6e 616d 652c 2046  tion(udf_name, F
-0003c720: 616c 7365 2c20 2a61 7267 732c 2061 7069  alse, *args, api
-0003c730: 5f63 616c 6c5f 736f 7572 6365 3d22 6675  _call_source="fu
-0003c740: 6e63 7469 6f6e 732e 6361 6c6c 5f75 6466  nctions.call_udf
-0003c750: 2229 0a0a 0a64 6566 2063 616c 6c5f 7461  ")...def call_ta
-0003c760: 626c 655f 6675 6e63 7469 6f6e 280a 2020  ble_function(.  
-0003c770: 2020 6675 6e63 7469 6f6e 5f6e 616d 653a    function_name:
-0003c780: 2073 7472 2c20 2a61 7267 733a 2043 6f6c   str, *args: Col
-0003c790: 756d 6e4f 724c 6974 6572 616c 2c20 2a2a  umnOrLiteral, **
-0003c7a0: 6b77 6172 6773 3a20 436f 6c75 6d6e 4f72  kwargs: ColumnOr
-0003c7b0: 4c69 7465 7261 6c0a 2920 2d3e 2022 736e  Literal.) -> "sn
-0003c7c0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0003c7d0: 2e74 6162 6c65 5f66 756e 6374 696f 6e2e  .table_function.
-0003c7e0: 5461 626c 6546 756e 6374 696f 6e43 616c  TableFunctionCal
-0003c7f0: 6c22 3a0a 2020 2020 2222 2249 6e76 6f6b  l":.    """Invok
-0003c800: 6573 2061 2053 6e6f 7766 6c61 6b65 2074  es a Snowflake t
-0003c810: 6162 6c65 2066 756e 6374 696f 6e2c 2069  able function, i
-0003c820: 6e63 6c75 6469 6e67 2073 7973 7465 6d2d  ncluding system-
-0003c830: 6465 6669 6e65 6420 7461 626c 6520 6675  defined table fu
-0003c840: 6e63 7469 6f6e 7320 616e 6420 7573 6572  nctions and user
-0003c850: 2d64 6566 696e 6564 2074 6162 6c65 2066  -defined table f
-0003c860: 756e 6374 696f 6e73 2e0a 0a20 2020 2049  unctions...    I
-0003c870: 7420 7265 7475 726e 7320 6120 3a6d 6574  t returns a :met
-0003c880: 683a 607e 736e 6f77 666c 616b 652e 736e  h:`~snowflake.sn
-0003c890: 6f77 7061 726b 2e74 6162 6c65 5f66 756e  owpark.table_fun
-0003c8a0: 6374 696f 6e2e 5461 626c 6546 756e 6374  ction.TableFunct
-0003c8b0: 696f 6e43 616c 6c60 2073 6f20 796f 7520  ionCall` so you 
-0003c8c0: 6361 6e20 7370 6563 6966 7920 7468 6520  can specify the 
-0003c8d0: 7061 7274 6974 696f 6e20 636c 6175 7365  partition clause
-0003c8e0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-0003c8f0: 2020 2020 2066 756e 6374 696f 6e5f 6e61       function_na
-0003c900: 6d65 3a20 5468 6520 6e61 6d65 206f 6620  me: The name of 
-0003c910: 7468 6520 7461 626c 6520 6675 6e63 7469  the table functi
-0003c920: 6f6e 2e0a 2020 2020 2020 2020 6172 6773  on..        args
-0003c930: 3a20 5468 6520 706f 7369 7469 6f6e 616c  : The positional
-0003c940: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
-0003c950: 6520 7461 626c 6520 6675 6e63 7469 6f6e  e table function
-0003c960: 2e0a 2020 2020 2020 2020 2a2a 6b77 6172  ..        **kwar
-0003c970: 6773 3a20 5468 6520 6e61 6d65 6420 6172  gs: The named ar
-0003c980: 6775 6d65 6e74 7320 6f66 2074 6865 2074  guments of the t
-0003c990: 6162 6c65 2066 756e 6374 696f 6e2e 2053  able function. S
-0003c9a0: 6f6d 6520 7461 626c 6520 6675 6e63 7469  ome table functi
-0003c9b0: 6f6e 7320 2865 2e67 2e2c 2060 6066 6c61  ons (e.g., ``fla
-0003c9c0: 7474 656e 6060 2920 6861 7665 206e 616d  tten``) have nam
-0003c9d0: 6564 2061 7267 756d 656e 7473 2069 6e73  ed arguments ins
-0003c9e0: 7465 6164 206f 6620 706f 7369 7469 6f6e  tead of position
-0003c9f0: 616c 206f 6e65 732e 0a0a 2020 2020 4578  al ones...    Ex
-0003ca00: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-0003ca10: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0003ca20: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
-0003ca30: 7469 6f6e 7320 696d 706f 7274 206c 6974  tions import lit
-0003ca40: 0a20 2020 2020 2020 203e 3e3e 2073 6573  .        >>> ses
-0003ca50: 7369 6f6e 2e74 6162 6c65 5f66 756e 6374  sion.table_funct
-0003ca60: 696f 6e28 6361 6c6c 5f74 6162 6c65 5f66  ion(call_table_f
-0003ca70: 756e 6374 696f 6e28 2273 706c 6974 5f74  unction("split_t
-0003ca80: 6f5f 7461 626c 6522 2c20 6c69 7428 2273  o_table", lit("s
-0003ca90: 706c 6974 2077 6f72 6473 2074 6f20 7461  plit words to ta
-0003caa0: 626c 6522 292c 206c 6974 2822 2022 2929  ble"), lit(" "))
-0003cab0: 2e6f 7665 7228 2929 2e63 6f6c 6c65 6374  .over()).collect
-0003cac0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
-0003cad0: 5345 513d 312c 2049 4e44 4558 3d31 2c20  SEQ=1, INDEX=1, 
-0003cae0: 5641 4c55 453d 2773 706c 6974 2729 2c20  VALUE='split'), 
-0003caf0: 526f 7728 5345 513d 312c 2049 4e44 4558  Row(SEQ=1, INDEX
-0003cb00: 3d32 2c20 5641 4c55 453d 2777 6f72 6473  =2, VALUE='words
-0003cb10: 2729 2c20 526f 7728 5345 513d 312c 2049  '), Row(SEQ=1, I
-0003cb20: 4e44 4558 3d33 2c20 5641 4c55 453d 2774  NDEX=3, VALUE='t
-0003cb30: 6f27 292c 2052 6f77 2853 4551 3d31 2c20  o'), Row(SEQ=1, 
-0003cb40: 494e 4445 583d 342c 2056 414c 5545 3d27  INDEX=4, VALUE='
-0003cb50: 7461 626c 6527 295d 0a20 2020 2022 2222  table')].    """
-0003cb60: 0a20 2020 2072 6574 7572 6e20 736e 6f77  .    return snow
-0003cb70: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0003cb80: 6162 6c65 5f66 756e 6374 696f 6e2e 5461  able_function.Ta
-0003cb90: 626c 6546 756e 6374 696f 6e43 616c 6c28  bleFunctionCall(
-0003cba0: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
-0003cbb0: 6e5f 6e61 6d65 2c20 2a61 7267 732c 202a  n_name, *args, *
-0003cbc0: 2a6b 7761 7267 730a 2020 2020 290a 0a0a  *kwargs.    )...
-0003cbd0: 6465 6620 7461 626c 655f 6675 6e63 7469  def table_functi
-0003cbe0: 6f6e 2866 756e 6374 696f 6e5f 6e61 6d65  on(function_name
-0003cbf0: 3a20 7374 7229 202d 3e20 4361 6c6c 6162  : str) -> Callab
-0003cc00: 6c65 3a0a 2020 2020 2222 2243 7265 6174  le:.    """Creat
-0003cc10: 6520 6120 6675 6e63 7469 6f6e 206f 626a  e a function obj
-0003cc20: 6563 7420 746f 2069 6e76 6f6b 6520 6120  ect to invoke a 
-0003cc30: 536e 6f77 666c 616b 6520 7461 626c 6520  Snowflake table 
-0003cc40: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2041  function...    A
-0003cc50: 7267 733a 0a20 2020 2020 2020 2066 756e  rgs:.        fun
-0003cc60: 6374 696f 6e5f 6e61 6d65 3a20 5468 6520  ction_name: The 
-0003cc70: 6e61 6d65 206f 6620 7468 6520 7461 626c  name of the tabl
-0003cc80: 6520 6675 6e63 7469 6f6e 2e0a 0a20 2020  e function...   
-0003cc90: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0003cca0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
-0003ccb0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
-0003ccc0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
-0003ccd0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
-0003cce0: 7370 6c69 745f 746f 5f74 6162 6c65 203d  split_to_table =
-0003ccf0: 2074 6162 6c65 5f66 756e 6374 696f 6e28   table_function(
-0003cd00: 2273 706c 6974 5f74 6f5f 7461 626c 6522  "split_to_table"
-0003cd10: 290a 2020 2020 2020 2020 3e3e 3e20 7365  ).        >>> se
-0003cd20: 7373 696f 6e2e 7461 626c 655f 6675 6e63  ssion.table_func
-0003cd30: 7469 6f6e 2873 706c 6974 5f74 6f5f 7461  tion(split_to_ta
-0003cd40: 626c 6528 6c69 7428 2273 706c 6974 2077  ble(lit("split w
-0003cd50: 6f72 6473 2074 6f20 7461 626c 6522 292c  ords to table"),
-0003cd60: 206c 6974 2822 2022 2929 2e6f 7665 7228   lit(" ")).over(
-0003cd70: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
-0003cd80: 2020 2020 205b 526f 7728 5345 513d 312c       [Row(SEQ=1,
-0003cd90: 2049 4e44 4558 3d31 2c20 5641 4c55 453d   INDEX=1, VALUE=
-0003cda0: 2773 706c 6974 2729 2c20 526f 7728 5345  'split'), Row(SE
-0003cdb0: 513d 312c 2049 4e44 4558 3d32 2c20 5641  Q=1, INDEX=2, VA
-0003cdc0: 4c55 453d 2777 6f72 6473 2729 2c20 526f  LUE='words'), Ro
-0003cdd0: 7728 5345 513d 312c 2049 4e44 4558 3d33  w(SEQ=1, INDEX=3
-0003cde0: 2c20 5641 4c55 453d 2774 6f27 292c 2052  , VALUE='to'), R
-0003cdf0: 6f77 2853 4551 3d31 2c20 494e 4445 583d  ow(SEQ=1, INDEX=
-0003ce00: 342c 2056 414c 5545 3d27 7461 626c 6527  4, VALUE='table'
-0003ce10: 295d 0a20 2020 2022 2222 0a20 2020 2072  )].    """.    r
-0003ce20: 6574 7572 6e20 6c61 6d62 6461 202a 6172  eturn lambda *ar
-0003ce30: 6773 2c20 2a2a 6b77 6172 6773 3a20 6361  gs, **kwargs: ca
-0003ce40: 6c6c 5f74 6162 6c65 5f66 756e 6374 696f  ll_table_functio
-0003ce50: 6e28 6675 6e63 7469 6f6e 5f6e 616d 652c  n(function_name,
-0003ce60: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0003ce70: 290a 0a0a 6465 6620 6361 6c6c 5f66 756e  )...def call_fun
-0003ce80: 6374 696f 6e28 6675 6e63 7469 6f6e 5f6e  ction(function_n
-0003ce90: 616d 653a 2073 7472 2c20 2a61 7267 733a  ame: str, *args:
-0003cea0: 2043 6f6c 756d 6e4f 724c 6974 6572 616c   ColumnOrLiteral
-0003ceb0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0003cec0: 2022 2222 496e 766f 6b65 7320 6120 536e   """Invokes a Sn
-0003ced0: 6f77 666c 616b 6520 6073 7973 7465 6d2d  owflake `system-
-0003cee0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
-0003cef0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-0003cf00: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-0003cf10: 7371 6c2d 7265 6665 7265 6e63 652d 6675  sql-reference-fu
-0003cf20: 6e63 7469 6f6e 732e 6874 6d6c 3e60 5f20  nctions.html>`_ 
-0003cf30: 2862 7569 6c74 2d69 6e20 6675 6e63 7469  (built-in functi
-0003cf40: 6f6e 2920 7769 7468 2074 6865 2073 7065  on) with the spe
-0003cf50: 6369 6669 6564 206e 616d 650a 2020 2020  cified name.    
-0003cf60: 616e 6420 6172 6775 6d65 6e74 732e 0a0a  and arguments...
-0003cf70: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0003cf80: 2020 6675 6e63 7469 6f6e 5f6e 616d 653a    function_name:
-0003cf90: 2054 6865 206e 616d 6520 6f66 2062 7569   The name of bui
-0003cfa0: 6c74 2d69 6e20 6675 6e63 7469 6f6e 2069  lt-in function i
-0003cfb0: 6e20 536e 6f77 666c 616b 650a 2020 2020  n Snowflake.    
-0003cfc0: 2020 2020 6172 6773 3a20 4172 6775 6d65      args: Argume
-0003cfd0: 6e74 7320 6361 6e20 6265 2069 6e20 7477  nts can be in tw
-0003cfe0: 6f20 7479 7065 733a 0a0a 2020 2020 2020  o types:..      
-0003cff0: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
-0003d000: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-0003d010: 6172 6b2e 436f 6c75 6d6e 602c 206f 720a  ark.Column`, or.
-0003d020: 2020 2020 2020 2020 2020 2020 2d20 4261              - Ba
-0003d030: 7369 6320 5079 7468 6f6e 2074 7970 6573  sic Python types
-0003d040: 2c20 7768 6963 6820 6172 6520 636f 6e76  , which are conv
-0003d050: 6572 7465 6420 746f 2053 6e6f 7770 6172  erted to Snowpar
-0003d060: 6b20 6c69 7465 7261 6c73 2e0a 0a20 2020  k literals...   
-0003d070: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
-0003d080: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
-0003d090: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
-0003d0a0: 7261 6d65 285b 312c 2032 2c20 332c 2034  rame([1, 2, 3, 4
-0003d0b0: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
-0003d0c0: 2020 2320 6120 7369 6e67 6c65 2063 6f6c    # a single col
-0003d0d0: 756d 6e20 7769 7468 2034 2072 6f77 730a  umn with 4 rows.
-0003d0e0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
-0003d0f0: 656c 6563 7428 6361 6c6c 5f66 756e 6374  elect(call_funct
-0003d100: 696f 6e28 2261 7667 222c 2063 6f6c 2822  ion("avg", col("
-0003d110: 6122 2929 292e 7368 6f77 2829 0a20 2020  a"))).show().   
-0003d120: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-0003d130: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
-0003d140: 4156 4728 2222 4122 2229 2220 207c 0a20  AVG(""A"")"  |. 
-0003d150: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003d160: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003d170: 7c32 2e35 3030 3030 3020 2020 2020 207c  |2.500000      |
-0003d180: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003d190: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0003d1a0: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 0a20    <BLANKLINE>.. 
-0003d1b0: 2020 2022 2222 0a0a 2020 2020 7265 7475     """..    retu
-0003d1c0: 726e 205f 6361 6c6c 5f66 756e 6374 696f  rn _call_functio
-0003d1d0: 6e28 6675 6e63 7469 6f6e 5f6e 616d 652c  n(function_name,
-0003d1e0: 2046 616c 7365 2c20 2a61 7267 7329 0a0a   False, *args)..
-0003d1f0: 0a64 6566 2066 756e 6374 696f 6e28 6675  .def function(fu
-0003d200: 6e63 7469 6f6e 5f6e 616d 653a 2073 7472  nction_name: str
-0003d210: 2920 2d3e 2043 616c 6c61 626c 653a 0a20  ) -> Callable:. 
-0003d220: 2020 2022 2222 0a20 2020 2046 756e 6374     """.    Funct
-0003d230: 696f 6e20 6f62 6a65 6374 2074 6f20 696e  ion object to in
-0003d240: 766f 6b65 2061 2053 6e6f 7766 6c61 6b65  voke a Snowflake
-0003d250: 2060 7379 7374 656d 2d64 6566 696e 6564   `system-defined
-0003d260: 2066 756e 6374 696f 6e20 3c68 7474 7073   function <https
-0003d270: 3a2f 2f64 6f63 732e 736e 6f77 666c 616b  ://docs.snowflak
-0003d280: 652e 636f 6d2f 656e 2f73 716c 2d72 6566  e.com/en/sql-ref
-0003d290: 6572 656e 6365 2d66 756e 6374 696f 6e73  erence-functions
-0003d2a0: 2e68 746d 6c3e 605f 2028 6275 696c 742d  .html>`_ (built-
-0003d2b0: 696e 2066 756e 6374 696f 6e29 2e20 5573  in function). Us
-0003d2c0: 6520 7468 6973 2074 6f20 696e 766f 6b65  e this to invoke
-0003d2d0: 0a20 2020 2061 6e79 2062 7569 6c74 2d69  .    any built-i
-0003d2e0: 6e20 6675 6e63 7469 6f6e 7320 6e6f 7420  n functions not 
-0003d2f0: 6578 706c 6963 6974 6c79 206c 6973 7465  explicitly liste
-0003d300: 6420 696e 2074 6869 7320 6f62 6a65 6374  d in this object
-0003d310: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-0003d320: 2020 2020 2066 756e 6374 696f 6e5f 6e61       function_na
-0003d330: 6d65 3a20 5468 6520 6e61 6d65 206f 6620  me: The name of 
-0003d340: 6275 696c 742d 696e 2066 756e 6374 696f  built-in functio
-0003d350: 6e20 696e 2053 6e6f 7766 6c61 6b65 2e0a  n in Snowflake..
-0003d360: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
-0003d370: 2020 2020 2020 4120 3a63 6c61 7373 3a60        A :class:`
-0003d380: 4361 6c6c 6162 6c65 6020 6f62 6a65 6374  Callable` object
-0003d390: 2066 6f72 2063 616c 6c69 6e67 2061 2053   for calling a S
-0003d3a0: 6e6f 7766 6c61 6b65 2073 7973 7465 6d2d  nowflake system-
-0003d3b0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
-0003d3c0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
-0003d3d0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0003d3e0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0003d3f0: 5f64 6174 6166 7261 6d65 285b 312c 2032  _dataframe([1, 2
-0003d400: 2c20 332c 2034 5d2c 2073 6368 656d 613d  , 3, 4], schema=
-0003d410: 5b22 6122 5d29 2020 2320 6120 7369 6e67  ["a"])  # a sing
-0003d420: 6c65 2063 6f6c 756d 6e20 7769 7468 2034  le column with 4
-0003d430: 2072 6f77 730a 2020 2020 2020 2020 3e3e   rows.        >>
-0003d440: 3e20 6466 2e73 656c 6563 7428 6361 6c6c  > df.select(call
-0003d450: 5f66 756e 6374 696f 6e28 2261 7667 222c  _function("avg",
-0003d460: 2063 6f6c 2822 6122 2929 292e 7368 6f77   col("a"))).show
-0003d470: 2829 0a20 2020 2020 2020 202d 2d2d 2d2d  ().        -----
-0003d480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-0003d490: 2020 2020 7c22 4156 4728 2222 4122 2229      |"AVG(""A"")
-0003d4a0: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
-0003d4b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-0003d4c0: 2020 2020 2020 7c32 2e35 3030 3030 3020        |2.500000 
-0003d4d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
-0003d4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-0003d4f0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
-0003d500: 4e45 3e0a 2020 2020 2020 2020 3e3e 3e20  NE>.        >>> 
-0003d510: 6d79 5f61 7667 203d 2066 756e 6374 696f  my_avg = functio
-0003d520: 6e28 2761 7667 2729 0a20 2020 2020 2020  n('avg').       
-0003d530: 203e 3e3e 2064 662e 7365 6c65 6374 286d   >>> df.select(m
-0003d540: 795f 6176 6728 636f 6c28 2261 2229 2929  y_avg(col("a")))
-0003d550: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
-0003d560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0003d570: 0a20 2020 2020 2020 207c 2241 5647 2822  .        |"AVG("
-0003d580: 2241 2222 2922 2020 7c0a 2020 2020 2020  "A"")"  |.      
-0003d590: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
-0003d5a0: 2d2d 0a20 2020 2020 2020 207c 322e 3530  --.        |2.50
-0003d5b0: 3030 3030 2020 2020 2020 7c0a 2020 2020  0000      |.    
-0003d5c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
-0003d5d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
-0003d5e0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
-0003d5f0: 0a20 2020 2072 6574 7572 6e20 6c61 6d62  .    return lamb
-0003d600: 6461 202a 6172 6773 3a20 6361 6c6c 5f66  da *args: call_f
-0003d610: 756e 6374 696f 6e28 6675 6e63 7469 6f6e  unction(function
-0003d620: 5f6e 616d 652c 202a 6172 6773 290a 0a0a  _name, *args)...
-0003d630: 6465 6620 5f63 616c 6c5f 6675 6e63 7469  def _call_functi
-0003d640: 6f6e 280a 2020 2020 6e61 6d65 3a20 7374  on(.    name: st
-0003d650: 722c 0a20 2020 2069 735f 6469 7374 696e  r,.    is_distin
-0003d660: 6374 3a20 626f 6f6c 203d 2046 616c 7365  ct: bool = False
-0003d670: 2c0a 2020 2020 2a61 7267 733a 2043 6f6c  ,.    *args: Col
-0003d680: 756d 6e4f 724c 6974 6572 616c 2c0a 2020  umnOrLiteral,.  
-0003d690: 2020 6170 695f 6361 6c6c 5f73 6f75 7263    api_call_sourc
-0003d6a0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-0003d6b0: 203d 204e 6f6e 652c 0a29 202d 3e20 436f   = None,.) -> Co
-0003d6c0: 6c75 6d6e 3a0a 2020 2020 6578 7072 6573  lumn:.    expres
-0003d6d0: 7369 6f6e 7320 3d20 5b43 6f6c 756d 6e2e  sions = [Column.
-0003d6e0: 5f74 6f5f 6578 7072 2861 7267 2920 666f  _to_expr(arg) fo
-0003d6f0: 7220 6172 6720 696e 2070 6172 7365 5f70  r arg in parse_p
-0003d700: 6f73 6974 696f 6e61 6c5f 6172 6773 5f74  ositional_args_t
-0003d710: 6f5f 6c69 7374 282a 6172 6773 295d 0a20  o_list(*args)]. 
-0003d720: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
-0003d730: 280a 2020 2020 2020 2020 4675 6e63 7469  (.        Functi
-0003d740: 6f6e 4578 7072 6573 7369 6f6e 280a 2020  onExpression(.  
-0003d750: 2020 2020 2020 2020 2020 6e61 6d65 2c20            name, 
-0003d760: 6578 7072 6573 7369 6f6e 732c 2069 735f  expressions, is_
-0003d770: 6469 7374 696e 6374 3d69 735f 6469 7374  distinct=is_dist
-0003d780: 696e 6374 2c20 6170 695f 6361 6c6c 5f73  inct, api_call_s
-0003d790: 6f75 7263 653d 6170 695f 6361 6c6c 5f73  ource=api_call_s
-0003d7a0: 6f75 7263 650a 2020 2020 2020 2020 290a  ource.        ).
-0003d7b0: 2020 2020 290a 0a0a 6465 6620 7370 726f      )...def spro
-0003d7c0: 6328 0a20 2020 2066 756e 633a 204f 7074  c(.    func: Opt
-0003d7d0: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
-0003d7e0: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
-0003d7f0: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
-0003d800: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
-0003d810: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
-0003d820: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
-0003d830: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
-0003d840: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
-0003d850: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
-0003d860: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
-0003d870: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
-0003d880: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
-0003d890: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
-0003d8a0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
-0003d8b0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
-0003d8c0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0003d8d0: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
-0003d8e0: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
-0003d8f0: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
-0003d900: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
-0003d910: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
-0003d920: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
-0003d930: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
-0003d940: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
-0003d950: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
-0003d960: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
-0003d970: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
-0003d980: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
-0003d990: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
-0003d9a0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
-0003d9b0: 2e53 6573 7369 6f6e 225d 203d 204e 6f6e  .Session"] = Non
-0003d9c0: 652c 0a20 2020 2070 6172 616c 6c65 6c3a  e,.    parallel:
-0003d9d0: 2069 6e74 203d 2034 2c0a 2020 2020 7374   int = 4,.    st
-0003d9e0: 6174 656d 656e 745f 7061 7261 6d73 3a20  atement_params: 
-0003d9f0: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
-0003da00: 722c 2073 7472 5d5d 203d 204e 6f6e 652c  r, str]] = None,
-0003da10: 0a20 2020 2065 7865 6375 7465 5f61 733a  .    execute_as:
-0003da20: 2074 7970 696e 672e 4c69 7465 7261 6c5b   typing.Literal[
-0003da30: 2263 616c 6c65 7222 2c20 226f 776e 6572  "caller", "owner
-0003da40: 225d 203d 2022 6f77 6e65 7222 2c0a 2020  "] = "owner",.  
-0003da50: 2020 7374 7269 6374 3a20 626f 6f6c 203d    strict: bool =
-0003da60: 2046 616c 7365 2c0a 2020 2020 736f 7572   False,.    sour
-0003da70: 6365 5f63 6f64 655f 6469 7370 6c61 793a  ce_code_display:
-0003da80: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-0003da90: 2020 2a2a 6b77 6172 6773 2c0a 2920 2d3e    **kwargs,.) ->
-0003daa0: 2055 6e69 6f6e 5b53 746f 7265 6450 726f   Union[StoredPro
-0003dab0: 6365 6475 7265 2c20 6675 6e63 746f 6f6c  cedure, functool
-0003dac0: 732e 7061 7274 6961 6c5d 3a0a 2020 2020  s.partial]:.    
-0003dad0: 2222 2252 6567 6973 7465 7273 2061 2050  """Registers a P
-0003dae0: 7974 686f 6e20 6675 6e63 7469 6f6e 2061  ython function a
-0003daf0: 7320 6120 536e 6f77 666c 616b 6520 5079  s a Snowflake Py
-0003db00: 7468 6f6e 2073 746f 7265 6420 7072 6f63  thon stored proc
-0003db10: 6564 7572 6520 616e 6420 7265 7475 726e  edure and return
-0003db20: 7320 7468 6520 7374 6f72 6564 2070 726f  s the stored pro
-0003db30: 6365 6475 7265 2e0a 0a20 2020 2049 7420  cedure...    It 
-0003db40: 6361 6e20 6265 2075 7365 6420 6173 2065  can be used as e
-0003db50: 6974 6865 7220 6120 6675 6e63 7469 6f6e  ither a function
-0003db60: 2063 616c 6c20 6f72 2061 2064 6563 6f72   call or a decor
-0003db70: 6174 6f72 2e20 496e 206d 6f73 7420 6361  ator. In most ca
-0003db80: 7365 7320 796f 7520 776f 726b 2077 6974  ses you work wit
-0003db90: 6820 6120 7369 6e67 6c65 2073 6573 7369  h a single sessi
-0003dba0: 6f6e 2e0a 2020 2020 5468 6973 2066 756e  on..    This fun
-0003dbb0: 6374 696f 6e20 7573 6573 2074 6861 7420  ction uses that 
-0003dbc0: 7365 7373 696f 6e20 746f 2072 6567 6973  session to regis
-0003dbd0: 7465 7220 7468 6520 7374 6f72 6564 2070  ter the stored p
-0003dbe0: 726f 6365 6475 7265 2e20 4966 2079 6f75  rocedure. If you
-0003dbf0: 2068 6176 6520 6d75 6c74 6970 6c65 2073   have multiple s
-0003dc00: 6573 7369 6f6e 732c 2079 6f75 206e 6565  essions, you nee
-0003dc10: 6420 746f 0a20 2020 2065 7870 6c69 6369  d to.    explici
-0003dc20: 746c 7920 7370 6563 6966 7920 7468 6520  tly specify the 
-0003dc30: 6060 7365 7373 696f 6e60 6020 7061 7261  ``session`` para
-0003dc40: 6d65 7465 7220 6f66 2074 6869 7320 6675  meter of this fu
-0003dc50: 6e63 7469 6f6e 2e20 4966 2079 6f75 2068  nction. If you h
-0003dc60: 6176 6520 6120 6675 6e63 7469 6f6e 2061  ave a function a
-0003dc70: 6e64 2077 6f75 6c64 0a20 2020 206c 696b  nd would.    lik
-0003dc80: 6520 746f 2072 6567 6973 7465 7220 6974  e to register it
-0003dc90: 2074 6f20 6d75 6c74 6970 6c65 2064 6174   to multiple dat
-0003dca0: 6162 6173 6573 2c20 7573 6520 6060 7365  abases, use ``se
-0003dcb0: 7373 696f 6e2e 7370 726f 632e 7265 6769  ssion.sproc.regi
-0003dcc0: 7374 6572 6060 2069 6e73 7465 6164 2e20  ster`` instead. 
-0003dcd0: 5365 6520 6578 616d 706c 6573 0a20 2020  See examples.   
-0003dce0: 2069 6e20 3a63 6c61 7373 3a60 7e73 6e6f   in :class:`~sno
-0003dcf0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
-0003dd00: 7374 6f72 6564 5f70 726f 6365 6475 7265  stored_procedure
-0003dd10: 2e53 746f 7265 6450 726f 6365 6475 7265  .StoredProcedure
-0003dd20: 5265 6769 7374 7261 7469 6f6e 602e 0a0a  Registration`...
-0003dd30: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-0003dd40: 6520 6669 7273 7420 7061 7261 6d65 7465  e first paramete
-0003dd50: 7220 6f66 2079 6f75 7220 6675 6e63 7469  r of your functi
-0003dd60: 6f6e 2073 686f 756c 6420 6265 2061 2073  on should be a s
-0003dd70: 6e6f 7770 6172 6b20 5365 7373 696f 6e2e  nowpark Session.
-0003dd80: 2041 6c73 6f2c 2079 6f75 206e 6565 6420   Also, you need 
-0003dd90: 746f 2061 6464 0a20 2020 2060 736e 6f77  to add.    `snow
-0003dda0: 666c 616b 652d 736e 6f77 7061 726b 2d70  flake-snowpark-p
-0003ddb0: 7974 686f 6e60 2070 6163 6b61 6765 2028  ython` package (
-0003ddc0: 7665 7273 696f 6e20 3e3d 2030 2e34 2e30  version >= 0.4.0
-0003ddd0: 2920 746f 2079 6f75 7220 7365 7373 696f  ) to your sessio
-0003dde0: 6e20 6265 666f 7265 2074 7279 696e 6720  n before trying 
-0003ddf0: 746f 2063 7265 6174 6520 610a 2020 2020  to create a.    
-0003de00: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-0003de10: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
-0003de20: 2020 2020 2066 756e 633a 2041 2050 7974       func: A Pyt
-0003de30: 686f 6e20 6675 6e63 7469 6f6e 2075 7365  hon function use
-0003de40: 6420 666f 7220 6372 6561 7469 6e67 2074  d for creating t
-0003de50: 6865 2073 746f 7265 6420 7072 6f63 6564  he stored proced
-0003de60: 7572 652e 0a20 2020 2020 2020 2072 6574  ure..        ret
-0003de70: 7572 6e5f 7479 7065 3a20 4120 3a63 6c61  urn_type: A :cla
-0003de80: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
-0003de90: 6e6f 7770 6172 6b2e 7479 7065 732e 4461  nowpark.types.Da
-0003dea0: 7461 5479 7065 6020 7265 7072 6573 656e  taType` represen
-0003deb0: 7469 6e67 2074 6865 2072 6574 7572 6e20  ting the return 
-0003dec0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
-0003ded0: 2074 7970 6520 6f66 2074 6865 2073 746f   type of the sto
-0003dee0: 7265 6420 7072 6f63 6564 7572 652e 204f  red procedure. O
-0003def0: 7074 696f 6e61 6c20 6966 2074 7970 6520  ptional if type 
-0003df00: 6869 6e74 7320 6172 6520 7072 6f76 6964  hints are provid
-0003df10: 6564 2e0a 2020 2020 2020 2020 696e 7075  ed..        inpu
-0003df20: 745f 7479 7065 733a 2041 206c 6973 7420  t_types: A list 
-0003df30: 6f66 203a 636c 6173 733a 607e 736e 6f77  of :class:`~snow
-0003df40: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
-0003df50: 7970 6573 2e44 6174 6154 7970 6560 0a20  ypes.DataType`. 
-0003df60: 2020 2020 2020 2020 2020 2072 6570 7265             repre
-0003df70: 7365 6e74 696e 6720 7468 6520 696e 7075  senting the inpu
-0003df80: 7420 6461 7461 2074 7970 6573 206f 6620  t data types of 
-0003df90: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
-0003dfa0: 6475 7265 2e20 4f70 7469 6f6e 616c 2069  dure. Optional i
-0003dfb0: 660a 2020 2020 2020 2020 2020 2020 7479  f.            ty
-0003dfc0: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
-0003dfd0: 7669 6465 642e 0a20 2020 2020 2020 206e  vided..        n
-0003dfe0: 616d 653a 2041 2073 7472 696e 6720 6f72  ame: A string or
-0003dff0: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-0003e000: 2074 6861 7420 7370 6563 6966 7920 7468   that specify th
-0003e010: 6520 6e61 6d65 206f 7220 6675 6c6c 792d  e name or fully-
-0003e020: 7175 616c 6966 6965 640a 2020 2020 2020  qualified.      
-0003e030: 2020 2020 2020 6f62 6a65 6374 2069 6465        object ide
-0003e040: 6e74 6966 6965 7220 2864 6174 6162 6173  ntifier (databas
-0003e050: 6520 6e61 6d65 2c20 7363 6865 6d61 206e  e name, schema n
-0003e060: 616d 652c 2061 6e64 2066 756e 6374 696f  ame, and functio
-0003e070: 6e20 6e61 6d65 2920 666f 720a 2020 2020  n name) for.    
-0003e080: 2020 2020 2020 2020 7468 6520 7374 6f72          the stor
-0003e090: 6564 2070 726f 6365 6475 7265 2069 6e20  ed procedure in 
-0003e0a0: 536e 6f77 666c 616b 652c 2077 6869 6368  Snowflake, which
-0003e0b0: 2061 6c6c 6f77 7320 796f 7520 746f 2063   allows you to c
-0003e0c0: 616c 6c20 7468 6973 2073 746f 7265 6420  all this stored 
-0003e0d0: 7072 6f63 6564 7572 6520 696e 2061 2053  procedure in a S
-0003e0e0: 514c 0a20 2020 2020 2020 2020 2020 2063  QL.            c
-0003e0f0: 6f6d 6d61 6e64 206f 7220 7669 6120 3a66  ommand or via :f
-0003e100: 756e 633a 6073 6573 7369 6f6e 2e63 616c  unc:`session.cal
-0003e110: 6c28 2960 2e20 4966 2069 7420 6973 206e  l()`. If it is n
-0003e120: 6f74 2070 726f 7669 6465 642c 2061 206e  ot provided, a n
-0003e130: 616d 6520 7769 6c6c 0a20 2020 2020 2020  ame will.       
-0003e140: 2020 2020 2062 6520 6175 746f 6d61 7469       be automati
-0003e150: 6361 6c6c 7920 6765 6e65 7261 7465 6420  cally generated 
-0003e160: 666f 7220 7468 6520 7374 6f72 6564 2070  for the stored p
-0003e170: 726f 6365 6475 7265 2e20 4120 6e61 6d65  rocedure. A name
-0003e180: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-0003e190: 6564 2077 6865 6e0a 2020 2020 2020 2020  ed when.        
-0003e1a0: 2020 2020 6060 6973 5f70 6572 6d61 6e65      ``is_permane
-0003e1b0: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
-0003e1c0: 2e0a 2020 2020 2020 2020 6973 5f70 6572  ..        is_per
-0003e1d0: 6d61 6e65 6e74 3a20 5768 6574 6865 7220  manent: Whether 
-0003e1e0: 746f 2063 7265 6174 6520 6120 7065 726d  to create a perm
-0003e1f0: 616e 656e 7420 7374 6f72 6564 2070 726f  anent stored pro
-0003e200: 6365 6475 7265 2e20 5468 6520 6465 6661  cedure. The defa
-0003e210: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
-0003e220: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-0003e230: 2069 7420 6973 2060 6054 7275 6560 602c   it is ``True``,
-0003e240: 2061 2076 616c 6964 2060 6073 7461 6765   a valid ``stage
-0003e250: 5f6c 6f63 6174 696f 6e60 6020 6d75 7374  _location`` must
-0003e260: 2062 6520 7072 6f76 6964 6564 2e0a 2020   be provided..  
-0003e270: 2020 2020 2020 7374 6167 655f 6c6f 6361        stage_loca
-0003e280: 7469 6f6e 3a20 5468 6520 7374 6167 6520  tion: The stage 
-0003e290: 6c6f 6361 7469 6f6e 2077 6865 7265 2074  location where t
-0003e2a0: 6865 2050 7974 686f 6e20 6669 6c65 2066  he Python file f
-0003e2b0: 6f72 2074 6865 2073 746f 7265 6420 7072  or the stored pr
-0003e2c0: 6f63 6564 7572 650a 2020 2020 2020 2020  ocedure.        
-0003e2d0: 2020 2020 616e 6420 6974 7320 6465 7065      and its depe
-0003e2e0: 6e64 656e 6369 6573 2073 686f 756c 6420  ndencies should 
-0003e2f0: 6265 2075 706c 6f61 6465 642e 2054 6865  be uploaded. The
-0003e300: 2073 7461 6765 206c 6f63 6174 696f 6e20   stage location 
-0003e310: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
-0003e320: 640a 2020 2020 2020 2020 2020 2020 7768  d.            wh
-0003e330: 656e 2060 6069 735f 7065 726d 616e 656e  en ``is_permanen
-0003e340: 7460 6020 6973 2060 6054 7275 6560 602c  t`` is ``True``,
-0003e350: 2061 6e64 2069 7420 7769 6c6c 2062 6520   and it will be 
-0003e360: 6967 6e6f 7265 6420 7768 656e 0a20 2020  ignored when.   
-0003e370: 2020 2020 2020 2020 2060 6069 735f 7065           ``is_pe
-0003e380: 726d 616e 656e 7460 6020 6973 2060 6046  rmanent`` is ``F
-0003e390: 616c 7365 6060 2e20 4974 2063 616e 2062  alse``. It can b
-0003e3a0: 6520 616e 7920 7374 6167 6520 6f74 6865  e any stage othe
-0003e3b0: 7220 7468 616e 2074 656d 706f 7261 7279  r than temporary
-0003e3c0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-0003e3d0: 6765 7320 616e 6420 6578 7465 726e 616c  ges and external
-0003e3e0: 2073 7461 6765 732e 0a20 2020 2020 2020   stages..       
-0003e3f0: 2069 6d70 6f72 7473 3a20 4120 6c69 7374   imports: A list
-0003e400: 206f 6620 696d 706f 7274 7320 7468 6174   of imports that
-0003e410: 206f 6e6c 7920 6170 706c 7920 746f 2074   only apply to t
-0003e420: 6869 7320 7374 6f72 6564 2070 726f 6365  his stored proce
-0003e430: 6475 7265 2e20 596f 7520 6361 6e20 7573  dure. You can us
-0003e440: 6520 6120 7374 7269 6e67 2074 6f0a 2020  e a string to.  
-0003e450: 2020 2020 2020 2020 2020 7265 7072 6573            repres
-0003e460: 656e 7420 6120 6669 6c65 2070 6174 6820  ent a file path 
-0003e470: 2873 696d 696c 6172 2074 6f20 7468 6520  (similar to the 
-0003e480: 6060 7061 7468 6060 2061 7267 756d 656e  ``path`` argumen
-0003e490: 7420 696e 0a20 2020 2020 2020 2020 2020  t in.           
-0003e4a0: 203a 6d65 7468 3a60 7e73 6e6f 7766 6c61   :meth:`~snowfla
-0003e4b0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
-0003e4c0: 696f 6e2e 6164 645f 696d 706f 7274 6029  ion.add_import`)
-0003e4d0: 2069 6e20 7468 6973 206c 6973 742c 206f   in this list, o
-0003e4e0: 7220 6120 7475 706c 6520 6f66 2074 776f  r a tuple of two
-0003e4f0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0003e500: 696e 6773 2074 6f20 7265 7072 6573 656e  ings to represen
-0003e510: 7420 6120 6669 6c65 2070 6174 6820 616e  t a file path an
-0003e520: 6420 616e 2069 6d70 6f72 7420 7061 7468  d an import path
-0003e530: 2028 7369 6d69 6c61 7220 746f 2074 6865   (similar to the
-0003e540: 2060 6069 6d70 6f72 745f 7061 7468 6060   ``import_path``
-0003e550: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-0003e560: 756d 656e 7420 696e 203a 6d65 7468 3a60  ument in :meth:`
-0003e570: 7e73 6e6f 7766 6c61 6b65 2e73 6e6f 7770  ~snowflake.snowp
-0003e580: 6172 6b2e 5365 7373 696f 6e2e 6164 645f  ark.Session.add_
-0003e590: 696d 706f 7274 6029 2e20 5468 6573 6520  import`). These 
-0003e5a0: 7374 6f72 6564 2d70 726f 632d 6c65 7665  stored-proc-leve
-0003e5b0: 6c20 696d 706f 7274 730a 2020 2020 2020  l imports.      
-0003e5c0: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
-0003e5d0: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
-0003e5e0: 6c65 7665 6c20 696d 706f 7274 7320 6164  level imports ad
-0003e5f0: 6465 6420 6279 0a20 2020 2020 2020 2020  ded by.         
-0003e600: 2020 203a 6d65 7468 3a60 7e73 6e6f 7766     :meth:`~snowf
-0003e610: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5365  lake.snowpark.Se
-0003e620: 7373 696f 6e2e 6164 645f 696d 706f 7274  ssion.add_import
-0003e630: 602e 0a20 2020 2020 2020 2070 6163 6b61  `..        packa
-0003e640: 6765 733a 2041 206c 6973 7420 6f66 2070  ges: A list of p
-0003e650: 6163 6b61 6765 7320 7468 6174 206f 6e6c  ackages that onl
-0003e660: 7920 6170 706c 7920 746f 2074 6869 7320  y apply to this 
-0003e670: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-0003e680: 2e20 5468 6573 6520 7374 6f72 6564 2d70  . These stored-p
-0003e690: 726f 632d 6c65 7665 6c20 7061 636b 6167  roc-level packag
-0003e6a0: 6573 0a20 2020 2020 2020 2020 2020 2077  es.            w
-0003e6b0: 696c 6c20 6f76 6572 7269 6465 2074 6865  ill override the
-0003e6c0: 2073 6573 7369 6f6e 2d6c 6576 656c 2070   session-level p
-0003e6d0: 6163 6b61 6765 7320 6164 6465 6420 6279  ackages added by
-0003e6e0: 0a20 2020 2020 2020 2020 2020 203a 6d65  .            :me
-0003e6f0: 7468 3a60 7e73 6e6f 7766 6c61 6b65 2e73  th:`~snowflake.s
-0003e700: 6e6f 7770 6172 6b2e 5365 7373 696f 6e2e  nowpark.Session.
-0003e710: 6164 645f 7061 636b 6167 6573 6020 616e  add_packages` an
-0003e720: 640a 2020 2020 2020 2020 2020 2020 3a6d  d.            :m
-0003e730: 6574 683a 607e 736e 6f77 666c 616b 652e  eth:`~snowflake.
-0003e740: 736e 6f77 7061 726b 2e53 6573 7369 6f6e  snowpark.Session
-0003e750: 2e61 6464 5f72 6571 7569 7265 6d65 6e74  .add_requirement
-0003e760: 7360 2e0a 2020 2020 2020 2020 7265 706c  s`..        repl
-0003e770: 6163 653a 2057 6865 7468 6572 2074 6f20  ace: Whether to 
-0003e780: 7265 706c 6163 6520 6120 7374 6f72 6564  replace a stored
-0003e790: 2070 726f 6365 6475 7265 2074 6861 7420   procedure that 
-0003e7a0: 616c 7265 6164 7920 7761 7320 7265 6769  already was regi
-0003e7b0: 7374 6572 6564 2e20 5468 6520 6465 6661  stered. The defa
-0003e7c0: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
-0003e7d0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-0003e7e0: 2069 7420 6973 2060 6046 616c 7365 6060   it is ``False``
-0003e7f0: 2c20 6174 7465 6d70 7469 6e67 2074 6f20  , attempting to 
-0003e800: 7265 6769 7374 6572 2061 2073 746f 7265  register a store
-0003e810: 6420 7072 6f63 6564 7572 6520 7769 7468  d procedure with
-0003e820: 2061 206e 616d 6520 7468 6174 2061 6c72   a name that alr
-0003e830: 6561 6479 2065 7869 7374 730a 2020 2020  eady exists.    
-0003e840: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
-0003e850: 696e 2061 2060 6053 6e6f 7770 6172 6b53  in a ``SnowparkS
-0003e860: 514c 4578 6365 7074 696f 6e60 6020 6578  QLException`` ex
-0003e870: 6365 7074 696f 6e20 6265 696e 6720 7468  ception being th
-0003e880: 726f 776e 2e20 4966 2069 7420 6973 2060  rown. If it is `
-0003e890: 6054 7275 6560 602c 0a20 2020 2020 2020  `True``,.       
-0003e8a0: 2020 2020 2061 6e20 6578 6973 7469 6e67       an existing
-0003e8b0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-0003e8c0: 6520 7769 7468 2074 6865 2073 616d 6520  e with the same 
-0003e8d0: 6e61 6d65 2069 7320 6f76 6572 7772 6974  name is overwrit
-0003e8e0: 7465 6e2e 0a20 2020 2020 2020 2069 665f  ten..        if_
-0003e8f0: 6e6f 745f 6578 6973 7473 3a20 5768 6574  not_exists: Whet
-0003e900: 6865 7220 746f 2073 6b69 7020 6372 6561  her to skip crea
-0003e910: 7469 6f6e 206f 6620 6120 7374 6f72 6564  tion of a stored
-0003e920: 2070 726f 6365 6475 7265 2074 6865 2073   procedure the s
-0003e930: 616d 6520 7072 6f63 6564 7572 6520 6973  ame procedure is
-0003e940: 2061 6c72 6561 6479 2072 6567 6973 7465   already registe
-0003e950: 7265 642e 0a20 2020 2020 2020 2020 2020  red..           
-0003e960: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-0003e970: 6060 4661 6c73 6560 602e 2060 6069 665f  ``False``. ``if_
-0003e980: 6e6f 745f 6578 6973 7473 6060 2061 6e64  not_exists`` and
-0003e990: 2060 6072 6570 6c61 6365 6060 2061 7265   ``replace`` are
-0003e9a0: 206d 7574 7561 6c6c 7920 6578 636c 7573   mutually exclus
-0003e9b0: 6976 6520 616e 6420 6120 6060 5661 6c75  ive and a ``Valu
-0003e9c0: 6545 7272 6f72 6060 0a20 2020 2020 2020  eError``.       
-0003e9d0: 2020 2020 2069 7320 7261 6973 6564 2077       is raised w
-0003e9e0: 6865 6e20 626f 7468 2061 7265 2073 6574  hen both are set
-0003e9f0: 2e20 4966 2069 7420 6973 2060 6054 7275  . If it is ``Tru
-0003ea00: 6560 6020 616e 6420 6120 7374 6f72 6564  e`` and a stored
-0003ea10: 2070 726f 6365 6475 7265 2069 7320 616c   procedure is al
-0003ea20: 7265 6164 7920 7265 6769 7374 6572 6564  ready registered
-0003ea30: 2c20 7468 6520 7265 6769 7374 7261 7469  , the registrati
-0003ea40: 6f6e 2069 7320 736b 6970 7065 642e 0a20  on is skipped.. 
-0003ea50: 2020 2020 2020 2073 6573 7369 6f6e 3a20         session: 
-0003ea60: 5573 6520 7468 6973 2073 6573 7369 6f6e  Use this session
-0003ea70: 2074 6f20 7265 6769 7374 6572 2074 6865   to register the
-0003ea80: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-0003ea90: 652e 2049 6620 6974 2773 206e 6f74 2073  e. If it's not s
-0003eaa0: 7065 6369 6669 6564 2c20 7468 6520 7365  pecified, the se
-0003eab0: 7373 696f 6e20 7468 6174 2079 6f75 2063  ssion that you c
-0003eac0: 7265 6174 6564 2062 6566 6f72 6520 6361  reated before ca
-0003ead0: 6c6c 696e 6720 7468 6973 2066 756e 6374  lling this funct
-0003eae0: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-0003eaf0: 2e0a 2020 2020 2020 2020 2020 2020 596f  ..            Yo
-0003eb00: 7520 6e65 6564 2074 6f20 7370 6563 6966  u need to specif
-0003eb10: 7920 7468 6973 2070 6172 616d 6574 6572  y this parameter
-0003eb20: 2069 6620 796f 7520 6861 7665 2063 7265   if you have cre
-0003eb30: 6174 6564 206d 756c 7469 706c 6520 7365  ated multiple se
-0003eb40: 7373 696f 6e73 2062 6566 6f72 6520 6361  ssions before ca
-0003eb50: 6c6c 696e 6720 7468 6973 206d 6574 686f  lling this metho
-0003eb60: 642e 0a20 2020 2020 2020 2070 6172 616c  d..        paral
-0003eb70: 6c65 6c3a 2054 6865 206e 756d 6265 7220  lel: The number 
-0003eb80: 6f66 2074 6872 6561 6473 2074 6f20 7573  of threads to us
-0003eb90: 6520 666f 7220 7570 6c6f 6164 696e 6720  e for uploading 
-0003eba0: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
-0003ebb0: 2066 696c 6573 2077 6974 6820 7468 650a   files with the.
-0003ebc0: 2020 2020 2020 2020 2020 2020 6050 5554              `PUT
-0003ebd0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
-0003ebe0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
-0003ebf0: 7371 6c2d 7265 6665 7265 6e63 652f 7371  sql-reference/sq
-0003ec00: 6c2f 7075 742e 6874 6d6c 2370 7574 3e60  l/put.html#put>`
-0003ec10: 5f0a 2020 2020 2020 2020 2020 2020 636f  _.            co
-0003ec20: 6d6d 616e 642e 2054 6865 2064 6566 6175  mmand. The defau
-0003ec30: 6c74 2076 616c 7565 2069 7320 3420 616e  lt value is 4 an
-0003ec40: 6420 7375 7070 6f72 7465 6420 7661 6c75  d supported valu
-0003ec50: 6573 2061 7265 2066 726f 6d20 3120 746f  es are from 1 to
-0003ec60: 2039 392e 0a20 2020 2020 2020 2020 2020   99..           
-0003ec70: 2049 6e63 7265 6173 696e 6720 7468 6520   Increasing the 
-0003ec80: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
-0003ec90: 7320 6361 6e20 696d 7072 6f76 6520 7065  s can improve pe
-0003eca0: 7266 6f72 6d61 6e63 6520 7768 656e 2075  rformance when u
-0003ecb0: 706c 6f61 6469 6e67 0a20 2020 2020 2020  ploading.       
-0003ecc0: 2020 2020 206c 6172 6765 2073 746f 7265       large store
-0003ecd0: 6420 7072 6f63 6564 7572 6520 6669 6c65  d procedure file
-0003ece0: 732e 0a20 2020 2020 2020 2065 7865 6375  s..        execu
-0003ecf0: 7465 5f61 733a 2057 6861 7420 7065 726d  te_as: What perm
-0003ed00: 6973 7369 6f6e 7320 7368 6f75 6c64 2074  issions should t
-0003ed10: 6865 2070 726f 6365 6475 7265 2068 6176  he procedure hav
-0003ed20: 6520 7768 696c 6520 6578 6563 7574 696e  e while executin
-0003ed30: 672e 2054 6869 730a 2020 2020 2020 2020  g. This.        
-0003ed40: 2020 2020 7375 7070 6f72 7473 2063 616c      supports cal
-0003ed50: 6c65 722c 206f 7220 6f77 6e65 7220 666f  ler, or owner fo
-0003ed60: 7220 6e6f 772e 2053 6565 2060 6f77 6e65  r now. See `owne
-0003ed70: 7220 616e 6420 6361 6c6c 6572 2072 6967  r and caller rig
-0003ed80: 6874 7320 3c68 7474 7073 3a2f 2f64 6f63  hts <https://doc
-0003ed90: 732e 736e 6f77 666c 616b 652e 636f 6d2f  s.snowflake.com/
-0003eda0: 656e 2f73 716c 2d72 6566 6572 656e 6365  en/sql-reference
-0003edb0: 2f73 746f 7265 642d 7072 6f63 6564 7572  /stored-procedur
-0003edc0: 6573 2d72 6967 6874 732e 6874 6d6c 3e60  es-rights.html>`
-0003edd0: 5f0a 2020 2020 2020 2020 2020 2020 666f  _.            fo
-0003ede0: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-0003edf0: 6f6e 2e0a 2020 2020 2020 2020 7374 6174  on..        stat
-0003ee00: 656d 656e 745f 7061 7261 6d73 3a20 4469  ement_params: Di
-0003ee10: 6374 696f 6e61 7279 206f 6620 7374 6174  ctionary of stat
-0003ee20: 656d 656e 7420 6c65 7665 6c20 7061 7261  ement level para
-0003ee30: 6d65 7465 7273 2074 6f20 6265 2073 6574  meters to be set
-0003ee40: 2077 6869 6c65 2065 7865 6375 7469 6e67   while executing
-0003ee50: 2074 6869 7320 6163 7469 6f6e 2e0a 2020   this action..  
-0003ee60: 2020 2020 2020 7374 7269 6374 3a20 5768        strict: Wh
-0003ee70: 6574 6865 7220 7468 6520 6372 6561 7465  ether the create
-0003ee80: 6420 7374 6f72 6564 2070 726f 6365 6475  d stored procedu
-0003ee90: 7265 2069 7320 7374 7269 6374 2e20 4120  re is strict. A 
-0003eea0: 7374 7269 6374 2073 746f 7265 6420 7072  strict stored pr
-0003eeb0: 6f63 6564 7572 6520 7769 6c6c 206e 6f74  ocedure will not
-0003eec0: 2069 6e76 6f6b 650a 2020 2020 2020 2020   invoke.        
-0003eed0: 2020 2020 7468 6520 7374 6f72 6564 2070      the stored p
-0003eee0: 726f 6365 6475 7265 2069 6620 616e 7920  rocedure if any 
-0003eef0: 696e 7075 7420 6973 206e 756c 6c2e 2049  input is null. I
-0003ef00: 6e73 7465 6164 2c20 6120 6e75 6c6c 2076  nstead, a null v
-0003ef10: 616c 7565 2077 696c 6c20 616c 7761 7973  alue will always
-0003ef20: 2062 6520 7265 7475 726e 6564 2e20 4e6f   be returned. No
-0003ef30: 7465 0a20 2020 2020 2020 2020 2020 2074  te.            t
-0003ef40: 6861 7420 7468 6520 7374 6f72 6564 2070  hat the stored p
-0003ef50: 726f 6365 6475 7265 206d 6967 6874 2073  rocedure might s
-0003ef60: 7469 6c6c 2072 6574 7572 6e20 6e75 6c6c  till return null
-0003ef70: 2066 6f72 206e 6f6e 2d6e 756c 6c20 696e   for non-null in
-0003ef80: 7075 7473 2e0a 2020 2020 2020 2020 736f  puts..        so
-0003ef90: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-0003efa0: 793a 2044 6973 706c 6179 2074 6865 2073  y: Display the s
-0003efb0: 6f75 7263 6520 636f 6465 206f 6620 7468  ource code of th
-0003efc0: 6520 7374 6f72 6564 2070 726f 6365 6475  e stored procedu
-0003efd0: 7265 2060 6675 6e63 6020 6173 2063 6f6d  re `func` as com
-0003efe0: 6d65 6e74 7320 696e 2074 6865 2067 656e  ments in the gen
-0003eff0: 6572 6174 6564 2073 6372 6970 742e 0a20  erated script.. 
-0003f000: 2020 2020 2020 2020 2020 2054 6865 2073             The s
-0003f010: 6f75 7263 6520 636f 6465 2069 7320 6479  ource code is dy
-0003f020: 6e61 6d69 6361 6c6c 7920 6765 6e65 7261  namically genera
-0003f030: 7465 6420 7468 6572 6566 6f72 6520 6974  ted therefore it
-0003f040: 206d 6179 206e 6f74 2062 6520 6964 656e   may not be iden
-0003f050: 7469 6361 6c20 746f 2068 6f77 2074 6865  tical to how the
-0003f060: 0a20 2020 2020 2020 2020 2020 2060 6675  .            `fu
-0003f070: 6e63 6020 6973 206f 7269 6769 6e61 6c6c  nc` is originall
-0003f080: 7920 6465 6669 6e65 642e 2054 6865 2064  y defined. The d
-0003f090: 6566 6175 6c74 2069 7320 6060 5472 7565  efault is ``True
-0003f0a0: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
-0003f0b0: 4966 2069 7420 6973 2060 6046 616c 7365  If it is ``False
-0003f0c0: 6060 2c20 736f 7572 6365 2063 6f64 6520  ``, source code 
-0003f0d0: 7769 6c6c 206e 6f74 2062 6520 6765 6e65  will not be gene
-0003f0e0: 7261 7465 6420 6f72 2064 6973 706c 6179  rated or display
-0003f0f0: 6564 2e0a 0a20 2020 2052 6574 7572 6e73  ed...    Returns
-0003f100: 3a0a 2020 2020 2020 2020 4120 7374 6f72  :.        A stor
-0003f110: 6564 2070 726f 6365 6475 7265 2066 756e  ed procedure fun
-0003f120: 6374 696f 6e20 7468 6174 2063 616e 2062  ction that can b
-0003f130: 6520 6361 6c6c 6564 2077 6974 6820 7079  e called with py
-0003f140: 7468 6f6e 2076 616c 7565 2e0a 0a20 2020  thon value...   
-0003f150: 204e 6f74 653a 0a20 2020 2020 2020 2031   Note:.        1
-0003f160: 2e20 5768 656e 2074 7970 6520 6869 6e74  . When type hint
-0003f170: 7320 6172 6520 7072 6f76 6964 6564 2061  s are provided a
-0003f180: 6e64 2061 7265 2063 6f6d 706c 6574 6520  nd are complete 
-0003f190: 666f 7220 6120 6675 6e63 7469 6f6e 2c0a  for a function,.
-0003f1a0: 2020 2020 2020 2020 6060 7265 7475 726e          ``return
-0003f1b0: 5f74 7970 6560 6020 616e 6420 6060 696e  _type`` and ``in
-0003f1c0: 7075 745f 7479 7065 7360 6020 6172 6520  put_types`` are 
-0003f1d0: 6f70 7469 6f6e 616c 2061 6e64 2077 696c  optional and wil
-0003f1e0: 6c20 6265 2069 676e 6f72 6564 2e0a 2020  l be ignored..  
-0003f1f0: 2020 2020 2020 5365 6520 6465 7461 696c        See detail
-0003f200: 7320 6f66 2073 7570 706f 7274 6564 2064  s of supported d
-0003f210: 6174 6120 7479 7065 7320 666f 7220 7374  ata types for st
-0003f220: 6f72 6564 2070 726f 6365 6475 7265 2069  ored procedure i
-0003f230: 6e0a 2020 2020 2020 2020 3a63 6c61 7373  n.        :class
-0003f240: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
-0003f250: 7770 6172 6b2e 7374 6f72 6564 5f70 726f  wpark.stored_pro
-0003f260: 6365 6475 7265 2e53 746f 7265 6450 726f  cedure.StoredPro
-0003f270: 6365 6475 7265 5265 6769 7374 7261 7469  cedureRegistrati
-0003f280: 6f6e 602e 0a0a 2020 2020 2020 2020 2020  on`...          
-0003f290: 2020 2d20 596f 7520 6361 6e20 7573 6520    - You can use 
-0003f2a0: 3a61 7474 723a 607e 736e 6f77 666c 616b  :attr:`~snowflak
-0003f2b0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
-0003f2c0: 2e56 6172 6961 6e74 6020 746f 0a20 2020  .Variant` to.   
-0003f2d0: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
-0003f2e0: 6174 6520 6120 7661 7269 616e 742c 2061  ate a variant, a
-0003f2f0: 6e64 2075 7365 203a 6174 7472 3a60 7e73  nd use :attr:`~s
-0003f300: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
-0003f310: 6b2e 7479 7065 732e 4765 6f67 7261 7068  k.types.Geograph
-0003f320: 7960 0a20 2020 2020 2020 2020 2020 2020  y`.             
-0003f330: 2074 6f20 616e 6e6f 7461 7465 2061 2067   to annotate a g
-0003f340: 656f 6772 6170 6879 2077 6865 6e20 6465  eography when de
-0003f350: 6669 6e69 6e67 2061 2073 746f 7265 6420  fining a stored 
-0003f360: 7072 6f63 6564 7572 652e 0a0a 2020 2020  procedure...    
-0003f370: 2020 2020 2020 2020 2d20 3a63 6c61 7373          - :class
-0003f380: 3a60 7479 7069 6e67 2e55 6e69 6f6e 6020  :`typing.Union` 
-0003f390: 6973 206e 6f74 2061 2076 616c 6964 2074  is not a valid t
-0003f3a0: 7970 6520 616e 6e6f 7461 7469 6f6e 2066  ype annotation f
-0003f3b0: 6f72 2073 746f 7265 6420 7072 6f63 6564  or stored proced
-0003f3c0: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
-0003f3d0: 2020 2020 6275 7420 3a63 6c61 7373 3a60      but :class:`
-0003f3e0: 7479 7069 6e67 2e4f 7074 696f 6e61 6c60  typing.Optional`
-0003f3f0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0003f400: 696e 6469 6361 7465 2074 6865 206f 7074  indicate the opt
-0003f410: 696f 6e61 6c20 7479 7065 2e0a 0a20 2020  ional type...   
-0003f420: 2020 2020 2032 2e20 4120 7465 6d70 6f72       2. A tempor
-0003f430: 6172 7920 7374 6f72 6564 2070 726f 6365  ary stored proce
-0003f440: 6475 7265 2028 7768 656e 2060 6069 735f  dure (when ``is_
-0003f450: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
-0003f460: 6046 616c 7365 6060 2920 6973 2073 636f  `False``) is sco
-0003f470: 7065 6420 746f 2074 6869 7320 6060 7365  ped to this ``se
-0003f480: 7373 696f 6e60 600a 2020 2020 2020 2020  ssion``.        
-0003f490: 616e 6420 616c 6c20 7374 6f72 6564 2070  and all stored p
-0003f4a0: 726f 6365 6475 7265 2072 656c 6174 6564  rocedure related
-0003f4b0: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
-0003f4c0: 706c 6f61 6465 6420 746f 2061 2074 656d  ploaded to a tem
-0003f4d0: 706f 7261 7279 2073 6573 7369 6f6e 2073  porary session s
-0003f4e0: 7461 6765 0a20 2020 2020 2020 2028 3a66  tage.        (:f
-0003f4f0: 756e 633a 6073 6573 7369 6f6e 2e67 6574  unc:`session.get
-0003f500: 5f73 6573 7369 6f6e 5f73 7461 6765 2829  _session_stage()
-0003f510: 203c 736e 6f77 666c 616b 652e 736e 6f77   <snowflake.snow
-0003f520: 7061 726b 2e53 6573 7369 6f6e 2e67 6574  park.Session.get
-0003f530: 5f73 6573 7369 6f6e 5f73 7461 6765 3e60  _session_stage>`
-0003f540: 292e 0a20 2020 2020 2020 2046 6f72 2061  )..        For a
-0003f550: 2070 6572 6d61 6e65 6e74 2073 746f 7265   permanent store
-0003f560: 6420 7072 6f63 6564 7572 652c 2074 6865  d procedure, the
-0003f570: 7365 2066 696c 6573 2077 696c 6c20 6265  se files will be
-0003f580: 2075 706c 6f61 6465 6420 746f 2074 6865   uploaded to the
-0003f590: 2073 7461 6765 2074 6861 7420 796f 7520   stage that you 
-0003f5a0: 7072 6f76 6964 652e 0a0a 2020 2020 2020  provide...      
-0003f5b0: 2020 332e 2042 7920 6465 6661 756c 742c    3. By default,
-0003f5c0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
-0003f5d0: 6520 7265 6769 7374 7261 7469 6f6e 2066  e registration f
-0003f5e0: 6169 6c73 2069 6620 6120 6675 6e63 7469  ails if a functi
-0003f5f0: 6f6e 2077 6974 6820 7468 6520 7361 6d65  on with the same
-0003f600: 206e 616d 6520 6973 2061 6c72 6561 6479   name is already
-0003f610: 0a20 2020 2020 2020 2072 6567 6973 7465  .        registe
-0003f620: 7265 642e 2049 6e76 6f6b 696e 6720 3a66  red. Invoking :f
-0003f630: 756e 633a 6073 7072 6f63 6020 7769 7468  unc:`sproc` with
-0003f640: 2060 6072 6570 6c61 6365 6060 2073 6574   ``replace`` set
-0003f650: 2074 6f20 6060 5472 7565 6060 2077 696c   to ``True`` wil
-0003f660: 6c20 6f76 6572 7772 6974 6520 7468 650a  l overwrite the.
-0003f670: 2020 2020 2020 2020 7072 6576 696f 7573          previous
-0003f680: 6c79 2072 6567 6973 7465 7265 6420 6675  ly registered fu
-0003f690: 6e63 7469 6f6e 2e0a 0a20 2020 2053 6565  nction...    See
-0003f6a0: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
-0003f6b0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
-0003f6c0: 652e 736e 6f77 7061 726b 2e73 746f 7265  e.snowpark.store
-0003f6d0: 645f 7072 6f63 6564 7572 652e 5374 6f72  d_procedure.Stor
-0003f6e0: 6564 5072 6f63 6564 7572 6552 6567 6973  edProcedureRegis
-0003f6f0: 7472 6174 696f 6e60 0a0a 2020 2020 4578  tration`..    Ex
-0003f700: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
-0003f710: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
-0003f720: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
-0003f730: 7320 696d 706f 7274 2049 6e74 6567 6572  s import Integer
-0003f740: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
-0003f750: 2040 7370 726f 6328 7265 7475 726e 5f74   @sproc(return_t
-0003f760: 7970 653d 496e 7465 6765 7254 7970 6528  ype=IntegerType(
-0003f770: 292c 2069 6e70 7574 5f74 7970 6573 3d5b  ), input_types=[
-0003f780: 496e 7465 6765 7254 7970 6528 292c 2049  IntegerType(), I
-0003f790: 6e74 6567 6572 5479 7065 2829 5d2c 2070  ntegerType()], p
-0003f7a0: 6163 6b61 6765 733d 5b22 736e 6f77 666c  ackages=["snowfl
-0003f7b0: 616b 652d 736e 6f77 7061 726b 2d70 7974  ake-snowpark-pyt
-0003f7c0: 686f 6e22 5d29 0a20 2020 2020 2020 202e  hon"]).        .
-0003f7d0: 2e2e 2064 6566 2061 6464 5f73 7028 7365  .. def add_sp(se
-0003f7e0: 7373 696f 6e5f 2c20 782c 2079 293a 0a20  ssion_, x, y):. 
-0003f7f0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
-0003f800: 6574 7572 6e20 7365 7373 696f 6e5f 2e73  eturn session_.s
-0003f810: 716c 2866 2253 454c 4543 5420 7b78 7d20  ql(f"SELECT {x} 
-0003f820: 2b20 7b79 7d22 292e 636f 6c6c 6563 7428  + {y}").collect(
-0003f830: 295b 305d 5b30 5d0a 2020 2020 2020 2020  )[0][0].        
-0003f840: 2e2e 2e0a 2020 2020 2020 2020 3e3e 3e20  ....        >>> 
-0003f850: 6164 645f 7370 2831 2c20 3129 0a20 2020  add_sp(1, 1).   
-0003f860: 2020 2020 2032 0a20 2020 2022 2222 0a20       2.    """. 
-0003f870: 2020 2073 6573 7369 6f6e 203d 2073 6573     session = ses
-0003f880: 7369 6f6e 206f 7220 736e 6f77 666c 616b  sion or snowflak
-0003f890: 652e 736e 6f77 7061 726b 2e73 6573 7369  e.snowpark.sessi
-0003f8a0: 6f6e 2e5f 6765 745f 6163 7469 7665 5f73  on._get_active_s
-0003f8b0: 6573 7369 6f6e 2829 0a20 2020 2069 6620  ession().    if 
-0003f8c0: 6675 6e63 2069 7320 4e6f 6e65 3a0a 2020  func is None:.  
-0003f8d0: 2020 2020 2020 7265 7475 726e 2066 756e        return fun
-0003f8e0: 6374 6f6f 6c73 2e70 6172 7469 616c 280a  ctools.partial(.
-0003f8f0: 2020 2020 2020 2020 2020 2020 7365 7373              sess
-0003f900: 696f 6e2e 7370 726f 632e 7265 6769 7374  ion.sproc.regist
-0003f910: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0003f920: 7265 7475 726e 5f74 7970 653d 7265 7475  return_type=retu
-0003f930: 726e 5f74 7970 652c 0a20 2020 2020 2020  rn_type,.       
-0003f940: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
-0003f950: 3d69 6e70 7574 5f74 7970 6573 2c0a 2020  =input_types,.  
-0003f960: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
-0003f970: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0003f980: 2069 735f 7065 726d 616e 656e 743d 6973   is_permanent=is
-0003f990: 5f70 6572 6d61 6e65 6e74 2c0a 2020 2020  _permanent,.    
-0003f9a0: 2020 2020 2020 2020 7374 6167 655f 6c6f          stage_lo
-0003f9b0: 6361 7469 6f6e 3d73 7461 6765 5f6c 6f63  cation=stage_loc
-0003f9c0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-0003f9d0: 2020 2069 6d70 6f72 7473 3d69 6d70 6f72     imports=impor
-0003f9e0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0003f9f0: 7061 636b 6167 6573 3d70 6163 6b61 6765  packages=package
-0003fa00: 732c 0a20 2020 2020 2020 2020 2020 2072  s,.            r
-0003fa10: 6570 6c61 6365 3d72 6570 6c61 6365 2c0a  eplace=replace,.
-0003fa20: 2020 2020 2020 2020 2020 2020 6966 5f6e              if_n
-0003fa30: 6f74 5f65 7869 7374 733d 6966 5f6e 6f74  ot_exists=if_not
-0003fa40: 5f65 7869 7374 732c 0a20 2020 2020 2020  _exists,.       
-0003fa50: 2020 2020 2070 6172 616c 6c65 6c3d 7061       parallel=pa
-0003fa60: 7261 6c6c 656c 2c0a 2020 2020 2020 2020  rallel,.        
-0003fa70: 2020 2020 7374 6174 656d 656e 745f 7061      statement_pa
-0003fa80: 7261 6d73 3d73 7461 7465 6d65 6e74 5f70  rams=statement_p
-0003fa90: 6172 616d 732c 0a20 2020 2020 2020 2020  arams,.         
-0003faa0: 2020 2065 7865 6375 7465 5f61 733d 6578     execute_as=ex
-0003fab0: 6563 7574 655f 6173 2c0a 2020 2020 2020  ecute_as,.      
-0003fac0: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
-0003fad0: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-0003fae0: 2073 6f75 7263 655f 636f 6465 5f64 6973   source_code_dis
-0003faf0: 706c 6179 3d73 6f75 7263 655f 636f 6465  play=source_code
-0003fb00: 5f64 6973 706c 6179 2c0a 2020 2020 2020  _display,.      
-0003fb10: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
-0003fb20: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
-0003fb30: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
-0003fb40: 726e 2073 6573 7369 6f6e 2e73 7072 6f63  rn session.sproc
-0003fb50: 2e72 6567 6973 7465 7228 0a20 2020 2020  .register(.     
-0003fb60: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-0003fb70: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-0003fb80: 7479 7065 3d72 6574 7572 6e5f 7479 7065  type=return_type
-0003fb90: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0003fba0: 7075 745f 7479 7065 733d 696e 7075 745f  put_types=input_
-0003fbb0: 7479 7065 732c 0a20 2020 2020 2020 2020  types,.         
-0003fbc0: 2020 206e 616d 653d 6e61 6d65 2c0a 2020     name=name,.  
-0003fbd0: 2020 2020 2020 2020 2020 6973 5f70 6572            is_per
-0003fbe0: 6d61 6e65 6e74 3d69 735f 7065 726d 616e  manent=is_perman
-0003fbf0: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
-0003fc00: 2073 7461 6765 5f6c 6f63 6174 696f 6e3d   stage_location=
-0003fc10: 7374 6167 655f 6c6f 6361 7469 6f6e 2c0a  stage_location,.
-0003fc20: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-0003fc30: 7274 733d 696d 706f 7274 732c 0a20 2020  rts=imports,.   
-0003fc40: 2020 2020 2020 2020 2070 6163 6b61 6765           package
-0003fc50: 733d 7061 636b 6167 6573 2c0a 2020 2020  s=packages,.    
-0003fc60: 2020 2020 2020 2020 7265 706c 6163 653d          replace=
-0003fc70: 7265 706c 6163 652c 0a20 2020 2020 2020  replace,.       
-0003fc80: 2020 2020 2069 665f 6e6f 745f 6578 6973       if_not_exis
-0003fc90: 7473 3d69 665f 6e6f 745f 6578 6973 7473  ts=if_not_exists
-0003fca0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0003fcb0: 7261 6c6c 656c 3d70 6172 616c 6c65 6c2c  rallel=parallel,
-0003fcc0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-0003fcd0: 7465 6d65 6e74 5f70 6172 616d 733d 7374  tement_params=st
-0003fce0: 6174 656d 656e 745f 7061 7261 6d73 2c0a  atement_params,.
-0003fcf0: 2020 2020 2020 2020 2020 2020 6578 6563              exec
-0003fd00: 7574 655f 6173 3d65 7865 6375 7465 5f61  ute_as=execute_a
-0003fd10: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-0003fd20: 7472 6963 743d 7374 7269 6374 2c0a 2020  trict=strict,.  
-0003fd30: 2020 2020 2020 2020 2020 736f 7572 6365            source
-0003fd40: 5f63 6f64 655f 6469 7370 6c61 793d 736f  _code_display=so
-0003fd50: 7572 6365 5f63 6f64 655f 6469 7370 6c61  urce_code_displa
-0003fd60: 792c 0a20 2020 2020 2020 2020 2020 202a  y,.            *
-0003fd70: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-0003fd80: 2029 0a0a 0a23 2041 6464 2074 6865 7365   )...# Add these
-0003fd90: 2061 6c69 6173 2066 6f72 2075 7365 7220   alias for user 
-0003fda0: 636f 6465 206d 6967 7261 7469 6f6e 0a63  code migration.c
-0003fdb0: 616c 6c5f 6275 696c 7469 6e20 3d20 6361  all_builtin = ca
-0003fdc0: 6c6c 5f66 756e 6374 696f 6e0a 6275 696c  ll_function.buil
-0003fdd0: 7469 6e20 3d20 6675 6e63 7469 6f6e 0a63  tin = function.c
-0003fde0: 6f75 6e74 4469 7374 696e 6374 203d 2063  ountDistinct = c
-0003fdf0: 6f75 6e74 5f64 6973 7469 6e63 740a 7375  ount_distinct.su
-0003fe00: 6273 7472 203d 2073 7562 7374 7269 6e67  bstr = substring
-0003fe10: 0a74 6f5f 7661 7263 6861 7220 3d20 746f  .to_varchar = to
-0003fe20: 5f63 6861 720a 6578 7072 203d 2073 716c  _char.expr = sql
-0003fe30: 5f65 7870 720a 6461 7465 5f66 6f72 6d61  _expr.date_forma
-0003fe40: 7420 3d20 746f 5f64 6174 650a 6d6f 6e6f  t = to_date.mono
-0003fe50: 746f 6e69 6361 6c6c 795f 696e 6372 6561  tonically_increa
-0003fe60: 7369 6e67 5f69 6420 3d20 7365 7138 0a66  sing_id = seq8.f
-0003fe70: 726f 6d5f 756e 6978 7469 6d65 203d 2074  rom_unixtime = t
-0003fe80: 6f5f 7469 6d65 7374 616d 700a 0a0a 6465  o_timestamp...de
-0003fe90: 6620 756e 6978 5f74 696d 6573 7461 6d70  f unix_timestamp
-0003fea0: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
-0003feb0: 2c20 666d 743a 204f 7074 696f 6e61 6c5b  , fmt: Optional[
-0003fec0: 2243 6f6c 756d 6e22 5d20 3d20 4e6f 6e65  "Column"] = None
-0003fed0: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
-0003fee0: 2022 2222 0a20 2020 2043 6f6e 7665 7274   """.    Convert
-0003fef0: 7320 6120 7469 6d65 7374 616d 7020 6f72  s a timestamp or
-0003ff00: 2061 2074 696d 6573 7461 6d70 2073 7472   a timestamp str
-0003ff10: 696e 6720 746f 2055 6e69 7820 7469 6d65  ing to Unix time
-0003ff20: 2073 7461 6d70 2028 696e 2073 6563 6f6e   stamp (in secon
-0003ff30: 6473 292e 0a0a 2020 2020 4578 616d 706c  ds)...    Exampl
-0003ff40: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
-0003ff50: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-0003ff60: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
-0003ff70: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
-0003ff80: 5f64 6174 6166 7261 6d65 285b 5b22 3230  _dataframe([["20
-0003ff90: 3133 2d30 352d 3038 5432 333a 3339 3a32  13-05-08T23:39:2
-0003ffa0: 302e 3132 332d 3037 3a30 3022 5d5d 2c20  0.123-07:00"]], 
-0003ffb0: 7363 6865 6d61 3d5b 2274 735f 636f 6c22  schema=["ts_col"
-0003ffc0: 5d29 0a20 2020 2020 2020 203e 3e3e 2064  ]).        >>> d
-0003ffd0: 662e 7365 6c65 6374 2875 6e69 785f 7469  f.select(unix_ti
-0003ffe0: 6d65 7374 616d 7028 636f 6c28 2274 735f  mestamp(col("ts_
-0003fff0: 636f 6c22 2929 2e61 6c69 6173 2822 756e  col")).alias("un
-00040000: 6978 5f74 696d 6522 2929 2e73 686f 7728  ix_time")).show(
-00040010: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
-00040020: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00040030: 2020 7c22 554e 4958 5f54 494d 4522 2020    |"UNIX_TIME"  
-00040040: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00040050: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00040060: 2020 7c31 3336 3830 3536 3336 3020 2020    |1368056360   
-00040070: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
-00040080: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00040090: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-000400a0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-000400b0: 2064 6174 655f 7061 7274 2822 6570 6f63   date_part("epoc
-000400c0: 685f 7365 636f 6e64 222c 2074 6f5f 7469  h_second", to_ti
-000400d0: 6d65 7374 616d 7028 652c 2066 6d74 2929  mestamp(e, fmt))
-000400e0: 0a                                       .
+000288e0: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+000288f0: 2020 7c0a 2020 2020 2020 2020 7c20 2031    |.        |  1
+00028900: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+00028910: 207c 2020 3220 2020 2020 2020 7c0a 2020   |  2       |.  
+00028920: 2020 2020 2020 7c5d 2020 2020 2020 2020        |]        
+00028930: 207c 0a20 2020 2020 2020 207c 5b20 2020   |.        |[   
+00028940: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00028950: 7c20 2033 2c20 2020 2020 207c 0a20 2020  |  3,      |.   
+00028960: 2020 2020 207c 2020 3420 2020 2020 2020       |  4       
+00028970: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00028980: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00028990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000289a0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+000289b0: 2020 2020 2222 220a 2020 2020 6373 203d      """.    cs =
+000289c0: 205b 5f74 6f5f 636f 6c5f 6966 5f73 7472   [_to_col_if_str
+000289d0: 2863 2c20 2261 7272 6179 5f63 6f6e 7374  (c, "array_const
+000289e0: 7275 6374 5f63 6f6d 7061 6374 2229 2066  ruct_compact") f
+000289f0: 6f72 2063 2069 6e20 636f 6c73 5d0a 2020  or c in cols].  
+00028a00: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+00028a10: 2822 6172 7261 795f 636f 6e73 7472 7563  ("array_construc
+00028a20: 745f 636f 6d70 6163 7422 2928 2a63 7329  t_compact")(*cs)
+00028a30: 0a0a 0a64 6566 2061 7272 6179 5f63 6f6e  ...def array_con
+00028a40: 7461 696e 7328 7661 7269 616e 743a 2043  tains(variant: C
+00028a50: 6f6c 756d 6e4f 724e 616d 652c 2061 7272  olumnOrName, arr
+00028a60: 6179 3a20 436f 6c75 6d6e 4f72 4e61 6d65  ay: ColumnOrName
+00028a70: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00028a80: 2022 2222 5265 7475 726e 7320 5472 7565   """Returns True
+00028a90: 2069 6620 7468 6520 7370 6563 6966 6965   if the specifie
+00028aa0: 6420 5641 5249 414e 5420 6973 2066 6f75  d VARIANT is fou
+00028ab0: 6e64 2069 6e20 7468 6520 7370 6563 6966  nd in the specif
+00028ac0: 6965 6420 4152 5241 592e 0a0a 2020 2020  ied ARRAY...    
+00028ad0: 4172 6773 3a0a 2020 2020 2020 2020 7661  Args:.        va
+00028ae0: 7269 616e 743a 2043 6f6c 756d 6e20 636f  riant: Column co
+00028af0: 6e74 6169 6e69 6e67 2074 6865 2056 4152  ntaining the VAR
+00028b00: 4941 4e54 2074 6f20 6669 6e64 2e0a 2020  IANT to find..  
+00028b10: 2020 2020 2020 6172 7261 793a 2043 6f6c        array: Col
+00028b20: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
+00028b30: 6865 2041 5252 4159 2074 6f20 7365 6172  he ARRAY to sear
+00028b40: 6368 2e0a 0a20 2020 2045 7861 6d70 6c65  ch...    Example
+00028b50: 3a3a 0a20 2020 2020 2020 203e 3e3e 2066  ::.        >>> f
+00028b60: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00028b70: 6f77 7061 726b 2069 6d70 6f72 7420 526f  owpark import Ro
+00028b80: 770a 2020 2020 2020 2020 3e3e 3e20 6466  w.        >>> df
+00028b90: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00028ba0: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
+00028bb0: 285b 312c 2032 5d29 2c20 526f 7728 5b31  ([1, 2]), Row([1
+00028bc0: 2c20 335d 295d 2c20 7363 6865 6d61 3d5b  , 3])], schema=[
+00028bd0: 2261 225d 290a 2020 2020 2020 2020 3e3e  "a"]).        >>
+00028be0: 3e20 6466 2e73 656c 6563 7428 6172 7261  > df.select(arra
+00028bf0: 795f 636f 6e74 6169 6e73 286c 6974 2832  y_contains(lit(2
+00028c00: 292c 2022 6122 292e 616c 6961 7328 2272  ), "a").alias("r
+00028c10: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+00028c20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00028c30: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+00028c40: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+00028c50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+00028c60: 2020 2020 2020 207c 5472 7565 2020 2020         |True    
+00028c70: 2020 7c0a 2020 2020 2020 2020 7c46 616c    |.        |Fal
+00028c80: 7365 2020 2020 207c 0a20 2020 2020 2020  se     |.       
+00028c90: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00028ca0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00028cb0: 3e0a 2020 2020 2222 220a 2020 2020 7620  >.    """.    v 
+00028cc0: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+00028cd0: 2876 6172 6961 6e74 2c20 2261 7272 6179  (variant, "array
+00028ce0: 5f63 6f6e 7461 696e 7322 290a 2020 2020  _contains").    
+00028cf0: 6120 3d20 5f74 6f5f 636f 6c5f 6966 5f73  a = _to_col_if_s
+00028d00: 7472 2861 7272 6179 2c20 2261 7272 6179  tr(array, "array
+00028d10: 5f63 6f6e 7461 696e 7322 290a 2020 2020  _contains").    
+00028d20: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+00028d30: 6172 7261 795f 636f 6e74 6169 6e73 2229  array_contains")
+00028d40: 2876 2c20 6129 0a0a 0a64 6566 2061 7272  (v, a)...def arr
+00028d50: 6179 5f69 6e73 6572 7428 0a20 2020 2061  ay_insert(.    a
+00028d60: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
+00028d70: 6d65 2c20 706f 733a 2043 6f6c 756d 6e4f  me, pos: ColumnO
+00028d80: 724e 616d 652c 2065 6c65 6d65 6e74 3a20  rName, element: 
+00028d90: 436f 6c75 6d6e 4f72 4e61 6d65 0a29 202d  ColumnOrName.) -
+00028da0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00028db0: 2252 6574 7572 6e73 2061 6e20 4152 5241  "Returns an ARRA
+00028dc0: 5920 636f 6e74 6169 6e69 6e67 2061 6c6c  Y containing all
+00028dd0: 2065 6c65 6d65 6e74 7320 6672 6f6d 2074   elements from t
+00028de0: 6865 2073 6f75 7263 6520 4152 5241 5920  he source ARRAY 
+00028df0: 6173 2077 656c 6c20 6173 2074 6865 206e  as well as the n
+00028e00: 6577 2065 6c65 6d65 6e74 2e0a 0a20 2020  ew element...   
+00028e10: 2041 7267 733a 0a20 2020 2020 2020 2061   Args:.        a
+00028e20: 7272 6179 3a20 436f 6c75 6d6e 2063 6f6e  rray: Column con
+00028e30: 7461 696e 696e 6720 7468 6520 736f 7572  taining the sour
+00028e40: 6365 2041 5252 4159 2e0a 2020 2020 2020  ce ARRAY..      
+00028e50: 2020 706f 733a 2043 6f6c 756d 6e20 636f    pos: Column co
+00028e60: 6e74 6169 6e69 6e67 2061 2028 7a65 726f  ntaining a (zero
+00028e70: 2d62 6173 6564 2920 706f 7369 7469 6f6e  -based) position
+00028e80: 2069 6e20 7468 6520 736f 7572 6365 2041   in the source A
+00028e90: 5252 4159 2e0a 2020 2020 2020 2020 2020  RRAY..          
+00028ea0: 2020 5468 6520 6e65 7720 656c 656d 656e    The new elemen
+00028eb0: 7420 6973 2069 6e73 6572 7465 6420 6174  t is inserted at
+00028ec0: 2074 6869 7320 706f 7369 7469 6f6e 2e20   this position. 
+00028ed0: 5468 6520 6f72 6967 696e 616c 2065 6c65  The original ele
+00028ee0: 6d65 6e74 2066 726f 6d20 7468 6973 0a20  ment from this. 
+00028ef0: 2020 2020 2020 2020 2020 2070 6f73 6974             posit
+00028f00: 696f 6e20 2869 6620 616e 7929 2061 6e64  ion (if any) and
+00028f10: 2061 6c6c 2073 7562 7365 7175 656e 7420   all subsequent 
+00028f20: 656c 656d 656e 7473 2028 6966 2061 6e79  elements (if any
+00028f30: 2920 6172 6520 7368 6966 7465 6420 6279  ) are shifted by
+00028f40: 206f 6e65 2070 6f73 6974 696f 6e0a 2020   one position.  
+00028f50: 2020 2020 2020 2020 2020 746f 2074 6865            to the
+00028f60: 2072 6967 6874 2069 6e20 7468 6520 7265   right in the re
+00028f70: 7375 6c74 696e 6720 6172 7261 7920 2869  sulting array (i
+00028f80: 2e65 2e20 696e 7365 7274 696e 6720 6174  .e. inserting at
+00028f90: 2070 6f73 6974 696f 6e20 3020 6861 7320   position 0 has 
+00028fa0: 7468 6520 7361 6d65 0a20 2020 2020 2020  the same.       
+00028fb0: 2020 2020 2065 6666 6563 7420 6173 2075       effect as u
+00028fc0: 7369 6e67 2061 7272 6179 5f70 7265 7065  sing array_prepe
+00028fd0: 6e64 292e 0a20 2020 2020 2020 2020 2020  nd)..           
+00028fe0: 2041 206e 6567 6174 6976 6520 706f 7369   A negative posi
+00028ff0: 7469 6f6e 2069 7320 696e 7465 7270 7265  tion is interpre
+00029000: 7465 6420 6173 2061 6e20 696e 6465 7820  ted as an index 
+00029010: 6672 6f6d 2074 6865 2062 6163 6b20 6f66  from the back of
+00029020: 2074 6865 2061 7272 6179 2028 652e 672e   the array (e.g.
+00029030: 0a20 2020 2020 2020 2020 2020 202d 3120  .            -1 
+00029040: 7265 7375 6c74 7320 696e 2069 6e73 6572  results in inser
+00029050: 7469 6f6e 2062 6566 6f72 6520 7468 6520  tion before the 
+00029060: 6c61 7374 2065 6c65 6d65 6e74 2069 6e20  last element in 
+00029070: 7468 6520 6172 7261 7929 2e0a 2020 2020  the array)..    
+00029080: 2020 2020 656c 656d 656e 743a 2043 6f6c      element: Col
+00029090: 756d 6e20 636f 6e74 6169 6e69 6e67 2074  umn containing t
+000290a0: 6865 2065 6c65 6d65 6e74 2074 6f20 6265  he element to be
+000290b0: 2069 6e73 6572 7465 642e 2054 6865 206e   inserted. The n
+000290c0: 6577 2065 6c65 6d65 6e74 2069 7320 6c6f  ew element is lo
+000290d0: 6361 7465 6420 6174 0a20 2020 2020 2020  cated at.       
+000290e0: 2020 2020 2070 6f73 6974 696f 6e20 706f       position po
+000290f0: 732e 2054 6865 2072 656c 6174 6976 6520  s. The relative 
+00029100: 6f72 6465 7220 6f66 2074 6865 206f 7468  order of the oth
+00029110: 6572 2065 6c65 6d65 6e74 7320 6672 6f6d  er elements from
+00029120: 2074 6865 2073 6f75 7263 650a 2020 2020   the source.    
+00029130: 2020 2020 2020 2020 6172 7261 7920 6973          array is
+00029140: 2070 7265 7365 7276 6564 2e0a 0a20 2020   preserved...   
+00029150: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00029160: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00029170: 666c 616b 652e 736e 6f77 7061 726b 2069  flake.snowpark i
+00029180: 6d70 6f72 7420 526f 770a 2020 2020 2020  mport Row.      
+00029190: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000291a0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000291b0: 616d 6528 5b52 6f77 285b 312c 2032 5d29  ame([Row([1, 2])
+000291c0: 2c20 526f 7728 5b31 2c20 335d 295d 2c20  , Row([1, 3])], 
+000291d0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+000291e0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000291f0: 6563 7428 6172 7261 795f 696e 7365 7274  ect(array_insert
+00029200: 2822 6122 2c20 6c69 7428 3029 2c20 6c69  ("a", lit(0), li
+00029210: 7428 3130 2929 2e61 6c69 6173 2822 7265  t(10)).alias("re
+00029220: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+00029230: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00029240: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+00029250: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+00029260: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00029270: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
+00029280: 207c 0a20 2020 2020 2020 207c 2020 3130   |.        |  10
+00029290: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
+000292a0: 7c20 2031 2c20 2020 2020 207c 0a20 2020  |  1,      |.   
+000292b0: 2020 2020 207c 2020 3220 2020 2020 2020       |  2       
+000292c0: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+000292d0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+000292e0: 5b20 2020 2020 2020 2020 7c0a 2020 2020  [         |.    
+000292f0: 2020 2020 7c20 2031 302c 2020 2020 207c      |  10,     |
+00029300: 0a20 2020 2020 2020 207c 2020 312c 2020  .        |  1,  
+00029310: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+00029320: 2033 2020 2020 2020 207c 0a20 2020 2020   3       |.     
+00029330: 2020 207c 5d20 2020 2020 2020 2020 7c0a     |]         |.
+00029340: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00029350: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+00029360: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+00029370: 0a20 2020 2061 203d 205f 746f 5f63 6f6c  .    a = _to_col
+00029380: 5f69 665f 7374 7228 6172 7261 792c 2022  _if_str(array, "
+00029390: 6172 7261 795f 696e 7365 7274 2229 0a20  array_insert"). 
+000293a0: 2020 2070 203d 205f 746f 5f63 6f6c 5f69     p = _to_col_i
+000293b0: 665f 7374 7228 706f 732c 2022 6172 7261  f_str(pos, "arra
+000293c0: 795f 696e 7365 7274 2229 0a20 2020 2065  y_insert").    e
+000293d0: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+000293e0: 7228 656c 656d 656e 742c 2022 6172 7261  r(element, "arra
+000293f0: 795f 696e 7365 7274 2229 0a20 2020 2072  y_insert").    r
+00029400: 6574 7572 6e20 6275 696c 7469 6e28 2261  eturn builtin("a
+00029410: 7272 6179 5f69 6e73 6572 7422 2928 612c  rray_insert")(a,
+00029420: 2070 2c20 6529 0a0a 0a64 6566 2061 7272   p, e)...def arr
+00029430: 6179 5f70 6f73 6974 696f 6e28 7661 7269  ay_position(vari
+00029440: 616e 743a 2043 6f6c 756d 6e4f 724e 616d  ant: ColumnOrNam
+00029450: 652c 2061 7272 6179 3a20 436f 6c75 6d6e  e, array: Column
+00029460: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00029470: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00029480: 7320 7468 6520 696e 6465 7820 6f66 2074  s the index of t
+00029490: 6865 2066 6972 7374 206f 6363 7572 7265  he first occurre
+000294a0: 6e63 6520 6f66 2061 6e20 656c 656d 656e  nce of an elemen
+000294b0: 7420 696e 2061 6e20 4152 5241 592e 0a0a  t in an ARRAY...
+000294c0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+000294d0: 2020 7661 7269 616e 743a 2043 6f6c 756d    variant: Colum
+000294e0: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
+000294f0: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
+00029500: 6861 7420 796f 7520 7761 6e74 2074 6f20  hat you want to 
+00029510: 6669 6e64 2e20 5468 6520 6675 6e63 7469  find. The functi
+00029520: 6f6e 0a20 2020 2020 2020 2020 2020 2073  on.            s
+00029530: 6561 7263 6865 7320 666f 7220 7468 6520  earches for the 
+00029540: 6669 7273 7420 6f63 6375 7272 656e 6365  first occurrence
+00029550: 206f 6620 7468 6973 2076 616c 7565 2069   of this value i
+00029560: 6e20 7468 6520 6172 7261 792e 0a20 2020  n the array..   
+00029570: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
+00029580: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
+00029590: 6520 4152 5241 5920 746f 2062 6520 7365  e ARRAY to be se
+000295a0: 6172 6368 6564 2e0a 0a20 2020 2045 7861  arched...    Exa
+000295b0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+000295c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+000295d0: 652e 736e 6f77 7061 726b 2069 6d70 6f72  e.snowpark impor
+000295e0: 7420 526f 770a 2020 2020 2020 2020 3e3e  t Row.        >>
+000295f0: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00029600: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00029610: 5b52 6f77 285b 322c 2031 5d29 2c20 526f  [Row([2, 1]), Ro
+00029620: 7728 5b31 2c20 335d 295d 2c20 7363 6865  w([1, 3])], sche
+00029630: 6d61 3d5b 2261 225d 290a 2020 2020 2020  ma=["a"]).      
+00029640: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00029650: 6172 7261 795f 706f 7369 7469 6f6e 286c  array_position(l
+00029660: 6974 2831 292c 2022 6122 292e 616c 6961  it(1), "a").alia
+00029670: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+00029680: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+00029690: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000296a0: 207c 2252 4553 554c 5422 2020 7c0a 2020   |"RESULT"  |.  
+000296b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000296c0: 2d2d 0a20 2020 2020 2020 207c 3120 2020  --.        |1   
+000296d0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+000296e0: 7c30 2020 2020 2020 2020 207c 0a20 2020  |0         |.   
+000296f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00029700: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+00029710: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+00029720: 2020 7620 3d20 5f74 6f5f 636f 6c5f 6966    v = _to_col_if
+00029730: 5f73 7472 2876 6172 6961 6e74 2c20 2261  _str(variant, "a
+00029740: 7272 6179 5f70 6f73 6974 696f 6e22 290a  rray_position").
+00029750: 2020 2020 6120 3d20 5f74 6f5f 636f 6c5f      a = _to_col_
+00029760: 6966 5f73 7472 2861 7272 6179 2c20 2261  if_str(array, "a
+00029770: 7272 6179 5f70 6f73 6974 696f 6e22 290a  rray_position").
+00029780: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00029790: 696e 2822 6172 7261 795f 706f 7369 7469  in("array_positi
+000297a0: 6f6e 2229 2876 2c20 6129 0a0a 0a64 6566  on")(v, a)...def
+000297b0: 2061 7272 6179 5f70 7265 7065 6e64 2861   array_prepend(a
+000297c0: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
+000297d0: 6d65 2c20 656c 656d 656e 743a 2043 6f6c  me, element: Col
+000297e0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+000297f0: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00029800: 7572 6e73 2061 6e20 4152 5241 5920 636f  urns an ARRAY co
+00029810: 6e74 6169 6e69 6e67 2074 6865 206e 6577  ntaining the new
+00029820: 2065 6c65 6d65 6e74 2061 7320 7765 6c6c   element as well
+00029830: 2061 7320 616c 6c20 656c 656d 656e 7473   as all elements
+00029840: 2066 726f 6d20 7468 6520 736f 7572 6365   from the source
+00029850: 2041 5252 4159 2e0a 2020 2020 5468 6520   ARRAY..    The 
+00029860: 6e65 7720 656c 656d 656e 7420 6973 2070  new element is p
+00029870: 6f73 6974 696f 6e65 6420 6174 2074 6865  ositioned at the
+00029880: 2062 6567 696e 6e69 6e67 206f 6620 7468   beginning of th
+00029890: 6520 4152 5241 592e 0a0a 2020 2020 4172  e ARRAY...    Ar
+000298a0: 6773 3a0a 2020 2020 2020 2020 6172 7261  gs:.        arra
+000298b0: 7920 436f 6c75 6d6e 2063 6f6e 7461 696e  y Column contain
+000298c0: 696e 6720 7468 6520 736f 7572 6365 2041  ing the source A
+000298d0: 5252 4159 2e0a 2020 2020 2020 2020 656c  RRAY..        el
+000298e0: 656d 656e 7420 436f 6c75 6d6e 2063 6f6e  ement Column con
+000298f0: 7461 696e 696e 6720 7468 6520 656c 656d  taining the elem
+00029900: 656e 7420 746f 2062 6520 7072 6570 656e  ent to be prepen
+00029910: 6465 642e 0a0a 2020 2020 4578 616d 706c  ded...    Exampl
+00029920: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+00029930: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00029940: 6e6f 7770 6172 6b20 696d 706f 7274 2052  nowpark import R
+00029950: 6f77 0a20 2020 2020 2020 203e 3e3e 2064  ow.        >>> d
+00029960: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00029970: 7465 5f64 6174 6166 7261 6d65 285b 526f  te_dataframe([Ro
+00029980: 7728 613d 5b31 2c20 322c 2033 5d29 5d29  w(a=[1, 2, 3])])
+00029990: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000299a0: 7365 6c65 6374 2861 7272 6179 5f70 7265  select(array_pre
+000299b0: 7065 6e64 2822 6122 2c20 6c69 7428 3429  pend("a", lit(4)
+000299c0: 292e 616c 6961 7328 2272 6573 756c 7422  ).alias("result"
+000299d0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000299e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+000299f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+00029a00: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+00029a10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00029a20: 207c 5b20 2020 2020 2020 2020 7c0a 2020   |[         |.  
+00029a30: 2020 2020 2020 7c20 2034 2c20 2020 2020        |  4,     
+00029a40: 207c 0a20 2020 2020 2020 207c 2020 312c   |.        |  1,
+00029a50: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00029a60: 7c20 2032 2c20 2020 2020 207c 0a20 2020  |  2,      |.   
+00029a70: 2020 2020 207c 2020 3320 2020 2020 2020       |  3       
+00029a80: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00029a90: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+00029aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00029ab0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00029ac0: 2020 2020 2222 220a 2020 2020 6120 3d20      """.    a = 
+00029ad0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2861  _to_col_if_str(a
+00029ae0: 7272 6179 2c20 2261 7272 6179 5f70 7265  rray, "array_pre
+00029af0: 7065 6e64 2229 0a20 2020 2065 203d 205f  pend").    e = _
+00029b00: 746f 5f63 6f6c 5f69 665f 7374 7228 656c  to_col_if_str(el
+00029b10: 656d 656e 742c 2022 6172 7261 795f 7072  ement, "array_pr
+00029b20: 6570 656e 6422 290a 2020 2020 7265 7475  epend").    retu
+00029b30: 726e 2062 7569 6c74 696e 2822 6172 7261  rn builtin("arra
+00029b40: 795f 7072 6570 656e 6422 2928 612c 2065  y_prepend")(a, e
+00029b50: 290a 0a0a 6465 6620 6172 7261 795f 7369  )...def array_si
+00029b60: 7a65 2861 7272 6179 3a20 436f 6c75 6d6e  ze(array: Column
+00029b70: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00029b80: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+00029b90: 7320 7468 6520 7369 7a65 206f 6620 7468  s the size of th
+00029ba0: 6520 696e 7075 7420 4152 5241 592e 0a0a  e input ARRAY...
+00029bb0: 2020 2020 4966 2074 6865 2073 7065 6369      If the speci
+00029bc0: 6669 6564 2063 6f6c 756d 6e20 636f 6e74  fied column cont
+00029bd0: 6169 6e73 2061 2056 4152 4941 4e54 2076  ains a VARIANT v
+00029be0: 616c 7565 2074 6861 7420 636f 6e74 6169  alue that contai
+00029bf0: 6e73 2061 6e20 4152 5241 592c 2074 6865  ns an ARRAY, the
+00029c00: 2073 697a 6520 6f66 2074 6865 2041 5252   size of the ARR
+00029c10: 4159 0a20 2020 2069 7320 7265 7475 726e  AY.    is return
+00029c20: 6564 3b20 6f74 6865 7277 6973 652c 204e  ed; otherwise, N
+00029c30: 554c 4c20 6973 2072 6574 7572 6e65 6420  ULL is returned 
+00029c40: 6966 2074 6865 2076 616c 7565 2069 7320  if the value is 
+00029c50: 6e6f 7420 616e 2041 5252 4159 2e0a 0a20  not an ARRAY... 
+00029c60: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+00029c70: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00029c80: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00029c90: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
+00029ca0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00029cb0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00029cc0: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
+00029cd0: 2032 2c20 335d 295d 290a 2020 2020 2020   2, 3])]).      
+00029ce0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00029cf0: 6172 7261 795f 7369 7a65 2822 6122 292e  array_size("a").
+00029d00: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00029d10: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00029d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+00029d30: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+00029d40: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00029d50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+00029d60: 3320 2020 2020 2020 2020 7c0a 2020 2020  3         |.    
+00029d70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00029d80: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00029d90: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00029da0: 2061 203d 205f 746f 5f63 6f6c 5f69 665f   a = _to_col_if_
+00029db0: 7374 7228 6172 7261 792c 2022 6172 7261  str(array, "arra
+00029dc0: 795f 7369 7a65 2229 0a20 2020 2072 6574  y_size").    ret
+00029dd0: 7572 6e20 6275 696c 7469 6e28 2261 7272  urn builtin("arr
+00029de0: 6179 5f73 697a 6522 2928 6129 0a0a 0a64  ay_size")(a)...d
+00029df0: 6566 2061 7272 6179 5f73 6c69 6365 2861  ef array_slice(a
+00029e00: 7272 6179 3a20 436f 6c75 6d6e 4f72 4e61  rray: ColumnOrNa
+00029e10: 6d65 2c20 6672 6f6d 5f3a 2043 6f6c 756d  me, from_: Colum
+00029e20: 6e4f 724e 616d 652c 2074 6f3a 2043 6f6c  nOrName, to: Col
+00029e30: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00029e40: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+00029e50: 7572 6e73 2061 6e20 4152 5241 5920 636f  urns an ARRAY co
+00029e60: 6e73 7472 7563 7465 6420 6672 6f6d 2061  nstructed from a
+00029e70: 2073 7065 6369 6669 6564 2073 7562 7365   specified subse
+00029e80: 7420 6f66 2065 6c65 6d65 6e74 7320 6f66  t of elements of
+00029e90: 2074 6865 2069 6e70 7574 2041 5252 4159   the input ARRAY
+00029ea0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+00029eb0: 2020 2020 2061 7272 6179 3a20 436f 6c75       array: Colu
+00029ec0: 6d6e 2063 6f6e 7461 696e 696e 6720 7468  mn containing th
+00029ed0: 6520 736f 7572 6365 2041 5252 4159 2e0a  e source ARRAY..
+00029ee0: 2020 2020 2020 2020 6672 6f6d 5f3a 2043          from_: C
+00029ef0: 6f6c 756d 6e20 636f 6e74 6169 6e69 6e67  olumn containing
+00029f00: 2061 2070 6f73 6974 696f 6e20 696e 2074   a position in t
+00029f10: 6865 2073 6f75 7263 6520 4152 5241 592e  he source ARRAY.
+00029f20: 2054 6865 2070 6f73 6974 696f 6e20 6f66   The position of
+00029f30: 2074 6865 2066 6972 7374 0a20 2020 2020   the first.     
+00029f40: 2020 2020 2020 2065 6c65 6d65 6e74 2069         element i
+00029f50: 7320 302e 2045 6c65 6d65 6e74 7320 6672  s 0. Elements fr
+00029f60: 6f6d 2070 6f73 6974 696f 6e73 206c 6573  om positions les
+00029f70: 7320 7468 616e 2074 6869 7320 7061 7261  s than this para
+00029f80: 6d65 7465 7220 6172 650a 2020 2020 2020  meter are.      
+00029f90: 2020 2020 2020 6e6f 7420 696e 636c 7564        not includ
+00029fa0: 6564 2069 6e20 7468 6520 7265 7375 6c74  ed in the result
+00029fb0: 696e 6720 4152 5241 592e 0a20 2020 2020  ing ARRAY..     
+00029fc0: 2020 2074 6f3a 2043 6f6c 756d 6e20 636f     to: Column co
+00029fd0: 6e74 6169 6e69 6e67 2061 2070 6f73 6974  ntaining a posit
+00029fe0: 696f 6e20 696e 2074 6865 2073 6f75 7263  ion in the sourc
+00029ff0: 6520 4152 5241 592e 2045 6c65 6d65 6e74  e ARRAY. Element
+0002a000: 7320 6672 6f6d 2070 6f73 6974 696f 6e73  s from positions
+0002a010: 2065 7175 616c 2074 6f0a 2020 2020 2020   equal to.      
+0002a020: 2020 2020 2020 6f72 2067 7265 6174 6572        or greater
+0002a030: 2074 6861 6e20 7468 6973 2070 6172 616d   than this param
+0002a040: 6574 6572 2061 7265 206e 6f74 2069 6e63  eter are not inc
+0002a050: 6c75 6465 6420 696e 2074 6865 2072 6573  luded in the res
+0002a060: 756c 7469 6e67 2061 7272 6179 2e0a 0a20  ulting array... 
+0002a070: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0002a080: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0002a090: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0002a0a0: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
+0002a0b0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002a0c0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0002a0d0: 6672 616d 6528 5b52 6f77 2861 3d5b 312c  frame([Row(a=[1,
+0002a0e0: 2032 2c20 332c 2034 2c20 355d 295d 290a   2, 3, 4, 5])]).
+0002a0f0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002a100: 656c 6563 7428 6172 7261 795f 736c 6963  elect(array_slic
+0002a110: 6528 2261 222c 206c 6974 2831 292c 206c  e("a", lit(1), l
+0002a120: 6974 2833 2929 2e61 6c69 6173 2822 7265  it(3)).alias("re
+0002a130: 7375 6c74 2229 292e 7368 6f77 2829 0a20  sult")).show(). 
+0002a140: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002a150: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0002a160: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+0002a170: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0002a180: 2020 2020 2020 7c5b 2020 2020 2020 2020        |[        
+0002a190: 207c 0a20 2020 2020 2020 207c 2020 322c   |.        |  2,
+0002a1a0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002a1b0: 7c20 2033 2020 2020 2020 207c 0a20 2020  |  3       |.   
+0002a1c0: 2020 2020 207c 5d20 2020 2020 2020 2020       |]         
+0002a1d0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002a1e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0002a1f0: 424c 414e 4b4c 494e 453e 0a20 2020 2022  BLANKLINE>.    "
+0002a200: 2222 0a20 2020 2061 203d 205f 746f 5f63  "".    a = _to_c
+0002a210: 6f6c 5f69 665f 7374 7228 6172 7261 792c  ol_if_str(array,
+0002a220: 2022 6172 7261 795f 736c 6963 6522 290a   "array_slice").
+0002a230: 2020 2020 6620 3d20 5f74 6f5f 636f 6c5f      f = _to_col_
+0002a240: 6966 5f73 7472 2866 726f 6d5f 2c20 2261  if_str(from_, "a
+0002a250: 7272 6179 5f73 6c69 6365 2229 0a20 2020  rray_slice").   
+0002a260: 2074 203d 205f 746f 5f63 6f6c 5f69 665f   t = _to_col_if_
+0002a270: 7374 7228 746f 2c20 2261 7272 6179 5f73  str(to, "array_s
+0002a280: 6c69 6365 2229 0a20 2020 2072 6574 7572  lice").    retur
+0002a290: 6e20 6275 696c 7469 6e28 2261 7272 6179  n builtin("array
+0002a2a0: 5f73 6c69 6365 2229 2861 2c20 662c 2074  _slice")(a, f, t
+0002a2b0: 290a 0a0a 6465 6620 6172 7261 795f 746f  )...def array_to
+0002a2c0: 5f73 7472 696e 6728 6172 7261 793a 2043  _string(array: C
+0002a2d0: 6f6c 756d 6e4f 724e 616d 652c 2073 6570  olumnOrName, sep
+0002a2e0: 6172 6174 6f72 3a20 436f 6c75 6d6e 4f72  arator: ColumnOr
+0002a2f0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002a300: 0a20 2020 2022 2222 5265 7475 726e 7320  .    """Returns 
+0002a310: 616e 2069 6e70 7574 2041 5252 4159 2063  an input ARRAY c
+0002a320: 6f6e 7665 7274 6564 2074 6f20 6120 7374  onverted to a st
+0002a330: 7269 6e67 2062 7920 6361 7374 696e 6720  ring by casting 
+0002a340: 616c 6c20 7661 6c75 6573 2074 6f20 7374  all values to st
+0002a350: 7269 6e67 7320 2875 7369 6e67 0a20 2020  rings (using.   
+0002a360: 2054 4f5f 5641 5243 4841 5229 2061 6e64   TO_VARCHAR) and
+0002a370: 2063 6f6e 6361 7465 6e61 7469 6e67 2074   concatenating t
+0002a380: 6865 6d20 2875 7369 6e67 2074 6865 2073  hem (using the s
+0002a390: 7472 696e 6720 6672 6f6d 2074 6865 2073  tring from the s
+0002a3a0: 6563 6f6e 6420 6172 6775 6d65 6e74 2074  econd argument t
+0002a3b0: 6f20 7365 7061 7261 7465 0a20 2020 2074  o separate.    t
+0002a3c0: 6865 2065 6c65 6d65 6e74 7329 2e0a 0a20  he elements)... 
+0002a3d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0002a3e0: 2061 7272 6179 3a20 436f 6c75 6d6e 2063   array: Column c
+0002a3f0: 6f6e 7461 696e 696e 6720 7468 6520 4152  ontaining the AR
+0002a400: 5241 5920 6f66 2065 6c65 6d65 6e74 7320  RAY of elements 
+0002a410: 746f 2063 6f6e 7665 7274 2074 6f20 6120  to convert to a 
+0002a420: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
+0002a430: 7365 7061 7261 746f 723a 2043 6f6c 756d  separator: Colum
+0002a440: 6e20 636f 6e74 6169 6e69 6e67 2074 6865  n containing the
+0002a450: 2073 7472 696e 6720 746f 2070 7574 2062   string to put b
+0002a460: 6574 7765 656e 2065 6163 6820 656c 656d  etween each elem
+0002a470: 656e 7420 2865 2e67 2e20 6120 7370 6163  ent (e.g. a spac
+0002a480: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
+0002a490: 6f6d 6d61 2c20 6f72 206f 7468 6572 2068  omma, or other h
+0002a4a0: 756d 616e 2d72 6561 6461 626c 6520 7365  uman-readable se
+0002a4b0: 7061 7261 746f 7229 2e0a 0a20 2020 2045  parator)...    E
+0002a4c0: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002a4d0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0002a4e0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
+0002a4f0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
+0002a500: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002a510: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0002a520: 6528 5b52 6f77 2861 3d5b 312c 2054 7275  e([Row(a=[1, Tru
+0002a530: 652c 2022 7322 5d29 5d29 0a20 2020 2020  e, "s"])]).     
+0002a540: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0002a550: 2861 7272 6179 5f74 6f5f 7374 7269 6e67  (array_to_string
+0002a560: 2822 6122 2c20 6c69 7428 222c 2229 292e  ("a", lit(",")).
+0002a570: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0002a580: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0002a590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002a5a0: 2020 2020 207c 2252 4553 554c 5422 2020       |"RESULT"  
+0002a5b0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002a5c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0002a5d0: 312c 7472 7565 2c73 2020 7c0a 2020 2020  1,true,s  |.    
+0002a5e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002a5f0: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0002a600: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0002a610: 2061 203d 205f 746f 5f63 6f6c 5f69 665f   a = _to_col_if_
+0002a620: 7374 7228 6172 7261 792c 2022 6172 7261  str(array, "arra
+0002a630: 795f 746f 5f73 7472 696e 6722 290a 2020  y_to_string").  
+0002a640: 2020 7320 3d20 5f74 6f5f 636f 6c5f 6966    s = _to_col_if
+0002a650: 5f73 7472 2873 6570 6172 6174 6f72 2c20  _str(separator, 
+0002a660: 2261 7272 6179 5f74 6f5f 7374 7269 6e67  "array_to_string
+0002a670: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0002a680: 696c 7469 6e28 2261 7272 6179 5f74 6f5f  iltin("array_to_
+0002a690: 7374 7269 6e67 2229 2861 2c20 7329 0a0a  string")(a, s)..
+0002a6a0: 0a64 6566 2061 7272 6179 5f75 6e69 7175  .def array_uniqu
+0002a6b0: 655f 6167 6728 636f 6c3a 2043 6f6c 756d  e_agg(col: Colum
+0002a6c0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002a6d0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002a6e0: 6e73 2061 2043 6f6c 756d 6e20 636f 6e74  ns a Column cont
+0002a6f0: 6169 6e69 6e67 2074 6865 2064 6973 7469  aining the disti
+0002a700: 6e63 7420 7661 6c75 6573 2069 6e20 7468  nct values in th
+0002a710: 6520 7370 6563 6966 6965 6420 636f 6c75  e specified colu
+0002a720: 6d6e 2063 6f6c 2e0a 2020 2020 5468 6520  mn col..    The 
+0002a730: 7661 6c75 6573 2069 6e20 7468 6520 436f  values in the Co
+0002a740: 6c75 6d6e 2061 7265 2069 6e20 6e6f 2070  lumn are in no p
+0002a750: 6172 7469 6375 6c61 7220 6f72 6465 722c  articular order,
+0002a760: 2061 6e64 2074 6865 206f 7264 6572 2069   and the order i
+0002a770: 7320 6e6f 7420 6465 7465 726d 696e 6973  s not determinis
+0002a780: 7469 632e 0a20 2020 2054 6865 2066 756e  tic..    The fun
+0002a790: 6374 696f 6e20 6967 6e6f 7265 7320 4e55  ction ignores NU
+0002a7a0: 4c4c 2076 616c 7565 7320 696e 2063 6f6c  LL values in col
+0002a7b0: 2e0a 2020 2020 4966 2063 6f6c 2063 6f6e  ..    If col con
+0002a7c0: 7461 696e 7320 6f6e 6c79 204e 554c 4c20  tains only NULL 
+0002a7d0: 7661 6c75 6573 206f 7220 636f 6c20 6973  values or col is
+0002a7e0: 2065 6d70 7479 2c20 7468 6520 6675 6e63   empty, the func
+0002a7f0: 7469 6f6e 2072 6574 7572 6e73 2061 6e20  tion returns an 
+0002a800: 656d 7074 7920 436f 6c75 6d6e 2e0a 0a20  empty Column... 
+0002a810: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0002a820: 2063 6f6c 3a20 4120 3a63 6c61 7373 3a60   col: A :class:`
+0002a830: 436f 6c75 6d6e 6020 6f62 6a65 6374 206f  Column` object o
+0002a840: 7220 636f 6c75 6d6e 206e 616d 6520 7468  r column name th
+0002a850: 6174 2064 6574 6572 6d69 6e65 7320 7468  at determines th
+0002a860: 6520 7661 6c75 6573 2e0a 0a20 2020 2045  e values...    E
+0002a870: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002a880: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002a890: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0002a8a0: 6d65 285b 5b35 5d2c 205b 325d 2c20 5b31  me([[5], [2], [1
+0002a8b0: 5d2c 205b 325d 2c20 5b31 5d5d 2c20 7363  ], [2], [1]], sc
+0002a8c0: 6865 6d61 3d5b 2261 225d 290a 2020 2020  hema=["a"]).    
+0002a8d0: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002a8e0: 7428 6172 7261 795f 756e 6971 7565 5f61  t(array_unique_a
+0002a8f0: 6767 2822 6122 292e 616c 6961 7328 2272  gg("a").alias("r
+0002a900: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0002a910: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002a920: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002a930: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0002a940: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002a950: 2020 2020 2020 207c 5b20 2020 2020 2020         |[       
+0002a960: 2020 7c0a 2020 2020 2020 2020 7c20 2035    |.        |  5
+0002a970: 2c20 2020 2020 207c 0a20 2020 2020 2020  ,      |.       
+0002a980: 207c 2020 322c 2020 2020 2020 7c0a 2020   |  2,      |.  
+0002a990: 2020 2020 2020 7c20 2031 2020 2020 2020        |  1      
+0002a9a0: 207c 0a20 2020 2020 2020 207c 5d20 2020   |.        |]   
+0002a9b0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002a9c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002a9d0: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0002a9e0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0002a9f0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002aa00: 636f 6c2c 2022 6172 7261 795f 756e 6971  col, "array_uniq
+0002aa10: 7565 5f61 6767 2229 0a20 2020 2072 6574  ue_agg").    ret
+0002aa20: 7572 6e20 5f63 616c 6c5f 6675 6e63 7469  urn _call_functi
+0002aa30: 6f6e 2822 6172 7261 795f 756e 6971 7565  on("array_unique
+0002aa40: 5f61 6767 222c 2054 7275 652c 2063 290a  _agg", True, c).
+0002aa50: 0a0a 6465 6620 6f62 6a65 6374 5f61 6767  ..def object_agg
+0002aa60: 286b 6579 3a20 436f 6c75 6d6e 4f72 4e61  (key: ColumnOrNa
+0002aa70: 6d65 2c20 7661 6c75 653a 2043 6f6c 756d  me, value: Colum
+0002aa80: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002aa90: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002aaa0: 6e73 206f 6e65 204f 424a 4543 5420 7065  ns one OBJECT pe
+0002aab0: 7220 6772 6f75 702e 2046 6f72 2065 6163  r group. For eac
+0002aac0: 6820 6b65 792d 7661 6c75 6520 696e 7075  h key-value inpu
+0002aad0: 7420 7061 6972 2c20 7768 6572 6520 6b65  t pair, where ke
+0002aae0: 7920 6d75 7374 2062 6520 6120 5641 5243  y must be a VARC
+0002aaf0: 4841 520a 2020 2020 616e 6420 7661 6c75  HAR.    and valu
+0002ab00: 6520 6d75 7374 2062 6520 6120 5641 5249  e must be a VARI
+0002ab10: 414e 542c 2074 6865 2072 6573 756c 7469  ANT, the resulti
+0002ab20: 6e67 204f 424a 4543 5420 636f 6e74 6169  ng OBJECT contai
+0002ab30: 6e73 2061 206b 6579 2d76 616c 7565 2066  ns a key-value f
+0002ab40: 6965 6c64 2e0a 0a20 2020 2045 7861 6d70  ield...    Examp
+0002ab50: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+0002ab60: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+0002ab70: 2e73 6e6f 7770 6172 6b2e 7479 7065 7320  .snowpark.types 
+0002ab80: 696d 706f 7274 2053 7472 7563 7454 7970  import StructTyp
+0002ab90: 652c 2053 7472 7563 7446 6965 6c64 2c20  e, StructField, 
+0002aba0: 5661 7269 616e 7454 7970 652c 2053 7472  VariantType, Str
+0002abb0: 696e 6754 7970 650a 2020 2020 2020 2020  ingType.        
+0002abc0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002abd0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0002abe0: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+0002abf0: 2020 205b 5b22 6e61 6d65 222c 2022 4a6f     [["name", "Jo
+0002ac00: 6522 5d2c 205b 227a 6970 222c 2022 3938  e"], ["zip", "98
+0002ac10: 3030 3422 5d5d 2c0a 2020 2020 2020 2020  004"]],.        
+0002ac20: 2e2e 2e20 2020 2020 7363 6865 6d61 3d53  ...     schema=S
+0002ac30: 7472 7563 7454 7970 6528 5b53 7472 7563  tructType([Struc
+0002ac40: 7446 6965 6c64 2822 6b22 2c20 5374 7269  tField("k", Stri
+0002ac50: 6e67 5479 7065 2829 292c 2053 7472 7563  ngType()), Struc
+0002ac60: 7446 6965 6c64 2822 7622 2c20 5661 7269  tField("v", Vari
+0002ac70: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
+0002ac80: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+0002ac90: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0002aca0: 286f 626a 6563 745f 6167 6728 636f 6c28  (object_agg(col(
+0002acb0: 226b 2229 2c20 636f 6c28 2276 2229 292e  "k"), col("v")).
+0002acc0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0002acd0: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0002ace0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002acf0: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002ad00: 4553 554c 5422 2020 2020 2020 2020 2020  ESULT"          
+0002ad10: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002ad20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002ad30: 2020 2020 2020 207c 7b20 2020 2020 2020         |{       
+0002ad40: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002ad50: 2020 2020 7c20 2022 6e61 6d65 223a 2022      |  "name": "
+0002ad60: 4a6f 6522 2c20 207c 0a20 2020 2020 2020  Joe",  |.       
+0002ad70: 207c 2020 227a 6970 223a 2022 3938 3030   |  "zip": "9800
+0002ad80: 3422 2020 7c0a 2020 2020 2020 2020 7c7d  4"  |.        |}
+0002ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ada0: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0002adb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002adc0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0002add0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+0002ade0: 6b20 3d20 5f74 6f5f 636f 6c5f 6966 5f73  k = _to_col_if_s
+0002adf0: 7472 286b 6579 2c20 226f 626a 6563 745f  tr(key, "object_
+0002ae00: 6167 6722 290a 2020 2020 7620 3d20 5f74  agg").    v = _t
+0002ae10: 6f5f 636f 6c5f 6966 5f73 7472 2876 616c  o_col_if_str(val
+0002ae20: 7565 2c20 226f 626a 6563 745f 6167 6722  ue, "object_agg"
+0002ae30: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002ae40: 6c74 696e 2822 6f62 6a65 6374 5f61 6767  ltin("object_agg
+0002ae50: 2229 286b 2c20 7629 0a0a 0a64 6566 206f  ")(k, v)...def o
+0002ae60: 626a 6563 745f 636f 6e73 7472 7563 7428  bject_construct(
+0002ae70: 2a6b 6579 5f76 616c 7565 733a 2043 6f6c  *key_values: Col
+0002ae80: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0002ae90: 6c75 6d6e 3a0a 2020 2020 2222 2252 6574  lumn:.    """Ret
+0002aea0: 7572 6e73 2061 6e20 4f42 4a45 4354 2063  urns an OBJECT c
+0002aeb0: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
+0002aec0: 7468 6520 6172 6775 6d65 6e74 732e 0a0a  the arguments...
+0002aed0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002aee0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002aef0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002af00: 726b 2e74 7970 6573 2069 6d70 6f72 7420  rk.types import 
+0002af10: 5374 7275 6374 5479 7065 2c20 5374 7275  StructType, Stru
+0002af20: 6374 4669 656c 642c 2056 6172 6961 6e74  ctField, Variant
+0002af30: 5479 7065 2c20 5374 7269 6e67 5479 7065  Type, StringType
+0002af40: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002af50: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+0002af60: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
+0002af70: 2020 2020 2e2e 2e20 2020 2020 5b5b 226e      ...     [["n
+0002af80: 616d 6522 2c20 224a 6f65 225d 2c20 5b22  ame", "Joe"], ["
+0002af90: 7a69 7022 2c20 2239 3830 3034 225d 2c5b  zip", "98004"],[
+0002afa0: 2261 6765 222c 204e 6f6e 655d 2c20 5b4e  "age", None], [N
+0002afb0: 6f6e 652c 2022 7661 6c75 6522 5d5d 2c0a  one, "value"]],.
+0002afc0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0002afd0: 7363 6865 6d61 3d53 7472 7563 7454 7970  schema=StructTyp
+0002afe0: 6528 5b53 7472 7563 7446 6965 6c64 2822  e([StructField("
+0002aff0: 6b22 2c20 5374 7269 6e67 5479 7065 2829  k", StringType()
+0002b000: 292c 2053 7472 7563 7446 6965 6c64 2822  ), StructField("
+0002b010: 7622 2c20 5661 7269 616e 7454 7970 6528  v", VariantType(
+0002b020: 2929 5d29 0a20 2020 2020 2020 202e 2e2e  ))]).        ...
+0002b030: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+0002b040: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
+0002b050: 636f 6e73 7472 7563 7428 636f 6c28 226b  construct(col("k
+0002b060: 2229 2c20 636f 6c28 2276 2229 292e 616c  "), col("v")).al
+0002b070: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+0002b080: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0002b090: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002b0a0: 2d2d 0a20 2020 2020 2020 207c 2252 4553  --.        |"RES
+0002b0b0: 554c 5422 2020 2020 2020 2020 2020 7c0a  ULT"          |.
+0002b0c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002b0d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002b0e0: 2020 2020 207c 7b20 2020 2020 2020 2020       |{         
+0002b0f0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0002b100: 2020 7c20 2022 6e61 6d65 223a 2022 4a6f    |  "name": "Jo
+0002b110: 6522 2020 207c 0a20 2020 2020 2020 207c  e"   |.        |
+0002b120: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+0002b130: 2020 7c0a 2020 2020 2020 2020 7c7b 2020    |.        |{  
+0002b140: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+0002b150: 0a20 2020 2020 2020 207c 2020 227a 6970  .        |  "zip
+0002b160: 223a 2022 3938 3030 3422 2020 7c0a 2020  ": "98004"  |.  
+0002b170: 2020 2020 2020 7c7d 2020 2020 2020 2020        |}        
+0002b180: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002b190: 2020 207c 7b7d 2020 2020 2020 2020 2020     |{}          
+0002b1a0: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0002b1b0: 7c7b 7d20 2020 2020 2020 2020 2020 2020  |{}             
+0002b1c0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+0002b1d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002b1e0: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0002b1f0: 4c49 4e45 3e0a 2020 2020 2222 220a 2020  LINE>.    """.  
+0002b200: 2020 6b76 7320 3d20 5b5f 746f 5f63 6f6c    kvs = [_to_col
+0002b210: 5f69 665f 7374 7228 6b76 2c20 226f 626a  _if_str(kv, "obj
+0002b220: 6563 745f 636f 6e73 7472 7563 7422 2920  ect_construct") 
+0002b230: 666f 7220 6b76 2069 6e20 6b65 795f 7661  for kv in key_va
+0002b240: 6c75 6573 5d0a 2020 2020 7265 7475 726e  lues].    return
+0002b250: 2062 7569 6c74 696e 2822 6f62 6a65 6374   builtin("object
+0002b260: 5f63 6f6e 7374 7275 6374 2229 282a 6b76  _construct")(*kv
+0002b270: 7329 0a0a 0a64 6566 206f 626a 6563 745f  s)...def object_
+0002b280: 636f 6e73 7472 7563 745f 6b65 6570 5f6e  construct_keep_n
+0002b290: 756c 6c28 2a6b 6579 5f76 616c 7565 733a  ull(*key_values:
+0002b2a0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0002b2b0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002b2c0: 2252 6574 7572 6e73 2061 6e20 6f62 6a65  "Returns an obje
+0002b2d0: 6374 2063 6f6e 7461 696e 696e 6720 7468  ct containing th
+0002b2e0: 6520 636f 6e74 656e 7473 206f 6620 7468  e contents of th
+0002b2f0: 6520 696e 7075 7420 2869 2e65 2e20 736f  e input (i.e. so
+0002b300: 7572 6365 2920 6f62 6a65 6374 2077 6974  urce) object wit
+0002b310: 6820 6f6e 6520 6f72 206d 6f72 650a 2020  h one or more.  
+0002b320: 2020 6b65 7973 2072 656d 6f76 6564 2e0a    keys removed..
+0002b330: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0002b340: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0002b350: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0002b360: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0002b370: 2053 7472 7563 7454 7970 652c 2053 7472   StructType, Str
+0002b380: 7563 7446 6965 6c64 2c20 5661 7269 616e  uctField, Varian
+0002b390: 7454 7970 652c 2053 7472 696e 6754 7970  tType, StringTyp
+0002b3a0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002b3b0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002b3c0: 655f 6461 7461 6672 616d 6528 0a20 2020  e_dataframe(.   
+0002b3d0: 2020 2020 202e 2e2e 2020 2020 205b 5b22       ...     [["
+0002b3e0: 6b65 795f 3122 2c20 226f 6e65 225d 2c20  key_1", "one"], 
+0002b3f0: 5b22 6b65 795f 3222 2c20 4e6f 6e65 5d5d  ["key_2", None]]
+0002b400: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0002b410: 2020 7363 6865 6d61 3d53 7472 7563 7454    schema=StructT
+0002b420: 7970 6528 5b53 7472 7563 7446 6965 6c64  ype([StructField
+0002b430: 2822 6b22 2c20 5374 7269 6e67 5479 7065  ("k", StringType
+0002b440: 2829 292c 2053 7472 7563 7446 6965 6c64  ()), StructField
+0002b450: 2822 7622 2c20 5661 7269 616e 7454 7970  ("v", VariantTyp
+0002b460: 6528 2929 5d29 0a20 2020 2020 2020 202e  e())]).        .
+0002b470: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+0002b480: 2064 662e 7365 6c65 6374 286f 626a 6563   df.select(objec
+0002b490: 745f 636f 6e73 7472 7563 745f 6b65 6570  t_construct_keep
+0002b4a0: 5f6e 756c 6c28 636f 6c28 226b 2229 2c20  _null(col("k"), 
+0002b4b0: 636f 6c28 2276 2229 292e 616c 6961 7328  col("v")).alias(
+0002b4c0: 2272 6573 756c 7422 2929 2e73 686f 7728  "result")).show(
+0002b4d0: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+0002b4e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002b4f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0002b500: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002b510: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002b520: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002b530: 207c 7b20 2020 2020 2020 2020 2020 2020   |{             
+0002b540: 2020 2020 7c0a 2020 2020 2020 2020 7c20      |.        | 
+0002b550: 2022 6b65 795f 3122 3a20 226f 6e65 2220   "key_1": "one" 
+0002b560: 207c 0a20 2020 2020 2020 207c 7d20 2020   |.        |}   
+0002b570: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+0002b580: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+0002b590: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002b5a0: 2020 2020 207c 2020 226b 6579 5f32 223a       |  "key_2":
+0002b5b0: 206e 756c 6c20 2020 7c0a 2020 2020 2020   null   |.      
+0002b5c0: 2020 7c7d 2020 2020 2020 2020 2020 2020    |}            
+0002b5d0: 2020 2020 207c 0a20 2020 2020 2020 202d       |.        -
+0002b5e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002b5f0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0002b600: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0002b610: 2020 2020 6b76 7320 3d20 5b5f 746f 5f63      kvs = [_to_c
+0002b620: 6f6c 5f69 665f 7374 7228 6b76 2c20 226f  ol_if_str(kv, "o
+0002b630: 626a 6563 745f 636f 6e73 7472 7563 745f  bject_construct_
+0002b640: 6b65 6570 5f6e 756c 6c22 2920 666f 7220  keep_null") for 
+0002b650: 6b76 2069 6e20 6b65 795f 7661 6c75 6573  kv in key_values
+0002b660: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
+0002b670: 6c74 696e 2822 6f62 6a65 6374 5f63 6f6e  ltin("object_con
+0002b680: 7374 7275 6374 5f6b 6565 705f 6e75 6c6c  struct_keep_null
+0002b690: 2229 282a 6b76 7329 0a0a 0a64 6566 206f  ")(*kvs)...def o
+0002b6a0: 626a 6563 745f 6465 6c65 7465 286f 626a  bject_delete(obj
+0002b6b0: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2c20  : ColumnOrName, 
+0002b6c0: 6b65 7931 3a20 436f 6c75 6d6e 4f72 4e61  key1: ColumnOrNa
+0002b6d0: 6d65 2c20 2a6b 6579 733a 2043 6f6c 756d  me, *keys: Colum
+0002b6e0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002b6f0: 6d6e 3a0a 2020 2020 2222 2252 6574 7572  mn:.    """Retur
+0002b700: 6e73 2061 6e20 6f62 6a65 6374 2063 6f6e  ns an object con
+0002b710: 7369 7374 696e 6720 6f66 2074 6865 2069  sisting of the i
+0002b720: 6e70 7574 206f 626a 6563 7420 7769 7468  nput object with
+0002b730: 206f 6e65 206f 7220 6d6f 7265 206b 6579   one or more key
+0002b740: 7320 7265 6d6f 7665 642e 0a20 2020 2054  s removed..    T
+0002b750: 6865 2069 6e70 7574 206b 6579 206d 7573  he input key mus
+0002b760: 7420 6e6f 7420 6578 6973 7420 696e 2074  t not exist in t
+0002b770: 6865 206f 626a 6563 742e 0a0a 2020 2020  he object...    
+0002b780: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0002b790: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0002b7a0: 666c 616b 652e 736e 6f77 7061 726b 2e66  flake.snowpark.f
+0002b7b0: 756e 6374 696f 6e73 2069 6d70 6f72 7420  unctions import 
+0002b7c0: 6c69 740a 2020 2020 2020 2020 3e3e 3e20  lit.        >>> 
+0002b7d0: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+0002b7e0: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+0002b7f0: 2020 2273 656c 6563 7420 6f62 6a65 6374    "select object
+0002b800: 5f63 6f6e 7374 7275 6374 2861 2c62 2c63  _construct(a,b,c
+0002b810: 2c64 2c65 2c66 2920 6173 206f 626a 2066  ,d,e,f) as obj f
+0002b820: 726f 6d20 220a 2020 2020 2020 2020 2e2e  rom ".        ..
+0002b830: 2e20 2020 2020 2276 616c 7565 7328 2761  .     "values('a
+0002b840: 6765 272c 2032 312c 2027 7a69 7027 2c20  ge', 21, 'zip', 
+0002b850: 3231 3032 312c 2027 6e61 6d65 272c 2027  21021, 'name', '
+0002b860: 4a6f 6527 292c 220a 2020 2020 2020 2020  Joe'),".        
+0002b870: 2e2e 2e20 2020 2020 2228 2761 6765 272c  ...     "('age',
+0002b880: 2032 362c 2027 7a69 7027 2c20 3934 3032   26, 'zip', 9402
+0002b890: 312c 2027 6e61 6d65 272c 2027 4a61 7927  1, 'name', 'Jay'
+0002b8a0: 2920 6173 2054 2861 2c62 2c63 2c64 2c65  ) as T(a,b,c,d,e
+0002b8b0: 2c66 2922 0a20 2020 2020 2020 202e 2e2e  ,f)".        ...
+0002b8c0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+0002b8d0: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
+0002b8e0: 6465 6c65 7465 2863 6f6c 2822 6f62 6a22  delete(col("obj"
+0002b8f0: 292c 206c 6974 2822 6167 6522 2929 2e61  ), lit("age")).a
+0002b900: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0002b910: 7368 6f77 2829 0a20 2020 2020 2020 202d  show().        -
+0002b920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002b930: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0002b940: 5355 4c54 2220 2020 2020 2020 2020 207c  SULT"          |
+0002b950: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002b960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002b970: 2020 2020 2020 7c7b 2020 2020 2020 2020        |{        
+0002b980: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002b990: 2020 207c 2020 226e 616d 6522 3a20 224a     |  "name": "J
+0002b9a0: 6f65 222c 2020 7c0a 2020 2020 2020 2020  oe",  |.        
+0002b9b0: 7c20 2022 7a69 7022 3a20 3231 3032 3120  |  "zip": 21021 
+0002b9c0: 2020 207c 0a20 2020 2020 2020 207c 7d20     |.        |} 
+0002b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b9e0: 7c0a 2020 2020 2020 2020 7c7b 2020 2020  |.        |{    
+0002b9f0: 2020 2020 2020 2020 2020 2020 207c 0a20               |. 
+0002ba00: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
+0002ba10: 3a20 224a 6179 222c 2020 7c0a 2020 2020  : "Jay",  |.    
+0002ba20: 2020 2020 7c20 2022 7a69 7022 3a20 3934      |  "zip": 94
+0002ba30: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
+0002ba40: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
+0002ba50: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002ba60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002ba70: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0002ba80: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0002ba90: 2020 206f 203d 205f 746f 5f63 6f6c 5f69     o = _to_col_i
+0002baa0: 665f 7374 7228 6f62 6a2c 2022 6f62 6a65  f_str(obj, "obje
+0002bab0: 6374 5f64 656c 6574 6522 290a 2020 2020  ct_delete").    
+0002bac0: 6b31 203d 205f 746f 5f63 6f6c 5f69 665f  k1 = _to_col_if_
+0002bad0: 7374 7228 6b65 7931 2c20 226f 626a 6563  str(key1, "objec
+0002bae0: 745f 6465 6c65 7465 2229 0a20 2020 206b  t_delete").    k
+0002baf0: 7320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  s = [_to_col_if_
+0002bb00: 7374 7228 6b2c 2022 6f62 6a65 6374 5f64  str(k, "object_d
+0002bb10: 656c 6574 6522 2920 666f 7220 6b20 696e  elete") for k in
+0002bb20: 206b 6579 735d 0a20 2020 2072 6574 7572   keys].    retur
+0002bb30: 6e20 6275 696c 7469 6e28 226f 626a 6563  n builtin("objec
+0002bb40: 745f 6465 6c65 7465 2229 286f 2c20 6b31  t_delete")(o, k1
+0002bb50: 2c20 2a6b 7329 0a0a 0a64 6566 206f 626a  , *ks)...def obj
+0002bb60: 6563 745f 696e 7365 7274 280a 2020 2020  ect_insert(.    
+0002bb70: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
+0002bb80: 652c 0a20 2020 206b 6579 3a20 436f 6c75  e,.    key: Colu
+0002bb90: 6d6e 4f72 4e61 6d65 2c0a 2020 2020 7661  mnOrName,.    va
+0002bba0: 6c75 653a 2043 6f6c 756d 6e4f 724e 616d  lue: ColumnOrNam
+0002bbb0: 652c 0a20 2020 2075 7064 6174 655f 666c  e,.    update_fl
+0002bbc0: 6167 3a20 4f70 7469 6f6e 616c 5b43 6f6c  ag: Optional[Col
+0002bbd0: 756d 6e4f 724e 616d 655d 203d 204e 6f6e  umnOrName] = Non
+0002bbe0: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
+0002bbf0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+0002bc00: 6e20 6f62 6a65 6374 2063 6f6e 7369 7374  n object consist
+0002bc10: 696e 6720 6f66 2074 6865 2069 6e70 7574  ing of the input
+0002bc20: 206f 626a 6563 7420 7769 7468 2061 206e   object with a n
+0002bc30: 6577 206b 6579 2d76 616c 7565 2070 6169  ew key-value pai
+0002bc40: 7220 696e 7365 7274 6564 2028 6f72 2061  r inserted (or a
+0002bc50: 6e0a 2020 2020 6578 6973 7469 6e67 206b  n.    existing k
+0002bc60: 6579 2075 7064 6174 6564 2077 6974 6820  ey updated with 
+0002bc70: 6120 6e65 7720 7661 6c75 6529 2e0a 0a20  a new value)... 
+0002bc80: 2020 2045 7861 6d70 6c65 3a3a 0a20 2020     Example::.   
+0002bc90: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0002bca0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0002bcb0: 2e66 756e 6374 696f 6e73 2069 6d70 6f72  .functions impor
+0002bcc0: 7420 6c69 740a 2020 2020 2020 2020 3e3e  t lit.        >>
+0002bcd0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+0002bce0: 716c 280a 2020 2020 2020 2020 2e2e 2e20  ql(.        ... 
+0002bcf0: 2020 2020 2273 656c 6563 7420 6f62 6a65      "select obje
+0002bd00: 6374 5f63 6f6e 7374 7275 6374 2861 2c62  ct_construct(a,b
+0002bd10: 2c63 2c64 2c65 2c66 2920 6173 206f 626a  ,c,d,e,f) as obj
+0002bd20: 2c20 6b2c 2076 2066 726f 6d20 220a 2020  , k, v from ".  
+0002bd30: 2020 2020 2020 2e2e 2e20 2020 2020 2276        ...     "v
+0002bd40: 616c 7565 7328 2761 6765 272c 2032 312c  alues('age', 21,
+0002bd50: 2027 7a69 7027 2c20 3231 3032 312c 2027   'zip', 21021, '
+0002bd60: 6e61 6d65 272c 2027 4a6f 6527 2c20 2761  name', 'Joe', 'a
+0002bd70: 6765 272c 2030 292c 220a 2020 2020 2020  ge', 0),".      
+0002bd80: 2020 2e2e 2e20 2020 2020 2228 2761 6765    ...     "('age
+0002bd90: 272c 2032 362c 2027 7a69 7027 2c20 3934  ', 26, 'zip', 94
+0002bda0: 3032 312c 2027 6e61 6d65 272c 2027 4a61  021, 'name', 'Ja
+0002bdb0: 7927 2c20 2761 6765 272c 2030 2920 6173  y', 'age', 0) as
+0002bdc0: 2054 2861 2c62 2c63 2c64 2c65 2c66 2c6b   T(a,b,c,d,e,f,k
+0002bdd0: 2c76 2922 0a20 2020 2020 2020 202e 2e2e  ,v)".        ...
+0002bde0: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+0002bdf0: 662e 7365 6c65 6374 286f 626a 6563 745f  f.select(object_
+0002be00: 696e 7365 7274 2863 6f6c 2822 6f62 6a22  insert(col("obj"
+0002be10: 292c 206c 6974 2822 6b65 7922 292c 206c  ), lit("key"), l
+0002be20: 6974 2822 7622 2929 2e61 6c69 6173 2822  it("v")).alias("
+0002be30: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+0002be40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002be50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+0002be60: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+0002be70: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002be80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0002be90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002bea0: 7c7b 2020 2020 2020 2020 2020 2020 2020  |{              
+0002beb0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0002bec0: 2261 6765 223a 2032 312c 2020 2020 2020  "age": 21,      
+0002bed0: 7c0a 2020 2020 2020 2020 7c20 2022 6b65  |.        |  "ke
+0002bee0: 7922 3a20 2276 222c 2020 2020 207c 0a20  y": "v",     |. 
+0002bef0: 2020 2020 2020 207c 2020 226e 616d 6522         |  "name"
+0002bf00: 3a20 224a 6f65 222c 2020 7c0a 2020 2020  : "Joe",  |.    
+0002bf10: 2020 2020 7c20 2022 7a69 7022 3a20 3231      |  "zip": 21
+0002bf20: 3032 3120 2020 207c 0a20 2020 2020 2020  021    |.       
+0002bf30: 207c 7d20 2020 2020 2020 2020 2020 2020   |}             
+0002bf40: 2020 2020 7c0a 2020 2020 2020 2020 7c7b      |.        |{
+0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf60: 207c 0a20 2020 2020 2020 207c 2020 2261   |.        |  "a
+0002bf70: 6765 223a 2032 362c 2020 2020 2020 7c0a  ge": 26,      |.
+0002bf80: 2020 2020 2020 2020 7c20 2022 6b65 7922          |  "key"
+0002bf90: 3a20 2276 222c 2020 2020 207c 0a20 2020  : "v",     |.   
+0002bfa0: 2020 2020 207c 2020 226e 616d 6522 3a20       |  "name": 
+0002bfb0: 224a 6179 222c 2020 7c0a 2020 2020 2020  "Jay",  |.      
+0002bfc0: 2020 7c20 2022 7a69 7022 3a20 3934 3032    |  "zip": 9402
+0002bfd0: 3120 2020 207c 0a20 2020 2020 2020 207c  1    |.        |
+0002bfe0: 7d20 2020 2020 2020 2020 2020 2020 2020  }               
+0002bff0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002c000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002c010: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0002c020: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+0002c030: 206f 203d 205f 746f 5f63 6f6c 5f69 665f   o = _to_col_if_
+0002c040: 7374 7228 6f62 6a2c 2022 6f62 6a65 6374  str(obj, "object
+0002c050: 5f69 6e73 6572 7422 290a 2020 2020 6b20  _insert").    k 
+0002c060: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0002c070: 286b 6579 2c20 226f 626a 6563 745f 696e  (key, "object_in
+0002c080: 7365 7274 2229 0a20 2020 2076 203d 205f  sert").    v = _
+0002c090: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002c0a0: 6c75 652c 2022 6f62 6a65 6374 5f69 6e73  lue, "object_ins
+0002c0b0: 6572 7422 290a 2020 2020 7566 203d 205f  ert").    uf = _
+0002c0c0: 746f 5f63 6f6c 5f69 665f 7374 7228 7570  to_col_if_str(up
+0002c0d0: 6461 7465 5f66 6c61 672c 2022 7570 6461  date_flag, "upda
+0002c0e0: 7465 5f66 6c61 6722 2920 6966 2075 7064  te_flag") if upd
+0002c0f0: 6174 655f 666c 6167 2069 7320 6e6f 7420  ate_flag is not 
+0002c100: 4e6f 6e65 2065 6c73 6520 4e6f 6e65 0a20  None else None. 
+0002c110: 2020 2069 6620 7566 2069 7320 6e6f 7420     if uf is not 
+0002c120: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+0002c130: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
+0002c140: 6a65 6374 5f69 6e73 6572 7422 2928 6f2c  ject_insert")(o,
+0002c150: 206b 2c20 762c 2075 6629 0a20 2020 2065   k, v, uf).    e
+0002c160: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+0002c170: 7572 6e20 6275 696c 7469 6e28 226f 626a  urn builtin("obj
+0002c180: 6563 745f 696e 7365 7274 2229 286f 2c20  ect_insert")(o, 
+0002c190: 6b2c 2076 290a 0a0a 6465 6620 6f62 6a65  k, v)...def obje
+0002c1a0: 6374 5f70 6963 6b28 6f62 6a3a 2043 6f6c  ct_pick(obj: Col
+0002c1b0: 756d 6e4f 724e 616d 652c 206b 6579 313a  umnOrName, key1:
+0002c1c0: 2043 6f6c 756d 6e4f 724e 616d 652c 202a   ColumnOrName, *
+0002c1d0: 6b65 7973 3a20 436f 6c75 6d6e 4f72 4e61  keys: ColumnOrNa
+0002c1e0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002c1f0: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
+0002c200: 6e65 7720 4f42 4a45 4354 2063 6f6e 7461  new OBJECT conta
+0002c210: 696e 696e 6720 736f 6d65 206f 6620 7468  ining some of th
+0002c220: 6520 6b65 792d 7661 6c75 6520 7061 6972  e key-value pair
+0002c230: 7320 6672 6f6d 2061 6e20 6578 6973 7469  s from an existi
+0002c240: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
+0002c250: 546f 2069 6465 6e74 6966 7920 7468 6520  To identify the 
+0002c260: 6b65 792d 7661 6c75 6520 7061 6972 7320  key-value pairs 
+0002c270: 746f 2069 6e63 6c75 6465 2069 6e20 7468  to include in th
+0002c280: 6520 6e65 7720 6f62 6a65 6374 2c20 7061  e new object, pa
+0002c290: 7373 2069 6e20 7468 6520 6b65 7973 2061  ss in the keys a
+0002c2a0: 7320 6172 6775 6d65 6e74 732c 0a20 2020  s arguments,.   
+0002c2b0: 206f 7220 7061 7373 2069 6e20 616e 2061   or pass in an a
+0002c2c0: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+0002c2d0: 7468 6520 6b65 7973 2e0a 0a20 2020 2049  the keys...    I
+0002c2e0: 6620 6120 7370 6563 6966 6965 6420 6b65  f a specified ke
+0002c2f0: 7920 6973 206e 6f74 2070 7265 7365 6e74  y is not present
+0002c300: 2069 6e20 7468 6520 696e 7075 7420 6f62   in the input ob
+0002c310: 6a65 6374 2c20 7468 6520 6b65 7920 6973  ject, the key is
+0002c320: 2069 676e 6f72 6564 2e0a 0a20 2020 2045   ignored...    E
+0002c330: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002c340: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0002c350: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+0002c360: 6374 696f 6e73 2069 6d70 6f72 7420 6c69  ctions import li
+0002c370: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
+0002c380: 203d 2073 6573 7369 6f6e 2e73 716c 280a   = session.sql(.
+0002c390: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0002c3a0: 2273 656c 6563 7420 6f62 6a65 6374 5f63  "select object_c
+0002c3b0: 6f6e 7374 7275 6374 2861 2c62 2c63 2c64  onstruct(a,b,c,d
+0002c3c0: 2c65 2c66 2920 6173 206f 626a 2c20 6b2c  ,e,f) as obj, k,
+0002c3d0: 2076 2066 726f 6d20 220a 2020 2020 2020   v from ".      
+0002c3e0: 2020 2e2e 2e20 2020 2020 2276 616c 7565    ...     "value
+0002c3f0: 7328 2761 6765 272c 2032 312c 2027 7a69  s('age', 21, 'zi
+0002c400: 7027 2c20 3231 3032 312c 2027 6e61 6d65  p', 21021, 'name
+0002c410: 272c 2027 4a6f 6527 2c20 2761 6765 272c  ', 'Joe', 'age',
+0002c420: 2030 292c 220a 2020 2020 2020 2020 2e2e   0),".        ..
+0002c430: 2e20 2020 2020 2228 2761 6765 272c 2032  .     "('age', 2
+0002c440: 362c 2027 7a69 7027 2c20 3934 3032 312c  6, 'zip', 94021,
+0002c450: 2027 6e61 6d65 272c 2027 4a61 7927 2c20   'name', 'Jay', 
+0002c460: 2761 6765 272c 2030 2920 6173 2054 2861  'age', 0) as T(a
+0002c470: 2c62 2c63 2c64 2c65 2c66 2c6b 2c76 2922  ,b,c,d,e,f,k,v)"
+0002c480: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+0002c490: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002c4a0: 6c65 6374 286f 626a 6563 745f 7069 636b  lect(object_pick
+0002c4b0: 2863 6f6c 2822 6f62 6a22 292c 2063 6f6c  (col("obj"), col
+0002c4c0: 2822 6b22 292c 206c 6974 2822 6e61 6d65  ("k"), lit("name
+0002c4d0: 2229 292e 616c 6961 7328 2272 6573 756c  ")).alias("resul
+0002c4e0: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+0002c4f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002c500: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002c510: 7c22 5245 5355 4c54 2220 2020 2020 2020  |"RESULT"       
+0002c520: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002c530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002c540: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+0002c550: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002c560: 2020 2020 7c20 2022 6167 6522 3a20 3231      |  "age": 21
+0002c570: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
+0002c580: 7c20 2022 6e61 6d65 223a 2022 4a6f 6522  |  "name": "Joe"
+0002c590: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
+0002c5a0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+0002c5b0: 2020 2020 2020 2020 7c7b 2020 2020 2020          |{      
+0002c5c0: 2020 2020 2020 2020 2020 7c0a 2020 2020            |.    
+0002c5d0: 2020 2020 7c20 2022 6167 6522 3a20 3236      |  "age": 26
+0002c5e0: 2c20 2020 2020 7c0a 2020 2020 2020 2020  ,     |.        
+0002c5f0: 7c20 2022 6e61 6d65 223a 2022 4a61 7922  |  "name": "Jay"
+0002c600: 2020 7c0a 2020 2020 2020 2020 7c7d 2020    |.        |}  
+0002c610: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+0002c620: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002c630: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0002c640: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0002c650: 2020 2020 2222 220a 2020 2020 6f20 3d20      """.    o = 
+0002c660: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
+0002c670: 626a 2c20 226f 626a 6563 745f 7069 636b  bj, "object_pick
+0002c680: 2229 0a20 2020 206b 3120 3d20 5f74 6f5f  ").    k1 = _to_
+0002c690: 636f 6c5f 6966 5f73 7472 286b 6579 312c  col_if_str(key1,
+0002c6a0: 2022 6f62 6a65 6374 5f70 6963 6b22 290a   "object_pick").
+0002c6b0: 2020 2020 6b73 203d 205b 5f74 6f5f 636f      ks = [_to_co
+0002c6c0: 6c5f 6966 5f73 7472 286b 2c20 226f 626a  l_if_str(k, "obj
+0002c6d0: 6563 745f 7069 636b 2229 2066 6f72 206b  ect_pick") for k
+0002c6e0: 2069 6e20 6b65 7973 5d0a 2020 2020 7265   in keys].    re
+0002c6f0: 7475 726e 2062 7569 6c74 696e 2822 6f62  turn builtin("ob
+0002c700: 6a65 6374 5f70 6963 6b22 2928 6f2c 206b  ject_pick")(o, k
+0002c710: 312c 202a 6b73 290a 0a0a 6465 6620 6173  1, *ks)...def as
+0002c720: 6328 633a 2043 6f6c 756d 6e4f 724e 616d  c(c: ColumnOrNam
+0002c730: 6529 202d 3e20 436f 6c75 6d6e 3a0a 2020  e) -> Column:.  
+0002c740: 2020 2222 2252 6574 7572 6e73 2061 2043    """Returns a C
+0002c750: 6f6c 756d 6e20 6578 7072 6573 7369 6f6e  olumn expression
+0002c760: 2077 6974 6820 7661 6c75 6573 2073 6f72   with values sor
+0002c770: 7465 6420 696e 2061 7363 656e 6469 6e67  ted in ascending
+0002c780: 206f 7264 6572 2e0a 0a20 2020 2045 7861   order...    Exa
+0002c790: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0002c7a0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002c7b0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0002c7c0: 6528 5b4e 6f6e 652c 2033 2c20 322c 2031  e([None, 3, 2, 1
+0002c7d0: 2c20 4e6f 6e65 5d2c 2073 6368 656d 613d  , None], schema=
+0002c7e0: 5b22 6122 5d29 0a20 2020 2020 2020 203e  ["a"]).        >
+0002c7f0: 3e3e 2064 662e 736f 7274 2861 7363 2864  >> df.sort(asc(d
+0002c800: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
+0002c810: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0002c820: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
+0002c830: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
+0002c840: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
+0002c850: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
+0002c860: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0002c870: 7472 2863 2c20 2261 7363 2229 0a20 2020  tr(c, "asc").   
+0002c880: 2072 6574 7572 6e20 632e 6173 6328 290a   return c.asc().
+0002c890: 0a0a 6465 6620 6173 635f 6e75 6c6c 735f  ..def asc_nulls_
+0002c8a0: 6669 7273 7428 633a 2043 6f6c 756d 6e4f  first(c: ColumnO
+0002c8b0: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002c8c0: 3a0a 2020 2020 2222 2252 6574 7572 6e73  :.    """Returns
+0002c8d0: 2061 2043 6f6c 756d 6e20 6578 7072 6573   a Column expres
+0002c8e0: 7369 6f6e 2077 6974 6820 7661 6c75 6573  sion with values
+0002c8f0: 2073 6f72 7465 6420 696e 2061 7363 656e   sorted in ascen
+0002c900: 6469 6e67 206f 7264 6572 0a20 2020 2028  ding order.    (
+0002c910: 6e75 6c6c 2076 616c 7565 7320 736f 7274  null values sort
+0002c920: 6564 2062 6566 6f72 6520 6e6f 6e2d 6e75  ed before non-nu
+0002c930: 6c6c 2076 616c 7565 7329 2e0a 0a20 2020  ll values)...   
+0002c940: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0002c950: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+0002c960: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+0002c970: 6672 616d 6528 5b4e 6f6e 652c 2033 2c20  frame([None, 3, 
+0002c980: 322c 2031 2c20 4e6f 6e65 5d2c 2073 6368  2, 1, None], sch
+0002c990: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+0002c9a0: 2020 203e 3e3e 2064 662e 736f 7274 2861     >>> df.sort(a
+0002c9b0: 7363 5f6e 756c 6c73 5f66 6972 7374 2864  sc_nulls_first(d
+0002c9c0: 665b 2261 225d 2929 2e63 6f6c 6c65 6374  f["a"])).collect
+0002c9d0: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+0002c9e0: 413d 4e6f 6e65 292c 2052 6f77 2841 3d4e  A=None), Row(A=N
+0002c9f0: 6f6e 6529 2c20 526f 7728 413d 3129 2c20  one), Row(A=1), 
+0002ca00: 526f 7728 413d 3229 2c20 526f 7728 413d  Row(A=2), Row(A=
+0002ca10: 3329 5d0a 2020 2020 2222 220a 2020 2020  3)].    """.    
+0002ca20: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0002ca30: 7472 2863 2c20 2261 7363 5f6e 756c 6c73  tr(c, "asc_nulls
+0002ca40: 5f66 6972 7374 2229 0a20 2020 2072 6574  _first").    ret
+0002ca50: 7572 6e20 632e 6173 635f 6e75 6c6c 735f  urn c.asc_nulls_
+0002ca60: 6669 7273 7428 290a 0a0a 6465 6620 6173  first()...def as
+0002ca70: 635f 6e75 6c6c 735f 6c61 7374 2863 3a20  c_nulls_last(c: 
+0002ca80: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+0002ca90: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0002caa0: 5265 7475 726e 7320 6120 436f 6c75 6d6e  Returns a Column
+0002cab0: 2065 7870 7265 7373 696f 6e20 7769 7468   expression with
+0002cac0: 2076 616c 7565 7320 736f 7274 6564 2069   values sorted i
+0002cad0: 6e20 6173 6365 6e64 696e 6720 6f72 6465  n ascending orde
+0002cae0: 720a 2020 2020 286e 756c 6c20 7661 6c75  r.    (null valu
+0002caf0: 6573 2073 6f72 7465 6420 6166 7465 7220  es sorted after 
+0002cb00: 6e6f 6e2d 6e75 6c6c 2076 616c 7565 7329  non-null values)
+0002cb10: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002cb20: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0002cb30: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002cb40: 655f 6461 7461 6672 616d 6528 5b4e 6f6e  e_dataframe([Non
+0002cb50: 652c 2033 2c20 322c 2031 2c20 4e6f 6e65  e, 3, 2, 1, None
+0002cb60: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0002cb70: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002cb80: 736f 7274 2861 7363 5f6e 756c 6c73 5f6c  sort(asc_nulls_l
+0002cb90: 6173 7428 6466 5b22 6122 5d29 292e 636f  ast(df["a"])).co
+0002cba0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0002cbb0: 5b52 6f77 2841 3d31 292c 2052 6f77 2841  [Row(A=1), Row(A
+0002cbc0: 3d32 292c 2052 6f77 2841 3d33 292c 2052  =2), Row(A=3), R
+0002cbd0: 6f77 2841 3d4e 6f6e 6529 2c20 526f 7728  ow(A=None), Row(
+0002cbe0: 413d 4e6f 6e65 295d 0a20 2020 2022 2222  A=None)].    """
+0002cbf0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002cc00: 5f69 665f 7374 7228 632c 2022 6173 635f  _if_str(c, "asc_
+0002cc10: 6e75 6c6c 735f 6c61 7374 2229 0a20 2020  nulls_last").   
+0002cc20: 2072 6574 7572 6e20 632e 6173 635f 6e75   return c.asc_nu
+0002cc30: 6c6c 735f 6c61 7374 2829 0a0a 0a64 6566  lls_last()...def
+0002cc40: 2064 6573 6328 633a 2043 6f6c 756d 6e4f   desc(c: ColumnO
+0002cc50: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002cc60: 3a0a 2020 2020 2222 220a 2020 2020 5265  :.    """.    Re
+0002cc70: 7475 726e 7320 6120 436f 6c75 6d6e 2065  turns a Column e
+0002cc80: 7870 7265 7373 696f 6e20 7769 7468 2076  xpression with v
+0002cc90: 616c 7565 7320 736f 7274 6564 2069 6e20  alues sorted in 
+0002cca0: 6465 7363 656e 6469 6e67 206f 7264 6572  descending order
+0002ccb0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002ccc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0002ccd0: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002cce0: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+0002ccf0: 322c 2033 2c20 4e6f 6e65 2c20 4e6f 6e65  2, 3, None, None
+0002cd00: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0002cd10: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002cd20: 736f 7274 2864 6573 6328 6466 5b22 6122  sort(desc(df["a"
+0002cd30: 5d29 292e 636f 6c6c 6563 7428 290a 2020  ])).collect().  
+0002cd40: 2020 2020 2020 5b52 6f77 2841 3d33 292c        [Row(A=3),
+0002cd50: 2052 6f77 2841 3d32 292c 2052 6f77 2841   Row(A=2), Row(A
+0002cd60: 3d31 292c 2052 6f77 2841 3d4e 6f6e 6529  =1), Row(A=None)
+0002cd70: 2c20 526f 7728 413d 4e6f 6e65 295d 0a20  , Row(A=None)]. 
+0002cd80: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002cd90: 746f 5f63 6f6c 5f69 665f 7374 7228 632c  to_col_if_str(c,
+0002cda0: 2022 6465 7363 2229 0a20 2020 2072 6574   "desc").    ret
+0002cdb0: 7572 6e20 632e 6465 7363 2829 0a0a 0a64  urn c.desc()...d
+0002cdc0: 6566 2064 6573 635f 6e75 6c6c 735f 6669  ef desc_nulls_fi
+0002cdd0: 7273 7428 633a 2043 6f6c 756d 6e4f 724e  rst(c: ColumnOrN
+0002cde0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002cdf0: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+0002ce00: 726e 7320 6120 436f 6c75 6d6e 2065 7870  rns a Column exp
+0002ce10: 7265 7373 696f 6e20 7769 7468 2076 616c  ression with val
+0002ce20: 7565 7320 736f 7274 6564 2069 6e20 6465  ues sorted in de
+0002ce30: 7363 656e 6469 6e67 206f 7264 6572 0a20  scending order. 
+0002ce40: 2020 2028 6e75 6c6c 2076 616c 7565 7320     (null values 
+0002ce50: 736f 7274 6564 2062 6566 6f72 6520 6e6f  sorted before no
+0002ce60: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
+0002ce70: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0002ce80: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002ce90: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+0002cea0: 6461 7461 6672 616d 6528 5b31 2c20 322c  dataframe([1, 2,
+0002ceb0: 2033 2c20 4e6f 6e65 2c20 4e6f 6e65 5d2c   3, None, None],
+0002cec0: 2073 6368 656d 613d 5b22 6122 5d29 0a20   schema=["a"]). 
+0002ced0: 2020 2020 2020 203e 3e3e 2064 662e 736f         >>> df.so
+0002cee0: 7274 2864 6573 635f 6e75 6c6c 735f 6669  rt(desc_nulls_fi
+0002cef0: 7273 7428 6466 5b22 6122 5d29 292e 636f  rst(df["a"])).co
+0002cf00: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0002cf10: 5b52 6f77 2841 3d4e 6f6e 6529 2c20 526f  [Row(A=None), Ro
+0002cf20: 7728 413d 4e6f 6e65 292c 2052 6f77 2841  w(A=None), Row(A
+0002cf30: 3d33 292c 2052 6f77 2841 3d32 292c 2052  =3), Row(A=2), R
+0002cf40: 6f77 2841 3d31 295d 0a20 2020 2022 2222  ow(A=1)].    """
+0002cf50: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002cf60: 5f69 665f 7374 7228 632c 2022 6465 7363  _if_str(c, "desc
+0002cf70: 5f6e 756c 6c73 5f66 6972 7374 2229 0a20  _nulls_first"). 
+0002cf80: 2020 2072 6574 7572 6e20 632e 6465 7363     return c.desc
+0002cf90: 5f6e 756c 6c73 5f66 6972 7374 2829 0a0a  _nulls_first()..
+0002cfa0: 0a64 6566 2064 6573 635f 6e75 6c6c 735f  .def desc_nulls_
+0002cfb0: 6c61 7374 2863 3a20 436f 6c75 6d6e 4f72  last(c: ColumnOr
+0002cfc0: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002cfd0: 0a20 2020 2022 2222 0a20 2020 2052 6574  .    """.    Ret
+0002cfe0: 7572 6e73 2061 2043 6f6c 756d 6e20 6578  urns a Column ex
+0002cff0: 7072 6573 7369 6f6e 2077 6974 6820 7661  pression with va
+0002d000: 6c75 6573 2073 6f72 7465 6420 696e 2064  lues sorted in d
+0002d010: 6573 6365 6e64 696e 6720 6f72 6465 720a  escending order.
+0002d020: 2020 2020 286e 756c 6c20 7661 6c75 6573      (null values
+0002d030: 2073 6f72 7465 6420 6166 7465 7220 6e6f   sorted after no
+0002d040: 6e2d 6e75 6c6c 2076 616c 7565 7329 2e0a  n-null values)..
+0002d050: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0002d060: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002d070: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0002d080: 6174 6166 7261 6d65 285b 312c 2032 2c20  ataframe([1, 2, 
+0002d090: 332c 204e 6f6e 652c 204e 6f6e 655d 2c20  3, None, None], 
+0002d0a0: 7363 6865 6d61 3d5b 2261 225d 290a 2020  schema=["a"]).  
+0002d0b0: 2020 2020 2020 3e3e 3e20 6466 2e73 6f72        >>> df.sor
+0002d0c0: 7428 6465 7363 5f6e 756c 6c73 5f6c 6173  t(desc_nulls_las
+0002d0d0: 7428 6466 5b22 6122 5d29 292e 636f 6c6c  t(df["a"])).coll
+0002d0e0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0002d0f0: 6f77 2841 3d33 292c 2052 6f77 2841 3d32  ow(A=3), Row(A=2
+0002d100: 292c 2052 6f77 2841 3d31 292c 2052 6f77  ), Row(A=1), Row
+0002d110: 2841 3d4e 6f6e 6529 2c20 526f 7728 413d  (A=None), Row(A=
+0002d120: 4e6f 6e65 295d 0a20 2020 2022 2222 0a20  None)].    """. 
+0002d130: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0002d140: 665f 7374 7228 632c 2022 6465 7363 5f6e  f_str(c, "desc_n
+0002d150: 756c 6c73 5f6c 6173 7422 290a 2020 2020  ulls_last").    
+0002d160: 7265 7475 726e 2063 2e64 6573 635f 6e75  return c.desc_nu
+0002d170: 6c6c 735f 6c61 7374 2829 0a0a 0a64 6566  lls_last()...def
+0002d180: 2061 735f 6172 7261 7928 7661 7269 616e   as_array(varian
+0002d190: 743a 2043 6f6c 756d 6e4f 724e 616d 6529  t: ColumnOrName)
+0002d1a0: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+0002d1b0: 2222 2243 6173 7473 2061 2056 4152 4941  """Casts a VARIA
+0002d1c0: 4e54 2076 616c 7565 2074 6f20 616e 2061  NT value to an a
+0002d1d0: 7272 6179 2e0a 0a20 2020 2045 7861 6d70  rray...    Examp
+0002d1e0: 6c65 3a3a 0a20 2020 2020 2020 203e 3e3e  le::.        >>>
+0002d1f0: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+0002d200: 6c28 2273 656c 6563 7420 6172 7261 795f  l("select array_
+0002d210: 636f 6e73 7472 7563 7428 312c 2032 293a  construct(1, 2):
+0002d220: 3a76 6172 6961 6e74 2061 7320 6122 290a  :variant as a").
+0002d230: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002d240: 656c 6563 7428 6173 5f61 7272 6179 2822  elect(as_array("
+0002d250: 6122 292e 616c 6961 7328 2272 6573 756c  a").alias("resul
+0002d260: 7422 2929 2e73 686f 7728 290a 2020 2020  t")).show().    
+0002d270: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0002d280: 0a20 2020 2020 2020 207c 2252 4553 554c  .        |"RESUL
+0002d290: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+0002d2a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0002d2b0: 2020 207c 5b20 2020 2020 2020 2020 7c0a     |[         |.
+0002d2c0: 2020 2020 2020 2020 7c20 2031 2c20 2020          |  1,   
+0002d2d0: 2020 207c 0a20 2020 2020 2020 207c 2020     |.        |  
+0002d2e0: 3220 2020 2020 2020 7c0a 2020 2020 2020  2       |.      
+0002d2f0: 2020 7c5d 2020 2020 2020 2020 207c 0a20    |]         |. 
+0002d300: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002d310: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+0002d320: 4e4b 4c49 4e45 3e0a 2020 2020 2222 220a  NKLINE>.    """.
+0002d330: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0002d340: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
+0002d350: 2261 735f 6172 7261 7922 290a 2020 2020  "as_array").    
+0002d360: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002d370: 6173 5f61 7272 6179 2229 2863 290a 0a0a  as_array")(c)...
+0002d380: 6465 6620 6173 5f62 696e 6172 7928 7661  def as_binary(va
+0002d390: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
+0002d3a0: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002d3b0: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
+0002d3c0: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+0002d3d0: 6120 6269 6e61 7279 2073 7472 696e 672e  a binary string.
+0002d3e0: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002d3f0: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002d400: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
+0002d410: 6c65 6374 2074 6f5f 6269 6e61 7279 2827  lect to_binary('
+0002d420: 4630 4135 2729 3a3a 7661 7269 616e 7420  F0A5')::variant 
+0002d430: 6173 2061 2229 0a20 2020 2020 2020 203e  as a").        >
+0002d440: 3e3e 2064 662e 7365 6c65 6374 2861 735f  >> df.select(as_
+0002d450: 6269 6e61 7279 2822 6122 292e 616c 6961  binary("a").alia
+0002d460: 7328 2272 6573 756c 7422 2929 2e73 686f  s("result")).sho
+0002d470: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0002d480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d490: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 207c  ------.        |
+0002d4a0: 2252 4553 554c 5422 2020 2020 2020 2020  "RESULT"        
+0002d4b0: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0002d4c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0002d4d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002d4e0: 2020 2020 207c 6279 7465 6172 7261 7928       |bytearray(
+0002d4f0: 6227 5c78 6630 5c78 6135 2729 2020 7c0a  b'\xf0\xa5')  |.
+0002d500: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002d510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002d520: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+0002d530: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+0002d540: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+0002d550: 665f 7374 7228 7661 7269 616e 742c 2022  f_str(variant, "
+0002d560: 6173 5f62 696e 6172 7922 290a 2020 2020  as_binary").    
+0002d570: 7265 7475 726e 2062 7569 6c74 696e 2822  return builtin("
+0002d580: 6173 5f62 696e 6172 7922 2928 6329 0a0a  as_binary")(c)..
+0002d590: 0a64 6566 2061 735f 6368 6172 2876 6172  .def as_char(var
+0002d5a0: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
+0002d5b0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002d5c0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
+0002d5d0: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
+0002d5e0: 2073 7472 696e 672e 0a0a 2020 2020 4578   string...    Ex
+0002d5f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0002d600: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+0002d610: 616b 652e 736e 6f77 7061 726b 2e66 756e  ake.snowpark.fun
+0002d620: 6374 696f 6e73 2069 6d70 6f72 7420 6173  ctions import as
+0002d630: 5f63 6861 722c 2074 6f5f 7661 7269 616e  _char, to_varian
+0002d640: 740a 2020 2020 2020 2020 3e3e 3e20 6466  t.        >>> df
+0002d650: 203d 2073 6573 7369 6f6e 2e73 716c 2822   = session.sql("
+0002d660: 7365 6c65 6374 2027 736f 6d65 2073 7472  select 'some str
+0002d670: 696e 6727 2061 7320 6368 6172 2229 0a20  ing' as char"). 
+0002d680: 2020 2020 2020 203e 3e3e 2064 662e 6368         >>> df.ch
+0002d690: 6172 5f76 203d 2074 6f5f 7661 7269 616e  ar_v = to_varian
+0002d6a0: 7428 6466 2e63 6861 7229 0a20 2020 2020  t(df.char).     
+0002d6b0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+0002d6c0: 2864 662e 6368 6172 5f76 2e61 735f 2822  (df.char_v.as_("
+0002d6d0: 6368 6172 2229 292e 636f 6c6c 6563 7428  char")).collect(
+0002d6e0: 2920 3d3d 2064 662e 7365 6c65 6374 2864  ) == df.select(d
+0002d6f0: 662e 6368 6172 292e 636f 6c6c 6563 7428  f.char).collect(
+0002d700: 290a 2020 2020 2020 2020 4661 6c73 650a  ).        False.
+0002d710: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002d720: 656c 6563 7428 6173 5f63 6861 7228 6466  elect(as_char(df
+0002d730: 2e63 6861 725f 7629 2e61 735f 2822 6368  .char_v).as_("ch
+0002d740: 6172 2229 292e 636f 6c6c 6563 7428 2920  ar")).collect() 
+0002d750: 3d3d 2064 662e 7365 6c65 6374 2864 662e  == df.select(df.
+0002d760: 6368 6172 292e 636f 6c6c 6563 7428 290a  char).collect().
+0002d770: 2020 2020 2020 2020 5472 7565 0a20 2020          True.   
+0002d780: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0002d790: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
+0002d7a0: 616e 742c 2022 6173 5f63 6861 7222 290a  ant, "as_char").
+0002d7b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0002d7c0: 696e 2822 6173 5f63 6861 7222 2928 6329  in("as_char")(c)
+0002d7d0: 0a0a 0a64 6566 2061 735f 7661 7263 6861  ...def as_varcha
+0002d7e0: 7228 7661 7269 616e 743a 2043 6f6c 756d  r(variant: Colum
+0002d7f0: 6e4f 724e 616d 6529 202d 3e20 436f 6c75  nOrName) -> Colu
+0002d800: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
+0002d810: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
+0002d820: 2074 6f20 6120 7374 7269 6e67 2e0a 0a20   to a string... 
+0002d830: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0002d840: 2020 2020 2020 3e3e 3e20 6672 6f6d 2073        >>> from s
+0002d850: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0002d860: 6b2e 6675 6e63 7469 6f6e 7320 696d 706f  k.functions impo
+0002d870: 7274 2061 735f 7661 7263 6861 722c 2074  rt as_varchar, t
+0002d880: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
+0002d890: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002d8a0: 6f6e 2e73 716c 2822 7365 6c65 6374 2027  on.sql("select '
+0002d8b0: 736f 6d65 2073 7472 696e 6727 2061 7320  some string' as 
+0002d8c0: 6368 6172 2229 0a20 2020 2020 2020 203e  char").        >
+0002d8d0: 3e3e 2064 662e 6368 6172 5f76 203d 2074  >> df.char_v = t
+0002d8e0: 6f5f 7661 7269 616e 7428 6466 2e63 6861  o_variant(df.cha
+0002d8f0: 7229 0a20 2020 2020 2020 203e 3e3e 2064  r).        >>> d
+0002d900: 662e 7365 6c65 6374 2864 662e 6368 6172  f.select(df.char
+0002d910: 5f76 2e61 735f 2822 6368 6172 2229 292e  _v.as_("char")).
+0002d920: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
+0002d930: 7365 6c65 6374 2864 662e 6368 6172 292e  select(df.char).
+0002d940: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002d950: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
+0002d960: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
+0002d970: 5f76 6172 6368 6172 2864 662e 6368 6172  _varchar(df.char
+0002d980: 5f76 292e 6173 5f28 2263 6861 7222 2929  _v).as_("char"))
+0002d990: 2e63 6f6c 6c65 6374 2829 203d 3d20 6466  .collect() == df
+0002d9a0: 2e73 656c 6563 7428 6466 2e63 6861 7229  .select(df.char)
+0002d9b0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0002d9c0: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
+0002d9d0: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0002d9e0: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
+0002d9f0: 2261 735f 7661 7263 6861 7222 290a 2020  "as_varchar").  
+0002da00: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0002da10: 2822 6173 5f76 6172 6368 6172 2229 2863  ("as_varchar")(c
+0002da20: 290a 0a0a 6465 6620 6173 5f64 6174 6528  )...def as_date(
+0002da30: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+0002da40: 724e 616d 6529 202d 3e20 436f 6c75 6d6e  rName) -> Column
+0002da50: 3a0a 2020 2020 2222 2243 6173 7473 2061  :.    """Casts a
+0002da60: 2056 4152 4941 4e54 2076 616c 7565 2074   VARIANT value t
+0002da70: 6f20 6120 6461 7465 2e0a 0a20 2020 2045  o a date...    E
+0002da80: 7861 6d70 6c65 3a3a 0a20 2020 2020 2020  xample::.       
+0002da90: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0002daa0: 6e2e 7371 6c28 2273 656c 6563 7420 6461  n.sql("select da
+0002dab0: 7465 2732 3032 302d 312d 3127 3a3a 7661  te'2020-1-1'::va
+0002dac0: 7269 616e 7420 6173 2061 2229 0a20 2020  riant as a").   
+0002dad0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002dae0: 6374 2861 735f 6461 7465 2822 6122 292e  ct(as_date("a").
+0002daf0: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+0002db00: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0002db10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002db20: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0002db30: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+0002db40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0002db50: 2020 2020 207c 3230 3230 2d30 312d 3031       |2020-01-01
+0002db60: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002db70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0002db80: 2020 203c 424c 414e 4b4c 494e 453e 0a20     <BLANKLINE>. 
+0002db90: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+0002dba0: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002dbb0: 7269 616e 742c 2022 6173 5f64 6174 6522  riant, "as_date"
+0002dbc0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002dbd0: 6c74 696e 2822 6173 5f64 6174 6522 2928  ltin("as_date")(
+0002dbe0: 6329 0a0a 0a64 6566 2063 6173 7428 636f  c)...def cast(co
+0002dbf0: 6c75 6d6e 3a20 436f 6c75 6d6e 4f72 4e61  lumn: ColumnOrNa
+0002dc00: 6d65 2c20 746f 3a20 556e 696f 6e5b 7374  me, to: Union[st
+0002dc10: 722c 2044 6174 6154 7970 655d 2920 2d3e  r, DataType]) ->
+0002dc20: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0002dc30: 436f 6e76 6572 7473 2061 2076 616c 7565  Converts a value
+0002dc40: 206f 6620 6f6e 6520 6461 7461 2074 7970   of one data typ
+0002dc50: 6520 696e 746f 2061 6e6f 7468 6572 2064  e into another d
+0002dc60: 6174 6120 7479 7065 2e0a 2020 2020 5468  ata type..    Th
+0002dc70: 6520 7365 6d61 6e74 6963 7320 6f66 2043  e semantics of C
+0002dc80: 4153 5420 6172 6520 7468 6520 7361 6d65  AST are the same
+0002dc90: 2061 7320 7468 6520 7365 6d61 6e74 6963   as the semantic
+0002dca0: 7320 6f66 2074 6865 2063 6f72 7265 7370  s of the corresp
+0002dcb0: 6f6e 6469 6e67 2074 6f20 6461 7461 7479  onding to dataty
+0002dcc0: 7065 2063 6f6e 7665 7273 696f 6e20 6675  pe conversion fu
+0002dcd0: 6e63 7469 6f6e 732e 0a20 2020 2049 6620  nctions..    If 
+0002dce0: 7468 6520 6361 7374 2069 7320 6e6f 7420  the cast is not 
+0002dcf0: 706f 7373 6962 6c65 2c20 6120 6060 536e  possible, a ``Sn
+0002dd00: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
+0002dd10: 6f6e 6060 2065 7863 6570 7469 6f6e 2069  on`` exception i
+0002dd20: 7320 7468 726f 776e 2e0a 0a20 2020 2045  s thrown...    E
+0002dd30: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+0002dd40: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+0002dd50: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
+0002dd60: 7065 7320 696d 706f 7274 2044 6563 696d  pes import Decim
+0002dd70: 616c 5479 7065 2c20 496e 7465 6765 7254  alType, IntegerT
+0002dd80: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
+0002dd90: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+0002dda0: 6174 655f 6461 7461 6672 616d 6528 5b5b  ate_dataframe([[
+0002ddb0: 312e 3534 3332 5d5d 2c20 7363 6865 6d61  1.5432]], schema
+0002ddc0: 3d5b 2264 225d 290a 2020 2020 2020 2020  =["d"]).        
+0002ddd0: 3e3e 3e20 6466 2e73 656c 6563 7428 6361  >>> df.select(ca
+0002dde0: 7374 2864 662e 642c 2044 6563 696d 616c  st(df.d, Decimal
+0002ddf0: 5479 7065 2831 352c 2032 2929 2e61 735f  Type(15, 2)).as_
+0002de00: 2822 4445 4349 4d41 4c22 292c 2063 6173  ("DECIMAL"), cas
+0002de10: 7428 6466 2e64 2c20 496e 7465 6765 7254  t(df.d, IntegerT
+0002de20: 7970 6528 2929 2e61 735f 2822 494e 5422  ype()).as_("INT"
+0002de30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0002de40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0002de50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002de60: 7c22 4445 4349 4d41 4c22 2020 7c22 494e  |"DECIMAL"  |"IN
+0002de70: 5422 2020 7c0a 2020 2020 2020 2020 2d2d  T"  |.        --
+0002de80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0002de90: 2d2d 2d0a 2020 2020 2020 2020 7c31 2e35  ---.        |1.5
+0002dea0: 3420 2020 2020 2020 7c32 2020 2020 2020  4       |2      
+0002deb0: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+0002dec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+0002ded0: 2020 2020 2020 2020 3c42 4c41 4e4b 4c49          <BLANKLI
+0002dee0: 4e45 3e0a 2020 2020 2222 220a 2020 2020  NE>.    """.    
+0002def0: 6320 3d20 5f74 6f5f 636f 6c5f 6966 5f73  c = _to_col_if_s
+0002df00: 7472 2863 6f6c 756d 6e2c 2022 6361 7374  tr(column, "cast
+0002df10: 2229 0a20 2020 2072 6574 7572 6e20 632e  ").    return c.
+0002df20: 6361 7374 2874 6f29 0a0a 0a64 6566 2074  cast(to)...def t
+0002df30: 7279 5f63 6173 7428 636f 6c75 6d6e 3a20  ry_cast(column: 
+0002df40: 436f 6c75 6d6e 4f72 4e61 6d65 2c20 746f  ColumnOrName, to
+0002df50: 3a20 556e 696f 6e5b 7374 722c 2044 6174  : Union[str, Dat
+0002df60: 6154 7970 655d 2920 2d3e 2043 6f6c 756d  aType]) -> Colum
+0002df70: 6e3a 0a20 2020 2022 2222 4120 7370 6563  n:.    """A spec
+0002df80: 6961 6c20 7665 7273 696f 6e20 6f66 2043  ial version of C
+0002df90: 4153 5420 666f 7220 6120 7375 6273 6574  AST for a subset
+0002dfa0: 206f 6620 6461 7461 2074 7970 6520 636f   of data type co
+0002dfb0: 6e76 6572 7369 6f6e 732e 0a20 2020 2049  nversions..    I
+0002dfc0: 7420 7065 7266 6f72 6d73 2074 6865 2073  t performs the s
+0002dfd0: 616d 6520 6f70 6572 6174 696f 6e20 2869  ame operation (i
+0002dfe0: 2e65 2e20 636f 6e76 6572 7473 2061 2076  .e. converts a v
+0002dff0: 616c 7565 206f 6620 6f6e 6520 6461 7461  alue of one data
+0002e000: 2074 7970 6520 696e 746f 2061 6e6f 7468   type into anoth
+0002e010: 6572 2064 6174 6120 7479 7065 292c 0a20  er data type),. 
+0002e020: 2020 2062 7574 2072 6574 7572 6e73 2061     but returns a
+0002e030: 204e 554c 4c20 7661 6c75 6520 696e 7374   NULL value inst
+0002e040: 6561 6420 6f66 2072 6169 7369 6e67 2061  ead of raising a
+0002e050: 6e20 6572 726f 7220 7768 656e 2074 6865  n error when the
+0002e060: 2063 6f6e 7665 7273 696f 6e20 6361 6e20   conversion can 
+0002e070: 6e6f 7420 6265 2070 6572 666f 726d 6564  not be performed
+0002e080: 2e0a 0a20 2020 2054 6865 2060 6063 6f6c  ...    The ``col
+0002e090: 756d 6e60 6020 6172 6775 6d65 6e74 206d  umn`` argument m
+0002e0a0: 7573 7420 6265 2061 2073 7472 696e 6720  ust be a string 
+0002e0b0: 636f 6c75 6d6e 2069 6e20 536e 6f77 666c  column in Snowfl
+0002e0c0: 616b 652e 0a0a 2020 2020 4578 616d 706c  ake...    Exampl
+0002e0d0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+0002e0e0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+0002e0f0: 736e 6f77 7061 726b 2e74 7970 6573 2069  snowpark.types i
+0002e100: 6d70 6f72 7420 496e 7465 6765 7254 7970  mport IntegerTyp
+0002e110: 652c 2046 6c6f 6174 5479 7065 0a20 2020  e, FloatType.   
+0002e120: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002e130: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0002e140: 6166 7261 6d65 285b 2730 272c 2027 2d31  aframe(['0', '-1
+0002e150: 3227 2c20 2732 3227 2c20 2731 3030 3127  2', '22', '1001'
+0002e160: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+0002e170: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0002e180: 7365 6c65 6374 2874 7279 5f63 6173 7428  select(try_cast(
+0002e190: 636f 6c28 2261 2229 2c20 496e 7465 6765  col("a"), Intege
+0002e1a0: 7254 7970 6528 2929 2e61 735f 2827 616e  rType()).as_('an
+0002e1b0: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+0002e1c0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+0002e1d0: 3029 2c20 526f 7728 414e 533d 2d31 3229  0), Row(ANS=-12)
+0002e1e0: 2c20 526f 7728 414e 533d 3232 292c 2052  , Row(ANS=22), R
+0002e1f0: 6f77 2841 4e53 3d31 3030 3129 5d0a 0a20  ow(ANS=1001)].. 
+0002e200: 2020 2045 7861 6d70 6c65 3a3a 0a0a 2020     Example::..  
+0002e210: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+0002e220: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+0002e230: 7461 6672 616d 6528 5b27 302e 3132 272c  taframe(['0.12',
+0002e240: 2027 5553 4420 3237 2e39 3027 2c20 2731   'USD 27.90', '1
+0002e250: 332e 3937 2055 5344 272c 2027 e282 ac39  3.97 USD', '...9
+0002e260: 372e 3027 2c20 2731 372c 2d27 5d2c 2073  7.0', '17,-'], s
+0002e270: 6368 656d 613d 5b22 6122 5d29 0a20 2020  chema=["a"]).   
+0002e280: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002e290: 6374 2874 7279 5f63 6173 7428 636f 6c28  ct(try_cast(col(
+0002e2a0: 2261 2229 2c20 466c 6f61 7454 7970 6528  "a"), FloatType(
+0002e2b0: 2929 2e61 735f 2827 616e 7327 2929 2e63  )).as_('ans')).c
+0002e2c0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0002e2d0: 205b 526f 7728 414e 533d 302e 3132 292c   [Row(ANS=0.12),
+0002e2e0: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+0002e2f0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+0002e300: 6f77 2841 4e53 3d4e 6f6e 6529 2c20 526f  ow(ANS=None), Ro
+0002e310: 7728 414e 533d 4e6f 6e65 295d 0a0a 2020  w(ANS=None)]..  
+0002e320: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+0002e330: 6f5f 636f 6c5f 6966 5f73 7472 2863 6f6c  o_col_if_str(col
+0002e340: 756d 6e2c 2022 7472 795f 6361 7374 2229  umn, "try_cast")
+0002e350: 0a20 2020 2072 6574 7572 6e20 632e 7472  .    return c.tr
+0002e360: 795f 6361 7374 2874 6f29 0a0a 0a64 6566  y_cast(to)...def
+0002e370: 205f 6173 5f64 6563 696d 616c 5f6f 725f   _as_decimal_or_
+0002e380: 6e75 6d62 6572 280a 2020 2020 6361 7374  number(.    cast
+0002e390: 5f74 7970 653a 2073 7472 2c0a 2020 2020  _type: str,.    
+0002e3a0: 7661 7269 616e 743a 2043 6f6c 756d 6e4f  variant: ColumnO
+0002e3b0: 724e 616d 652c 0a20 2020 2070 7265 6369  rName,.    preci
+0002e3c0: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b69  sion: Optional[i
+0002e3d0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+0002e3e0: 7363 616c 653a 204f 7074 696f 6e61 6c5b  scale: Optional[
+0002e3f0: 696e 745d 203d 204e 6f6e 652c 0a29 202d  int] = None,.) -
+0002e400: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002e410: 2248 656c 7065 7220 6675 6e63 7469 6f6e  "Helper function
+0002e420: 2074 6861 7420 6361 7374 7320 6120 5641   that casts a VA
+0002e430: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
+0002e440: 2064 6563 696d 616c 206f 7220 6e75 6d62   decimal or numb
+0002e450: 6572 2e22 2222 0a20 2020 2063 203d 205f  er.""".    c = _
+0002e460: 746f 5f63 6f6c 5f69 665f 7374 7228 7661  to_col_if_str(va
+0002e470: 7269 616e 742c 2063 6173 745f 7479 7065  riant, cast_type
+0002e480: 290a 2020 2020 6966 2073 6361 6c65 2061  ).    if scale a
+0002e490: 6e64 206e 6f74 2070 7265 6369 7369 6f6e  nd not precision
+0002e4a0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+0002e4b0: 5661 6c75 6545 7272 6f72 2822 4361 6e6e  ValueError("Cann
+0002e4c0: 6f74 2064 6566 696e 6520 7363 616c 6520  ot define scale 
+0002e4d0: 7769 7468 6f75 7420 7072 6563 6973 696f  without precisio
+0002e4e0: 6e22 290a 2020 2020 6966 2070 7265 6369  n").    if preci
+0002e4f0: 7369 6f6e 2061 6e64 2073 6361 6c65 3a0a  sion and scale:.
+0002e500: 2020 2020 2020 2020 7265 7475 726e 2062          return b
+0002e510: 7569 6c74 696e 2863 6173 745f 7479 7065  uiltin(cast_type
+0002e520: 2928 632c 206c 6974 2870 7265 6369 7369  )(c, lit(precisi
+0002e530: 6f6e 292c 206c 6974 2873 6361 6c65 2929  on), lit(scale))
+0002e540: 0a20 2020 2065 6c69 6620 7072 6563 6973  .    elif precis
+0002e550: 696f 6e3a 0a20 2020 2020 2020 2072 6574  ion:.        ret
+0002e560: 7572 6e20 6275 696c 7469 6e28 6361 7374  urn builtin(cast
+0002e570: 5f74 7970 6529 2863 2c20 6c69 7428 7072  _type)(c, lit(pr
+0002e580: 6563 6973 696f 6e29 290a 2020 2020 656c  ecision)).    el
+0002e590: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
+0002e5a0: 726e 2062 7569 6c74 696e 2863 6173 745f  rn builtin(cast_
+0002e5b0: 7479 7065 2928 6329 0a0a 0a64 6566 2061  type)(c)...def a
+0002e5c0: 735f 6465 6369 6d61 6c28 0a20 2020 2076  s_decimal(.    v
+0002e5d0: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002e5e0: 4e61 6d65 2c0a 2020 2020 7072 6563 6973  Name,.    precis
+0002e5f0: 696f 6e3a 204f 7074 696f 6e61 6c5b 696e  ion: Optional[in
+0002e600: 745d 203d 204e 6f6e 652c 0a20 2020 2073  t] = None,.    s
+0002e610: 6361 6c65 3a20 4f70 7469 6f6e 616c 5b69  cale: Optional[i
+0002e620: 6e74 5d20 3d20 4e6f 6e65 2c0a 2920 2d3e  nt] = None,.) ->
+0002e630: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+0002e640: 4361 7374 7320 6120 5641 5249 414e 5420  Casts a VARIANT 
+0002e650: 7661 6c75 6520 746f 2061 2066 6978 6564  value to a fixed
+0002e660: 2d70 6f69 6e74 2064 6563 696d 616c 2028  -point decimal (
+0002e670: 646f 6573 206e 6f74 206d 6174 6368 2066  does not match f
+0002e680: 6c6f 6174 696e 672d 706f 696e 7420 7661  loating-point va
+0002e690: 6c75 6573 292e 0a0a 2020 2020 4578 616d  lues)...    Exam
+0002e6a0: 706c 653a 3a0a 2020 2020 2020 2020 3e3e  ple::.        >>
+0002e6b0: 3e20 6466 203d 2073 6573 7369 6f6e 2e73  > df = session.s
+0002e6c0: 716c 2822 7365 6c65 6374 2031 2e32 3334  ql("select 1.234
+0002e6d0: 353a 3a76 6172 6961 6e74 2061 7320 6122  5::variant as a"
+0002e6e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002e6f0: 2e73 656c 6563 7428 6173 5f64 6563 696d  .select(as_decim
+0002e700: 616c 2822 6122 2c20 342c 2031 292e 616c  al("a", 4, 1).al
+0002e710: 6961 7328 2272 6573 756c 7422 2929 2e73  ias("result")).s
+0002e720: 686f 7728 290a 2020 2020 2020 2020 2d2d  how().        --
+0002e730: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0002e740: 2020 207c 2252 4553 554c 5422 2020 7c0a     |"RESULT"  |.
+0002e750: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002e760: 2d2d 2d2d 0a20 2020 2020 2020 207c 312e  ----.        |1.
+0002e770: 3220 2020 2020 2020 7c0a 2020 2020 2020  2       |.      
+0002e780: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002e790: 2020 2020 2020 203c 424c 414e 4b4c 494e         <BLANKLIN
+0002e7a0: 453e 0a20 2020 2022 2222 0a20 2020 2072  E>.    """.    r
+0002e7b0: 6574 7572 6e20 5f61 735f 6465 6369 6d61  eturn _as_decima
+0002e7c0: 6c5f 6f72 5f6e 756d 6265 7228 2261 735f  l_or_number("as_
+0002e7d0: 6465 6369 6d61 6c22 2c20 7661 7269 616e  decimal", varian
+0002e7e0: 742c 2070 7265 6369 7369 6f6e 2c20 7363  t, precision, sc
+0002e7f0: 616c 6529 0a0a 0a64 6566 2061 735f 6e75  ale)...def as_nu
+0002e800: 6d62 6572 280a 2020 2020 7661 7269 616e  mber(.    varian
+0002e810: 743a 2043 6f6c 756d 6e4f 724e 616d 652c  t: ColumnOrName,
+0002e820: 0a20 2020 2070 7265 6369 7369 6f6e 3a20  .    precision: 
+0002e830: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
+0002e840: 4e6f 6e65 2c0a 2020 2020 7363 616c 653a  None,.    scale:
+0002e850: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+0002e860: 204e 6f6e 652c 0a29 202d 3e20 436f 6c75   None,.) -> Colu
+0002e870: 6d6e 3a0a 2020 2020 2222 2243 6173 7473  mn:.    """Casts
+0002e880: 2061 2056 4152 4941 4e54 2076 616c 7565   a VARIANT value
+0002e890: 2074 6f20 6120 6669 7865 642d 706f 696e   to a fixed-poin
+0002e8a0: 7420 6465 6369 6d61 6c20 2864 6f65 7320  t decimal (does 
+0002e8b0: 6e6f 7420 6d61 7463 6820 666c 6f61 7469  not match floati
+0002e8c0: 6e67 2d70 6f69 6e74 2076 616c 7565 7329  ng-point values)
+0002e8d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002e8e0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0002e8f0: 3d20 7365 7373 696f 6e2e 7371 6c28 2273  = session.sql("s
+0002e900: 656c 6563 7420 312e 3233 3435 3a3a 7661  elect 1.2345::va
+0002e910: 7269 616e 7420 6173 2061 2229 0a20 2020  riant as a").   
+0002e920: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002e930: 6374 2861 735f 6e75 6d62 6572 2822 6122  ct(as_number("a"
+0002e940: 2c20 342c 2031 292e 616c 6961 7328 2272  , 4, 1).alias("r
+0002e950: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0002e960: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002e970: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002e980: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0002e990: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002e9a0: 2020 2020 2020 207c 312e 3220 2020 2020         |1.2     
+0002e9b0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002e9c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002e9d0: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0002e9e0: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
+0002e9f0: 5f61 735f 6465 6369 6d61 6c5f 6f72 5f6e  _as_decimal_or_n
+0002ea00: 756d 6265 7228 2261 735f 6e75 6d62 6572  umber("as_number
+0002ea10: 222c 2076 6172 6961 6e74 2c20 7072 6563  ", variant, prec
+0002ea20: 6973 696f 6e2c 2073 6361 6c65 290a 0a0a  ision, scale)...
+0002ea30: 6465 6620 6173 5f64 6f75 626c 6528 7661  def as_double(va
+0002ea40: 7269 616e 743a 2043 6f6c 756d 6e4f 724e  riant: ColumnOrN
+0002ea50: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+0002ea60: 2020 2020 2222 2243 6173 7473 2061 2056      """Casts a V
+0002ea70: 4152 4941 4e54 2076 616c 7565 2074 6f20  ARIANT value to 
+0002ea80: 6120 666c 6f61 7469 6e67 2d70 6f69 6e74  a floating-point
+0002ea90: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
+0002eaa0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+0002eab0: 3e3e 2064 6620 3d20 7365 7373 696f 6e2e  >> df = session.
+0002eac0: 7371 6c28 2273 656c 6563 7420 312e 3233  sql("select 1.23
+0002ead0: 3435 3a3a 7661 7269 616e 7420 6173 2061  45::variant as a
+0002eae0: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
+0002eaf0: 662e 7365 6c65 6374 2861 735f 646f 7562  f.select(as_doub
+0002eb00: 6c65 2822 6122 292e 616c 6961 7328 2272  le("a").alias("r
+0002eb10: 6573 756c 7422 2929 2e73 686f 7728 290a  esult")).show().
+0002eb20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002eb30: 2d2d 2d2d 0a20 2020 2020 2020 207c 2252  ----.        |"R
+0002eb40: 4553 554c 5422 2020 7c0a 2020 2020 2020  ESULT"  |.      
+0002eb50: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0002eb60: 2020 2020 2020 207c 312e 3233 3435 2020         |1.2345  
+0002eb70: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0002eb80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002eb90: 203c 424c 414e 4b4c 494e 453e 0a20 2020   <BLANKLINE>.   
+0002eba0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+0002ebb0: 5f63 6f6c 5f69 665f 7374 7228 7661 7269  _col_if_str(vari
+0002ebc0: 616e 742c 2022 6173 5f64 6f75 626c 6522  ant, "as_double"
+0002ebd0: 290a 2020 2020 7265 7475 726e 2062 7569  ).    return bui
+0002ebe0: 6c74 696e 2822 6173 5f64 6f75 626c 6522  ltin("as_double"
+0002ebf0: 2928 6329 0a0a 0a64 6566 2061 735f 7265  )(c)...def as_re
+0002ec00: 616c 2876 6172 6961 6e74 3a20 436f 6c75  al(variant: Colu
+0002ec10: 6d6e 4f72 4e61 6d65 2920 2d3e 2043 6f6c  mnOrName) -> Col
+0002ec20: 756d 6e3a 0a20 2020 2022 2222 4361 7374  umn:.    """Cast
+0002ec30: 7320 6120 5641 5249 414e 5420 7661 6c75  s a VARIANT valu
+0002ec40: 6520 746f 2061 2066 6c6f 6174 696e 672d  e to a floating-
+0002ec50: 706f 696e 7420 7661 6c75 652e 0a0a 2020  point value...  
+0002ec60: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0002ec70: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+0002ec80: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0002ec90: 2e74 7970 6573 2069 6d70 6f72 7420 5661  .types import Va
+0002eca0: 7269 616e 7454 7970 652c 2053 7472 7563  riantType, Struc
+0002ecb0: 7454 7970 652c 2053 7472 7563 7446 6965  tType, StructFie
+0002ecc0: 6c64 2c20 446f 7562 6c65 5479 7065 0a20  ld, DoubleType. 
+0002ecd0: 2020 2020 2020 203e 3e3e 2073 6368 656d         >>> schem
+0002ece0: 613d 5374 7275 6374 5479 7065 285b 5374  a=StructType([St
+0002ecf0: 7275 6374 4669 656c 6428 2272 6164 6975  ructField("radiu
+0002ed00: 7322 2c20 446f 7562 6c65 5479 7065 2829  s", DoubleType()
+0002ed10: 292c 2020 5374 7275 6374 4669 656c 6428  ),  StructField(
+0002ed20: 2272 6164 6975 735f 7622 2c20 5661 7269  "radius_v", Vari
+0002ed30: 616e 7454 7970 6528 2929 5d29 0a20 2020  antType())]).   
+0002ed40: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002ed50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+0002ed60: 6166 7261 6d65 2864 6174 613d 5b5b 322e  aframe(data=[[2.
+0002ed70: 302c 204e 6f6e 655d 5d2c 2073 6368 656d  0, None]], schem
+0002ed80: 613d 7363 6865 6d61 290a 2020 2020 2020  a=schema).      
+0002ed90: 2020 3e3e 3e20 6466 2e72 6164 6975 735f    >>> df.radius_
+0002eda0: 7620 3d20 746f 5f76 6172 6961 6e74 2864  v = to_variant(d
+0002edb0: 662e 7261 6469 7573 290a 2020 2020 2020  f.radius).      
+0002edc0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002edd0: 6466 2e72 6164 6975 735f 762e 6173 5f28  df.radius_v.as_(
+0002ede0: 2272 6164 6975 735f 7622 292c 2064 662e  "radius_v"), df.
+0002edf0: 7261 6469 7573 292e 636f 6c6c 6563 7428  radius).collect(
+0002ee00: 290a 2020 2020 2020 2020 5b52 6f77 2852  ).        [Row(R
+0002ee10: 4144 4955 535f 563d 2732 2e30 3030 3030  ADIUS_V='2.00000
+0002ee20: 3030 3030 3030 3030 3030 652b 3030 272c  0000000000e+00',
+0002ee30: 2052 4144 4955 533d 322e 3029 5d0a 2020   RADIUS=2.0)].  
+0002ee40: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0002ee50: 6563 7428 6173 5f72 6561 6c28 6466 2e72  ect(as_real(df.r
+0002ee60: 6164 6975 735f 7629 2e61 735f 2822 7265  adius_v).as_("re
+0002ee70: 616c 5f72 6164 6975 735f 7622 292c 2064  al_radius_v"), d
+0002ee80: 662e 7261 6469 7573 292e 636f 6c6c 6563  f.radius).collec
+0002ee90: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0002eea0: 2852 4541 4c5f 5241 4449 5553 5f56 3d32  (REAL_RADIUS_V=2
+0002eeb0: 2e30 2c20 5241 4449 5553 3d32 2e30 295d  .0, RADIUS=2.0)]
+0002eec0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0002eed0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002eee0: 7661 7269 616e 742c 2022 6173 5f72 6561  variant, "as_rea
+0002eef0: 6c22 290a 2020 2020 7265 7475 726e 2062  l").    return b
+0002ef00: 7569 6c74 696e 2822 6173 5f72 6561 6c22  uiltin("as_real"
+0002ef10: 2928 6329 0a0a 0a64 6566 2061 735f 696e  )(c)...def as_in
+0002ef20: 7465 6765 7228 7661 7269 616e 743a 2043  teger(variant: C
+0002ef30: 6f6c 756d 6e4f 724e 616d 6529 202d 3e20  olumnOrName) -> 
+0002ef40: 436f 6c75 6d6e 3a0a 2020 2020 2222 2243  Column:.    """C
+0002ef50: 6173 7473 2061 2056 4152 4941 4e54 2076  asts a VARIANT v
+0002ef60: 616c 7565 2074 6f20 616e 2069 6e74 6567  alue to an integ
+0002ef70: 6572 2e0a 0a20 2020 2045 7861 6d70 6c65  er...    Example
+0002ef80: 3a3a 0a20 2020 2020 2020 203e 3e3e 2064  ::.        >>> d
+0002ef90: 6620 3d20 7365 7373 696f 6e2e 7371 6c28  f = session.sql(
+0002efa0: 2273 656c 6563 7420 312e 3233 3435 3a3a  "select 1.2345::
+0002efb0: 7661 7269 616e 7420 6173 2061 2229 0a20  variant as a"). 
+0002efc0: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+0002efd0: 6c65 6374 2861 735f 696e 7465 6765 7228  lect(as_integer(
+0002efe0: 2261 2229 2e61 6c69 6173 2822 7265 7375  "a").alias("resu
+0002eff0: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+0002f000: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0002f010: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+0002f020: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+0002f030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0002f040: 2020 2020 7c31 2020 2020 2020 2020 207c      |1         |
+0002f050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002f060: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+0002f070: 4c41 4e4b 4c49 4e45 3e0a 2020 2020 2222  LANKLINE>.    ""
+0002f080: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+0002f090: 6c5f 6966 5f73 7472 2876 6172 6961 6e74  l_if_str(variant
+0002f0a0: 2c20 2261 735f 696e 7465 6765 7222 290a  , "as_integer").
+0002f0b0: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+0002f0c0: 696e 2822 6173 5f69 6e74 6567 6572 2229  in("as_integer")
+0002f0d0: 2863 290a 0a0a 6465 6620 6173 5f6f 626a  (c)...def as_obj
+0002f0e0: 6563 7428 7661 7269 616e 743a 2043 6f6c  ect(variant: Col
+0002f0f0: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+0002f100: 6c75 6d6e 3a0a 2020 2020 2222 2243 6173  lumn:.    """Cas
+0002f110: 7473 2061 2056 4152 4941 4e54 2076 616c  ts a VARIANT val
+0002f120: 7565 2074 6f20 616e 206f 626a 6563 742e  ue to an object.
+0002f130: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0002f140: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002f150: 2073 6573 7369 6f6e 2e73 716c 2822 7365   session.sql("se
+0002f160: 6c65 6374 206f 626a 6563 745f 636f 6e73  lect object_cons
+0002f170: 7472 7563 7428 2741 272c 312c 2742 272c  truct('A',1,'B',
+0002f180: 2742 4242 4227 293a 3a76 6172 6961 6e74  'BBBB')::variant
+0002f190: 2061 7320 6122 290a 2020 2020 2020 2020   as a").        
+0002f1a0: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
+0002f1b0: 5f6f 626a 6563 7428 2261 2229 2e61 6c69  _object("a").ali
+0002f1c0: 6173 2822 7265 7375 6c74 2229 292e 7368  as("result")).sh
+0002f1d0: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+0002f1e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0002f1f0: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0002f200: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+0002f210: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+0002f220: 2d2d 0a20 2020 2020 2020 207c 7b20 2020  --.        |{   
+0002f230: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+0002f240: 2020 2020 207c 2020 2241 223a 2031 2c20       |  "A": 1, 
+0002f250: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+0002f260: 2020 2242 223a 2022 4242 4242 2220 207c    "B": "BBBB"  |
+0002f270: 0a20 2020 2020 2020 207c 7d20 2020 2020  .        |}     
+0002f280: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+0002f290: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0002f2a0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+0002f2b0: 414e 4b4c 494e 453e 0a20 2020 2022 2222  ANKLINE>.    """
+0002f2c0: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+0002f2d0: 5f69 665f 7374 7228 7661 7269 616e 742c  _if_str(variant,
+0002f2e0: 2022 6173 5f6f 626a 6563 7422 290a 2020   "as_object").  
+0002f2f0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+0002f300: 2822 6173 5f6f 626a 6563 7422 2928 6329  ("as_object")(c)
+0002f310: 0a0a 0a64 6566 2061 735f 7469 6d65 2876  ...def as_time(v
+0002f320: 6172 6961 6e74 3a20 436f 6c75 6d6e 4f72  ariant: ColumnOr
+0002f330: 4e61 6d65 2920 2d3e 2043 6f6c 756d 6e3a  Name) -> Column:
+0002f340: 0a20 2020 2022 2222 4361 7374 7320 6120  .    """Casts a 
+0002f350: 5641 5249 414e 5420 7661 6c75 6520 746f  VARIANT value to
+0002f360: 2061 2074 696d 6520 7661 6c75 652e 0a0a   a time value...
+0002f370: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002f380: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0002f390: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0002f3a0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+0002f3b0: 6f72 7420 6173 5f74 696d 652c 2074 6f5f  ort as_time, to_
+0002f3c0: 7661 7269 616e 740a 2020 2020 2020 2020  variant.        
+0002f3d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0002f3e0: 2e73 716c 2822 7365 6c65 6374 2054 4f5f  .sql("select TO_
+0002f3f0: 5449 4d45 2827 3132 3a33 343a 3536 2729  TIME('12:34:56')
+0002f400: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
+0002f410: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
+0002f420: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
+0002f430: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
+0002f440: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002f450: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
+0002f460: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
+0002f470: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
+0002f480: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
+0002f490: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
+0002f4a0: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002f4b0: 2e73 656c 6563 7428 6173 5f74 696d 6528  .select(as_time(
+0002f4c0: 6466 2e61 6c61 726d 5f76 292e 6173 5f28  df.alarm_v).as_(
+0002f4d0: 2261 6c61 726d 2229 292e 636f 6c6c 6563  "alarm")).collec
+0002f4e0: 7428 2920 3d3d 2064 662e 7365 6c65 6374  t() == df.select
+0002f4f0: 2864 662e 616c 6172 6d29 2e63 6f6c 6c65  (df.alarm).colle
+0002f500: 6374 2829 0a20 2020 2020 2020 2054 7275  ct().        Tru
+0002f510: 650a 2020 2020 2222 220a 2020 2020 6320  e.    """.    c 
+0002f520: 3d20 5f74 6f5f 636f 6c5f 6966 5f73 7472  = _to_col_if_str
+0002f530: 2876 6172 6961 6e74 2c20 2261 735f 7469  (variant, "as_ti
+0002f540: 6d65 2229 0a20 2020 2072 6574 7572 6e20  me").    return 
+0002f550: 6275 696c 7469 6e28 2261 735f 7469 6d65  builtin("as_time
+0002f560: 2229 2863 290a 0a0a 6465 6620 6173 5f74  ")(c)...def as_t
+0002f570: 696d 6573 7461 6d70 5f6c 747a 2876 6172  imestamp_ltz(var
+0002f580: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
+0002f590: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002f5a0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
+0002f5b0: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
+0002f5c0: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
+0002f5d0: 6120 6c6f 6361 6c20 7469 6d65 7a6f 6e65  a local timezone
+0002f5e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+0002f5f0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+0002f600: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0002f610: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+0002f620: 696d 706f 7274 2061 735f 7469 6d65 7374  import as_timest
+0002f630: 616d 705f 6c74 7a2c 2074 6f5f 7661 7269  amp_ltz, to_vari
+0002f640: 616e 740a 2020 2020 2020 2020 3e3e 3e20  ant.        >>> 
+0002f650: 6466 203d 2073 6573 7369 6f6e 2e73 716c  df = session.sql
+0002f660: 2822 7365 6c65 6374 2054 4f5f 5449 4d45  ("select TO_TIME
+0002f670: 5354 414d 505f 4c54 5a28 2732 3031 382d  STAMP_LTZ('2018-
+0002f680: 3130 2d31 3020 3132 3a33 343a 3536 2729  10-10 12:34:56')
+0002f690: 2061 7320 616c 6172 6d22 290a 2020 2020   as alarm").    
+0002f6a0: 2020 2020 3e3e 3e20 6466 2e61 6c61 726d      >>> df.alarm
+0002f6b0: 5f76 203d 2074 6f5f 7661 7269 616e 7428  _v = to_variant(
+0002f6c0: 6466 2e61 6c61 726d 290a 2020 2020 2020  df.alarm).      
+0002f6d0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+0002f6e0: 6466 2e61 6c61 726d 5f76 2e61 735f 2822  df.alarm_v.as_("
+0002f6f0: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
+0002f700: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
+0002f710: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
+0002f720: 7428 290a 2020 2020 2020 2020 4661 6c73  t().        Fals
+0002f730: 650a 2020 2020 2020 2020 3e3e 3e20 6466  e.        >>> df
+0002f740: 2e73 656c 6563 7428 6173 5f74 696d 6573  .select(as_times
+0002f750: 7461 6d70 5f6c 747a 2864 662e 616c 6172  tamp_ltz(df.alar
+0002f760: 6d5f 7629 2e61 735f 2822 616c 6172 6d22  m_v).as_("alarm"
+0002f770: 2929 2e63 6f6c 6c65 6374 2829 203d 3d20  )).collect() == 
+0002f780: 6466 2e73 656c 6563 7428 6466 2e61 6c61  df.select(df.ala
+0002f790: 726d 292e 636f 6c6c 6563 7428 290a 2020  rm).collect().  
+0002f7a0: 2020 2020 2020 5472 7565 0a20 2020 2022        True.    "
+0002f7b0: 2222 0a20 2020 2063 203d 205f 746f 5f63  "".    c = _to_c
+0002f7c0: 6f6c 5f69 665f 7374 7228 7661 7269 616e  ol_if_str(varian
+0002f7d0: 742c 2022 6173 5f74 696d 6573 7461 6d70  t, "as_timestamp
+0002f7e0: 5f6c 747a 2229 0a20 2020 2072 6574 7572  _ltz").    retur
+0002f7f0: 6e20 6275 696c 7469 6e28 2261 735f 7469  n builtin("as_ti
+0002f800: 6d65 7374 616d 705f 6c74 7a22 2928 6329  mestamp_ltz")(c)
+0002f810: 0a0a 0a64 6566 2061 735f 7469 6d65 7374  ...def as_timest
+0002f820: 616d 705f 6e74 7a28 7661 7269 616e 743a  amp_ntz(variant:
+0002f830: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+0002f840: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+0002f850: 2243 6173 7473 2061 2056 4152 4941 4e54  "Casts a VARIANT
+0002f860: 2076 616c 7565 2074 6f20 6120 5449 4d45   value to a TIME
+0002f870: 5354 414d 5020 7769 7468 206e 6f20 7469  STAMP with no ti
+0002f880: 6d65 7a6f 6e65 2e0a 0a20 2020 2045 7861  mezone...    Exa
+0002f890: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+0002f8a0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+0002f8b0: 6b65 2e73 6e6f 7770 6172 6b2e 6675 6e63  ke.snowpark.func
+0002f8c0: 7469 6f6e 7320 696d 706f 7274 2061 735f  tions import as_
+0002f8d0: 7469 6d65 7374 616d 705f 6e74 7a2c 2074  timestamp_ntz, t
+0002f8e0: 6f5f 7661 7269 616e 740a 2020 2020 2020  o_variant.      
+0002f8f0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0002f900: 6f6e 2e73 716c 2822 7365 6c65 6374 2054  on.sql("select T
+0002f910: 4f5f 5449 4d45 5354 414d 505f 4e54 5a28  O_TIMESTAMP_NTZ(
+0002f920: 2732 3031 382d 3130 2d31 3020 3132 3a33  '2018-10-10 12:3
+0002f930: 343a 3536 2729 2061 7320 616c 6172 6d22  4:56') as alarm"
+0002f940: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+0002f950: 2e61 6c61 726d 5f76 203d 2074 6f5f 7661  .alarm_v = to_va
+0002f960: 7269 616e 7428 6466 2e61 6c61 726d 290a  riant(df.alarm).
+0002f970: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002f980: 656c 6563 7428 6466 2e61 6c61 726d 5f76  elect(df.alarm_v
+0002f990: 2e61 735f 2822 616c 6172 6d22 2929 2e63  .as_("alarm")).c
+0002f9a0: 6f6c 6c65 6374 2829 203d 3d20 6466 2e73  ollect() == df.s
+0002f9b0: 656c 6563 7428 6466 2e61 6c61 726d 292e  elect(df.alarm).
+0002f9c0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0002f9d0: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
+0002f9e0: 3e3e 3e20 6466 2e73 656c 6563 7428 6173  >>> df.select(as
+0002f9f0: 5f74 696d 6573 7461 6d70 5f6e 747a 2864  _timestamp_ntz(d
+0002fa00: 662e 616c 6172 6d5f 7629 2e61 735f 2822  f.alarm_v).as_("
+0002fa10: 616c 6172 6d22 2929 2e63 6f6c 6c65 6374  alarm")).collect
+0002fa20: 2829 203d 3d20 6466 2e73 656c 6563 7428  () == df.select(
+0002fa30: 6466 2e61 6c61 726d 292e 636f 6c6c 6563  df.alarm).collec
+0002fa40: 7428 290a 2020 2020 2020 2020 5472 7565  t().        True
+0002fa50: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+0002fa60: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+0002fa70: 7661 7269 616e 742c 2022 6173 5f74 696d  variant, "as_tim
+0002fa80: 6573 7461 6d70 5f6e 747a 2229 0a20 2020  estamp_ntz").   
+0002fa90: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+0002faa0: 2261 735f 7469 6d65 7374 616d 705f 6e74  "as_timestamp_nt
+0002fab0: 7a22 2928 6329 0a0a 0a64 6566 2061 735f  z")(c)...def as_
+0002fac0: 7469 6d65 7374 616d 705f 747a 2876 6172  timestamp_tz(var
+0002fad0: 6961 6e74 3a20 436f 6c75 6d6e 4f72 4e61  iant: ColumnOrNa
+0002fae0: 6d65 2920 2d3e 2043 6f6c 756d 6e3a 0a20  me) -> Column:. 
+0002faf0: 2020 2022 2222 4361 7374 7320 6120 5641     """Casts a VA
+0002fb00: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
+0002fb10: 2054 494d 4553 5441 4d50 2077 6974 6820   TIMESTAMP with 
+0002fb20: 6120 7469 6d65 7a6f 6e65 2e0a 0a20 2020  a timezone...   
+0002fb30: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0002fb40: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+0002fb50: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0002fb60: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+0002fb70: 2061 735f 7469 6d65 7374 616d 705f 747a   as_timestamp_tz
+0002fb80: 2c20 746f 5f76 6172 6961 6e74 0a20 2020  , to_variant.   
+0002fb90: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+0002fba0: 7373 696f 6e2e 7371 6c28 2273 656c 6563  ssion.sql("selec
+0002fbb0: 7420 544f 5f54 494d 4553 5441 4d50 5f54  t TO_TIMESTAMP_T
+0002fbc0: 5a28 2732 3031 382d 3130 2d31 3020 3132  Z('2018-10-10 12
+0002fbd0: 3a33 343a 3536 202b 3030 3030 2729 2061  :34:56 +0000') a
+0002fbe0: 7320 616c 6172 6d22 290a 2020 2020 2020  s alarm").      
+0002fbf0: 2020 3e3e 3e20 6466 2e61 6c61 726d 5f76    >>> df.alarm_v
+0002fc00: 203d 2074 6f5f 7661 7269 616e 7428 6466   = to_variant(df
+0002fc10: 2e61 6c61 726d 290a 2020 2020 2020 2020  .alarm).        
+0002fc20: 3e3e 3e20 6466 2e73 656c 6563 7428 6466  >>> df.select(df
+0002fc30: 2e61 6c61 726d 5f76 2e61 735f 2822 616c  .alarm_v.as_("al
+0002fc40: 6172 6d22 2929 2e63 6f6c 6c65 6374 2829  arm")).collect()
+0002fc50: 203d 3d20 6466 2e73 656c 6563 7428 6466   == df.select(df
+0002fc60: 2e61 6c61 726d 292e 636f 6c6c 6563 7428  .alarm).collect(
+0002fc70: 290a 2020 2020 2020 2020 4661 6c73 650a  ).        False.
+0002fc80: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0002fc90: 656c 6563 7428 6173 5f74 696d 6573 7461  elect(as_timesta
+0002fca0: 6d70 5f74 7a28 6466 2e61 6c61 726d 5f76  mp_tz(df.alarm_v
+0002fcb0: 292e 6173 5f28 2261 6c61 726d 2229 292e  ).as_("alarm")).
+0002fcc0: 636f 6c6c 6563 7428 2920 3d3d 2064 662e  collect() == df.
+0002fcd0: 7365 6c65 6374 2864 662e 616c 6172 6d29  select(df.alarm)
+0002fce0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+0002fcf0: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
+0002fd00: 2020 2020 6320 3d20 5f74 6f5f 636f 6c5f      c = _to_col_
+0002fd10: 6966 5f73 7472 2876 6172 6961 6e74 2c20  if_str(variant, 
+0002fd20: 2261 735f 7469 6d65 7374 616d 705f 747a  "as_timestamp_tz
+0002fd30: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+0002fd40: 696c 7469 6e28 2261 735f 7469 6d65 7374  iltin("as_timest
+0002fd50: 616d 705f 747a 2229 2863 290a 0a0a 6465  amp_tz")(c)...de
+0002fd60: 6620 746f 5f62 696e 6172 7928 653a 2043  f to_binary(e: C
+0002fd70: 6f6c 756d 6e4f 724e 616d 652c 2066 6d74  olumnOrName, fmt
+0002fd80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0002fd90: 3d20 4e6f 6e65 2920 2d3e 2043 6f6c 756d  = None) -> Colum
+0002fda0: 6e3a 0a20 2020 2022 2222 436f 6e76 6572  n:.    """Conver
+0002fdb0: 7473 2074 6865 2069 6e70 7574 2065 7870  ts the input exp
+0002fdc0: 7265 7373 696f 6e20 746f 2061 2062 696e  ression to a bin
+0002fdd0: 6172 7920 7661 6c75 652e 2046 6f72 204e  ary value. For N
+0002fde0: 554c 4c20 696e 7075 742c 2074 6865 206f  ULL input, the o
+0002fdf0: 7574 7075 7420 6973 204e 554c 4c2e 0a0a  utput is NULL...
+0002fe00: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0002fe10: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0002fe20: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0002fe30: 6174 6166 7261 6d65 285b 2730 3027 2c20  ataframe(['00', 
+0002fe40: 2736 3727 2c20 2730 3331 3227 5d2c 2073  '67', '0312'], s
+0002fe50: 6368 656d 613d 5b27 6127 5d29 0a20 2020  chema=['a']).   
+0002fe60: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0002fe70: 6374 2874 6f5f 6269 6e61 7279 2863 6f6c  ct(to_binary(col
+0002fe80: 2827 6127 2929 2e61 735f 2827 616e 7327  ('a')).as_('ans'
+0002fe90: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+0002fea0: 2020 2020 205b 526f 7728 414e 533d 6279       [Row(ANS=by
+0002feb0: 7465 6172 7261 7928 6227 5c5c 7830 3027  tearray(b'\\x00'
+0002fec0: 2929 2c20 526f 7728 414e 533d 6279 7465  )), Row(ANS=byte
+0002fed0: 6172 7261 7928 6227 6727 2929 2c20 526f  array(b'g')), Ro
+0002fee0: 7728 414e 533d 6279 7465 6172 7261 7928  w(ANS=bytearray(
+0002fef0: 6227 5c5c 7830 335c 5c78 3132 2729 295d  b'\\x03\\x12'))]
+0002ff00: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+0002ff10: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0002ff20: 655f 6461 7461 6672 616d 6528 5b27 6147  e_dataframe(['aG
+0002ff30: 5673 6247 383d 272c 2027 6432 3979 6247  VsbG8=', 'd29ybG
+0002ff40: 513d 272c 2027 4951 3d3d 275d 2c20 7363  Q=', 'IQ=='], sc
+0002ff50: 6865 6d61 3d5b 2761 275d 290a 2020 2020  hema=['a']).    
+0002ff60: 2020 2020 3e3e 3e20 6466 2e73 656c 6563      >>> df.selec
+0002ff70: 7428 746f 5f62 696e 6172 7928 636f 6c28  t(to_binary(col(
+0002ff80: 2761 2729 2c20 2742 4153 4536 3427 292e  'a'), 'BASE64').
+0002ff90: 6173 5f28 2761 6e73 2729 292e 636f 6c6c  as_('ans')).coll
+0002ffa0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+0002ffb0: 6f77 2841 4e53 3d62 7974 6561 7272 6179  ow(ANS=bytearray
+0002ffc0: 2862 2768 656c 6c6f 2729 292c 2052 6f77  (b'hello')), Row
+0002ffd0: 2841 4e53 3d62 7974 6561 7272 6179 2862  (ANS=bytearray(b
+0002ffe0: 2777 6f72 6c64 2729 292c 2052 6f77 2841  'world')), Row(A
+0002fff0: 4e53 3d62 7974 6561 7272 6179 2862 2721  NS=bytearray(b'!
+00030000: 2729 295d 0a0a 2020 2020 2020 2020 3e3e  '))]..        >>
+00030010: 3e20 6466 2e73 656c 6563 7428 746f 5f62  > df.select(to_b
+00030020: 696e 6172 7928 636f 6c28 2761 2729 2c20  inary(col('a'), 
+00030030: 2755 5446 2d38 2729 2e61 735f 2827 616e  'UTF-8').as_('an
+00030040: 7327 2929 2e63 6f6c 6c65 6374 2829 0a20  s')).collect(). 
+00030050: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00030060: 6279 7465 6172 7261 7928 6227 6147 5673  bytearray(b'aGVs
+00030070: 6247 383d 2729 292c 2052 6f77 2841 4e53  bG8=')), Row(ANS
+00030080: 3d62 7974 6561 7272 6179 2862 2764 3239  =bytearray(b'd29
+00030090: 7962 4751 3d27 2929 2c20 526f 7728 414e  ybGQ=')), Row(AN
+000300a0: 533d 6279 7465 6172 7261 7928 6227 4951  S=bytearray(b'IQ
+000300b0: 3d3d 2729 295d 0a20 2020 2022 2222 0a20  =='))].    """. 
+000300c0: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+000300d0: 665f 7374 7228 652c 2022 746f 5f62 696e  f_str(e, "to_bin
+000300e0: 6172 7922 290a 2020 2020 7265 7475 726e  ary").    return
+000300f0: 2062 7569 6c74 696e 2822 746f 5f62 696e   builtin("to_bin
+00030100: 6172 7922 2928 632c 2066 6d74 2920 6966  ary")(c, fmt) if
+00030110: 2066 6d74 2065 6c73 6520 6275 696c 7469   fmt else builti
+00030120: 6e28 2274 6f5f 6269 6e61 7279 2229 2863  n("to_binary")(c
+00030130: 290a 0a0a 6465 6620 746f 5f61 7272 6179  )...def to_array
+00030140: 2865 3a20 436f 6c75 6d6e 4f72 4e61 6d65  (e: ColumnOrName
+00030150: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00030160: 2022 2222 436f 6e76 6572 7473 2061 6e79   """Converts any
+00030170: 2076 616c 7565 2074 6f20 616e 2041 5252   value to an ARR
+00030180: 4159 2076 616c 7565 206f 7220 4e55 4c4c  AY value or NULL
+00030190: 2028 6966 2069 6e70 7574 2069 7320 4e55   (if input is NU
+000301a0: 4c4c 292e 0a0a 2020 2020 4578 616d 706c  LL)...    Exampl
+000301b0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+000301c0: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+000301d0: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+000301e0: 312c 2032 2c20 332c 2034 5d2c 2073 6368  1, 2, 3, 4], sch
+000301f0: 656d 613d 5b27 6127 5d29 0a20 2020 2020  ema=['a']).     
+00030200: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+00030210: 2874 6f5f 6172 7261 7928 636f 6c28 2761  (to_array(col('a
+00030220: 2729 292e 6173 5f28 2761 6e73 2729 292e  ')).as_('ans')).
+00030230: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00030240: 2020 5b52 6f77 2841 4e53 3d27 5b5c 5c6e    [Row(ANS='[\\n
+00030250: 2020 315c 5c6e 5d27 292c 2052 6f77 2841    1\\n]'), Row(A
+00030260: 4e53 3d27 5b5c 5c6e 2020 325c 5c6e 5d27  NS='[\\n  2\\n]'
+00030270: 292c 2052 6f77 2841 4e53 3d27 5b5c 5c6e  ), Row(ANS='[\\n
+00030280: 2020 335c 5c6e 5d27 292c 2052 6f77 2841    3\\n]'), Row(A
+00030290: 4e53 3d27 5b5c 5c6e 2020 345c 5c6e 5d27  NS='[\\n  4\\n]'
+000302a0: 295d 0a0a 0a20 2020 2020 2020 203e 3e3e  )]...        >>>
+000302b0: 2066 726f 6d20 736e 6f77 666c 616b 652e   from snowflake.
+000302c0: 736e 6f77 7061 726b 2069 6d70 6f72 7420  snowpark import 
+000302d0: 526f 770a 2020 2020 2020 2020 3e3e 3e20  Row.        >>> 
+000302e0: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+000302f0: 6174 655f 6461 7461 6672 616d 6528 5b52  ate_dataframe([R
+00030300: 6f77 2861 3d5b 312c 2032 2c20 335d 292c  ow(a=[1, 2, 3]),
+00030310: 2052 6f77 2861 3d4e 6f6e 6529 5d29 0a20   Row(a=None)]). 
+00030320: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00030330: 6c65 6374 2874 6f5f 6172 7261 7928 636f  lect(to_array(co
+00030340: 6c28 2761 2729 292e 6173 5f28 2761 6e73  l('a')).as_('ans
+00030350: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
+00030360: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
+00030370: 5b5c 5c6e 2020 312c 5c5c 6e20 2032 2c5c  [\\n  1,\\n  2,\
+00030380: 5c6e 2020 335c 5c6e 5d27 292c 2052 6f77  \n  3\\n]'), Row
+00030390: 2841 4e53 3d4e 6f6e 6529 5d0a 2020 2020  (ANS=None)].    
+000303a0: 2222 220a 2020 2020 6320 3d20 5f74 6f5f  """.    c = _to_
+000303b0: 636f 6c5f 6966 5f73 7472 2865 2c20 2274  col_if_str(e, "t
+000303c0: 6f5f 6172 7261 7922 290a 2020 2020 7265  o_array").    re
+000303d0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
+000303e0: 5f61 7272 6179 2229 2863 290a 0a0a 6465  _array")(c)...de
+000303f0: 6620 746f 5f6a 736f 6e28 653a 2043 6f6c  f to_json(e: Col
+00030400: 756d 6e4f 724e 616d 6529 202d 3e20 436f  umnOrName) -> Co
+00030410: 6c75 6d6e 3a0a 2020 2020 2222 2243 6f6e  lumn:.    """Con
+00030420: 7665 7274 7320 616e 7920 5641 5249 414e  verts any VARIAN
+00030430: 5420 7661 6c75 6520 746f 2061 2073 7472  T value to a str
+00030440: 696e 6720 636f 6e74 6169 6e69 6e67 2074  ing containing t
+00030450: 6865 204a 534f 4e20 7265 7072 6573 656e  he JSON represen
+00030460: 7461 7469 6f6e 206f 6620 7468 650a 2020  tation of the.  
+00030470: 2020 7661 6c75 652e 2049 6620 7468 6520    value. If the 
+00030480: 696e 7075 7420 6973 204e 554c 4c2c 2074  input is NULL, t
+00030490: 6865 2072 6573 756c 7420 6973 2061 6c73  he result is als
+000304a0: 6f20 4e55 4c4c 2e0a 0a20 2020 2045 7861  o NULL...    Exa
+000304b0: 6d70 6c65 3a3a 0a20 2020 2020 2020 203e  mple::.        >
+000304c0: 3e3e 2066 726f 6d20 736e 6f77 666c 616b  >> from snowflak
+000304d0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+000304e0: 2069 6d70 6f72 7420 5661 7269 616e 7454   import VariantT
+000304f0: 7970 652c 2053 7472 7563 7446 6965 6c64  ype, StructField
+00030500: 2c20 5374 7275 6374 5479 7065 0a20 2020  , StructType.   
+00030510: 2020 2020 203e 3e3e 2066 726f 6d20 736e       >>> from sn
+00030520: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00030530: 2069 6d70 6f72 7420 526f 770a 2020 2020   import Row.    
+00030540: 2020 2020 3e3e 3e20 7363 6865 6d61 203d      >>> schema =
+00030550: 2053 7472 7563 7454 7970 6528 5b53 7472   StructType([Str
+00030560: 7563 7446 6965 6c64 2822 6122 2c20 5661  uctField("a", Va
+00030570: 7269 616e 7454 7970 6528 2929 5d29 0a20  riantType())]). 
+00030580: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00030590: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000305a0: 6174 6166 7261 6d65 285b 526f 7728 613d  ataframe([Row(a=
+000305b0: 4e6f 6e65 292c 526f 7728 613d 3132 292c  None),Row(a=12),
+000305c0: 526f 7728 613d 332e 3134 3129 2c52 6f77  Row(a=3.141),Row
+000305d0: 2861 3d7b 2761 273a 3130 2c27 6227 3a32  (a={'a':10,'b':2
+000305e0: 307d 292c 526f 7728 613d 5b31 2c32 332c  0}),Row(a=[1,23,
+000305f0: 3435 365d 295d 2c20 7363 6865 6d61 3d73  456])], schema=s
+00030600: 6368 656d 6129 0a20 2020 2020 2020 203e  chema).        >
+00030610: 3e3e 2064 662e 7365 6c65 6374 2874 6f5f  >> df.select(to_
+00030620: 6a73 6f6e 2863 6f6c 2822 6122 2929 2e61  json(col("a")).a
+00030630: 735f 2827 616e 7327 2929 2e63 6f6c 6c65  s_('ans')).colle
+00030640: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00030650: 7728 414e 533d 4e6f 6e65 292c 2052 6f77  w(ANS=None), Row
+00030660: 2841 4e53 3d27 3132 2729 2c20 526f 7728  (ANS='12'), Row(
+00030670: 414e 533d 2733 2e31 3431 2729 2c20 526f  ANS='3.141'), Ro
+00030680: 7728 414e 533d 277b 2261 223a 3130 2c22  w(ANS='{"a":10,"
+00030690: 6222 3a32 307d 2729 2c20 526f 7728 414e  b":20}'), Row(AN
+000306a0: 533d 275b 312c 3233 2c34 3536 5d27 295d  S='[1,23,456]')]
+000306b0: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+000306c0: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+000306d0: 652c 2022 746f 5f6a 736f 6e22 290a 2020  e, "to_json").  
+000306e0: 2020 7265 7475 726e 2062 7569 6c74 696e    return builtin
+000306f0: 2822 746f 5f6a 736f 6e22 2928 6329 0a0a  ("to_json")(c)..
+00030700: 0a64 6566 2074 6f5f 6f62 6a65 6374 2865  .def to_object(e
+00030710: 3a20 436f 6c75 6d6e 4f72 4e61 6d65 2920  : ColumnOrName) 
+00030720: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+00030730: 2222 436f 6e76 6572 7473 2061 6e79 2076  ""Converts any v
+00030740: 616c 7565 2074 6f20 6120 4f42 4a45 4354  alue to a OBJECT
+00030750: 2076 616c 7565 206f 7220 4e55 4c4c 2028   value or NULL (
+00030760: 6966 2069 6e70 7574 2069 7320 4e55 4c4c  if input is NULL
+00030770: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
+00030780: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+00030790: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+000307a0: 7770 6172 6b2e 7479 7065 7320 696d 706f  wpark.types impo
+000307b0: 7274 2056 6172 6961 6e74 5479 7065 2c20  rt VariantType, 
+000307c0: 5374 7275 6374 4669 656c 642c 2053 7472  StructField, Str
+000307d0: 7563 7454 7970 650a 2020 2020 2020 2020  uctType.        
+000307e0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+000307f0: 6b65 2e73 6e6f 7770 6172 6b20 696d 706f  ke.snowpark impo
+00030800: 7274 2052 6f77 0a20 2020 2020 2020 203e  rt Row.        >
+00030810: 3e3e 2073 6368 656d 6120 3d20 5374 7275  >> schema = Stru
+00030820: 6374 5479 7065 285b 5374 7275 6374 4669  ctType([StructFi
+00030830: 656c 6428 2261 222c 2056 6172 6961 6e74  eld("a", Variant
+00030840: 5479 7065 2829 295d 290a 2020 2020 2020  Type())]).      
+00030850: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00030860: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00030870: 616d 6528 5b22 7b27 6127 3a31 302c 2762  ame(["{'a':10,'b
+00030880: 273a 3230 7d22 2c20 4e6f 6e65 5d2c 2073  ':20}", None], s
+00030890: 6368 656d 613d 7363 6865 6d61 290a 2020  chema=schema).  
+000308a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000308b0: 6563 7428 746f 5f6f 626a 6563 7428 636f  ect(to_object(co
+000308c0: 6c28 2261 2229 292e 6173 5f28 2761 6e73  l("a")).as_('ans
+000308d0: 2729 292e 636f 6c6c 6563 7428 290a 2020  ')).collect().  
+000308e0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
+000308f0: 7b5c 5c6e 2020 2261 223a 2031 302c 5c5c  {\\n  "a": 10,\\
+00030900: 6e20 2022 6222 3a20 3230 5c5c 6e7d 2729  n  "b": 20\\n}')
+00030910: 2c20 526f 7728 414e 533d 4e6f 6e65 295d  , Row(ANS=None)]
+00030920: 0a20 2020 2022 2222 0a20 2020 2063 203d  .    """.    c =
+00030930: 205f 746f 5f63 6f6c 5f69 665f 7374 7228   _to_col_if_str(
+00030940: 652c 2022 746f 5f6f 626a 6563 7422 290a  e, "to_object").
+00030950: 2020 2020 7265 7475 726e 2062 7569 6c74      return built
+00030960: 696e 2822 746f 5f6f 626a 6563 7422 2928  in("to_object")(
+00030970: 6329 0a0a 0a64 6566 2074 6f5f 7661 7269  c)...def to_vari
+00030980: 616e 7428 653a 2043 6f6c 756d 6e4f 724e  ant(e: ColumnOrN
+00030990: 616d 6529 202d 3e20 436f 6c75 6d6e 3a0a  ame) -> Column:.
+000309a0: 2020 2020 2222 2243 6f6e 7665 7274 7320      """Converts 
+000309b0: 616e 7920 7661 6c75 6520 746f 2061 2056  any value to a V
+000309c0: 4152 4941 4e54 2076 616c 7565 206f 7220  ARIANT value or 
+000309d0: 4e55 4c4c 2028 6966 2069 6e70 7574 2069  NULL (if input i
+000309e0: 7320 4e55 4c4c 292e 0a0a 2020 2020 4578  s NULL)...    Ex
+000309f0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00030a00: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+00030a10: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+00030a20: 6d65 285b 312c 2032 2c20 332c 2034 5d2c  me([1, 2, 3, 4],
+00030a30: 2073 6368 656d 613d 5b27 6127 5d29 0a20   schema=['a']). 
+00030a40: 2020 2020 2020 203e 3e3e 2064 665f 636f         >>> df_co
+00030a50: 6e76 203d 2064 662e 7365 6c65 6374 2874  nv = df.select(t
+00030a60: 6f5f 7661 7269 616e 7428 636f 6c28 2261  o_variant(col("a
+00030a70: 2229 292e 6173 5f28 2261 6e73 2229 290a  ")).as_("ans")).
+00030a80: 2020 2020 2020 2020 3e3e 3e20 6466 5f63          >>> df_c
+00030a90: 6f6e 762e 636f 6c6c 6563 7428 290a 2020  onv.collect().  
+00030aa0: 2020 2020 2020 5b52 6f77 2841 4e53 3d27        [Row(ANS='
+00030ab0: 3127 292c 2052 6f77 2841 4e53 3d27 3227  1'), Row(ANS='2'
+00030ac0: 292c 2052 6f77 2841 4e53 3d27 3327 292c  ), Row(ANS='3'),
+00030ad0: 2052 6f77 2841 4e53 3d27 3427 295d 0a0a   Row(ANS='4')]..
+00030ae0: 2020 2020 2020 2020 4166 7465 7220 636f          After co
+00030af0: 6e76 6572 7369 6f6e 2076 6961 2074 6f5f  nversion via to_
+00030b00: 7661 7269 616e 742c 2061 6e6f 7468 6572  variant, another
+00030b10: 2076 6172 6961 6e74 2064 6174 6166 7261   variant datafra
+00030b20: 6d65 2063 616e 2062 6520 6d65 7267 6564  me can be merged
+00030b30: 2e0a 0a20 2020 2020 2020 203e 3e3e 2066  ...        >>> f
+00030b40: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00030b50: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+00030b60: 6f72 7420 5661 7269 616e 7454 7970 652c  ort VariantType,
+00030b70: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
+00030b80: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
+00030b90: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+00030ba0: 616b 652e 736e 6f77 7061 726b 2069 6d70  ake.snowpark imp
+00030bb0: 6f72 7420 526f 770a 2020 2020 2020 2020  ort Row.        
+00030bc0: 3e3e 3e20 7363 6865 6d61 203d 2053 7472  >>> schema = Str
+00030bd0: 7563 7454 7970 6528 5b53 7472 7563 7446  uctType([StructF
+00030be0: 6965 6c64 2822 6122 2c20 5661 7269 616e  ield("a", Varian
+00030bf0: 7454 7970 6528 2929 5d29 0a20 2020 2020  tType())]).     
+00030c00: 2020 203e 3e3e 2064 665f 6f74 6865 7220     >>> df_other 
+00030c10: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+00030c20: 5f64 6174 6166 7261 6d65 285b 526f 7728  _dataframe([Row(
+00030c30: 613d 3130 292c 2052 6f77 2861 3d27 7465  a=10), Row(a='te
+00030c40: 7374 2729 2c20 526f 7728 613d 7b27 6127  st'), Row(a={'a'
+00030c50: 3a20 3130 2c20 2762 273a 2032 307d 292c  : 10, 'b': 20}),
+00030c60: 2052 6f77 2861 3d5b 312c 2032 2c20 335d   Row(a=[1, 2, 3]
+00030c70: 295d 2c20 7363 6865 6d61 3d73 6368 656d  )], schema=schem
+00030c80: 6129 0a20 2020 2020 2020 203e 3e3e 2064  a).        >>> d
+00030c90: 665f 636f 6e76 2e75 6e69 6f6e 2864 665f  f_conv.union(df_
+00030ca0: 6f74 6865 7229 2e73 656c 6563 7428 7479  other).select(ty
+00030cb0: 7065 6f66 2863 6f6c 2822 616e 7322 2929  peof(col("ans"))
+00030cc0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
+00030cd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00030ce0: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
+00030cf0: 2729 2c20 526f 7728 414e 533d 2749 4e54  '), Row(ANS='INT
+00030d00: 4547 4552 2729 2c20 526f 7728 414e 533d  EGER'), Row(ANS=
+00030d10: 2749 4e54 4547 4552 2729 2c20 526f 7728  'INTEGER'), Row(
+00030d20: 414e 533d 2749 4e54 4547 4552 2729 2c20  ANS='INTEGER'), 
+00030d30: 526f 7728 414e 533d 2749 4e54 4547 4552  Row(ANS='INTEGER
+00030d40: 2729 2c20 526f 7728 414e 533d 2756 4152  '), Row(ANS='VAR
+00030d50: 4348 4152 2729 2c20 526f 7728 414e 533d  CHAR'), Row(ANS=
+00030d60: 274f 424a 4543 5427 292c 2052 6f77 2841  'OBJECT'), Row(A
+00030d70: 4e53 3d27 4152 5241 5927 295d 0a20 2020  NS='ARRAY')].   
+00030d80: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00030d90: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00030da0: 746f 5f76 6172 6961 6e74 2229 0a20 2020  to_variant").   
+00030db0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+00030dc0: 2274 6f5f 7661 7269 616e 7422 2928 6329  "to_variant")(c)
+00030dd0: 0a0a 0a64 6566 2074 6f5f 786d 6c28 653a  ...def to_xml(e:
+00030de0: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00030df0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00030e00: 2243 6f6e 7665 7274 7320 616e 7920 5641  "Converts any VA
+00030e10: 5249 414e 5420 7661 6c75 6520 746f 2061  RIANT value to a
+00030e20: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
+00030e30: 6e67 2074 6865 2058 4d4c 2072 6570 7265  ng the XML repre
+00030e40: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
+00030e50: 0a20 2020 2076 616c 7565 2e20 4966 2074  .    value. If t
+00030e60: 6865 2069 6e70 7574 2069 7320 4e55 4c4c  he input is NULL
+00030e70: 2c20 7468 6520 7265 7375 6c74 2069 7320  , the result is 
+00030e80: 616c 736f 204e 554c 4c2e 0a0a 2020 2020  also NULL...    
+00030e90: 4578 616d 706c 653a 3a0a 2020 2020 2020  Example::.      
+00030ea0: 2020 3e3e 3e20 6672 6f6d 2073 6e6f 7766    >>> from snowf
+00030eb0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7479  lake.snowpark.ty
+00030ec0: 7065 7320 696d 706f 7274 2056 6172 6961  pes import Varia
+00030ed0: 6e74 5479 7065 2c20 5374 7275 6374 4669  ntType, StructFi
+00030ee0: 656c 642c 2053 7472 7563 7454 7970 650a  eld, StructType.
+00030ef0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00030f00: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00030f10: 6172 6b20 696d 706f 7274 2052 6f77 0a20  ark import Row. 
+00030f20: 2020 2020 2020 203e 3e3e 2073 6368 656d         >>> schem
+00030f30: 6120 3d20 5374 7275 6374 5479 7065 285b  a = StructType([
+00030f40: 5374 7275 6374 4669 656c 6428 2261 222c  StructField("a",
+00030f50: 2056 6172 6961 6e74 5479 7065 2829 295d   VariantType())]
+00030f60: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00030f70: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+00030f80: 655f 6461 7461 6672 616d 6528 5b52 6f77  e_dataframe([Row
+00030f90: 2861 3d31 3029 2c20 526f 7728 613d 2774  (a=10), Row(a='t
+00030fa0: 6573 7427 292c 2052 6f77 2861 3d7b 2761  est'), Row(a={'a
+00030fb0: 273a 2031 302c 2027 6227 3a20 3230 7d29  ': 10, 'b': 20})
+00030fc0: 2c20 526f 7728 613d 5b31 2c20 322c 2033  , Row(a=[1, 2, 3
+00030fd0: 5d29 5d2c 2073 6368 656d 613d 7363 6865  ])], schema=sche
+00030fe0: 6d61 290a 2020 2020 2020 2020 3e3e 3e20  ma).        >>> 
+00030ff0: 6466 2e73 656c 6563 7428 746f 5f78 6d6c  df.select(to_xml
+00031000: 2863 6f6c 2822 4122 2929 2e61 735f 2822  (col("A")).as_("
+00031010: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
+00031020: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
+00031030: 533d 273c 536e 6f77 666c 616b 6544 6174  S='<SnowflakeDat
+00031040: 6120 7479 7065 3d22 494e 5445 4745 5222  a type="INTEGER"
+00031050: 3e31 303c 2f53 6e6f 7766 6c61 6b65 4461  >10</SnowflakeDa
+00031060: 7461 3e27 292c 2052 6f77 2841 4e53 3d27  ta>'), Row(ANS='
+00031070: 3c53 6e6f 7766 6c61 6b65 4461 7461 2074  <SnowflakeData t
+00031080: 7970 653d 2256 4152 4348 4152 223e 7465  ype="VARCHAR">te
+00031090: 7374 3c2f 536e 6f77 666c 616b 6544 6174  st</SnowflakeDat
+000310a0: 613e 2729 2c20 526f 7728 414e 533d 273c  a>'), Row(ANS='<
+000310b0: 536e 6f77 666c 616b 6544 6174 6120 7479  SnowflakeData ty
+000310c0: 7065 3d22 4f42 4a45 4354 223e 3c61 2074  pe="OBJECT"><a t
+000310d0: 7970 653d 2249 4e54 4547 4552 223e 3130  ype="INTEGER">10
+000310e0: 3c2f 613e 3c62 2074 7970 653d 2249 4e54  </a><b type="INT
+000310f0: 4547 4552 223e 3230 3c2f 623e 3c2f 536e  EGER">20</b></Sn
+00031100: 6f77 666c 616b 6544 6174 613e 2729 2c20  owflakeData>'), 
+00031110: 526f 7728 414e 533d 273c 536e 6f77 666c  Row(ANS='<Snowfl
+00031120: 616b 6544 6174 6120 7479 7065 3d22 4152  akeData type="AR
+00031130: 5241 5922 3e3c 6520 7479 7065 3d22 494e  RAY"><e type="IN
+00031140: 5445 4745 5222 3e31 3c2f 653e 3c65 2074  TEGER">1</e><e t
+00031150: 7970 653d 2249 4e54 4547 4552 223e 323c  ype="INTEGER">2<
+00031160: 2f65 3e3c 6520 7479 7065 3d22 494e 5445  /e><e type="INTE
+00031170: 4745 5222 3e33 3c2f 653e 3c2f 536e 6f77  GER">3</e></Snow
+00031180: 666c 616b 6544 6174 613e 2729 5d0a 2020  flakeData>')].  
+00031190: 2020 2222 220a 2020 2020 6320 3d20 5f74    """.    c = _t
+000311a0: 6f5f 636f 6c5f 6966 5f73 7472 2865 2c20  o_col_if_str(e, 
+000311b0: 2274 6f5f 786d 6c22 290a 2020 2020 7265  "to_xml").    re
+000311c0: 7475 726e 2062 7569 6c74 696e 2822 746f  turn builtin("to
+000311d0: 5f78 6d6c 2229 2863 290a 0a0a 6465 6620  _xml")(c)...def 
+000311e0: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
+000311f0: 6f62 6a3a 2043 6f6c 756d 6e4f 724e 616d  obj: ColumnOrNam
+00031200: 652c 2066 6965 6c64 3a20 436f 6c75 6d6e  e, field: Column
+00031210: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00031220: 6e3a 0a20 2020 2022 2222 0a20 2020 2045  n:.    """.    E
+00031230: 7874 7261 6374 7320 6120 6669 656c 6420  xtracts a field 
+00031240: 7661 6c75 6520 6672 6f6d 2061 6e20 6f62  value from an ob
+00031250: 6a65 6374 2e20 5265 7475 726e 7320 4e55  ject. Returns NU
+00031260: 4c4c 2069 6620 6569 7468 6572 206f 6620  LL if either of 
+00031270: 7468 6520 6172 6775 6d65 6e74 7320 6973  the arguments is
+00031280: 204e 554c 4c2e 0a20 2020 2054 6869 7320   NULL..    This 
+00031290: 6675 6e63 7469 6f6e 2069 7320 7369 6d69  function is simi
+000312a0: 6c61 7220 746f 203a 6d65 7468 3a60 6765  lar to :meth:`ge
+000312b0: 7460 2062 7574 2061 7070 6c69 6573 2063  t` but applies c
+000312c0: 6173 652d 696e 7365 6e73 6974 6976 6520  ase-insensitive 
+000312d0: 6d61 7463 6869 6e67 2074 6f20 6669 656c  matching to fiel
+000312e0: 6420 6e61 6d65 732e 0a0a 2020 2020 4578  d names...    Ex
+000312f0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
+00031300: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00031310: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00031320: 616d 6528 5b7b 2261 223a 207b 2261 6122  ame([{"a": {"aa"
+00031330: 3a20 312c 2022 6262 223a 2032 2c20 2263  : 1, "bb": 2, "c
+00031340: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
+00031350: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00031360: 6765 745f 6967 6e6f 7265 5f63 6173 6528  get_ignore_case(
+00031370: 6466 5b22 6122 5d2c 206c 6974 2822 4141  df["a"], lit("AA
+00031380: 2229 292e 616c 6961 7328 2267 6574 5f69  ")).alias("get_i
+00031390: 676e 6f72 655f 6361 7365 2229 292e 636f  gnore_case")).co
+000313a0: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+000313b0: 5b52 6f77 2847 4554 5f49 474e 4f52 455f  [Row(GET_IGNORE_
+000313c0: 4341 5345 3d27 3127 295d 0a20 2020 2022  CASE='1')].    "
+000313d0: 2222 0a20 2020 2063 3120 3d20 5f74 6f5f  "".    c1 = _to_
+000313e0: 636f 6c5f 6966 5f73 7472 286f 626a 2c20  col_if_str(obj, 
+000313f0: 2267 6574 5f69 676e 6f72 655f 6361 7365  "get_ignore_case
+00031400: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
+00031410: 636f 6c5f 6966 5f73 7472 2866 6965 6c64  col_if_str(field
+00031420: 2c20 2267 6574 5f69 676e 6f72 655f 6361  , "get_ignore_ca
+00031430: 7365 2229 0a20 2020 2072 6574 7572 6e20  se").    return 
+00031440: 6275 696c 7469 6e28 2267 6574 5f69 676e  builtin("get_ign
+00031450: 6f72 655f 6361 7365 2229 2863 312c 2063  ore_case")(c1, c
+00031460: 3229 0a0a 0a64 6566 206f 626a 6563 745f  2)...def object_
+00031470: 6b65 7973 286f 626a 3a20 436f 6c75 6d6e  keys(obj: Column
+00031480: 4f72 4e61 6d65 2920 2d3e 2043 6f6c 756d  OrName) -> Colum
+00031490: 6e3a 0a20 2020 2022 2222 5265 7475 726e  n:.    """Return
+000314a0: 7320 616e 2061 7272 6179 2063 6f6e 7461  s an array conta
+000314b0: 696e 696e 6720 7468 6520 6c69 7374 206f  ining the list o
+000314c0: 6620 6b65 7973 2069 6e20 7468 6520 696e  f keys in the in
+000314d0: 7075 7420 6f62 6a65 6374 2e0a 0a0a 2020  put object....  
+000314e0: 2020 4578 616d 706c 653a 3a0a 2020 2020    Example::.    
+000314f0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6e6f      >>> from sno
+00031500: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00031510: 6675 6e63 7469 6f6e 7320 696d 706f 7274  functions import
+00031520: 206c 6974 0a20 2020 2020 2020 203e 3e3e   lit.        >>>
+00031530: 2064 6620 3d20 7365 7373 696f 6e2e 7371   df = session.sq
+00031540: 6c28 0a20 2020 2020 2020 202e 2e2e 2020  l(.        ...  
+00031550: 2020 2022 7365 6c65 6374 206f 626a 6563     "select objec
+00031560: 745f 636f 6e73 7472 7563 7428 612c 622c  t_construct(a,b,
+00031570: 632c 642c 652c 6629 2061 7320 6f62 6a2c  c,d,e,f) as obj,
+00031580: 206b 2c20 7620 6672 6f6d 2022 0a20 2020   k, v from ".   
+00031590: 2020 2020 202e 2e2e 2020 2020 2022 7661       ...     "va
+000315a0: 6c75 6573 2827 6167 6527 2c20 3231 2c20  lues('age', 21, 
+000315b0: 277a 6970 272c 2032 3130 3231 2c20 276e  'zip', 21021, 'n
+000315c0: 616d 6527 2c20 274a 6f65 272c 2027 6167  ame', 'Joe', 'ag
+000315d0: 6527 2c20 3029 2c22 0a20 2020 2020 2020  e', 0),".       
+000315e0: 202e 2e2e 2020 2020 2022 2827 6167 6527   ...     "('age'
+000315f0: 2c20 3236 2c20 277a 6970 272c 2039 3430  , 26, 'zip', 940
+00031600: 3231 2c20 276e 616d 6527 2c20 274a 6179  21, 'name', 'Jay
+00031610: 272c 2027 6167 6527 2c20 3029 2061 7320  ', 'age', 0) as 
+00031620: 5428 612c 622c 632c 642c 652c 662c 6b2c  T(a,b,c,d,e,f,k,
+00031630: 7629 220a 2020 2020 2020 2020 2e2e 2e20  v)".        ... 
+00031640: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+00031650: 2e73 656c 6563 7428 6f62 6a65 6374 5f6b  .select(object_k
+00031660: 6579 7328 636f 6c28 226f 626a 2229 292e  eys(col("obj")).
+00031670: 616c 6961 7328 2272 6573 756c 7422 2929  alias("result"))
+00031680: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+00031690: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+000316a0: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+000316b0: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+000316c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000316d0: 2020 7c5b 2020 2020 2020 2020 2020 7c0a    |[          |.
+000316e0: 2020 2020 2020 2020 7c20 2022 6167 6522          |  "age"
+000316f0: 2c20 2020 7c0a 2020 2020 2020 2020 7c20  ,   |.        | 
+00031700: 2022 6e61 6d65 222c 2020 7c0a 2020 2020   "name",  |.    
+00031710: 2020 2020 7c20 2022 7a69 7022 2020 2020      |  "zip"    
+00031720: 7c0a 2020 2020 2020 2020 7c5d 2020 2020  |.        |]    
+00031730: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+00031740: 7c5b 2020 2020 2020 2020 2020 7c0a 2020  |[          |.  
+00031750: 2020 2020 2020 7c20 2022 6167 6522 2c20        |  "age", 
+00031760: 2020 7c0a 2020 2020 2020 2020 7c20 2022    |.        |  "
+00031770: 6e61 6d65 222c 2020 7c0a 2020 2020 2020  name",  |.      
+00031780: 2020 7c20 2022 7a69 7022 2020 2020 7c0a    |  "zip"    |.
+00031790: 2020 2020 2020 2020 7c5d 2020 2020 2020          |]      
+000317a0: 2020 2020 7c0a 2020 2020 2020 2020 2d2d      |.        --
+000317b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+000317c0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+000317d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+000317e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 286f  _to_col_if_str(o
+000317f0: 626a 2c20 226f 626a 6563 745f 6b65 7973  bj, "object_keys
+00031800: 2229 0a20 2020 2072 6574 7572 6e20 6275  ").    return bu
+00031810: 696c 7469 6e28 226f 626a 6563 745f 6b65  iltin("object_ke
+00031820: 7973 2229 2863 290a 0a0a 6465 6620 786d  ys")(c)...def xm
+00031830: 6c67 6574 280a 2020 2020 786d 6c3a 2043  lget(.    xml: C
+00031840: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
+00031850: 2074 6167 3a20 436f 6c75 6d6e 4f72 4e61   tag: ColumnOrNa
+00031860: 6d65 2c0a 2020 2020 696e 7374 616e 6365  me,.    instance
+00031870: 5f6e 756d 3a20 556e 696f 6e5b 436f 6c75  _num: Union[Colu
+00031880: 6d6e 4f72 4e61 6d65 2c20 696e 745d 203d  mnOrName, int] =
+00031890: 2030 2c0a 2920 2d3e 2043 6f6c 756d 6e3a   0,.) -> Column:
+000318a0: 0a20 2020 2022 2222 4578 7472 6163 7473  .    """Extracts
+000318b0: 2061 6e20 584d 4c20 656c 656d 656e 7420   an XML element 
+000318c0: 6f62 6a65 6374 2028 6f66 7465 6e20 7265  object (often re
+000318d0: 6665 7272 6564 2074 6f20 6173 2073 696d  ferred to as sim
+000318e0: 706c 7920 6120 7461 6729 2066 726f 6d20  ply a tag) from 
+000318f0: 6120 636f 6e74 656e 7420 6f66 206f 7574  a content of out
+00031900: 6572 0a20 2020 2058 4d4c 2065 6c65 6d65  er.    XML eleme
+00031910: 6e74 206f 626a 6563 7420 6279 2074 6865  nt object by the
+00031920: 206e 616d 6520 6f66 2074 6865 2074 6167   name of the tag
+00031930: 2061 6e64 2069 7473 2069 6e73 7461 6e63   and its instanc
+00031940: 6520 6e75 6d62 6572 2028 636f 756e 7469  e number (counti
+00031950: 6e67 2066 726f 6d20 3029 2e0a 0a20 2020  ng from 0)...   
+00031960: 2054 6865 2066 6f6c 6c6f 7769 6e67 2065   The following e
+00031970: 7861 6d70 6c65 2072 6574 7572 6e73 2074  xample returns t
+00031980: 6865 2066 6972 7374 2069 6e6e 6572 206c  he first inner l
+00031990: 6576 656c 2028 6c65 7665 6c32 2920 6672  evel (level2) fr
+000319a0: 6f6d 2074 6865 2058 4d4c 206f 626a 6563  om the XML objec
+000319b0: 7420 6372 6561 7465 6420 7669 6120 6070  t created via `p
+000319c0: 6172 7365 5f78 6d6c 602e 0a0a 2020 2020  arse_xml`...    
+000319d0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+000319e0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000319f0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+00031a00: 7261 6d65 285b 273c 6c65 7665 6c31 2061  rame(['<level1 a
+00031a10: 7474 7231 3d22 6122 3e31 3c6c 6576 656c  ttr1="a">1<level
+00031a20: 3220 6174 7472 323d 2262 223e 323c 6c65  2 attr2="b">2<le
+00031a30: 7665 6c33 3e33 613c 2f6c 6576 656c 333e  vel3>3a</level3>
+00031a40: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
+00031a50: 6c33 3e3c 2f6c 6576 656c 323e 3c2f 6c65  l3></level2></le
+00031a60: 7665 6c31 3e27 5d2c 2073 6368 656d 613d  vel1>'], schema=
+00031a70: 5b22 7374 7222 5d29 2e73 656c 6563 7428  ["str"]).select(
+00031a80: 7061 7273 655f 786d 6c28 2273 7472 2229  parse_xml("str")
+00031a90: 2e61 735f 2822 6f62 6a22 2929 0a20 2020  .as_("obj")).   
+00031aa0: 2020 2020 203e 3e3e 2064 662e 636f 6c6c       >>> df.coll
+00031ab0: 6563 7428 290a 2020 2020 2020 2020 5b52  ect().        [R
+00031ac0: 6f77 284f 424a 3d27 3c6c 6576 656c 3120  ow(OBJ='<level1 
+00031ad0: 6174 7472 313d 2261 223e 5c5c 6e20 2031  attr1="a">\\n  1
+00031ae0: 5c5c 6e20 203c 6c65 7665 6c32 2061 7474  \\n  <level2 att
+00031af0: 7232 3d22 6222 3e5c 5c6e 2020 2020 325c  r2="b">\\n    2\
+00031b00: 5c6e 2020 2020 3c6c 6576 656c 333e 3361  \n    <level3>3a
+00031b10: 3c2f 6c65 7665 6c33 3e5c 5c6e 2020 2020  </level3>\\n    
+00031b20: 3c6c 6576 656c 333e 3362 3c2f 6c65 7665  <level3>3b</leve
+00031b30: 6c33 3e5c 5c6e 2020 3c2f 6c65 7665 6c32  l3>\\n  </level2
+00031b40: 3e5c 5c6e 3c2f 6c65 7665 6c31 3e27 295d  >\\n</level1>')]
+00031b50: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00031b60: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
+00031b70: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
+00031b80: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
+00031b90: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00031ba0: 2020 5b52 6f77 2841 4e53 3d27 3c6c 6576    [Row(ANS='<lev
+00031bb0: 656c 3220 6174 7472 323d 2262 223e 5c5c  el2 attr2="b">\\
+00031bc0: 6e20 2032 5c5c 6e20 203c 6c65 7665 6c33  n  2\\n  <level3
+00031bd0: 3e33 613c 2f6c 6576 656c 333e 5c5c 6e20  >3a</level3>\\n 
+00031be0: 203c 6c65 7665 6c33 3e33 623c 2f6c 6576   <level3>3b</lev
+00031bf0: 656c 333e 5c5c 6e3c 2f6c 6576 656c 323e  el3>\\n</level2>
+00031c00: 2729 5d0a 0a20 2020 2057 6865 6e20 6d75  ')]..    When mu
+00031c10: 6c74 6970 6c65 2074 6167 7320 6578 6973  ltiple tags exis
+00031c20: 7420 6174 2061 206c 6576 656c 2c20 696e  t at a level, in
+00031c30: 7374 616e 6365 5f6e 756d 2063 616e 2062  stance_num can b
+00031c40: 6520 7573 6564 2074 6f20 6469 7374 696e  e used to distin
+00031c50: 6775 6973 6820 7768 6963 6820 656c 656d  guish which elem
+00031c60: 656e 7420 746f 2072 6574 7572 6e2e 0a0a  ent to return...
+00031c70: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00031c80: 2020 2020 2020 203e 3e3e 2064 662e 7365         >>> df.se
+00031c90: 6c65 6374 2878 6d6c 6765 7428 786d 6c67  lect(xmlget(xmlg
+00031ca0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
+00031cb0: 6576 656c 3222 2929 2c20 6c69 7428 226c  evel2")), lit("l
+00031cc0: 6576 656c 3322 292c 206c 6974 2830 2929  evel3"), lit(0))
+00031cd0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
+00031ce0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00031cf0: 526f 7728 414e 533d 273c 6c65 7665 6c33  Row(ANS='<level3
+00031d00: 3e33 613c 2f6c 6576 656c 333e 2729 5d0a  >3a</level3>')].
+00031d10: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00031d20: 656c 6563 7428 786d 6c67 6574 2878 6d6c  elect(xmlget(xml
+00031d30: 6765 7428 226f 626a 222c 206c 6974 2822  get("obj", lit("
+00031d40: 6c65 7665 6c32 2229 292c 206c 6974 2822  level2")), lit("
+00031d50: 6c65 7665 6c33 2229 2c20 6c69 7428 3129  level3"), lit(1)
+00031d60: 292e 6173 5f28 2261 6e73 2229 292e 636f  ).as_("ans")).co
+00031d70: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00031d80: 5b52 6f77 2841 4e53 3d27 3c6c 6576 656c  [Row(ANS='<level
+00031d90: 333e 3362 3c2f 6c65 7665 6c33 3e27 295d  3>3b</level3>')]
+00031da0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00031db0: 7365 6c65 6374 2878 6d6c 6765 7428 226f  select(xmlget("o
+00031dc0: 626a 222c 206c 6974 2822 6c65 7665 6c32  bj", lit("level2
+00031dd0: 2229 2c20 6c69 7428 3529 292e 6173 5f28  "), lit(5)).as_(
+00031de0: 2261 6e73 2229 292e 636f 6c6c 6563 7428  "ans")).collect(
+00031df0: 290a 2020 2020 2020 2020 5b52 6f77 2841  ).        [Row(A
+00031e00: 4e53 3d4e 6f6e 6529 5d0a 0a20 2020 2049  NS=None)]..    I
+00031e10: 6e20 6f72 6465 7220 746f 2067 6574 2074  n order to get t
+00031e20: 6865 2074 6167 6e61 6d65 2c20 7468 6520  he tagname, the 
+00031e30: 7661 6c75 6520 6f66 2061 6e20 6174 7472  value of an attr
+00031e40: 6962 7574 6520 6f72 2074 6865 2063 6f6e  ibute or the con
+00031e50: 7465 6e74 2077 6974 6869 6e20 6120 7461  tent within a ta
+00031e60: 6720 7468 6520 6067 6574 6020 6675 6e63  g the `get` func
+00031e70: 7469 6f6e 2063 616e 2062 6520 7573 6564  tion can be used
+00031e80: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00031e90: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00031ea0: 2e73 656c 6563 7428 6765 7428 786d 6c67  .select(get(xmlg
+00031eb0: 6574 2822 6f62 6a22 2c20 6c69 7428 226c  et("obj", lit("l
+00031ec0: 6576 656c 3222 2929 2c20 6c69 7428 2240  evel2")), lit("@
+00031ed0: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
+00031ee0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00031ef0: 2020 5b52 6f77 2841 4e53 3d27 226c 6576    [Row(ANS='"lev
+00031f00: 656c 3222 2729 5d0a 2020 2020 2020 2020  el2"')].        
+00031f10: 3e3e 3e20 6466 2e73 656c 6563 7428 6765  >>> df.select(ge
+00031f20: 7428 786d 6c67 6574 2822 6f62 6a22 2c20  t(xmlget("obj", 
+00031f30: 6c69 7428 226c 6576 656c 3222 2929 2c20  lit("level2")), 
+00031f40: 6c69 7428 2224 2229 292e 6173 5f28 2261  lit("$")).as_("a
+00031f50: 6e73 2229 292e 636f 6c6c 6563 7428 290a  ns")).collect().
+00031f60: 2020 2020 2020 2020 5b52 6f77 2841 4e53          [Row(ANS
+00031f70: 3d27 5b5c 5c6e 2020 322c 5c5c 6e20 207b  ='[\\n  2,\\n  {
+00031f80: 5c5c 6e20 2020 2022 2422 3a20 2233 6122  \\n    "$": "3a"
+00031f90: 2c5c 5c6e 2020 2020 2240 223a 2022 6c65  ,\\n    "@": "le
+00031fa0: 7665 6c33 225c 5c6e 2020 7d2c 5c5c 6e20  vel3"\\n  },\\n 
+00031fb0: 207b 5c5c 6e20 2020 2022 2422 3a20 2233   {\\n    "$": "3
+00031fc0: 6222 2c5c 5c6e 2020 2020 2240 223a 2022  b",\\n    "@": "
+00031fd0: 6c65 7665 6c33 225c 5c6e 2020 7d5c 5c6e  level3"\\n  }\\n
+00031fe0: 5d27 295d 0a20 2020 2020 2020 203e 3e3e  ]')].        >>>
+00031ff0: 2064 662e 7365 6c65 6374 2867 6574 2878   df.select(get(x
+00032000: 6d6c 6765 7428 786d 6c67 6574 2822 6f62  mlget(xmlget("ob
+00032010: 6a22 2c20 6c69 7428 226c 6576 656c 3222  j", lit("level2"
+00032020: 2929 2c20 6c69 7428 226c 6576 656c 3322  )), lit("level3"
+00032030: 2929 2c20 6c69 7428 2224 2229 292e 6173  )), lit("$")).as
+00032040: 5f28 2261 6e73 2229 292e 636f 6c6c 6563  _("ans")).collec
+00032050: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00032060: 2841 4e53 3d27 2233 6122 2729 5d0a 2020  (ANS='"3a"')].  
+00032070: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+00032080: 6563 7428 6765 7428 786d 6c67 6574 2822  ect(get(xmlget("
+00032090: 6f62 6a22 2c20 6c69 7428 226c 6576 656c  obj", lit("level
+000320a0: 3222 2929 2c20 6c69 7428 2240 6174 7472  2")), lit("@attr
+000320b0: 3222 2929 2e61 735f 2822 616e 7322 2929  2")).as_("ans"))
+000320c0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000320d0: 2020 205b 526f 7728 414e 533d 2722 6222     [Row(ANS='"b"
+000320e0: 2729 5d0a 2020 2020 2222 220a 2020 2020  ')].    """.    
+000320f0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
+00032100: 7374 7228 786d 6c2c 2022 786d 6c67 6574  str(xml, "xmlget
+00032110: 2229 0a20 2020 2063 3220 3d20 5f74 6f5f  ").    c2 = _to_
+00032120: 636f 6c5f 6966 5f73 7472 2874 6167 2c20  col_if_str(tag, 
+00032130: 2278 6d6c 6765 7422 290a 2020 2020 6333  "xmlget").    c3
+00032140: 203d 2028 0a20 2020 2020 2020 2069 6e73   = (.        ins
+00032150: 7461 6e63 655f 6e75 6d0a 2020 2020 2020  tance_num.      
+00032160: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00032170: 696e 7374 616e 6365 5f6e 756d 2c20 696e  instance_num, in
+00032180: 7429 0a20 2020 2020 2020 2065 6c73 6520  t).        else 
+00032190: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2869  _to_col_if_str(i
+000321a0: 6e73 7461 6e63 655f 6e75 6d2c 2022 786d  nstance_num, "xm
+000321b0: 6c67 6574 2229 0a20 2020 2029 0a20 2020  lget").    ).   
+000321c0: 2072 6574 7572 6e20 6275 696c 7469 6e28   return builtin(
+000321d0: 2278 6d6c 6765 7422 2928 6331 2c20 6332  "xmlget")(c1, c2
+000321e0: 2c20 6333 290a 0a0a 6465 6620 6765 745f  , c3)...def get_
+000321f0: 7061 7468 2863 6f6c 3a20 436f 6c75 6d6e  path(col: Column
+00032200: 4f72 4e61 6d65 2c20 7061 7468 3a20 436f  OrName, path: Co
+00032210: 6c75 6d6e 4f72 4e61 6d65 2920 2d3e 2043  lumnOrName) -> C
+00032220: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+00032230: 2020 2045 7874 7261 6374 7320 6120 7661     Extracts a va
+00032240: 6c75 6520 6672 6f6d 2073 656d 692d 7374  lue from semi-st
+00032250: 7275 6374 7572 6564 2064 6174 6120 7573  ructured data us
+00032260: 696e 6720 6120 7061 7468 206e 616d 652e  ing a path name.
+00032270: 0a0a 2020 2020 4578 616d 706c 6573 3a3a  ..    Examples::
+00032280: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00032290: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+000322a0: 655f 6461 7461 6672 616d 6528 5b7b 2261  e_dataframe([{"a
+000322b0: 223a 207b 2261 6122 3a20 7b22 6464 223a  ": {"aa": {"dd":
+000322c0: 2034 7d2c 2022 6262 223a 2032 2c20 2263   4}, "bb": 2, "c
+000322d0: 6322 3a20 337d 7d5d 290a 2020 2020 2020  c": 3}}]).      
+000322e0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+000322f0: 6765 745f 7061 7468 2864 665b 2261 225d  get_path(df["a"]
+00032300: 2c20 6c69 7428 2261 612e 6464 2229 292e  , lit("aa.dd")).
+00032310: 616c 6961 7328 2267 6574 5f70 6174 6822  alias("get_path"
+00032320: 2929 2e63 6f6c 6c65 6374 2829 0a20 2020  )).collect().   
+00032330: 2020 2020 205b 526f 7728 4745 545f 5041       [Row(GET_PA
+00032340: 5448 3d27 3427 295d 0a20 2020 2022 2222  TH='4')].    """
+00032350: 0a20 2020 2063 3120 3d20 5f74 6f5f 636f  .    c1 = _to_co
+00032360: 6c5f 6966 5f73 7472 2863 6f6c 2c20 2267  l_if_str(col, "g
+00032370: 6574 5f70 6174 6822 290a 2020 2020 6332  et_path").    c2
+00032380: 203d 205f 746f 5f63 6f6c 5f69 665f 7374   = _to_col_if_st
+00032390: 7228 7061 7468 2c20 2267 6574 5f70 6174  r(path, "get_pat
+000323a0: 6822 290a 2020 2020 7265 7475 726e 2062  h").    return b
+000323b0: 7569 6c74 696e 2822 6765 745f 7061 7468  uiltin("get_path
+000323c0: 2229 2863 312c 2063 3229 0a0a 0a64 6566  ")(c1, c2)...def
+000323d0: 2067 6574 2863 6f6c 313a 2055 6e69 6f6e   get(col1: Union
+000323e0: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+000323f0: 6e74 5d2c 2063 6f6c 323a 2055 6e69 6f6e  nt], col2: Union
+00032400: 5b43 6f6c 756d 6e4f 724e 616d 652c 2069  [ColumnOrName, i
+00032410: 6e74 5d29 202d 3e20 436f 6c75 6d6e 3a0a  nt]) -> Column:.
+00032420: 2020 2020 2222 2245 7874 7261 6374 7320      """Extracts 
+00032430: 6120 7661 6c75 6520 6672 6f6d 2061 6e20  a value from an 
+00032440: 6f62 6a65 6374 206f 7220 6172 7261 793b  object or array;
+00032450: 2072 6574 7572 6e73 204e 554c 4c20 6966   returns NULL if
+00032460: 2065 6974 6865 7220 6f66 2074 6865 2061   either of the a
+00032470: 7267 756d 656e 7473 2069 7320 4e55 4c4c  rguments is NULL
+00032480: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00032490: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+000324a0: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+000324b0: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+000324c0: 696d 706f 7274 206c 6974 0a20 2020 2020  import lit.     
+000324d0: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000324e0: 696f 6e2e 6372 6561 7465 4461 7461 4672  ion.createDataFr
+000324f0: 616d 6528 5b28 7b22 6122 3a20 312e 302c  ame([({"a": 1.0,
+00032500: 2022 6222 3a20 322e 307d 2c20 5b31 2c20   "b": 2.0}, [1, 
+00032510: 322c 2033 5d2c 292c 2028 7b7d 2c20 5b5d  2, 3],), ({}, []
+00032520: 2c29 5d2c 205b 226d 6170 222c 2022 6c69  ,)], ["map", "li
+00032530: 7374 225d 290a 2020 2020 2020 2020 3e3e  st"]).        >>
+00032540: 3e20 6466 2e73 656c 6563 7428 6765 7428  > df.select(get(
+00032550: 6466 2e6c 6973 742c 2031 292e 6173 5f28  df.list, 1).as_(
+00032560: 2269 6478 3122 2929 2e73 6f72 7428 636f  "idx1")).sort(co
+00032570: 6c28 2269 6478 3122 2929 2e73 686f 7728  l("idx1")).show(
+00032580: 290a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ).        ------
+00032590: 2d2d 2d2d 0a20 2020 2020 2020 207c 2249  ----.        |"I
+000325a0: 4458 3122 2020 7c0a 2020 2020 2020 2020  DX1"  |.        
+000325b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000325c0: 2020 207c 4e55 4c4c 2020 2020 7c0a 2020     |NULL    |.  
+000325d0: 2020 2020 2020 7c32 2020 2020 2020 207c        |2       |
+000325e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000325f0: 2d2d 2d0a 2020 2020 2020 2020 3c42 4c41  ---.        <BLA
+00032600: 4e4b 4c49 4e45 3e0a 0a20 2020 2020 2020  NKLINE>..       
+00032610: 203e 3e3e 2064 662e 7365 6c65 6374 2867   >>> df.select(g
+00032620: 6574 2864 662e 6d61 702c 206c 6974 2822  et(df.map, lit("
+00032630: 6122 2929 2e61 735f 2822 6765 745f 6122  a")).as_("get_a"
+00032640: 2929 2e73 6f72 7428 636f 6c28 2267 6574  )).sort(col("get
+00032650: 5f61 2229 292e 7368 6f77 2829 0a20 2020  _a")).show().   
+00032660: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00032670: 0a20 2020 2020 2020 207c 2247 4554 5f41  .        |"GET_A
+00032680: 2220 207c 0a20 2020 2020 2020 202d 2d2d  "  |.        ---
+00032690: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000326a0: 207c 4e55 4c4c 2020 2020 207c 0a20 2020   |NULL     |.   
+000326b0: 2020 2020 207c 3120 2020 2020 2020 207c       |1        |
+000326c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000326d0: 2d2d 2d2d 0a20 2020 2020 2020 203c 424c  ----.        <BL
+000326e0: 414e 4b4c 494e 453e 2222 220a 2020 2020  ANKLINE>""".    
+000326f0: 6331 203d 205f 746f 5f63 6f6c 5f69 665f  c1 = _to_col_if_
+00032700: 7374 725f 6f72 5f69 6e74 2863 6f6c 312c  str_or_int(col1,
+00032710: 2022 6765 7422 290a 2020 2020 6332 203d   "get").    c2 =
+00032720: 205f 746f 5f63 6f6c 5f69 665f 7374 725f   _to_col_if_str_
+00032730: 6f72 5f69 6e74 2863 6f6c 322c 2022 6765  or_int(col2, "ge
+00032740: 7422 290a 2020 2020 7265 7475 726e 2062  t").    return b
+00032750: 7569 6c74 696e 2822 6765 7422 2928 6331  uiltin("get")(c1
+00032760: 2c20 6332 290a 0a0a 656c 656d 656e 745f  , c2)...element_
+00032770: 6174 203d 2067 6574 0a0a 0a64 6566 2077  at = get...def w
+00032780: 6865 6e28 636f 6e64 6974 696f 6e3a 2043  hen(condition: C
+00032790: 6f6c 756d 6e4f 7253 716c 4578 7072 2c20  olumnOrSqlExpr, 
+000327a0: 7661 6c75 653a 2043 6f6c 756d 6e4f 724c  value: ColumnOrL
+000327b0: 6974 6572 616c 2920 2d3e 2043 6173 6545  iteral) -> CaseE
+000327c0: 7870 723a 0a20 2020 2022 2222 576f 726b  xpr:.    """Work
+000327d0: 7320 6c69 6b65 2061 2063 6173 6361 6469  s like a cascadi
+000327e0: 6e67 2069 662d 7468 656e 2d65 6c73 6520  ng if-then-else 
+000327f0: 7374 6174 656d 656e 742e 0a20 2020 2041  statement..    A
+00032800: 2073 6572 6965 7320 6f66 2063 6f6e 6469   series of condi
+00032810: 7469 6f6e 7320 6172 6520 6576 616c 7561  tions are evalua
+00032820: 7465 6420 696e 2073 6571 7565 6e63 652e  ted in sequence.
+00032830: 0a20 2020 2057 6865 6e20 6120 636f 6e64  .    When a cond
+00032840: 6974 696f 6e20 6576 616c 7561 7465 7320  ition evaluates 
+00032850: 746f 2054 5255 452c 2074 6865 2065 7661  to TRUE, the eva
+00032860: 6c75 6174 696f 6e20 7374 6f70 7320 616e  luation stops an
+00032870: 6420 7468 6520 6173 736f 6369 6174 6564  d the associated
+00032880: 0a20 2020 2072 6573 756c 7420 2861 6674  .    result (aft
+00032890: 6572 2054 4845 4e29 2069 7320 7265 7475  er THEN) is retu
+000328a0: 726e 6564 2e20 4966 206e 6f6e 6520 6f66  rned. If none of
+000328b0: 2074 6865 2063 6f6e 6469 7469 6f6e 7320   the conditions 
+000328c0: 6576 616c 7561 7465 2074 6f20 5452 5545  evaluate to TRUE
+000328d0: 2c0a 2020 2020 7468 656e 2074 6865 2072  ,.    then the r
+000328e0: 6573 756c 7420 6166 7465 7220 7468 6520  esult after the 
+000328f0: 6f70 7469 6f6e 616c 204f 5448 4552 5749  optional OTHERWI
+00032900: 5345 2069 7320 7265 7475 726e 6564 2c20  SE is returned, 
+00032910: 6966 2070 7265 7365 6e74 3b0a 2020 2020  if present;.    
+00032920: 6f74 6865 7277 6973 6520 4e55 4c4c 2069  otherwise NULL i
+00032930: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
+00032940: 2041 7267 733a 0a20 2020 2020 2020 2063   Args:.        c
+00032950: 6f6e 6469 7469 6f6e 3a20 4120 3a63 6c61  ondition: A :cla
+00032960: 7373 3a60 436f 6c75 6d6e 6020 6578 7072  ss:`Column` expr
+00032970: 6573 7369 6f6e 206f 7220 5351 4c20 7465  ession or SQL te
+00032980: 7874 2072 6570 7265 7365 6e74 696e 6720  xt representing 
+00032990: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
+000329a0: 6e64 6974 696f 6e2e 0a20 2020 2020 2020  ndition..       
+000329b0: 2076 616c 7565 3a20 4120 3a63 6c61 7373   value: A :class
+000329c0: 3a60 436f 6c75 6d6e 6020 6578 7072 6573  :`Column` expres
+000329d0: 7369 6f6e 206f 7220 6120 6c69 7465 7261  sion or a litera
+000329e0: 6c20 7661 6c75 652c 2077 6869 6368 2077  l value, which w
+000329f0: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
+00032a00: 2020 2020 2020 2020 2020 2020 6966 2060              if `
+00032a10: 6063 6f6e 6469 7469 6f6e 6060 2069 7320  `condition`` is 
+00032a20: 7472 7565 2e0a 0a20 2020 2045 7861 6d70  true...    Examp
+00032a30: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00032a40: 3e20 6466 203d 2073 6573 7369 6f6e 2e63  > df = session.c
+00032a50: 7265 6174 655f 6461 7461 6672 616d 6528  reate_dataframe(
+00032a60: 5b31 2c20 4e6f 6e65 2c20 322c 2033 2c20  [1, None, 2, 3, 
+00032a70: 4e6f 6e65 2c20 352c 2036 5d2c 2073 6368  None, 5, 6], sch
+00032a80: 656d 613d 5b22 6122 5d29 0a20 2020 2020  ema=["a"]).     
+00032a90: 2020 203e 3e3e 2064 662e 636f 6c6c 6563     >>> df.collec
+00032aa0: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+00032ab0: 2841 3d31 292c 2052 6f77 2841 3d4e 6f6e  (A=1), Row(A=Non
+00032ac0: 6529 2c20 526f 7728 413d 3229 2c20 526f  e), Row(A=2), Ro
+00032ad0: 7728 413d 3329 2c20 526f 7728 413d 4e6f  w(A=3), Row(A=No
+00032ae0: 6e65 292c 2052 6f77 2841 3d35 292c 2052  ne), Row(A=5), R
+00032af0: 6f77 2841 3d36 295d 0a20 2020 2020 2020  ow(A=6)].       
+00032b00: 203e 3e3e 2064 662e 7365 6c65 6374 2877   >>> df.select(w
+00032b10: 6865 6e28 636f 6c28 2261 2229 2025 2032  hen(col("a") % 2
+00032b20: 203d 3d20 302c 206c 6974 2822 6576 656e   == 0, lit("even
+00032b30: 2229 292e 6173 5f28 2261 6e73 2229 292e  ")).as_("ans")).
+00032b40: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00032b50: 2020 5b52 6f77 2841 4e53 3d4e 6f6e 6529    [Row(ANS=None)
+00032b60: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
+00032b70: 2052 6f77 2841 4e53 3d27 6576 656e 2729   Row(ANS='even')
+00032b80: 2c20 526f 7728 414e 533d 4e6f 6e65 292c  , Row(ANS=None),
+00032b90: 2052 6f77 2841 4e53 3d4e 6f6e 6529 2c20   Row(ANS=None), 
+00032ba0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+00032bb0: 6f77 2841 4e53 3d27 6576 656e 2729 5d0a  ow(ANS='even')].
+00032bc0: 0a20 2020 204d 756c 7469 706c 6520 7768  .    Multiple wh
+00032bd0: 656e 2073 7461 7465 6d65 6e74 7320 6361  en statements ca
+00032be0: 6e20 6265 2063 6861 6e67 6564 2061 6e64  n be changed and
+00032bf0: 2060 6f74 6865 7277 6973 6560 2f60 656c   `otherwise`/`el
+00032c00: 7365 5f60 2075 7365 6420 746f 2063 7265  se_` used to cre
+00032c10: 6174 6520 6578 7072 6573 7369 6f6e 7320  ate expressions 
+00032c20: 7369 6d69 6c61 7220 746f 2060 6043 4153  similar to ``CAS
+00032c30: 4520 5748 454e 202e 2e2e 2045 4c53 4520  E WHEN ... ELSE 
+00032c40: 2e2e 2e20 454e 4460 6020 696e 2053 514c  ... END`` in SQL
+00032c50: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+00032c60: 0a0a 2020 2020 2020 2020 3e3e 3e20 6466  ..        >>> df
+00032c70: 2e73 656c 6563 7428 7768 656e 2863 6f6c  .select(when(col
+00032c80: 2822 6122 2920 2520 3220 3d3d 2030 2c20  ("a") % 2 == 0, 
+00032c90: 6c69 7428 2265 7665 6e22 2929 2e77 6865  lit("even")).whe
+00032ca0: 6e28 636f 6c28 2261 2229 2025 2032 203d  n(col("a") % 2 =
+00032cb0: 3d20 312c 206c 6974 2822 6f64 6422 2929  = 1, lit("odd"))
+00032cc0: 2e61 735f 2822 616e 7322 2929 2e63 6f6c  .as_("ans")).col
+00032cd0: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+00032ce0: 526f 7728 414e 533d 276f 6464 2729 2c20  Row(ANS='odd'), 
+00032cf0: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+00032d00: 6f77 2841 4e53 3d27 6576 656e 2729 2c20  ow(ANS='even'), 
+00032d10: 526f 7728 414e 533d 276f 6464 2729 2c20  Row(ANS='odd'), 
+00032d20: 526f 7728 414e 533d 4e6f 6e65 292c 2052  Row(ANS=None), R
+00032d30: 6f77 2841 4e53 3d27 6f64 6427 292c 2052  ow(ANS='odd'), R
+00032d40: 6f77 2841 4e53 3d27 6576 656e 2729 5d0a  ow(ANS='even')].
+00032d50: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+00032d60: 656c 6563 7428 7768 656e 2863 6f6c 2822  elect(when(col("
+00032d70: 6122 2920 2520 3220 3d3d 2030 2c20 6c69  a") % 2 == 0, li
+00032d80: 7428 2265 7665 6e22 2929 2e77 6865 6e28  t("even")).when(
+00032d90: 636f 6c28 2261 2229 2025 2032 203d 3d20  col("a") % 2 == 
+00032da0: 312c 206c 6974 2822 6f64 6422 2929 2e6f  1, lit("odd")).o
+00032db0: 7468 6572 7769 7365 286c 6974 2822 756e  therwise(lit("un
+00032dc0: 6b6e 6f77 6e22 2929 2e61 735f 2822 616e  known")).as_("an
+00032dd0: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
+00032de0: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00032df0: 276f 6464 2729 2c20 526f 7728 414e 533d  'odd'), Row(ANS=
+00032e00: 2775 6e6b 6e6f 776e 2729 2c20 526f 7728  'unknown'), Row(
+00032e10: 414e 533d 2765 7665 6e27 292c 2052 6f77  ANS='even'), Row
+00032e20: 2841 4e53 3d27 6f64 6427 292c 2052 6f77  (ANS='odd'), Row
+00032e30: 2841 4e53 3d27 756e 6b6e 6f77 6e27 292c  (ANS='unknown'),
+00032e40: 2052 6f77 2841 4e53 3d27 6f64 6427 292c   Row(ANS='odd'),
+00032e50: 2052 6f77 2841 4e53 3d27 6576 656e 2729   Row(ANS='even')
+00032e60: 5d0a 2020 2020 2222 220a 2020 2020 7265  ].    """.    re
+00032e70: 7475 726e 2043 6173 6545 7870 7228 0a20  turn CaseExpr(. 
+00032e80: 2020 2020 2020 2043 6173 6557 6865 6e28         CaseWhen(
+00032e90: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00032ea0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00032eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032ec0: 2020 2020 205f 746f 5f63 6f6c 5f69 665f       _to_col_if_
+00032ed0: 7371 6c5f 6578 7072 2863 6f6e 6469 7469  sql_expr(conditi
+00032ee0: 6f6e 2c20 2277 6865 6e22 292e 5f65 7870  on, "when")._exp
+00032ef0: 7265 7373 696f 6e2c 0a20 2020 2020 2020  ression,.       
+00032f00: 2020 2020 2020 2020 2020 2020 2043 6f6c               Col
+00032f10: 756d 6e2e 5f74 6f5f 6578 7072 2876 616c  umn._to_expr(val
+00032f20: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
+00032f30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00032f40: 2020 205d 0a20 2020 2020 2020 2029 0a20     ].        ). 
+00032f50: 2020 2029 0a0a 0a64 6566 2069 6666 280a     )...def iff(.
+00032f60: 2020 2020 636f 6e64 6974 696f 6e3a 2043      condition: C
+00032f70: 6f6c 756d 6e4f 7253 716c 4578 7072 2c0a  olumnOrSqlExpr,.
+00032f80: 2020 2020 6578 7072 313a 2043 6f6c 756d      expr1: Colum
+00032f90: 6e4f 724c 6974 6572 616c 2c0a 2020 2020  nOrLiteral,.    
+00032fa0: 6578 7072 323a 2043 6f6c 756d 6e4f 724c  expr2: ColumnOrL
+00032fb0: 6974 6572 616c 2c0a 2920 2d3e 2043 6f6c  iteral,.) -> Col
+00032fc0: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00032fd0: 2052 6574 7572 6e73 206f 6e65 206f 6620   Returns one of 
+00032fe0: 7477 6f20 7370 6563 6966 6965 6420 6578  two specified ex
+00032ff0: 7072 6573 7369 6f6e 732c 2064 6570 656e  pressions, depen
+00033000: 6469 6e67 206f 6e20 6120 636f 6e64 6974  ding on a condit
+00033010: 696f 6e2e 0a20 2020 2054 6869 7320 6973  ion..    This is
+00033020: 2065 7175 6976 616c 656e 7420 746f 2061   equivalent to a
+00033030: 6e20 6060 6966 2d74 6865 6e2d 656c 7365  n ``if-then-else
+00033040: 6060 2065 7870 7265 7373 696f 6e2e 0a0a  `` expression...
+00033050: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00033060: 2020 636f 6e64 6974 696f 6e3a 2041 203a    condition: A :
+00033070: 636c 6173 733a 6043 6f6c 756d 6e60 2065  class:`Column` e
+00033080: 7870 7265 7373 696f 6e20 6f72 2053 514c  xpression or SQL
+00033090: 2074 6578 7420 7265 7072 6573 656e 7469   text representi
+000330a0: 6e67 2074 6865 2073 7065 6369 6669 6564  ng the specified
+000330b0: 2063 6f6e 6469 7469 6f6e 2e0a 2020 2020   condition..    
+000330c0: 2020 2020 6578 7072 313a 2041 203a 636c      expr1: A :cl
+000330d0: 6173 733a 6043 6f6c 756d 6e60 2065 7870  ass:`Column` exp
+000330e0: 7265 7373 696f 6e20 6f72 2061 206c 6974  ression or a lit
+000330f0: 6572 616c 2076 616c 7565 2c20 7768 6963  eral value, whic
+00033100: 6820 7769 6c6c 2062 6520 7265 7475 726e  h will be return
+00033110: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+00033120: 6620 6060 636f 6e64 6974 696f 6e60 6020  f ``condition`` 
+00033130: 6973 2074 7275 652e 0a20 2020 2020 2020  is true..       
+00033140: 2065 7870 7232 3a20 4120 3a63 6c61 7373   expr2: A :class
+00033150: 3a60 436f 6c75 6d6e 6020 6578 7072 6573  :`Column` expres
+00033160: 7369 6f6e 206f 7220 6120 6c69 7465 7261  sion or a litera
+00033170: 6c20 7661 6c75 652c 2077 6869 6368 2077  l value, which w
+00033180: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
+00033190: 2020 2020 2020 2020 2020 2020 6966 2060              if `
+000331a0: 6063 6f6e 6469 7469 6f6e 6060 2069 7320  `condition`` is 
+000331b0: 6661 6c73 652e 0a0a 2020 2020 4578 616d  false...    Exam
+000331c0: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
+000331d0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+000331e0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+000331f0: 6528 5b54 7275 652c 2046 616c 7365 2c20  e([True, False, 
+00033200: 4e6f 6e65 5d2c 2073 6368 656d 613d 5b22  None], schema=["
+00033210: 6122 5d29 0a20 2020 2020 2020 203e 3e3e  a"]).        >>>
+00033220: 2064 662e 7365 6c65 6374 2869 6666 2864   df.select(iff(d
+00033230: 665b 2261 225d 2c20 6c69 7428 2274 7275  f["a"], lit("tru
+00033240: 6522 292c 206c 6974 2822 6661 6c73 6522  e"), lit("false"
+00033250: 2929 2e61 6c69 6173 2822 6966 6622 2929  )).alias("iff"))
+00033260: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00033270: 2020 205b 526f 7728 4946 463d 2774 7275     [Row(IFF='tru
+00033280: 6527 292c 2052 6f77 2849 4646 3d27 6661  e'), Row(IFF='fa
+00033290: 6c73 6527 292c 2052 6f77 2849 4646 3d27  lse'), Row(IFF='
+000332a0: 6661 6c73 6527 295d 0a20 2020 2022 2222  false')].    """
+000332b0: 0a20 2020 2072 6574 7572 6e20 6275 696c  .    return buil
+000332c0: 7469 6e28 2269 6666 2229 285f 746f 5f63  tin("iff")(_to_c
+000332d0: 6f6c 5f69 665f 7371 6c5f 6578 7072 2863  ol_if_sql_expr(c
+000332e0: 6f6e 6469 7469 6f6e 2c20 2269 6666 2229  ondition, "iff")
+000332f0: 2c20 6578 7072 312c 2065 7870 7232 290a  , expr1, expr2).
+00033300: 0a0a 6465 6620 696e 5f28 0a20 2020 2063  ..def in_(.    c
+00033310: 6f6c 733a 204c 6973 745b 436f 6c75 6d6e  ols: List[Column
+00033320: 4f72 4e61 6d65 5d2c 0a20 2020 202a 7661  OrName],.    *va
+00033330: 6c73 3a20 556e 696f 6e5b 2273 6e6f 7766  ls: Union["snowf
+00033340: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 4461  lake.snowpark.Da
+00033350: 7461 4672 616d 6522 2c20 4c69 7465 7261  taFrame", Litera
+00033360: 6c54 7970 652c 2049 7465 7261 626c 655b  lType, Iterable[
+00033370: 4c69 7465 7261 6c54 7970 655d 5d2c 0a29  LiteralType]],.)
+00033380: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00033390: 2222 2252 6574 7572 6e73 2061 2063 6f6e  """Returns a con
+000333a0: 6469 7469 6f6e 616c 2065 7870 7265 7373  ditional express
+000333b0: 696f 6e20 7468 6174 2079 6f75 2063 616e  ion that you can
+000333c0: 2070 6173 7320 746f 2074 6865 2066 696c   pass to the fil
+000333d0: 7465 7220 6f72 2077 6865 7265 206d 6574  ter or where met
+000333e0: 686f 6473 2074 6f0a 2020 2020 7065 7266  hods to.    perf
+000333f0: 6f72 6d20 7468 6520 6571 7569 7661 6c65  orm the equivale
+00033400: 6e74 206f 6620 6120 5748 4552 4520 2e2e  nt of a WHERE ..
+00033410: 2e20 494e 2071 7565 7279 2074 6861 7420  . IN query that 
+00033420: 6d61 7463 6865 7320 726f 7773 2063 6f6e  matches rows con
+00033430: 7461 696e 696e 6720 6120 7365 7175 656e  taining a sequen
+00033440: 6365 206f 660a 2020 2020 7661 6c75 6573  ce of.    values
+00033450: 2e0a 0a20 2020 2054 6865 2065 7870 7265  ...    The expre
+00033460: 7373 696f 6e20 6576 616c 7561 7465 7320  ssion evaluates 
+00033470: 746f 2074 7275 6520 6966 2074 6865 2076  to true if the v
+00033480: 616c 7565 7320 696e 2061 2072 6f77 206d  alues in a row m
+00033490: 6174 6368 6573 2074 6865 2076 616c 7565  atches the value
+000334a0: 7320 696e 206f 6e65 206f 660a 2020 2020  s in one of.    
+000334b0: 7468 6520 7370 6563 6966 6965 6420 7365  the specified se
+000334c0: 7175 656e 6365 732e 0a0a 2020 2020 5468  quences...    Th
+000334d0: 6520 666f 6c6c 6f77 696e 6720 636f 6465  e following code
+000334e0: 2072 6574 7572 6e73 2061 2044 6174 6146   returns a DataF
+000334f0: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
+00033500: 6e73 2074 6865 2072 6f77 7320 696e 2077  ns the rows in w
+00033510: 6869 6368 0a20 2020 2074 6865 2063 6f6c  hich.    the col
+00033520: 756d 6e73 2060 6331 6020 616e 6420 6063  umns `c1` and `c
+00033530: 3260 2063 6f6e 7461 696e 2074 6865 2076  2` contain the v
+00033540: 616c 7565 733a 0a20 2020 202d 2060 3160  alues:.    - `1`
+00033550: 2061 6e64 2060 2261 2260 2c20 6f72 0a20   and `"a"`, or. 
+00033560: 2020 202d 2060 3260 2061 6e64 2060 2262     - `2` and `"b
+00033570: 2260 0a20 2020 2054 6869 7320 6973 2065  "`.    This is e
+00033580: 7175 6976 616c 656e 7420 746f 2060 6053  quivalent to ``S
+00033590: 454c 4543 5420 2a20 4652 4f4d 2074 6162  ELECT * FROM tab
+000335a0: 6c65 2057 4845 5245 2028 6331 2c20 6332  le WHERE (c1, c2
+000335b0: 2920 494e 2028 2831 2c20 2761 2729 2c20  ) IN ((1, 'a'), 
+000335c0: 2832 2c20 2762 2729 2960 602e 0a0a 2020  (2, 'b'))``...  
+000335d0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+000335e0: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+000335f0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00033600: 6166 7261 6d65 285b 5b31 2c20 2261 225d  aframe([[1, "a"]
+00033610: 2c20 5b32 2c20 2262 225d 2c20 5b33 2c20  , [2, "b"], [3, 
+00033620: 2263 225d 5d2c 2073 6368 656d 613d 5b22  "c"]], schema=["
+00033630: 636f 6c31 222c 2022 636f 6c32 225d 290a  col1", "col2"]).
+00033640: 2020 2020 2020 2020 3e3e 3e20 6466 2e66          >>> df.f
+00033650: 696c 7465 7228 696e 5f28 5b63 6f6c 2822  ilter(in_([col("
+00033660: 636f 6c31 2229 2c20 636f 6c28 2263 6f6c  col1"), col("col
+00033670: 3222 295d 2c20 5b5b 312c 2022 6122 5d2c  2")], [[1, "a"],
+00033680: 205b 322c 2022 6222 5d5d 2929 2e73 686f   [2, "b"]])).sho
+00033690: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+000336a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000336b0: 2020 2020 2020 2020 7c22 434f 4c31 2220          |"COL1" 
+000336c0: 207c 2243 4f4c 3222 2020 7c0a 2020 2020   |"COL2"  |.    
+000336d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+000336e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000336f0: 7c31 2020 2020 2020 207c 6120 2020 2020  |1       |a     
+00033700: 2020 7c0a 2020 2020 2020 2020 7c32 2020    |.        |2  
+00033710: 2020 2020 207c 6220 2020 2020 2020 7c0a       |b       |.
+00033720: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00033730: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00033740: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+00033750: 0a20 2020 2054 6865 2066 6f6c 6c6f 7769  .    The followi
+00033760: 6e67 2063 6f64 6520 7265 7475 726e 7320  ng code returns 
+00033770: 6120 4461 7461 4672 616d 6520 7468 6174  a DataFrame that
+00033780: 2063 6f6e 7461 696e 7320 7468 6520 726f   contains the ro
+00033790: 7773 2077 6865 7265 0a20 2020 2074 6865  ws where.    the
+000337a0: 2076 616c 7565 7320 6f66 2074 6865 2063   values of the c
+000337b0: 6f6c 756d 6e73 2060 6331 6020 616e 6420  olumns `c1` and 
+000337c0: 6063 3260 2069 6e20 6064 6632 6020 6d61  `c2` in `df2` ma
+000337d0: 7463 6820 7468 6520 7661 6c75 6573 206f  tch the values o
+000337e0: 6620 7468 6520 636f 6c75 6d6e 730a 2020  f the columns.  
+000337f0: 2020 6061 6020 616e 6420 6062 6020 696e    `a` and `b` in
+00033800: 2060 6466 3160 2e20 5468 6973 2069 7320   `df1`. This is 
+00033810: 6571 7569 7661 6c65 6e74 2074 6f0a 2020  equivalent to.  
+00033820: 2020 6060 5345 4c45 4354 202a 2046 524f    ``SELECT * FRO
+00033830: 4d20 7461 626c 6532 2057 4845 5245 2028  M table2 WHERE (
+00033840: 6331 2c20 6332 2920 494e 2028 5345 4c45  c1, c2) IN (SELE
+00033850: 4354 2061 2c20 6220 4652 4f4d 2074 6162  CT a, b FROM tab
+00033860: 6c65 3129 6060 2e0a 0a20 2020 2045 7861  le1)``...    Exa
+00033870: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00033880: 3e3e 3e20 6466 3120 3d20 7365 7373 696f  >>> df1 = sessio
+00033890: 6e2e 7371 6c28 2273 656c 6563 7420 312c  n.sql("select 1,
+000338a0: 2027 6127 2229 0a20 2020 2020 2020 203e   'a'").        >
+000338b0: 3e3e 2064 662e 6669 6c74 6572 2869 6e5f  >> df.filter(in_
+000338c0: 285b 636f 6c28 2263 6f6c 3122 292c 2063  ([col("col1"), c
+000338d0: 6f6c 2822 636f 6c32 2229 5d2c 2064 6631  ol("col2")], df1
+000338e0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+000338f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00033900: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00033910: 434f 4c31 2220 207c 2243 4f4c 3222 2020  COL1"  |"COL2"  
+00033920: 7c0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  |.        ------
+00033930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
+00033940: 2020 2020 2020 7c31 2020 2020 2020 207c        |1       |
+00033950: 6120 2020 2020 2020 7c0a 2020 2020 2020  a       |.      
+00033960: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+00033970: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3c42  -----.        <B
+00033980: 4c41 4e4b 4c49 4e45 3e0a 0a20 2020 2041  LANKLINE>..    A
+00033990: 7267 733a 3a0a 2020 2020 2020 2020 636f  rgs::.        co
+000339a0: 6c73 3a20 4120 6c69 7374 206f 6620 7468  ls: A list of th
+000339b0: 6520 636f 6c75 6d6e 7320 746f 2063 6f6d  e columns to com
+000339c0: 7061 7265 2066 6f72 2074 6865 2049 4e20  pare for the IN 
+000339d0: 6f70 6572 6174 696f 6e2e 0a20 2020 2020  operation..     
+000339e0: 2020 2076 616c 733a 2041 206c 6973 7420     vals: A list 
+000339f0: 636f 6e74 6169 6e69 6e67 2074 6865 2076  containing the v
+00033a00: 616c 7565 7320 746f 2063 6f6d 7061 7265  alues to compare
+00033a10: 2066 6f72 2074 6865 2049 4e20 6f70 6572   for the IN oper
+00033a20: 6174 696f 6e2e 0a20 2020 2022 2222 0a20  ation..    """. 
+00033a30: 2020 2076 616c 7320 3d20 7061 7273 655f     vals = parse_
+00033a40: 706f 7369 7469 6f6e 616c 5f61 7267 735f  positional_args_
+00033a50: 746f 5f6c 6973 7428 2a76 616c 7329 0a20  to_list(*vals). 
+00033a60: 2020 2063 6f6c 756d 6e73 203d 205b 5f74     columns = [_t
+00033a70: 6f5f 636f 6c5f 6966 5f73 7472 2863 2c20  o_col_if_str(c, 
+00033a80: 2269 6e5f 2229 2066 6f72 2063 2069 6e20  "in_") for c in 
+00033a90: 636f 6c73 5d0a 2020 2020 7265 7475 726e  cols].    return
+00033aa0: 2043 6f6c 756d 6e28 4d75 6c74 6970 6c65   Column(Multiple
+00033ab0: 4578 7072 6573 7369 6f6e 285b 632e 5f65  Expression([c._e
+00033ac0: 7870 7265 7373 696f 6e20 666f 7220 6320  xpression for c 
+00033ad0: 696e 2063 6f6c 756d 6e73 5d29 292e 696e  in columns])).in
+00033ae0: 5f28 7661 6c73 290a 0a0a 6465 6620 6375  _(vals)...def cu
+00033af0: 6d65 5f64 6973 7428 2920 2d3e 2043 6f6c  me_dist() -> Col
+00033b00: 756d 6e3a 0a20 2020 2022 2222 0a20 2020  umn:.    """.   
+00033b10: 2046 696e 6473 2074 6865 2063 756d 756c   Finds the cumul
+00033b20: 6174 6976 6520 6469 7374 7269 6275 7469  ative distributi
+00033b30: 6f6e 206f 6620 6120 7661 6c75 6520 7769  on of a value wi
+00033b40: 7468 2072 6567 6172 6420 746f 206f 7468  th regard to oth
+00033b50: 6572 2076 616c 7565 730a 2020 2020 7769  er values.    wi
+00033b60: 7468 696e 2074 6865 2073 616d 6520 7769  thin the same wi
+00033b70: 6e64 6f77 2070 6172 7469 7469 6f6e 2e0a  ndow partition..
+00033b80: 0a20 2020 2045 7861 6d70 6c65 3a0a 0a20  .    Example:.. 
+00033b90: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00033ba0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00033bb0: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
+00033bc0: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
+00033bd0: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00033be0: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+00033bf0: 7320 696d 706f 7274 2044 6563 696d 616c  s import Decimal
+00033c00: 5479 7065 0a20 2020 2020 2020 203e 3e3e  Type.        >>>
+00033c10: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00033c20: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00033c30: 5b31 2c20 325d 2c20 5b31 2c20 325d 2c20  [1, 2], [1, 2], 
+00033c40: 5b31 2c33 5d2c 205b 342c 2035 5d2c 205b  [1,3], [4, 5], [
+00033c50: 322c 2033 5d2c 205b 332c 2034 5d2c 205b  2, 3], [3, 4], [
+00033c60: 342c 2037 5d2c 205b 332c 375d 2c20 5b34  4, 7], [3,7], [4
+00033c70: 2c35 5d5d 2c20 7363 6865 6d61 3d5b 2261  ,5]], schema=["a
+00033c80: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+00033c90: 203e 3e3e 2064 662e 7365 6c65 6374 2863   >>> df.select(c
+00033ca0: 756d 655f 6469 7374 2829 2e6f 7665 7228  ume_dist().over(
+00033cb0: 5769 6e64 6f77 2e6f 7264 6572 5f62 7928  Window.order_by(
+00033cc0: 2261 2229 292e 6361 7374 2844 6563 696d  "a")).cast(Decim
+00033cd0: 616c 5479 7065 2873 6361 6c65 3d33 2929  alType(scale=3))
+00033ce0: 2e61 6c69 6173 2822 7265 7375 6c74 2229  .alias("result")
+00033cf0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00033d00: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00033d10: 2020 2020 2020 7c22 5245 5355 4c54 2220        |"RESULT" 
+00033d20: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+00033d30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00033d40: 7c30 2e33 3333 2020 2020 207c 0a20 2020  |0.333     |.   
+00033d50: 2020 2020 207c 302e 3333 3320 2020 2020       |0.333     
+00033d60: 7c0a 2020 2020 2020 2020 7c30 2e33 3333  |.        |0.333
+00033d70: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00033d80: 302e 3434 3420 2020 2020 7c0a 2020 2020  0.444     |.    
+00033d90: 2020 2020 7c30 2e36 3637 2020 2020 207c      |0.667     |
+00033da0: 0a20 2020 2020 2020 207c 302e 3636 3720  .        |0.667 
+00033db0: 2020 2020 7c0a 2020 2020 2020 2020 7c31      |.        |1
+00033dc0: 2e30 3030 2020 2020 207c 0a20 2020 2020  .000     |.     
+00033dd0: 2020 207c 312e 3030 3020 2020 2020 7c0a     |1.000     |.
+00033de0: 2020 2020 2020 2020 7c31 2e30 3030 2020          |1.000  
+00033df0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00033e00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00033e10: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00033e20: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00033e30: 2062 7569 6c74 696e 2822 6375 6d65 5f64   builtin("cume_d
+00033e40: 6973 7422 2928 290a 0a0a 6465 6620 7261  ist")()...def ra
+00033e50: 6e6b 2829 202d 3e20 436f 6c75 6d6e 3a0a  nk() -> Column:.
+00033e60: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
+00033e70: 726e 7320 7468 6520 7261 6e6b 206f 6620  rns the rank of 
+00033e80: 6120 7661 6c75 6520 7769 7468 696e 2061  a value within a
+00033e90: 6e20 6f72 6465 7265 6420 6772 6f75 7020  n ordered group 
+00033ea0: 6f66 2076 616c 7565 732e 0a20 2020 2054  of values..    T
+00033eb0: 6865 2072 616e 6b20 7661 6c75 6520 7374  he rank value st
+00033ec0: 6172 7473 2061 7420 3120 616e 6420 636f  arts at 1 and co
+00033ed0: 6e74 696e 7565 7320 7570 2e0a 0a20 2020  ntinues up...   
+00033ee0: 2045 7861 6d70 6c65 3a3a 0a20 2020 2020   Example::.     
+00033ef0: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+00033f00: 666c 616b 652e 736e 6f77 7061 726b 2e77  flake.snowpark.w
+00033f10: 696e 646f 7720 696d 706f 7274 2057 696e  indow import Win
+00033f20: 646f 770a 2020 2020 2020 2020 3e3e 3e20  dow.        >>> 
+00033f30: 6466 203d 2073 6573 7369 6f6e 2e63 7265  df = session.cre
+00033f40: 6174 655f 6461 7461 6672 616d 6528 0a20  ate_dataframe(. 
+00033f50: 2020 2020 2020 202e 2e2e 2020 2020 205b         ...     [
+00033f60: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00033f70: 2020 2020 205b 312c 2032 2c20 315d 2c0a       [1, 2, 1],.
+00033f80: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00033f90: 2020 2020 5b31 2c20 322c 2033 5d2c 0a20      [1, 2, 3],. 
+00033fa0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00033fb0: 2020 205b 322c 2031 2c20 3130 5d2c 0a20     [2, 1, 10],. 
+00033fc0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00033fd0: 2020 205b 322c 2032 2c20 315d 2c0a 2020     [2, 2, 1],.  
+00033fe0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00033ff0: 2020 5b32 2c20 322c 2033 5d2c 0a20 2020    [2, 2, 3],.   
+00034000: 2020 2020 202e 2e2e 2020 2020 205d 2c0a       ...     ],.
+00034010: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00034020: 7363 6865 6d61 3d5b 2278 222c 2022 7922  schema=["x", "y"
+00034030: 2c20 227a 225d 0a20 2020 2020 2020 202e  , "z"].        .
+00034040: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+00034050: 2064 662e 7365 6c65 6374 2872 616e 6b28   df.select(rank(
+00034060: 292e 6f76 6572 2857 696e 646f 772e 7061  ).over(Window.pa
+00034070: 7274 6974 696f 6e5f 6279 2863 6f6c 2822  rtition_by(col("
+00034080: 5822 2929 2e6f 7264 6572 5f62 7928 636f  X")).order_by(co
+00034090: 6c28 2259 2229 2929 2e61 6c69 6173 2822  l("Y"))).alias("
+000340a0: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+000340b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000340c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+000340d0: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+000340e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+000340f0: 2020 2020 2020 2020 7c31 2020 2020 2020          |1      
+00034100: 2020 207c 0a20 2020 2020 2020 207c 3220     |.        |2 
+00034110: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+00034120: 2020 7c32 2020 2020 2020 2020 207c 0a20    |2         |. 
+00034130: 2020 2020 2020 207c 3120 2020 2020 2020         |1       
+00034140: 2020 7c0a 2020 2020 2020 2020 7c31 2020    |.        |1  
+00034150: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00034160: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+00034170: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+00034180: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
+00034190: 7475 726e 2062 7569 6c74 696e 2822 7261  turn builtin("ra
+000341a0: 6e6b 2229 2829 0a0a 0a64 6566 2070 6572  nk")()...def per
+000341b0: 6365 6e74 5f72 616e 6b28 2920 2d3e 2043  cent_rank() -> C
+000341c0: 6f6c 756d 6e3a 0a20 2020 2022 2222 0a20  olumn:.    """. 
+000341d0: 2020 2052 6574 7572 6e73 2074 6865 2072     Returns the r
+000341e0: 656c 6174 6976 6520 7261 6e6b 206f 6620  elative rank of 
+000341f0: 6120 7661 6c75 6520 7769 7468 696e 2061  a value within a
+00034200: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
+00034210: 2c20 7370 6563 6966 6965 6420 6173 2061  , specified as a
+00034220: 2070 6572 6365 6e74 6167 650a 2020 2020   percentage.    
+00034230: 7261 6e67 696e 6720 6672 6f6d 2030 2e30  ranging from 0.0
+00034240: 2074 6f20 312e 302e 0a0a 2020 2020 4578   to 1.0...    Ex
+00034250: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+00034260: 3e3e 3e20 6672 6f6d 2073 6e6f 7766 6c61  >>> from snowfla
+00034270: 6b65 2e73 6e6f 7770 6172 6b2e 7769 6e64  ke.snowpark.wind
+00034280: 6f77 2069 6d70 6f72 7420 5769 6e64 6f77  ow import Window
+00034290: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000342a0: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000342b0: 5f64 6174 6166 7261 6d65 280a 2020 2020  _dataframe(.    
+000342c0: 2020 2020 2e2e 2e20 2020 2020 5b0a 2020      ...     [.  
+000342d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000342e0: 2020 5b31 2c20 322c 2031 5d2c 0a20 2020    [1, 2, 1],.   
+000342f0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00034300: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
+00034310: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00034320: 5b32 2c20 312c 2031 305d 2c0a 2020 2020  [2, 1, 10],.    
+00034330: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00034340: 5b32 2c20 322c 2031 5d2c 0a20 2020 2020  [2, 2, 1],.     
+00034350: 2020 202e 2e2e 2020 2020 2020 2020 205b     ...         [
+00034360: 322c 2032 2c20 335d 2c0a 2020 2020 2020  2, 2, 3],.      
+00034370: 2020 2e2e 2e20 2020 2020 5d2c 0a20 2020    ...     ],.   
+00034380: 2020 2020 202e 2e2e 2020 2020 2073 6368       ...     sch
+00034390: 656d 613d 5b22 7822 2c20 2279 222c 2022  ema=["x", "y", "
+000343a0: 7a22 5d0a 2020 2020 2020 2020 2e2e 2e20  z"].        ... 
+000343b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000343c0: 2e73 656c 6563 7428 7065 7263 656e 745f  .select(percent_
+000343d0: 7261 6e6b 2829 2e6f 7665 7228 5769 6e64  rank().over(Wind
+000343e0: 6f77 2e70 6172 7469 7469 6f6e 5f62 7928  ow.partition_by(
+000343f0: 2278 2229 2e6f 7264 6572 5f62 7928 636f  "x").order_by(co
+00034400: 6c28 2279 2229 2929 2e61 6c69 6173 2822  l("y"))).alias("
+00034410: 7265 7375 6c74 2229 292e 7368 6f77 2829  result")).show()
+00034420: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00034430: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7c22  -----.        |"
+00034440: 5245 5355 4c54 2220 207c 0a20 2020 2020  RESULT"  |.     
+00034450: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a     ------------.
+00034460: 2020 2020 2020 2020 7c30 2e30 2020 2020          |0.0    
+00034470: 2020 207c 0a20 2020 2020 2020 207c 302e     |.        |0.
+00034480: 3520 2020 2020 2020 7c0a 2020 2020 2020  5       |.      
+00034490: 2020 7c30 2e35 2020 2020 2020 207c 0a20    |0.5       |. 
+000344a0: 2020 2020 2020 207c 302e 3020 2020 2020         |0.0     
+000344b0: 2020 7c0a 2020 2020 2020 2020 7c30 2e30    |.        |0.0
+000344c0: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+000344d0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+000344e0: 2020 2020 2020 3c42 4c41 4e4b 4c49 4e45        <BLANKLINE
+000344f0: 3e0a 2020 2020 2222 220a 2020 2020 7265  >.    """.    re
+00034500: 7475 726e 2062 7569 6c74 696e 2822 7065  turn builtin("pe
+00034510: 7263 656e 745f 7261 6e6b 2229 2829 0a0a  rcent_rank")()..
+00034520: 0a64 6566 2064 656e 7365 5f72 616e 6b28  .def dense_rank(
+00034530: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+00034540: 2022 2222 0a20 2020 2052 6574 7572 6e73   """.    Returns
+00034550: 2074 6865 2072 616e 6b20 6f66 2061 2076   the rank of a v
+00034560: 616c 7565 2077 6974 6869 6e20 6120 6772  alue within a gr
+00034570: 6f75 7020 6f66 2076 616c 7565 732c 2077  oup of values, w
+00034580: 6974 686f 7574 2067 6170 7320 696e 2074  ithout gaps in t
+00034590: 6865 2072 616e 6b73 2e0a 2020 2020 5468  he ranks..    Th
+000345a0: 6520 7261 6e6b 2076 616c 7565 2073 7461  e rank value sta
+000345b0: 7274 7320 6174 2031 2061 6e64 2063 6f6e  rts at 1 and con
+000345c0: 7469 6e75 6573 2075 7020 7365 7175 656e  tinues up sequen
+000345d0: 7469 616c 6c79 2e0a 2020 2020 4966 2074  tially..    If t
+000345e0: 776f 2076 616c 7565 7320 6172 6520 7468  wo values are th
+000345f0: 6520 7361 6d65 2c20 7468 6579 2077 696c  e same, they wil
+00034600: 6c20 6861 7665 2074 6865 2073 616d 6520  l have the same 
+00034610: 7261 6e6b 2e0a 0a20 2020 2045 7861 6d70  rank...    Examp
+00034620: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00034630: 3e20 6672 6f6d 2073 6e6f 7766 6c61 6b65  > from snowflake
+00034640: 2e73 6e6f 7770 6172 6b2e 7769 6e64 6f77  .snowpark.window
+00034650: 2069 6d70 6f72 7420 5769 6e64 6f77 0a20   import Window. 
+00034660: 2020 2020 2020 203e 3e3e 2077 696e 646f         >>> windo
+00034670: 7720 3d20 5769 6e64 6f77 2e6f 7264 6572  w = Window.order
+00034680: 5f62 7928 226b 6579 2229 0a20 2020 2020  _by("key").     
+00034690: 2020 203e 3e3e 2064 6620 3d20 7365 7373     >>> df = sess
+000346a0: 696f 6e2e 6372 6561 7465 5f64 6174 6166  ion.create_dataf
+000346b0: 7261 6d65 285b 2831 2c20 2231 2229 2c20  rame([(1, "1"), 
+000346c0: 2832 2c20 2232 2229 2c20 2831 2c20 2233  (2, "2"), (1, "3
+000346d0: 2229 2c20 2832 2c20 2234 2229 5d2c 2073  "), (2, "4")], s
+000346e0: 6368 656d 613d 5b22 6b65 7922 2c20 2276  chema=["key", "v
+000346f0: 616c 7565 225d 290a 2020 2020 2020 2020  alue"]).        
+00034700: 3e3e 3e20 6466 2e73 656c 6563 7428 6465  >>> df.select(de
+00034710: 6e73 655f 7261 6e6b 2829 2e6f 7665 7228  nse_rank().over(
+00034720: 7769 6e64 6f77 292e 6173 5f28 2264 656e  window).as_("den
+00034730: 7365 5f72 616e 6b22 2929 2e63 6f6c 6c65  se_rank")).colle
+00034740: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+00034750: 7728 4445 4e53 455f 5241 4e4b 3d31 292c  w(DENSE_RANK=1),
+00034760: 2052 6f77 2844 454e 5345 5f52 414e 4b3d   Row(DENSE_RANK=
+00034770: 3129 2c20 526f 7728 4445 4e53 455f 5241  1), Row(DENSE_RA
+00034780: 4e4b 3d32 292c 2052 6f77 2844 454e 5345  NK=2), Row(DENSE
+00034790: 5f52 414e 4b3d 3229 5d0a 2020 2020 2222  _RANK=2)].    ""
+000347a0: 220a 2020 2020 7265 7475 726e 2062 7569  ".    return bui
+000347b0: 6c74 696e 2822 6465 6e73 655f 7261 6e6b  ltin("dense_rank
+000347c0: 2229 2829 0a0a 0a64 6566 2072 6f77 5f6e  ")()...def row_n
+000347d0: 756d 6265 7228 2920 2d3e 2043 6f6c 756d  umber() -> Colum
+000347e0: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+000347f0: 6574 7572 6e73 2061 2075 6e69 7175 6520  eturns a unique 
+00034800: 726f 7720 6e75 6d62 6572 2066 6f72 2065  row number for e
+00034810: 6163 6820 726f 7720 7769 7468 696e 2061  ach row within a
+00034820: 2077 696e 646f 7720 7061 7274 6974 696f   window partitio
+00034830: 6e2e 0a20 2020 2054 6865 2072 6f77 206e  n..    The row n
+00034840: 756d 6265 7220 7374 6172 7473 2061 7420  umber starts at 
+00034850: 3120 616e 6420 636f 6e74 696e 7565 7320  1 and continues 
+00034860: 7570 2073 6571 7565 6e74 6961 6c6c 792e  up sequentially.
+00034870: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00034880: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00034890: 6d20 736e 6f77 666c 616b 652e 736e 6f77  m snowflake.snow
+000348a0: 7061 726b 2e77 696e 646f 7720 696d 706f  park.window impo
+000348b0: 7274 2057 696e 646f 770a 2020 2020 2020  rt Window.      
+000348c0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000348d0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+000348e0: 616d 6528 0a20 2020 2020 2020 202e 2e2e  ame(.        ...
+000348f0: 2020 2020 205b 0a20 2020 2020 2020 202e       [.        .
+00034900: 2e2e 2020 2020 2020 2020 205b 312c 2032  ..         [1, 2
+00034910: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
+00034920: 2e20 2020 2020 2020 2020 5b31 2c20 322c  .         [1, 2,
+00034930: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
+00034940: 2020 2020 2020 2020 205b 322c 2031 2c20           [2, 1, 
+00034950: 3130 5d2c 0a20 2020 2020 2020 202e 2e2e  10],.        ...
+00034960: 2020 2020 2020 2020 205b 322c 2032 2c20           [2, 2, 
+00034970: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
+00034980: 2020 2020 2020 2020 5b32 2c20 322c 2033          [2, 2, 3
+00034990: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
+000349a0: 2020 205d 2c0a 2020 2020 2020 2020 2e2e     ],.        ..
+000349b0: 2e20 2020 2020 7363 6865 6d61 3d5b 2278  .     schema=["x
+000349c0: 222c 2022 7922 2c20 227a 225d 0a20 2020  ", "y", "z"].   
+000349d0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+000349e0: 2020 203e 3e3e 2064 662e 7365 6c65 6374     >>> df.select
+000349f0: 2872 6f77 5f6e 756d 6265 7228 292e 6f76  (row_number().ov
+00034a00: 6572 2857 696e 646f 772e 7061 7274 6974  er(Window.partit
+00034a10: 696f 6e5f 6279 2863 6f6c 2822 5822 2929  ion_by(col("X"))
+00034a20: 2e6f 7264 6572 5f62 7928 636f 6c28 2259  .order_by(col("Y
+00034a30: 2229 2929 2e61 6c69 6173 2822 7265 7375  "))).alias("resu
+00034a40: 6c74 2229 292e 7368 6f77 2829 0a20 2020  lt")).show().   
+00034a50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00034a60: 2d0a 2020 2020 2020 2020 7c22 5245 5355  -.        |"RESU
+00034a70: 4c54 2220 207c 0a20 2020 2020 2020 202d  LT"  |.        -
+00034a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00034a90: 2020 2020 7c31 2020 2020 2020 2020 207c      |1         |
+00034aa0: 0a20 2020 2020 2020 207c 3220 2020 2020  .        |2     
+00034ab0: 2020 2020 7c0a 2020 2020 2020 2020 7c33      |.        |3
+00034ac0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00034ad0: 2020 207c 3120 2020 2020 2020 2020 7c0a     |1         |.
+00034ae0: 2020 2020 2020 2020 7c32 2020 2020 2020          |2      
+00034af0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00034b00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00034b10: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
+00034b20: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00034b30: 2062 7569 6c74 696e 2822 726f 775f 6e75   builtin("row_nu
+00034b40: 6d62 6572 2229 2829 0a0a 0a64 6566 206c  mber")()...def l
+00034b50: 6167 280a 2020 2020 653a 2043 6f6c 756d  ag(.    e: Colum
+00034b60: 6e4f 724e 616d 652c 0a20 2020 206f 6666  nOrName,.    off
+00034b70: 7365 743a 2069 6e74 203d 2031 2c0a 2020  set: int = 1,.  
+00034b80: 2020 6465 6661 756c 745f 7661 6c75 653a    default_value:
+00034b90: 204f 7074 696f 6e61 6c5b 436f 6c75 6d6e   Optional[Column
+00034ba0: 4f72 4c69 7465 7261 6c5d 203d 204e 6f6e  OrLiteral] = Non
+00034bb0: 652c 0a20 2020 2069 676e 6f72 655f 6e75  e,.    ignore_nu
+00034bc0: 6c6c 733a 2062 6f6f 6c20 3d20 4661 6c73  lls: bool = Fals
+00034bd0: 652c 0a29 202d 3e20 436f 6c75 6d6e 3a0a  e,.) -> Column:.
+00034be0: 2020 2020 2222 220a 2020 2020 4163 6365      """.    Acce
+00034bf0: 7373 6573 2064 6174 6120 696e 2061 2070  sses data in a p
+00034c00: 7265 7669 6f75 7320 726f 7720 696e 2074  revious row in t
+00034c10: 6865 2073 616d 6520 7265 7375 6c74 2073  he same result s
+00034c20: 6574 2077 6974 686f 7574 2068 6176 696e  et without havin
+00034c30: 6720 746f 0a20 2020 206a 6f69 6e20 7468  g to.    join th
+00034c40: 6520 7461 626c 6520 746f 2069 7473 656c  e table to itsel
+00034c50: 662e 0a0a 2020 2020 4578 616d 706c 653a  f...    Example:
+00034c60: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
+00034c70: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+00034c80: 6f77 7061 726b 2e77 696e 646f 7720 696d  owpark.window im
+00034c90: 706f 7274 2057 696e 646f 770a 2020 2020  port Window.    
+00034ca0: 2020 2020 3e3e 3e20 6466 203d 2073 6573      >>> df = ses
+00034cb0: 7369 6f6e 2e63 7265 6174 655f 6461 7461  sion.create_data
+00034cc0: 6672 616d 6528 0a20 2020 2020 2020 202e  frame(.        .
+00034cd0: 2e2e 2020 2020 205b 0a20 2020 2020 2020  ..     [.       
+00034ce0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
+00034cf0: 2032 2c20 315d 2c0a 2020 2020 2020 2020   2, 1],.        
+00034d00: 2e2e 2e20 2020 2020 2020 2020 5b31 2c20  ...         [1, 
+00034d10: 322c 2033 5d2c 0a20 2020 2020 2020 202e  2, 3],.        .
+00034d20: 2e2e 2020 2020 2020 2020 205b 322c 2031  ..         [2, 1
+00034d30: 2c20 3130 5d2c 0a20 2020 2020 2020 202e  , 10],.        .
+00034d40: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
+00034d50: 2c20 315d 2c0a 2020 2020 2020 2020 2e2e  , 1],.        ..
+00034d60: 2e20 2020 2020 2020 2020 5b32 2c20 322c  .         [2, 2,
+00034d70: 2033 5d2c 0a20 2020 2020 2020 202e 2e2e   3],.        ...
+00034d80: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00034d90: 2e2e 2e20 2020 2020 7363 6865 6d61 3d5b  ...     schema=[
+00034da0: 2278 222c 2022 7922 2c20 227a 225d 0a20  "x", "y", "z"]. 
+00034db0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+00034dc0: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+00034dd0: 6374 286c 6167 2822 5a22 292e 6f76 6572  ct(lag("Z").over
+00034de0: 2857 696e 646f 772e 7061 7274 6974 696f  (Window.partitio
+00034df0: 6e5f 6279 2863 6f6c 2822 5822 2929 2e6f  n_by(col("X")).o
+00034e00: 7264 6572 5f62 7928 636f 6c28 2259 2229  rder_by(col("Y")
+00034e10: 2929 2e61 6c69 6173 2822 7265 7375 6c74  )).alias("result
+00034e20: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00034e30: 2020 2020 2020 5b52 6f77 2852 4553 554c        [Row(RESUL
+00034e40: 543d 4e6f 6e65 292c 2052 6f77 2852 4553  T=None), Row(RES
+00034e50: 554c 543d 3130 292c 2052 6f77 2852 4553  ULT=10), Row(RES
+00034e60: 554c 543d 3129 2c20 526f 7728 5245 5355  ULT=1), Row(RESU
+00034e70: 4c54 3d4e 6f6e 6529 2c20 526f 7728 5245  LT=None), Row(RE
+00034e80: 5355 4c54 3d31 295d 0a20 2020 2022 2222  SULT=1)].    """
+00034e90: 0a20 2020 2063 203d 205f 746f 5f63 6f6c  .    c = _to_col
+00034ea0: 5f69 665f 7374 7228 652c 2022 6c61 6722  _if_str(e, "lag"
+00034eb0: 290a 2020 2020 7265 7475 726e 2043 6f6c  ).    return Col
+00034ec0: 756d 6e28 0a20 2020 2020 2020 204c 6167  umn(.        Lag
+00034ed0: 2863 2e5f 6578 7072 6573 7369 6f6e 2c20  (c._expression, 
+00034ee0: 6f66 6673 6574 2c20 436f 6c75 6d6e 2e5f  offset, Column._
+00034ef0: 746f 5f65 7870 7228 6465 6661 756c 745f  to_expr(default_
+00034f00: 7661 6c75 6529 2c20 6967 6e6f 7265 5f6e  value), ignore_n
+00034f10: 756c 6c73 290a 2020 2020 290a 0a0a 6465  ulls).    )...de
+00034f20: 6620 6c65 6164 280a 2020 2020 653a 2043  f lead(.    e: C
+00034f30: 6f6c 756d 6e4f 724e 616d 652c 0a20 2020  olumnOrName,.   
+00034f40: 206f 6666 7365 743a 2069 6e74 203d 2031   offset: int = 1
+00034f50: 2c0a 2020 2020 6465 6661 756c 745f 7661  ,.    default_va
+00034f60: 6c75 653a 204f 7074 696f 6e61 6c5b 556e  lue: Optional[Un
+00034f70: 696f 6e5b 436f 6c75 6d6e 2c20 4c69 7465  ion[Column, Lite
+00034f80: 7261 6c54 7970 655d 5d20 3d20 4e6f 6e65  ralType]] = None
+00034f90: 2c0a 2020 2020 6967 6e6f 7265 5f6e 756c  ,.    ignore_nul
+00034fa0: 6c73 3a20 626f 6f6c 203d 2046 616c 7365  ls: bool = False
+00034fb0: 2c0a 2920 2d3e 2043 6f6c 756d 6e3a 0a20  ,.) -> Column:. 
+00034fc0: 2020 2022 2222 0a20 2020 2041 6363 6573     """.    Acces
+00034fd0: 7365 7320 6461 7461 2069 6e20 6120 7375  ses data in a su
+00034fe0: 6273 6571 7565 6e74 2072 6f77 2069 6e20  bsequent row in 
+00034ff0: 7468 6520 7361 6d65 2072 6573 756c 7420  the same result 
+00035000: 7365 7420 7769 7468 6f75 7420 6861 7669  set without havi
+00035010: 6e67 2074 6f0a 2020 2020 6a6f 696e 2074  ng to.    join t
+00035020: 6865 2074 6162 6c65 2074 6f20 6974 7365  he table to itse
+00035030: 6c66 2e0a 0a20 2020 2045 7861 6d70 6c65  lf...    Example
+00035040: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
+00035050: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+00035060: 6e6f 7770 6172 6b2e 7769 6e64 6f77 2069  nowpark.window i
+00035070: 6d70 6f72 7420 5769 6e64 6f77 0a20 2020  mport Window.   
+00035080: 2020 2020 203e 3e3e 2064 6620 3d20 7365       >>> df = se
+00035090: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000350a0: 6166 7261 6d65 280a 2020 2020 2020 2020  aframe(.        
+000350b0: 2e2e 2e20 2020 2020 5b0a 2020 2020 2020  ...     [.      
+000350c0: 2020 2e2e 2e20 2020 2020 2020 2020 5b31    ...         [1
+000350d0: 2c20 322c 2031 5d2c 0a20 2020 2020 2020  , 2, 1],.       
+000350e0: 202e 2e2e 2020 2020 2020 2020 205b 312c   ...         [1,
+000350f0: 2032 2c20 335d 2c0a 2020 2020 2020 2020   2, 3],.        
+00035100: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00035110: 312c 2031 305d 2c0a 2020 2020 2020 2020  1, 10],.        
+00035120: 2e2e 2e20 2020 2020 2020 2020 5b32 2c20  ...         [2, 
+00035130: 322c 2031 5d2c 0a20 2020 2020 2020 202e  2, 1],.        .
+00035140: 2e2e 2020 2020 2020 2020 205b 322c 2032  ..         [2, 2
+00035150: 2c20 335d 2c0a 2020 2020 2020 2020 2e2e  , 3],.        ..
+00035160: 2e20 2020 2020 5d2c 0a20 2020 2020 2020  .     ],.       
+00035170: 202e 2e2e 2020 2020 2073 6368 656d 613d   ...     schema=
+00035180: 5b22 7822 2c20 2279 222c 2022 7a22 5d0a  ["x", "y", "z"].
+00035190: 2020 2020 2020 2020 2e2e 2e20 290a 2020          ... ).  
+000351a0: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000351b0: 6563 7428 6c65 6164 2822 5a22 292e 6f76  ect(lead("Z").ov
+000351c0: 6572 2857 696e 646f 772e 7061 7274 6974  er(Window.partit
+000351d0: 696f 6e5f 6279 2863 6f6c 2822 5822 2929  ion_by(col("X"))
+000351e0: 2e6f 7264 6572 5f62 7928 636f 6c28 2259  .order_by(col("Y
+000351f0: 2229 2929 2e61 6c69 6173 2822 7265 7375  "))).alias("resu
+00035200: 6c74 2229 292e 636f 6c6c 6563 7428 290a  lt")).collect().
+00035210: 2020 2020 2020 2020 5b52 6f77 2852 4553          [Row(RES
+00035220: 554c 543d 3129 2c20 526f 7728 5245 5355  ULT=1), Row(RESU
+00035230: 4c54 3d33 292c 2052 6f77 2852 4553 554c  LT=3), Row(RESUL
+00035240: 543d 4e6f 6e65 292c 2052 6f77 2852 4553  T=None), Row(RES
+00035250: 554c 543d 3329 2c20 526f 7728 5245 5355  ULT=3), Row(RESU
+00035260: 4c54 3d4e 6f6e 6529 5d0a 2020 2020 2222  LT=None)].    ""
+00035270: 220a 2020 2020 6320 3d20 5f74 6f5f 636f  ".    c = _to_co
+00035280: 6c5f 6966 5f73 7472 2865 2c20 226c 6561  l_if_str(e, "lea
+00035290: 6422 290a 2020 2020 7265 7475 726e 2043  d").    return C
+000352a0: 6f6c 756d 6e28 0a20 2020 2020 2020 204c  olumn(.        L
+000352b0: 6561 6428 632e 5f65 7870 7265 7373 696f  ead(c._expressio
+000352c0: 6e2c 206f 6666 7365 742c 2043 6f6c 756d  n, offset, Colum
+000352d0: 6e2e 5f74 6f5f 6578 7072 2864 6566 6175  n._to_expr(defau
+000352e0: 6c74 5f76 616c 7565 292c 2069 676e 6f72  lt_value), ignor
+000352f0: 655f 6e75 6c6c 7329 0a20 2020 2029 0a0a  e_nulls).    )..
+00035300: 0a64 6566 206c 6173 745f 7661 6c75 6528  .def last_value(
+00035310: 0a20 2020 2065 3a20 436f 6c75 6d6e 4f72  .    e: ColumnOr
+00035320: 4e61 6d65 2c0a 2020 2020 6967 6e6f 7265  Name,.    ignore
+00035330: 5f6e 756c 6c73 3a20 626f 6f6c 203d 2046  _nulls: bool = F
+00035340: 616c 7365 2c0a 2920 2d3e 2043 6f6c 756d  alse,.) -> Colum
+00035350: 6e3a 0a20 2020 2022 2222 0a20 2020 2052  n:.    """.    R
+00035360: 6574 7572 6e73 2074 6865 206c 6173 7420  eturns the last 
+00035370: 7661 6c75 6520 7769 7468 696e 2061 6e20  value within an 
+00035380: 6f72 6465 7265 6420 6772 6f75 7020 6f66  ordered group of
+00035390: 2076 616c 7565 732e 0a0a 2020 2020 4578   values...    Ex
+000353a0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000353b0: 203e 3e3e 2066 726f 6d20 736e 6f77 666c   >>> from snowfl
+000353c0: 616b 652e 736e 6f77 7061 726b 2e77 696e  ake.snowpark.win
+000353d0: 646f 7720 696d 706f 7274 2057 696e 646f  dow import Windo
+000353e0: 770a 2020 2020 2020 2020 3e3e 3e20 7769  w.        >>> wi
+000353f0: 6e64 6f77 203d 2057 696e 646f 772e 7061  ndow = Window.pa
+00035400: 7274 6974 696f 6e5f 6279 2822 636f 6c75  rtition_by("colu
+00035410: 6d6e 3122 292e 6f72 6465 725f 6279 2822  mn1").order_by("
+00035420: 636f 6c75 6d6e 3222 290a 2020 2020 2020  column2").      
+00035430: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+00035440: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00035450: 616d 6528 5b5b 312c 2031 305d 2c20 5b31  ame([[1, 10], [1
+00035460: 2c20 3131 5d2c 205b 322c 2032 305d 2c20  , 11], [2, 20], 
+00035470: 5b32 2c20 3231 5d5d 2c20 7363 6865 6d61  [2, 21]], schema
+00035480: 3d5b 2263 6f6c 756d 6e31 222c 2022 636f  =["column1", "co
+00035490: 6c75 6d6e 3222 5d29 0a20 2020 2020 2020  lumn2"]).       
+000354a0: 203e 3e3e 2064 662e 7365 6c65 6374 2864   >>> df.select(d
+000354b0: 665b 2263 6f6c 756d 6e31 225d 2c20 6466  f["column1"], df
+000354c0: 5b22 636f 6c75 6d6e 3222 5d2c 206c 6173  ["column2"], las
+000354d0: 745f 7661 6c75 6528 6466 5b22 636f 6c75  t_value(df["colu
+000354e0: 6d6e 3222 5d29 2e6f 7665 7228 7769 6e64  mn2"]).over(wind
+000354f0: 6f77 292e 6173 5f28 2263 6f6c 756d 6e32  ow).as_("column2
+00035500: 5f6c 6173 7422 2929 2e63 6f6c 6c65 6374  _last")).collect
+00035510: 2829 0a20 2020 2020 2020 205b 526f 7728  ().        [Row(
+00035520: 434f 4c55 4d4e 313d 312c 2043 4f4c 554d  COLUMN1=1, COLUM
+00035530: 4e32 3d31 302c 2043 4f4c 554d 4e32 5f4c  N2=10, COLUMN2_L
+00035540: 4153 543d 3131 292c 2052 6f77 2843 4f4c  AST=11), Row(COL
+00035550: 554d 4e31 3d31 2c20 434f 4c55 4d4e 323d  UMN1=1, COLUMN2=
+00035560: 3131 2c20 434f 4c55 4d4e 325f 4c41 5354  11, COLUMN2_LAST
+00035570: 3d31 3129 2c20 526f 7728 434f 4c55 4d4e  =11), Row(COLUMN
+00035580: 313d 322c 2043 4f4c 554d 4e32 3d32 302c  1=2, COLUMN2=20,
+00035590: 2043 4f4c 554d 4e32 5f4c 4153 543d 3231   COLUMN2_LAST=21
+000355a0: 292c 2052 6f77 2843 4f4c 554d 4e31 3d32  ), Row(COLUMN1=2
+000355b0: 2c20 434f 4c55 4d4e 323d 3231 2c20 434f  , COLUMN2=21, CO
+000355c0: 4c55 4d4e 325f 4c41 5354 3d32 3129 5d0a  LUMN2_LAST=21)].
+000355d0: 2020 2020 2222 220a 2020 2020 6320 3d20      """.    c = 
+000355e0: 5f74 6f5f 636f 6c5f 6966 5f73 7472 2865  _to_col_if_str(e
+000355f0: 2c20 226c 6173 745f 7661 6c75 6522 290a  , "last_value").
+00035600: 2020 2020 7265 7475 726e 2043 6f6c 756d      return Colum
+00035610: 6e28 4c61 7374 5661 6c75 6528 632e 5f65  n(LastValue(c._e
+00035620: 7870 7265 7373 696f 6e2c 204e 6f6e 652c  xpression, None,
+00035630: 204e 6f6e 652c 2069 676e 6f72 655f 6e75   None, ignore_nu
+00035640: 6c6c 7329 290a 0a0a 6465 6620 6669 7273  lls))...def firs
+00035650: 745f 7661 6c75 6528 0a20 2020 2065 3a20  t_value(.    e: 
+00035660: 436f 6c75 6d6e 4f72 4e61 6d65 2c0a 2020  ColumnOrName,.  
+00035670: 2020 6967 6e6f 7265 5f6e 756c 6c73 3a20    ignore_nulls: 
+00035680: 626f 6f6c 203d 2046 616c 7365 2c0a 2920  bool = False,.) 
+00035690: 2d3e 2043 6f6c 756d 6e3a 0a20 2020 2022  -> Column:.    "
+000356a0: 2222 0a20 2020 2052 6574 7572 6e73 2074  "".    Returns t
+000356b0: 6865 2066 6972 7374 2076 616c 7565 2077  he first value w
+000356c0: 6974 6869 6e20 616e 206f 7264 6572 6564  ithin an ordered
+000356d0: 2067 726f 7570 206f 6620 7661 6c75 6573   group of values
+000356e0: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a3a  ...    Example::
+000356f0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00035700: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+00035710: 7770 6172 6b2e 7769 6e64 6f77 2069 6d70  wpark.window imp
+00035720: 6f72 7420 5769 6e64 6f77 0a20 2020 2020  ort Window.     
+00035730: 2020 203e 3e3e 2077 696e 646f 7720 3d20     >>> window = 
+00035740: 5769 6e64 6f77 2e70 6172 7469 7469 6f6e  Window.partition
+00035750: 5f62 7928 2263 6f6c 756d 6e31 2229 2e6f  _by("column1").o
+00035760: 7264 6572 5f62 7928 2263 6f6c 756d 6e32  rder_by("column2
+00035770: 2229 0a20 2020 2020 2020 203e 3e3e 2064  ").        >>> d
+00035780: 6620 3d20 7365 7373 696f 6e2e 6372 6561  f = session.crea
+00035790: 7465 5f64 6174 6166 7261 6d65 285b 5b31  te_dataframe([[1
+000357a0: 2c20 3130 5d2c 205b 312c 2031 315d 2c20  , 10], [1, 11], 
+000357b0: 5b32 2c20 3230 5d2c 205b 322c 2032 315d  [2, 20], [2, 21]
+000357c0: 5d2c 2073 6368 656d 613d 5b22 636f 6c75  ], schema=["colu
+000357d0: 6d6e 3122 2c20 2263 6f6c 756d 6e32 225d  mn1", "column2"]
+000357e0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000357f0: 2e73 656c 6563 7428 6466 5b22 636f 6c75  .select(df["colu
+00035800: 6d6e 3122 5d2c 2064 665b 2263 6f6c 756d  mn1"], df["colum
+00035810: 6e32 225d 2c20 6669 7273 745f 7661 6c75  n2"], first_valu
+00035820: 6528 6466 5b22 636f 6c75 6d6e 3222 5d29  e(df["column2"])
+00035830: 2e6f 7665 7228 7769 6e64 6f77 292e 6173  .over(window).as
+00035840: 5f28 2263 6f6c 756d 6e32 5f66 6972 7374  _("column2_first
+00035850: 2229 292e 636f 6c6c 6563 7428 290a 2020  ")).collect().  
+00035860: 2020 2020 2020 5b52 6f77 2843 4f4c 554d        [Row(COLUM
+00035870: 4e31 3d31 2c20 434f 4c55 4d4e 323d 3130  N1=1, COLUMN2=10
+00035880: 2c20 434f 4c55 4d4e 325f 4649 5253 543d  , COLUMN2_FIRST=
+00035890: 3130 292c 2052 6f77 2843 4f4c 554d 4e31  10), Row(COLUMN1
+000358a0: 3d31 2c20 434f 4c55 4d4e 323d 3131 2c20  =1, COLUMN2=11, 
+000358b0: 434f 4c55 4d4e 325f 4649 5253 543d 3130  COLUMN2_FIRST=10
+000358c0: 292c 2052 6f77 2843 4f4c 554d 4e31 3d32  ), Row(COLUMN1=2
+000358d0: 2c20 434f 4c55 4d4e 323d 3230 2c20 434f  , COLUMN2=20, CO
+000358e0: 4c55 4d4e 325f 4649 5253 543d 3230 292c  LUMN2_FIRST=20),
+000358f0: 2052 6f77 2843 4f4c 554d 4e31 3d32 2c20   Row(COLUMN1=2, 
+00035900: 434f 4c55 4d4e 323d 3231 2c20 434f 4c55  COLUMN2=21, COLU
+00035910: 4d4e 325f 4649 5253 543d 3230 295d 0a20  MN2_FIRST=20)]. 
+00035920: 2020 2022 2222 0a20 2020 2063 203d 205f     """.    c = _
+00035930: 746f 5f63 6f6c 5f69 665f 7374 7228 652c  to_col_if_str(e,
+00035940: 2022 6c61 7374 5f76 616c 7565 2229 0a20   "last_value"). 
+00035950: 2020 2072 6574 7572 6e20 436f 6c75 6d6e     return Column
+00035960: 2846 6972 7374 5661 6c75 6528 632e 5f65  (FirstValue(c._e
+00035970: 7870 7265 7373 696f 6e2c 204e 6f6e 652c  xpression, None,
+00035980: 204e 6f6e 652c 2069 676e 6f72 655f 6e75   None, ignore_nu
+00035990: 6c6c 7329 290a 0a0a 6465 6620 6e74 696c  lls))...def ntil
+000359a0: 6528 653a 2055 6e69 6f6e 5b69 6e74 2c20  e(e: Union[int, 
+000359b0: 436f 6c75 6d6e 4f72 4e61 6d65 5d29 202d  ColumnOrName]) -
+000359c0: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+000359d0: 220a 2020 2020 4469 7669 6465 7320 616e  ".    Divides an
+000359e0: 206f 7264 6572 6564 2064 6174 6120 7365   ordered data se
+000359f0: 7420 6571 7561 6c6c 7920 696e 746f 2074  t equally into t
+00035a00: 6865 206e 756d 6265 7220 6f66 2062 7563  he number of buc
+00035a10: 6b65 7473 2073 7065 6369 6669 6564 2062  kets specified b
+00035a20: 7920 6e2e 0a20 2020 2042 7563 6b65 7473  y n..    Buckets
+00035a30: 2061 7265 2073 6571 7565 6e74 6961 6c6c   are sequentiall
+00035a40: 7920 6e75 6d62 6572 6564 2031 2074 6872  y numbered 1 thr
+00035a50: 6f75 6768 206e 2e0a 0a20 2020 2041 7267  ough n...    Arg
+00035a60: 733a 0a20 2020 2020 2020 2065 3a20 5468  s:.        e: Th
+00035a70: 6520 6465 7369 7265 6420 6e75 6d62 6572  e desired number
+00035a80: 206f 6620 6275 636b 6574 733b 206d 7573   of buckets; mus
+00035a90: 7420 6265 2061 2070 6f73 6974 6976 6520  t be a positive 
+00035aa0: 696e 7465 6765 7220 7661 6c75 652e 0a0a  integer value...
+00035ab0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00035ac0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00035ad0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00035ae0: 726b 2e77 696e 646f 7720 696d 706f 7274  rk.window import
+00035af0: 2057 696e 646f 770a 2020 2020 2020 2020   Window.        
+00035b00: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00035b10: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00035b20: 6528 0a20 2020 2020 2020 202e 2e2e 2020  e(.        ...  
+00035b30: 2020 205b 5b22 4322 2c20 2253 5059 222c     [["C", "SPY",
+00035b40: 2033 5d2c 205b 2243 222c 2022 4141 504c   3], ["C", "AAPL
+00035b50: 222c 2031 305d 2c20 5b22 4e22 2c20 2253  ", 10], ["N", "S
+00035b60: 5059 222c 2035 5d2c 205b 224e 222c 2022  PY", 5], ["N", "
+00035b70: 4141 504c 222c 2037 5d2c 205b 2251 222c  AAPL", 7], ["Q",
+00035b80: 2022 4d53 4654 222c 2033 5d5d 2c0a 2020   "MSFT", 3]],.  
+00035b90: 2020 2020 2020 2e2e 2e20 2020 2020 7363        ...     sc
+00035ba0: 6865 6d61 3d5b 2265 7863 6861 6e67 6522  hema=["exchange"
+00035bb0: 2c20 2273 796d 626f 6c22 2c20 2273 6861  , "symbol", "sha
+00035bc0: 7265 7322 5d0a 2020 2020 2020 2020 2e2e  res"].        ..
+00035bd0: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
+00035be0: 6466 2e73 656c 6563 7428 636f 6c28 2265  df.select(col("e
+00035bf0: 7863 6861 6e67 6522 292c 2063 6f6c 2822  xchange"), col("
+00035c00: 7379 6d62 6f6c 2229 2c20 6e74 696c 6528  symbol"), ntile(
+00035c10: 3329 2e6f 7665 7228 5769 6e64 6f77 2e70  3).over(Window.p
+00035c20: 6172 7469 7469 6f6e 5f62 7928 2265 7863  artition_by("exc
+00035c30: 6861 6e67 6522 292e 6f72 6465 725f 6279  hange").order_by
+00035c40: 2822 7368 6172 6573 2229 292e 616c 6961  ("shares")).alia
+00035c50: 7328 226e 7469 6c65 5f33 2229 292e 7368  s("ntile_3")).sh
+00035c60: 6f77 2829 0a20 2020 2020 2020 202d 2d2d  ow().        ---
+00035c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00035c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00035c90: 2d2d 0a20 2020 2020 2020 207c 2245 5843  --.        |"EXC
+00035ca0: 4841 4e47 4522 2020 7c22 5359 4d42 4f4c  HANGE"  |"SYMBOL
+00035cb0: 2220 207c 224e 5449 4c45 5f33 2220 207c  "  |"NTILE_3"  |
+00035cc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00035cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00035ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00035cf0: 2020 2020 2020 207c 5120 2020 2020 2020         |Q       
+00035d00: 2020 2020 7c4d 5346 5420 2020 2020 207c      |MSFT      |
+00035d10: 3120 2020 2020 2020 2020 207c 0a20 2020  1          |.   
+00035d20: 2020 2020 207c 4e20 2020 2020 2020 2020       |N         
+00035d30: 2020 7c53 5059 2020 2020 2020 207c 3120    |SPY       |1 
+00035d40: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+00035d50: 2020 207c 4e20 2020 2020 2020 2020 2020     |N           
+00035d60: 7c41 4150 4c20 2020 2020 207c 3220 2020  |AAPL      |2   
+00035d70: 2020 2020 2020 207c 0a20 2020 2020 2020         |.       
+00035d80: 207c 4320 2020 2020 2020 2020 2020 7c53   |C           |S
+00035d90: 5059 2020 2020 2020 207c 3120 2020 2020  PY       |1     
+00035da0: 2020 2020 207c 0a20 2020 2020 2020 207c       |.        |
+00035db0: 4320 2020 2020 2020 2020 2020 7c41 4150  C           |AAP
+00035dc0: 4c20 2020 2020 207c 3220 2020 2020 2020  L      |2       
+00035dd0: 2020 207c 0a20 2020 2020 2020 202d 2d2d     |.        ---
+00035de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00035df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00035e00: 2d2d 0a20 2020 2020 2020 203c 424c 414e  --.        <BLAN
+00035e10: 4b4c 494e 453e 0a20 2020 2022 2222 0a20  KLINE>.    """. 
+00035e20: 2020 2063 203d 205f 746f 5f63 6f6c 5f69     c = _to_col_i
+00035e30: 665f 7374 725f 6f72 5f69 6e74 2865 2c20  f_str_or_int(e, 
+00035e40: 226e 7469 6c65 2229 0a20 2020 2072 6574  "ntile").    ret
+00035e50: 7572 6e20 6275 696c 7469 6e28 226e 7469  urn builtin("nti
+00035e60: 6c65 2229 2863 290a 0a0a 6465 6620 7065  le")(c)...def pe
+00035e70: 7263 656e 7469 6c65 5f63 6f6e 7428 7065  rcentile_cont(pe
+00035e80: 7263 656e 7469 6c65 3a20 666c 6f61 7429  rcentile: float)
+00035e90: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00035ea0: 2222 220a 2020 2020 5265 7475 726e 2061  """.    Return a
+00035eb0: 2070 6572 6365 6e74 696c 6520 7661 6c75   percentile valu
+00035ec0: 6520 6261 7365 6420 6f6e 2061 2063 6f6e  e based on a con
+00035ed0: 7469 6e75 6f75 7320 6469 7374 7269 6275  tinuous distribu
+00035ee0: 7469 6f6e 206f 6620 7468 650a 2020 2020  tion of the.    
+00035ef0: 696e 7075 7420 636f 6c75 6d6e 2e20 4966  input column. If
+00035f00: 206e 6f20 696e 7075 7420 726f 7720 6c69   no input row li
+00035f10: 6573 2065 7861 6374 6c79 2061 7420 7468  es exactly at th
+00035f20: 6520 6465 7369 7265 6420 7065 7263 656e  e desired percen
+00035f30: 7469 6c65 2c0a 2020 2020 7468 6520 7265  tile,.    the re
+00035f40: 7375 6c74 2069 7320 6361 6c63 756c 6174  sult is calculat
+00035f50: 6564 2075 7369 6e67 206c 696e 6561 7220  ed using linear 
+00035f60: 696e 7465 7270 6f6c 6174 696f 6e20 6f66  interpolation of
+00035f70: 2074 6865 2074 776f 206e 6561 7265 7374   the two nearest
+00035f80: 0a20 2020 2069 6e70 7574 2076 616c 7565  .    input value
+00035f90: 732e 204e 554c 4c20 7661 6c75 6573 2061  s. NULL values a
+00035fa0: 7265 2069 676e 6f72 6564 2069 6e20 7468  re ignored in th
+00035fb0: 6520 6361 6c63 756c 6174 696f 6e2e 0a0a  e calculation...
+00035fc0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00035fd0: 2020 7065 7263 656e 7469 6c65 3a20 7468    percentile: th
+00035fe0: 6520 7065 7263 656e 7469 6c65 206f 6620  e percentile of 
+00035ff0: 7468 6520 7661 6c75 6520 7468 6174 2079  the value that y
+00036000: 6f75 2077 616e 7420 746f 2066 696e 642e  ou want to find.
+00036010: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00036020: 2070 6572 6365 6e74 696c 6520 6d75 7374   percentile must
+00036030: 2062 6520 6120 636f 6e73 7461 6e74 2062   be a constant b
+00036040: 6574 7765 656e 2030 2e30 2061 6e64 2031  etween 0.0 and 1
+00036050: 2e30 2e20 466f 7220 6578 616d 706c 652c  .0. For example,
+00036060: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00036070: 796f 7520 7761 6e74 2074 6f20 6669 6e64  you want to find
+00036080: 2074 6865 2076 616c 7565 2061 7420 7468   the value at th
+00036090: 6520 3930 7468 2070 6572 6365 6e74 696c  e 90th percentil
+000360a0: 652c 2073 7065 6369 6679 2030 2e39 2e0a  e, specify 0.9..
+000360b0: 0a20 2020 2045 7861 6d70 6c65 3a0a 0a20  .    Example:.. 
+000360c0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000360d0: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+000360e0: 6174 6166 7261 6d65 285b 0a20 2020 2020  ataframe([.     
+000360f0: 2020 202e 2e2e 2020 2020 2028 302c 2030     ...     (0, 0
+00036100: 292c 2028 302c 2031 3029 2c20 2830 2c20  ), (0, 10), (0, 
+00036110: 3230 292c 2028 302c 2033 3029 2c20 2830  20), (0, 30), (0
+00036120: 2c20 3430 292c 0a20 2020 2020 2020 202e  , 40),.        .
+00036130: 2e2e 2020 2020 2028 312c 2031 3029 2c20  ..     (1, 10), 
+00036140: 2831 2c20 3230 292c 2028 322c 2031 3029  (1, 20), (2, 10)
+00036150: 2c20 2832 2c20 3230 292c 2028 322c 2032  , (2, 20), (2, 2
+00036160: 3529 2c0a 2020 2020 2020 2020 2e2e 2e20  5),.        ... 
+00036170: 2020 2020 2832 2c20 3330 292c 2028 332c      (2, 30), (3,
+00036180: 2036 3029 2c20 2834 2c20 4e6f 6e65 290a   60), (4, None).
+00036190: 2020 2020 2020 2020 2e2e 2e20 5d2c 2073          ... ], s
+000361a0: 6368 656d 613d 5b22 6b22 2c20 2276 225d  chema=["k", "v"]
+000361b0: 290a 2020 2020 2020 2020 3e3e 3e20 6466  ).        >>> df
+000361c0: 2e67 726f 7570 5f62 7928 226b 2229 2e61  .group_by("k").a
+000361d0: 6767 2870 6572 6365 6e74 696c 655f 636f  gg(percentile_co
+000361e0: 6e74 2830 2e32 3529 2e77 6974 6869 6e5f  nt(0.25).within_
+000361f0: 6772 6f75 7028 2276 2229 2e61 735f 2822  group("v").as_("
+00036200: 7065 7263 656e 7469 6c65 2229 292e 736f  percentile")).so
+00036210: 7274 2822 6b22 292e 636f 6c6c 6563 7428  rt("k").collect(
+00036220: 290a 2020 2020 2020 2020 5b52 6f77 284b  ).        [Row(K
+00036230: 3d30 2c20 5045 5243 454e 5449 4c45 3d44  =0, PERCENTILE=D
+00036240: 6563 696d 616c 2827 3130 2e30 3030 2729  ecimal('10.000')
+00036250: 292c 205c 0a52 6f77 284b 3d31 2c20 5045  ), \.Row(K=1, PE
+00036260: 5243 454e 5449 4c45 3d44 6563 696d 616c  RCENTILE=Decimal
+00036270: 2827 3132 2e35 3030 2729 292c 205c 0a52  ('12.500')), \.R
+00036280: 6f77 284b 3d32 2c20 5045 5243 454e 5449  ow(K=2, PERCENTI
+00036290: 4c45 3d44 6563 696d 616c 2827 3137 2e35  LE=Decimal('17.5
+000362a0: 3030 2729 292c 205c 0a52 6f77 284b 3d33  00')), \.Row(K=3
+000362b0: 2c20 5045 5243 454e 5449 4c45 3d44 6563  , PERCENTILE=Dec
+000362c0: 696d 616c 2827 3630 2e30 3030 2729 292c  imal('60.000')),
+000362d0: 205c 0a52 6f77 284b 3d34 2c20 5045 5243   \.Row(K=4, PERC
+000362e0: 454e 5449 4c45 3d4e 6f6e 6529 5d0a 2020  ENTILE=None)].  
+000362f0: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
+00036300: 2062 7569 6c74 696e 2822 7065 7263 656e   builtin("percen
+00036310: 7469 6c65 5f63 6f6e 7422 2928 7065 7263  tile_cont")(perc
+00036320: 656e 7469 6c65 290a 0a0a 6465 6620 6772  entile)...def gr
+00036330: 6561 7465 7374 282a 636f 6c75 6d6e 733a  eatest(*columns:
+00036340: 2043 6f6c 756d 6e4f 724e 616d 6529 202d   ColumnOrName) -
+00036350: 3e20 436f 6c75 6d6e 3a0a 2020 2020 2222  > Column:.    ""
+00036360: 220a 2020 2020 5265 7475 726e 7320 7468  ".    Returns th
+00036370: 6520 6c61 7267 6573 7420 7661 6c75 6520  e largest value 
+00036380: 6672 6f6d 2061 206c 6973 7420 6f66 2065  from a list of e
+00036390: 7870 7265 7373 696f 6e73 2e0a 2020 2020  xpressions..    
+000363a0: 4966 2061 6e79 206f 6620 7468 6520 6172  If any of the ar
+000363b0: 6775 6d65 6e74 2076 616c 7565 7320 6973  gument values is
+000363c0: 204e 554c 4c2c 2074 6865 2072 6573 756c   NULL, the resul
+000363d0: 7420 6973 204e 554c 4c2e 0a20 2020 2047  t is NULL..    G
+000363e0: 5245 4154 4553 5420 7375 7070 6f72 7473  REATEST supports
+000363f0: 2061 6c6c 2064 6174 6120 7479 7065 732c   all data types,
+00036400: 2069 6e63 6c75 6469 6e67 2056 4152 4941   including VARIA
+00036410: 4e54 2e0a 0a20 2020 2045 7861 6d70 6c65  NT...    Example
+00036420: 733a 3a0a 0a20 2020 2020 2020 203e 3e3e  s::..        >>>
+00036430: 2064 6620 3d20 7365 7373 696f 6e2e 6372   df = session.cr
+00036440: 6561 7465 5f64 6174 6166 7261 6d65 285b  eate_dataframe([
+00036450: 5b31 2c20 322c 2033 5d2c 205b 322c 2034  [1, 2, 3], [2, 4
+00036460: 2c20 2d31 5d2c 205b 332c 2036 2c20 4e6f  , -1], [3, 6, No
+00036470: 6e65 5d5d 2c20 7363 6865 6d61 3d5b 2261  ne]], schema=["a
+00036480: 222c 2022 6222 2c20 2263 225d 290a 2020  ", "b", "c"]).  
+00036490: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+000364a0: 6563 7428 6772 6561 7465 7374 2864 665b  ect(greatest(df[
+000364b0: 2261 225d 2c20 6466 5b22 6222 5d2c 2064  "a"], df["b"], d
+000364c0: 665b 2263 225d 292e 616c 6961 7328 2267  f["c"]).alias("g
+000364d0: 7265 6174 6573 7422 2929 2e63 6f6c 6c65  reatest")).colle
+000364e0: 6374 2829 0a20 2020 2020 2020 205b 526f  ct().        [Ro
+000364f0: 7728 4752 4541 5445 5354 3d33 292c 2052  w(GREATEST=3), R
+00036500: 6f77 2847 5245 4154 4553 543d 3429 2c20  ow(GREATEST=4), 
+00036510: 526f 7728 4752 4541 5445 5354 3d4e 6f6e  Row(GREATEST=Non
+00036520: 6529 5d0a 2020 2020 2222 220a 2020 2020  e)].    """.    
+00036530: 6320 3d20 5b5f 746f 5f63 6f6c 5f69 665f  c = [_to_col_if_
+00036540: 7374 7228 6578 2c20 2267 7265 6174 6573  str(ex, "greates
+00036550: 7422 2920 666f 7220 6578 2069 6e20 636f  t") for ex in co
+00036560: 6c75 6d6e 735d 0a20 2020 2072 6574 7572  lumns].    retur
+00036570: 6e20 6275 696c 7469 6e28 2267 7265 6174  n builtin("great
+00036580: 6573 7422 2928 2a63 290a 0a0a 6465 6620  est")(*c)...def 
+00036590: 6c65 6173 7428 2a63 6f6c 756d 6e73 3a20  least(*columns: 
+000365a0: 436f 6c75 6d6e 4f72 4e61 6d65 2920 2d3e  ColumnOrName) ->
+000365b0: 2043 6f6c 756d 6e3a 0a20 2020 2022 2222   Column:.    """
+000365c0: 0a20 2020 2052 6574 7572 6e73 2074 6865  .    Returns the
+000365d0: 2073 6d61 6c6c 6573 7420 7661 6c75 6520   smallest value 
+000365e0: 6672 6f6d 2061 206c 6973 7420 6f66 2065  from a list of e
+000365f0: 7870 7265 7373 696f 6e73 2e0a 2020 2020  xpressions..    
+00036600: 4966 2061 6e79 206f 6620 7468 6520 6172  If any of the ar
+00036610: 6775 6d65 6e74 2076 616c 7565 7320 6973  gument values is
+00036620: 204e 554c 4c2c 2074 6865 2072 6573 756c   NULL, the resul
+00036630: 7420 6973 204e 554c 4c2e 0a20 2020 204c  t is NULL..    L
+00036640: 4541 5354 2073 7570 706f 7274 7320 616c  EAST supports al
+00036650: 6c20 6461 7461 2074 7970 6573 2c20 696e  l data types, in
+00036660: 636c 7564 696e 6720 5641 5249 414e 542e  cluding VARIANT.
+00036670: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00036680: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00036690: 3d20 7365 7373 696f 6e2e 6372 6561 7465  = session.create
+000366a0: 5f64 6174 6166 7261 6d65 285b 5b31 2c20  _dataframe([[1, 
+000366b0: 322c 2033 5d2c 205b 322c 2034 2c20 2d31  2, 3], [2, 4, -1
+000366c0: 5d2c 205b 332c 2036 2c20 4e6f 6e65 5d5d  ], [3, 6, None]]
+000366d0: 2c20 7363 6865 6d61 3d5b 2261 222c 2022  , schema=["a", "
+000366e0: 6222 2c20 2263 225d 290a 2020 2020 2020  b", "c"]).      
+000366f0: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00036700: 6c65 6173 7428 6466 5b22 6122 5d2c 2064  least(df["a"], d
+00036710: 665b 2262 225d 2c20 6466 5b22 6322 5d29  f["b"], df["c"])
+00036720: 2e61 6c69 6173 2822 6c65 6173 7422 2929  .alias("least"))
+00036730: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+00036740: 2020 205b 526f 7728 4c45 4153 543d 3129     [Row(LEAST=1)
+00036750: 2c20 526f 7728 4c45 4153 543d 2d31 292c  , Row(LEAST=-1),
+00036760: 2052 6f77 284c 4541 5354 3d4e 6f6e 6529   Row(LEAST=None)
+00036770: 5d0a 2020 2020 2222 220a 2020 2020 6320  ].    """.    c 
+00036780: 3d20 5b5f 746f 5f63 6f6c 5f69 665f 7374  = [_to_col_if_st
+00036790: 7228 6578 2c20 226c 6561 7374 2229 2066  r(ex, "least") f
+000367a0: 6f72 2065 7820 696e 2063 6f6c 756d 6e73  or ex in columns
+000367b0: 5d0a 2020 2020 7265 7475 726e 2062 7569  ].    return bui
+000367c0: 6c74 696e 2822 6c65 6173 7422 2928 2a63  ltin("least")(*c
+000367d0: 290a 0a0a 6465 6620 6c69 7374 6167 6728  )...def listagg(
+000367e0: 653a 2043 6f6c 756d 6e4f 724e 616d 652c  e: ColumnOrName,
+000367f0: 2064 656c 696d 6974 6572 3a20 7374 7220   delimiter: str 
+00036800: 3d20 2222 2c20 6973 5f64 6973 7469 6e63  = "", is_distinc
+00036810: 743a 2062 6f6f 6c20 3d20 4661 6c73 6529  t: bool = False)
+00036820: 202d 3e20 436f 6c75 6d6e 3a0a 2020 2020   -> Column:.    
+00036830: 2222 220a 2020 2020 5265 7475 726e 7320  """.    Returns 
+00036840: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
+00036850: 2069 6e70 7574 2076 616c 7565 732c 2073   input values, s
+00036860: 6570 6172 6174 6564 2062 7920 6064 656c  eparated by `del
+00036870: 696d 6974 6572 6020 7374 7269 6e67 2e0a  imiter` string..
+00036880: 2020 2020 5365 6520 604c 4953 5441 4747      See `LISTAGG
+00036890: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+000368a0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+000368b0: 7371 6c2d 7265 6665 7265 6e63 652f 6675  sql-reference/fu
+000368c0: 6e63 7469 6f6e 732f 6c69 7374 6167 672e  nctions/listagg.
+000368d0: 6874 6d6c 3e60 5f20 666f 7220 6465 7461  html>`_ for deta
+000368e0: 696c 732e 0a0a 2020 2020 4172 6773 3a0a  ils...    Args:.
+000368f0: 2020 2020 2020 2020 653a 2041 203a 636c          e: A :cl
+00036900: 6173 733a 6043 6f6c 756d 6e60 206f 626a  ass:`Column` obj
+00036910: 6563 7420 6f72 2063 6f6c 756d 6e20 6e61  ect or column na
+00036920: 6d65 2074 6861 7420 6465 7465 726d 696e  me that determin
+00036930: 6573 2074 6865 2076 616c 7565 730a 2020  es the values.  
+00036940: 2020 2020 2020 2020 2020 746f 2062 6520            to be 
+00036950: 7075 7420 696e 746f 2074 6865 206c 6973  put into the lis
+00036960: 742e 0a20 2020 2020 2020 2064 656c 696d  t..        delim
+00036970: 6974 6572 3a20 4120 7374 7269 6e67 2064  iter: A string d
+00036980: 656c 696d 6974 6572 2e0a 2020 2020 2020  elimiter..      
+00036990: 2020 6973 5f64 6973 7469 6e63 743a 2057    is_distinct: W
+000369a0: 6865 7468 6572 2074 6865 2069 6e70 7574  hether the input
+000369b0: 2065 7870 7265 7373 696f 6e20 6973 2064   expression is d
+000369c0: 6973 7469 6e63 742e 0a0a 2020 2020 4578  istinct...    Ex
+000369d0: 616d 706c 6573 3a3a 0a0a 2020 2020 2020  amples::..      
+000369e0: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+000369f0: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00036a00: 616d 6528 5b31 2c20 322c 2033 2c20 322c  ame([1, 2, 3, 2,
+00036a10: 2034 2c20 355d 2c20 7363 6865 6d61 3d5b   4, 5], schema=[
+00036a20: 2263 6f6c 225d 290a 2020 2020 2020 2020  "col"]).        
+00036a30: 3e3e 3e20 6466 2e73 656c 6563 7428 6c69  >>> df.select(li
+00036a40: 7374 6167 6728 2263 6f6c 222c 2022 2c22  stagg("col", ","
+00036a50: 292e 7769 7468 696e 5f67 726f 7570 2864  ).within_group(d
+00036a60: 665b 2263 6f6c 225d 2e61 7363 2829 292e  f["col"].asc()).
+00036a70: 6173 5f28 2272 6573 756c 7422 2929 2e63  as_("result")).c
+00036a80: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+00036a90: 205b 526f 7728 5245 5355 4c54 3d27 312c   [Row(RESULT='1,
+00036aa0: 322c 322c 332c 342c 3527 295d 0a20 2020  2,2,3,4,5')].   
+00036ab0: 2022 2222 0a20 2020 2063 203d 205f 746f   """.    c = _to
+00036ac0: 5f63 6f6c 5f69 665f 7374 7228 652c 2022  _col_if_str(e, "
+00036ad0: 6c69 7374 6167 6722 290a 2020 2020 7265  listagg").    re
+00036ae0: 7475 726e 2043 6f6c 756d 6e28 4c69 7374  turn Column(List
+00036af0: 4167 6728 632e 5f65 7870 7265 7373 696f  Agg(c._expressio
+00036b00: 6e2c 2064 656c 696d 6974 6572 2c20 6973  n, delimiter, is
+00036b10: 5f64 6973 7469 6e63 7429 290a 0a0a 6465  _distinct))...de
+00036b20: 6620 7768 656e 5f6d 6174 6368 6564 280a  f when_matched(.
+00036b30: 2020 2020 636f 6e64 6974 696f 6e3a 204f      condition: O
+00036b40: 7074 696f 6e61 6c5b 436f 6c75 6d6e 5d20  ptional[Column] 
+00036b50: 3d20 4e6f 6e65 2c0a 2920 2d3e 2022 736e  = None,.) -> "sn
+00036b60: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00036b70: 2e74 6162 6c65 2e57 6865 6e4d 6174 6368  .table.WhenMatch
+00036b80: 6564 436c 6175 7365 223a 0a20 2020 2022  edClause":.    "
+00036b90: 2222 0a20 2020 2053 7065 6369 6669 6573  "".    Specifies
+00036ba0: 2061 206d 6174 6368 6564 2063 6c61 7573   a matched claus
+00036bb0: 6520 666f 7220 7468 6520 3a6d 6574 683a  e for the :meth:
+00036bc0: 6054 6162 6c65 2e6d 6572 6765 203c 736e  `Table.merge <sn
+00036bd0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00036be0: 2e54 6162 6c65 2e6d 6572 6765 3e60 2061  .Table.merge>` a
+00036bf0: 6374 696f 6e2e 0a20 2020 2053 6565 203a  ction..    See :
+00036c00: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00036c10: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
+00036c20: 2e57 6865 6e4d 6174 6368 6564 436c 6175  .WhenMatchedClau
+00036c30: 7365 6020 666f 7220 6465 7461 696c 732e  se` for details.
+00036c40: 0a0a 2020 2020 436f 6e76 656e 6965 6e63  ..    Convenienc
+00036c50: 6520 6675 6e63 7469 6f6e 2074 6f20 6372  e function to cr
+00036c60: 6561 7465 2061 206e 6577 2057 6865 6e4d  eate a new WhenM
+00036c70: 6174 6368 6564 436c 6175 7365 2069 6e73  atchedClause ins
+00036c80: 7461 6e63 6520 7768 6963 6820 6973 2072  tance which is r
+00036c90: 6571 7569 7265 6420 746f 6765 7468 6572  equired together
+00036ca0: 2077 6974 6820 616e 2061 6374 696f 6e20   with an action 
+00036cb0: 7768 656e 206d 6572 6769 6e67 0a20 2020  when merging.   
+00036cc0: 2061 2053 6e6f 7770 6172 6b20 7461 626c   a Snowpark tabl
+00036cd0: 6520 7769 7468 2061 2053 6e6f 7770 6172  e with a Snowpar
+00036ce0: 6b20 4461 7461 4672 616d 6520 2873 6565  k DataFrame (see
+00036cf0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00036d00: 6172 6b2e 5461 626c 652e 6d65 7267 6520  ark.Table.merge 
+00036d10: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
+00036d20: 292e 0a0a 2020 2020 4578 616d 706c 653a  )...    Example:
+00036d30: 3a0a 0a20 2020 2020 2020 203e 3e3e 2074  :..        >>> t
+00036d40: 6172 6765 745f 6466 203d 2073 6573 7369  arget_df = sessi
+00036d50: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+00036d60: 616d 6528 5b28 3130 2c20 226f 6c64 2229  ame([(10, "old")
+00036d70: 2c20 2831 302c 2022 746f 6f5f 6f6c 6422  , (10, "too_old"
+00036d80: 292c 2028 3131 2c20 226f 6c64 2229 5d2c  ), (11, "old")],
+00036d90: 2073 6368 656d 613d 5b22 6b65 7922 2c20   schema=["key", 
+00036da0: 2276 616c 7565 225d 290a 2020 2020 2020  "value"]).      
+00036db0: 2020 3e3e 3e20 7461 7267 6574 5f64 662e    >>> target_df.
+00036dc0: 7772 6974 652e 7361 7665 5f61 735f 7461  write.save_as_ta
+00036dd0: 626c 6528 226d 795f 7461 626c 6522 2c20  ble("my_table", 
+00036de0: 6d6f 6465 3d22 6f76 6572 7772 6974 6522  mode="overwrite"
+00036df0: 2c20 7461 626c 655f 7479 7065 3d22 7465  , table_type="te
+00036e00: 6d70 6f72 6172 7922 290a 2020 2020 2020  mporary").      
+00036e10: 2020 3e3e 3e20 7461 7267 6574 203d 2073    >>> target = s
+00036e20: 6573 7369 6f6e 2e74 6162 6c65 2822 6d79  ession.table("my
+00036e30: 5f74 6162 6c65 2229 0a20 2020 2020 2020  _table").       
+00036e40: 203e 3e3e 2073 6f75 7263 6520 3d20 7365   >>> source = se
+00036e50: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+00036e60: 6166 7261 6d65 285b 2831 302c 2022 6e65  aframe([(10, "ne
+00036e70: 7722 292c 2028 3132 2c20 226e 6577 2229  w"), (12, "new")
+00036e80: 2c20 2831 332c 2022 6f6c 6422 295d 2c20  , (13, "old")], 
+00036e90: 7363 6865 6d61 3d5b 226b 6579 222c 2022  schema=["key", "
+00036ea0: 7661 6c75 6522 5d29 0a20 2020 2020 2020  value"]).       
+00036eb0: 203e 3e3e 2074 6172 6765 742e 6d65 7267   >>> target.merg
+00036ec0: 6528 736f 7572 6365 2c20 2874 6172 6765  e(source, (targe
+00036ed0: 745b 226b 6579 225d 203d 3d20 736f 7572  t["key"] == sour
+00036ee0: 6365 5b22 6b65 7922 5d29 2026 2028 7461  ce["key"]) & (ta
+00036ef0: 7267 6574 5b22 7661 6c75 6522 5d20 3d3d  rget["value"] ==
+00036f00: 2022 746f 6f5f 6f6c 6422 292c 0a20 2020   "too_old"),.   
+00036f10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00036f20: 2020 2020 2020 5b77 6865 6e5f 6d61 7463        [when_matc
+00036f30: 6865 6428 292e 7570 6461 7465 287b 2276  hed().update({"v
+00036f40: 616c 7565 223a 2073 6f75 7263 655b 2276  alue": source["v
+00036f50: 616c 7565 225d 7d29 5d29 0a20 2020 2020  alue"]})]).     
+00036f60: 2020 204d 6572 6765 5265 7375 6c74 2872     MergeResult(r
+00036f70: 6f77 735f 696e 7365 7274 6564 3d30 2c20  ows_inserted=0, 
+00036f80: 726f 7773 5f75 7064 6174 6564 3d31 2c20  rows_updated=1, 
+00036f90: 726f 7773 5f64 656c 6574 6564 3d30 290a  rows_deleted=0).
+00036fa0: 2020 2020 2020 2020 3e3e 3e20 7461 7267          >>> targ
+00036fb0: 6574 2e63 6f6c 6c65 6374 2829 0a20 2020  et.collect().   
+00036fc0: 2020 2020 205b 526f 7728 4b45 593d 3130       [Row(KEY=10
+00036fd0: 2c20 5641 4c55 453d 276f 6c64 2729 2c20  , VALUE='old'), 
+00036fe0: 526f 7728 4b45 593d 3130 2c20 5641 4c55  Row(KEY=10, VALU
+00036ff0: 453d 276e 6577 2729 2c20 526f 7728 4b45  E='new'), Row(KE
+00037000: 593d 3131 2c20 5641 4c55 453d 276f 6c64  Y=11, VALUE='old
+00037010: 2729 5d0a 0a20 2020 2022 2222 0a20 2020  ')]..    """.   
+00037020: 2072 6574 7572 6e20 736e 6f77 666c 616b   return snowflak
+00037030: 652e 736e 6f77 7061 726b 2e74 6162 6c65  e.snowpark.table
+00037040: 2e57 6865 6e4d 6174 6368 6564 436c 6175  .WhenMatchedClau
+00037050: 7365 2863 6f6e 6469 7469 6f6e 290a 0a0a  se(condition)...
+00037060: 6465 6620 7768 656e 5f6e 6f74 5f6d 6174  def when_not_mat
+00037070: 6368 6564 280a 2020 2020 636f 6e64 6974  ched(.    condit
+00037080: 696f 6e3a 204f 7074 696f 6e61 6c5b 436f  ion: Optional[Co
+00037090: 6c75 6d6e 5d20 3d20 4e6f 6e65 2c0a 2920  lumn] = None,.) 
+000370a0: 2d3e 2022 736e 6f77 666c 616b 652e 736e  -> "snowflake.sn
+000370b0: 6f77 7061 726b 2e74 6162 6c65 2e57 6865  owpark.table.Whe
+000370c0: 6e4e 6f74 4d61 7463 6865 6443 6c61 7573  nNotMatchedClaus
+000370d0: 6522 3a0a 2020 2020 2222 220a 2020 2020  e":.    """.    
+000370e0: 5370 6563 6966 6965 7320 6120 6e6f 742d  Specifies a not-
+000370f0: 6d61 7463 6865 6420 636c 6175 7365 2066  matched clause f
+00037100: 6f72 2074 6865 203a 6d65 7468 3a60 5461  or the :meth:`Ta
+00037110: 626c 652e 6d65 7267 6520 3c73 6e6f 7766  ble.merge <snowf
+00037120: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5461  lake.snowpark.Ta
+00037130: 626c 652e 6d65 7267 653e 6020 6163 7469  ble.merge>` acti
+00037140: 6f6e 2e0a 2020 2020 5365 6520 3a63 6c61  on..    See :cla
+00037150: 7373 3a60 7e73 6e6f 7766 6c61 6b65 2e73  ss:`~snowflake.s
+00037160: 6e6f 7770 6172 6b2e 7461 626c 652e 5768  nowpark.table.Wh
+00037170: 656e 4e6f 744d 6174 6368 6564 436c 6175  enNotMatchedClau
+00037180: 7365 6020 666f 7220 6465 7461 696c 732e  se` for details.
+00037190: 0a0a 2020 2020 436f 6e76 656e 6965 6e63  ..    Convenienc
+000371a0: 6520 6675 6e63 7469 6f6e 2074 6f20 6372  e function to cr
+000371b0: 6561 7465 2061 206e 6577 2057 6865 6e4e  eate a new WhenN
+000371c0: 6f74 4d61 7463 6865 6443 6c61 7573 6520  otMatchedClause 
+000371d0: 696e 7374 616e 6365 2077 6869 6368 2069  instance which i
+000371e0: 7320 7265 7175 6972 6564 2074 6f67 6574  s required toget
+000371f0: 6865 7220 7769 7468 2061 6e20 6163 7469  her with an acti
+00037200: 6f6e 2077 6865 6e20 6d65 7267 696e 670a  on when merging.
+00037210: 2020 2020 6120 536e 6f77 7061 726b 2074      a Snowpark t
+00037220: 6162 6c65 2077 6974 6820 6120 536e 6f77  able with a Snow
+00037230: 7061 726b 2044 6174 6146 7261 6d65 2028  park DataFrame (
+00037240: 7365 6520 736e 6f77 666c 616b 652e 736e  see snowflake.sn
+00037250: 6f77 7061 726b 2e54 6162 6c65 2e6d 6572  owpark.Table.mer
+00037260: 6765 2066 6f72 206d 6f72 6520 6465 7461  ge for more deta
+00037270: 696c 7329 2e0a 0a20 2020 2045 7861 6d70  ils)...    Examp
+00037280: 6c65 3a3a 0a0a 2020 2020 2020 2020 3e3e  le::..        >>
+00037290: 3e20 7461 7267 6574 5f64 6620 3d20 7365  > target_df = se
+000372a0: 7373 696f 6e2e 6372 6561 7465 5f64 6174  ssion.create_dat
+000372b0: 6166 7261 6d65 285b 2831 302c 2022 6f6c  aframe([(10, "ol
+000372c0: 6422 292c 2028 3130 2c20 2274 6f6f 5f6f  d"), (10, "too_o
+000372d0: 6c64 2229 2c20 2831 312c 2022 6f6c 6422  ld"), (11, "old"
+000372e0: 295d 2c20 7363 6865 6d61 3d5b 226b 6579  )], schema=["key
+000372f0: 222c 2022 7661 6c75 6522 5d29 0a20 2020  ", "value"]).   
+00037300: 2020 2020 203e 3e3e 2074 6172 6765 745f       >>> target_
+00037310: 6466 2e77 7269 7465 2e73 6176 655f 6173  df.write.save_as
+00037320: 5f74 6162 6c65 2822 6d79 5f74 6162 6c65  _table("my_table
+00037330: 222c 206d 6f64 653d 226f 7665 7277 7269  ", mode="overwri
+00037340: 7465 222c 2074 6162 6c65 5f74 7970 653d  te", table_type=
+00037350: 2274 656d 706f 7261 7279 2229 0a20 2020  "temporary").   
+00037360: 2020 2020 203e 3e3e 2074 6172 6765 7420       >>> target 
+00037370: 3d20 7365 7373 696f 6e2e 7461 626c 6528  = session.table(
+00037380: 226d 795f 7461 626c 6522 290a 2020 2020  "my_table").    
+00037390: 2020 2020 3e3e 3e20 736f 7572 6365 203d      >>> source =
+000373a0: 2073 6573 7369 6f6e 2e63 7265 6174 655f   session.create_
+000373b0: 6461 7461 6672 616d 6528 5b28 3130 2c20  dataframe([(10, 
+000373c0: 226e 6577 2229 2c20 2831 322c 2022 6e65  "new"), (12, "ne
+000373d0: 7722 292c 2028 3133 2c20 226f 6c64 2229  w"), (13, "old")
+000373e0: 5d2c 2073 6368 656d 613d 5b22 6b65 7922  ], schema=["key"
+000373f0: 2c20 2276 616c 7565 225d 290a 2020 2020  , "value"]).    
+00037400: 2020 2020 3e3e 3e20 7461 7267 6574 2e6d      >>> target.m
+00037410: 6572 6765 2873 6f75 7263 652c 2028 7461  erge(source, (ta
+00037420: 7267 6574 5b22 6b65 7922 5d20 3d3d 2073  rget["key"] == s
+00037430: 6f75 7263 655b 226b 6579 225d 2920 2620  ource["key"]) & 
+00037440: 2874 6172 6765 745b 2276 616c 7565 225d  (target["value"]
+00037450: 203d 3d20 2274 6f6f 5f6f 6c64 2229 2c0a   == "too_old"),.
+00037460: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00037470: 2020 2020 2020 2020 205b 7768 656e 5f6e           [when_n
+00037480: 6f74 5f6d 6174 6368 6564 2829 2e69 6e73  ot_matched().ins
+00037490: 6572 7428 7b22 6b65 7922 3a20 736f 7572  ert({"key": sour
+000374a0: 6365 5b22 6b65 7922 5d7d 295d 290a 2020  ce["key"]})]).  
+000374b0: 2020 2020 2020 4d65 7267 6552 6573 756c        MergeResul
+000374c0: 7428 726f 7773 5f69 6e73 6572 7465 643d  t(rows_inserted=
+000374d0: 322c 2072 6f77 735f 7570 6461 7465 643d  2, rows_updated=
+000374e0: 302c 2072 6f77 735f 6465 6c65 7465 643d  0, rows_deleted=
+000374f0: 3029 0a20 2020 2020 2020 203e 3e3e 2074  0).        >>> t
+00037500: 6172 6765 742e 736f 7274 2863 6f6c 2822  arget.sort(col("
+00037510: 6b65 7922 292c 2063 6f6c 2822 7661 6c75  key"), col("valu
+00037520: 6522 2929 2e63 6f6c 6c65 6374 2829 0a20  e")).collect(). 
+00037530: 2020 2020 2020 205b 526f 7728 4b45 593d         [Row(KEY=
+00037540: 3130 2c20 5641 4c55 453d 276f 6c64 2729  10, VALUE='old')
+00037550: 2c20 526f 7728 4b45 593d 3130 2c20 5641  , Row(KEY=10, VA
+00037560: 4c55 453d 2774 6f6f 5f6f 6c64 2729 2c20  LUE='too_old'), 
+00037570: 526f 7728 4b45 593d 3131 2c20 5641 4c55  Row(KEY=11, VALU
+00037580: 453d 276f 6c64 2729 2c20 526f 7728 4b45  E='old'), Row(KE
+00037590: 593d 3132 2c20 5641 4c55 453d 4e6f 6e65  Y=12, VALUE=None
+000375a0: 292c 2052 6f77 284b 4559 3d31 332c 2056  ), Row(KEY=13, V
+000375b0: 414c 5545 3d4e 6f6e 6529 5d0a 2020 2020  ALUE=None)].    
+000375c0: 2222 220a 2020 2020 7265 7475 726e 2073  """.    return s
+000375d0: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+000375e0: 6b2e 7461 626c 652e 5768 656e 4e6f 744d  k.table.WhenNotM
+000375f0: 6174 6368 6564 436c 6175 7365 2863 6f6e  atchedClause(con
+00037600: 6469 7469 6f6e 290a 0a0a 6465 6620 7564  dition)...def ud
+00037610: 6628 0a20 2020 2066 756e 633a 204f 7074  f(.    func: Opt
+00037620: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
+00037630: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
+00037640: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
+00037650: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
+00037660: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
+00037670: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
+00037680: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
+00037690: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
+000376a0: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
+000376b0: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
+000376c0: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
+000376d0: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
+000376e0: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+000376f0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
+00037700: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+00037710: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00037720: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
+00037730: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
+00037740: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
+00037750: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
+00037760: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
+00037770: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
+00037780: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
+00037790: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
+000377a0: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
+000377b0: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
+000377c0: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
+000377d0: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
+000377e0: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
+000377f0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00037800: 2e73 6573 7369 6f6e 2e53 6573 7369 6f6e  .session.Session
+00037810: 225d 203d 204e 6f6e 652c 0a20 2020 2070  "] = None,.    p
+00037820: 6172 616c 6c65 6c3a 2069 6e74 203d 2034  arallel: int = 4
+00037830: 2c0a 2020 2020 6d61 785f 6261 7463 685f  ,.    max_batch_
+00037840: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b69  size: Optional[i
+00037850: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+00037860: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
+00037870: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
+00037880: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
+00037890: 652c 0a20 2020 2073 6f75 7263 655f 636f  e,.    source_co
+000378a0: 6465 5f64 6973 706c 6179 3a20 626f 6f6c  de_display: bool
+000378b0: 203d 2054 7275 652c 0a20 2020 2073 7472   = True,.    str
+000378c0: 6963 743a 2062 6f6f 6c20 3d20 4661 6c73  ict: bool = Fals
+000378d0: 652c 0a20 2020 2073 6563 7572 653a 2062  e,.    secure: b
+000378e0: 6f6f 6c20 3d20 4661 6c73 652c 0a29 202d  ool = False,.) -
+000378f0: 3e20 556e 696f 6e5b 5573 6572 4465 6669  > Union[UserDefi
+00037900: 6e65 6446 756e 6374 696f 6e2c 2066 756e  nedFunction, fun
+00037910: 6374 6f6f 6c73 2e70 6172 7469 616c 5d3a  ctools.partial]:
+00037920: 0a20 2020 2022 2222 5265 6769 7374 6572  .    """Register
+00037930: 7320 6120 5079 7468 6f6e 2066 756e 6374  s a Python funct
+00037940: 696f 6e20 6173 2061 2053 6e6f 7766 6c61  ion as a Snowfla
+00037950: 6b65 2050 7974 686f 6e20 5544 4620 616e  ke Python UDF an
+00037960: 6420 7265 7475 726e 7320 7468 6520 5544  d returns the UD
+00037970: 462e 0a0a 2020 2020 4974 2063 616e 2062  F...    It can b
+00037980: 6520 7573 6564 2061 7320 6569 7468 6572  e used as either
+00037990: 2061 2066 756e 6374 696f 6e20 6361 6c6c   a function call
+000379a0: 206f 7220 6120 6465 636f 7261 746f 722e   or a decorator.
+000379b0: 2049 6e20 6d6f 7374 2063 6173 6573 2079   In most cases y
+000379c0: 6f75 2077 6f72 6b20 7769 7468 2061 2073  ou work with a s
+000379d0: 696e 676c 6520 7365 7373 696f 6e2e 0a20  ingle session.. 
+000379e0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+000379f0: 2075 7365 7320 7468 6174 2073 6573 7369   uses that sessi
+00037a00: 6f6e 2074 6f20 7265 6769 7374 6572 2074  on to register t
+00037a10: 6865 2055 4446 2e20 4966 2079 6f75 2068  he UDF. If you h
+00037a20: 6176 6520 6d75 6c74 6970 6c65 2073 6573  ave multiple ses
+00037a30: 7369 6f6e 732c 2079 6f75 206e 6565 6420  sions, you need 
+00037a40: 746f 0a20 2020 2065 7870 6c69 6369 746c  to.    explicitl
+00037a50: 7920 7370 6563 6966 7920 7468 6520 6060  y specify the ``
+00037a60: 7365 7373 696f 6e60 6020 7061 7261 6d65  session`` parame
+00037a70: 7465 7220 6f66 2074 6869 7320 6675 6e63  ter of this func
+00037a80: 7469 6f6e 2e20 4966 2079 6f75 2068 6176  tion. If you hav
+00037a90: 6520 6120 6675 6e63 7469 6f6e 2061 6e64  e a function and
+00037aa0: 2077 6f75 6c64 0a20 2020 206c 696b 6520   would.    like 
+00037ab0: 746f 2072 6567 6973 7465 7220 6974 2074  to register it t
+00037ac0: 6f20 6d75 6c74 6970 6c65 2064 6174 6162  o multiple datab
+00037ad0: 6173 6573 2c20 7573 6520 6060 7365 7373  ases, use ``sess
+00037ae0: 696f 6e2e 7564 662e 7265 6769 7374 6572  ion.udf.register
+00037af0: 6060 2069 6e73 7465 6164 2e20 5365 6520  `` instead. See 
+00037b00: 6578 616d 706c 6573 0a20 2020 2069 6e20  examples.    in 
+00037b10: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
+00037b20: 6b65 2e73 6e6f 7770 6172 6b2e 7564 662e  ke.snowpark.udf.
+00037b30: 5544 4652 6567 6973 7472 6174 696f 6e60  UDFRegistration`
+00037b40: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+00037b50: 2020 2020 2066 756e 633a 2041 2050 7974       func: A Pyt
+00037b60: 686f 6e20 6675 6e63 7469 6f6e 2075 7365  hon function use
+00037b70: 6420 666f 7220 6372 6561 7469 6e67 2074  d for creating t
+00037b80: 6865 2055 4446 2e0a 2020 2020 2020 2020  he UDF..        
+00037b90: 7265 7475 726e 5f74 7970 653a 2041 203a  return_type: A :
+00037ba0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+00037bb0: 652e 736e 6f77 7061 726b 2e74 7970 6573  e.snowpark.types
+00037bc0: 2e44 6174 6154 7970 6560 2072 6570 7265  .DataType` repre
+00037bd0: 7365 6e74 696e 6720 7468 6520 7265 7475  senting the retu
+00037be0: 726e 2064 6174 610a 2020 2020 2020 2020  rn data.        
+00037bf0: 2020 2020 7479 7065 206f 6620 7468 6520      type of the 
+00037c00: 5544 462e 204f 7074 696f 6e61 6c20 6966  UDF. Optional if
+00037c10: 2074 7970 6520 6869 6e74 7320 6172 6520   type hints are 
+00037c20: 7072 6f76 6964 6564 2e0a 2020 2020 2020  provided..      
+00037c30: 2020 696e 7075 745f 7479 7065 733a 2041    input_types: A
+00037c40: 206c 6973 7420 6f66 203a 636c 6173 733a   list of :class:
+00037c50: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+00037c60: 7061 726b 2e74 7970 6573 2e44 6174 6154  park.types.DataT
+00037c70: 7970 6560 0a20 2020 2020 2020 2020 2020  ype`.           
+00037c80: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+00037c90: 6520 696e 7075 7420 6461 7461 2074 7970  e input data typ
+00037ca0: 6573 206f 6620 7468 6520 5544 462e 204f  es of the UDF. O
+00037cb0: 7074 696f 6e61 6c20 6966 0a20 2020 2020  ptional if.     
+00037cc0: 2020 2020 2020 2074 7970 6520 6869 6e74         type hint
+00037cd0: 7320 6172 6520 7072 6f76 6964 6564 2e0a  s are provided..
+00037ce0: 2020 2020 2020 2020 6e61 6d65 3a20 4120          name: A 
+00037cf0: 7374 7269 6e67 206f 7220 6c69 7374 206f  string or list o
+00037d00: 6620 7374 7269 6e67 7320 7468 6174 2073  f strings that s
+00037d10: 7065 6369 6679 2074 6865 206e 616d 6520  pecify the name 
+00037d20: 6f72 2066 756c 6c79 2d71 7561 6c69 6669  or fully-qualifi
+00037d30: 6564 0a20 2020 2020 2020 2020 2020 206f  ed.            o
+00037d40: 626a 6563 7420 6964 656e 7469 6669 6572  bject identifier
+00037d50: 2028 6461 7461 6261 7365 206e 616d 652c   (database name,
+00037d60: 2073 6368 656d 6120 6e61 6d65 2c20 616e   schema name, an
+00037d70: 6420 6675 6e63 7469 6f6e 206e 616d 6529  d function name)
+00037d80: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
+00037d90: 2074 6865 2055 4446 2069 6e20 536e 6f77   the UDF in Snow
+00037da0: 666c 616b 652c 2077 6869 6368 2061 6c6c  flake, which all
+00037db0: 6f77 7320 796f 7520 746f 2063 616c 6c20  ows you to call 
+00037dc0: 7468 6973 2055 4446 2069 6e20 6120 5351  this UDF in a SQ
+00037dd0: 4c0a 2020 2020 2020 2020 2020 2020 636f  L.            co
+00037de0: 6d6d 616e 6420 6f72 2076 6961 203a 6675  mmand or via :fu
+00037df0: 6e63 3a60 6361 6c6c 5f75 6466 2829 602e  nc:`call_udf()`.
+00037e00: 2049 6620 6974 2069 7320 6e6f 7420 7072   If it is not pr
+00037e10: 6f76 6964 6564 2c20 6120 6e61 6d65 2077  ovided, a name w
+00037e20: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+00037e30: 6265 2061 7574 6f6d 6174 6963 616c 6c79  be automatically
+00037e40: 2067 656e 6572 6174 6564 2066 6f72 2074   generated for t
+00037e50: 6865 2055 4446 2e20 4120 6e61 6d65 206d  he UDF. A name m
+00037e60: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+00037e70: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
+00037e80: 2020 6060 6973 5f70 6572 6d61 6e65 6e74    ``is_permanent
+00037e90: 6060 2069 7320 6060 5472 7565 6060 2e0a  `` is ``True``..
+00037ea0: 2020 2020 2020 2020 6973 5f70 6572 6d61          is_perma
+00037eb0: 6e65 6e74 3a20 5768 6574 6865 7220 746f  nent: Whether to
+00037ec0: 2063 7265 6174 6520 6120 7065 726d 616e   create a perman
+00037ed0: 656e 7420 5544 462e 2054 6865 2064 6566  ent UDF. The def
+00037ee0: 6175 6c74 2069 7320 6060 4661 6c73 6560  ault is ``False`
+00037ef0: 602e 0a20 2020 2020 2020 2020 2020 2049  `..            I
+00037f00: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
+00037f10: 2c20 6120 7661 6c69 6420 6060 7374 6167  , a valid ``stag
+00037f20: 655f 6c6f 6361 7469 6f6e 6060 206d 7573  e_location`` mus
+00037f30: 7420 6265 2070 726f 7669 6465 642e 0a20  t be provided.. 
+00037f40: 2020 2020 2020 2073 7461 6765 5f6c 6f63         stage_loc
+00037f50: 6174 696f 6e3a 2054 6865 2073 7461 6765  ation: The stage
+00037f60: 206c 6f63 6174 696f 6e20 7768 6572 6520   location where 
+00037f70: 7468 6520 5079 7468 6f6e 2066 696c 6520  the Python file 
+00037f80: 666f 7220 7468 6520 5544 460a 2020 2020  for the UDF.    
+00037f90: 2020 2020 2020 2020 616e 6420 6974 7320          and its 
+00037fa0: 6465 7065 6e64 656e 6369 6573 2073 686f  dependencies sho
+00037fb0: 756c 6420 6265 2075 706c 6f61 6465 642e  uld be uploaded.
+00037fc0: 2054 6865 2073 7461 6765 206c 6f63 6174   The stage locat
+00037fd0: 696f 6e20 6d75 7374 2062 6520 7370 6563  ion must be spec
+00037fe0: 6966 6965 640a 2020 2020 2020 2020 2020  ified.          
+00037ff0: 2020 7768 656e 2060 6069 735f 7065 726d    when ``is_perm
+00038000: 616e 656e 7460 6020 6973 2060 6054 7275  anent`` is ``Tru
+00038010: 6560 602c 2061 6e64 2069 7420 7769 6c6c  e``, and it will
+00038020: 2062 6520 6967 6e6f 7265 6420 7768 656e   be ignored when
+00038030: 0a20 2020 2020 2020 2020 2020 2060 6069  .            ``i
+00038040: 735f 7065 726d 616e 656e 7460 6020 6973  s_permanent`` is
+00038050: 2060 6046 616c 7365 6060 2e20 4974 2063   ``False``. It c
+00038060: 616e 2062 6520 616e 7920 7374 6167 6520  an be any stage 
+00038070: 6f74 6865 7220 7468 616e 2074 656d 706f  other than tempo
+00038080: 7261 7279 0a20 2020 2020 2020 2020 2020  rary.           
+00038090: 2073 7461 6765 7320 616e 6420 6578 7465   stages and exte
+000380a0: 726e 616c 2073 7461 6765 732e 0a20 2020  rnal stages..   
+000380b0: 2020 2020 2069 6d70 6f72 7473 3a20 4120       imports: A 
+000380c0: 6c69 7374 206f 6620 696d 706f 7274 7320  list of imports 
+000380d0: 7468 6174 206f 6e6c 7920 6170 706c 7920  that only apply 
+000380e0: 746f 2074 6869 7320 5544 462e 2059 6f75  to this UDF. You
+000380f0: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
+00038100: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
+00038110: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
+00038120: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
+00038130: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
+00038140: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
+00038150: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+00038160: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00038170: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+00038180: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
+00038190: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
+000381a0: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
+000381b0: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
+000381c0: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
+000381d0: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
+000381e0: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
+000381f0: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
+00038200: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
+00038210: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
+00038220: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+00038230: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+00038240: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
+00038250: 2054 6865 7365 2055 4446 2d6c 6576 656c   These UDF-level
+00038260: 2069 6d70 6f72 7473 0a20 2020 2020 2020   imports.       
+00038270: 2020 2020 2077 696c 6c20 6f76 6572 7269       will overri
+00038280: 6465 2074 6865 2073 6573 7369 6f6e 2d6c  de the session-l
+00038290: 6576 656c 2069 6d70 6f72 7473 2061 6464  evel imports add
+000382a0: 6564 2062 790a 2020 2020 2020 2020 2020  ed by.          
+000382b0: 2020 3a6d 6574 683a 607e 736e 6f77 666c    :meth:`~snowfl
+000382c0: 616b 652e 736e 6f77 7061 726b 2e53 6573  ake.snowpark.Ses
+000382d0: 7369 6f6e 2e61 6464 5f69 6d70 6f72 7460  sion.add_import`
+000382e0: 2e20 4e6f 7465 2074 6861 7420 616e 2065  . Note that an e
+000382f0: 6d70 7479 206c 6973 7420 6d65 616e 730a  mpty list means.
+00038300: 2020 2020 2020 2020 2020 2020 6e6f 2069              no i
+00038310: 6d70 6f72 7420 666f 7220 7468 6973 2055  mport for this U
+00038320: 4446 2c20 616e 6420 6060 4e6f 6e65 6060  DF, and ``None``
+00038330: 206f 7220 6e6f 7420 7370 6563 6966 7969   or not specifyi
+00038340: 6e67 2074 6869 7320 7061 7261 6d65 7465  ng this paramete
+00038350: 7220 6d65 616e 7320 7573 696e 670a 2020  r means using.  
+00038360: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
+00038370: 6e2d 6c65 7665 6c20 696d 706f 7274 732e  n-level imports.
+00038380: 0a20 2020 2020 2020 2070 6163 6b61 6765  .        package
+00038390: 733a 2041 206c 6973 7420 6f66 2070 6163  s: A list of pac
+000383a0: 6b61 6765 7320 7468 6174 206f 6e6c 7920  kages that only 
+000383b0: 6170 706c 7920 746f 2074 6869 7320 5544  apply to this UD
+000383c0: 462e 2054 6865 7365 2055 4446 2d6c 6576  F. These UDF-lev
+000383d0: 656c 2070 6163 6b61 6765 730a 2020 2020  el packages.    
+000383e0: 2020 2020 2020 2020 7769 6c6c 206f 7665          will ove
+000383f0: 7272 6964 6520 7468 6520 7365 7373 696f  rride the sessio
+00038400: 6e2d 6c65 7665 6c20 7061 636b 6167 6573  n-level packages
+00038410: 2061 6464 6564 2062 790a 2020 2020 2020   added by.      
+00038420: 2020 2020 2020 3a6d 6574 683a 607e 736e        :meth:`~sn
+00038430: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+00038440: 2e53 6573 7369 6f6e 2e61 6464 5f70 6163  .Session.add_pac
+00038450: 6b61 6765 7360 2061 6e64 0a20 2020 2020  kages` and.     
+00038460: 2020 2020 2020 203a 6d65 7468 3a60 7e73         :meth:`~s
+00038470: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00038480: 6b2e 5365 7373 696f 6e2e 6164 645f 7265  k.Session.add_re
+00038490: 7175 6972 656d 656e 7473 602e 204e 6f74  quirements`. Not
+000384a0: 6520 7468 6174 2061 6e20 656d 7074 7920  e that an empty 
+000384b0: 6c69 7374 206d 6561 6e73 0a20 2020 2020  list means.     
+000384c0: 2020 2020 2020 206e 6f20 7061 636b 6167         no packag
+000384d0: 6520 666f 7220 7468 6973 2055 4446 2c20  e for this UDF, 
+000384e0: 616e 6420 6060 4e6f 6e65 6060 206f 7220  and ``None`` or 
+000384f0: 6e6f 7420 7370 6563 6966 7969 6e67 2074  not specifying t
+00038500: 6869 7320 7061 7261 6d65 7465 7220 6d65  his parameter me
+00038510: 616e 7320 7573 696e 670a 2020 2020 2020  ans using.      
+00038520: 2020 2020 2020 7365 7373 696f 6e2d 6c65        session-le
+00038530: 7665 6c20 7061 636b 6167 6573 2e0a 2020  vel packages..  
+00038540: 2020 2020 2020 7265 706c 6163 653a 2057        replace: W
+00038550: 6865 7468 6572 2074 6f20 7265 706c 6163  hether to replac
+00038560: 6520 6120 5544 4620 7468 6174 2061 6c72  e a UDF that alr
+00038570: 6561 6479 2077 6173 2072 6567 6973 7465  eady was registe
+00038580: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
+00038590: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
+000385a0: 2020 2020 2020 2020 2020 2049 6620 6974             If it
+000385b0: 2069 7320 6060 4661 6c73 6560 602c 2061   is ``False``, a
+000385c0: 7474 656d 7074 696e 6720 746f 2072 6567  ttempting to reg
+000385d0: 6973 7465 7220 6120 5544 4620 7769 7468  ister a UDF with
+000385e0: 2061 206e 616d 6520 7468 6174 2061 6c72   a name that alr
+000385f0: 6561 6479 2065 7869 7374 730a 2020 2020  eady exists.    
+00038600: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+00038610: 696e 2061 2060 6053 6e6f 7770 6172 6b53  in a ``SnowparkS
+00038620: 514c 4578 6365 7074 696f 6e60 6020 6578  QLException`` ex
+00038630: 6365 7074 696f 6e20 6265 696e 6720 7468  ception being th
+00038640: 726f 776e 2e20 4966 2069 7420 6973 2060  rown. If it is `
+00038650: 6054 7275 6560 602c 0a20 2020 2020 2020  `True``,.       
+00038660: 2020 2020 2061 6e20 6578 6973 7469 6e67       an existing
+00038670: 2055 4446 2077 6974 6820 7468 6520 7361   UDF with the sa
+00038680: 6d65 206e 616d 6520 6973 206f 7665 7277  me name is overw
+00038690: 7269 7474 656e 2e0a 2020 2020 2020 2020  ritten..        
+000386a0: 6966 5f6e 6f74 5f65 7869 7374 733a 2057  if_not_exists: W
+000386b0: 6865 7468 6572 2074 6f20 736b 6970 2063  hether to skip c
+000386c0: 7265 6174 696f 6e20 6f66 2061 2055 4446  reation of a UDF
+000386d0: 2077 6865 6e20 6f6e 6520 7769 7468 2074   when one with t
+000386e0: 6865 2073 616d 6520 7369 676e 6174 7572  he same signatur
+000386f0: 6520 616c 7265 6164 7920 6578 6973 7473  e already exists
+00038700: 2e0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00038710: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
+00038720: 616c 7365 6060 2e20 6060 6966 5f6e 6f74  alse``. ``if_not
+00038730: 5f65 7869 7374 7360 6020 616e 6420 6060  _exists`` and ``
+00038740: 7265 706c 6163 6560 6020 6172 6520 6d75  replace`` are mu
+00038750: 7475 616c 6c79 2065 7863 6c75 7369 7665  tually exclusive
+00038760: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00038770: 2061 2060 6056 616c 7565 4572 726f 7260   a ``ValueError`
+00038780: 6020 6973 2072 6169 7365 6420 7768 656e  ` is raised when
+00038790: 2062 6f74 6820 6172 6520 7365 742e 2049   both are set. I
+000387a0: 6620 6974 2069 7320 6060 5472 7565 6060  f it is ``True``
+000387b0: 2061 6e64 2061 2055 4446 2077 6974 680a   and a UDF with.
+000387c0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000387d0: 7361 6d65 2073 6967 6e61 7475 7265 2065  same signature e
+000387e0: 7869 7374 732c 2074 6865 2055 4446 2063  xists, the UDF c
+000387f0: 7265 6174 696f 6e20 6973 2073 6b69 7070  reation is skipp
+00038800: 6564 2e0a 2020 2020 2020 2020 7365 7373  ed..        sess
+00038810: 696f 6e3a 2055 7365 2074 6869 7320 7365  ion: Use this se
+00038820: 7373 696f 6e20 746f 2072 6567 6973 7465  ssion to registe
+00038830: 7220 7468 6520 5544 462e 2049 6620 6974  r the UDF. If it
+00038840: 2773 206e 6f74 2073 7065 6369 6669 6564  's not specified
+00038850: 2c20 7468 6520 7365 7373 696f 6e20 7468  , the session th
+00038860: 6174 2079 6f75 2063 7265 6174 6564 2062  at you created b
+00038870: 6566 6f72 6520 6361 6c6c 696e 6720 7468  efore calling th
+00038880: 6973 2066 756e 6374 696f 6e20 7769 6c6c  is function will
+00038890: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
+000388a0: 2020 2020 2020 596f 7520 6e65 6564 2074        You need t
+000388b0: 6f20 7370 6563 6966 7920 7468 6973 2070  o specify this p
+000388c0: 6172 616d 6574 6572 2069 6620 796f 7520  arameter if you 
+000388d0: 6861 7665 2063 7265 6174 6564 206d 756c  have created mul
+000388e0: 7469 706c 6520 7365 7373 696f 6e73 2062  tiple sessions b
+000388f0: 6566 6f72 6520 6361 6c6c 696e 6720 7468  efore calling th
+00038900: 6973 206d 6574 686f 642e 0a20 2020 2020  is method..     
+00038910: 2020 2070 6172 616c 6c65 6c3a 2054 6865     parallel: The
+00038920: 206e 756d 6265 7220 6f66 2074 6872 6561   number of threa
+00038930: 6473 2074 6f20 7573 6520 666f 7220 7570  ds to use for up
+00038940: 6c6f 6164 696e 6720 5544 4620 6669 6c65  loading UDF file
+00038950: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
+00038960: 2020 2020 2020 2060 5055 5420 3c68 7474         `PUT <htt
+00038970: 7073 3a2f 2f64 6f63 732e 736e 6f77 666c  ps://docs.snowfl
+00038980: 616b 652e 636f 6d2f 656e 2f73 716c 2d72  ake.com/en/sql-r
+00038990: 6566 6572 656e 6365 2f73 716c 2f70 7574  eference/sql/put
+000389a0: 2e68 746d 6c23 7075 743e 605f 0a20 2020  .html#put>`_.   
+000389b0: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
+000389c0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+000389d0: 6c75 6520 6973 2034 2061 6e64 2073 7570  lue is 4 and sup
+000389e0: 706f 7274 6564 2076 616c 7565 7320 6172  ported values ar
+000389f0: 6520 6672 6f6d 2031 2074 6f20 3939 2e0a  e from 1 to 99..
+00038a00: 2020 2020 2020 2020 2020 2020 496e 6372              Incr
+00038a10: 6561 7369 6e67 2074 6865 206e 756d 6265  easing the numbe
+00038a20: 7220 6f66 2074 6872 6561 6473 2063 616e  r of threads can
+00038a30: 2069 6d70 726f 7665 2070 6572 666f 726d   improve perform
+00038a40: 616e 6365 2077 6865 6e20 7570 6c6f 6164  ance when upload
+00038a50: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00038a60: 6c61 7267 6520 5544 4620 6669 6c65 732e  large UDF files.
+00038a70: 0a20 2020 2020 2020 206d 6178 5f62 6174  .        max_bat
+00038a80: 6368 5f73 697a 653a 2054 6865 206d 6178  ch_size: The max
+00038a90: 696d 756d 206e 756d 6265 7220 6f66 2072  imum number of r
+00038aa0: 6f77 7320 7065 7220 696e 7075 7420 5061  ows per input Pa
+00038ab0: 6e64 6173 2044 6174 6146 7261 6d65 206f  ndas DataFrame o
+00038ac0: 7220 5061 6e64 6173 2053 6572 6965 730a  r Pandas Series.
+00038ad0: 2020 2020 2020 2020 2020 2020 696e 7369              insi
+00038ae0: 6465 2061 2076 6563 746f 7269 7a65 6420  de a vectorized 
+00038af0: 5544 462e 2042 6563 6175 7365 2061 2076  UDF. Because a v
+00038b00: 6563 746f 7269 7a65 6420 5544 4620 7769  ectorized UDF wi
+00038b10: 6c6c 2062 6520 6578 6563 7574 6564 2077  ll be executed w
+00038b20: 6974 6869 6e20 6120 7469 6d65 206c 696d  ithin a time lim
+00038b30: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
+00038b40: 7768 6963 6820 6973 2060 3630 6020 7365  which is `60` se
+00038b50: 636f 6e64 732c 2074 6869 7320 6f70 7469  conds, this opti
+00038b60: 6f6e 616c 2061 7267 756d 656e 7420 6361  onal argument ca
+00038b70: 6e20 6265 2075 7365 6420 746f 2072 6564  n be used to red
+00038b80: 7563 6520 7468 6520 7275 6e6e 696e 6720  uce the running 
+00038b90: 7469 6d65 206f 660a 2020 2020 2020 2020  time of.        
+00038ba0: 2020 2020 6576 6572 7920 6261 7463 6820      every batch 
+00038bb0: 6279 2073 6574 7469 6e67 2061 2073 6d61  by setting a sma
+00038bc0: 6c6c 6572 2062 6174 6368 2073 697a 652e  ller batch size.
+00038bd0: 204e 6f74 6520 7468 6174 2073 6574 7469   Note that setti
+00038be0: 6e67 2061 206c 6172 6765 7220 7661 6c75  ng a larger valu
+00038bf0: 6520 646f 6573 206e 6f74 0a20 2020 2020  e does not.     
+00038c00: 2020 2020 2020 2067 7561 7261 6e74 6565         guarantee
+00038c10: 2074 6861 7420 536e 6f77 666c 616b 6520   that Snowflake 
+00038c20: 7769 6c6c 2065 6e63 6f64 6520 6261 7463  will encode batc
+00038c30: 6865 7320 7769 7468 2074 6865 2073 7065  hes with the spe
+00038c40: 6369 6669 6564 206e 756d 6265 7220 6f66  cified number of
+00038c50: 2072 6f77 732e 2049 7420 7769 6c6c 0a20   rows. It will. 
+00038c60: 2020 2020 2020 2020 2020 2062 6520 6967             be ig
+00038c70: 6e6f 7265 6420 7768 656e 2072 6567 6973  nored when regis
+00038c80: 7465 7269 6e67 2061 206e 6f6e 2d76 6563  tering a non-vec
+00038c90: 746f 7269 7a65 6420 5544 462e 0a20 2020  torized UDF..   
+00038ca0: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
+00038cb0: 6172 616d 733a 2044 6963 7469 6f6e 6172  arams: Dictionar
+00038cc0: 7920 6f66 2073 7461 7465 6d65 6e74 206c  y of statement l
+00038cd0: 6576 656c 2070 6172 616d 6574 6572 7320  evel parameters 
+00038ce0: 746f 2062 6520 7365 7420 7768 696c 6520  to be set while 
+00038cf0: 6578 6563 7574 696e 6720 7468 6973 2061  executing this a
+00038d00: 6374 696f 6e2e 0a20 2020 2020 2020 2073  ction..        s
+00038d10: 6f75 7263 655f 636f 6465 5f64 6973 706c  ource_code_displ
+00038d20: 6179 3a20 4469 7370 6c61 7920 7468 6520  ay: Display the 
+00038d30: 736f 7572 6365 2063 6f64 6520 6f66 2074  source code of t
+00038d40: 6865 2055 4446 2060 6675 6e63 6020 6173  he UDF `func` as
+00038d50: 2063 6f6d 6d65 6e74 7320 696e 2074 6865   comments in the
+00038d60: 2067 656e 6572 6174 6564 2073 6372 6970   generated scrip
+00038d70: 742e 0a20 2020 2020 2020 2020 2020 2054  t..            T
+00038d80: 6865 2073 6f75 7263 6520 636f 6465 2069  he source code i
+00038d90: 7320 6479 6e61 6d69 6361 6c6c 7920 6765  s dynamically ge
+00038da0: 6e65 7261 7465 6420 7468 6572 6566 6f72  nerated therefor
+00038db0: 6520 6974 206d 6179 206e 6f74 2062 6520  e it may not be 
+00038dc0: 6964 656e 7469 6361 6c20 746f 2068 6f77  identical to how
+00038dd0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00038de0: 2060 6675 6e63 6020 6973 206f 7269 6769   `func` is origi
+00038df0: 6e61 6c6c 7920 6465 6669 6e65 642e 2054  nally defined. T
+00038e00: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
+00038e10: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
+00038e20: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
+00038e30: 616c 7365 6060 2c20 736f 7572 6365 2063  alse``, source c
+00038e40: 6f64 6520 7769 6c6c 206e 6f74 2062 6520  ode will not be 
+00038e50: 6765 6e65 7261 7465 6420 6f72 2064 6973  generated or dis
+00038e60: 706c 6179 6564 2e0a 2020 2020 2020 2020  played..        
+00038e70: 7374 7269 6374 3a20 5768 6574 6865 7220  strict: Whether 
+00038e80: 7468 6520 6372 6561 7465 6420 5544 4620  the created UDF 
+00038e90: 6973 2073 7472 6963 742e 2041 2073 7472  is strict. A str
+00038ea0: 6963 7420 5544 4620 7769 6c6c 206e 6f74  ict UDF will not
+00038eb0: 2069 6e76 6f6b 6520 7468 6520 5544 4620   invoke the UDF 
+00038ec0: 6966 2061 6e79 2069 6e70 7574 2069 730a  if any input is.
+00038ed0: 2020 2020 2020 2020 2020 2020 6e75 6c6c              null
+00038ee0: 2e20 496e 7374 6561 642c 2061 206e 756c  . Instead, a nul
+00038ef0: 6c20 7661 6c75 6520 7769 6c6c 2061 6c77  l value will alw
+00038f00: 6179 7320 6265 2072 6574 7572 6e65 6420  ays be returned 
+00038f10: 666f 7220 7468 6174 2072 6f77 2e20 4e6f  for that row. No
+00038f20: 7465 2074 6861 7420 7468 6520 5544 4620  te that the UDF 
+00038f30: 6d69 6768 740a 2020 2020 2020 2020 2020  might.          
+00038f40: 2020 7374 696c 6c20 7265 7475 726e 206e    still return n
+00038f50: 756c 6c20 666f 7220 6e6f 6e2d 6e75 6c6c  ull for non-null
+00038f60: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
+00038f70: 2073 6563 7572 653a 2057 6865 7468 6572   secure: Whether
+00038f80: 2074 6865 2063 7265 6174 6564 2055 4446   the created UDF
+00038f90: 2069 7320 7365 6375 7265 2e20 466f 7220   is secure. For 
+00038fa0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+00038fb0: 2061 626f 7574 2073 6563 7572 6520 6675   about secure fu
+00038fc0: 6e63 7469 6f6e 732c 0a20 2020 2020 2020  nctions,.       
+00038fd0: 2020 2020 2073 6565 2060 5365 6375 7265       see `Secure
+00038fe0: 2055 4446 7320 3c68 7474 7073 3a2f 2f64   UDFs <https://d
+00038ff0: 6f63 732e 736e 6f77 666c 616b 652e 636f  ocs.snowflake.co
+00039000: 6d2f 656e 2f73 716c 2d72 6566 6572 656e  m/en/sql-referen
+00039010: 6365 2f75 6466 2d73 6563 7572 652e 6874  ce/udf-secure.ht
+00039020: 6d6c 3e60 5f2e 0a0a 2020 2020 5265 7475  ml>`_...    Retu
+00039030: 726e 733a 0a20 2020 2020 2020 2041 2055  rns:.        A U
+00039040: 4446 2066 756e 6374 696f 6e20 7468 6174  DF function that
+00039050: 2063 616e 2062 6520 6361 6c6c 6564 2077   can be called w
+00039060: 6974 6820 3a63 6c61 7373 3a60 7e73 6e6f  ith :class:`~sno
+00039070: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00039080: 436f 6c75 6d6e 6020 6578 7072 6573 7369  Column` expressi
+00039090: 6f6e 732e 0a0a 2020 2020 4e6f 7465 3a0a  ons...    Note:.
+000390a0: 2020 2020 2020 2020 312e 2057 6865 6e20          1. When 
+000390b0: 7479 7065 2068 696e 7473 2061 7265 2070  type hints are p
+000390c0: 726f 7669 6465 6420 616e 6420 6172 6520  rovided and are 
+000390d0: 636f 6d70 6c65 7465 2066 6f72 2061 2066  complete for a f
+000390e0: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
+000390f0: 2060 6072 6574 7572 6e5f 7479 7065 6060   ``return_type``
+00039100: 2061 6e64 2060 6069 6e70 7574 5f74 7970   and ``input_typ
+00039110: 6573 6060 2061 7265 206f 7074 696f 6e61  es`` are optiona
+00039120: 6c20 616e 6420 7769 6c6c 2062 6520 6967  l and will be ig
+00039130: 6e6f 7265 642e 0a20 2020 2020 2020 2053  nored..        S
+00039140: 6565 2064 6574 6169 6c73 206f 6620 7375  ee details of su
+00039150: 7070 6f72 7465 6420 6461 7461 2074 7970  pported data typ
+00039160: 6573 2066 6f72 2055 4446 7320 696e 0a20  es for UDFs in. 
+00039170: 2020 2020 2020 203a 636c 6173 733a 607e         :class:`~
+00039180: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00039190: 726b 2e75 6466 2e55 4446 5265 6769 7374  rk.udf.UDFRegist
+000391a0: 7261 7469 6f6e 602e 0a0a 2020 2020 2020  ration`...      
+000391b0: 2020 2020 2020 2d20 596f 7520 6361 6e20        - You can 
+000391c0: 7573 6520 7573 6520 3a61 7474 723a 607e  use use :attr:`~
+000391d0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+000391e0: 726b 2e74 7970 6573 2e56 6172 6961 6e74  rk.types.Variant
+000391f0: 6020 746f 0a20 2020 2020 2020 2020 2020  ` to.           
+00039200: 2020 2061 6e6e 6f74 6174 6520 6120 7661     annotate a va
+00039210: 7269 616e 742c 2061 6e64 2075 7365 203a  riant, and use :
+00039220: 6174 7472 3a60 7e73 6e6f 7766 6c61 6b65  attr:`~snowflake
+00039230: 2e73 6e6f 7770 6172 6b2e 7479 7065 732e  .snowpark.types.
+00039240: 4765 6f67 7261 7068 7960 0a20 2020 2020  Geography`.     
+00039250: 2020 2020 2020 2020 2074 6f20 616e 6e6f           to anno
+00039260: 7461 7465 2061 2067 656f 6772 6170 6879  tate a geography
+00039270: 2077 6865 6e20 6465 6669 6e69 6e67 2061   when defining a
+00039280: 2055 4446 2e0a 0a20 2020 2020 2020 2020   UDF...         
+00039290: 2020 202d 2059 6f75 2063 616e 2075 7365     - You can use
+000392a0: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
+000392b0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000392c0: 7479 7065 732e 5061 6e64 6173 5365 7269  types.PandasSeri
+000392d0: 6573 6020 746f 2061 6e6e 6f74 6174 650a  es` to annotate.
+000392e0: 2020 2020 2020 2020 2020 2020 2020 6120                a 
+000392f0: 5061 6e64 6173 2053 6572 6965 732c 2061  Pandas Series, a
+00039300: 6e64 2075 7365 203a 6174 7472 3a60 7e73  nd use :attr:`~s
+00039310: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00039320: 6b2e 7479 7065 732e 5061 6e64 6173 4461  k.types.PandasDa
+00039330: 7461 4672 616d 6560 0a20 2020 2020 2020  taFrame`.       
+00039340: 2020 2020 2020 2074 6f20 616e 6e6f 7461         to annota
+00039350: 7465 2061 2050 616e 6461 7320 4461 7461  te a Pandas Data
+00039360: 4672 616d 6520 7768 656e 2064 6566 696e  Frame when defin
+00039370: 696e 6720 6120 7665 6374 6f72 697a 6564  ing a vectorized
+00039380: 2055 4446 2e0a 2020 2020 2020 2020 2020   UDF..          
+00039390: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+000393a0: 6579 2061 7265 2067 656e 6572 6963 2074  ey are generic t
+000393b0: 7970 6573 2073 6f20 796f 7520 6361 6e20  ypes so you can 
+000393c0: 7370 6563 6966 7920 7468 6520 656c 656d  specify the elem
+000393d0: 656e 7420 7479 7065 2069 6e20 610a 2020  ent type in a.  
+000393e0: 2020 2020 2020 2020 2020 2020 5061 6e64              Pand
+000393f0: 6173 2053 6572 6965 7320 616e 6420 4461  as Series and Da
+00039400: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
+00039410: 2020 2020 2020 2d20 3a63 6c61 7373 3a60        - :class:`
+00039420: 7479 7069 6e67 2e55 6e69 6f6e 6020 6973  typing.Union` is
+00039430: 206e 6f74 2061 2076 616c 6964 2074 7970   not a valid typ
+00039440: 6520 616e 6e6f 7461 7469 6f6e 2066 6f72  e annotation for
+00039450: 2055 4446 732c 0a20 2020 2020 2020 2020   UDFs,.         
+00039460: 2020 2020 2062 7574 203a 636c 6173 733a       but :class:
+00039470: 6074 7970 696e 672e 4f70 7469 6f6e 616c  `typing.Optional
+00039480: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
+00039490: 2069 6e64 6963 6174 6520 7468 6520 6f70   indicate the op
+000394a0: 7469 6f6e 616c 2074 7970 652e 0a0a 2020  tional type...  
+000394b0: 2020 2020 2020 2020 2020 2d20 5479 7065            - Type
+000394c0: 2068 696e 7473 2061 7265 206e 6f74 2073   hints are not s
+000394d0: 7570 706f 7274 6564 206f 6e20 6675 6e63  upported on func
+000394e0: 7469 6f6e 7320 6465 636f 7261 7465 6420  tions decorated 
+000394f0: 7769 7468 2064 6563 6f72 6174 6f72 732e  with decorators.
+00039500: 0a0a 2020 2020 2020 2020 322e 2041 2074  ..        2. A t
+00039510: 656d 706f 7261 7279 2055 4446 2028 7768  emporary UDF (wh
+00039520: 656e 2060 6069 735f 7065 726d 616e 656e  en ``is_permanen
+00039530: 7460 6020 6973 2060 6046 616c 7365 6060  t`` is ``False``
+00039540: 2920 6973 2073 636f 7065 6420 746f 2074  ) is scoped to t
+00039550: 6869 7320 6060 7365 7373 696f 6e60 600a  his ``session``.
+00039560: 2020 2020 2020 2020 616e 6420 616c 6c20          and all 
+00039570: 5544 4620 7265 6c61 7465 6420 6669 6c65  UDF related file
+00039580: 7320 7769 6c6c 2062 6520 7570 6c6f 6164  s will be upload
+00039590: 6564 2074 6f20 6120 7465 6d70 6f72 6172  ed to a temporar
+000395a0: 7920 7365 7373 696f 6e20 7374 6167 650a  y session stage.
+000395b0: 2020 2020 2020 2020 283a 6675 6e63 3a60          (:func:`
+000395c0: 7365 7373 696f 6e2e 6765 745f 7365 7373  session.get_sess
+000395d0: 696f 6e5f 7374 6167 6528 2920 3c73 6e6f  ion_stage() <sno
+000395e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000395f0: 5365 7373 696f 6e2e 6765 745f 7365 7373  Session.get_sess
+00039600: 696f 6e5f 7374 6167 653e 6029 2e0a 2020  ion_stage>`)..  
+00039610: 2020 2020 2020 466f 7220 6120 7065 726d        For a perm
+00039620: 616e 656e 7420 5544 462c 2074 6865 7365  anent UDF, these
+00039630: 2066 696c 6573 2077 696c 6c20 6265 2075   files will be u
+00039640: 706c 6f61 6465 6420 746f 2074 6865 2073  ploaded to the s
+00039650: 7461 6765 2074 6861 7420 796f 7520 7072  tage that you pr
+00039660: 6f76 6964 652e 0a0a 2020 2020 2020 2020  ovide...        
+00039670: 332e 2042 7920 6465 6661 756c 742c 2055  3. By default, U
+00039680: 4446 2072 6567 6973 7472 6174 696f 6e20  DF registration 
+00039690: 6661 696c 7320 6966 2061 2066 756e 6374  fails if a funct
+000396a0: 696f 6e20 7769 7468 2074 6865 2073 616d  ion with the sam
+000396b0: 6520 6e61 6d65 2069 7320 616c 7265 6164  e name is alread
+000396c0: 790a 2020 2020 2020 2020 7265 6769 7374  y.        regist
+000396d0: 6572 6564 2e20 496e 766f 6b69 6e67 203a  ered. Invoking :
+000396e0: 6675 6e63 3a60 7564 6660 2077 6974 6820  func:`udf` with 
+000396f0: 6060 7265 706c 6163 6560 6020 7365 7420  ``replace`` set 
+00039700: 746f 2060 6054 7275 6560 6020 7769 6c6c  to ``True`` will
+00039710: 206f 7665 7277 7269 7465 2074 6865 0a20   overwrite the. 
+00039720: 2020 2020 2020 2070 7265 7669 6f75 736c         previousl
+00039730: 7920 7265 6769 7374 6572 6564 2066 756e  y registered fun
+00039740: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+00039750: 342e 2057 6865 6e20 7265 6769 7374 6572  4. When register
+00039760: 696e 6720 6120 7665 6374 6f72 697a 6564  ing a vectorized
+00039770: 2055 4446 2c20 6060 7061 6e64 6173 6060   UDF, ``pandas``
+00039780: 206c 6962 7261 7279 2077 696c 6c20 6265   library will be
+00039790: 2061 6464 6564 2061 7320 6120 7061 636b   added as a pack
+000397a0: 6167 650a 2020 2020 2020 2020 6175 746f  age.        auto
+000397b0: 6d61 7469 6361 6c6c 792c 2077 6974 6820  matically, with 
+000397c0: 7468 6520 6c61 7465 7374 2076 6572 7369  the latest versi
+000397d0: 6f6e 206f 6e20 7468 6520 536e 6f77 666c  on on the Snowfl
+000397e0: 616b 6520 7365 7276 6572 2e20 4966 2079  ake server. If y
+000397f0: 6f75 2064 6f6e 2774 2077 616e 7420 746f  ou don't want to
+00039800: 0a20 2020 2020 2020 2075 7365 2074 6869  .        use thi
+00039810: 7320 7665 7273 696f 6e2c 2079 6f75 2063  s version, you c
+00039820: 616e 206f 7665 7277 7269 7465 2069 7420  an overwrite it 
+00039830: 6279 2061 6464 696e 6720 6070 616e 6461  by adding `panda
+00039840: 7360 2077 6974 6820 7370 6563 6966 6963  s` with specific
+00039850: 2076 6572 7369 6f6e 0a20 2020 2020 2020   version.       
+00039860: 2072 6571 7569 7265 6d65 6e74 2075 7369   requirement usi
+00039870: 6e67 2060 6070 6163 6b61 6765 6060 2061  ng ``package`` a
+00039880: 7267 756d 656e 7420 6f72 203a 6d65 7468  rgument or :meth
+00039890: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+000398a0: 7770 6172 6b2e 5365 7373 696f 6e2e 6164  wpark.Session.ad
+000398b0: 645f 7061 636b 6167 6573 602e 0a0a 2020  d_packages`...  
+000398c0: 2020 5365 6520 416c 736f 3a0a 2020 2020    See Also:.    
+000398d0: 2020 2020 3a63 6c61 7373 3a60 7e73 6e6f      :class:`~sno
+000398e0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+000398f0: 7564 662e 5544 4652 6567 6973 7472 6174  udf.UDFRegistrat
+00039900: 696f 6e60 0a0a 2020 2020 5544 4673 2063  ion`..    UDFs c
+00039910: 616e 2062 6520 6372 6561 7465 6420 6173  an be created as
+00039920: 2061 6e6f 6e79 6d6f 7573 2055 4446 730a   anonymous UDFs.
+00039930: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+00039940: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+00039950: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+00039960: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+00039970: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
+00039980: 2020 2020 203e 3e3e 2061 6464 5f6f 6e65       >>> add_one
+00039990: 203d 2075 6466 286c 616d 6264 6120 783a   = udf(lambda x:
+000399a0: 2078 2b31 2c20 7265 7475 726e 5f74 7970   x+1, return_typ
+000399b0: 653d 496e 7465 6765 7254 7970 6528 292c  e=IntegerType(),
+000399c0: 2069 6e70 7574 5f74 7970 6573 3d5b 496e   input_types=[In
+000399d0: 7465 6765 7254 7970 6528 295d 290a 2020  tegerType()]).  
+000399e0: 2020 2020 2020 3e3e 3e20 6466 203d 2073        >>> df = s
+000399f0: 6573 7369 6f6e 2e63 7265 6174 655f 6461  ession.create_da
+00039a00: 7461 6672 616d 6528 5b31 2c20 322c 2033  taframe([1, 2, 3
+00039a10: 5d2c 2073 6368 656d 613d 5b22 6122 5d29  ], schema=["a"])
+00039a20: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00039a30: 7365 6c65 6374 2861 6464 5f6f 6e65 2863  select(add_one(c
+00039a40: 6f6c 2822 6122 2929 2e61 735f 2822 616e  ol("a")).as_("an
+00039a50: 7322 2929 2e63 6f6c 6c65 6374 2829 0a20  s")).collect(). 
+00039a60: 2020 2020 2020 205b 526f 7728 414e 533d         [Row(ANS=
+00039a70: 3229 2c20 526f 7728 414e 533d 3329 2c20  2), Row(ANS=3), 
+00039a80: 526f 7728 414e 533d 3429 5d0a 0a20 2020  Row(ANS=4)]..   
+00039a90: 206f 7220 6173 206e 616d 6564 2055 4446   or as named UDF
+00039aa0: 7320 7468 6174 2061 7265 2061 6363 6573  s that are acces
+00039ab0: 7369 626c 6520 696e 2074 6865 2073 616d  sible in the sam
+00039ac0: 6520 7365 7373 696f 6e2e 2049 6e73 7465  e session. Inste
+00039ad0: 6164 206f 6620 6361 6c6c 696e 6720 6075  ad of calling `u
+00039ae0: 6466 6020 6173 2066 756e 6374 696f 6e2c  df` as function,
+00039af0: 2069 7420 6361 6e20 6265 2061 6c73 6f20   it can be also 
+00039b00: 7573 6564 0a20 2020 2061 7320 6120 6465  used.    as a de
+00039b10: 636f 7261 746f 723a 0a0a 2020 2020 4578  corator:..    Ex
+00039b20: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00039b30: 203e 3e3e 2040 7564 6628 6e61 6d65 3d22   >>> @udf(name="
+00039b40: 6d69 6e75 735f 6f6e 6522 2c20 7265 706c  minus_one", repl
+00039b50: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
+00039b60: 2020 2e2e 2e20 6465 6620 6d69 6e75 735f    ... def minus_
+00039b70: 6f6e 6528 783a 2069 6e74 2920 2d3e 2069  one(x: int) -> i
+00039b80: 6e74 3a0a 2020 2020 2020 2020 2e2e 2e20  nt:.        ... 
+00039b90: 2020 2020 7265 7475 726e 2078 202d 2031      return x - 1
+00039ba0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+00039bb0: 7365 6c65 6374 286d 696e 7573 5f6f 6e65  select(minus_one
+00039bc0: 2863 6f6c 2822 6122 2929 2e61 735f 2822  (col("a")).as_("
+00039bd0: 616e 7322 2929 2e63 6f6c 6c65 6374 2829  ans")).collect()
+00039be0: 0a20 2020 2020 2020 205b 526f 7728 414e  .        [Row(AN
+00039bf0: 533d 3029 2c20 526f 7728 414e 533d 3129  S=0), Row(ANS=1)
+00039c00: 2c20 526f 7728 414e 533d 3229 5d0a 2020  , Row(ANS=2)].  
+00039c10: 2020 2020 2020 3e3e 3e20 7365 7373 696f        >>> sessio
+00039c20: 6e2e 7371 6c28 2253 454c 4543 5420 6d69  n.sql("SELECT mi
+00039c30: 6e75 735f 6f6e 6528 3130 2922 292e 636f  nus_one(10)").co
+00039c40: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+00039c50: 5b52 6f77 284d 494e 5553 5f4f 4e45 2831  [Row(MINUS_ONE(1
+00039c60: 3029 3d39 295d 0a0a 2020 2020 2222 220a  0)=9)]..    """.
+00039c70: 2020 2020 7365 7373 696f 6e20 3d20 7365      session = se
+00039c80: 7373 696f 6e20 6f72 2073 6e6f 7766 6c61  ssion or snowfla
+00039c90: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
+00039ca0: 696f 6e2e 5f67 6574 5f61 6374 6976 655f  ion._get_active_
+00039cb0: 7365 7373 696f 6e28 290a 2020 2020 6966  session().    if
+00039cc0: 2066 756e 6320 6973 204e 6f6e 653a 0a20   func is None:. 
+00039cd0: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
+00039ce0: 6e63 746f 6f6c 732e 7061 7274 6961 6c28  nctools.partial(
+00039cf0: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
+00039d00: 7369 6f6e 2e75 6466 2e72 6567 6973 7465  sion.udf.registe
+00039d10: 722c 0a20 2020 2020 2020 2020 2020 2072  r,.            r
+00039d20: 6574 7572 6e5f 7479 7065 3d72 6574 7572  eturn_type=retur
+00039d30: 6e5f 7479 7065 2c0a 2020 2020 2020 2020  n_type,.        
+00039d40: 2020 2020 696e 7075 745f 7479 7065 733d      input_types=
+00039d50: 696e 7075 745f 7479 7065 732c 0a20 2020  input_types,.   
+00039d60: 2020 2020 2020 2020 206e 616d 653d 6e61           name=na
+00039d70: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00039d80: 6973 5f70 6572 6d61 6e65 6e74 3d69 735f  is_permanent=is_
+00039d90: 7065 726d 616e 656e 742c 0a20 2020 2020  permanent,.     
+00039da0: 2020 2020 2020 2073 7461 6765 5f6c 6f63         stage_loc
+00039db0: 6174 696f 6e3d 7374 6167 655f 6c6f 6361  ation=stage_loca
+00039dc0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00039dd0: 2020 696d 706f 7274 733d 696d 706f 7274    imports=import
+00039de0: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
+00039df0: 6163 6b61 6765 733d 7061 636b 6167 6573  ackages=packages
+00039e00: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00039e10: 706c 6163 653d 7265 706c 6163 652c 0a20  place=replace,. 
+00039e20: 2020 2020 2020 2020 2020 2069 665f 6e6f             if_no
+00039e30: 745f 6578 6973 7473 3d69 665f 6e6f 745f  t_exists=if_not_
+00039e40: 6578 6973 7473 2c0a 2020 2020 2020 2020  exists,.        
+00039e50: 2020 2020 7061 7261 6c6c 656c 3d70 6172      parallel=par
+00039e60: 616c 6c65 6c2c 0a20 2020 2020 2020 2020  allel,.         
+00039e70: 2020 206d 6178 5f62 6174 6368 5f73 697a     max_batch_siz
+00039e80: 653d 6d61 785f 6261 7463 685f 7369 7a65  e=max_batch_size
+00039e90: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00039ea0: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
+00039eb0: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
+00039ec0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00039ed0: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
+00039ee0: 3d73 6f75 7263 655f 636f 6465 5f64 6973  =source_code_dis
+00039ef0: 706c 6179 2c0a 2020 2020 2020 2020 2020  play,.          
+00039f00: 2020 7374 7269 6374 3d73 7472 6963 742c    strict=strict,
+00039f10: 0a20 2020 2020 2020 2020 2020 2073 6563  .            sec
+00039f20: 7572 653d 7365 6375 7265 2c0a 2020 2020  ure=secure,.    
+00039f30: 2020 2020 290a 2020 2020 656c 7365 3a0a      ).    else:.
+00039f40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00039f50: 6573 7369 6f6e 2e75 6466 2e72 6567 6973  ession.udf.regis
+00039f60: 7465 7228 0a20 2020 2020 2020 2020 2020  ter(.           
+00039f70: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
+00039f80: 2020 2072 6574 7572 6e5f 7479 7065 3d72     return_type=r
+00039f90: 6574 7572 6e5f 7479 7065 2c0a 2020 2020  eturn_type,.    
+00039fa0: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
+00039fb0: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
+00039fc0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00039fd0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
+00039fe0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
+00039ff0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
+0003a000: 2020 2020 2020 2020 2020 2073 7461 6765             stage
+0003a010: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
+0003a020: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
+0003a030: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
+0003a040: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
+0003a050: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
+0003a060: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
+0003a070: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
+0003a080: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003a090: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
+0003a0a0: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
+0003a0b0: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
+0003a0c0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
+0003a0d0: 2020 2020 2020 206d 6178 5f62 6174 6368         max_batch
+0003a0e0: 5f73 697a 653d 6d61 785f 6261 7463 685f  _size=max_batch_
+0003a0f0: 7369 7a65 2c0a 2020 2020 2020 2020 2020  size,.          
+0003a100: 2020 7374 6174 656d 656e 745f 7061 7261    statement_para
+0003a110: 6d73 3d73 7461 7465 6d65 6e74 5f70 6172  ms=statement_par
+0003a120: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
+0003a130: 2073 6f75 7263 655f 636f 6465 5f64 6973   source_code_dis
+0003a140: 706c 6179 3d73 6f75 7263 655f 636f 6465  play=source_code
+0003a150: 5f64 6973 706c 6179 2c0a 2020 2020 2020  _display,.      
+0003a160: 2020 2020 2020 7374 7269 6374 3d73 7472        strict=str
+0003a170: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+0003a180: 2073 6563 7572 653d 7365 6375 7265 2c0a   secure=secure,.
+0003a190: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+0003a1a0: 7564 7466 280a 2020 2020 6861 6e64 6c65  udtf(.    handle
+0003a1b0: 723a 204f 7074 696f 6e61 6c5b 4361 6c6c  r: Optional[Call
+0003a1c0: 6162 6c65 5d20 3d20 4e6f 6e65 2c0a 2020  able] = None,.  
+0003a1d0: 2020 2a2c 0a20 2020 206f 7574 7075 745f    *,.    output_
+0003a1e0: 7363 6865 6d61 3a20 556e 696f 6e5b 5374  schema: Union[St
+0003a1f0: 7275 6374 5479 7065 2c20 4c69 7374 5b73  ructType, List[s
+0003a200: 7472 5d5d 2c0a 2020 2020 696e 7075 745f  tr]],.    input_
+0003a210: 7479 7065 733a 204f 7074 696f 6e61 6c5b  types: Optional[
+0003a220: 4c69 7374 5b44 6174 6154 7970 655d 5d20  List[DataType]] 
+0003a230: 3d20 4e6f 6e65 2c0a 2020 2020 6e61 6d65  = None,.    name
+0003a240: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+0003a250: 5b73 7472 2c20 4974 6572 6162 6c65 5b73  [str, Iterable[s
+0003a260: 7472 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  tr]]] = None,.  
+0003a270: 2020 6973 5f70 6572 6d61 6e65 6e74 3a20    is_permanent: 
+0003a280: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0003a290: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
+0003a2a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0003a2b0: 3d20 4e6f 6e65 2c0a 2020 2020 696d 706f  = None,.    impo
+0003a2c0: 7274 733a 204f 7074 696f 6e61 6c5b 4c69  rts: Optional[Li
+0003a2d0: 7374 5b55 6e69 6f6e 5b73 7472 2c20 5475  st[Union[str, Tu
+0003a2e0: 706c 655b 7374 722c 2073 7472 5d5d 5d5d  ple[str, str]]]]
+0003a2f0: 203d 204e 6f6e 652c 0a20 2020 2070 6163   = None,.    pac
+0003a300: 6b61 6765 733a 204f 7074 696f 6e61 6c5b  kages: Optional[
+0003a310: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
+0003a320: 4d6f 6475 6c65 5479 7065 5d5d 5d20 3d20  ModuleType]]] = 
+0003a330: 4e6f 6e65 2c0a 2020 2020 7265 706c 6163  None,.    replac
+0003a340: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+0003a350: 0a20 2020 2069 665f 6e6f 745f 6578 6973  .    if_not_exis
+0003a360: 7473 3a20 626f 6f6c 203d 2046 616c 7365  ts: bool = False
+0003a370: 2c0a 2020 2020 7365 7373 696f 6e3a 204f  ,.    session: O
+0003a380: 7074 696f 6e61 6c5b 2273 6e6f 7766 6c61  ptional["snowfla
+0003a390: 6b65 2e73 6e6f 7770 6172 6b2e 7365 7373  ke.snowpark.sess
+0003a3a0: 696f 6e2e 5365 7373 696f 6e22 5d20 3d20  ion.Session"] = 
+0003a3b0: 4e6f 6e65 2c0a 2020 2020 7061 7261 6c6c  None,.    parall
+0003a3c0: 656c 3a20 696e 7420 3d20 342c 0a20 2020  el: int = 4,.   
+0003a3d0: 2073 7461 7465 6d65 6e74 5f70 6172 616d   statement_param
+0003a3e0: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
+0003a3f0: 5b73 7472 2c20 7374 725d 5d20 3d20 4e6f  [str, str]] = No
+0003a400: 6e65 2c0a 2020 2020 7374 7269 6374 3a20  ne,.    strict: 
+0003a410: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0003a420: 2020 7365 6375 7265 3a20 626f 6f6c 203d    secure: bool =
+0003a430: 2046 616c 7365 2c0a 2920 2d3e 2055 6e69   False,.) -> Uni
+0003a440: 6f6e 5b55 7365 7244 6566 696e 6564 5461  on[UserDefinedTa
+0003a450: 626c 6546 756e 6374 696f 6e2c 2066 756e  bleFunction, fun
+0003a460: 6374 6f6f 6c73 2e70 6172 7469 616c 5d3a  ctools.partial]:
+0003a470: 0a20 2020 2022 2222 5265 6769 7374 6572  .    """Register
+0003a480: 7320 6120 5079 7468 6f6e 2063 6c61 7373  s a Python class
+0003a490: 2061 7320 6120 536e 6f77 666c 616b 6520   as a Snowflake 
+0003a4a0: 5079 7468 6f6e 2055 4454 4620 616e 6420  Python UDTF and 
+0003a4b0: 7265 7475 726e 7320 7468 6520 5544 5446  returns the UDTF
+0003a4c0: 2e0a 0a20 2020 2049 7420 6361 6e20 6265  ...    It can be
+0003a4d0: 2075 7365 6420 6173 2065 6974 6865 7220   used as either 
+0003a4e0: 6120 6675 6e63 7469 6f6e 2063 616c 6c20  a function call 
+0003a4f0: 6f72 2061 2064 6563 6f72 6174 6f72 2e20  or a decorator. 
+0003a500: 496e 206d 6f73 7420 6361 7365 7320 796f  In most cases yo
+0003a510: 7520 776f 726b 2077 6974 6820 6120 7369  u work with a si
+0003a520: 6e67 6c65 2073 6573 7369 6f6e 2e0a 2020  ngle session..  
+0003a530: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+0003a540: 7573 6573 2074 6861 7420 7365 7373 696f  uses that sessio
+0003a550: 6e20 746f 2072 6567 6973 7465 7220 7468  n to register th
+0003a560: 6520 5544 5446 2e20 4966 2079 6f75 2068  e UDTF. If you h
+0003a570: 6176 6520 6d75 6c74 6970 6c65 2073 6573  ave multiple ses
+0003a580: 7369 6f6e 732c 2079 6f75 206e 6565 6420  sions, you need 
+0003a590: 746f 0a20 2020 2065 7870 6c69 6369 746c  to.    explicitl
+0003a5a0: 7920 7370 6563 6966 7920 7468 6520 6060  y specify the ``
+0003a5b0: 7365 7373 696f 6e60 6020 7061 7261 6d65  session`` parame
+0003a5c0: 7465 7220 6f66 2074 6869 7320 6675 6e63  ter of this func
+0003a5d0: 7469 6f6e 2e20 4966 2079 6f75 2068 6176  tion. If you hav
+0003a5e0: 6520 6120 6675 6e63 7469 6f6e 2061 6e64  e a function and
+0003a5f0: 2077 6f75 6c64 0a20 2020 206c 696b 6520   would.    like 
+0003a600: 746f 2072 6567 6973 7465 7220 6974 2074  to register it t
+0003a610: 6f20 6d75 6c74 6970 6c65 2064 6174 6162  o multiple datab
+0003a620: 6173 6573 2c20 7573 6520 6060 7365 7373  ases, use ``sess
+0003a630: 696f 6e2e 7564 7466 2e72 6567 6973 7465  ion.udtf.registe
+0003a640: 7260 6020 696e 7374 6561 642e 2053 6565  r`` instead. See
+0003a650: 2065 7861 6d70 6c65 730a 2020 2020 696e   examples.    in
+0003a660: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+0003a670: 616b 652e 736e 6f77 7061 726b 2e75 6474  ake.snowpark.udt
+0003a680: 662e 5544 5446 5265 6769 7374 7261 7469  f.UDTFRegistrati
+0003a690: 6f6e 602e 0a0a 2020 2020 4172 6773 3a0a  on`...    Args:.
+0003a6a0: 2020 2020 2020 2020 6861 6e64 6c65 723a          handler:
+0003a6b0: 2041 2050 7974 686f 6e20 636c 6173 7320   A Python class 
+0003a6c0: 7573 6564 2066 6f72 2063 7265 6174 696e  used for creatin
+0003a6d0: 6720 7468 6520 5544 5446 2e0a 2020 2020  g the UDTF..    
+0003a6e0: 2020 2020 6f75 7470 7574 5f73 6368 656d      output_schem
+0003a6f0: 613a 2041 206c 6973 7420 6f66 2063 6f6c  a: A list of col
+0003a700: 756d 6e20 6e61 6d65 732c 206f 7220 6120  umn names, or a 
+0003a710: 3a63 6c61 7373 3a60 7e73 6e6f 7766 6c61  :class:`~snowfla
+0003a720: 6b65 2e73 6e6f 7770 6172 6b2e 7479 7065  ke.snowpark.type
+0003a730: 732e 5374 7275 6374 5479 7065 6020 696e  s.StructType` in
+0003a740: 7374 616e 6365 2074 6861 7420 7265 7072  stance that repr
+0003a750: 6573 656e 7473 2074 6865 2074 6162 6c65  esents the table
+0003a760: 2066 756e 6374 696f 6e27 7320 636f 6c75   function's colu
+0003a770: 6d6e 732e 0a20 2020 2020 2020 2020 4966  mns..         If
+0003a780: 2061 206c 6973 7420 6f66 2063 6f6c 756d   a list of colum
+0003a790: 6e20 6e61 6d65 7320 6973 2070 726f 7669  n names is provi
+0003a7a0: 6465 642c 2074 6865 2060 6070 726f 6365  ded, the ``proce
+0003a7b0: 7373 6060 206d 6574 686f 6420 6f66 2074  ss`` method of t
+0003a7c0: 6865 2068 616e 646c 6572 2063 6c61 7373  he handler class
+0003a7d0: 206d 7573 7420 6861 7665 2072 6574 7572   must have retur
+0003a7e0: 6e20 7479 7065 2068 696e 7473 2074 6f20  n type hints to 
+0003a7f0: 696e 6469 6361 7465 2074 6865 206f 7574  indicate the out
+0003a800: 7075 7420 7363 6865 6d61 2064 6174 6120  put schema data 
+0003a810: 7479 7065 732e 0a20 2020 2020 2020 2069  types..        i
+0003a820: 6e70 7574 5f74 7970 6573 3a20 4120 6c69  nput_types: A li
+0003a830: 7374 206f 6620 3a63 6c61 7373 3a60 7e73  st of :class:`~s
+0003a840: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+0003a850: 6b2e 7479 7065 732e 4461 7461 5479 7065  k.types.DataType
+0003a860: 600a 2020 2020 2020 2020 2020 2020 7265  `.            re
+0003a870: 7072 6573 656e 7469 6e67 2074 6865 2069  presenting the i
+0003a880: 6e70 7574 2064 6174 6120 7479 7065 7320  nput data types 
+0003a890: 6f66 2074 6865 2055 4454 462e 204f 7074  of the UDTF. Opt
+0003a8a0: 696f 6e61 6c20 6966 0a20 2020 2020 2020  ional if.       
+0003a8b0: 2020 2020 2074 7970 6520 6869 6e74 7320       type hints 
+0003a8c0: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
+0003a8d0: 2020 2020 2020 6e61 6d65 3a20 4120 7374        name: A st
+0003a8e0: 7269 6e67 206f 7220 6c69 7374 206f 6620  ring or list of 
+0003a8f0: 7374 7269 6e67 7320 7468 6174 2073 7065  strings that spe
+0003a900: 6369 6679 2074 6865 206e 616d 6520 6f72  cify the name or
+0003a910: 2066 756c 6c79 2d71 7561 6c69 6669 6564   fully-qualified
+0003a920: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
+0003a930: 6563 7420 6964 656e 7469 6669 6572 2028  ect identifier (
+0003a940: 6461 7461 6261 7365 206e 616d 652c 2073  database name, s
+0003a950: 6368 656d 6120 6e61 6d65 2c20 616e 6420  chema name, and 
+0003a960: 6675 6e63 7469 6f6e 206e 616d 6529 2066  function name) f
+0003a970: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
+0003a980: 6865 2055 4454 4620 696e 2053 6e6f 7766  he UDTF in Snowf
+0003a990: 6c61 6b65 2c20 7768 6963 6820 616c 6c6f  lake, which allo
+0003a9a0: 7773 2079 6f75 2074 6f20 6361 6c6c 2074  ws you to call t
+0003a9b0: 6869 7320 5544 5446 2069 6e20 6120 5351  his UDTF in a SQ
+0003a9c0: 4c0a 2020 2020 2020 2020 2020 2020 636f  L.            co
+0003a9d0: 6d6d 616e 6420 6f72 2076 6961 203a 6675  mmand or via :fu
+0003a9e0: 6e63 3a60 6361 6c6c 5f75 6474 6628 2960  nc:`call_udtf()`
+0003a9f0: 2e20 4966 2069 7420 6973 206e 6f74 2070  . If it is not p
+0003aa00: 726f 7669 6465 642c 2061 206e 616d 6520  rovided, a name 
+0003aa10: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+0003aa20: 2062 6520 6175 746f 6d61 7469 6361 6c6c   be automaticall
+0003aa30: 7920 6765 6e65 7261 7465 6420 666f 7220  y generated for 
+0003aa40: 7468 6520 5544 5446 2e20 4120 6e61 6d65  the UDTF. A name
+0003aa50: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+0003aa60: 6564 2077 6865 6e0a 2020 2020 2020 2020  ed when.        
+0003aa70: 2020 2020 6060 6973 5f70 6572 6d61 6e65      ``is_permane
+0003aa80: 6e74 6060 2069 7320 6060 5472 7565 6060  nt`` is ``True``
+0003aa90: 2e0a 2020 2020 2020 2020 6973 5f70 6572  ..        is_per
+0003aaa0: 6d61 6e65 6e74 3a20 5768 6574 6865 7220  manent: Whether 
+0003aab0: 746f 2063 7265 6174 6520 6120 7065 726d  to create a perm
+0003aac0: 616e 656e 7420 5544 5446 2e20 5468 6520  anent UDTF. The 
+0003aad0: 6465 6661 756c 7420 6973 2060 6046 616c  default is ``Fal
+0003aae0: 7365 6060 2e0a 2020 2020 2020 2020 2020  se``..          
+0003aaf0: 2020 4966 2069 7420 6973 2060 6054 7275    If it is ``Tru
+0003ab00: 6560 602c 2061 2076 616c 6964 2060 6073  e``, a valid ``s
+0003ab10: 7461 6765 5f6c 6f63 6174 696f 6e60 6020  tage_location`` 
+0003ab20: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
+0003ab30: 2e0a 2020 2020 2020 2020 7374 6167 655f  ..        stage_
+0003ab40: 6c6f 6361 7469 6f6e 3a20 5468 6520 7374  location: The st
+0003ab50: 6167 6520 6c6f 6361 7469 6f6e 2077 6865  age location whe
+0003ab60: 7265 2074 6865 2050 7974 686f 6e20 6669  re the Python fi
+0003ab70: 6c65 2066 6f72 2074 6865 2055 4454 460a  le for the UDTF.
+0003ab80: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0003ab90: 6974 7320 6465 7065 6e64 656e 6369 6573  its dependencies
+0003aba0: 2073 686f 756c 6420 6265 2075 706c 6f61   should be uploa
+0003abb0: 6465 642e 2054 6865 2073 7461 6765 206c  ded. The stage l
+0003abc0: 6f63 6174 696f 6e20 6d75 7374 2062 6520  ocation must be 
+0003abd0: 7370 6563 6966 6965 640a 2020 2020 2020  specified.      
+0003abe0: 2020 2020 2020 7768 656e 2060 6069 735f        when ``is_
+0003abf0: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+0003ac00: 6054 7275 6560 602c 2061 6e64 2069 7420  `True``, and it 
+0003ac10: 7769 6c6c 2062 6520 6967 6e6f 7265 6420  will be ignored 
+0003ac20: 7768 656e 0a20 2020 2020 2020 2020 2020  when.           
+0003ac30: 2060 6069 735f 7065 726d 616e 656e 7460   ``is_permanent`
+0003ac40: 6020 6973 2060 6046 616c 7365 6060 2e20  ` is ``False``. 
+0003ac50: 4974 2063 616e 2062 6520 616e 7920 7374  It can be any st
+0003ac60: 6167 6520 6f74 6865 7220 7468 616e 2074  age other than t
+0003ac70: 656d 706f 7261 7279 0a20 2020 2020 2020  emporary.       
+0003ac80: 2020 2020 2073 7461 6765 7320 616e 6420       stages and 
+0003ac90: 6578 7465 726e 616c 2073 7461 6765 732e  external stages.
+0003aca0: 0a20 2020 2020 2020 2069 6d70 6f72 7473  .        imports
+0003acb0: 3a20 4120 6c69 7374 206f 6620 696d 706f  : A list of impo
+0003acc0: 7274 7320 7468 6174 206f 6e6c 7920 6170  rts that only ap
+0003acd0: 706c 7920 746f 2074 6869 7320 5544 5446  ply to this UDTF
+0003ace0: 2e20 596f 7520 6361 6e20 7573 6520 6120  . You can use a 
+0003acf0: 7374 7269 6e67 2074 6f0a 2020 2020 2020  string to.      
+0003ad00: 2020 2020 2020 7265 7072 6573 656e 7420        represent 
+0003ad10: 6120 6669 6c65 2070 6174 6820 2873 696d  a file path (sim
+0003ad20: 696c 6172 2074 6f20 7468 6520 6060 7061  ilar to the ``pa
+0003ad30: 7468 6060 2061 7267 756d 656e 7420 696e  th`` argument in
+0003ad40: 0a20 2020 2020 2020 2020 2020 203a 6d65  .            :me
+0003ad50: 7468 3a60 7e73 6e6f 7766 6c61 6b65 2e73  th:`~snowflake.s
+0003ad60: 6e6f 7770 6172 6b2e 5365 7373 696f 6e2e  nowpark.Session.
+0003ad70: 6164 645f 696d 706f 7274 6029 2069 6e20  add_import`) in 
+0003ad80: 7468 6973 206c 6973 742c 206f 7220 6120  this list, or a 
+0003ad90: 7475 706c 6520 6f66 2074 776f 0a20 2020  tuple of two.   
+0003ada0: 2020 2020 2020 2020 2073 7472 696e 6773           strings
+0003adb0: 2074 6f20 7265 7072 6573 656e 7420 6120   to represent a 
+0003adc0: 6669 6c65 2070 6174 6820 616e 6420 616e  file path and an
+0003add0: 2069 6d70 6f72 7420 7061 7468 2028 7369   import path (si
+0003ade0: 6d69 6c61 7220 746f 2074 6865 2060 6069  milar to the ``i
+0003adf0: 6d70 6f72 745f 7061 7468 6060 0a20 2020  mport_path``.   
+0003ae00: 2020 2020 2020 2020 2061 7267 756d 656e           argumen
+0003ae10: 7420 696e 203a 6d65 7468 3a60 7e73 6e6f  t in :meth:`~sno
+0003ae20: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003ae30: 5365 7373 696f 6e2e 6164 645f 696d 706f  Session.add_impo
+0003ae40: 7274 6029 2e20 5468 6573 6520 5544 5446  rt`). These UDTF
+0003ae50: 2d6c 6576 656c 2069 6d70 6f72 7473 0a20  -level imports. 
+0003ae60: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+0003ae70: 6f76 6572 7269 6465 2074 6865 2073 6573  override the ses
+0003ae80: 7369 6f6e 2d6c 6576 656c 2069 6d70 6f72  sion-level impor
+0003ae90: 7473 2061 6464 6564 2062 790a 2020 2020  ts added by.    
+0003aea0: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+0003aeb0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003aec0: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+0003aed0: 6d70 6f72 7460 2e0a 2020 2020 2020 2020  mport`..        
+0003aee0: 7061 636b 6167 6573 3a20 4120 6c69 7374  packages: A list
+0003aef0: 206f 6620 7061 636b 6167 6573 2074 6861   of packages tha
+0003af00: 7420 6f6e 6c79 2061 7070 6c79 2074 6f20  t only apply to 
+0003af10: 7468 6973 2055 4454 462e 2054 6865 7365  this UDTF. These
+0003af20: 2055 4454 462d 6c65 7665 6c20 7061 636b   UDTF-level pack
+0003af30: 6167 6573 0a20 2020 2020 2020 2020 2020  ages.           
+0003af40: 2077 696c 6c20 6f76 6572 7269 6465 2074   will override t
+0003af50: 6865 2073 6573 7369 6f6e 2d6c 6576 656c  he session-level
+0003af60: 2070 6163 6b61 6765 7320 6164 6465 6420   packages added 
+0003af70: 6279 0a20 2020 2020 2020 2020 2020 203a  by.            :
+0003af80: 6d65 7468 3a60 7e73 6e6f 7766 6c61 6b65  meth:`~snowflake
+0003af90: 2e73 6e6f 7770 6172 6b2e 5365 7373 696f  .snowpark.Sessio
+0003afa0: 6e2e 6164 645f 7061 636b 6167 6573 6020  n.add_packages` 
+0003afb0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+0003afc0: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+0003afd0: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+0003afe0: 6f6e 2e61 6464 5f72 6571 7569 7265 6d65  on.add_requireme
+0003aff0: 6e74 7360 2e0a 2020 2020 2020 2020 7265  nts`..        re
+0003b000: 706c 6163 653a 2057 6865 7468 6572 2074  place: Whether t
+0003b010: 6f20 7265 706c 6163 6520 6120 5544 5446  o replace a UDTF
+0003b020: 2074 6861 7420 616c 7265 6164 7920 7761   that already wa
+0003b030: 7320 7265 6769 7374 6572 6564 2e20 5468  s registered. Th
+0003b040: 6520 6465 6661 756c 7420 6973 2060 6046  e default is ``F
+0003b050: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
+0003b060: 2020 2020 4966 2069 7420 6973 2060 6046      If it is ``F
+0003b070: 616c 7365 6060 2c20 6174 7465 6d70 7469  alse``, attempti
+0003b080: 6e67 2074 6f20 7265 6769 7374 6572 2061  ng to register a
+0003b090: 2055 4454 4620 7769 7468 2061 206e 616d   UDTF with a nam
+0003b0a0: 6520 7468 6174 2061 6c72 6561 6479 2065  e that already e
+0003b0b0: 7869 7374 730a 2020 2020 2020 2020 2020  xists.          
+0003b0c0: 2020 7265 7375 6c74 7320 696e 2061 2060    results in a `
+0003b0d0: 6053 6e6f 7770 6172 6b53 514c 4578 6365  `SnowparkSQLExce
+0003b0e0: 7074 696f 6e60 6020 6578 6365 7074 696f  ption`` exceptio
+0003b0f0: 6e20 6265 696e 6720 7468 726f 776e 2e20  n being thrown. 
+0003b100: 4966 2069 7420 6973 2060 6054 7275 6560  If it is ``True`
+0003b110: 602c 0a20 2020 2020 2020 2020 2020 2061  `,.            a
+0003b120: 6e20 6578 6973 7469 6e67 2055 4454 4620  n existing UDTF 
+0003b130: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
+0003b140: 6d65 2069 7320 6f76 6572 7772 6974 7465  me is overwritte
+0003b150: 6e2e 0a20 2020 2020 2020 2069 665f 6e6f  n..        if_no
+0003b160: 745f 6578 6973 7473 3a20 5768 6574 6865  t_exists: Whethe
+0003b170: 7220 746f 2073 6b69 7020 6372 6561 7469  r to skip creati
+0003b180: 6f6e 206f 6620 6120 5544 5446 2077 6865  on of a UDTF whe
+0003b190: 6e20 6f6e 6520 7769 7468 2074 6865 2073  n one with the s
+0003b1a0: 616d 6520 7369 676e 6174 7572 6520 616c  ame signature al
+0003b1b0: 7265 6164 7920 6578 6973 7473 2e0a 2020  ready exists..  
+0003b1c0: 2020 2020 2020 2020 2020 5468 6520 6465            The de
+0003b1d0: 6661 756c 7420 6973 2060 6046 616c 7365  fault is ``False
+0003b1e0: 6060 2e20 6060 6966 5f6e 6f74 5f65 7869  ``. ``if_not_exi
+0003b1f0: 7374 7360 6020 616e 6420 6060 7265 706c  sts`` and ``repl
+0003b200: 6163 6560 6020 6172 6520 6d75 7475 616c  ace`` are mutual
+0003b210: 6c79 2065 7863 6c75 7369 7665 0a20 2020  ly exclusive.   
+0003b220: 2020 2020 2020 2020 2061 6e64 2061 2060           and a `
+0003b230: 6056 616c 7565 4572 726f 7260 6020 6973  `ValueError`` is
+0003b240: 2072 6169 7365 6420 7768 656e 2062 6f74   raised when bot
+0003b250: 6820 6172 6520 7365 742e 2049 6620 6974  h are set. If it
+0003b260: 2069 7320 6060 5472 7565 6060 2061 6e64   is ``True`` and
+0003b270: 2061 2055 4454 4620 7769 7468 0a20 2020   a UDTF with.   
+0003b280: 2020 2020 2020 2020 2074 6865 2073 616d           the sam
+0003b290: 6520 7369 676e 6174 7572 6520 6578 6973  e signature exis
+0003b2a0: 7473 2c20 7468 6520 5544 5446 2063 7265  ts, the UDTF cre
+0003b2b0: 6174 696f 6e20 6973 2073 6b69 7070 6564  ation is skipped
+0003b2c0: 2e0a 2020 2020 2020 2020 7365 7373 696f  ..        sessio
+0003b2d0: 6e3a 2055 7365 2074 6869 7320 7365 7373  n: Use this sess
+0003b2e0: 696f 6e20 746f 2072 6567 6973 7465 7220  ion to register 
+0003b2f0: 7468 6520 5544 5446 2e20 4966 2069 7427  the UDTF. If it'
+0003b300: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
+0003b310: 2074 6865 2073 6573 7369 6f6e 2074 6861   the session tha
+0003b320: 7420 796f 7520 6372 6561 7465 6420 6265  t you created be
+0003b330: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
+0003b340: 7320 6675 6e63 7469 6f6e 2077 696c 6c20  s function will 
+0003b350: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
+0003b360: 2020 2020 2059 6f75 206e 6565 6420 746f       You need to
+0003b370: 2073 7065 6369 6679 2074 6869 7320 7061   specify this pa
+0003b380: 7261 6d65 7465 7220 6966 2079 6f75 2068  rameter if you h
+0003b390: 6176 6520 6372 6561 7465 6420 6d75 6c74  ave created mult
+0003b3a0: 6970 6c65 2073 6573 7369 6f6e 7320 6265  iple sessions be
+0003b3b0: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
+0003b3c0: 7320 6d65 7468 6f64 2e0a 2020 2020 2020  s method..      
+0003b3d0: 2020 7061 7261 6c6c 656c 3a20 5468 6520    parallel: The 
+0003b3e0: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
+0003b3f0: 7320 746f 2075 7365 2066 6f72 2075 706c  s to use for upl
+0003b400: 6f61 6469 6e67 2055 4454 4620 6669 6c65  oading UDTF file
+0003b410: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
+0003b420: 2020 2020 2020 2060 5055 5420 3c68 7474         `PUT <htt
+0003b430: 7073 3a2f 2f64 6f63 732e 736e 6f77 666c  ps://docs.snowfl
+0003b440: 616b 652e 636f 6d2f 656e 2f73 716c 2d72  ake.com/en/sql-r
+0003b450: 6566 6572 656e 6365 2f73 716c 2f70 7574  eference/sql/put
+0003b460: 2e68 746d 6c23 7075 743e 605f 0a20 2020  .html#put>`_.   
+0003b470: 2020 2020 2020 2020 2063 6f6d 6d61 6e64           command
+0003b480: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+0003b490: 6c75 6520 6973 2034 2061 6e64 2073 7570  lue is 4 and sup
+0003b4a0: 706f 7274 6564 2076 616c 7565 7320 6172  ported values ar
+0003b4b0: 6520 6672 6f6d 2031 2074 6f20 3939 2e0a  e from 1 to 99..
+0003b4c0: 2020 2020 2020 2020 2020 2020 496e 6372              Incr
+0003b4d0: 6561 7369 6e67 2074 6865 206e 756d 6265  easing the numbe
+0003b4e0: 7220 6f66 2074 6872 6561 6473 2063 616e  r of threads can
+0003b4f0: 2069 6d70 726f 7665 2070 6572 666f 726d   improve perform
+0003b500: 616e 6365 2077 6865 6e20 7570 6c6f 6164  ance when upload
+0003b510: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0003b520: 6c61 7267 6520 5544 5446 2066 696c 6573  large UDTF files
+0003b530: 2e0a 2020 2020 2020 2020 7374 6174 656d  ..        statem
+0003b540: 656e 745f 7061 7261 6d73 3a20 4469 6374  ent_params: Dict
+0003b550: 696f 6e61 7279 206f 6620 7374 6174 656d  ionary of statem
+0003b560: 656e 7420 6c65 7665 6c20 7061 7261 6d65  ent level parame
+0003b570: 7465 7273 2074 6f20 6265 2073 6574 2077  ters to be set w
+0003b580: 6869 6c65 2065 7865 6375 7469 6e67 2074  hile executing t
+0003b590: 6869 7320 6163 7469 6f6e 2e0a 2020 2020  his action..    
+0003b5a0: 2020 2020 7374 7269 6374 3a20 5768 6574      strict: Whet
+0003b5b0: 6865 7220 7468 6520 6372 6561 7465 6420  her the created 
+0003b5c0: 5544 5446 2069 7320 7374 7269 6374 2e20  UDTF is strict. 
+0003b5d0: 4120 7374 7269 6374 2055 4454 4620 7769  A strict UDTF wi
+0003b5e0: 6c6c 206e 6f74 2069 6e76 6f6b 6520 7468  ll not invoke th
+0003b5f0: 6520 5544 5446 2069 6620 616e 7920 696e  e UDTF if any in
+0003b600: 7075 7420 6973 0a20 2020 2020 2020 2020  put is.         
+0003b610: 2020 206e 756c 6c2e 2049 6e73 7465 6164     null. Instead
+0003b620: 2c20 6120 6e75 6c6c 2076 616c 7565 2077  , a null value w
+0003b630: 696c 6c20 616c 7761 7973 2062 6520 7265  ill always be re
+0003b640: 7475 726e 6564 2066 6f72 2074 6861 7420  turned for that 
+0003b650: 726f 772e 204e 6f74 6520 7468 6174 2074  row. Note that t
+0003b660: 6865 2055 4454 4620 6d69 6768 740a 2020  he UDTF might.  
+0003b670: 2020 2020 2020 2020 2020 7374 696c 6c20            still 
+0003b680: 7265 7475 726e 206e 756c 6c20 666f 7220  return null for 
+0003b690: 6e6f 6e2d 6e75 6c6c 2069 6e70 7574 732e  non-null inputs.
+0003b6a0: 0a20 2020 2020 2020 2073 6563 7572 653a  .        secure:
+0003b6b0: 2057 6865 7468 6572 2074 6865 2063 7265   Whether the cre
+0003b6c0: 6174 6564 2055 4454 4620 6973 2073 6563  ated UDTF is sec
+0003b6d0: 7572 652e 2046 6f72 206d 6f72 6520 696e  ure. For more in
+0003b6e0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+0003b6f0: 7365 6375 7265 2066 756e 6374 696f 6e73  secure functions
+0003b700: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+0003b710: 6520 6053 6563 7572 6520 5544 4673 203c  e `Secure UDFs <
+0003b720: 6874 7470 733a 2f2f 646f 6373 2e73 6e6f  https://docs.sno
+0003b730: 7766 6c61 6b65 2e63 6f6d 2f65 6e2f 7371  wflake.com/en/sq
+0003b740: 6c2d 7265 6665 7265 6e63 652f 7564 662d  l-reference/udf-
+0003b750: 7365 6375 7265 2e68 746d 6c3e 605f 2e0a  secure.html>`_..
+0003b760: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+0003b770: 2020 2020 2020 4120 5544 5446 2066 756e        A UDTF fun
+0003b780: 6374 696f 6e20 7468 6174 2063 616e 2062  ction that can b
+0003b790: 6520 6361 6c6c 6564 2077 6974 6820 3a63  e called with :c
+0003b7a0: 6c61 7373 3a60 7e73 6e6f 7766 6c61 6b65  lass:`~snowflake
+0003b7b0: 2e73 6e6f 7770 6172 6b2e 436f 6c75 6d6e  .snowpark.Column
+0003b7c0: 6020 6578 7072 6573 7369 6f6e 732e 0a0a  ` expressions...
+0003b7d0: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
+0003b7e0: 2020 312e 2057 6865 6e20 7479 7065 2068    1. When type h
+0003b7f0: 696e 7473 2061 7265 2070 726f 7669 6465  ints are provide
+0003b800: 6420 616e 6420 6172 6520 636f 6d70 6c65  d and are comple
+0003b810: 7465 2066 6f72 2061 2066 756e 6374 696f  te for a functio
+0003b820: 6e2c 0a20 2020 2020 2020 2060 6072 6574  n,.        ``ret
+0003b830: 7572 6e5f 7479 7065 6060 2061 6e64 2060  urn_type`` and `
+0003b840: 6069 6e70 7574 5f74 7970 6573 6060 2061  `input_types`` a
+0003b850: 7265 206f 7074 696f 6e61 6c20 616e 6420  re optional and 
+0003b860: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
+0003b870: 0a20 2020 2020 2020 2053 6565 2064 6574  .        See det
+0003b880: 6169 6c73 206f 6620 7375 7070 6f72 7465  ails of supporte
+0003b890: 6420 6461 7461 2074 7970 6573 2066 6f72  d data types for
+0003b8a0: 2055 4454 4673 2069 6e0a 2020 2020 2020   UDTFs in.      
+0003b8b0: 2020 3a63 6c61 7373 3a60 7e73 6e6f 7766    :class:`~snowf
+0003b8c0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7564  lake.snowpark.ud
+0003b8d0: 7466 2e55 4454 4652 6567 6973 7472 6174  tf.UDTFRegistrat
+0003b8e0: 696f 6e60 2e0a 0a20 2020 2020 2020 2020  ion`...         
+0003b8f0: 2020 202d 2059 6f75 2063 616e 2075 7365     - You can use
+0003b900: 2075 7365 203a 6174 7472 3a60 7e73 6e6f   use :attr:`~sno
+0003b910: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003b920: 7479 7065 732e 5661 7269 616e 7460 2074  types.Variant` t
+0003b930: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
+0003b940: 616e 6e6f 7461 7465 2061 2076 6172 6961  annotate a varia
+0003b950: 6e74 2c20 616e 6420 7573 6520 3a61 7474  nt, and use :att
+0003b960: 723a 607e 736e 6f77 666c 616b 652e 736e  r:`~snowflake.sn
+0003b970: 6f77 7061 726b 2e74 7970 6573 2e47 656f  owpark.types.Geo
+0003b980: 6772 6170 6879 600a 2020 2020 2020 2020  graphy`.        
+0003b990: 2020 2020 2020 746f 2061 6e6e 6f74 6174        to annotat
+0003b9a0: 6520 6120 6765 6f67 7261 7068 7920 7768  e a geography wh
+0003b9b0: 656e 2064 6566 696e 696e 6720 6120 5544  en defining a UD
+0003b9c0: 5446 2e0a 0a20 2020 2020 2020 2020 2020  TF...           
+0003b9d0: 202d 203a 636c 6173 733a 6074 7970 696e   - :class:`typin
+0003b9e0: 672e 556e 696f 6e60 2069 7320 6e6f 7420  g.Union` is not 
+0003b9f0: 6120 7661 6c69 6420 7479 7065 2061 6e6e  a valid type ann
+0003ba00: 6f74 6174 696f 6e20 666f 7220 5544 5446  otation for UDTF
+0003ba10: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0003ba20: 2062 7574 203a 636c 6173 733a 6074 7970   but :class:`typ
+0003ba30: 696e 672e 4f70 7469 6f6e 616c 6020 6361  ing.Optional` ca
+0003ba40: 6e20 6265 2075 7365 6420 746f 2069 6e64  n be used to ind
+0003ba50: 6963 6174 6520 7468 6520 6f70 7469 6f6e  icate the option
+0003ba60: 616c 2074 7970 652e 0a0a 2020 2020 2020  al type...      
+0003ba70: 2020 2020 2020 2d20 5479 7065 2068 696e        - Type hin
+0003ba80: 7473 2061 7265 206e 6f74 2073 7570 706f  ts are not suppo
+0003ba90: 7274 6564 206f 6e20 6675 6e63 7469 6f6e  rted on function
+0003baa0: 7320 6465 636f 7261 7465 6420 7769 7468  s decorated with
+0003bab0: 2064 6563 6f72 6174 6f72 732e 0a0a 2020   decorators...  
+0003bac0: 2020 2020 2020 322e 2041 2074 656d 706f        2. A tempo
+0003bad0: 7261 7279 2055 4454 4620 2877 6865 6e20  rary UDTF (when 
+0003bae0: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
+0003baf0: 2069 7320 6060 4661 6c73 6560 6029 2069   is ``False``) i
+0003bb00: 7320 7363 6f70 6564 2074 6f20 7468 6973  s scoped to this
+0003bb10: 2060 6073 6573 7369 6f6e 6060 0a20 2020   ``session``.   
+0003bb20: 2020 2020 2061 6e64 2061 6c6c 2055 4454       and all UDT
+0003bb30: 4620 7265 6c61 7465 6420 6669 6c65 7320  F related files 
+0003bb40: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
+0003bb50: 2074 6f20 6120 7465 6d70 6f72 6172 7920   to a temporary 
+0003bb60: 7365 7373 696f 6e20 7374 6167 650a 2020  session stage.  
+0003bb70: 2020 2020 2020 283a 6675 6e63 3a60 7365        (:func:`se
+0003bb80: 7373 696f 6e2e 6765 745f 7365 7373 696f  ssion.get_sessio
+0003bb90: 6e5f 7374 6167 6528 2920 3c73 6e6f 7766  n_stage() <snowf
+0003bba0: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 5365  lake.snowpark.Se
+0003bbb0: 7373 696f 6e2e 6765 745f 7365 7373 696f  ssion.get_sessio
+0003bbc0: 6e5f 7374 6167 653e 6029 2e0a 2020 2020  n_stage>`)..    
+0003bbd0: 2020 2020 466f 7220 6120 7065 726d 616e      For a perman
+0003bbe0: 656e 7420 5544 5446 2c20 7468 6573 6520  ent UDTF, these 
+0003bbf0: 6669 6c65 7320 7769 6c6c 2062 6520 7570  files will be up
+0003bc00: 6c6f 6164 6564 2074 6f20 7468 6520 7374  loaded to the st
+0003bc10: 6167 6520 7468 6174 2079 6f75 2073 7065  age that you spe
+0003bc20: 6369 6679 2e0a 0a20 2020 2020 2020 2033  cify...        3
+0003bc30: 2e20 4279 2064 6566 6175 6c74 2c20 5544  . By default, UD
+0003bc40: 5446 2072 6567 6973 7472 6174 696f 6e20  TF registration 
+0003bc50: 6661 696c 7320 6966 2061 2066 756e 6374  fails if a funct
+0003bc60: 696f 6e20 7769 7468 2074 6865 2073 616d  ion with the sam
+0003bc70: 6520 6e61 6d65 2069 7320 616c 7265 6164  e name is alread
+0003bc80: 790a 2020 2020 2020 2020 7265 6769 7374  y.        regist
+0003bc90: 6572 6564 2e20 496e 766f 6b69 6e67 203a  ered. Invoking :
+0003bca0: 6675 6e63 3a60 7564 7466 6020 7769 7468  func:`udtf` with
+0003bcb0: 2060 6072 6570 6c61 6365 6060 2073 6574   ``replace`` set
+0003bcc0: 2074 6f20 6060 5472 7565 6060 2077 696c   to ``True`` wil
+0003bcd0: 6c20 6f76 6572 7772 6974 6520 7468 650a  l overwrite the.
+0003bce0: 2020 2020 2020 2020 7072 6576 696f 7573          previous
+0003bcf0: 6c79 2072 6567 6973 7465 7265 6420 6675  ly registered fu
+0003bd00: 6e63 7469 6f6e 2e0a 0a20 2020 2053 6565  nction...    See
+0003bd10: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
+0003bd20: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+0003bd30: 652e 736e 6f77 7061 726b 2e75 6474 662e  e.snowpark.udtf.
+0003bd40: 5544 5446 5265 6769 7374 7261 7469 6f6e  UDTFRegistration
+0003bd50: 600a 0a0a 2020 2020 4578 616d 706c 653a  `...    Example:
+0003bd60: 3a0a 0a20 2020 2020 2020 203e 3e3e 2066  :..        >>> f
+0003bd70: 726f 6d20 736e 6f77 666c 616b 652e 736e  rom snowflake.sn
+0003bd80: 6f77 7061 726b 2e74 7970 6573 2069 6d70  owpark.types imp
+0003bd90: 6f72 7420 496e 7465 6765 7254 7970 652c  ort IntegerType,
+0003bda0: 2053 7472 7563 7446 6965 6c64 2c20 5374   StructField, St
+0003bdb0: 7275 6374 5479 7065 0a20 2020 2020 2020  ructType.       
+0003bdc0: 203e 3e3e 2063 6c61 7373 2050 7269 6d65   >>> class Prime
+0003bdd0: 5369 6576 653a 0a20 2020 2020 2020 202e  Sieve:.        .
+0003bde0: 2e2e 2020 2020 2064 6566 2070 726f 6365  ..     def proce
+0003bdf0: 7373 2873 656c 662c 206e 293a 0a20 2020  ss(self, n):.   
+0003be00: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003be10: 2069 735f 7072 696d 6520 3d20 5b54 7275   is_prime = [Tru
+0003be20: 655d 202a 2028 6e20 2b20 3129 0a20 2020  e] * (n + 1).   
+0003be30: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003be40: 2069 735f 7072 696d 655b 305d 203d 2046   is_prime[0] = F
+0003be50: 616c 7365 0a20 2020 2020 2020 202e 2e2e  alse.        ...
+0003be60: 2020 2020 2020 2020 2069 735f 7072 696d           is_prim
+0003be70: 655b 315d 203d 2046 616c 7365 0a20 2020  e[1] = False.   
+0003be80: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003be90: 2070 203d 2032 0a20 2020 2020 2020 202e   p = 2.        .
+0003bea0: 2e2e 2020 2020 2020 2020 2077 6869 6c65  ..         while
+0003beb0: 2070 202a 2070 203c 3d20 6e3a 0a20 2020   p * p <= n:.   
+0003bec0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003bed0: 2020 2020 2069 6620 6973 5f70 7269 6d65       if is_prime
+0003bee0: 5b70 5d3a 0a20 2020 2020 2020 202e 2e2e  [p]:.        ...
+0003bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bf00: 2023 2073 6574 2061 6c6c 206d 756c 7469   # set all multi
+0003bf10: 706c 6573 206f 6620 7020 746f 2046 616c  ples of p to Fal
+0003bf20: 7365 0a20 2020 2020 2020 202e 2e2e 2020  se.        ...  
+0003bf30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003bf40: 6f72 2069 2069 6e20 7261 6e67 6528 7020  or i in range(p 
+0003bf50: 2a20 702c 206e 202b 2031 2c20 7029 3a0a  * p, n + 1, p):.
+0003bf60: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bf80: 6973 5f70 7269 6d65 5b69 5d20 3d20 4661  is_prime[i] = Fa
+0003bf90: 6c73 650a 2020 2020 2020 2020 2e2e 2e20  lse.        ... 
+0003bfa0: 2020 2020 2020 2020 2020 2020 7020 2b3d              p +=
+0003bfb0: 2031 0a20 2020 2020 2020 202e 2e2e 2020   1.        ...  
+0003bfc0: 2020 2020 2020 2023 2079 6965 6c64 2061         # yield a
+0003bfd0: 6c6c 2070 7269 6d65 206e 756d 6265 7273  ll prime numbers
+0003bfe0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003bff0: 2020 2020 2066 6f72 2070 2069 6e20 7261       for p in ra
+0003c000: 6e67 6528 322c 206e 202b 2031 293a 0a20  nge(2, n + 1):. 
+0003c010: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003c020: 2020 2020 2020 2069 6620 6973 5f70 7269         if is_pri
+0003c030: 6d65 5b70 5d3a 0a20 2020 2020 2020 202e  me[p]:.        .
+0003c040: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c050: 2020 2079 6965 6c64 2028 702c 290a 2020     yield (p,).  
+0003c060: 2020 2020 2020 3e3e 3e20 7072 696d 655f        >>> prime_
+0003c070: 7564 7466 203d 2075 6474 6628 5072 696d  udtf = udtf(Prim
+0003c080: 6553 6965 7665 2c20 6f75 7470 7574 5f73  eSieve, output_s
+0003c090: 6368 656d 613d 5374 7275 6374 5479 7065  chema=StructType
+0003c0a0: 285b 5374 7275 6374 4669 656c 6428 226e  ([StructField("n
+0003c0b0: 756d 6265 7222 2c20 496e 7465 6765 7254  umber", IntegerT
+0003c0c0: 7970 6528 2929 5d29 2c20 696e 7075 745f  ype())]), input_
+0003c0d0: 7479 7065 733d 5b49 6e74 6567 6572 5479  types=[IntegerTy
+0003c0e0: 7065 2829 5d29 0a20 2020 2020 2020 203e  pe()]).        >
+0003c0f0: 3e3e 2073 6573 7369 6f6e 2e74 6162 6c65  >> session.table
+0003c100: 5f66 756e 6374 696f 6e28 7072 696d 655f  _function(prime_
+0003c110: 7564 7466 286c 6974 2832 3029 2929 2e63  udtf(lit(20))).c
+0003c120: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
+0003c130: 205b 526f 7728 4e55 4d42 4552 3d32 292c   [Row(NUMBER=2),
+0003c140: 2052 6f77 284e 554d 4245 523d 3329 2c20   Row(NUMBER=3), 
+0003c150: 526f 7728 4e55 4d42 4552 3d35 292c 2052  Row(NUMBER=5), R
+0003c160: 6f77 284e 554d 4245 523d 3729 2c20 526f  ow(NUMBER=7), Ro
+0003c170: 7728 4e55 4d42 4552 3d31 3129 2c20 526f  w(NUMBER=11), Ro
+0003c180: 7728 4e55 4d42 4552 3d31 3329 2c20 526f  w(NUMBER=13), Ro
+0003c190: 7728 4e55 4d42 4552 3d31 3729 2c20 526f  w(NUMBER=17), Ro
+0003c1a0: 7728 4e55 4d42 4552 3d31 3929 5d0a 0a20  w(NUMBER=19)].. 
+0003c1b0: 2020 2020 2020 2049 6e73 7465 6164 206f         Instead o
+0003c1c0: 6620 6361 6c6c 696e 6720 6075 6474 6660  f calling `udtf`
+0003c1d0: 2069 7420 6973 2061 6c73 6f20 706f 7373   it is also poss
+0003c1e0: 6962 6c65 2074 6f20 7573 6520 7564 7466  ible to use udtf
+0003c1f0: 2061 7320 6120 6465 636f 7261 746f 722e   as a decorator.
+0003c200: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+0003c210: 0a20 2020 2020 2020 203e 3e3e 2040 7564  .        >>> @ud
+0003c220: 7466 286e 616d 653d 2261 6c74 5f69 6e74  tf(name="alt_int
+0003c230: 222c 7265 706c 6163 653d 5472 7565 2c20  ",replace=True, 
+0003c240: 6f75 7470 7574 5f73 6368 656d 613d 5374  output_schema=St
+0003c250: 7275 6374 5479 7065 285b 5374 7275 6374  ructType([Struct
+0003c260: 4669 656c 6428 226e 756d 6265 7222 2c20  Field("number", 
+0003c270: 496e 7465 6765 7254 7970 6528 2929 5d29  IntegerType())])
+0003c280: 2c20 696e 7075 745f 7479 7065 733d 5b49  , input_types=[I
+0003c290: 6e74 6567 6572 5479 7065 2829 5d29 0a20  ntegerType()]). 
+0003c2a0: 2020 2020 2020 202e 2e2e 2063 6c61 7373         ... class
+0003c2b0: 2041 6c74 6572 6e61 746f 723a 0a20 2020   Alternator:.   
+0003c2c0: 2020 2020 202e 2e2e 2020 2020 2064 6566       ...     def
+0003c2d0: 205f 5f69 6e69 745f 5f28 7365 6c66 293a   __init__(self):
+0003c2e0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003c2f0: 2020 2020 2073 656c 662e 5f70 6f73 6974       self._posit
+0003c300: 6976 6520 3d20 5472 7565 0a20 2020 2020  ive = True.     
+0003c310: 2020 202e 2e2e 0a20 2020 2020 2020 202e     ....        .
+0003c320: 2e2e 2020 2020 2064 6566 2070 726f 6365  ..     def proce
+0003c330: 7373 2873 656c 662c 206e 293a 0a20 2020  ss(self, n):.   
+0003c340: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0003c350: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0003c360: 6e29 3a0a 2020 2020 2020 2020 2e2e 2e20  n):.        ... 
+0003c370: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0003c380: 656c 662e 5f70 6f73 6974 6976 653a 0a20  elf._positive:. 
+0003c390: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003c3a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+0003c3b0: 2028 312c 290a 2020 2020 2020 2020 2e2e   (1,).        ..
+0003c3c0: 2e20 2020 2020 2020 2020 2020 2020 656c  .             el
+0003c3d0: 7365 3a0a 2020 2020 2020 2020 2e2e 2e20  se:.        ... 
+0003c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c3f0: 7969 656c 6420 282d 312c 290a 2020 2020  yield (-1,).    
+0003c400: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0003c410: 2020 2020 7365 6c66 2e5f 706f 7369 7469      self._positi
+0003c420: 7665 203d 206e 6f74 2073 656c 662e 5f70  ve = not self._p
+0003c430: 6f73 6974 6976 650a 2020 2020 2020 2020  ositive.        
+0003c440: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
+0003c450: 655f 6675 6e63 7469 6f6e 2822 616c 745f  e_function("alt_
+0003c460: 696e 7422 2c20 6c69 7428 3329 292e 636f  int", lit(3)).co
+0003c470: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
+0003c480: 5b52 6f77 284e 554d 4245 523d 3129 2c20  [Row(NUMBER=1), 
+0003c490: 526f 7728 4e55 4d42 4552 3d2d 3129 2c20  Row(NUMBER=-1), 
+0003c4a0: 526f 7728 4e55 4d42 4552 3d31 295d 0a20  Row(NUMBER=1)]. 
+0003c4b0: 2020 2020 2020 203e 3e3e 2073 6573 7369         >>> sessi
+0003c4c0: 6f6e 2e74 6162 6c65 5f66 756e 6374 696f  on.table_functio
+0003c4d0: 6e28 2261 6c74 5f69 6e74 222c 206c 6974  n("alt_int", lit
+0003c4e0: 2832 2929 2e63 6f6c 6c65 6374 2829 0a20  (2)).collect(). 
+0003c4f0: 2020 2020 2020 205b 526f 7728 4e55 4d42         [Row(NUMB
+0003c500: 4552 3d31 292c 2052 6f77 284e 554d 4245  ER=1), Row(NUMBE
+0003c510: 523d 2d31 295d 0a20 2020 2020 2020 203e  R=-1)].        >
+0003c520: 3e3e 2073 6573 7369 6f6e 2e74 6162 6c65  >> session.table
+0003c530: 5f66 756e 6374 696f 6e28 2261 6c74 5f69  _function("alt_i
+0003c540: 6e74 222c 206c 6974 2831 2929 2e63 6f6c  nt", lit(1)).col
+0003c550: 6c65 6374 2829 0a20 2020 2020 2020 205b  lect().        [
+0003c560: 526f 7728 4e55 4d42 4552 3d31 295d 0a20  Row(NUMBER=1)]. 
+0003c570: 2020 2022 2222 0a20 2020 2073 6573 7369     """.    sessi
+0003c580: 6f6e 203d 2073 6573 7369 6f6e 206f 7220  on = session or 
+0003c590: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003c5a0: 726b 2e73 6573 7369 6f6e 2e5f 6765 745f  rk.session._get_
+0003c5b0: 6163 7469 7665 5f73 6573 7369 6f6e 2829  active_session()
+0003c5c0: 0a20 2020 2069 6620 6861 6e64 6c65 7220  .    if handler 
+0003c5d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0003c5e0: 2072 6574 7572 6e20 6675 6e63 746f 6f6c   return functool
+0003c5f0: 732e 7061 7274 6961 6c28 0a20 2020 2020  s.partial(.     
+0003c600: 2020 2020 2020 2073 6573 7369 6f6e 2e75         session.u
+0003c610: 6474 662e 7265 6769 7374 6572 2c0a 2020  dtf.register,.  
+0003c620: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+0003c630: 5f73 6368 656d 613d 6f75 7470 7574 5f73  _schema=output_s
+0003c640: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
+0003c650: 2020 2069 6e70 7574 5f74 7970 6573 3d69     input_types=i
+0003c660: 6e70 7574 5f74 7970 6573 2c0a 2020 2020  nput_types,.    
+0003c670: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
+0003c680: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003c690: 735f 7065 726d 616e 656e 743d 6973 5f70  s_permanent=is_p
+0003c6a0: 6572 6d61 6e65 6e74 2c0a 2020 2020 2020  ermanent,.      
+0003c6b0: 2020 2020 2020 7374 6167 655f 6c6f 6361        stage_loca
+0003c6c0: 7469 6f6e 3d73 7461 6765 5f6c 6f63 6174  tion=stage_locat
+0003c6d0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0003c6e0: 2069 6d70 6f72 7473 3d69 6d70 6f72 7473   imports=imports
+0003c6f0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0003c700: 636b 6167 6573 3d70 6163 6b61 6765 732c  ckages=packages,
+0003c710: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+0003c720: 6c61 6365 3d72 6570 6c61 6365 2c0a 2020  lace=replace,.  
+0003c730: 2020 2020 2020 2020 2020 6966 5f6e 6f74            if_not
+0003c740: 5f65 7869 7374 733d 6966 5f6e 6f74 5f65  _exists=if_not_e
+0003c750: 7869 7374 732c 0a20 2020 2020 2020 2020  xists,.         
+0003c760: 2020 2070 6172 616c 6c65 6c3d 7061 7261     parallel=para
+0003c770: 6c6c 656c 2c0a 2020 2020 2020 2020 2020  llel,.          
+0003c780: 2020 7374 6174 656d 656e 745f 7061 7261    statement_para
+0003c790: 6d73 3d73 7461 7465 6d65 6e74 5f70 6172  ms=statement_par
+0003c7a0: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
+0003c7b0: 2073 7472 6963 743d 7374 7269 6374 2c0a   strict=strict,.
+0003c7c0: 2020 2020 2020 2020 2020 2020 7365 6375              secu
+0003c7d0: 7265 3d73 6563 7572 652c 0a20 2020 2020  re=secure,.     
+0003c7e0: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
+0003c7f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0003c800: 7373 696f 6e2e 7564 7466 2e72 6567 6973  ssion.udtf.regis
+0003c810: 7465 7228 0a20 2020 2020 2020 2020 2020  ter(.           
+0003c820: 2068 616e 646c 6572 2c0a 2020 2020 2020   handler,.      
+0003c830: 2020 2020 2020 6f75 7470 7574 5f73 6368        output_sch
+0003c840: 656d 613d 6f75 7470 7574 5f73 6368 656d  ema=output_schem
+0003c850: 612c 0a20 2020 2020 2020 2020 2020 2069  a,.            i
+0003c860: 6e70 7574 5f74 7970 6573 3d69 6e70 7574  nput_types=input
+0003c870: 5f74 7970 6573 2c0a 2020 2020 2020 2020  _types,.        
+0003c880: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
+0003c890: 2020 2020 2020 2020 2020 2069 735f 7065             is_pe
+0003c8a0: 726d 616e 656e 743d 6973 5f70 6572 6d61  rmanent=is_perma
+0003c8b0: 6e65 6e74 2c0a 2020 2020 2020 2020 2020  nent,.          
+0003c8c0: 2020 7374 6167 655f 6c6f 6361 7469 6f6e    stage_location
+0003c8d0: 3d73 7461 6765 5f6c 6f63 6174 696f 6e2c  =stage_location,
+0003c8e0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0003c8f0: 6f72 7473 3d69 6d70 6f72 7473 2c0a 2020  orts=imports,.  
+0003c900: 2020 2020 2020 2020 2020 7061 636b 6167            packag
+0003c910: 6573 3d70 6163 6b61 6765 732c 0a20 2020  es=packages,.   
+0003c920: 2020 2020 2020 2020 2072 6570 6c61 6365           replace
+0003c930: 3d72 6570 6c61 6365 2c0a 2020 2020 2020  =replace,.      
+0003c940: 2020 2020 2020 6966 5f6e 6f74 5f65 7869        if_not_exi
+0003c950: 7374 733d 6966 5f6e 6f74 5f65 7869 7374  sts=if_not_exist
+0003c960: 732c 0a20 2020 2020 2020 2020 2020 2070  s,.            p
+0003c970: 6172 616c 6c65 6c3d 7061 7261 6c6c 656c  arallel=parallel
+0003c980: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+0003c990: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
+0003c9a0: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
+0003c9b0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0003c9c0: 6963 743d 7374 7269 6374 2c0a 2020 2020  ict=strict,.    
+0003c9d0: 2020 2020 2020 2020 7365 6375 7265 3d73          secure=s
+0003c9e0: 6563 7572 652c 0a20 2020 2020 2020 2029  ecure,.        )
+0003c9f0: 0a0a 0a64 6566 2070 616e 6461 735f 7564  ...def pandas_ud
+0003ca00: 6628 0a20 2020 2066 756e 633a 204f 7074  f(.    func: Opt
+0003ca10: 696f 6e61 6c5b 4361 6c6c 6162 6c65 5d20  ional[Callable] 
+0003ca20: 3d20 4e6f 6e65 2c0a 2020 2020 2a2c 0a20  = None,.    *,. 
+0003ca30: 2020 2072 6574 7572 6e5f 7479 7065 3a20     return_type: 
+0003ca40: 4f70 7469 6f6e 616c 5b44 6174 6154 7970  Optional[DataTyp
+0003ca50: 655d 203d 204e 6f6e 652c 0a20 2020 2069  e] = None,.    i
+0003ca60: 6e70 7574 5f74 7970 6573 3a20 4f70 7469  nput_types: Opti
+0003ca70: 6f6e 616c 5b4c 6973 745b 4461 7461 5479  onal[List[DataTy
+0003ca80: 7065 5d5d 203d 204e 6f6e 652c 0a20 2020  pe]] = None,.   
+0003ca90: 206e 616d 653a 204f 7074 696f 6e61 6c5b   name: Optional[
+0003caa0: 556e 696f 6e5b 7374 722c 2049 7465 7261  Union[str, Itera
+0003cab0: 626c 655b 7374 725d 5d5d 203d 204e 6f6e  ble[str]]] = Non
+0003cac0: 652c 0a20 2020 2069 735f 7065 726d 616e  e,.    is_perman
+0003cad0: 656e 743a 2062 6f6f 6c20 3d20 4661 6c73  ent: bool = Fals
+0003cae0: 652c 0a20 2020 2073 7461 6765 5f6c 6f63  e,.    stage_loc
+0003caf0: 6174 696f 6e3a 204f 7074 696f 6e61 6c5b  ation: Optional[
+0003cb00: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0003cb10: 2069 6d70 6f72 7473 3a20 4f70 7469 6f6e   imports: Option
+0003cb20: 616c 5b4c 6973 745b 556e 696f 6e5b 7374  al[List[Union[st
+0003cb30: 722c 2054 7570 6c65 5b73 7472 2c20 7374  r, Tuple[str, st
+0003cb40: 725d 5d5d 5d20 3d20 4e6f 6e65 2c0a 2020  r]]]] = None,.  
+0003cb50: 2020 7061 636b 6167 6573 3a20 4f70 7469    packages: Opti
+0003cb60: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
+0003cb70: 7374 722c 204d 6f64 756c 6554 7970 655d  str, ModuleType]
+0003cb80: 5d5d 203d 204e 6f6e 652c 0a20 2020 2072  ]] = None,.    r
+0003cb90: 6570 6c61 6365 3a20 626f 6f6c 203d 2046  eplace: bool = F
+0003cba0: 616c 7365 2c0a 2020 2020 6966 5f6e 6f74  alse,.    if_not
+0003cbb0: 5f65 7869 7374 733a 2062 6f6f 6c20 3d20  _exists: bool = 
+0003cbc0: 4661 6c73 652c 0a20 2020 2073 6573 7369  False,.    sessi
+0003cbd0: 6f6e 3a20 4f70 7469 6f6e 616c 5b22 736e  on: Optional["sn
+0003cbe0: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003cbf0: 2e73 6573 7369 6f6e 2e53 6573 7369 6f6e  .session.Session
+0003cc00: 225d 203d 204e 6f6e 652c 0a20 2020 2070  "] = None,.    p
+0003cc10: 6172 616c 6c65 6c3a 2069 6e74 203d 2034  arallel: int = 4
+0003cc20: 2c0a 2020 2020 6d61 785f 6261 7463 685f  ,.    max_batch_
+0003cc30: 7369 7a65 3a20 4f70 7469 6f6e 616c 5b69  size: Optional[i
+0003cc40: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+0003cc50: 7374 6174 656d 656e 745f 7061 7261 6d73  statement_params
+0003cc60: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
+0003cc70: 7374 722c 2073 7472 5d5d 203d 204e 6f6e  str, str]] = Non
+0003cc80: 652c 0a20 2020 2073 6f75 7263 655f 636f  e,.    source_co
+0003cc90: 6465 5f64 6973 706c 6179 3a20 626f 6f6c  de_display: bool
+0003cca0: 203d 2054 7275 652c 0a29 202d 3e20 556e   = True,.) -> Un
+0003ccb0: 696f 6e5b 5573 6572 4465 6669 6e65 6446  ion[UserDefinedF
+0003ccc0: 756e 6374 696f 6e2c 2066 756e 6374 6f6f  unction, functoo
+0003ccd0: 6c73 2e70 6172 7469 616c 5d3a 0a20 2020  ls.partial]:.   
+0003cce0: 2022 2222 0a20 2020 2052 6567 6973 7465   """.    Registe
+0003ccf0: 7273 2061 2050 7974 686f 6e20 6675 6e63  rs a Python func
+0003cd00: 7469 6f6e 2061 7320 6120 7665 6374 6f72  tion as a vector
+0003cd10: 697a 6564 2055 4446 2061 6e64 2072 6574  ized UDF and ret
+0003cd20: 7572 6e73 2074 6865 2055 4446 2e0a 2020  urns the UDF..  
+0003cd30: 2020 5468 6520 6172 6775 6d65 6e74 732c    The arguments,
+0003cd40: 2072 6574 7572 6e20 7661 6c75 6520 616e   return value an
+0003cd50: 6420 7573 6167 6520 6f66 2074 6869 7320  d usage of this 
+0003cd60: 6675 6e63 7469 6f6e 2061 7265 2065 7861  function are exa
+0003cd70: 6374 6c79 2074 6865 2073 616d 6520 6173  ctly the same as
+0003cd80: 0a20 2020 203a 6675 6e63 3a60 7564 6660  .    :func:`udf`
+0003cd90: 2c20 6275 7420 7468 6973 2066 756e 6374  , but this funct
+0003cda0: 696f 6e20 6361 6e20 6f6e 6c79 2062 6520  ion can only be 
+0003cdb0: 7573 6564 2066 6f72 2072 6567 6973 7465  used for registe
+0003cdc0: 7269 6e67 2076 6563 746f 7269 7a65 6420  ring vectorized 
+0003cdd0: 5544 4673 2e0a 2020 2020 5365 6520 6578  UDFs..    See ex
+0003cde0: 616d 706c 6573 2069 6e20 3a63 6c61 7373  amples in :class
+0003cdf0: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003ce00: 7770 6172 6b2e 7564 662e 5544 4652 6567  wpark.udf.UDFReg
+0003ce10: 6973 7472 6174 696f 6e60 2e0a 0a20 2020  istration`...   
+0003ce20: 2053 6565 2041 6c73 6f3a 0a20 2020 2020   See Also:.     
+0003ce30: 2020 202d 203a 6675 6e63 3a60 7564 6660     - :func:`udf`
+0003ce40: 0a20 2020 2020 2020 202d 203a 6d65 7468  .        - :meth
+0003ce50: 3a60 5544 4652 6567 6973 7472 6174 696f  :`UDFRegistratio
+0003ce60: 6e2e 7265 6769 7374 6572 2829 203c 736e  n.register() <sn
+0003ce70: 6f77 666c 616b 652e 736e 6f77 7061 726b  owflake.snowpark
+0003ce80: 2e75 6466 2e55 4446 5265 6769 7374 7261  .udf.UDFRegistra
+0003ce90: 7469 6f6e 2e72 6567 6973 7465 723e 600a  tion.register>`.
+0003cea0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a0a  .    Example::..
+0003ceb0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+0003cec0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+0003ced0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+0003cee0: 2050 616e 6461 7353 6572 6965 7354 7970   PandasSeriesTyp
+0003cef0: 652c 2050 616e 6461 7344 6174 6146 7261  e, PandasDataFra
+0003cf00: 6d65 5479 7065 2c20 496e 7465 6765 7254  meType, IntegerT
+0003cf10: 7970 650a 2020 2020 2020 2020 3e3e 3e20  ype.        >>> 
+0003cf20: 6164 645f 6f6e 655f 6466 5f70 616e 6461  add_one_df_panda
+0003cf30: 735f 7564 6620 3d20 7061 6e64 6173 5f75  s_udf = pandas_u
+0003cf40: 6466 280a 2020 2020 2020 2020 2e2e 2e20  df(.        ... 
+0003cf50: 2020 2020 6c61 6d62 6461 2064 663a 2064      lambda df: d
+0003cf60: 665b 305d 202b 2064 665b 315d 202b 2031  f[0] + df[1] + 1
+0003cf70: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0003cf80: 2020 7265 7475 726e 5f74 7970 653d 5061    return_type=Pa
+0003cf90: 6e64 6173 5365 7269 6573 5479 7065 2849  ndasSeriesType(I
+0003cfa0: 6e74 6567 6572 5479 7065 2829 292c 0a20  ntegerType()),. 
+0003cfb0: 2020 2020 2020 202e 2e2e 2020 2020 2069         ...     i
+0003cfc0: 6e70 7574 5f74 7970 6573 3d5b 5061 6e64  nput_types=[Pand
+0003cfd0: 6173 4461 7461 4672 616d 6554 7970 6528  asDataFrameType(
+0003cfe0: 5b49 6e74 6567 6572 5479 7065 2829 2c20  [IntegerType(), 
+0003cff0: 496e 7465 6765 7254 7970 6528 295d 295d  IntegerType()])]
+0003d000: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+0003d010: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0003d020: 7365 7373 696f 6e2e 6372 6561 7465 5f64  session.create_d
+0003d030: 6174 6166 7261 6d65 285b 5b31 2c20 325d  ataframe([[1, 2]
+0003d040: 2c20 5b33 2c20 345d 5d2c 2073 6368 656d  , [3, 4]], schem
+0003d050: 613d 5b22 6122 2c20 2262 225d 290a 2020  a=["a", "b"]).  
+0003d060: 2020 2020 2020 3e3e 3e20 6466 2e73 656c        >>> df.sel
+0003d070: 6563 7428 6164 645f 6f6e 655f 6466 5f70  ect(add_one_df_p
+0003d080: 616e 6461 735f 7564 6628 2261 222c 2022  andas_udf("a", "
+0003d090: 6222 292e 616c 6961 7328 2272 6573 756c  b").alias("resul
+0003d0a0: 7422 2929 2e6f 7264 6572 5f62 7928 2272  t")).order_by("r
+0003d0b0: 6573 756c 7422 292e 7368 6f77 2829 0a20  esult").show(). 
+0003d0c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0003d0d0: 2d2d 2d0a 2020 2020 2020 2020 7c22 5245  ---.        |"RE
+0003d0e0: 5355 4c54 2220 207c 0a20 2020 2020 2020  SULT"  |.       
+0003d0f0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020   ------------.  
+0003d100: 2020 2020 2020 7c34 2020 2020 2020 2020        |4        
+0003d110: 207c 0a20 2020 2020 2020 207c 3820 2020   |.        |8   
+0003d120: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0003d130: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0003d140: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0003d150: 0a0a 2020 2020 6f72 2061 7320 6e61 6d65  ..    or as name
+0003d160: 6420 5061 6e64 6173 2055 4446 7320 7468  d Pandas UDFs th
+0003d170: 6174 2061 7265 2061 6363 6573 6962 6c65  at are accesible
+0003d180: 2069 6e20 7468 6520 7361 6d65 2073 6573   in the same ses
+0003d190: 7369 6f6e 2e20 496e 7374 6561 6420 6f66  sion. Instead of
+0003d1a0: 2063 616c 6c69 6e67 2060 7061 6e64 6173   calling `pandas
+0003d1b0: 5f75 6466 6020 6173 2066 756e 6374 696f  _udf` as functio
+0003d1c0: 6e2c 0a20 2020 2069 7420 6361 6e20 6265  n,.    it can be
+0003d1d0: 2061 6c73 6f20 7573 6564 2061 7320 6120   also used as a 
+0003d1e0: 6465 636f 7261 746f 723a 0a0a 2020 2020  decorator:..    
+0003d1f0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0003d200: 2020 203e 3e3e 2066 726f 6d20 736e 6f77     >>> from snow
+0003d210: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003d220: 7970 6573 2069 6d70 6f72 7420 5061 6e64  ypes import Pand
+0003d230: 6173 5365 7269 6573 5479 7065 2c20 5061  asSeriesType, Pa
+0003d240: 6e64 6173 4461 7461 4672 616d 6554 7970  ndasDataFrameTyp
+0003d250: 652c 2049 6e74 6567 6572 5479 7065 0a20  e, IntegerType. 
+0003d260: 2020 2020 2020 203e 3e3e 2040 7061 6e64         >>> @pand
+0003d270: 6173 5f75 6466 280a 2020 2020 2020 2020  as_udf(.        
+0003d280: 2e2e 2e20 2020 2020 7265 7475 726e 5f74  ...     return_t
+0003d290: 7970 653d 5061 6e64 6173 5365 7269 6573  ype=PandasSeries
+0003d2a0: 5479 7065 2849 6e74 6567 6572 5479 7065  Type(IntegerType
+0003d2b0: 2829 292c 0a20 2020 2020 2020 202e 2e2e  ()),.        ...
+0003d2c0: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
+0003d2d0: 3d5b 5061 6e64 6173 4461 7461 4672 616d  =[PandasDataFram
+0003d2e0: 6554 7970 6528 5b49 6e74 6567 6572 5479  eType([IntegerTy
+0003d2f0: 7065 2829 2c20 496e 7465 6765 7254 7970  pe(), IntegerTyp
+0003d300: 6528 295d 295d 2c0a 2020 2020 2020 2020  e()])],.        
+0003d310: 2e2e 2e20 290a 2020 2020 2020 2020 2e2e  ... ).        ..
+0003d320: 2e20 6465 6620 6164 645f 6f6e 655f 6466  . def add_one_df
+0003d330: 5f70 616e 6461 735f 7564 6628 6466 293a  _pandas_udf(df):
+0003d340: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003d350: 2072 6574 7572 6e20 6466 5b30 5d20 2b20   return df[0] + 
+0003d360: 6466 5b31 5d20 2b20 310a 2020 2020 2020  df[1] + 1.      
+0003d370: 2020 3e3e 3e20 6466 203d 2073 6573 7369    >>> df = sessi
+0003d380: 6f6e 2e63 7265 6174 655f 6461 7461 6672  on.create_datafr
+0003d390: 616d 6528 5b5b 312c 2032 5d2c 205b 332c  ame([[1, 2], [3,
+0003d3a0: 2034 5d5d 2c20 7363 6865 6d61 3d5b 2261   4]], schema=["a
+0003d3b0: 222c 2022 6222 5d29 0a20 2020 2020 2020  ", "b"]).       
+0003d3c0: 203e 3e3e 2064 662e 7365 6c65 6374 2861   >>> df.select(a
+0003d3d0: 6464 5f6f 6e65 5f64 665f 7061 6e64 6173  dd_one_df_pandas
+0003d3e0: 5f75 6466 2822 6122 2c20 2262 2229 2e61  _udf("a", "b").a
+0003d3f0: 6c69 6173 2822 7265 7375 6c74 2229 292e  lias("result")).
+0003d400: 6f72 6465 725f 6279 2822 7265 7375 6c74  order_by("result
+0003d410: 2229 2e73 686f 7728 290a 2020 2020 2020  ").show().      
+0003d420: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20    ------------. 
+0003d430: 2020 2020 2020 207c 2252 4553 554c 5422         |"RESULT"
+0003d440: 2020 7c0a 2020 2020 2020 2020 2d2d 2d2d    |.        ----
+0003d450: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0003d460: 207c 3420 2020 2020 2020 2020 7c0a 2020   |4         |.  
+0003d470: 2020 2020 2020 7c38 2020 2020 2020 2020        |8        
+0003d480: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0003d490: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003d4a0: 3c42 4c41 4e4b 4c49 4e45 3e0a 2020 2020  <BLANKLINE>.    
+0003d4b0: 2222 220a 2020 2020 7365 7373 696f 6e20  """.    session 
+0003d4c0: 3d20 7365 7373 696f 6e20 6f72 2073 6e6f  = session or sno
+0003d4d0: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003d4e0: 7365 7373 696f 6e2e 5f67 6574 5f61 6374  session._get_act
+0003d4f0: 6976 655f 7365 7373 696f 6e28 290a 2020  ive_session().  
+0003d500: 2020 6966 2066 756e 6320 6973 204e 6f6e    if func is Non
+0003d510: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+0003d520: 6e20 6675 6e63 746f 6f6c 732e 7061 7274  n functools.part
+0003d530: 6961 6c28 0a20 2020 2020 2020 2020 2020  ial(.           
+0003d540: 2073 6573 7369 6f6e 2e75 6466 2e72 6567   session.udf.reg
+0003d550: 6973 7465 722c 0a20 2020 2020 2020 2020  ister,.         
+0003d560: 2020 2072 6574 7572 6e5f 7479 7065 3d72     return_type=r
+0003d570: 6574 7572 6e5f 7479 7065 2c0a 2020 2020  eturn_type,.    
+0003d580: 2020 2020 2020 2020 696e 7075 745f 7479          input_ty
+0003d590: 7065 733d 696e 7075 745f 7479 7065 732c  pes=input_types,
+0003d5a0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0003d5b0: 653d 6e61 6d65 2c0a 2020 2020 2020 2020  e=name,.        
+0003d5c0: 2020 2020 6973 5f70 6572 6d61 6e65 6e74      is_permanent
+0003d5d0: 3d69 735f 7065 726d 616e 656e 742c 0a20  =is_permanent,. 
+0003d5e0: 2020 2020 2020 2020 2020 2073 7461 6765             stage
+0003d5f0: 5f6c 6f63 6174 696f 6e3d 7374 6167 655f  _location=stage_
+0003d600: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
+0003d610: 2020 2020 2020 696d 706f 7274 733d 696d        imports=im
+0003d620: 706f 7274 732c 0a20 2020 2020 2020 2020  ports,.         
+0003d630: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
+0003d640: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
+0003d650: 2020 7265 706c 6163 653d 7265 706c 6163    replace=replac
+0003d660: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0003d670: 665f 6e6f 745f 6578 6973 7473 3d69 665f  f_not_exists=if_
+0003d680: 6e6f 745f 6578 6973 7473 2c0a 2020 2020  not_exists,.    
+0003d690: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
+0003d6a0: 3d70 6172 616c 6c65 6c2c 0a20 2020 2020  =parallel,.     
+0003d6b0: 2020 2020 2020 206d 6178 5f62 6174 6368         max_batch
+0003d6c0: 5f73 697a 653d 6d61 785f 6261 7463 685f  _size=max_batch_
+0003d6d0: 7369 7a65 2c0a 2020 2020 2020 2020 2020  size,.          
+0003d6e0: 2020 5f66 726f 6d5f 7061 6e64 6173 5f75    _from_pandas_u
+0003d6f0: 6466 5f66 756e 6374 696f 6e3d 5472 7565  df_function=True
+0003d700: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+0003d710: 6174 656d 656e 745f 7061 7261 6d73 3d73  atement_params=s
+0003d720: 7461 7465 6d65 6e74 5f70 6172 616d 732c  tatement_params,
+0003d730: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+0003d740: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
+0003d750: 3d73 6f75 7263 655f 636f 6465 5f64 6973  =source_code_dis
+0003d760: 706c 6179 2c0a 2020 2020 2020 2020 290a  play,.        ).
+0003d770: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003d780: 2020 7265 7475 726e 2073 6573 7369 6f6e    return session
+0003d790: 2e75 6466 2e72 6567 6973 7465 7228 0a20  .udf.register(. 
+0003d7a0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
+0003d7b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003d7c0: 7572 6e5f 7479 7065 3d72 6574 7572 6e5f  urn_type=return_
+0003d7d0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0003d7e0: 2020 696e 7075 745f 7479 7065 733d 696e    input_types=in
+0003d7f0: 7075 745f 7479 7065 732c 0a20 2020 2020  put_types,.     
+0003d800: 2020 2020 2020 206e 616d 653d 6e61 6d65         name=name
+0003d810: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
+0003d820: 5f70 6572 6d61 6e65 6e74 3d69 735f 7065  _permanent=is_pe
+0003d830: 726d 616e 656e 742c 0a20 2020 2020 2020  rmanent,.       
+0003d840: 2020 2020 2073 7461 6765 5f6c 6f63 6174       stage_locat
+0003d850: 696f 6e3d 7374 6167 655f 6c6f 6361 7469  ion=stage_locati
+0003d860: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0003d870: 696d 706f 7274 733d 696d 706f 7274 732c  imports=imports,
+0003d880: 0a20 2020 2020 2020 2020 2020 2070 6163  .            pac
+0003d890: 6b61 6765 733d 7061 636b 6167 6573 2c0a  kages=packages,.
+0003d8a0: 2020 2020 2020 2020 2020 2020 7265 706c              repl
+0003d8b0: 6163 653d 7265 706c 6163 652c 0a20 2020  ace=replace,.   
+0003d8c0: 2020 2020 2020 2020 2069 665f 6e6f 745f           if_not_
+0003d8d0: 6578 6973 7473 3d69 665f 6e6f 745f 6578  exists=if_not_ex
+0003d8e0: 6973 7473 2c0a 2020 2020 2020 2020 2020  ists,.          
+0003d8f0: 2020 7061 7261 6c6c 656c 3d70 6172 616c    parallel=paral
+0003d900: 6c65 6c2c 0a20 2020 2020 2020 2020 2020  lel,.           
+0003d910: 206d 6178 5f62 6174 6368 5f73 697a 653d   max_batch_size=
+0003d920: 6d61 785f 6261 7463 685f 7369 7a65 2c0a  max_batch_size,.
+0003d930: 2020 2020 2020 2020 2020 2020 5f66 726f              _fro
+0003d940: 6d5f 7061 6e64 6173 5f75 6466 5f66 756e  m_pandas_udf_fun
+0003d950: 6374 696f 6e3d 5472 7565 2c0a 2020 2020  ction=True,.    
+0003d960: 2020 2020 2020 2020 7374 6174 656d 656e          statemen
+0003d970: 745f 7061 7261 6d73 3d73 7461 7465 6d65  t_params=stateme
+0003d980: 6e74 5f70 6172 616d 732c 0a20 2020 2020  nt_params,.     
+0003d990: 2020 2020 2020 2073 6f75 7263 655f 636f         source_co
+0003d9a0: 6465 5f64 6973 706c 6179 3d73 6f75 7263  de_display=sourc
+0003d9b0: 655f 636f 6465 5f64 6973 706c 6179 2c0a  e_code_display,.
+0003d9c0: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+0003d9d0: 6361 6c6c 5f75 6466 280a 2020 2020 7564  call_udf(.    ud
+0003d9e0: 665f 6e61 6d65 3a20 7374 722c 0a20 2020  f_name: str,.   
+0003d9f0: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
+0003da00: 4c69 7465 7261 6c2c 0a29 202d 3e20 436f  Literal,.) -> Co
+0003da10: 6c75 6d6e 3a0a 2020 2020 2222 2243 616c  lumn:.    """Cal
+0003da20: 6c73 2061 2075 7365 722d 6465 6669 6e65  ls a user-define
+0003da30: 6420 6675 6e63 7469 6f6e 2028 5544 4629  d function (UDF)
+0003da40: 2062 7920 6e61 6d65 2e0a 0a20 2020 2041   by name...    A
+0003da50: 7267 733a 0a20 2020 2020 2020 2075 6466  rgs:.        udf
+0003da60: 5f6e 616d 653a 2054 6865 206e 616d 6520  _name: The name 
+0003da70: 6f66 2055 4446 2069 6e20 536e 6f77 666c  of UDF in Snowfl
+0003da80: 616b 652e 0a20 2020 2020 2020 2061 7267  ake..        arg
+0003da90: 733a 2041 7267 756d 656e 7473 2063 616e  s: Arguments can
+0003daa0: 2062 6520 696e 2074 776f 2074 7970 6573   be in two types
+0003dab0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+0003dac0: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+0003dad0: 616b 652e 736e 6f77 7061 726b 2e43 6f6c  ake.snowpark.Col
+0003dae0: 756d 6e60 2c20 6f72 0a20 2020 2020 2020  umn`, or.       
+0003daf0: 2020 2020 202d 2042 6173 6963 2050 7974       - Basic Pyt
+0003db00: 686f 6e20 7479 7065 732c 2077 6869 6368  hon types, which
+0003db10: 2061 7265 2063 6f6e 7665 7274 6564 2074   are converted t
+0003db20: 6f20 536e 6f77 7061 726b 206c 6974 6572  o Snowpark liter
+0003db30: 616c 732e 0a0a 2020 2020 4578 616d 706c  als...    Exampl
+0003db40: 653a 3a0a 2020 2020 2020 2020 3e3e 3e20  e::.        >>> 
+0003db50: 6672 6f6d 2073 6e6f 7766 6c61 6b65 2e73  from snowflake.s
+0003db60: 6e6f 7770 6172 6b2e 7479 7065 7320 696d  nowpark.types im
+0003db70: 706f 7274 2049 6e74 6567 6572 5479 7065  port IntegerType
+0003db80: 0a20 2020 2020 2020 203e 3e3e 2075 6466  .        >>> udf
+0003db90: 5f64 6566 203d 2073 6573 7369 6f6e 2e75  _def = session.u
+0003dba0: 6466 2e72 6567 6973 7465 7228 6c61 6d62  df.register(lamb
+0003dbb0: 6461 2078 2c20 793a 2078 202b 2079 2c20  da x, y: x + y, 
+0003dbc0: 6e61 6d65 3d22 6164 645f 636f 6c75 6d6e  name="add_column
+0003dbd0: 7322 2c20 696e 7075 745f 7479 7065 733d  s", input_types=
+0003dbe0: 5b49 6e74 6567 6572 5479 7065 2829 2c20  [IntegerType(), 
+0003dbf0: 496e 7465 6765 7254 7970 6528 295d 2c20  IntegerType()], 
+0003dc00: 7265 7475 726e 5f74 7970 653d 496e 7465  return_type=Inte
+0003dc10: 6765 7254 7970 6528 292c 2072 6570 6c61  gerType(), repla
+0003dc20: 6365 3d54 7275 6529 0a20 2020 2020 2020  ce=True).       
+0003dc30: 203e 3e3e 2064 6620 3d20 7365 7373 696f   >>> df = sessio
+0003dc40: 6e2e 6372 6561 7465 5f64 6174 6166 7261  n.create_datafra
+0003dc50: 6d65 285b 5b31 2c20 325d 5d2c 2073 6368  me([[1, 2]], sch
+0003dc60: 656d 613d 5b22 6122 2c20 2262 225d 290a  ema=["a", "b"]).
+0003dc70: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0003dc80: 656c 6563 7428 6361 6c6c 5f75 6466 2822  elect(call_udf("
+0003dc90: 6164 645f 636f 6c75 6d6e 7322 2c20 636f  add_columns", co
+0003dca0: 6c28 2261 2229 2c20 636f 6c28 2262 2229  l("a"), col("b")
+0003dcb0: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0003dcc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0003dcd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003dce0: 2d0a 2020 2020 2020 2020 7c22 4144 445f  -.        |"ADD_
+0003dcf0: 434f 4c55 4d4e 5328 2222 4122 222c 2022  COLUMNS(""A"", "
+0003dd00: 2242 2222 2922 2020 7c0a 2020 2020 2020  "B"")"  |.      
+0003dd10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0003dd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003dd30: 2d0a 2020 2020 2020 2020 7c33 2020 2020  -.        |3    
+0003dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dd50: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
+0003dd60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0003dd70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003dd80: 2d0a 2020 2020 2020 2020 3c42 4c41 4e4b  -.        <BLANK
+0003dd90: 4c49 4e45 3e0a 2020 2020 2222 220a 0a20  LINE>.    """.. 
+0003dda0: 2020 2076 616c 6964 6174 655f 6f62 6a65     validate_obje
+0003ddb0: 6374 5f6e 616d 6528 7564 665f 6e61 6d65  ct_name(udf_name
+0003ddc0: 290a 2020 2020 7265 7475 726e 205f 6361  ).    return _ca
+0003ddd0: 6c6c 5f66 756e 6374 696f 6e28 7564 665f  ll_function(udf_
+0003dde0: 6e61 6d65 2c20 4661 6c73 652c 202a 6172  name, False, *ar
+0003ddf0: 6773 2c20 6170 695f 6361 6c6c 5f73 6f75  gs, api_call_sou
+0003de00: 7263 653d 2266 756e 6374 696f 6e73 2e63  rce="functions.c
+0003de10: 616c 6c5f 7564 6622 290a 0a0a 6465 6620  all_udf")...def 
+0003de20: 6361 6c6c 5f74 6162 6c65 5f66 756e 6374  call_table_funct
+0003de30: 696f 6e28 0a20 2020 2066 756e 6374 696f  ion(.    functio
+0003de40: 6e5f 6e61 6d65 3a20 7374 722c 202a 6172  n_name: str, *ar
+0003de50: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
+0003de60: 7261 6c2c 202a 2a6b 7761 7267 733a 2043  ral, **kwargs: C
+0003de70: 6f6c 756d 6e4f 724c 6974 6572 616c 0a29  olumnOrLiteral.)
+0003de80: 202d 3e20 2273 6e6f 7766 6c61 6b65 2e73   -> "snowflake.s
+0003de90: 6e6f 7770 6172 6b2e 7461 626c 655f 6675  nowpark.table_fu
+0003dea0: 6e63 7469 6f6e 2e54 6162 6c65 4675 6e63  nction.TableFunc
+0003deb0: 7469 6f6e 4361 6c6c 223a 0a20 2020 2022  tionCall":.    "
+0003dec0: 2222 496e 766f 6b65 7320 6120 536e 6f77  ""Invokes a Snow
+0003ded0: 666c 616b 6520 7461 626c 6520 6675 6e63  flake table func
+0003dee0: 7469 6f6e 2c20 696e 636c 7564 696e 6720  tion, including 
+0003def0: 7379 7374 656d 2d64 6566 696e 6564 2074  system-defined t
+0003df00: 6162 6c65 2066 756e 6374 696f 6e73 2061  able functions a
+0003df10: 6e64 2075 7365 722d 6465 6669 6e65 6420  nd user-defined 
+0003df20: 7461 626c 6520 6675 6e63 7469 6f6e 732e  table functions.
+0003df30: 0a0a 2020 2020 4974 2072 6574 7572 6e73  ..    It returns
+0003df40: 2061 203a 6d65 7468 3a60 7e73 6e6f 7766   a :meth:`~snowf
+0003df50: 6c61 6b65 2e73 6e6f 7770 6172 6b2e 7461  lake.snowpark.ta
+0003df60: 626c 655f 6675 6e63 7469 6f6e 2e54 6162  ble_function.Tab
+0003df70: 6c65 4675 6e63 7469 6f6e 4361 6c6c 6020  leFunctionCall` 
+0003df80: 736f 2079 6f75 2063 616e 2073 7065 6369  so you can speci
+0003df90: 6679 2074 6865 2070 6172 7469 7469 6f6e  fy the partition
+0003dfa0: 2063 6c61 7573 652e 0a0a 2020 2020 4172   clause...    Ar
+0003dfb0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+0003dfc0: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
+0003dfd0: 616d 6520 6f66 2074 6865 2074 6162 6c65  ame of the table
+0003dfe0: 2066 756e 6374 696f 6e2e 0a20 2020 2020   function..     
+0003dff0: 2020 2061 7267 733a 2054 6865 2070 6f73     args: The pos
+0003e000: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+0003e010: 7320 6f66 2074 6865 2074 6162 6c65 2066  s of the table f
+0003e020: 756e 6374 696f 6e2e 0a20 2020 2020 2020  unction..       
+0003e030: 202a 2a6b 7761 7267 733a 2054 6865 206e   **kwargs: The n
+0003e040: 616d 6564 2061 7267 756d 656e 7473 206f  amed arguments o
+0003e050: 6620 7468 6520 7461 626c 6520 6675 6e63  f the table func
+0003e060: 7469 6f6e 2e20 536f 6d65 2074 6162 6c65  tion. Some table
+0003e070: 2066 756e 6374 696f 6e73 2028 652e 672e   functions (e.g.
+0003e080: 2c20 6060 666c 6174 7465 6e60 6029 2068  , ``flatten``) h
+0003e090: 6176 6520 6e61 6d65 6420 6172 6775 6d65  ave named argume
+0003e0a0: 6e74 7320 696e 7374 6561 6420 6f66 2070  nts instead of p
+0003e0b0: 6f73 6974 696f 6e61 6c20 6f6e 6573 2e0a  ositional ones..
+0003e0c0: 0a20 2020 2045 7861 6d70 6c65 3a3a 0a20  .    Example::. 
+0003e0d0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0003e0e0: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003e0f0: 726b 2e66 756e 6374 696f 6e73 2069 6d70  rk.functions imp
+0003e100: 6f72 7420 6c69 740a 2020 2020 2020 2020  ort lit.        
+0003e110: 3e3e 3e20 7365 7373 696f 6e2e 7461 626c  >>> session.tabl
+0003e120: 655f 6675 6e63 7469 6f6e 2863 616c 6c5f  e_function(call_
+0003e130: 7461 626c 655f 6675 6e63 7469 6f6e 2822  table_function("
+0003e140: 7370 6c69 745f 746f 5f74 6162 6c65 222c  split_to_table",
+0003e150: 206c 6974 2822 7370 6c69 7420 776f 7264   lit("split word
+0003e160: 7320 746f 2074 6162 6c65 2229 2c20 6c69  s to table"), li
+0003e170: 7428 2220 2229 292e 6f76 6572 2829 292e  t(" ")).over()).
+0003e180: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+0003e190: 2020 5b52 6f77 2853 4551 3d31 2c20 494e    [Row(SEQ=1, IN
+0003e1a0: 4445 583d 312c 2056 414c 5545 3d27 7370  DEX=1, VALUE='sp
+0003e1b0: 6c69 7427 292c 2052 6f77 2853 4551 3d31  lit'), Row(SEQ=1
+0003e1c0: 2c20 494e 4445 583d 322c 2056 414c 5545  , INDEX=2, VALUE
+0003e1d0: 3d27 776f 7264 7327 292c 2052 6f77 2853  ='words'), Row(S
+0003e1e0: 4551 3d31 2c20 494e 4445 583d 332c 2056  EQ=1, INDEX=3, V
+0003e1f0: 414c 5545 3d27 746f 2729 2c20 526f 7728  ALUE='to'), Row(
+0003e200: 5345 513d 312c 2049 4e44 4558 3d34 2c20  SEQ=1, INDEX=4, 
+0003e210: 5641 4c55 453d 2774 6162 6c65 2729 5d0a  VALUE='table')].
+0003e220: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+0003e230: 726e 2073 6e6f 7766 6c61 6b65 2e73 6e6f  rn snowflake.sno
+0003e240: 7770 6172 6b2e 7461 626c 655f 6675 6e63  wpark.table_func
+0003e250: 7469 6f6e 2e54 6162 6c65 4675 6e63 7469  tion.TableFuncti
+0003e260: 6f6e 4361 6c6c 280a 2020 2020 2020 2020  onCall(.        
+0003e270: 6675 6e63 7469 6f6e 5f6e 616d 652c 202a  function_name, *
+0003e280: 6172 6773 2c20 2a2a 6b77 6172 6773 0a20  args, **kwargs. 
+0003e290: 2020 2029 0a0a 0a64 6566 2074 6162 6c65     )...def table
+0003e2a0: 5f66 756e 6374 696f 6e28 6675 6e63 7469  _function(functi
+0003e2b0: 6f6e 5f6e 616d 653a 2073 7472 2920 2d3e  on_name: str) ->
+0003e2c0: 2043 616c 6c61 626c 653a 0a20 2020 2022   Callable:.    "
+0003e2d0: 2222 4372 6561 7465 2061 2066 756e 6374  ""Create a funct
+0003e2e0: 696f 6e20 6f62 6a65 6374 2074 6f20 696e  ion object to in
+0003e2f0: 766f 6b65 2061 2053 6e6f 7766 6c61 6b65  voke a Snowflake
+0003e300: 2074 6162 6c65 2066 756e 6374 696f 6e2e   table function.
+0003e310: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
+0003e320: 2020 2020 6675 6e63 7469 6f6e 5f6e 616d      function_nam
+0003e330: 653a 2054 6865 206e 616d 6520 6f66 2074  e: The name of t
+0003e340: 6865 2074 6162 6c65 2066 756e 6374 696f  he table functio
+0003e350: 6e2e 0a0a 2020 2020 4578 616d 706c 653a  n...    Example:
+0003e360: 3a0a 2020 2020 2020 2020 3e3e 3e20 6672  :.        >>> fr
+0003e370: 6f6d 2073 6e6f 7766 6c61 6b65 2e73 6e6f  om snowflake.sno
+0003e380: 7770 6172 6b2e 6675 6e63 7469 6f6e 7320  wpark.functions 
+0003e390: 696d 706f 7274 206c 6974 0a20 2020 2020  import lit.     
+0003e3a0: 2020 203e 3e3e 2073 706c 6974 5f74 6f5f     >>> split_to_
+0003e3b0: 7461 626c 6520 3d20 7461 626c 655f 6675  table = table_fu
+0003e3c0: 6e63 7469 6f6e 2822 7370 6c69 745f 746f  nction("split_to
+0003e3d0: 5f74 6162 6c65 2229 0a20 2020 2020 2020  _table").       
+0003e3e0: 203e 3e3e 2073 6573 7369 6f6e 2e74 6162   >>> session.tab
+0003e3f0: 6c65 5f66 756e 6374 696f 6e28 7370 6c69  le_function(spli
+0003e400: 745f 746f 5f74 6162 6c65 286c 6974 2822  t_to_table(lit("
+0003e410: 7370 6c69 7420 776f 7264 7320 746f 2074  split words to t
+0003e420: 6162 6c65 2229 2c20 6c69 7428 2220 2229  able"), lit(" ")
+0003e430: 292e 6f76 6572 2829 292e 636f 6c6c 6563  ).over()).collec
+0003e440: 7428 290a 2020 2020 2020 2020 5b52 6f77  t().        [Row
+0003e450: 2853 4551 3d31 2c20 494e 4445 583d 312c  (SEQ=1, INDEX=1,
+0003e460: 2056 414c 5545 3d27 7370 6c69 7427 292c   VALUE='split'),
+0003e470: 2052 6f77 2853 4551 3d31 2c20 494e 4445   Row(SEQ=1, INDE
+0003e480: 583d 322c 2056 414c 5545 3d27 776f 7264  X=2, VALUE='word
+0003e490: 7327 292c 2052 6f77 2853 4551 3d31 2c20  s'), Row(SEQ=1, 
+0003e4a0: 494e 4445 583d 332c 2056 414c 5545 3d27  INDEX=3, VALUE='
+0003e4b0: 746f 2729 2c20 526f 7728 5345 513d 312c  to'), Row(SEQ=1,
+0003e4c0: 2049 4e44 4558 3d34 2c20 5641 4c55 453d   INDEX=4, VALUE=
+0003e4d0: 2774 6162 6c65 2729 5d0a 2020 2020 2222  'table')].    ""
+0003e4e0: 220a 2020 2020 7265 7475 726e 206c 616d  ".    return lam
+0003e4f0: 6264 6120 2a61 7267 732c 202a 2a6b 7761  bda *args, **kwa
+0003e500: 7267 733a 2063 616c 6c5f 7461 626c 655f  rgs: call_table_
+0003e510: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
+0003e520: 6e5f 6e61 6d65 2c20 2a61 7267 732c 202a  n_name, *args, *
+0003e530: 2a6b 7761 7267 7329 0a0a 0a64 6566 2063  *kwargs)...def c
+0003e540: 616c 6c5f 6675 6e63 7469 6f6e 2866 756e  all_function(fun
+0003e550: 6374 696f 6e5f 6e61 6d65 3a20 7374 722c  ction_name: str,
+0003e560: 202a 6172 6773 3a20 436f 6c75 6d6e 4f72   *args: ColumnOr
+0003e570: 4c69 7465 7261 6c29 202d 3e20 436f 6c75  Literal) -> Colu
+0003e580: 6d6e 3a0a 2020 2020 2222 2249 6e76 6f6b  mn:.    """Invok
+0003e590: 6573 2061 2053 6e6f 7766 6c61 6b65 2060  es a Snowflake `
+0003e5a0: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
+0003e5b0: 756e 6374 696f 6e20 3c68 7474 7073 3a2f  unction <https:/
+0003e5c0: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
+0003e5d0: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
+0003e5e0: 656e 6365 2d66 756e 6374 696f 6e73 2e68  ence-functions.h
+0003e5f0: 746d 6c3e 605f 2028 6275 696c 742d 696e  tml>`_ (built-in
+0003e600: 2066 756e 6374 696f 6e29 2077 6974 6820   function) with 
+0003e610: 7468 6520 7370 6563 6966 6965 6420 6e61  the specified na
+0003e620: 6d65 0a20 2020 2061 6e64 2061 7267 756d  me.    and argum
+0003e630: 656e 7473 2e0a 0a20 2020 2041 7267 733a  ents...    Args:
+0003e640: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
+0003e650: 6e5f 6e61 6d65 3a20 5468 6520 6e61 6d65  n_name: The name
+0003e660: 206f 6620 6275 696c 742d 696e 2066 756e   of built-in fun
+0003e670: 6374 696f 6e20 696e 2053 6e6f 7766 6c61  ction in Snowfla
+0003e680: 6b65 0a20 2020 2020 2020 2061 7267 733a  ke.        args:
+0003e690: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
+0003e6a0: 6520 696e 2074 776f 2074 7970 6573 3a0a  e in two types:.
+0003e6b0: 0a20 2020 2020 2020 2020 2020 202d 203a  .            - :
+0003e6c0: 636c 6173 733a 607e 736e 6f77 666c 616b  class:`~snowflak
+0003e6d0: 652e 736e 6f77 7061 726b 2e43 6f6c 756d  e.snowpark.Colum
+0003e6e0: 6e60 2c20 6f72 0a20 2020 2020 2020 2020  n`, or.         
+0003e6f0: 2020 202d 2042 6173 6963 2050 7974 686f     - Basic Pytho
+0003e700: 6e20 7479 7065 732c 2077 6869 6368 2061  n types, which a
+0003e710: 7265 2063 6f6e 7665 7274 6564 2074 6f20  re converted to 
+0003e720: 536e 6f77 7061 726b 206c 6974 6572 616c  Snowpark literal
+0003e730: 732e 0a0a 2020 2020 4578 616d 706c 653a  s...    Example:
+0003e740: 3a0a 2020 2020 2020 2020 3e3e 3e20 6466  :.        >>> df
+0003e750: 203d 2073 6573 7369 6f6e 2e63 7265 6174   = session.creat
+0003e760: 655f 6461 7461 6672 616d 6528 5b31 2c20  e_dataframe([1, 
+0003e770: 322c 2033 2c20 345d 2c20 7363 6865 6d61  2, 3, 4], schema
+0003e780: 3d5b 2261 225d 2920 2023 2061 2073 696e  =["a"])  # a sin
+0003e790: 676c 6520 636f 6c75 6d6e 2077 6974 6820  gle column with 
+0003e7a0: 3420 726f 7773 0a20 2020 2020 2020 203e  4 rows.        >
+0003e7b0: 3e3e 2064 662e 7365 6c65 6374 2863 616c  >> df.select(cal
+0003e7c0: 6c5f 6675 6e63 7469 6f6e 2822 6176 6722  l_function("avg"
+0003e7d0: 2c20 636f 6c28 2261 2229 2929 2e73 686f  , col("a"))).sho
+0003e7e0: 7728 290a 2020 2020 2020 2020 2d2d 2d2d  w().        ----
+0003e7f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
+0003e800: 2020 2020 207c 2241 5647 2822 2241 2222       |"AVG(""A""
+0003e810: 2922 2020 7c0a 2020 2020 2020 2020 2d2d  )"  |.        --
+0003e820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+0003e830: 2020 2020 2020 207c 322e 3530 3030 3030         |2.500000
+0003e840: 2020 2020 2020 7c0a 2020 2020 2020 2020        |.        
+0003e850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0003e860: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+0003e870: 494e 453e 0a0a 2020 2020 2222 220a 0a20  INE>..    """.. 
+0003e880: 2020 2072 6574 7572 6e20 5f63 616c 6c5f     return _call_
+0003e890: 6675 6e63 7469 6f6e 2866 756e 6374 696f  function(functio
+0003e8a0: 6e5f 6e61 6d65 2c20 4661 6c73 652c 202a  n_name, False, *
+0003e8b0: 6172 6773 290a 0a0a 6465 6620 6675 6e63  args)...def func
+0003e8c0: 7469 6f6e 2866 756e 6374 696f 6e5f 6e61  tion(function_na
+0003e8d0: 6d65 3a20 7374 7229 202d 3e20 4361 6c6c  me: str) -> Call
+0003e8e0: 6162 6c65 3a0a 2020 2020 2222 220a 2020  able:.    """.  
+0003e8f0: 2020 4675 6e63 7469 6f6e 206f 626a 6563    Function objec
+0003e900: 7420 746f 2069 6e76 6f6b 6520 6120 536e  t to invoke a Sn
+0003e910: 6f77 666c 616b 6520 6073 7973 7465 6d2d  owflake `system-
+0003e920: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+0003e930: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+0003e940: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+0003e950: 7371 6c2d 7265 6665 7265 6e63 652d 6675  sql-reference-fu
+0003e960: 6e63 7469 6f6e 732e 6874 6d6c 3e60 5f20  nctions.html>`_ 
+0003e970: 2862 7569 6c74 2d69 6e20 6675 6e63 7469  (built-in functi
+0003e980: 6f6e 292e 2055 7365 2074 6869 7320 746f  on). Use this to
+0003e990: 2069 6e76 6f6b 650a 2020 2020 616e 7920   invoke.    any 
+0003e9a0: 6275 696c 742d 696e 2066 756e 6374 696f  built-in functio
+0003e9b0: 6e73 206e 6f74 2065 7870 6c69 6369 746c  ns not explicitl
+0003e9c0: 7920 6c69 7374 6564 2069 6e20 7468 6973  y listed in this
+0003e9d0: 206f 626a 6563 742e 0a0a 2020 2020 4172   object...    Ar
+0003e9e0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+0003e9f0: 7469 6f6e 5f6e 616d 653a 2054 6865 206e  tion_name: The n
+0003ea00: 616d 6520 6f66 2062 7569 6c74 2d69 6e20  ame of built-in 
+0003ea10: 6675 6e63 7469 6f6e 2069 6e20 536e 6f77  function in Snow
+0003ea20: 666c 616b 652e 0a0a 2020 2020 5265 7475  flake...    Retu
+0003ea30: 726e 733a 0a20 2020 2020 2020 2041 203a  rns:.        A :
+0003ea40: 636c 6173 733a 6043 616c 6c61 626c 6560  class:`Callable`
+0003ea50: 206f 626a 6563 7420 666f 7220 6361 6c6c   object for call
+0003ea60: 696e 6720 6120 536e 6f77 666c 616b 6520  ing a Snowflake 
+0003ea70: 7379 7374 656d 2d64 6566 696e 6564 2066  system-defined f
+0003ea80: 756e 6374 696f 6e2e 0a0a 2020 2020 4578  unction...    Ex
+0003ea90: 616d 706c 653a 3a0a 2020 2020 2020 2020  ample::.        
+0003eaa0: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+0003eab0: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+0003eac0: 6528 5b31 2c20 322c 2033 2c20 345d 2c20  e([1, 2, 3, 4], 
+0003ead0: 7363 6865 6d61 3d5b 2261 225d 2920 2023  schema=["a"])  #
+0003eae0: 2061 2073 696e 676c 6520 636f 6c75 6d6e   a single column
+0003eaf0: 2077 6974 6820 3420 726f 7773 0a20 2020   with 4 rows.   
+0003eb00: 2020 2020 203e 3e3e 2064 662e 7365 6c65       >>> df.sele
+0003eb10: 6374 2863 616c 6c5f 6675 6e63 7469 6f6e  ct(call_function
+0003eb20: 2822 6176 6722 2c20 636f 6c28 2261 2229  ("avg", col("a")
+0003eb30: 2929 2e73 686f 7728 290a 2020 2020 2020  )).show().      
+0003eb40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    --------------
+0003eb50: 2d2d 0a20 2020 2020 2020 207c 2241 5647  --.        |"AVG
+0003eb60: 2822 2241 2222 2922 2020 7c0a 2020 2020  (""A"")"  |.    
+0003eb70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+0003eb80: 2d2d 2d2d 0a20 2020 2020 2020 207c 322e  ----.        |2.
+0003eb90: 3530 3030 3030 2020 2020 2020 7c0a 2020  500000      |.  
+0003eba0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0003ebb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203c  ------.        <
+0003ebc0: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
+0003ebd0: 2020 203e 3e3e 206d 795f 6176 6720 3d20     >>> my_avg = 
+0003ebe0: 6675 6e63 7469 6f6e 2827 6176 6727 290a  function('avg').
+0003ebf0: 2020 2020 2020 2020 3e3e 3e20 6466 2e73          >>> df.s
+0003ec00: 656c 6563 7428 6d79 5f61 7667 2863 6f6c  elect(my_avg(col
+0003ec10: 2822 6122 2929 292e 7368 6f77 2829 0a20  ("a"))).show(). 
+0003ec20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0003ec30: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003ec40: 7c22 4156 4728 2222 4122 2229 2220 207c  |"AVG(""A"")"  |
+0003ec50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003ec60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0003ec70: 2020 7c32 2e35 3030 3030 3020 2020 2020    |2.500000     
+0003ec80: 207c 0a20 2020 2020 2020 202d 2d2d 2d2d   |.        -----
+0003ec90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+0003eca0: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
+0003ecb0: 2020 2020 2222 220a 2020 2020 7265 7475      """.    retu
+0003ecc0: 726e 206c 616d 6264 6120 2a61 7267 733a  rn lambda *args:
+0003ecd0: 2063 616c 6c5f 6675 6e63 7469 6f6e 2866   call_function(f
+0003ece0: 756e 6374 696f 6e5f 6e61 6d65 2c20 2a61  unction_name, *a
+0003ecf0: 7267 7329 0a0a 0a64 6566 205f 6361 6c6c  rgs)...def _call
+0003ed00: 5f66 756e 6374 696f 6e28 0a20 2020 206e  _function(.    n
+0003ed10: 616d 653a 2073 7472 2c0a 2020 2020 6973  ame: str,.    is
+0003ed20: 5f64 6973 7469 6e63 743a 2062 6f6f 6c20  _distinct: bool 
+0003ed30: 3d20 4661 6c73 652c 0a20 2020 202a 6172  = False,.    *ar
+0003ed40: 6773 3a20 436f 6c75 6d6e 4f72 4c69 7465  gs: ColumnOrLite
+0003ed50: 7261 6c2c 0a20 2020 2061 7069 5f63 616c  ral,.    api_cal
+0003ed60: 6c5f 736f 7572 6365 3a20 4f70 7469 6f6e  l_source: Option
+0003ed70: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0003ed80: 2920 2d3e 2043 6f6c 756d 6e3a 0a20 2020  ) -> Column:.   
+0003ed90: 2065 7870 7265 7373 696f 6e73 203d 205b   expressions = [
+0003eda0: 436f 6c75 6d6e 2e5f 746f 5f65 7870 7228  Column._to_expr(
+0003edb0: 6172 6729 2066 6f72 2061 7267 2069 6e20  arg) for arg in 
+0003edc0: 7061 7273 655f 706f 7369 7469 6f6e 616c  parse_positional
+0003edd0: 5f61 7267 735f 746f 5f6c 6973 7428 2a61  _args_to_list(*a
+0003ede0: 7267 7329 5d0a 2020 2020 7265 7475 726e  rgs)].    return
+0003edf0: 2043 6f6c 756d 6e28 0a20 2020 2020 2020   Column(.       
+0003ee00: 2046 756e 6374 696f 6e45 7870 7265 7373   FunctionExpress
+0003ee10: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0003ee20: 206e 616d 652c 2065 7870 7265 7373 696f   name, expressio
+0003ee30: 6e73 2c20 6973 5f64 6973 7469 6e63 743d  ns, is_distinct=
+0003ee40: 6973 5f64 6973 7469 6e63 742c 2061 7069  is_distinct, api
+0003ee50: 5f63 616c 6c5f 736f 7572 6365 3d61 7069  _call_source=api
+0003ee60: 5f63 616c 6c5f 736f 7572 6365 0a20 2020  _call_source.   
+0003ee70: 2020 2020 2029 0a20 2020 2029 0a0a 0a64       ).    )...d
+0003ee80: 6566 2073 7072 6f63 280a 2020 2020 6675  ef sproc(.    fu
+0003ee90: 6e63 3a20 4f70 7469 6f6e 616c 5b43 616c  nc: Optional[Cal
+0003eea0: 6c61 626c 655d 203d 204e 6f6e 652c 0a20  lable] = None,. 
+0003eeb0: 2020 202a 2c0a 2020 2020 7265 7475 726e     *,.    return
+0003eec0: 5f74 7970 653a 204f 7074 696f 6e61 6c5b  _type: Optional[
+0003eed0: 4461 7461 5479 7065 5d20 3d20 4e6f 6e65  DataType] = None
+0003eee0: 2c0a 2020 2020 696e 7075 745f 7479 7065  ,.    input_type
+0003eef0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+0003ef00: 5b44 6174 6154 7970 655d 5d20 3d20 4e6f  [DataType]] = No
+0003ef10: 6e65 2c0a 2020 2020 6e61 6d65 3a20 4f70  ne,.    name: Op
+0003ef20: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+0003ef30: 2c20 4974 6572 6162 6c65 5b73 7472 5d5d  , Iterable[str]]
+0003ef40: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 6973  ] = None,.    is
+0003ef50: 5f70 6572 6d61 6e65 6e74 3a20 626f 6f6c  _permanent: bool
+0003ef60: 203d 2046 616c 7365 2c0a 2020 2020 7374   = False,.    st
+0003ef70: 6167 655f 6c6f 6361 7469 6f6e 3a20 4f70  age_location: Op
+0003ef80: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+0003ef90: 6e65 2c0a 2020 2020 696d 706f 7274 733a  ne,.    imports:
+0003efa0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b55   Optional[List[U
+0003efb0: 6e69 6f6e 5b73 7472 2c20 5475 706c 655b  nion[str, Tuple[
+0003efc0: 7374 722c 2073 7472 5d5d 5d5d 203d 204e  str, str]]]] = N
+0003efd0: 6f6e 652c 0a20 2020 2070 6163 6b61 6765  one,.    package
+0003efe0: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+0003eff0: 5b55 6e69 6f6e 5b73 7472 2c20 4d6f 6475  [Union[str, Modu
+0003f000: 6c65 5479 7065 5d5d 5d20 3d20 4e6f 6e65  leType]]] = None
+0003f010: 2c0a 2020 2020 7265 706c 6163 653a 2062  ,.    replace: b
+0003f020: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0003f030: 2069 665f 6e6f 745f 6578 6973 7473 3a20   if_not_exists: 
+0003f040: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0003f050: 2020 7365 7373 696f 6e3a 204f 7074 696f    session: Optio
+0003f060: 6e61 6c5b 2273 6e6f 7766 6c61 6b65 2e73  nal["snowflake.s
+0003f070: 6e6f 7770 6172 6b2e 5365 7373 696f 6e22  nowpark.Session"
+0003f080: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 7061  ] = None,.    pa
+0003f090: 7261 6c6c 656c 3a20 696e 7420 3d20 342c  rallel: int = 4,
+0003f0a0: 0a20 2020 2073 7461 7465 6d65 6e74 5f70  .    statement_p
+0003f0b0: 6172 616d 733a 204f 7074 696f 6e61 6c5b  arams: Optional[
+0003f0c0: 4469 6374 5b73 7472 2c20 7374 725d 5d20  Dict[str, str]] 
+0003f0d0: 3d20 4e6f 6e65 2c0a 2020 2020 6578 6563  = None,.    exec
+0003f0e0: 7574 655f 6173 3a20 7479 7069 6e67 2e4c  ute_as: typing.L
+0003f0f0: 6974 6572 616c 5b22 6361 6c6c 6572 222c  iteral["caller",
+0003f100: 2022 6f77 6e65 7222 5d20 3d20 226f 776e   "owner"] = "own
+0003f110: 6572 222c 0a20 2020 2073 7472 6963 743a  er",.    strict:
+0003f120: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0003f130: 2020 2073 6f75 7263 655f 636f 6465 5f64     source_code_d
+0003f140: 6973 706c 6179 3a20 626f 6f6c 203d 2054  isplay: bool = T
+0003f150: 7275 652c 0a20 2020 202a 2a6b 7761 7267  rue,.    **kwarg
+0003f160: 732c 0a29 202d 3e20 556e 696f 6e5b 5374  s,.) -> Union[St
+0003f170: 6f72 6564 5072 6f63 6564 7572 652c 2066  oredProcedure, f
+0003f180: 756e 6374 6f6f 6c73 2e70 6172 7469 616c  unctools.partial
+0003f190: 5d3a 0a20 2020 2022 2222 5265 6769 7374  ]:.    """Regist
+0003f1a0: 6572 7320 6120 5079 7468 6f6e 2066 756e  ers a Python fun
+0003f1b0: 6374 696f 6e20 6173 2061 2053 6e6f 7766  ction as a Snowf
+0003f1c0: 6c61 6b65 2050 7974 686f 6e20 7374 6f72  lake Python stor
+0003f1d0: 6564 2070 726f 6365 6475 7265 2061 6e64  ed procedure and
+0003f1e0: 2072 6574 7572 6e73 2074 6865 2073 746f   returns the sto
+0003f1f0: 7265 6420 7072 6f63 6564 7572 652e 0a0a  red procedure...
+0003f200: 2020 2020 4974 2063 616e 2062 6520 7573      It can be us
+0003f210: 6564 2061 7320 6569 7468 6572 2061 2066  ed as either a f
+0003f220: 756e 6374 696f 6e20 6361 6c6c 206f 7220  unction call or 
+0003f230: 6120 6465 636f 7261 746f 722e 2049 6e20  a decorator. In 
+0003f240: 6d6f 7374 2063 6173 6573 2079 6f75 2077  most cases you w
+0003f250: 6f72 6b20 7769 7468 2061 2073 696e 676c  ork with a singl
+0003f260: 6520 7365 7373 696f 6e2e 0a20 2020 2054  e session..    T
+0003f270: 6869 7320 6675 6e63 7469 6f6e 2075 7365  his function use
+0003f280: 7320 7468 6174 2073 6573 7369 6f6e 2074  s that session t
+0003f290: 6f20 7265 6769 7374 6572 2074 6865 2073  o register the s
+0003f2a0: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
+0003f2b0: 2049 6620 796f 7520 6861 7665 206d 756c   If you have mul
+0003f2c0: 7469 706c 6520 7365 7373 696f 6e73 2c20  tiple sessions, 
+0003f2d0: 796f 7520 6e65 6564 2074 6f0a 2020 2020  you need to.    
+0003f2e0: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
+0003f2f0: 6679 2074 6865 2060 6073 6573 7369 6f6e  fy the ``session
+0003f300: 6060 2070 6172 616d 6574 6572 206f 6620  `` parameter of 
+0003f310: 7468 6973 2066 756e 6374 696f 6e2e 2049  this function. I
+0003f320: 6620 796f 7520 6861 7665 2061 2066 756e  f you have a fun
+0003f330: 6374 696f 6e20 616e 6420 776f 756c 640a  ction and would.
+0003f340: 2020 2020 6c69 6b65 2074 6f20 7265 6769      like to regi
+0003f350: 7374 6572 2069 7420 746f 206d 756c 7469  ster it to multi
+0003f360: 706c 6520 6461 7461 6261 7365 732c 2075  ple databases, u
+0003f370: 7365 2060 6073 6573 7369 6f6e 2e73 7072  se ``session.spr
+0003f380: 6f63 2e72 6567 6973 7465 7260 6020 696e  oc.register`` in
+0003f390: 7374 6561 642e 2053 6565 2065 7861 6d70  stead. See examp
+0003f3a0: 6c65 730a 2020 2020 696e 203a 636c 6173  les.    in :clas
+0003f3b0: 733a 607e 736e 6f77 666c 616b 652e 736e  s:`~snowflake.sn
+0003f3c0: 6f77 7061 726b 2e73 746f 7265 645f 7072  owpark.stored_pr
+0003f3d0: 6f63 6564 7572 652e 5374 6f72 6564 5072  ocedure.StoredPr
+0003f3e0: 6f63 6564 7572 6552 6567 6973 7472 6174  ocedureRegistrat
+0003f3f0: 696f 6e60 2e0a 0a20 2020 204e 6f74 6520  ion`...    Note 
+0003f400: 7468 6174 2074 6865 2066 6972 7374 2070  that the first p
+0003f410: 6172 616d 6574 6572 206f 6620 796f 7572  arameter of your
+0003f420: 2066 756e 6374 696f 6e20 7368 6f75 6c64   function should
+0003f430: 2062 6520 6120 736e 6f77 7061 726b 2053   be a snowpark S
+0003f440: 6573 7369 6f6e 2e20 416c 736f 2c20 796f  ession. Also, yo
+0003f450: 7520 6e65 6564 2074 6f20 6164 640a 2020  u need to add.  
+0003f460: 2020 6073 6e6f 7766 6c61 6b65 2d73 6e6f    `snowflake-sno
+0003f470: 7770 6172 6b2d 7079 7468 6f6e 6020 7061  wpark-python` pa
+0003f480: 636b 6167 6520 2876 6572 7369 6f6e 203e  ckage (version >
+0003f490: 3d20 302e 342e 3029 2074 6f20 796f 7572  = 0.4.0) to your
+0003f4a0: 2073 6573 7369 6f6e 2062 6566 6f72 6520   session before 
+0003f4b0: 7472 7969 6e67 2074 6f20 6372 6561 7465  trying to create
+0003f4c0: 2061 0a20 2020 2073 746f 7265 6420 7072   a.    stored pr
+0003f4d0: 6f63 6564 7572 652e 0a0a 2020 2020 4172  ocedure...    Ar
+0003f4e0: 6773 3a0a 2020 2020 2020 2020 6675 6e63  gs:.        func
+0003f4f0: 3a20 4120 5079 7468 6f6e 2066 756e 6374  : A Python funct
+0003f500: 696f 6e20 7573 6564 2066 6f72 2063 7265  ion used for cre
+0003f510: 6174 696e 6720 7468 6520 7374 6f72 6564  ating the stored
+0003f520: 2070 726f 6365 6475 7265 2e0a 2020 2020   procedure..    
+0003f530: 2020 2020 7265 7475 726e 5f74 7970 653a      return_type:
+0003f540: 2041 203a 636c 6173 733a 607e 736e 6f77   A :class:`~snow
+0003f550: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+0003f560: 7970 6573 2e44 6174 6154 7970 6560 2072  ypes.DataType` r
+0003f570: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+0003f580: 7265 7475 726e 2064 6174 610a 2020 2020  return data.    
+0003f590: 2020 2020 2020 2020 7479 7065 206f 6620          type of 
+0003f5a0: 7468 6520 7374 6f72 6564 2070 726f 6365  the stored proce
+0003f5b0: 6475 7265 2e20 4f70 7469 6f6e 616c 2069  dure. Optional i
+0003f5c0: 6620 7479 7065 2068 696e 7473 2061 7265  f type hints are
+0003f5d0: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
+0003f5e0: 2020 2069 6e70 7574 5f74 7970 6573 3a20     input_types: 
+0003f5f0: 4120 6c69 7374 206f 6620 3a63 6c61 7373  A list of :class
+0003f600: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+0003f610: 7770 6172 6b2e 7479 7065 732e 4461 7461  wpark.types.Data
+0003f620: 5479 7065 600a 2020 2020 2020 2020 2020  Type`.          
+0003f630: 2020 7265 7072 6573 656e 7469 6e67 2074    representing t
+0003f640: 6865 2069 6e70 7574 2064 6174 6120 7479  he input data ty
+0003f650: 7065 7320 6f66 2074 6865 2073 746f 7265  pes of the store
+0003f660: 6420 7072 6f63 6564 7572 652e 204f 7074  d procedure. Opt
+0003f670: 696f 6e61 6c20 6966 0a20 2020 2020 2020  ional if.       
+0003f680: 2020 2020 2074 7970 6520 6869 6e74 7320       type hints 
+0003f690: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
+0003f6a0: 2020 2020 2020 6e61 6d65 3a20 4120 7374        name: A st
+0003f6b0: 7269 6e67 206f 7220 6c69 7374 206f 6620  ring or list of 
+0003f6c0: 7374 7269 6e67 7320 7468 6174 2073 7065  strings that spe
+0003f6d0: 6369 6679 2074 6865 206e 616d 6520 6f72  cify the name or
+0003f6e0: 2066 756c 6c79 2d71 7561 6c69 6669 6564   fully-qualified
+0003f6f0: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
+0003f700: 6563 7420 6964 656e 7469 6669 6572 2028  ect identifier (
+0003f710: 6461 7461 6261 7365 206e 616d 652c 2073  database name, s
+0003f720: 6368 656d 6120 6e61 6d65 2c20 616e 6420  chema name, and 
+0003f730: 6675 6e63 7469 6f6e 206e 616d 6529 2066  function name) f
+0003f740: 6f72 0a20 2020 2020 2020 2020 2020 2074  or.            t
+0003f750: 6865 2073 746f 7265 6420 7072 6f63 6564  he stored proced
+0003f760: 7572 6520 696e 2053 6e6f 7766 6c61 6b65  ure in Snowflake
+0003f770: 2c20 7768 6963 6820 616c 6c6f 7773 2079  , which allows y
+0003f780: 6f75 2074 6f20 6361 6c6c 2074 6869 7320  ou to call this 
+0003f790: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+0003f7a0: 2069 6e20 6120 5351 4c0a 2020 2020 2020   in a SQL.      
+0003f7b0: 2020 2020 2020 636f 6d6d 616e 6420 6f72        command or
+0003f7c0: 2076 6961 203a 6675 6e63 3a60 7365 7373   via :func:`sess
+0003f7d0: 696f 6e2e 6361 6c6c 2829 602e 2049 6620  ion.call()`. If 
+0003f7e0: 6974 2069 7320 6e6f 7420 7072 6f76 6964  it is not provid
+0003f7f0: 6564 2c20 6120 6e61 6d65 2077 696c 6c0a  ed, a name will.
+0003f800: 2020 2020 2020 2020 2020 2020 6265 2061              be a
+0003f810: 7574 6f6d 6174 6963 616c 6c79 2067 656e  utomatically gen
+0003f820: 6572 6174 6564 2066 6f72 2074 6865 2073  erated for the s
+0003f830: 746f 7265 6420 7072 6f63 6564 7572 652e  tored procedure.
+0003f840: 2041 206e 616d 6520 6d75 7374 2062 6520   A name must be 
+0003f850: 7370 6563 6966 6965 6420 7768 656e 0a20  specified when. 
+0003f860: 2020 2020 2020 2020 2020 2060 6069 735f             ``is_
+0003f870: 7065 726d 616e 656e 7460 6020 6973 2060  permanent`` is `
+0003f880: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+0003f890: 2069 735f 7065 726d 616e 656e 743a 2057   is_permanent: W
+0003f8a0: 6865 7468 6572 2074 6f20 6372 6561 7465  hether to create
+0003f8b0: 2061 2070 6572 6d61 6e65 6e74 2073 746f   a permanent sto
+0003f8c0: 7265 6420 7072 6f63 6564 7572 652e 2054  red procedure. T
+0003f8d0: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
+0003f8e0: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+0003f8f0: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
+0003f900: 5472 7565 6060 2c20 6120 7661 6c69 6420  True``, a valid 
+0003f910: 6060 7374 6167 655f 6c6f 6361 7469 6f6e  ``stage_location
+0003f920: 6060 206d 7573 7420 6265 2070 726f 7669  `` must be provi
+0003f930: 6465 642e 0a20 2020 2020 2020 2073 7461  ded..        sta
+0003f940: 6765 5f6c 6f63 6174 696f 6e3a 2054 6865  ge_location: The
+0003f950: 2073 7461 6765 206c 6f63 6174 696f 6e20   stage location 
+0003f960: 7768 6572 6520 7468 6520 5079 7468 6f6e  where the Python
+0003f970: 2066 696c 6520 666f 7220 7468 6520 7374   file for the st
+0003f980: 6f72 6564 2070 726f 6365 6475 7265 0a20  ored procedure. 
+0003f990: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
+0003f9a0: 7473 2064 6570 656e 6465 6e63 6965 7320  ts dependencies 
+0003f9b0: 7368 6f75 6c64 2062 6520 7570 6c6f 6164  should be upload
+0003f9c0: 6564 2e20 5468 6520 7374 6167 6520 6c6f  ed. The stage lo
+0003f9d0: 6361 7469 6f6e 206d 7573 7420 6265 2073  cation must be s
+0003f9e0: 7065 6369 6669 6564 0a20 2020 2020 2020  pecified.       
+0003f9f0: 2020 2020 2077 6865 6e20 6060 6973 5f70       when ``is_p
+0003fa00: 6572 6d61 6e65 6e74 6060 2069 7320 6060  ermanent`` is ``
+0003fa10: 5472 7565 6060 2c20 616e 6420 6974 2077  True``, and it w
+0003fa20: 696c 6c20 6265 2069 676e 6f72 6564 2077  ill be ignored w
+0003fa30: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+0003fa40: 6060 6973 5f70 6572 6d61 6e65 6e74 6060  ``is_permanent``
+0003fa50: 2069 7320 6060 4661 6c73 6560 602e 2049   is ``False``. I
+0003fa60: 7420 6361 6e20 6265 2061 6e79 2073 7461  t can be any sta
+0003fa70: 6765 206f 7468 6572 2074 6861 6e20 7465  ge other than te
+0003fa80: 6d70 6f72 6172 790a 2020 2020 2020 2020  mporary.        
+0003fa90: 2020 2020 7374 6167 6573 2061 6e64 2065      stages and e
+0003faa0: 7874 6572 6e61 6c20 7374 6167 6573 2e0a  xternal stages..
+0003fab0: 2020 2020 2020 2020 696d 706f 7274 733a          imports:
+0003fac0: 2041 206c 6973 7420 6f66 2069 6d70 6f72   A list of impor
+0003fad0: 7473 2074 6861 7420 6f6e 6c79 2061 7070  ts that only app
+0003fae0: 6c79 2074 6f20 7468 6973 2073 746f 7265  ly to this store
+0003faf0: 6420 7072 6f63 6564 7572 652e 2059 6f75  d procedure. You
+0003fb00: 2063 616e 2075 7365 2061 2073 7472 696e   can use a strin
+0003fb10: 6720 746f 0a20 2020 2020 2020 2020 2020  g to.           
+0003fb20: 2072 6570 7265 7365 6e74 2061 2066 696c   represent a fil
+0003fb30: 6520 7061 7468 2028 7369 6d69 6c61 7220  e path (similar 
+0003fb40: 746f 2074 6865 2060 6070 6174 6860 6020  to the ``path`` 
+0003fb50: 6172 6775 6d65 6e74 2069 6e0a 2020 2020  argument in.    
+0003fb60: 2020 2020 2020 2020 3a6d 6574 683a 607e          :meth:`~
+0003fb70: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+0003fb80: 726b 2e53 6573 7369 6f6e 2e61 6464 5f69  rk.Session.add_i
+0003fb90: 6d70 6f72 7460 2920 696e 2074 6869 7320  mport`) in this 
+0003fba0: 6c69 7374 2c20 6f72 2061 2074 7570 6c65  list, or a tuple
+0003fbb0: 206f 6620 7477 6f0a 2020 2020 2020 2020   of two.        
+0003fbc0: 2020 2020 7374 7269 6e67 7320 746f 2072      strings to r
+0003fbd0: 6570 7265 7365 6e74 2061 2066 696c 6520  epresent a file 
+0003fbe0: 7061 7468 2061 6e64 2061 6e20 696d 706f  path and an impo
+0003fbf0: 7274 2070 6174 6820 2873 696d 696c 6172  rt path (similar
+0003fc00: 2074 6f20 7468 6520 6060 696d 706f 7274   to the ``import
+0003fc10: 5f70 6174 6860 600a 2020 2020 2020 2020  _path``.        
+0003fc20: 2020 2020 6172 6775 6d65 6e74 2069 6e20      argument in 
+0003fc30: 3a6d 6574 683a 607e 736e 6f77 666c 616b  :meth:`~snowflak
+0003fc40: 652e 736e 6f77 7061 726b 2e53 6573 7369  e.snowpark.Sessi
+0003fc50: 6f6e 2e61 6464 5f69 6d70 6f72 7460 292e  on.add_import`).
+0003fc60: 2054 6865 7365 2073 746f 7265 642d 7072   These stored-pr
+0003fc70: 6f63 2d6c 6576 656c 2069 6d70 6f72 7473  oc-level imports
+0003fc80: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+0003fc90: 6c20 6f76 6572 7269 6465 2074 6865 2073  l override the s
+0003fca0: 6573 7369 6f6e 2d6c 6576 656c 2069 6d70  ession-level imp
+0003fcb0: 6f72 7473 2061 6464 6564 2062 790a 2020  orts added by.  
+0003fcc0: 2020 2020 2020 2020 2020 3a6d 6574 683a            :meth:
+0003fcd0: 607e 736e 6f77 666c 616b 652e 736e 6f77  `~snowflake.snow
+0003fce0: 7061 726b 2e53 6573 7369 6f6e 2e61 6464  park.Session.add
+0003fcf0: 5f69 6d70 6f72 7460 2e0a 2020 2020 2020  _import`..      
+0003fd00: 2020 7061 636b 6167 6573 3a20 4120 6c69    packages: A li
+0003fd10: 7374 206f 6620 7061 636b 6167 6573 2074  st of packages t
+0003fd20: 6861 7420 6f6e 6c79 2061 7070 6c79 2074  hat only apply t
+0003fd30: 6f20 7468 6973 2073 746f 7265 6420 7072  o this stored pr
+0003fd40: 6f63 6564 7572 652e 2054 6865 7365 2073  ocedure. These s
+0003fd50: 746f 7265 642d 7072 6f63 2d6c 6576 656c  tored-proc-level
+0003fd60: 2070 6163 6b61 6765 730a 2020 2020 2020   packages.      
+0003fd70: 2020 2020 2020 7769 6c6c 206f 7665 7272        will overr
+0003fd80: 6964 6520 7468 6520 7365 7373 696f 6e2d  ide the session-
+0003fd90: 6c65 7665 6c20 7061 636b 6167 6573 2061  level packages a
+0003fda0: 6464 6564 2062 790a 2020 2020 2020 2020  dded by.        
+0003fdb0: 2020 2020 3a6d 6574 683a 607e 736e 6f77      :meth:`~snow
+0003fdc0: 666c 616b 652e 736e 6f77 7061 726b 2e53  flake.snowpark.S
+0003fdd0: 6573 7369 6f6e 2e61 6464 5f70 6163 6b61  ession.add_packa
+0003fde0: 6765 7360 2061 6e64 0a20 2020 2020 2020  ges` and.       
+0003fdf0: 2020 2020 203a 6d65 7468 3a60 7e73 6e6f       :meth:`~sno
+0003fe00: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+0003fe10: 5365 7373 696f 6e2e 6164 645f 7265 7175  Session.add_requ
+0003fe20: 6972 656d 656e 7473 602e 0a20 2020 2020  irements`..     
+0003fe30: 2020 2072 6570 6c61 6365 3a20 5768 6574     replace: Whet
+0003fe40: 6865 7220 746f 2072 6570 6c61 6365 2061  her to replace a
+0003fe50: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+0003fe60: 6520 7468 6174 2061 6c72 6561 6479 2077  e that already w
+0003fe70: 6173 2072 6567 6973 7465 7265 642e 2054  as registered. T
+0003fe80: 6865 2064 6566 6175 6c74 2069 7320 6060  he default is ``
+0003fe90: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+0003fea0: 2020 2020 2049 6620 6974 2069 7320 6060       If it is ``
+0003feb0: 4661 6c73 6560 602c 2061 7474 656d 7074  False``, attempt
+0003fec0: 696e 6720 746f 2072 6567 6973 7465 7220  ing to register 
+0003fed0: 6120 7374 6f72 6564 2070 726f 6365 6475  a stored procedu
+0003fee0: 7265 2077 6974 6820 6120 6e61 6d65 2074  re with a name t
+0003fef0: 6861 7420 616c 7265 6164 7920 6578 6973  hat already exis
+0003ff00: 7473 0a20 2020 2020 2020 2020 2020 2072  ts.            r
+0003ff10: 6573 756c 7473 2069 6e20 6120 6060 536e  esults in a ``Sn
+0003ff20: 6f77 7061 726b 5351 4c45 7863 6570 7469  owparkSQLExcepti
+0003ff30: 6f6e 6060 2065 7863 6570 7469 6f6e 2062  on`` exception b
+0003ff40: 6569 6e67 2074 6872 6f77 6e2e 2049 6620  eing thrown. If 
+0003ff50: 6974 2069 7320 6060 5472 7565 6060 2c0a  it is ``True``,.
+0003ff60: 2020 2020 2020 2020 2020 2020 616e 2065              an e
+0003ff70: 7869 7374 696e 6720 7374 6f72 6564 2070  xisting stored p
+0003ff80: 726f 6365 6475 7265 2077 6974 6820 7468  rocedure with th
+0003ff90: 6520 7361 6d65 206e 616d 6520 6973 206f  e same name is o
+0003ffa0: 7665 7277 7269 7474 656e 2e0a 2020 2020  verwritten..    
+0003ffb0: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
+0003ffc0: 733a 2057 6865 7468 6572 2074 6f20 736b  s: Whether to sk
+0003ffd0: 6970 2063 7265 6174 696f 6e20 6f66 2061  ip creation of a
+0003ffe0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+0003fff0: 6520 7468 6520 7361 6d65 2070 726f 6365  e the same proce
+00040000: 6475 7265 2069 7320 616c 7265 6164 7920  dure is already 
+00040010: 7265 6769 7374 6572 6564 2e0a 2020 2020  registered..    
+00040020: 2020 2020 2020 2020 5468 6520 6465 6661          The defa
+00040030: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
+00040040: 2e20 6060 6966 5f6e 6f74 5f65 7869 7374  . ``if_not_exist
+00040050: 7360 6020 616e 6420 6060 7265 706c 6163  s`` and ``replac
+00040060: 6560 6020 6172 6520 6d75 7475 616c 6c79  e`` are mutually
+00040070: 2065 7863 6c75 7369 7665 2061 6e64 2061   exclusive and a
+00040080: 2060 6056 616c 7565 4572 726f 7260 600a   ``ValueError``.
+00040090: 2020 2020 2020 2020 2020 2020 6973 2072              is r
+000400a0: 6169 7365 6420 7768 656e 2062 6f74 6820  aised when both 
+000400b0: 6172 6520 7365 742e 2049 6620 6974 2069  are set. If it i
+000400c0: 7320 6060 5472 7565 6060 2061 6e64 2061  s ``True`` and a
+000400d0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+000400e0: 6520 6973 2061 6c72 6561 6479 2072 6567  e is already reg
+000400f0: 6973 7465 7265 642c 2074 6865 2072 6567  istered, the reg
+00040100: 6973 7472 6174 696f 6e20 6973 2073 6b69  istration is ski
+00040110: 7070 6564 2e0a 2020 2020 2020 2020 7365  pped..        se
+00040120: 7373 696f 6e3a 2055 7365 2074 6869 7320  ssion: Use this 
+00040130: 7365 7373 696f 6e20 746f 2072 6567 6973  session to regis
+00040140: 7465 7220 7468 6520 7374 6f72 6564 2070  ter the stored p
+00040150: 726f 6365 6475 7265 2e20 4966 2069 7427  rocedure. If it'
+00040160: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
+00040170: 2074 6865 2073 6573 7369 6f6e 2074 6861   the session tha
+00040180: 7420 796f 7520 6372 6561 7465 6420 6265  t you created be
+00040190: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
+000401a0: 7320 6675 6e63 7469 6f6e 2077 696c 6c20  s function will 
+000401b0: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
+000401c0: 2020 2020 2059 6f75 206e 6565 6420 746f       You need to
+000401d0: 2073 7065 6369 6679 2074 6869 7320 7061   specify this pa
+000401e0: 7261 6d65 7465 7220 6966 2079 6f75 2068  rameter if you h
+000401f0: 6176 6520 6372 6561 7465 6420 6d75 6c74  ave created mult
+00040200: 6970 6c65 2073 6573 7369 6f6e 7320 6265  iple sessions be
+00040210: 666f 7265 2063 616c 6c69 6e67 2074 6869  fore calling thi
+00040220: 7320 6d65 7468 6f64 2e0a 2020 2020 2020  s method..      
+00040230: 2020 7061 7261 6c6c 656c 3a20 5468 6520    parallel: The 
+00040240: 6e75 6d62 6572 206f 6620 7468 7265 6164  number of thread
+00040250: 7320 746f 2075 7365 2066 6f72 2075 706c  s to use for upl
+00040260: 6f61 6469 6e67 2073 746f 7265 6420 7072  oading stored pr
+00040270: 6f63 6564 7572 6520 6669 6c65 7320 7769  ocedure files wi
+00040280: 7468 2074 6865 0a20 2020 2020 2020 2020  th the.         
+00040290: 2020 2060 5055 5420 3c68 7474 7073 3a2f     `PUT <https:/
+000402a0: 2f64 6f63 732e 736e 6f77 666c 616b 652e  /docs.snowflake.
+000402b0: 636f 6d2f 656e 2f73 716c 2d72 6566 6572  com/en/sql-refer
+000402c0: 656e 6365 2f73 716c 2f70 7574 2e68 746d  ence/sql/put.htm
+000402d0: 6c23 7075 743e 605f 0a20 2020 2020 2020  l#put>`_.       
+000402e0: 2020 2020 2063 6f6d 6d61 6e64 2e20 5468       command. Th
+000402f0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00040300: 6973 2034 2061 6e64 2073 7570 706f 7274  is 4 and support
+00040310: 6564 2076 616c 7565 7320 6172 6520 6672  ed values are fr
+00040320: 6f6d 2031 2074 6f20 3939 2e0a 2020 2020  om 1 to 99..    
+00040330: 2020 2020 2020 2020 496e 6372 6561 7369          Increasi
+00040340: 6e67 2074 6865 206e 756d 6265 7220 6f66  ng the number of
+00040350: 2074 6872 6561 6473 2063 616e 2069 6d70   threads can imp
+00040360: 726f 7665 2070 6572 666f 726d 616e 6365  rove performance
+00040370: 2077 6865 6e20 7570 6c6f 6164 696e 670a   when uploading.
+00040380: 2020 2020 2020 2020 2020 2020 6c61 7267              larg
+00040390: 6520 7374 6f72 6564 2070 726f 6365 6475  e stored procedu
+000403a0: 7265 2066 696c 6573 2e0a 2020 2020 2020  re files..      
+000403b0: 2020 6578 6563 7574 655f 6173 3a20 5768    execute_as: Wh
+000403c0: 6174 2070 6572 6d69 7373 696f 6e73 2073  at permissions s
+000403d0: 686f 756c 6420 7468 6520 7072 6f63 6564  hould the proced
+000403e0: 7572 6520 6861 7665 2077 6869 6c65 2065  ure have while e
+000403f0: 7865 6375 7469 6e67 2e20 5468 6973 0a20  xecuting. This. 
+00040400: 2020 2020 2020 2020 2020 2073 7570 706f             suppo
+00040410: 7274 7320 6361 6c6c 6572 2c20 6f72 206f  rts caller, or o
+00040420: 776e 6572 2066 6f72 206e 6f77 2e20 5365  wner for now. Se
+00040430: 6520 606f 776e 6572 2061 6e64 2063 616c  e `owner and cal
+00040440: 6c65 7220 7269 6768 7473 203c 6874 7470  ler rights <http
+00040450: 733a 2f2f 646f 6373 2e73 6e6f 7766 6c61  s://docs.snowfla
+00040460: 6b65 2e63 6f6d 2f65 6e2f 7371 6c2d 7265  ke.com/en/sql-re
+00040470: 6665 7265 6e63 652f 7374 6f72 6564 2d70  ference/stored-p
+00040480: 726f 6365 6475 7265 732d 7269 6768 7473  rocedures-rights
+00040490: 2e68 746d 6c3e 605f 0a20 2020 2020 2020  .html>`_.       
+000404a0: 2020 2020 2066 6f72 206d 6f72 6520 696e       for more in
+000404b0: 666f 726d 6174 696f 6e2e 0a20 2020 2020  formation..     
+000404c0: 2020 2073 7461 7465 6d65 6e74 5f70 6172     statement_par
+000404d0: 616d 733a 2044 6963 7469 6f6e 6172 7920  ams: Dictionary 
+000404e0: 6f66 2073 7461 7465 6d65 6e74 206c 6576  of statement lev
+000404f0: 656c 2070 6172 616d 6574 6572 7320 746f  el parameters to
+00040500: 2062 6520 7365 7420 7768 696c 6520 6578   be set while ex
+00040510: 6563 7574 696e 6720 7468 6973 2061 6374  ecuting this act
+00040520: 696f 6e2e 0a20 2020 2020 2020 2073 7472  ion..        str
+00040530: 6963 743a 2057 6865 7468 6572 2074 6865  ict: Whether the
+00040540: 2063 7265 6174 6564 2073 746f 7265 6420   created stored 
+00040550: 7072 6f63 6564 7572 6520 6973 2073 7472  procedure is str
+00040560: 6963 742e 2041 2073 7472 6963 7420 7374  ict. A strict st
+00040570: 6f72 6564 2070 726f 6365 6475 7265 2077  ored procedure w
+00040580: 696c 6c20 6e6f 7420 696e 766f 6b65 0a20  ill not invoke. 
+00040590: 2020 2020 2020 2020 2020 2074 6865 2073             the s
+000405a0: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
+000405b0: 6966 2061 6e79 2069 6e70 7574 2069 7320  if any input is 
+000405c0: 6e75 6c6c 2e20 496e 7374 6561 642c 2061  null. Instead, a
+000405d0: 206e 756c 6c20 7661 6c75 6520 7769 6c6c   null value will
+000405e0: 2061 6c77 6179 7320 6265 2072 6574 7572   always be retur
+000405f0: 6e65 642e 204e 6f74 650a 2020 2020 2020  ned. Note.      
+00040600: 2020 2020 2020 7468 6174 2074 6865 2073        that the s
+00040610: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
+00040620: 6d69 6768 7420 7374 696c 6c20 7265 7475  might still retu
+00040630: 726e 206e 756c 6c20 666f 7220 6e6f 6e2d  rn null for non-
+00040640: 6e75 6c6c 2069 6e70 7574 732e 0a20 2020  null inputs..   
+00040650: 2020 2020 2073 6f75 7263 655f 636f 6465       source_code
+00040660: 5f64 6973 706c 6179 3a20 4469 7370 6c61  _display: Displa
+00040670: 7920 7468 6520 736f 7572 6365 2063 6f64  y the source cod
+00040680: 6520 6f66 2074 6865 2073 746f 7265 6420  e of the stored 
+00040690: 7072 6f63 6564 7572 6520 6066 756e 6360  procedure `func`
+000406a0: 2061 7320 636f 6d6d 656e 7473 2069 6e20   as comments in 
+000406b0: 7468 6520 6765 6e65 7261 7465 6420 7363  the generated sc
+000406c0: 7269 7074 2e0a 2020 2020 2020 2020 2020  ript..          
+000406d0: 2020 5468 6520 736f 7572 6365 2063 6f64    The source cod
+000406e0: 6520 6973 2064 796e 616d 6963 616c 6c79  e is dynamically
+000406f0: 2067 656e 6572 6174 6564 2074 6865 7265   generated there
+00040700: 666f 7265 2069 7420 6d61 7920 6e6f 7420  fore it may not 
+00040710: 6265 2069 6465 6e74 6963 616c 2074 6f20  be identical to 
+00040720: 686f 7720 7468 650a 2020 2020 2020 2020  how the.        
+00040730: 2020 2020 6066 756e 6360 2069 7320 6f72      `func` is or
+00040740: 6967 696e 616c 6c79 2064 6566 696e 6564  iginally defined
+00040750: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00040760: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
+00040770: 2020 2020 2020 2049 6620 6974 2069 7320         If it is 
+00040780: 6060 4661 6c73 6560 602c 2073 6f75 7263  ``False``, sourc
+00040790: 6520 636f 6465 2077 696c 6c20 6e6f 7420  e code will not 
+000407a0: 6265 2067 656e 6572 6174 6564 206f 7220  be generated or 
+000407b0: 6469 7370 6c61 7965 642e 0a0a 2020 2020  displayed...    
+000407c0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+000407d0: 2041 2073 746f 7265 6420 7072 6f63 6564   A stored proced
+000407e0: 7572 6520 6675 6e63 7469 6f6e 2074 6861  ure function tha
+000407f0: 7420 6361 6e20 6265 2063 616c 6c65 6420  t can be called 
+00040800: 7769 7468 2070 7974 686f 6e20 7661 6c75  with python valu
+00040810: 652e 0a0a 2020 2020 4e6f 7465 3a0a 2020  e...    Note:.  
+00040820: 2020 2020 2020 312e 2057 6865 6e20 7479        1. When ty
+00040830: 7065 2068 696e 7473 2061 7265 2070 726f  pe hints are pro
+00040840: 7669 6465 6420 616e 6420 6172 6520 636f  vided and are co
+00040850: 6d70 6c65 7465 2066 6f72 2061 2066 756e  mplete for a fun
+00040860: 6374 696f 6e2c 0a20 2020 2020 2020 2060  ction,.        `
+00040870: 6072 6574 7572 6e5f 7479 7065 6060 2061  `return_type`` a
+00040880: 6e64 2060 6069 6e70 7574 5f74 7970 6573  nd ``input_types
+00040890: 6060 2061 7265 206f 7074 696f 6e61 6c20  `` are optional 
+000408a0: 616e 6420 7769 6c6c 2062 6520 6967 6e6f  and will be igno
+000408b0: 7265 642e 0a20 2020 2020 2020 2053 6565  red..        See
+000408c0: 2064 6574 6169 6c73 206f 6620 7375 7070   details of supp
+000408d0: 6f72 7465 6420 6461 7461 2074 7970 6573  orted data types
+000408e0: 2066 6f72 2073 746f 7265 6420 7072 6f63   for stored proc
+000408f0: 6564 7572 6520 696e 0a20 2020 2020 2020  edure in.       
+00040900: 203a 636c 6173 733a 607e 736e 6f77 666c   :class:`~snowfl
+00040910: 616b 652e 736e 6f77 7061 726b 2e73 746f  ake.snowpark.sto
+00040920: 7265 645f 7072 6f63 6564 7572 652e 5374  red_procedure.St
+00040930: 6f72 6564 5072 6f63 6564 7572 6552 6567  oredProcedureReg
+00040940: 6973 7472 6174 696f 6e60 2e0a 0a20 2020  istration`...   
+00040950: 2020 2020 2020 2020 202d 2059 6f75 2063           - You c
+00040960: 616e 2075 7365 203a 6174 7472 3a60 7e73  an use :attr:`~s
+00040970: 6e6f 7766 6c61 6b65 2e73 6e6f 7770 6172  nowflake.snowpar
+00040980: 6b2e 7479 7065 732e 5661 7269 616e 7460  k.types.Variant`
+00040990: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+000409a0: 2020 616e 6e6f 7461 7465 2061 2076 6172    annotate a var
+000409b0: 6961 6e74 2c20 616e 6420 7573 6520 3a61  iant, and use :a
+000409c0: 7474 723a 607e 736e 6f77 666c 616b 652e  ttr:`~snowflake.
+000409d0: 736e 6f77 7061 726b 2e74 7970 6573 2e47  snowpark.types.G
+000409e0: 656f 6772 6170 6879 600a 2020 2020 2020  eography`.      
+000409f0: 2020 2020 2020 2020 746f 2061 6e6e 6f74          to annot
+00040a00: 6174 6520 6120 6765 6f67 7261 7068 7920  ate a geography 
+00040a10: 7768 656e 2064 6566 696e 696e 6720 6120  when defining a 
+00040a20: 7374 6f72 6564 2070 726f 6365 6475 7265  stored procedure
+00040a30: 2e0a 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00040a40: 203a 636c 6173 733a 6074 7970 696e 672e   :class:`typing.
+00040a50: 556e 696f 6e60 2069 7320 6e6f 7420 6120  Union` is not a 
+00040a60: 7661 6c69 6420 7479 7065 2061 6e6e 6f74  valid type annot
+00040a70: 6174 696f 6e20 666f 7220 7374 6f72 6564  ation for stored
+00040a80: 2070 726f 6365 6475 7265 732c 0a20 2020   procedures,.   
+00040a90: 2020 2020 2020 2020 2020 2062 7574 203a             but :
+00040aa0: 636c 6173 733a 6074 7970 696e 672e 4f70  class:`typing.Op
+00040ab0: 7469 6f6e 616c 6020 6361 6e20 6265 2075  tional` can be u
+00040ac0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00040ad0: 7468 6520 6f70 7469 6f6e 616c 2074 7970  the optional typ
+00040ae0: 652e 0a0a 2020 2020 2020 2020 322e 2041  e...        2. A
+00040af0: 2074 656d 706f 7261 7279 2073 746f 7265   temporary store
+00040b00: 6420 7072 6f63 6564 7572 6520 2877 6865  d procedure (whe
+00040b10: 6e20 6060 6973 5f70 6572 6d61 6e65 6e74  n ``is_permanent
+00040b20: 6060 2069 7320 6060 4661 6c73 6560 6029  `` is ``False``)
+00040b30: 2069 7320 7363 6f70 6564 2074 6f20 7468   is scoped to th
+00040b40: 6973 2060 6073 6573 7369 6f6e 6060 0a20  is ``session``. 
+00040b50: 2020 2020 2020 2061 6e64 2061 6c6c 2073         and all s
+00040b60: 746f 7265 6420 7072 6f63 6564 7572 6520  tored procedure 
+00040b70: 7265 6c61 7465 6420 6669 6c65 7320 7769  related files wi
+00040b80: 6c6c 2062 6520 7570 6c6f 6164 6564 2074  ll be uploaded t
+00040b90: 6f20 6120 7465 6d70 6f72 6172 7920 7365  o a temporary se
+00040ba0: 7373 696f 6e20 7374 6167 650a 2020 2020  ssion stage.    
+00040bb0: 2020 2020 283a 6675 6e63 3a60 7365 7373      (:func:`sess
+00040bc0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
+00040bd0: 7374 6167 6528 2920 3c73 6e6f 7766 6c61  stage() <snowfla
+00040be0: 6b65 2e73 6e6f 7770 6172 6b2e 5365 7373  ke.snowpark.Sess
+00040bf0: 696f 6e2e 6765 745f 7365 7373 696f 6e5f  ion.get_session_
+00040c00: 7374 6167 653e 6029 2e0a 2020 2020 2020  stage>`)..      
+00040c10: 2020 466f 7220 6120 7065 726d 616e 656e    For a permanen
+00040c20: 7420 7374 6f72 6564 2070 726f 6365 6475  t stored procedu
+00040c30: 7265 2c20 7468 6573 6520 6669 6c65 7320  re, these files 
+00040c40: 7769 6c6c 2062 6520 7570 6c6f 6164 6564  will be uploaded
+00040c50: 2074 6f20 7468 6520 7374 6167 6520 7468   to the stage th
+00040c60: 6174 2079 6f75 2070 726f 7669 6465 2e0a  at you provide..
+00040c70: 0a20 2020 2020 2020 2033 2e20 4279 2064  .        3. By d
+00040c80: 6566 6175 6c74 2c20 7374 6f72 6564 2070  efault, stored p
+00040c90: 726f 6365 6475 7265 2072 6567 6973 7472  rocedure registr
+00040ca0: 6174 696f 6e20 6661 696c 7320 6966 2061  ation fails if a
+00040cb0: 2066 756e 6374 696f 6e20 7769 7468 2074   function with t
+00040cc0: 6865 2073 616d 6520 6e61 6d65 2069 7320  he same name is 
+00040cd0: 616c 7265 6164 790a 2020 2020 2020 2020  already.        
+00040ce0: 7265 6769 7374 6572 6564 2e20 496e 766f  registered. Invo
+00040cf0: 6b69 6e67 203a 6675 6e63 3a60 7370 726f  king :func:`spro
+00040d00: 6360 2077 6974 6820 6060 7265 706c 6163  c` with ``replac
+00040d10: 6560 6020 7365 7420 746f 2060 6054 7275  e`` set to ``Tru
+00040d20: 6560 6020 7769 6c6c 206f 7665 7277 7269  e`` will overwri
+00040d30: 7465 2074 6865 0a20 2020 2020 2020 2070  te the.        p
+00040d40: 7265 7669 6f75 736c 7920 7265 6769 7374  reviously regist
+00040d50: 6572 6564 2066 756e 6374 696f 6e2e 0a0a  ered function...
+00040d60: 2020 2020 2020 2020 342e 2054 6f20 6465          4. To de
+00040d70: 7363 7269 6265 2074 6865 2072 6574 7572  scribe the retur
+00040d80: 6e20 7479 7065 2066 6f72 2061 2073 746f  n type for a sto
+00040d90: 7265 6420 7072 6f63 6564 7572 6520 7468  red procedure th
+00040da0: 6174 2060 7265 7475 726e 7320 7461 6275  at `returns tabu
+00040db0: 6c61 7220 6461 7461 0a20 2020 2020 2020  lar data.       
+00040dc0: 203c 6874 7470 733a 2f2f 646f 6373 2e73   <https://docs.s
+00040dd0: 6e6f 7766 6c61 6b65 2e63 6f6d 2f65 6e2f  nowflake.com/en/
+00040de0: 7371 6c2d 7265 6665 7265 6e63 652f 7374  sql-reference/st
+00040df0: 6f72 6564 2d70 726f 6365 6475 7265 732d  ored-procedures-
+00040e00: 7079 7468 6f6e 2372 6574 7572 6e69 6e67  python#returning
+00040e10: 2d74 6162 756c 6172 2d64 6174 613e 605f  -tabular-data>`_
+00040e20: 2c0a 2020 2020 2020 2020 7573 6520 6f6e  ,.        use on
+00040e30: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
+00040e40: 6e67 2077 6179 733a 0a0a 2020 2020 2020  ng ways:..      
+00040e50: 2020 2020 2020 2d20 2852 6563 6f6d 6d65        - (Recomme
+00040e60: 6e64 6564 2920 4465 7363 7269 6265 2074  nded) Describe t
+00040e70: 6865 2072 6574 7572 6e20 7479 7065 2075  he return type u
+00040e80: 7369 6e67 203a 6174 7472 3a60 7e73 6e6f  sing :attr:`~sno
+00040e90: 7766 6c61 6b65 2e73 6e6f 7770 6172 6b2e  wflake.snowpark.
+00040ea0: 7479 7065 732e 5374 7275 6374 5479 7065  types.StructType
+00040eb0: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
+00040ec0: 616e 6420 3a61 7474 723a 607e 736e 6f77  and :attr:`~snow
+00040ed0: 666c 616b 652e 736e 6f77 7061 726b 2e74  flake.snowpark.t
+00040ee0: 7970 6573 2e53 7472 7563 7446 6965 6c64  ypes.StructField
+00040ef0: 602e 2053 6574 2060 6072 6574 7572 6e5f  `. Set ``return_
+00040f00: 7479 7065 203d 0a20 2020 2020 2020 2020  type =.         
+00040f10: 2020 2020 2053 7472 7563 7454 7970 6528       StructType(
+00040f20: 5b53 7472 7563 7446 6965 6c64 2822 6122  [StructField("a"
+00040f30: 2c20 4461 7461 5479 7065 4128 2929 2c20  , DataTypeA()), 
+00040f40: 2e2e 2e5d 2960 6020 746f 2064 6573 6372  ...])`` to descr
+00040f50: 6962 6520 7468 6520 6361 7365 0a20 2020  ibe the case.   
+00040f60: 2020 2020 2020 2020 2020 2060 6052 4554             ``RET
+00040f70: 5552 4e53 2054 4142 4c45 2841 2044 6174  URNS TABLE(A Dat
+00040f80: 6154 7970 6541 2c20 2e2e 2e29 6060 2e0a  aTypeA, ...)``..
+00040f90: 0a20 2020 2020 2020 2020 2020 202d 2053  .            - S
+00040fa0: 6574 2060 6072 6574 7572 6e5f 7479 7065  et ``return_type
+00040fb0: 203d 2053 7472 7563 7454 7970 6528 2960   = StructType()`
+00040fc0: 6020 746f 2064 6573 6372 6962 6520 7468  ` to describe th
+00040fd0: 6520 6361 7365 2060 6052 4554 5552 4e53  e case ``RETURNS
+00040fe0: 2054 4142 4c45 2829 6060 2e0a 0a20 2020   TABLE()``...   
+00040ff0: 2020 2020 2020 2020 202d 2057 6865 6e20           - When 
+00041000: 7573 696e 6720 7479 7065 2068 696e 7473  using type hints
+00041010: 2c20 7468 6520 7265 7475 726e 2074 7970  , the return typ
+00041020: 6520 6f66 2066 756e 6374 696f 6e20 6361  e of function ca
+00041030: 6e20 6265 2073 6574 2061 730a 2020 2020  n be set as.    
+00041040: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
+00041050: 3a60 7e73 6e6f 7766 6c61 6b65 2e73 6e6f  :`~snowflake.sno
+00041060: 7770 6172 6b2e 6461 7461 6672 616d 652e  wpark.dataframe.
+00041070: 4461 7461 4672 616d 6560 2e20 5468 6973  DataFrame`. This
+00041080: 2072 6567 6973 7465 7273 2061 0a20 2020   registers a.   
+00041090: 2020 2020 2020 2020 2020 2074 6162 6c65             table
+000410a0: 2073 746f 7265 6420 7072 6f63 6564 7572   stored procedur
+000410b0: 6520 7769 7468 2072 6574 7572 6e20 7479  e with return ty
+000410c0: 7065 2064 6566 696e 6564 2075 7369 6e67  pe defined using
+000410d0: 2060 6052 4554 5552 4e53 2054 4142 4c45   ``RETURNS TABLE
+000410e0: 2829 6060 2e0a 2020 2020 2020 2020 2020  ()``..          
+000410f0: 2020 2020 4368 6563 6b20 2a2a 5365 6520      Check **See 
+00041100: 616c 736f 2a2a 2062 656c 6f77 2066 6f72  also** below for
+00041110: 206d 6f72 6520 6578 616d 706c 6573 2e0a   more examples..
+00041120: 0a20 2020 2053 6565 2041 6c73 6f3a 0a20  .    See Also:. 
+00041130: 2020 2020 2020 203a 636c 6173 733a 607e         :class:`~
+00041140: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00041150: 726b 2e73 746f 7265 645f 7072 6f63 6564  rk.stored_proced
+00041160: 7572 652e 5374 6f72 6564 5072 6f63 6564  ure.StoredProced
+00041170: 7572 6552 6567 6973 7472 6174 696f 6e60  ureRegistration`
+00041180: 0a0a 2020 2020 4578 616d 706c 653a 3a0a  ..    Example::.
+00041190: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+000411a0: 2073 6e6f 7766 6c61 6b65 2e73 6e6f 7770   snowflake.snowp
+000411b0: 6172 6b2e 7479 7065 7320 696d 706f 7274  ark.types import
+000411c0: 2049 6e74 6567 6572 5479 7065 0a20 2020   IntegerType.   
+000411d0: 2020 2020 203e 3e3e 2040 7370 726f 6328       >>> @sproc(
+000411e0: 7265 7475 726e 5f74 7970 653d 496e 7465  return_type=Inte
+000411f0: 6765 7254 7970 6528 292c 2069 6e70 7574  gerType(), input
+00041200: 5f74 7970 6573 3d5b 496e 7465 6765 7254  _types=[IntegerT
+00041210: 7970 6528 292c 2049 6e74 6567 6572 5479  ype(), IntegerTy
+00041220: 7065 2829 5d2c 2070 6163 6b61 6765 733d  pe()], packages=
+00041230: 5b22 736e 6f77 666c 616b 652d 736e 6f77  ["snowflake-snow
+00041240: 7061 726b 2d70 7974 686f 6e22 5d29 0a20  park-python"]). 
+00041250: 2020 2020 2020 202e 2e2e 2064 6566 2061         ... def a
+00041260: 6464 5f73 7028 7365 7373 696f 6e5f 2c20  dd_sp(session_, 
+00041270: 782c 2079 293a 0a20 2020 2020 2020 202e  x, y):.        .
+00041280: 2e2e 2020 2020 2072 6574 7572 6e20 7365  ..     return se
+00041290: 7373 696f 6e5f 2e73 716c 2866 2253 454c  ssion_.sql(f"SEL
+000412a0: 4543 5420 7b78 7d20 2b20 7b79 7d22 292e  ECT {x} + {y}").
+000412b0: 636f 6c6c 6563 7428 295b 305d 5b30 5d0a  collect()[0][0].
+000412c0: 2020 2020 2020 2020 2e2e 2e0a 2020 2020          ....    
+000412d0: 2020 2020 3e3e 3e20 6164 645f 7370 2831      >>> add_sp(1
+000412e0: 2c20 3129 0a20 2020 2020 2020 2032 0a20  , 1).        2. 
+000412f0: 2020 2022 2222 0a20 2020 2073 6573 7369     """.    sessi
+00041300: 6f6e 203d 2073 6573 7369 6f6e 206f 7220  on = session or 
+00041310: 736e 6f77 666c 616b 652e 736e 6f77 7061  snowflake.snowpa
+00041320: 726b 2e73 6573 7369 6f6e 2e5f 6765 745f  rk.session._get_
+00041330: 6163 7469 7665 5f73 6573 7369 6f6e 2829  active_session()
+00041340: 0a20 2020 2069 6620 6675 6e63 2069 7320  .    if func is 
+00041350: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+00041360: 7475 726e 2066 756e 6374 6f6f 6c73 2e70  turn functools.p
+00041370: 6172 7469 616c 280a 2020 2020 2020 2020  artial(.        
+00041380: 2020 2020 7365 7373 696f 6e2e 7370 726f      session.spro
+00041390: 632e 7265 6769 7374 6572 2c0a 2020 2020  c.register,.    
+000413a0: 2020 2020 2020 2020 7265 7475 726e 5f74          return_t
+000413b0: 7970 653d 7265 7475 726e 5f74 7970 652c  ype=return_type,
+000413c0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+000413d0: 7574 5f74 7970 6573 3d69 6e70 7574 5f74  ut_types=input_t
+000413e0: 7970 6573 2c0a 2020 2020 2020 2020 2020  ypes,.          
+000413f0: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
+00041400: 2020 2020 2020 2020 2069 735f 7065 726d           is_perm
+00041410: 616e 656e 743d 6973 5f70 6572 6d61 6e65  anent=is_permane
+00041420: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+00041430: 7374 6167 655f 6c6f 6361 7469 6f6e 3d73  stage_location=s
+00041440: 7461 6765 5f6c 6f63 6174 696f 6e2c 0a20  tage_location,. 
+00041450: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00041460: 7473 3d69 6d70 6f72 7473 2c0a 2020 2020  ts=imports,.    
+00041470: 2020 2020 2020 2020 7061 636b 6167 6573          packages
+00041480: 3d70 6163 6b61 6765 732c 0a20 2020 2020  =packages,.     
+00041490: 2020 2020 2020 2072 6570 6c61 6365 3d72         replace=r
+000414a0: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
+000414b0: 2020 2020 6966 5f6e 6f74 5f65 7869 7374      if_not_exist
+000414c0: 733d 6966 5f6e 6f74 5f65 7869 7374 732c  s=if_not_exists,
+000414d0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+000414e0: 616c 6c65 6c3d 7061 7261 6c6c 656c 2c0a  allel=parallel,.
+000414f0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+00041500: 656d 656e 745f 7061 7261 6d73 3d73 7461  ement_params=sta
+00041510: 7465 6d65 6e74 5f70 6172 616d 732c 0a20  tement_params,. 
+00041520: 2020 2020 2020 2020 2020 2065 7865 6375             execu
+00041530: 7465 5f61 733d 6578 6563 7574 655f 6173  te_as=execute_as
+00041540: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00041550: 7269 6374 3d73 7472 6963 742c 0a20 2020  rict=strict,.   
+00041560: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
+00041570: 636f 6465 5f64 6973 706c 6179 3d73 6f75  code_display=sou
+00041580: 7263 655f 636f 6465 5f64 6973 706c 6179  rce_code_display
+00041590: 2c0a 2020 2020 2020 2020 2020 2020 2a2a  ,.            **
+000415a0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+000415b0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+000415c0: 2020 2020 7265 7475 726e 2073 6573 7369      return sessi
+000415d0: 6f6e 2e73 7072 6f63 2e72 6567 6973 7465  on.sproc.registe
+000415e0: 7228 0a20 2020 2020 2020 2020 2020 2066  r(.            f
+000415f0: 756e 632c 0a20 2020 2020 2020 2020 2020  unc,.           
+00041600: 2072 6574 7572 6e5f 7479 7065 3d72 6574   return_type=ret
+00041610: 7572 6e5f 7479 7065 2c0a 2020 2020 2020  urn_type,.      
+00041620: 2020 2020 2020 696e 7075 745f 7479 7065        input_type
+00041630: 733d 696e 7075 745f 7479 7065 732c 0a20  s=input_types,. 
+00041640: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00041650: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00041660: 2020 6973 5f70 6572 6d61 6e65 6e74 3d69    is_permanent=i
+00041670: 735f 7065 726d 616e 656e 742c 0a20 2020  s_permanent,.   
+00041680: 2020 2020 2020 2020 2073 7461 6765 5f6c           stage_l
+00041690: 6f63 6174 696f 6e3d 7374 6167 655f 6c6f  ocation=stage_lo
+000416a0: 6361 7469 6f6e 2c0a 2020 2020 2020 2020  cation,.        
+000416b0: 2020 2020 696d 706f 7274 733d 696d 706f      imports=impo
+000416c0: 7274 732c 0a20 2020 2020 2020 2020 2020  rts,.           
+000416d0: 2070 6163 6b61 6765 733d 7061 636b 6167   packages=packag
+000416e0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+000416f0: 7265 706c 6163 653d 7265 706c 6163 652c  replace=replace,
+00041700: 0a20 2020 2020 2020 2020 2020 2069 665f  .            if_
+00041710: 6e6f 745f 6578 6973 7473 3d69 665f 6e6f  not_exists=if_no
+00041720: 745f 6578 6973 7473 2c0a 2020 2020 2020  t_exists,.      
+00041730: 2020 2020 2020 7061 7261 6c6c 656c 3d70        parallel=p
+00041740: 6172 616c 6c65 6c2c 0a20 2020 2020 2020  arallel,.       
+00041750: 2020 2020 2073 7461 7465 6d65 6e74 5f70       statement_p
+00041760: 6172 616d 733d 7374 6174 656d 656e 745f  arams=statement_
+00041770: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+00041780: 2020 2020 6578 6563 7574 655f 6173 3d65      execute_as=e
+00041790: 7865 6375 7465 5f61 732c 0a20 2020 2020  xecute_as,.     
+000417a0: 2020 2020 2020 2073 7472 6963 743d 7374         strict=st
+000417b0: 7269 6374 2c0a 2020 2020 2020 2020 2020  rict,.          
+000417c0: 2020 736f 7572 6365 5f63 6f64 655f 6469    source_code_di
+000417d0: 7370 6c61 793d 736f 7572 6365 5f63 6f64  splay=source_cod
+000417e0: 655f 6469 7370 6c61 792c 0a20 2020 2020  e_display,.     
+000417f0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00041800: 0a20 2020 2020 2020 2029 0a0a 0a23 2041  .        )...# A
+00041810: 6464 2074 6865 7365 2061 6c69 6173 2066  dd these alias f
+00041820: 6f72 2075 7365 7220 636f 6465 206d 6967  or user code mig
+00041830: 7261 7469 6f6e 0a63 616c 6c5f 6275 696c  ration.call_buil
+00041840: 7469 6e20 3d20 6361 6c6c 5f66 756e 6374  tin = call_funct
+00041850: 696f 6e0a 636f 6c6c 6563 745f 7365 7420  ion.collect_set 
+00041860: 3d20 6172 7261 795f 756e 6971 7565 5f61  = array_unique_a
+00041870: 6767 0a62 7569 6c74 696e 203d 2066 756e  gg.builtin = fun
+00041880: 6374 696f 6e0a 636f 756e 7444 6973 7469  ction.countDisti
+00041890: 6e63 7420 3d20 636f 756e 745f 6469 7374  nct = count_dist
+000418a0: 696e 6374 0a73 7562 7374 7220 3d20 7375  inct.substr = su
+000418b0: 6273 7472 696e 670a 746f 5f76 6172 6368  bstring.to_varch
+000418c0: 6172 203d 2074 6f5f 6368 6172 0a65 7870  ar = to_char.exp
+000418d0: 7220 3d20 7371 6c5f 6578 7072 0a64 6174  r = sql_expr.dat
+000418e0: 655f 666f 726d 6174 203d 2074 6f5f 6461  e_format = to_da
+000418f0: 7465 0a6d 6f6e 6f74 6f6e 6963 616c 6c79  te.monotonically
+00041900: 5f69 6e63 7265 6173 696e 675f 6964 203d  _increasing_id =
+00041910: 2073 6571 380a 6672 6f6d 5f75 6e69 7874   seq8.from_unixt
+00041920: 696d 6520 3d20 746f 5f74 696d 6573 7461  ime = to_timesta
+00041930: 6d70 0a0a 0a64 6566 2075 6e69 785f 7469  mp...def unix_ti
+00041940: 6d65 7374 616d 7028 653a 2043 6f6c 756d  mestamp(e: Colum
+00041950: 6e4f 724e 616d 652c 2066 6d74 3a20 4f70  nOrName, fmt: Op
+00041960: 7469 6f6e 616c 5b22 436f 6c75 6d6e 225d  tional["Column"]
+00041970: 203d 204e 6f6e 6529 202d 3e20 436f 6c75   = None) -> Colu
+00041980: 6d6e 3a0a 2020 2020 2222 220a 2020 2020  mn:.    """.    
+00041990: 436f 6e76 6572 7473 2061 2074 696d 6573  Converts a times
+000419a0: 7461 6d70 206f 7220 6120 7469 6d65 7374  tamp or a timest
+000419b0: 616d 7020 7374 7269 6e67 2074 6f20 556e  amp string to Un
+000419c0: 6978 2074 696d 6520 7374 616d 7020 2869  ix time stamp (i
+000419d0: 6e20 7365 636f 6e64 7329 2e0a 0a20 2020  n seconds)...   
+000419e0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+000419f0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+00041a00: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+00041a10: 3e3e 3e20 6466 203d 2073 6573 7369 6f6e  >>> df = session
+00041a20: 2e63 7265 6174 655f 6461 7461 6672 616d  .create_datafram
+00041a30: 6528 5b5b 2232 3031 332d 3035 2d30 3854  e([["2013-05-08T
+00041a40: 3233 3a33 393a 3230 2e31 3233 2d30 373a  23:39:20.123-07:
+00041a50: 3030 225d 5d2c 2073 6368 656d 613d 5b22  00"]], schema=["
+00041a60: 7473 5f63 6f6c 225d 290a 2020 2020 2020  ts_col"]).      
+00041a70: 2020 3e3e 3e20 6466 2e73 656c 6563 7428    >>> df.select(
+00041a80: 756e 6978 5f74 696d 6573 7461 6d70 2863  unix_timestamp(c
+00041a90: 6f6c 2822 7473 5f63 6f6c 2229 292e 616c  ol("ts_col")).al
+00041aa0: 6961 7328 2275 6e69 785f 7469 6d65 2229  ias("unix_time")
+00041ab0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00041ac0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00041ad0: 0a20 2020 2020 2020 207c 2255 4e49 585f  .        |"UNIX_
+00041ae0: 5449 4d45 2220 207c 0a20 2020 2020 2020  TIME"  |.       
+00041af0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00041b00: 0a20 2020 2020 2020 207c 3133 3638 3035  .        |136805
+00041b10: 3633 3630 2020 207c 0a20 2020 2020 2020  6360   |.       
+00041b20: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00041b30: 0a20 2020 2020 2020 203c 424c 414e 4b4c  .        <BLANKL
+00041b40: 494e 453e 0a20 2020 2022 2222 0a20 2020  INE>.    """.   
+00041b50: 2072 6574 7572 6e20 6461 7465 5f70 6172   return date_par
+00041b60: 7428 2265 706f 6368 5f73 6563 6f6e 6422  t("epoch_second"
+00041b70: 2c20 746f 5f74 696d 6573 7461 6d70 2865  , to_timestamp(e
+00041b80: 2c20 666d 7429 290a                      , fmt)).
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/query_history.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/query_history.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/relational_grouped_dataframe.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/relational_grouped_dataframe.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,13 +1,11 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
-
-import re
 from typing import Callable, Dict, List, Tuple, Union
 
 from snowflake.snowpark import functions
 from snowflake.snowpark._internal.analyzer.expression import (
     Expression,
     Literal,
     NamedExpression,
@@ -30,31 +28,22 @@
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import relational_group_df_api_usage
 from snowflake.snowpark._internal.type_utils import ColumnOrName
 from snowflake.snowpark._internal.utils import parse_positional_args_to_list
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.dataframe import DataFrame
 
-INVALID_SF_IDENTIFIER_CHARS = re.compile("[^\\x20-\\x7E]")
-
-
-def _strip_invalid_sf_identifier_chars(identifier: str) -> str:
-    return INVALID_SF_IDENTIFIER_CHARS.sub("", identifier.replace('"', ""))
-
 
 def _alias(expr: Expression) -> NamedExpression:
     if isinstance(expr, UnresolvedAttribute):
         return UnresolvedAlias(expr)
     elif isinstance(expr, NamedExpression):
         return expr
     else:
-        return Alias(
-            expr,
-            _strip_invalid_sf_identifier_chars(expr.sql.upper()),
-        )
+        return Alias(expr, expr.sql.upper().replace('"', ""))
 
 
 def _expr_to_func(expr: str, input_expr: Expression) -> Expression:
     lowered = expr.lower()
     if lowered in ["avg", "average", "mean"]:
         return functions.avg(Column(input_expr))._expression
     elif lowered in ["stddev", "std"]:
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/row.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/row.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,20 +1,21 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Any, Dict, Union
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 def _restore_row_from_pickle(values, named_values, fields):
     if named_values:
         row = Row(**named_values)
     else:
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/session.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/session.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,25 +4,27 @@
 #
 
 import datetime
 import decimal
 import json
 import logging
 import os
+import sys
 from array import array
 from functools import reduce
 from logging import getLogger
 from threading import RLock
 from types import ModuleType
 from typing import Any, Dict, List, Literal, Optional, Sequence, Set, Tuple, Union
 
 import cloudpickle
 import pkg_resources
 
 from snowflake.connector import ProgrammingError, SnowflakeConnection
+from snowflake.connector.errors import MissingDependencyError
 from snowflake.connector.options import installed_pandas, pandas
 from snowflake.connector.pandas_tools import write_pandas
 from snowflake.snowpark._internal.analyzer.analyzer import Analyzer
 from snowflake.snowpark._internal.analyzer.analyzer_utils import (
     escape_quotes,
     quote_name,
 )
@@ -45,15 +47,17 @@
     TableFunctionRelation,
 )
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.server_connection import ServerConnection
 from snowflake.snowpark._internal.telemetry import set_api_call_source
 from snowflake.snowpark._internal.type_utils import (
     ColumnOrName,
+    convert_sp_to_sf_type,
     infer_schema,
+    infer_type,
     merge_type,
 )
 from snowflake.snowpark._internal.udf_utils import generate_call_python_sp_sql
 from snowflake.snowpark._internal.utils import (
     MODULE_NAME_TO_PACKAGE_NAME_MAP,
     STAGE_PREFIX,
     SUPPORTED_TABLE_TYPES,
@@ -123,17 +127,17 @@
 )
 from snowflake.snowpark.udf import UDFRegistration
 from snowflake.snowpark.udtf import UDTFRegistration
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 _logger = getLogger(__name__)
 
 _session_management_lock = RLock()
 _active_sessions: Set["Session"] = set()
 _PYTHON_SNOWPARK_USE_SCOPED_TEMP_OBJECTS_STRING = (
@@ -718,15 +722,15 @@
             >>> from snowflake.snowpark.functions import udf
             >>> import numpy
             >>> import pandas
             >>> import dateutil
             >>> # add numpy with the latest version on Snowflake Anaconda
             >>> # and pandas with the version "1.3.*"
             >>> # and dateutil with the local version in your environment
-            >>> session.add_packages("numpy", "pandas==1.3.*", dateutil)
+            >>> session.add_packages("numpy", "pandas==1.4.*", dateutil)
             >>> @udf
             ... def get_package_name_udf() -> list:
             ...     return [numpy.__name__, pandas.__name__, dateutil.__name__]
             >>> session.sql(f"select {get_package_name_udf.name}()").to_df("col1").show()
             ----------------
             |"COL1"        |
             ----------------
@@ -856,18 +860,23 @@
             # underscores are discouraged in package names, but are still used in Anaconda channel
             # pkg_resources.Requirement.parse will convert all underscores to dashes
             package_name = (
                 package if not use_local_version and "_" in package else package_req.key
             )
             package_dict[package] = (package_name, use_local_version, package_req)
 
+        package_table = "information_schema.packages"
+        # TODO: Use the database from fully qualified UDF name
+        if not self.get_current_database():
+            package_table = f"snowflake.{package_table}"
+
         valid_packages = (
             {
                 p[0]: json.loads(p[1])
-                for p in self.table("information_schema.packages")
+                for p in self.table(package_table)
                 .filter(
                     (col("language") == "python")
                     & (col("package_name").in_([v[0] for v in package_dict.values()]))
                 )
                 .group_by("package_name")
                 .agg(array_agg("version"))
                 ._internal_collect_with_tag()
@@ -1151,15 +1160,15 @@
             raise ValueError("Columns cannot be empty for generator table function")
         named_args = {}
         if rowcount != 0:
             named_args["rowcount"] = lit(rowcount)._expression
         if timelimit != 0:
             named_args["timelimit"] = lit(timelimit)._expression
 
-        operators = [self._analyzer.analyze(col._expression) for col in columns]
+        operators = [self._analyzer.analyze(col._expression, {}) for col in columns]
         func_expr = GeneratorTableFunction(args=named_args, operators=operators)
 
         if self.sql_simplifier_enabled:
             d = DataFrame(
                 self,
                 SelectStatement(
                     from_=SelectTableFunction(
@@ -1457,22 +1466,26 @@
         if data is None:
             raise ValueError("data cannot be None.")
 
         # check the type of data
         if isinstance(data, Row):
             raise TypeError("create_dataframe() function does not accept a Row object.")
 
-        if not isinstance(data, (list, tuple)) and (
-            not installed_pandas
-            or (installed_pandas and not isinstance(data, pandas.DataFrame))
-        ):
+        if not isinstance(data, (list, tuple, pandas.DataFrame)):
             raise TypeError(
                 "create_dataframe() function only accepts data as a list, tuple or a pandas DataFrame."
             )
 
+        if not installed_pandas and isinstance(data, pandas.DataFrame):
+            raise MissingDependencyError(
+                "snowflake-connector-python[pandas]. create_dataframe() function only accepts data as a pandas "
+                "DataFrame when the Snowflake Connector for Python is the Pandas-compatible version. Please install "
+                'it as follow: `pip install "snowflake-connector-python[pandas]"`'
+            )
+
         # check to see if it is a Pandas DataFrame and if so, write that to a temp
         # table and return as a DataFrame
         if installed_pandas and isinstance(data, pandas.DataFrame):
             table_name = escape_quotes(
                 random_name_for_temp_object(TempObjectType.TABLE)
             )
             sf_database = self._conn._get_current_parameter("database", quoted=False)
@@ -1798,17 +1811,19 @@
             validate_object_name(object_name)
             self._run_query(f"use {object_type} {object_name}")
         else:
             raise ValueError(f"'{object_type}' must not be empty or None.")
 
     @property
     def telemetry_enabled(self) -> bool:
-        """
-        Returns whether telemetry is enabled. The default value is ``True`` and can
-        be set to ``False`` to disable telemetry.
+        """Controls whether or not the Snowpark client sends usage telemetry to Snowflake.
+        This typically includes information like the API calls invoked, libraries used in conjunction with Snowpark,
+        and information that will let us better diagnose and fix client side errors.
+
+        The default value is ``True``.
 
         Example::
 
             >>> session.telemetry_enabled
             True
             >>> session.telemetry_enabled = False
             >>> session.telemetry_enabled
@@ -1857,14 +1872,31 @@
     def sproc(self) -> StoredProcedureRegistration:
         """
         Returns a :class:`stored_procedure.StoredProcedureRegistration` object that you can use to register stored procedures.
         See details of how to use this object in :class:`stored_procedure.StoredProcedureRegistration`.
         """
         return self._sp_registration
 
+    def _infer_is_return_table(self, sproc_name: str, *args: Any) -> bool:
+        try:
+            arg_types = [convert_sp_to_sf_type(infer_type(arg)) for arg in args]
+            func_signature = f"{sproc_name.upper()}({', '.join(arg_types)})"
+
+            # describe procedure returns two column table with columns - property and value
+            # the second row in the sproc_desc is property=returns and value=<return type of procedure>
+            # when no procedure of the signature is found, SQL exception is raised
+            sproc_desc = self._run_query(f"describe procedure {func_signature}")
+            return_type = sproc_desc[1][1]
+            return return_type.upper().startswith("TABLE")
+        except Exception as exc:
+            _logger.warn(
+                f"Could not describe procedure {func_signature} due to exception {exc}"
+            )
+        return False
+
     def call(
         self,
         sproc_name: str,
         *args: Any,
         statement_params: Optional[Dict[str, Any]] = None,
     ) -> Any:
         """Calls a stored procedure by name.
@@ -1887,18 +1919,56 @@
             ...     return "SUCCESS"
             >>> _ = session.sql("create or replace table test_from(test_str varchar) as select randstr(20, random()) from table(generator(rowCount => 100))").collect()
             >>> _ = session.sql("drop table if exists test_to").collect()
             >>> session.call("my_copy_sp", "test_from", "test_to", 10)
             'SUCCESS'
             >>> session.table("test_to").count()
             10
+
+        Example::
+
+            >>> from snowflake.snowpark.dataframe import DataFrame
+            >>>
+            >>> @sproc(name="my_table_sp", replace=True)
+            ... def my_table(session: snowflake.snowpark.Session, x: int, y: int, col1: str, col2: str) -> DataFrame:
+            ...     return session.sql(f"select {x} as {col1}, {y} as {col2}")
+            >>> session.call("my_table_sp", 1, 2, "a", "b").show()
+            -------------
+            |"A"  |"B"  |
+            -------------
+            |1    |2    |
+            -------------
+            <BLANKLINE>
+        """
+        return self._call(sproc_name, *args, statement_params=statement_params)
+
+    def _call(
+        self,
+        sproc_name: str,
+        *args: Any,
+        statement_params: Optional[Dict[str, Any]] = None,
+        is_return_table: Optional[bool] = None,
+    ) -> Any:
+        """Private implementation of session.call
+
+        Args:
+            sproc_name: The name of stored procedure in Snowflake.
+            args: Arguments should be basic Python types.
+            statement_params: Dictionary of statement level parameters to be set while executing this action.
+            is_return_table: When set to a non-null value, it signifies whether the return type of sproc_name
+                is a table return type. This skips infer check and returns a dataframe with appropriate sql call.
         """
         validate_object_name(sproc_name)
         df = self.sql(generate_call_python_sp_sql(self, sproc_name, *args))
         set_api_call_source(df, "Session.call")
+
+        if is_return_table is None:
+            is_return_table = self._infer_is_return_table(sproc_name, *args)
+        if is_return_table:
+            return df
         return df.collect(statement_params=statement_params)[0][0]
 
     @deprecated(
         version="0.7.0",
         extra_warning_text="Use `Session.table_function()` instead.",
         extra_doc_string="Use :meth:`table_function` instead.",
     )
@@ -1989,53 +2059,52 @@
         ...     res = df.collect()
         >>> assert len(query_history.queries) == 1
         """
         query_listener = QueryHistory(self)
         self._conn.add_query_listener(query_listener)
         return query_listener
 
-    def _table_exists(self, raw_table_name: Union[str, Iterable[str]]):
+    def _table_exists(self, raw_table_name: Iterable[str]):
         """ """
-        if isinstance(raw_table_name, str):
+        # implementation based upon: https://docs.snowflake.com/en/sql-reference/name-resolution.html
+        qualified_table_name = list(raw_table_name)
+        if len(qualified_table_name) == 1:
+            # name in the form of "table"
             tables = self._run_query(
-                f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(raw_table_name)}'"
+                f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[0])}'"
+            )
+        elif len(qualified_table_name) == 2:
+            # name in the form of "schema.table" omitting database
+            # schema: qualified_table_name[0]
+            # table: qualified_table_name[1]
+            tables = self._run_query(
+                f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[1])}' in schema {qualified_table_name[0]}"
+            )
+        elif len(qualified_table_name) == 3:
+            # name in the form of "database.schema.table"
+            # database: qualified_table_name[0]
+            # schema: qualified_table_name[1]
+            # table: qualified_table_name[2]
+            # special case:  (''<database_name>..<object_name>''), by following
+            # https://docs.snowflake.com/en/sql-reference/name-resolution#resolution-when-schema-omitted-double-dot-notation
+            # The two dots indicate that the schema name is not specified.
+            # The PUBLIC default schema is always referenced.
+            condition = (
+                f"schema {qualified_table_name[0]}.PUBLIC"
+                if qualified_table_name[1] == ""
+                else f"schema {qualified_table_name[0]}.{qualified_table_name[1]}"
+            )
+            tables = self._run_query(
+                f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[2])}' in {condition}"
             )
         else:
-            # implementation based upon: https://docs.snowflake.com/en/sql-reference/name-resolution.html
-            qualified_table_name = list(raw_table_name)
-            if len(qualified_table_name) == 1:
-                # name in the form of "table"
-                tables = self._run_query(
-                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[0])}'"
-                )
-            elif len(qualified_table_name) == 2:
-                # name in the form of "schema.table" omitting database
-                # schema: qualified_table_name[0]
-                # table: qualified_table_name[1]
-                tables = self._run_query(
-                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[1])}' in schema {qualified_table_name[0]}"
-                )
-            elif len(qualified_table_name) == 3:
-                # name in the form of "database.schema.table"
-                # database: qualified_table_name[0]
-                # schema: qualified_table_name[1]
-                # table: qualified_table_name[2]
-                condition = (
-                    f"database {qualified_table_name[0]}"
-                    if qualified_table_name[1] == ""
-                    else f"schema {qualified_table_name[0]}.{qualified_table_name[1]}"
-                )
-                tables = self._run_query(
-                    f"show tables like '{strip_double_quotes_in_like_statement_in_table_name(qualified_table_name[2])}' in {condition}"
-                )
-            else:
-                # we do not support len(qualified_table_name) > 3 for now
-                raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(
-                    ".".join(raw_table_name)
-                )
+            # we do not support len(qualified_table_name) > 3 for now
+            raise SnowparkClientExceptionMessages.GENERAL_INVALID_OBJECT_NAME(
+                ".".join(raw_table_name)
+            )
 
         return tables is not None and len(tables) > 0
 
     def _explain_query(self, query: str) -> Optional[str]:
         try:
             return self._run_query(f"explain using text {query}")[0][0]
         # return None for queries which can't be explained
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/stored_procedure.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/stored_procedure.py`

 * *Files 2% similar despite different names*

```diff
@@ -12,36 +12,35 @@
 import snowflake.snowpark
 from snowflake.connector import ProgrammingError
 from snowflake.snowpark._internal.error_message import SnowparkClientExceptionMessages
 from snowflake.snowpark._internal.telemetry import TelemetryField
 from snowflake.snowpark._internal.type_utils import convert_sp_to_sf_type
 from snowflake.snowpark._internal.udf_utils import (
     UDFColumn,
+    check_execute_as_arg,
     check_register_args,
     cleanup_failed_permanent_registration,
     create_python_udf_or_sp,
     generate_anonymous_python_sp_sql,
     generate_call_python_sp_sql,
     process_file_path,
     process_registration_inputs,
     resolve_imports_and_packages,
 )
 from snowflake.snowpark._internal.utils import TempObjectType
-from snowflake.snowpark.types import DataType
+from snowflake.snowpark.types import DataType, StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
-EXECUTE_AS_WHITELIST = frozenset(["owner", "caller"])
-
 
 class StoredProcedure:
     """
     Encapsulates a user defined lambda or function that is returned by
     :func:`~snowflake.snowpark.functions.sproc`, :meth:`StoredProcedureRegistration.register`
     or :meth:`StoredProcedureRegistration.register_from_file`. The constructor
     of this class is not supposed to be called directly.
@@ -68,14 +67,15 @@
         #: The stored procedure name.
         self.name: str = name
 
         self._return_type = return_type
         self._input_types = input_types
         self._execute_as = execute_as
         self._anonymous_sp_sql = anonymous_sp_sql
+        self._is_return_table = isinstance(return_type, StructType)
 
     def __call__(
         self,
         *args: Any,
         session: Optional["snowflake.snowpark.session.Session"] = None,
     ) -> any:
         if args and isinstance(args[0], snowflake.snowpark.session.Session):
@@ -96,17 +96,22 @@
 
         session._conn._telemetry_client.send_function_usage_telemetry(
             "StoredProcedure.__call__", TelemetryField.FUNC_CAT_USAGE.value
         )
 
         if self._anonymous_sp_sql:
             call_sql = generate_call_python_sp_sql(session, self.name, *args)
-            return session.sql(f"{self._anonymous_sp_sql}{call_sql}").collect()[0][0]
+            df = session.sql(f"{self._anonymous_sp_sql}{call_sql}")
+            if self._is_return_table:
+                return df
+            return df.collect()[0][0]
         else:
-            return session.call(self.name, *args)
+            return session._call(
+                self.name, *args, is_return_table=self._is_return_table
+            )
 
 
 class StoredProcedureRegistration:
     """
     Provides methods to register lambdas and functions as stored procedures in the Snowflake database.
     For more information about Snowflake Python stored procedures, see `Python stored procedures <https://docs.snowflake.com/en/sql-reference/stored-procedures-python.html>`__.
 
@@ -177,14 +182,18 @@
         :class:`~snowflake.snowpark.types.GeographyType` (:attr:`~snowflake.snowpark.types.Geography`)
         by a stored procedure will be represented as a `GeoJSON <https://datatracker.ietf.org/doc/html/rfc7946>`_
         string.
 
         3. Currently calling stored procedure that requires VARIANT and GEOGRAPHY input types is not supported
         in snowpark API.
 
+        4. Dataframe returned from :meth:`~snowflake.snowpark.Session.call` does not support stacking dataframe
+        operations when sql simplifier is disabled, and output columns in return type for the table stored
+        procedure are not defined.
+
     Example 1
         Use stored procedure to copy data from one table to another::
 
             >>> import snowflake.snowpark
             >>> from snowflake.snowpark.functions import sproc
             >>>
             >>> session.add_packages('snowflake-snowpark-python')
@@ -333,14 +342,62 @@
             ...     func_name="mod5",
             ...     return_type=IntegerType(),
             ...     input_types=[IntegerType()],
             ... )
             >>> mod5_sp(2)
             2
 
+    Example 9
+        Creating a table stored procedure with return type while defining return columns and datatypes::
+
+            >>> from snowflake.snowpark.types import IntegerType, StructField, StructType
+            >>> @sproc(return_type=StructType([StructField("A", IntegerType()), StructField("B", IntegerType())]), input_types=[IntegerType(), IntegerType()])
+            ... def select_sp(session_, x, y):
+            ...     return session_.sql(f"SELECT {x} as A, {y} as B")
+            ...
+            >>> select_sp(1, 2).show()
+            -------------
+            |"A"  |"B"  |
+            -------------
+            |1    |2    |
+            -------------
+            <BLANKLINE>
+
+    Example 10
+        Creating a table stored procedure with return type with free return columns::
+
+            >>> from snowflake.snowpark.types import IntegerType, StructType
+            >>> @sproc(return_type=StructType(), input_types=[IntegerType(), IntegerType()])
+            ... def select_sp(session_, x, y):
+            ...     return session_.sql(f"SELECT {x} as A, {y} as B")
+            ...
+            >>> select_sp(1, 2).show()
+            -------------
+            |"A"  |"B"  |
+            -------------
+            |1    |2    |
+            -------------
+            <BLANKLINE>
+
+    Example 9
+        Creating a table stored procedure using implicit type hints::
+
+            >>> from snowflake.snowpark.dataframe import DataFrame
+            >>> @sproc
+            ... def select_sp(session_: snowflake.snowpark.Session, x: int, y: int) -> DataFrame:
+            ...     return session_.sql(f"SELECT {x} as A, {y} as B")
+            ...
+            >>> select_sp(1, 2).show()
+            -------------
+            |"A"  |"B"  |
+            -------------
+            |1    |2    |
+            -------------
+            <BLANKLINE>
+
     See Also:
         - :class:`snowflake.snowpark.udf.UDFRegistration`
         - :func:`~snowflake.snowpark.functions.sproc`
         - :meth:`register`
         - :meth:`register_from_file`
         - :meth:`~snowflake.snowpark.Session.add_import`
         - :meth:`~snowflake.snowpark.Session.add_packages`
@@ -451,23 +508,16 @@
             - :meth:`register_from_file`
         """
         if not callable(func):
             raise TypeError(
                 "Invalid function: not a function or callable "
                 f"(__call__ is not defined): {type(func)}"
             )
-        if (
-            not isinstance(execute_as, str)
-            or execute_as.lower() not in EXECUTE_AS_WHITELIST
-        ):
-            raise TypeError(
-                f"'execute_as' value '{execute_as}' is invalid, choose from "
-                f"{', '.join(EXECUTE_AS_WHITELIST, )}"
-            )
 
+        check_execute_as_arg(execute_as)
         check_register_args(
             TempObjectType.PROCEDURE, name, is_permanent, stage_location, parallel
         )
 
         # register stored procedure
         return self._do_register_sp(
             func,
@@ -498,14 +548,15 @@
         is_permanent: bool = False,
         stage_location: Optional[str] = None,
         imports: Optional[List[Union[str, Tuple[str, str]]]] = None,
         packages: Optional[List[Union[str, ModuleType]]] = None,
         replace: bool = False,
         if_not_exists: bool = False,
         parallel: int = 4,
+        execute_as: typing.Literal["caller", "owner"] = "owner",
         strict: bool = False,
         *,
         statement_params: Optional[Dict[str, str]] = None,
         source_code_display: bool = True,
         skip_upload_on_content_match: bool = False,
     ) -> StoredProcedure:
         """
@@ -561,14 +612,16 @@
                 The default is ``False``. ``if_not_exists`` and ``replace`` are mutually exclusive and a ``ValueError``
                 is raised when both are set. If it is ``True`` and a stored procedure is already registered, the registration is skipped.
             parallel: The number of threads to use for uploading stored procedure files with the
                 `PUT <https://docs.snowflake.com/en/sql-reference/sql/put.html#put>`_
                 command. The default value is 4 and supported values are from 1 to 99.
                 Increasing the number of threads can improve performance when uploading
                 large stored procedure files.
+            execute_as: What permissions should the procedure have while executing. This
+                supports caller, or owner for now.
             strict: Whether the created stored procedure is strict. A strict stored procedure will not invoke
                 the stored procedure if any input is null. Instead, a null value will always be returned. Note
                 that the stored procedure might still return null for non-null inputs.
             statement_params: Dictionary of statement level parameters to be set while executing this action.
             source_code_display: Display the source code of the stored procedure `func` as comments in the generated script.
                 The source code is dynamically generated therefore it may not be identical to how the
                 `func` is originally defined. The default is ``True``.
@@ -587,14 +640,15 @@
             - :func:`~snowflake.snowpark.functions.sproc`
             - :meth:`register`
         """
         file_path = process_file_path(file_path)
         check_register_args(
             TempObjectType.PROCEDURE, name, is_permanent, stage_location, parallel
         )
+        check_execute_as_arg(execute_as)
 
         # register stored procedure
         return self._do_register_sp(
             (file_path, func_name),
             return_type,
             input_types,
             name,
@@ -602,14 +656,15 @@
             imports,
             packages,
             replace,
             if_not_exists,
             parallel,
             strict,
             statement_params=statement_params,
+            execute_as=execute_as,
             api_call_source="StoredProcedureRegistration.register_from_file",
             source_code_display=source_code_display,
             skip_upload_on_content_match=skip_upload_on_content_match,
         )
 
     def _do_register_sp(
         self,
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/table.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
+import sys
 from typing import Dict, List, NamedTuple, Optional, Union, overload
 
 import snowflake.snowpark
 from snowflake.snowpark._internal.analyzer.binary_plan_node import create_join_type
 from snowflake.snowpark._internal.analyzer.select_statement import (
     SelectableEntity,
     SelectStatement,
@@ -26,17 +27,17 @@
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.dataframe import DataFrame, _disambiguate
 from snowflake.snowpark.row import Row
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class UpdateResult(NamedTuple):
     """Result of updating rows in a :class:`Table`."""
 
     rows_updated: int  #: The number of rows modified.
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/table_function.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/table_function.py`

 * *Files identical despite different names*

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/types.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/types.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,25 +1,26 @@
 #!/usr/bin/env python3
 #
 # Copyright (c) 2012-2023 Snowflake Computing Inc. All rights reserved.
 #
 
 """This package contains all Snowpark logical types."""
 import re
+import sys
 from typing import Generic, List, Optional, TypeVar, Union
 
 import snowflake.snowpark._internal.analyzer.expression as expression
 from snowflake.connector.options import installed_pandas, pandas
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class DataType:
     """The base class of Snowpark data types."""
 
     def __hash__(self):
@@ -62,17 +63,54 @@
 class DateType(_AtomicType):
     """Date data type. This maps to the DATE data type in Snowflake."""
 
     pass
 
 
 class StringType(_AtomicType):
-    """String data type. This maps to the VARCHAR data type in Snowflake."""
+    """String data type. This maps to the VARCHAR data type in Snowflake.
 
-    pass
+    A ``StringType`` object can be created in the following ways::
+
+        >>> string_t = StringType(23)  # this can be used to create a string type column which holds at most 23 chars
+        >>> string_t = StringType()    # this can be used to create a string type column with maximum allowed length
+    """
+
+    _MAX_LENGTH = 16777216
+
+    def __init__(self, length: Optional[int] = None) -> None:
+        self.length = length
+
+    def __repr__(self) -> str:
+        if self.length:
+            return f"StringType({self.length})"
+        return "StringType()"
+
+    def __eq__(self, other):
+        if not isinstance(other, StringType):
+            return False
+
+        if self.length == other.length:
+            return True
+
+        # This is to ensure that we treat StringType() and StringType(_MAX_LENGTH)
+        # the same because when a string type column is created on server side without
+        # a length parameter, it is set the _MAX_LENGTH by default.
+        if (
+            self.length is None
+            and other.length == StringType._MAX_LENGTH
+            or other.length is None
+            and self.length == StringType._MAX_LENGTH
+        ):
+            return True
+
+        return False
+
+    def __hash__(self):
+        return super().__hash__()
 
 
 class _NumericType(_AtomicType):
     pass
 
 
 class TimestampType(_AtomicType):
@@ -263,17 +301,39 @@
     def __eq__(self, other):
         return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
 
 
 class StructType(DataType):
     """Represents a table schema. Contains :class:`StructField` for each column."""
 
-    def __init__(self, fields: List["StructField"]) -> None:
+    def __init__(self, fields: Optional[List["StructField"]] = None) -> None:
+        if fields is None:
+            fields = []
         self.fields = fields
 
+    def add(
+        self,
+        field: Union[str, ColumnIdentifier, "StructField"],
+        datatype: Optional[DataType] = None,
+        nullable: Optional[bool] = True,
+    ) -> "StructType":
+        if isinstance(field, StructField):
+            self.fields.append(field)
+        elif isinstance(field, (str, ColumnIdentifier)):
+            if datatype is None:
+                raise ValueError(
+                    "When field argument is str or ColumnIdentifier, datatype must not be None."
+                )
+            self.fields.append(StructField(field, datatype, nullable))
+        else:
+            raise ValueError(
+                f"field argument must be one of str, ColumnIdentifier or StructField. Got: '{type(field)}'"
+            )
+        return self
+
     @classmethod
     def _from_attributes(cls, attributes: list) -> "StructType":
         return cls([StructField(a.name, a.datatype, a.nullable) for a in attributes])
 
     def _to_attributes(self) -> List["expression.Attribute"]:
         return [
             expression.Attribute(
@@ -293,15 +353,17 @@
                     return field
             raise KeyError(f"No StructField named {item}")
         elif isinstance(item, int):
             return self.fields[item]  # may throw ValueError
         elif isinstance(item, slice):
             return StructType(self.fields[item])
         else:
-            raise TypeError(f"StructType items should be strings, integers or slices, but got {type(item).__name__}")
+            raise TypeError(
+                f"StructType items should be strings, integers or slices, but got {type(item).__name__}"
+            )
 
     def __setitem__(self, key, value):
         raise TypeError("StructType object does not support item assignment")
 
     @property
     def names(self) -> List[str]:
         """Returns the list of names of the :class:`StructField`"""
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udf.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/udf.py`

 * *Files identical despite different names*

```diff
@@ -29,17 +29,17 @@
 )
 from snowflake.snowpark.column import Column
 from snowflake.snowpark.types import DataType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class UserDefinedFunction:
     """
     Encapsulates a user defined lambda or function that is returned by
     :func:`~snowflake.snowpark.functions.udf`, :meth:`UDFRegistration.register` or
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/udtf.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/udtf.py`

 * *Files 1% similar despite different names*

```diff
@@ -42,17 +42,17 @@
 from snowflake.snowpark._internal.utils import TempObjectType, validate_object_name
 from snowflake.snowpark.table_function import TableFunctionCall
 from snowflake.snowpark.types import DataType, StructField, StructType
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 class UserDefinedTableFunction:
     """
     Encapsulates a user defined table function that is returned by
     :func:`~snowflake.snowpark.functions.udtf`, :meth:`UDTFRegistration.register` or
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake/snowpark/window.py` & `snowflake-snowpark-python-1.5.0/src/snowflake/snowpark/window.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,17 +24,17 @@
 )
 from snowflake.snowpark._internal.type_utils import ColumnOrName
 from snowflake.snowpark._internal.utils import parse_positional_args_to_list
 
 # Python 3.8 needs to use typing.Iterable because collections.abc.Iterable is not subscriptable
 # Python 3.9 can use both
 # Python 3.10 needs to use collections.abc.Iterable because typing.Iterable is removed
-try:
+if sys.version_info <= (3, 9):
     from typing import Iterable
-except ImportError:
+else:
     from collections.abc import Iterable
 
 
 def _convert_boundary_to_expr(start: int, end: int) -> Tuple[Expression, Expression]:
     if start == 0:
         boundary_start = CurrentRow()
     elif start <= Window.UNBOUNDED_PRECEDING:
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/PKG-INFO` & `snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: snowflake-snowpark-python
-Version: 1.4.0
+Version: 1.5.0
 Summary: Snowflake Snowpark for Python
 Home-page: https://www.snowflake.com/
 Author: Snowflake, Inc
 Author-email: snowflake-python-libraries-dl@snowflake.com
 License: Apache License, Version 2.0
 Project-URL: Documentation, https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html
 Project-URL: Source, https://github.com/snowflakedb/snowpark-python
@@ -19,21 +19,22 @@
 Classifier: Intended Audience :: Information Technology
 Classifier: Intended Audience :: System Administrators
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: SQL
 Classifier: Programming Language :: Python :: 3 :: Only
 Classifier: Programming Language :: Python :: 3.8
+Classifier: Programming Language :: Python :: 3.9
 Classifier: Topic :: Database
 Classifier: Topic :: Software Development
 Classifier: Topic :: Software Development :: Libraries
 Classifier: Topic :: Software Development :: Libraries :: Application Frameworks
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Scientific/Engineering :: Information Analysis
-Requires-Python: ==3.8.*
+Requires-Python: >=3.8, <3.10
 Description-Content-Type: text/markdown
 Provides-Extra: pandas
 Provides-Extra: secure-local-storage
 Provides-Extra: development
 License-File: LICENSE.txt
 
 # Snowflake Snowpark Python API
@@ -130,14 +131,43 @@
 [snowflake lab sample code]: https://github.com/Snowflake-Labs/snowpark-python-demos
 [samples]: https://github.com/snowflakedb/snowpark-python/blob/main/README.md#samples
 [contributing]: https://github.com/snowflakedb/snowpark-python/blob/main/CONTRIBUTING.md
 
 
 # Release History
 
+## 1.5.0 (2023-06-09)
+
+### Behavior Changes
+
+- Aggregation results, from functions such as `DataFrame.agg` and `DataFrame.describe`, no longer strip away non-printing characters from column names.
+
+### New Features
+
+- Added support for the Python 3.9 runtime environment.
+- Added support for new functions in `snowflake.snowpark.functions`:
+  - `array_generate_range`
+  - `array_unique_agg`
+  - `collect_set`
+  - `sequence`
+- Added support for registering and calling stored procedures with `TABLE` return type.
+- Added support for parameter `length` in `StringType()` to specify the maximum number of characters that can be stored by the column.
+- Added the alias `functions.element_at()` for `functions.get()`.
+- Added the alias `Column.contains` for `functions.contains`.
+- Added experimental feature `DataFrame.alias`.
+- Added support for querying metadata columns from stage when creating `DataFrame` using `DataFrameReader`.
+- Added support for `StructType.add` to append more fields to existing `StructType` objects.
+- Added support for parameter `execute_as` in `StoredProcedureRegistration.register_from_file()` to specify stored procedure caller rights.
+
+### Bug Fixes
+
+- Fixed a bug where the `Dataframe.join_table_function` did not run all of the necessary queries to set up the join table function when SQL simplifier was enabled.
+- Fixed type hint declaration for custom types - `ColumnOrName`, `ColumnOrLiteralStr`, `ColumnOrSqlExpr`, `LiteralType` and `ColumnOrLiteral` that were breaking `mypy` checks.
+- Fixed a bug where `DataFrameWriter.save_as_table` and `DataFrame.copy_into_table` failed to parse fully qualified table names.
+
 ## 1.4.0 (2023-04-24)
 
 ### New Features
 
 - Added support for `session.getOrCreate`.
 - Added support for alias `Column.getField`.
 - Added support for new functions in `snowflake.snowpark.functions`:
@@ -147,15 +177,15 @@
   - `array_distinct`.
   - `regexp_extract`.
   - `struct`.
   - `format_number`.
   - `bround`.
   - `substring_index`
 - Added parameter `skip_upload_on_content_match` when creating UDFs, UDTFs and stored procedures using `register_from_file` to skip uploading files to a stage if the same version of the files are already on the stage.
-- Added support for `DataFrame.save_as_table` method to take table names that contain dots.
+- Added support for `DataFrameWriter.save_as_table` method to take table names that contain dots.
 - Flattened generated SQL when `DataFrame.filter()` or `DataFrame.order_by()` is followed by a projection statement (e.g. `DataFrame.select()`, `DataFrame.with_column()`).
 - Added support for creating dynamic tables _(in private preview)_ using `Dataframe.create_or_replace_dynamic_table`.
 - Added an optional argument `params` in `session.sql()` to support binding variables. Note that this is not supported in stored procedures yet.
 
 ### Bug Fixes
 
 - Fixed a bug in `strtok_to_array` where an exception was thrown when a delimiter was passed in.
```

### Comparing `snowflake-snowpark-python-1.4.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt` & `snowflake-snowpark-python-1.5.0/src/snowflake_snowpark_python.egg-info/SOURCES.txt`

 * *Files identical despite different names*

