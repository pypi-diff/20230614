# Comparing `tmp/patato-0.4.0-pp39-pypy39_pp73-win_amd64.whl.zip` & `tmp/patato-0.5.0-pp39-pypy39_pp73-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,142 +1,98 @@
-Zip file size: 272144 bytes, number of entries: 140
--rw-rw-rw-  2.0 fat     2274 b- defN 23-May-12 16:47 patato/__init__.py
--rw-rw-rw-  2.0 fat      214 b- defN 23-May-12 16:47 patato/convenience_scripts/__init__.py
--rw-rw-rw-  2.0 fat     1247 b- defN 23-May-12 16:47 patato/convenience_scripts/convert_binary_to_hdf5.py
--rw-rw-rw-  2.0 fat     1053 b- defN 23-May-12 16:47 patato/convenience_scripts/convert_simpa.py
--rw-rw-rw-  2.0 fat     6631 b- defN 23-May-12 16:47 patato/convenience_scripts/copy_rois.py
--rw-rw-rw-  2.0 fat    20287 b- defN 23-May-12 16:47 patato/convenience_scripts/draw_roi.py
--rw-rw-rw-  2.0 fat     2148 b- defN 23-May-12 16:47 patato/convenience_scripts/generate_core.py
--rw-rw-rw-  2.0 fat     1294 b- defN 23-May-12 16:47 patato/convenience_scripts/import_clinical_data.py
--rw-rw-rw-  2.0 fat     1666 b- defN 23-May-12 16:47 patato/convenience_scripts/import_ithera_recons.py
--rw-rw-rw-  2.0 fat     1536 b- defN 23-May-12 16:47 patato/convenience_scripts/print_speeds.py
--rw-rw-rw-  2.0 fat     4649 b- defN 23-May-12 16:47 patato/convenience_scripts/process_msot.py
--rw-rw-rw-  2.0 fat      962 b- defN 23-May-12 16:47 patato/convenience_scripts/rename_scan.py
--rw-rw-rw-  2.0 fat     1890 b- defN 23-May-12 16:47 patato/convenience_scripts/scan_status.py
--rw-rw-rw-  2.0 fat     1788 b- defN 23-May-12 16:47 patato/convenience_scripts/split_rois.py
--rw-rw-rw-  2.0 fat     8435 b- defN 23-May-12 16:47 patato/convenience_scripts/tune_speed_of_sound.py
--rw-rw-rw-  2.0 fat     2665 b- defN 23-May-12 16:47 patato/convenience_scripts/unmix.py
--rw-rw-rw-  2.0 fat     4250 b- defN 23-May-12 16:47 patato/convenience_scripts/view.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/convenience_scripts/data_analysis/__init__.py
--rw-rw-rw-  2.0 fat     2617 b- defN 23-May-12 16:47 patato/convenience_scripts/data_analysis/analyse_dce.py
--rw-rw-rw-  2.0 fat     2745 b- defN 23-May-12 16:47 patato/convenience_scripts/data_analysis/analyse_gas_challenge.py
--rw-rw-rw-  2.0 fat       87 b- defN 23-May-12 16:47 patato/core/__init__.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/core/image_structures/__init__.py
--rw-rw-rw-  2.0 fat    12591 b- defN 23-May-12 16:47 patato/core/image_structures/image_sequence.py
--rw-rw-rw-  2.0 fat      773 b- defN 23-May-12 16:47 patato/core/image_structures/image_structure_types.py
--rw-rw-rw-  2.0 fat     1275 b- defN 23-May-12 16:47 patato/core/image_structures/pa_fourier_data.py
--rw-rw-rw-  2.0 fat     2035 b- defN 23-May-12 16:47 patato/core/image_structures/pa_raw_data.py
--rw-rw-rw-  2.0 fat     2054 b- defN 23-May-12 16:47 patato/core/image_structures/pa_time_data.py
--rw-rw-rw-  2.0 fat     1141 b- defN 23-May-12 16:47 patato/core/image_structures/reconstruction_image.py
--rw-rw-rw-  2.0 fat      982 b- defN 23-May-12 16:47 patato/core/image_structures/single_image.py
--rw-rw-rw-  2.0 fat     1121 b- defN 23-May-12 16:47 patato/core/image_structures/single_parameter_data.py
--rw-rw-rw-  2.0 fat      930 b- defN 23-May-12 16:47 patato/core/image_structures/unmixed_image.py
--rw-rw-rw-  2.0 fat      371 b- defN 23-May-12 16:47 patato/data/__init__.py
--rw-rw-rw-  2.0 fat     3890 b- defN 23-May-12 16:47 patato/data/get_example_datasets.py
--rw-rw-rw-  2.0 fat     2132 b- defN 23-May-12 16:47 patato/data/simulated_datasets.py
--rw-rw-rw-  2.0 fat      124 b- defN 23-May-12 16:47 patato/io/__init__.py
--rw-rw-rw-  2.0 fat     2877 b- defN 23-May-12 16:47 patato/io/attribute_tags.py
--rw-rw-rw-  2.0 fat     3924 b- defN 23-May-12 16:47 patato/io/hdf5_converter.py
--rw-rw-rw-  2.0 fat    23829 b- defN 23-May-12 16:47 patato/io/msot_data.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/hdf/__init__.py
--rw-rw-rw-  2.0 fat    12215 b- defN 23-May-12 16:47 patato/io/hdf/fileimporter.py
--rw-rw-rw-  2.0 fat    17067 b- defN 23-May-12 16:47 patato/io/hdf/hdf5_interface.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/hdf/tests/__init__.py
--rw-rw-rw-  2.0 fat      511 b- defN 23-May-12 16:47 patato/io/hdf/tests/test_ithera_import_clinical_new.py
--rw-rw-rw-  2.0 fat      518 b- defN 23-May-12 16:47 patato/io/ipasc/__init__.py
--rw-rw-rw-  2.0 fat     2531 b- defN 23-May-12 16:47 patato/io/ipasc/ipasc_export.py
--rw-rw-rw-  2.0 fat     2834 b- defN 23-May-12 16:47 patato/io/ipasc/read_ipasc.py
--rw-rw-rw-  2.0 fat      245 b- defN 23-May-12 16:47 patato/io/ithera/__init__.py
--rw-rw-rw-  2.0 fat    13838 b- defN 23-May-12 16:47 patato/io/ithera/read_ithera.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/ithera/tests/__init__.py
--rw-rw-rw-  2.0 fat     1749 b- defN 23-May-12 16:47 patato/io/ithera/tests/ithera_tests.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/json/__init__.py
--rw-rw-rw-  2.0 fat     6898 b- defN 23-May-12 16:47 patato/io/json/json_reading.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/json/tests/__init__.py
--rw-rw-rw-  2.0 fat     1122 b- defN 23-May-12 16:47 patato/io/json/tests/test_reconstruction_reading.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/simpa/__init__.py
--rw-rw-rw-  2.0 fat     5192 b- defN 23-May-12 16:47 patato/io/simpa/read_simpa.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/io/tests/__init__.py
--rw-rw-rw-  2.0 fat     1456 b- defN 23-May-12 16:47 patato/io/tests/test_msot_data.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/processing/__init__.py
--rw-rw-rw-  2.0 fat    11809 b- defN 23-May-12 16:47 patato/processing/gpu_preprocessing_algorithm.py
--rw-rw-rw-  2.0 fat    12380 b- defN 23-May-12 16:47 patato/processing/jax_preprocessing_algorithm.py
--rw-rw-rw-  2.0 fat    10136 b- defN 23-May-12 16:47 patato/processing/preprocessing_algorithm.py
--rw-rw-rw-  2.0 fat      655 b- defN 23-May-12 16:47 patato/processing/preprocessing_types.py
--rw-rw-rw-  2.0 fat     2259 b- defN 23-May-12 16:47 patato/processing/processing_algorithm.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/processing/tests/__init__.py
--rw-rw-rw-  2.0 fat     2466 b- defN 23-May-12 16:47 patato/processing/tests/preprocessing_algorithm.py
--rw-rw-rw-  2.0 fat     1878 b- defN 23-May-12 16:47 patato/recon/__init__.py
--rw-rw-rw-  2.0 fat     7281 b- defN 23-May-12 16:47 patato/recon/backprojection_opencl.py
--rw-rw-rw-  2.0 fat     2078 b- defN 23-May-12 16:47 patato/recon/backprojection_reference.py
--rw-rw-rw-  2.0 fat     5070 b- defN 23-May-12 16:47 patato/recon/reconstruction_algorithm.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/recon/backprojection_implementation/__init__.py
--rw-rw-rw-  2.0 fat     1056 b- defN 23-May-12 16:47 patato/recon/backprojection_implementation/jax_implementation.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/recon/model_based/__init__.py
--rw-rw-rw-  2.0 fat     3874 b- defN 23-May-12 16:47 patato/recon/model_based/cuda_implementation.py
--rw-rw-rw-  2.0 fat     2806 b- defN 23-May-12 16:47 patato/recon/model_based/cuda_implementation_refraction.py
--rw-rw-rw-  2.0 fat     6985 b- defN 23-May-12 16:47 patato/recon/model_based/generate_model.cpp
--rw-rw-rw-  2.0 fat     5999 b- defN 23-May-12 16:47 patato/recon/model_based/generate_model.cu
--rw-rw-rw-  2.0 fat   113152 b- defN 23-May-12 16:57 patato/recon/model_based/generate_model.pypy39-pp73-win_amd64.pyd
--rw-rw-rw-  2.0 fat     8080 b- defN 23-May-12 16:47 patato/recon/model_based/generate_model_refraction.cpp
--rw-rw-rw-  2.0 fat     7990 b- defN 23-May-12 16:47 patato/recon/model_based/generate_model_refraction.cu
--rw-rw-rw-  2.0 fat   114176 b- defN 23-May-12 16:57 patato/recon/model_based/generate_model_refraction.pypy39-pp73-win_amd64.pyd
--rw-rw-rw-  2.0 fat    10355 b- defN 23-May-12 16:47 patato/recon/model_based/model_based.py
--rw-rw-rw-  2.0 fat     2519 b- defN 23-May-12 16:47 patato/recon/model_based/numpy_implementation.py
--rw-rw-rw-  2.0 fat       94 b- defN 23-May-12 16:47 patato/recon/numpy/__init__.py
--rw-rw-rw-  2.0 fat     3029 b- defN 23-May-12 16:47 patato/recon/numpy/recon.py
--rw-rw-rw-  2.0 fat     1633 b- defN 23-May-12 16:47 patato/recon/opencl_code/dascl.cl
--rw-rw-rw-  2.0 fat     1729 b- defN 23-May-12 16:47 patato/recon/opencl_code/dmascl.cl
--rw-rw-rw-  2.0 fat      488 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_clinical.json
--rw-rw-rw-  2.0 fat      488 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_clinical_xy.json
--rw-rw-rw-  2.0 fat      488 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_clinical_xz.json
--rw-rw-rw-  2.0 fat      488 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_clinical_yz.json
--rw-rw-rw-  2.0 fat      486 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_janek.json
--rw-rw-rw-  2.0 fat      486 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_janek_sos.json
--rw-rw-rw-  2.0 fat      485 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_noirf.json
--rw-rw-rw-  2.0 fat      491 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard.json
--rw-rw-rw-  2.0 fat      493 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_sos.json
--rw-rw-rw-  2.0 fat      557 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_water_correction.json
--rw-rw-rw-  2.0 fat      561 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_water_correction_new_ithera.json
--rw-rw-rw-  2.0 fat      491 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_xy.json
--rw-rw-rw-  2.0 fat      491 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_xz.json
--rw-rw-rw-  2.0 fat      491 b- defN 23-May-12 16:47 patato/recon/recon_presets/backproject_standard_yz.json
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/recon/tests/__init__.py
--rw-rw-rw-  2.0 fat     1873 b- defN 23-May-12 16:47 patato/recon/tests/backprojection_test.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/recon/tests/model_based_test.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/unmixing/__init__.py
--rw-rw-rw-  2.0 fat    15954 b- defN 23-May-12 16:47 patato/unmixing/unmixer.py
--rw-rw-rw-  2.0 fat     4290 b- defN 23-May-12 16:47 patato/unmixing/spectra/__init__.py
--rw-rw-rw-  2.0 fat    12113 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/ICG.csv
--rw-rw-rw-  2.0 fat    17760 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/Melanin.csv
--rw-rw-rw-  2.0 fat     7768 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/lipids.txt
--rw-rw-rw-  2.0 fat     6861 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/prahl.txt
--rw-rw-rw-  2.0 fat     3710 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/water.txt
--rw-rw-rw-  2.0 fat     8643 b- defN 23-May-12 16:47 patato/unmixing/spectra/spectra_files/water_long.txt
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/unmixing/tests/__init__.py
--rw-rw-rw-  2.0 fat     3404 b- defN 23-May-12 16:47 patato/unmixing/tests/unmixing_test.py
--rw-rw-rw-  2.0 fat      120 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/haemoglobin.json
--rw-rw-rw-  2.0 fat      120 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/haemoglobin_flow_phantom.json
--rw-rw-rw-  2.0 fat      121 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/haemoglobin_flow_phantom_all_wl.json
--rw-rw-rw-  2.0 fat      134 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/haemoglobin_melanin.json
--rw-rw-rw-  2.0 fat      183 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/haemoglobin_mitox.json
--rw-rw-rw-  2.0 fat      205 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/hb_emma_water.json
--rw-rw-rw-  2.0 fat      132 b- defN 23-May-12 16:47 patato/unmixing/unmix_presets/hb_icg.json
--rw-rw-rw-  2.0 fat     9603 b- defN 23-May-12 16:47 patato/useful_utilities/__init__.py
--rw-rw-rw-  2.0 fat      379 b- defN 23-May-12 16:47 patato/utils/__init__.py
--rw-rw-rw-  2.0 fat     4320 b- defN 23-May-12 16:47 patato/utils/mask_operations.py
--rw-rw-rw-  2.0 fat     1316 b- defN 23-May-12 16:47 patato/utils/plotting.py
--rw-rw-rw-  2.0 fat      585 b- defN 23-May-12 16:47 patato/utils/process_study.py
--rw-rw-rw-  2.0 fat     3534 b- defN 23-May-12 16:47 patato/utils/roi_operations.py
--rw-rw-rw-  2.0 fat     4262 b- defN 23-May-12 16:47 patato/utils/run_pipeline.py
--rw-rw-rw-  2.0 fat     3025 b- defN 23-May-12 16:47 patato/utils/time_series_analysis.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/utils/rois/__init__.py
--rw-rw-rw-  2.0 fat     3338 b- defN 23-May-12 16:47 patato/utils/rois/roi_type.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-May-12 16:47 patato/utils/tests/__init__.py
--rw-rw-rw-  2.0 fat     1507 b- defN 23-May-12 16:47 patato/utils/tests/pipline_tests.py
--rw-rw-rw-  2.0 fat     1087 b- defN 23-May-12 16:57 patato-0.4.0.dist-info/LICENSE.MD
--rw-rw-rw-  2.0 fat     3448 b- defN 23-May-12 16:57 patato-0.4.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat      107 b- defN 23-May-12 16:57 patato-0.4.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat      590 b- defN 23-May-12 16:56 patato-0.4.0.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat        7 b- defN 23-May-12 16:56 patato-0.4.0.dist-info/top_level.txt
--rw-rw-r--  2.0 fat    13597 b- defN 23-May-12 16:57 patato-0.4.0.dist-info/RECORD
-140 files, 676277 bytes uncompressed, 250012 bytes compressed:  63.0%
+Zip file size: 233267 bytes, number of entries: 96
+-rw-rw-rw-  2.0 fat     2183 b- defN 23-Jun-14 09:02 patato/__init__.py
+-rw-rw-rw-  2.0 fat      216 b- defN 23-Jun-14 09:02 patato/convenience_scripts/__init__.py
+-rw-rw-rw-  2.0 fat     1247 b- defN 23-Jun-14 09:02 patato/convenience_scripts/convert_binary_to_hdf5.py
+-rw-rw-rw-  2.0 fat     1053 b- defN 23-Jun-14 09:02 patato/convenience_scripts/convert_simpa.py
+-rw-rw-rw-  2.0 fat     6648 b- defN 23-Jun-14 09:02 patato/convenience_scripts/copy_rois.py
+-rw-rw-rw-  2.0 fat    20250 b- defN 23-Jun-14 09:02 patato/convenience_scripts/draw_roi.py
+-rw-rw-rw-  2.0 fat     2153 b- defN 23-Jun-14 09:02 patato/convenience_scripts/generate_core.py
+-rw-rw-rw-  2.0 fat     1294 b- defN 23-Jun-14 09:02 patato/convenience_scripts/import_clinical_data.py
+-rw-rw-rw-  2.0 fat     1666 b- defN 23-Jun-14 09:02 patato/convenience_scripts/import_ithera_recons.py
+-rw-rw-rw-  2.0 fat     1541 b- defN 23-Jun-14 09:02 patato/convenience_scripts/print_speeds.py
+-rw-rw-rw-  2.0 fat     4611 b- defN 23-Jun-14 09:02 patato/convenience_scripts/process_msot.py
+-rw-rw-rw-  2.0 fat      962 b- defN 23-Jun-14 09:02 patato/convenience_scripts/rename_scan.py
+-rw-rw-rw-  2.0 fat     1895 b- defN 23-Jun-14 09:02 patato/convenience_scripts/scan_status.py
+-rw-rw-rw-  2.0 fat     1793 b- defN 23-Jun-14 09:02 patato/convenience_scripts/split_rois.py
+-rw-rw-rw-  2.0 fat     8438 b- defN 23-Jun-14 09:02 patato/convenience_scripts/tune_speed_of_sound.py
+-rw-rw-rw-  2.0 fat     2663 b- defN 23-Jun-14 09:02 patato/convenience_scripts/unmix.py
+-rw-rw-rw-  2.0 fat     4255 b- defN 23-Jun-14 09:02 patato/convenience_scripts/view.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/convenience_scripts/data_analysis/__init__.py
+-rw-rw-rw-  2.0 fat     2617 b- defN 23-Jun-14 09:02 patato/convenience_scripts/data_analysis/analyse_dce.py
+-rw-rw-rw-  2.0 fat     2745 b- defN 23-Jun-14 09:02 patato/convenience_scripts/data_analysis/analyse_gas_challenge.py
+-rw-rw-rw-  2.0 fat      251 b- defN 23-Jun-14 09:02 patato/core/__init__.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/core/image_structures/__init__.py
+-rw-rw-rw-  2.0 fat    12588 b- defN 23-Jun-14 09:02 patato/core/image_structures/image_sequence.py
+-rw-rw-rw-  2.0 fat      856 b- defN 23-Jun-14 09:02 patato/core/image_structures/image_structure_types.py
+-rw-rw-rw-  2.0 fat     1430 b- defN 23-Jun-14 09:02 patato/core/image_structures/pa_raw_data.py
+-rw-rw-rw-  2.0 fat     1331 b- defN 23-Jun-14 09:02 patato/core/image_structures/pa_time_data.py
+-rw-rw-rw-  2.0 fat      851 b- defN 23-Jun-14 09:02 patato/core/image_structures/reconstruction_image.py
+-rw-rw-rw-  2.0 fat      982 b- defN 23-Jun-14 09:02 patato/core/image_structures/single_image.py
+-rw-rw-rw-  2.0 fat     1121 b- defN 23-Jun-14 09:02 patato/core/image_structures/single_parameter_data.py
+-rw-rw-rw-  2.0 fat      930 b- defN 23-Jun-14 09:02 patato/core/image_structures/unmixed_image.py
+-rw-rw-rw-  2.0 fat      701 b- defN 23-Jun-14 09:02 patato/data/__init__.py
+-rw-rw-rw-  2.0 fat     3676 b- defN 23-Jun-14 09:02 patato/data/get_example_datasets.py
+-rw-rw-rw-  2.0 fat     2132 b- defN 23-Jun-14 09:02 patato/data/simulated_datasets.py
+-rw-rw-rw-  2.0 fat       53 b- defN 23-Jun-14 09:02 patato/experimental/__init__.py
+-rw-rw-rw-  2.0 fat       57 b- defN 23-Jun-14 09:02 patato/experimental/simulation/__init__.py
+-rw-rw-rw-  2.0 fat      194 b- defN 23-Jun-14 09:02 patato/io/__init__.py
+-rw-rw-rw-  2.0 fat     2877 b- defN 23-Jun-14 09:02 patato/io/attribute_tags.py
+-rw-rw-rw-  2.0 fat     3924 b- defN 23-Jun-14 09:02 patato/io/hdf5_converter.py
+-rw-rw-rw-  2.0 fat    23221 b- defN 23-Jun-14 09:02 patato/io/msot_data.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/io/hdf/__init__.py
+-rw-rw-rw-  2.0 fat    12302 b- defN 23-Jun-14 09:02 patato/io/hdf/fileimporter.py
+-rw-rw-rw-  2.0 fat    17073 b- defN 23-Jun-14 09:02 patato/io/hdf/hdf5_interface.py
+-rw-rw-rw-  2.0 fat      518 b- defN 23-Jun-14 09:02 patato/io/ipasc/__init__.py
+-rw-rw-rw-  2.0 fat     2472 b- defN 23-Jun-14 09:02 patato/io/ipasc/ipasc_export.py
+-rw-rw-rw-  2.0 fat     2840 b- defN 23-Jun-14 09:02 patato/io/ipasc/read_ipasc.py
+-rw-rw-rw-  2.0 fat      245 b- defN 23-Jun-14 09:02 patato/io/ithera/__init__.py
+-rw-rw-rw-  2.0 fat    13838 b- defN 23-Jun-14 09:02 patato/io/ithera/read_ithera.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/io/json/__init__.py
+-rw-rw-rw-  2.0 fat     6868 b- defN 23-Jun-14 09:02 patato/io/json/json_reading.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/io/simpa/__init__.py
+-rw-rw-rw-  2.0 fat     5192 b- defN 23-Jun-14 09:02 patato/io/simpa/read_simpa.py
+-rw-rw-rw-  2.0 fat      339 b- defN 23-Jun-14 09:02 patato/processing/__init__.py
+-rw-rw-rw-  2.0 fat    11603 b- defN 23-Jun-14 09:02 patato/processing/gpu_preprocessing_algorithm.py
+-rw-rw-rw-  2.0 fat    12332 b- defN 23-Jun-14 09:02 patato/processing/jax_preprocessing_algorithm.py
+-rw-rw-rw-  2.0 fat    10264 b- defN 23-Jun-14 09:02 patato/processing/preprocessing_algorithm.py
+-rw-rw-rw-  2.0 fat      685 b- defN 23-Jun-14 09:02 patato/processing/preprocessing_types.py
+-rw-rw-rw-  2.0 fat     2259 b- defN 23-Jun-14 09:02 patato/processing/processing_algorithm.py
+-rw-rw-rw-  2.0 fat     1897 b- defN 23-Jun-14 09:02 patato/recon/__init__.py
+-rw-rw-rw-  2.0 fat     7337 b- defN 23-Jun-14 09:02 patato/recon/backprojection_opencl.py
+-rw-rw-rw-  2.0 fat     2137 b- defN 23-Jun-14 09:02 patato/recon/backprojection_reference.py
+-rw-rw-rw-  2.0 fat     5070 b- defN 23-Jun-14 09:02 patato/recon/reconstruction_algorithm.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/recon/backprojection_implementation/__init__.py
+-rw-rw-rw-  2.0 fat     1056 b- defN 23-Jun-14 09:02 patato/recon/backprojection_implementation/jax_implementation.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/recon/model_based/__init__.py
+-rw-rw-rw-  2.0 fat     3874 b- defN 23-Jun-14 09:02 patato/recon/model_based/cuda_implementation.py
+-rw-rw-rw-  2.0 fat     2806 b- defN 23-Jun-14 09:02 patato/recon/model_based/cuda_implementation_refraction.py
+-rw-rw-rw-  2.0 fat     6985 b- defN 23-Jun-14 09:02 patato/recon/model_based/generate_model.cpp
+-rw-rw-rw-  2.0 fat     5999 b- defN 23-Jun-14 09:02 patato/recon/model_based/generate_model.cu
+-rw-rw-rw-  2.0 fat   113152 b- defN 23-Jun-14 09:10 patato/recon/model_based/generate_model.pypy39-pp73-win_amd64.pyd
+-rw-rw-rw-  2.0 fat     8080 b- defN 23-Jun-14 09:02 patato/recon/model_based/generate_model_refraction.cpp
+-rw-rw-rw-  2.0 fat     7990 b- defN 23-Jun-14 09:02 patato/recon/model_based/generate_model_refraction.cu
+-rw-rw-rw-  2.0 fat   114176 b- defN 23-Jun-14 09:10 patato/recon/model_based/generate_model_refraction.pypy39-pp73-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    11229 b- defN 23-Jun-14 09:02 patato/recon/model_based/model_based.py
+-rw-rw-rw-  2.0 fat     2524 b- defN 23-Jun-14 09:02 patato/recon/model_based/numpy_implementation.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/recon/numpy_backprojection/__init__.py
+-rw-rw-rw-  2.0 fat     3004 b- defN 23-Jun-14 09:02 patato/recon/numpy_backprojection/recon.py
+-rw-rw-rw-  2.0 fat      576 b- defN 23-Jun-14 09:02 patato/unmixing/__init__.py
+-rw-rw-rw-  2.0 fat    15954 b- defN 23-Jun-14 09:02 patato/unmixing/unmixer.py
+-rw-rw-rw-  2.0 fat     4290 b- defN 23-Jun-14 09:02 patato/unmixing/spectra/__init__.py
+-rw-rw-rw-  2.0 fat     9837 b- defN 23-Jun-14 09:02 patato/useful_utilities/__init__.py
+-rw-rw-rw-  2.0 fat      523 b- defN 23-Jun-14 09:02 patato/utils/__init__.py
+-rw-rw-rw-  2.0 fat     4320 b- defN 23-Jun-14 09:02 patato/utils/mask_operations.py
+-rw-rw-rw-  2.0 fat     1316 b- defN 23-Jun-14 09:02 patato/utils/plotting.py
+-rw-rw-rw-  2.0 fat      585 b- defN 23-Jun-14 09:02 patato/utils/process_study.py
+-rw-rw-rw-  2.0 fat     3570 b- defN 23-Jun-14 09:02 patato/utils/roi_operations.py
+-rw-rw-rw-  2.0 fat     4262 b- defN 23-Jun-14 09:02 patato/utils/run_pipeline.py
+-rw-rw-rw-  2.0 fat     3025 b- defN 23-Jun-14 09:02 patato/utils/time_series_analysis.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/utils/rois/__init__.py
+-rw-rw-rw-  2.0 fat     3338 b- defN 23-Jun-14 09:02 patato/utils/rois/roi_type.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-14 09:02 patato/utils/tests/__init__.py
+-rw-rw-rw-  2.0 fat     1087 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/LICENSE.MD
+-rw-rw-rw-  2.0 fat     4949 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      107 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat      590 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat        7 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     9068 b- defN 23-Jun-14 09:10 patato-0.5.0.dist-info/RECORD
+96 files, 589505 bytes uncompressed, 218589 bytes compressed:  62.9%
```

## zipnote {}

```diff
@@ -66,17 +66,14 @@
 
 Filename: patato/core/image_structures/image_sequence.py
 Comment: 
 
 Filename: patato/core/image_structures/image_structure_types.py
 Comment: 
 
-Filename: patato/core/image_structures/pa_fourier_data.py
-Comment: 
-
 Filename: patato/core/image_structures/pa_raw_data.py
 Comment: 
 
 Filename: patato/core/image_structures/pa_time_data.py
 Comment: 
 
 Filename: patato/core/image_structures/reconstruction_image.py
@@ -96,14 +93,20 @@
 
 Filename: patato/data/get_example_datasets.py
 Comment: 
 
 Filename: patato/data/simulated_datasets.py
 Comment: 
 
+Filename: patato/experimental/__init__.py
+Comment: 
+
+Filename: patato/experimental/simulation/__init__.py
+Comment: 
+
 Filename: patato/io/__init__.py
 Comment: 
 
 Filename: patato/io/attribute_tags.py
 Comment: 
 
 Filename: patato/io/hdf5_converter.py
@@ -117,20 +120,14 @@
 
 Filename: patato/io/hdf/fileimporter.py
 Comment: 
 
 Filename: patato/io/hdf/hdf5_interface.py
 Comment: 
 
-Filename: patato/io/hdf/tests/__init__.py
-Comment: 
-
-Filename: patato/io/hdf/tests/test_ithera_import_clinical_new.py
-Comment: 
-
 Filename: patato/io/ipasc/__init__.py
 Comment: 
 
 Filename: patato/io/ipasc/ipasc_export.py
 Comment: 
 
 Filename: patato/io/ipasc/read_ipasc.py
@@ -138,44 +135,26 @@
 
 Filename: patato/io/ithera/__init__.py
 Comment: 
 
 Filename: patato/io/ithera/read_ithera.py
 Comment: 
 
-Filename: patato/io/ithera/tests/__init__.py
-Comment: 
-
-Filename: patato/io/ithera/tests/ithera_tests.py
-Comment: 
-
 Filename: patato/io/json/__init__.py
 Comment: 
 
 Filename: patato/io/json/json_reading.py
 Comment: 
 
-Filename: patato/io/json/tests/__init__.py
-Comment: 
-
-Filename: patato/io/json/tests/test_reconstruction_reading.py
-Comment: 
-
 Filename: patato/io/simpa/__init__.py
 Comment: 
 
 Filename: patato/io/simpa/read_simpa.py
 Comment: 
 
-Filename: patato/io/tests/__init__.py
-Comment: 
-
-Filename: patato/io/tests/test_msot_data.py
-Comment: 
-
 Filename: patato/processing/__init__.py
 Comment: 
 
 Filename: patato/processing/gpu_preprocessing_algorithm.py
 Comment: 
 
 Filename: patato/processing/jax_preprocessing_algorithm.py
@@ -186,20 +165,14 @@
 
 Filename: patato/processing/preprocessing_types.py
 Comment: 
 
 Filename: patato/processing/processing_algorithm.py
 Comment: 
 
-Filename: patato/processing/tests/__init__.py
-Comment: 
-
-Filename: patato/processing/tests/preprocessing_algorithm.py
-Comment: 
-
 Filename: patato/recon/__init__.py
 Comment: 
 
 Filename: patato/recon/backprojection_opencl.py
 Comment: 
 
 Filename: patato/recon/backprojection_reference.py
@@ -243,131 +216,29 @@
 
 Filename: patato/recon/model_based/model_based.py
 Comment: 
 
 Filename: patato/recon/model_based/numpy_implementation.py
 Comment: 
 
-Filename: patato/recon/numpy/__init__.py
-Comment: 
-
-Filename: patato/recon/numpy/recon.py
-Comment: 
-
-Filename: patato/recon/opencl_code/dascl.cl
-Comment: 
-
-Filename: patato/recon/opencl_code/dmascl.cl
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_clinical.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_clinical_xy.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_clinical_xz.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_clinical_yz.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_janek.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_janek_sos.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_noirf.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard.json
+Filename: patato/recon/numpy_backprojection/__init__.py
 Comment: 
 
-Filename: patato/recon/recon_presets/backproject_standard_sos.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard_water_correction.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard_water_correction_new_ithera.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard_xy.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard_xz.json
-Comment: 
-
-Filename: patato/recon/recon_presets/backproject_standard_yz.json
-Comment: 
-
-Filename: patato/recon/tests/__init__.py
-Comment: 
-
-Filename: patato/recon/tests/backprojection_test.py
-Comment: 
-
-Filename: patato/recon/tests/model_based_test.py
+Filename: patato/recon/numpy_backprojection/recon.py
 Comment: 
 
 Filename: patato/unmixing/__init__.py
 Comment: 
 
 Filename: patato/unmixing/unmixer.py
 Comment: 
 
 Filename: patato/unmixing/spectra/__init__.py
 Comment: 
 
-Filename: patato/unmixing/spectra/spectra_files/ICG.csv
-Comment: 
-
-Filename: patato/unmixing/spectra/spectra_files/Melanin.csv
-Comment: 
-
-Filename: patato/unmixing/spectra/spectra_files/lipids.txt
-Comment: 
-
-Filename: patato/unmixing/spectra/spectra_files/prahl.txt
-Comment: 
-
-Filename: patato/unmixing/spectra/spectra_files/water.txt
-Comment: 
-
-Filename: patato/unmixing/spectra/spectra_files/water_long.txt
-Comment: 
-
-Filename: patato/unmixing/tests/__init__.py
-Comment: 
-
-Filename: patato/unmixing/tests/unmixing_test.py
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/haemoglobin.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/haemoglobin_flow_phantom.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/haemoglobin_flow_phantom_all_wl.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/haemoglobin_melanin.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/haemoglobin_mitox.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/hb_emma_water.json
-Comment: 
-
-Filename: patato/unmixing/unmix_presets/hb_icg.json
-Comment: 
-
 Filename: patato/useful_utilities/__init__.py
 Comment: 
 
 Filename: patato/utils/__init__.py
 Comment: 
 
 Filename: patato/utils/mask_operations.py
@@ -393,29 +264,26 @@
 
 Filename: patato/utils/rois/roi_type.py
 Comment: 
 
 Filename: patato/utils/tests/__init__.py
 Comment: 
 
-Filename: patato/utils/tests/pipline_tests.py
-Comment: 
-
-Filename: patato-0.4.0.dist-info/LICENSE.MD
+Filename: patato-0.5.0.dist-info/LICENSE.MD
 Comment: 
 
-Filename: patato-0.4.0.dist-info/METADATA
+Filename: patato-0.5.0.dist-info/METADATA
 Comment: 
 
-Filename: patato-0.4.0.dist-info/WHEEL
+Filename: patato-0.5.0.dist-info/WHEEL
 Comment: 
 
-Filename: patato-0.4.0.dist-info/entry_points.txt
+Filename: patato-0.5.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: patato-0.4.0.dist-info/top_level.txt
+Filename: patato-0.5.0.dist-info/top_level.txt
 Comment: 
 
-Filename: patato-0.4.0.dist-info/RECORD
+Filename: patato-0.5.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## patato/__init__.py

```diff
@@ -8,52 +8,50 @@
 """
 
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 from os import environ
 from .io.ithera.read_ithera import iTheraMSOT
+from .io.json.json_reading import read_reconstruction_preset, read_unmixing_preset
 from .io.msot_data import PAData
 from .io.simpa.read_simpa import SimpaImporter
 from .recon.backprojection_opencl import OpenCLBackprojection
 from .recon.backprojection_reference import ReferenceBackprojection
 
 from .recon.model_based.model_based import ModelBasedReconstruction
-from .recon.reconstruction_algorithm import ReconstructionAlgorithm
 
-from .processing.jax_preprocessing_algorithm import MSOTPreProcessor
+from .processing.jax_preprocessing_algorithm import PreProcessor
 
 from .unmixing.unmixer import SpectralUnmixer, SO2Calculator, THbCalculator, GasChallengeAnalyser, DCEAnalyser
 from .core.image_structures.reconstruction_image import Reconstruction
 from .core.image_structures.unmixed_image import UnmixedData
 from .core.image_structures.image_sequence import ImageSequence
 from .utils.rois.roi_type import ROI
-from .utils import sort_key
-from .utils.run_pipeline import run_pipeline, run_batch
-from .recon import get_default_recon_preset, get_default_unmixing_preset
-from .io.json.json_reading import read_reconstruction_preset, read_unmixing_preset
 from .core.image_structures.pa_time_data import PATimeSeries
 
 Backprojection = ReferenceBackprojection
 
 # For backwards compatibility:
-DefaultMSOTPreProcessor = MSOTPreProcessor
-GPUMSOTPreProcessor = MSOTPreProcessor
+DefaultMSOTPreProcessor = PreProcessor
+MSOTPreProcessor = PreProcessor
+GPUMSOTPreProcessor = PreProcessor
+
 
 PAT_MAXIMUM_BATCH_SIZE = int(environ.get("PAT_MAXIMUM_BATCH_SIZE", 5))
 
 """ DOCUMENTATION FIX: """
 # To add support for importing to sphinx documentation:
-__all_exports = [MSOTPreProcessor,
+__all_exports = [PreProcessor,
                  Backprojection, OpenCLBackprojection, ModelBasedReconstruction,
                  SpectralUnmixer, SO2Calculator, THbCalculator,
                  GasChallengeAnalyser, DCEAnalyser,
                  PAData,
                  SimpaImporter, iTheraMSOT,
                  Reconstruction, UnmixedData, ImageSequence,
                  ROI,
-                 PATimeSeries]
+                 PATimeSeries, read_reconstruction_preset, read_unmixing_preset]
 
 for e in __all_exports:
     e.__module__ = __name__
 
-__all__ = [e.__name__ for e in __all_exports]
+__all__ = [e.__name__ for e in __all_exports] + ["core", "io", "recon", "unmixing", "processing", "utils", "data"]
```

## patato/convenience_scripts/__init__.py

```diff
@@ -1,9 +1,9 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 """
-PATATO Command Line Interface
-=============================
+PATATO command line interfaces
+==============================
 
 A series of convenience scripts for running the patato package in the command line.
 """
```

## patato/convenience_scripts/copy_rois.py

```diff
@@ -4,20 +4,21 @@
 import argparse
 import glob
 import re
 from os.path import join
 
 import h5py
 import numpy as np
-from .. import sort_key
+from ..utils import sort_key
 
 
 def init_argparse():
     map = {"TRUE": True, "FALSE": False, "T": True, "F": False, "YES": True, "NO": False, "Y": True, "N": False}
-    map_fn = lambda x: map[x.upper()]
+    def map_fn(x):
+        return map[x.upper()]
     parser = argparse.ArgumentParser(description="Copy ROIs between scans made of same thing at same time.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument('-r', '--regex', default=None, type=str, help="Regex for parsing name")
     parser.add_argument('-c', '--copyclose', default=False, type=map_fn, help="Automatically copy over roi to closest "
                                                                               "slice if not exact matches (tolerance "
                                                                               "1mm)")
     parser.add_argument('-d', '--deleteold', default=True, type=map_fn, help="Delete old copies.")
```

## patato/convenience_scripts/draw_roi.py

```diff
@@ -3,25 +3,23 @@
 
 """
 ``patato-draw-roi``: A script to draw regions of interest interactively on datasets..
 """
 
 import argparse
 import glob
-import sys
 from collections import namedtuple
 from os.path import join, split
 
 import matplotlib
 import matplotlib.pyplot as plt
 import numpy as np
 from matplotlib.widgets import Slider, Button, RangeSlider, PolygonSelector
-from .. import ImageSequence
-from .. import ROI, PAData
-from .. import sort_key
+from .. import ImageSequence, ROI, PAData
+from ..utils import sort_key
 from scipy.optimize import least_squares
 
 if matplotlib.get_backend() == "MacOSX":
     matplotlib.use("TkAgg")
 
 from ..utils.roi_operations import ROI_NAMES, REGION_COLOURS, close_loop
 
@@ -478,13 +476,13 @@
         extents = recon.extent
 
         thb = data.get_scan_thb()
 
         if args.drawthb:
             recon = thb[(method, "0")]
 
-        roi_drawerer = ROIDrawer(data, recon, extents, roi_name=args.name, roi_position=args.position,
+        ROIDrawer(data, recon, extents, roi_name=args.name, roi_position=args.position,
                                  interpolation=args.interpolation, draw_all_rois=args.drawallrois, start_wl = wl_i)
 
 
 if __name__ == "__main__":
     main()
```

## patato/convenience_scripts/generate_core.py

```diff
@@ -2,15 +2,15 @@
 #  License: MIT
 
 import argparse
 import glob
 from os.path import split, join
 
 from .. import PAData
-from .. import sort_key
+from ..utils import sort_key
 from ..utils.roi_operations import add_rim_core_data
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="Split regions of interest.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument('name', type=str, help="ROI Name")
```

## patato/convenience_scripts/print_speeds.py

```diff
@@ -2,15 +2,15 @@
 #  License: MIT
 
 import argparse
 import glob
 from os.path import join, split
 
 import h5py
-from .. import sort_key
+from ..utils import sort_key
 from tabulate import tabulate
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="Look at the status of a data folder.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument(
```

## patato/convenience_scripts/process_msot.py

```diff
@@ -8,18 +8,17 @@
 import argparse
 import glob
 import json
 import logging
 import os
 
 from .. import PAData
-from .. import get_default_recon_preset
+from ..recon import get_default_recon_preset
 from .. import read_reconstruction_preset
-from .. import run_pipeline
-from .. import sort_key
+from ..utils import run_pipeline, sort_key
 
 
 def main():
     parser = argparse.ArgumentParser(description="Process MSOT Data.")
     parser.add_argument('input', type=str, help="Data File")
     parser.add_argument('-c', '--speed', type=float, help="Speed of Sound", default=None)
     parser.add_argument('-o', '--output', type=str, help="Output File", default=None)
@@ -53,15 +52,14 @@
     elif os.path.isdir(data_file):
         files = sorted(glob.glob(os.path.join(data_file, "**", "*.hdf5"), recursive=True), key=sort_key)
 
     output_file = args.output
 
     clear_recons = args.clear
     recompute_recon = args.repeat
-    speed_of_sound = args.speed
     run_number = args.run
     if run_number is None:
         run_number = slice(None, None)
     else:
         run_number = slice(run_number, run_number + 1)
     wavelength = args.wavelength
     if wavelength is None:
```

## patato/convenience_scripts/scan_status.py

```diff
@@ -2,15 +2,15 @@
 #  License: MIT
 
 import argparse
 import glob
 from os.path import join
 
 import h5py
-from .. import sort_key
+from ..utils import sort_key
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="Look at the status of a data folder.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument(
         "-v", "--version", action="version",
```

## patato/convenience_scripts/split_rois.py

```diff
@@ -2,15 +2,15 @@
 #  License: MIT
 
 import argparse
 import glob
 from os.path import split, join
 
 from .. import PAData
-from .. import sort_key
+from ..utils import sort_key
 from ..utils.roi_operations import split_roi_left_right
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="Split regions of interest.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument('-n', '--name', type=str, help="ROI Name", default="")
```

## patato/convenience_scripts/tune_speed_of_sound.py

```diff
@@ -9,25 +9,26 @@
 import glob
 import json
 import os
 
 import matplotlib.pyplot as plt
 import numpy as np
 from matplotlib.widgets import Slider, Button, RangeSlider
+
+from patato.recon import get_default_recon_preset
 from .. import PAData
 
 try:
     from pyopencl.array import Array
 except ImportError:
     Array = None
 
-from .. import read_reconstruction_preset
-from .. import MSOTPreProcessor
-from .. import ReconstructionAlgorithm, get_default_recon_preset, OpenCLBackprojection
-from .. import sort_key
+from .. import read_reconstruction_preset, PreProcessor,  OpenCLBackprojection
+from ..recon.reconstruction_algorithm import ReconstructionAlgorithm
+from ..utils import sort_key
 
 
 def main():
     parser = argparse.ArgumentParser(description="Process MSOT Data.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument('c', type=float, help="Speed of Sound")
     parser.add_argument('-p', '--preset', type=str, help="Preset File",
@@ -62,15 +63,14 @@
     scan_number = args.scan
     clear = args.clear
     run_number = args.run
     if run_number is None:
         run_number = 0
 
     # TODO: implement ultrasound threshold overlay
-    us_threshold = args.usthreshold
     log = args.log
 
     files = sorted(glob.glob(os.path.join(data_folder, "**", "*.hdf5"), recursive=True), key=sort_key)
 
     for data_file in files:
         if args.startscan is not None:
             if int(data_file.split("_")[-1].split(".")[0]) < args.startscan:
@@ -88,15 +88,15 @@
             preset = get_default_recon_preset(pa_data)
 
         with open(preset) as json_file:
             settings = json.load(json_file)
 
         pipeline = read_reconstruction_preset(settings)
 
-        preprocessor: MSOTPreProcessor = pipeline
+        preprocessor: PreProcessor = pipeline
         preprocessor.time_factor = 1
         preprocessor.detector_factor = 1
         reconstructor: ReconstructionAlgorithm = pipeline.children[0]
 
         if pa_data.get_speed_of_sound() is not None and not clear:
             continue
         if pa_data.get_speed_of_sound() is not None:
```

## patato/convenience_scripts/unmix.py

```diff
@@ -9,18 +9,17 @@
 import glob
 import json
 import os.path
 from os.path import join
 
 import numpy as np
 from .. import PAData
-from .. import get_default_unmixing_preset
+from ..unmixing import get_default_unmixing_preset
 from .. import read_unmixing_preset
-from .. import run_pipeline
-from .. import sort_key
+from ..utils import run_pipeline, sort_key
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="Process MSOT Data.")
     parser.add_argument('input', type=str, help="Data File")
     parser.add_argument('-w', '--wavelengths', nargs="*", type=float, default=[])
     parser.add_argument('-i', '--wavelengthindices', nargs="*", type=int, default=[])
```

## patato/convenience_scripts/view.py

```diff
@@ -5,15 +5,15 @@
 import glob
 from os.path import join, split
 
 import matplotlib.pyplot as plt
 import numpy as np
 from matplotlib.widgets import Slider, RangeSlider
 from .. import PAData
-from .. import sort_key
+from ..utils import sort_key
 from ..core.image_structures.single_parameter_data import SingleParameterData
 
 
 def init_argparse():
     parser = argparse.ArgumentParser(description="View MSOT Recons.")
     parser.add_argument('input', type=str, help="Data Folder")
     parser.add_argument('-f', '--filter', type=str, help="Choose scan", default=None)
```

## patato/core/__init__.py

```diff
@@ -1,6 +1,10 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 """
-Core datastructures.
+Core datastructures
+===================
+
+Core datastructure for PATATO. This module provides structures such as Reconstruction, UnmixedData etc., providing
+commonly-used functions.
 """
```

## patato/core/image_structures/image_sequence.py

```diff
@@ -153,15 +153,15 @@
 
         if roi_mask is not None:
             if type(roi_mask) is not ROI:
                 try:
                     mask, image_slice = roi_mask[0].to_mask_slice(self)
                     image_slice = image_slice.to_2d()
                     display_image = np.squeeze(image_slice.numpy_array).astype(np.float64)
-                    overall_mask = np.zeros(display_image.shape, dtype=np.bool)
+                    overall_mask = np.zeros(display_image.shape, dtype=bool)
                     for roi in roi_mask:
                         mask, _ = roi.to_mask_slice(self)
                         if mask_roi:
                             overall_mask[np.squeeze(mask)] = True
                     if mask_roi:
                         display_image[~overall_mask] = np.nan
                 except TypeError:
```

## patato/core/image_structures/image_structure_types.py

```diff
@@ -1,19 +1,22 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 from __future__ import annotations
 
-from typing import TypeVar
+from typing import TypeVar, TYPE_CHECKING
 
 from .reconstruction_image import Reconstruction
 from .single_image import SingleImage
 from .single_parameter_data import SingleParameterData
 from .unmixed_image import UnmixedData
 
+if TYPE_CHECKING:
+    from .image_sequence import ImageSequence
+
 T = TypeVar("T", bound="ImageSequence")
 S = TypeVar("S", bound="ImageSequence")
 IMAGE_DATA_TYPES = {"recons": Reconstruction, "unmixed": UnmixedData,
                     "so2": SingleParameterData, "thb": SingleParameterData,
                     "dso2": SingleImage, "dicg": SingleImage,
                     "baseline_so2_sigma": SingleImage, "baseline_so2": SingleImage,
                     "baseline_icg_sigma": SingleImage, "baseline_icg": SingleImage}
```

## patato/core/image_structures/pa_raw_data.py

```diff
@@ -1,25 +1,23 @@
 """
 PA raw data implements the data structure for photoacoustic time series data.
 """
 
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
-from abc import ABC, abstractmethod
+from abc import ABC
 from typing import TYPE_CHECKING
 
-import numpy as np
 
 from ...core.image_structures.image_sequence import DataSequence
 from ...io.attribute_tags import HDF5Tags
 
 if TYPE_CHECKING:
-    from ...core.image_structures.pa_fourier_data import PAFourierDomain
-    from ...core.image_structures.pa_time_data import PATimeSeries
+    pass
 
 
 class PARawData(DataSequence, ABC):
     """
     PARawData is the abstract data structure for time series data. This can be in the pure time series format or the
     fourier way.
     """
@@ -60,30 +58,7 @@
         """
 
         Returns
         -------
 
         """
         return HDF5Tags.WAVELENGTH
-
-    @abstractmethod
-    def to_time_domain(self, from_complex=np.imag) -> "PATimeSeries":
-        """
-
-        Parameters
-        ----------
-        from_complex
-
-        Returns
-        -----------
-        PATimeSeries
-        """
-        pass
-
-    @abstractmethod
-    def to_fourier_domain(self) -> "PAFourierDomain":
-        """
-        Returns
-        -------
-        PAFourierDomain
-        """
-        pass
```

## patato/core/image_structures/pa_time_data.py

```diff
@@ -1,24 +1,20 @@
 """
 pa_time_data. Defines the time-domain version of PARawData class.
 """
 
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
-from typing import TYPE_CHECKING
 
 import numpy as np
-import scipy.fft
 import xarray
 
 from ..image_structures.pa_raw_data import PARawData
 
-if TYPE_CHECKING:
-    from ..image_structures.pa_fourier_data import PAFourierDomain
 
 try:
     from pyopencl.array import Array, to_device
 except ImportError:
     Array = np.ndarray
     to_device = None
 
@@ -48,23 +44,7 @@
         new_data.__array_ufunc__ = None
 
         cls.raw_data = new_data
         return cls
 
     def two_dims(self):
         return "detectors", "timeseries"
-
-    def to_fourier_domain(self) -> "PAFourierDomain":
-        from ...core.image_structures.pa_fourier_data import PAFourierDomain
-        res = self.copy(PAFourierDomain)
-        try:
-            import cupy as cp
-        except ImportError:
-            cp = None
-        if cp is not None and type(self.raw_data) == cp.ndarray:
-            res.raw_data = cp.fft.fft(self.raw_data, axis=-1)
-        else:
-            res.raw_data = scipy.fft.fft(self.raw_data, axis=-1)
-        return res
-
-    def to_time_domain(self, _=None) -> "PATimeSeries":
-        return self
```

## patato/core/image_structures/reconstruction_image.py

```diff
@@ -7,21 +7,22 @@
 
 from __future__ import annotations
 
 import numpy as np
 
 from ...core.image_structures.image_sequence import ImageSequence
 from ...io.attribute_tags import HDF5Tags
-import warnings
 
 
 class Reconstruction(ImageSequence):
-    """Data structure for reconstructed images.
+    """
+    Data structure for reconstructed images.
     """
     save_output = True
+
     @staticmethod
     def is_single_instance():
         return False
 
     @staticmethod
     def get_ax1_label_meaning():
         return HDF5Tags.WAVELENGTH
@@ -29,15 +30,9 @@
     def get_hdf5_group_name(self) -> str:
         return HDF5Tags.RECONSTRUCTION
 
     @property
     def wavelengths(self):
         return np.array(self.ax_1_labels)
 
-    @classmethod
-    def from_numpy(cls, data, wavelength):
-        return cls()
-    
     def __init__(self, *args, **kwargs):
         super().__init__(*args, **kwargs)
-        if "CorrectionFactorApplied" not in self.attributes:
-            warnings.warn("Old version of PATATO used to generate this data. We recommend to re-run the image reconstruction.")
```

## patato/data/__init__.py

```diff
@@ -1,13 +1,21 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 """
-PATATO Data
-===========
+Data examples
+====================
 
-PATATO Data - an interface for exemplar data and basic simulations.
+PATATO data - an interface for exemplar data and basic simulations to illustrate the core features of PATATO.
 """
 
 from .simulated_datasets import get_basic_p0, generate_basic_simulation
 from .get_example_datasets import get_msot_time_series_example, get_ithera_msot_time_series_example, \
     get_msot_phantom_example
+
+__all_exports = [get_msot_time_series_example, get_ithera_msot_time_series_example,
+                 get_msot_phantom_example, get_basic_p0, generate_basic_simulation]
+
+for e in __all_exports:
+    e.__module__ = __name__
+
+__all__ = [e.__name__ for e in __all_exports]
```

## patato/data/get_example_datasets.py

```diff
@@ -8,97 +8,97 @@
 from tqdm.auto import tqdm
 
 import requests
 from patato import iTheraMSOT
 
 from .. import PAData
 
+
 def get_patato_data_folder():
-    """Get the folder where patato data is stored.
+    """Get the folder where PATATO example data is stored.
 
     Returns
     -------
     folder : str
         The folder where patato data is stored.
     """
-    if os.environ.get("PAT_DATA_FOLDER", None) == "TEMP":
+    folder = os.environ.get("PAT_DATA_FOLDER") or "~/patato_example_data"
+
+    if folder == "TEMP":
         os.environ["PAT_DATA_FOLDER"] = mkdtemp()
-    return os.path.expanduser(os.environ.get("PAT_DATA_FOLDER", "~/patato_example_data"))
+        folder = os.environ["PAT_DATA_FOLDER"]
+    return os.path.expanduser(folder)
 
 
 def download_file(file_from, file_to):
-    print(f"Downloading {file_from} to {file_to}... Might take a while.")
-    with requests.get(file_from, stream=True) as file_data:
-        # Get the total file size
-        total_length = int(file_data.headers.get("Content-Length"))
-        # Download the file
-        with tqdm.wrapattr(file_data.raw, "read", total=total_length, desc="") as raw:
-            with open(file_to, "wb") as output:
-                shutil.copyfileobj(raw, output)
+    raise NotImplementedError("No longer able to automatically download data."
+                              "Please download manually from: https://doi.org/10.17863/CAM.93181")
 
 
 def get_msot_time_series_example(image_type="so2"):
     """Get a time series of MSOT images.
 
     Returns
     -------
     dataset : PAData
         The MSOT dataset.
     """
 
-    data_sources = {"so2": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/invivo_oe.hdf5?sequence=6&isAllowed=y",
-                    "icg": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/invivo_dce.hdf5?sequence=7&isAllowed=y"}
+    data_sources = {"so2": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/invivo_oe.hdf5",
+                    "icg": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/invivo_dce.hdf5"}
 
     data_path = os.path.join(get_patato_data_folder(), f'{image_type}-timeseries-data.hdf5')
     folder = os.path.split(data_path)[0]
-    if not os.path.exists(folder):
-        os.mkdir(folder)
+    os.makedirs(folder, exist_ok=True)
     if not os.path.exists(data_path):
         # Download the data
         download_file(data_sources[image_type], data_path)
     return PAData.from_hdf5(data_path)
 
 
 def get_ithera_msot_time_series_example(image_type="so2"):
     """Get a time series of MSOT images in the iThera format.
 
     Returns
     -------
     dataset : PAData
         The MSOT dataset.
     """
-    data_sources = {"so2": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/ithera_invivo_oe.zip?sequence=4&isAllowed=y",
-                    "icg": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/ithera_invivo_dce.zip?sequence=5&isAllowed=y"}
+    import glob
+    print(glob.glob(get_patato_data_folder() + "/*"))
+    data_sources = {"so2": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/ithera_invivo_oe.zip",
+                    "icg": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/ithera_invivo_dce.zip"}
 
     data_path = os.path.join(get_patato_data_folder(), f'{image_type}-ithera_data')
     filenames = {"so2": "Scan_9", "icg": "Scan_10"}
     folder = os.path.split(data_path)[0]
     if folder and not os.path.exists(folder):
-        os.mkdir(folder)
+        os.makedirs(folder, exist_ok=True)
     if not os.path.exists(data_path):
         # Download the data
-        zip_file = os.path.join(mkdtemp(), "patato_temp.zip")
+        zip_file = os.path.join(get_patato_data_folder(), "patato_temp.zip")
         download_file(data_sources[image_type], zip_file)
         with zipfile.ZipFile(zip_file, 'r') as zip_ref:
             zip_ref.extractall(data_path)
+        print(f"Extracted data to {data_path}")
     return PAData(iTheraMSOT(os.path.join(data_path, filenames[image_type])))
 
 
 def get_msot_phantom_example(image_type="clinical"):
     """Get a time series of MSOT images.
 
     Returns
     -------
     dataset : PAData
         The MSOT dataset.
     """
-    data_sources = {"clinical": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/clinical_phantom.hdf5?sequence=8&isAllowed=y",
-                    "preclinical": "hhttps://www.repository.cam.ac.uk/bitstream/handle/1810/345836/preclinical_phantom.hdf5?sequence=3&isAllowed=y"}
+    data_sources = {"clinical": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/clinical_phantom.hdf5",
+                    "preclinical": "https://www.repository.cam.ac.uk/bitstream/handle/1810/345836/preclinical_phantom.hdf5"}
 
     data_path = os.path.join(get_patato_data_folder(), f'{image_type}-msot-data.hdf5')
     folder = os.path.split(data_path)[0]
     if not os.path.exists(folder):
-        os.mkdir(folder)
+        os.makedirs(folder, exist_ok=True)
     if not os.path.exists(data_path):
         # Download the data
         download_file(data_sources[image_type], data_path)
     return PAData.from_hdf5(data_path)
```

## patato/io/__init__.py

```diff
@@ -1,5 +1,9 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
-# from .hdf5_converter import convert_ithera_msot_binary_to_hdf5
-#
+"""
+Input/output module
+==========================
+
+I/O module for patato. Provides interfaces to HDF5 format, simpa and iThera.
+"""
```

## patato/io/msot_data.py

```diff
@@ -8,15 +8,14 @@
 
 import h5py
 import numpy as np
 import xarray
 
 from .hdf.fileimporter import ReaderInterface, WriterInterface
 from .hdf.hdf5_interface import HDF5Reader, HDF5Writer
-from ..core.image_structures.pa_fourier_data import PAFourierDomain
 from ..core.image_structures.pa_time_data import PATimeSeries
 from ..core.image_structures.single_image import SingleImage
 from ..core.image_structures.single_parameter_data import SingleParameterData
 from ..utils.roi_operations import get_rim_core_rois
 from ..utils.rois.roi_type import ROI
 
 if TYPE_CHECKING:
@@ -480,32 +479,15 @@
         """
 
         Returns
         -------
 
         """
         dataset = self.scan_reader.get_pa_data()
-        if type(dataset) is PAFourierDomain:
-            return dataset.to_time_domain()
-        elif type(dataset) is not PATimeSeries:
-            raise ValueError("raw_data attribute must be either TimeSeries or FourierDomain type.")
-        else:
-            return dataset
-
-    def get_fft(self) -> PAFourierDomain:
-        """
-
-        Returns
-        -------
-
-        """
-        dataset = self.scan_reader.get_pa_data()
-        if type(dataset) is PATimeSeries:
-            return dataset.to_fourier_domain()
-        elif not type(dataset) is PAFourierDomain:
+        if type(dataset) is not PATimeSeries:
             raise ValueError("raw_data attribute must be either TimeSeries or FourierDomain type.")
         else:
             return dataset
 
     def get_recon_types(self) -> list:
         """
         Get the list of different reconstruction types.
```

## patato/io/hdf/fileimporter.py

```diff
@@ -11,14 +11,16 @@
 import numpy as np
 
 from ...core.image_structures.pa_time_data import PATimeSeries
 from ...utils.mask_operations import interpolate_rois
 
 
 def slice_1d(data, test_data, slices, dim=-1):
+    if data is None:
+        return None
     def slice_wl(slice_data, item, wl_axis):
         if wl_axis == 0 and type(item) is not tuple:
             r = slice_data[item]
         elif type(item) is not tuple:
             r = slice_data
         else:
             if len(item) > wl_axis:
@@ -300,15 +302,16 @@
         self.set_temperature(reader.get_temperature())
         self.set_correction_factor(reader.get_correction_factor())
         self.set_scanner_z_position(reader.get_scanner_z_position())
         self.set_run_numbers(reader.get_run_numbers())
         self.set_repetition_numbers(reader.get_repetition_numbers())
         self.set_scan_times(reader.get_scan_times())
         self.set_sensor_geometry(reader.get_sensor_geometry())
-        if reader.get_us_data() is not None:
+        if reader.get_us_data()[0] is not None:
+            print(reader.get_us_data())
             self.set_us_data(*reader.get_us_data())  # TODO: implement us data as a image data type.
         self.set_impulse_response(reader.get_impulse_response())
         self.set_wavelengths(reader.get_wavelengths())
         self.set_us_offsets(reader.get_us_offsets())
         self.set_water_absorption(*reader.get_water_absorption())
         if reader.get_datasets() is not None:
             for _, image_group in reader.get_datasets().items():
```

## patato/io/hdf/hdf5_interface.py

```diff
@@ -93,15 +93,15 @@
         self.overwrite = False  # TODO: implement this.
 
     def set_scan_datetime(self, datetime):
         self.file.attrs[HDF5Tags.DATE] = str(datetime)
 
     def set_pa_data(self, raw_data):
         if type(raw_data) == PATimeSeries:
-            raw_data = raw_data.da
+            raw_data = raw_data.raw_data
         if raw_data is None:
             return
         self.file.create_dataset(HDF5Tags.RAW_DATA, data=raw_data)
 
     def set_scan_name(self, scan_name: str):
         self.file.attrs[HDF5Tags.SCAN_NAME] = scan_name
         self.file[HDF5Tags.RAW_DATA].attrs[HDF5Tags.SCAN_NAME] = scan_name
```

## patato/io/ipasc/ipasc_export.py

```diff
@@ -1,22 +1,19 @@
-#  Copyright (c) Thomas Else 2023.
-#  License: MIT
-
 import numpy as np
 import pacfish as pf
 from pacfish import MetaDatum
 
 
-class TomHDF5AdapterToIPASCFormat(pf.BaseAdapter):
+class PatHDF5AdapterToIPASCFormat(pf.BaseAdapter):
     def generate_device_meta_data(self) -> dict:
         return {}
 
     def __init__(self, hdf5_file):
         self.hdf5_file = hdf5_file
-        super(TomHDF5AdapterToIPASCFormat, self).__init__()
+        super(PatHDF5AdapterToIPASCFormat, self).__init__()
 
     def generate_binary_data(self) -> np.ndarray:
         # iThera definition: [frames, wavelengths, detectors, time_series]
         # IPASC definition: [detectors, time_series, wavelength, frames]
         time_series = self.hdf5_file["raw_data"]
         time_series = np.swapaxes(time_series, 2, 0)  # [detectors, wavelengths, frames, time_series]
         time_series = np.swapaxes(time_series, 3, 1)  # [detectors, time_series, frames, wavelength]
@@ -45,9 +42,7 @@
 
             return np.asarray(poses).reshape((orig_shape[0], orig_shape[1], -1))
         if metadata_tag == pf.MetadataAcquisitionTags.MEASUREMENT_TIMESTAMPS:
             return np.asarray(self.hdf5_file["timestamp"])
         if metadata_tag == pf.MetadataAcquisitionTags.ACQUISITION_WAVELENGTHS:
             return np.asarray(self.hdf5_file["wavelengths"])
         return None
-
-
```

## patato/io/ipasc/read_ipasc.py

```diff
@@ -5,15 +5,16 @@
 from os.path import split
 import pacfish as pf
 import numpy as np
 from ..hdf.fileimporter import ReaderInterface
 
 
 class IPASCInterface(ReaderInterface):
-    """An interface for iThera MSOT datasets.
+    """
+    An interface for iThera MSOT datasets.
     """
     def _get_rois(self):
         pass
 
     def _get_segmentation(self):
         return None
```

## patato/io/json/json_reading.py

```diff
@@ -67,15 +67,14 @@
     number_of_pixels_z = settings.get(ReconAttributeTags.Z_NUMBER_OF_PIXELS, 1)
 
     # Number of pixels x and y
     reconstruction_algorithm = RECONSTRUCTION_NAMES[settings[ReconAttributeTags.RECONSTRUCTION_ALGORITHM]]
 
     # Whether to do universal backprojection.
     ubp = settings.get("UBP", False)
-    print("Doing ubp?", ubp)
     step_1 = preprocessing_algorithm(time_factor=time_interpolation_factor,
                                      detector_factor=detector_interpolation_factor,
                                      irf=correct_for_impulse_response,
                                      hilbert=do_hilbert_transform,
                                      lp_filter=filter_lowpass,
                                      hp_filter=filter_highpass,
                                      filter_window_size=window_size,
```

## patato/processing/__init__.py

```diff
@@ -1,3 +1,10 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
+"""
+Time-series data processing module
+=========================================
+
+This module provides functions for commonly-used pre-processing procedures used in photoacoustic imaging.
+This includes, for example, band-pass filtering, Hilbert transforms and interpolation.
+"""
```

## patato/processing/gpu_preprocessing_algorithm.py

```diff
@@ -1,20 +1,18 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 from __future__ import annotations
 
 from typing import Union, TYPE_CHECKING, Tuple, Optional
 
-from .preprocessing_algorithm import DefaultMSOTPreProcessor
-from .processing_algorithm import ProcessingResult
+from .processing_algorithm import ProcessingResult, TimeSeriesProcessingAlgorithm
 
 if TYPE_CHECKING:
     from ..io.msot_data import PAData
-    from ..core.image_structures.pa_raw_data import PARawData
 
 from ..core.image_structures.pa_time_data import PATimeSeries
 
 try:
     import cupy as cp
     from cupy.fft import fft, ifft, fftshift, fftfreq
 except ImportError:
@@ -22,15 +20,15 @@
 
 from ..io.attribute_tags import PreprocessingAttributeTags
 import time
 from patato.unmixing.spectra import SPECTRA_NAMES
 import logging
 
 
-class GPUMSOTPreProcessor(DefaultMSOTPreProcessor):
+class GPUMSOTPreProcessor(TimeSeriesProcessingAlgorithm):
     @staticmethod
     def get_algorithm_name() -> str:
         return "GPU Standard Preprocessor"
 
     @staticmethod
     def get_hdf5_group_name() -> Union[str, None]:
         return None
@@ -114,19 +112,21 @@
         t = time.time()
         raw_data = cp.array(time_series.raw_data)
         time_series.raw_data = raw_data - cp.mean(raw_data, axis=-1)[extend]
         logging.debug(f"Mean subtraction took {time.time() - t}s")
         # Apply a fourier domain filter.
 
         t = time.time()
-        time_series = time_series.to_fourier_domain()
-        time_series = self.apply_filter(time_series, ft_filter=ft_filter, absolute=self.absolute)
+        time_series_ft = fft(time_series.raw_data, axis=-1)
+        time_series_ft = self.apply_filter(time_series_ft, ft_filter=ft_filter)
+
+        operation = cp.real if self.absolute == "real" or self.absolute is None else cp.imag if self.absolute == "imag" else cp.abs
+        time_series.raw_data = operation(ifft(time_series_ft, axis=-1))
 
         # Go back to the time domain.
-        time_series = time_series.to_time_domain()
         logging.debug(f"Filter took {time.time() - t}s")
 
         # Apply interpolation in time and detector domains.
         time_series, interp_params = self.interpolate(time_series, detectors)
         new_parameters.update(interp_params)
 
         # Apply energy correction factor
@@ -156,15 +156,15 @@
         # Get the new indices on which to interpolate.
         detector_ind = cp.arange(detectors.shape[0])
         new_detector_ind = cp.arange((detectors.shape[0] - 1) * self.detector_factor + 1) / self.detector_factor
         if exact_ratios:
             new_detector_ind = cp.linspace(0, detectors.shape[0] - 1, self.detector_factor * detectors.shape[0])
 
         # Interpolate in the sample domain
-        sample_ind = cp.arange(signal.shape[-1])
+        cp.arange(signal.shape[-1])
         new_samp_ind = cp.arange((signal.shape[-1] - 1) * self.time_factor + 1) / self.time_factor
         if exact_ratios:
             new_samp_ind = cp.linspace(0, signal.shape[-1] - 1, self.time_factor * signal.shape[-1])
 
         new_signal = cp.zeros(signal.shape[:-2] + (new_detector_ind.shape[0], new_samp_ind.shape[0]),
                               dtype=signal.dtype)
         t = time.time()
@@ -192,21 +192,18 @@
         attributes = dict(time_series.da.attrs)
         attributes["fs"] *= self.time_factor
 
         new_data = PATimeSeries(new_signal, time_series.da.dims, coords, attributes=attributes)
         return new_data, {"geometry": detectors.get()}
 
     @staticmethod
-    def apply_filter(pa_data: PARawData, ft_filter, absolute=False) -> PATimeSeries:
-        pa_fft = pa_data.to_fourier_domain()
-        extend = (None,) * (pa_fft.raw_data.ndim - 1) + (slice(None, None),)
-        pa_fft.raw_data *= ft_filter[extend]
-        operation = cp.real if absolute == "real" or absolute is None else cp.imag if absolute == "imag" else cp.abs
-        pa_time = pa_fft.to_time_domain(operation)
-        return pa_time
+    def apply_filter(pa_data: cp.ndarray, ft_filter) -> cp.ndarray:
+        extend = (None,) * (pa_data.ndim - 1) + (slice(None, None),)
+        pa_data *= ft_filter[extend]
+        return pa_data
 
     @staticmethod
     def make_filter(n_samples, fs, irf,
                     hilbert, lp_filter,
                     hp_filter, rise=0.2,
                     n_filter=1024, window=None) -> cp.ndarray:
         # at the moment, it looks like it is shifting the data a bit??
```

## patato/processing/jax_preprocessing_algorithm.py

```diff
@@ -117,28 +117,27 @@
     filter_time[-n_filter // 2:] = time_series[-n_filter // 2:]
 
     filter_output = np.fft.fft(filter_time)
     output *= filter_output
     return output
 
 
-class MSOTPreProcessor(TimeSeriesProcessingAlgorithm):
+class PreProcessor(TimeSeriesProcessingAlgorithm):
     """ Preprocesses MSOT time series data. Uses JAX in the background.
     """
 
     @staticmethod
     def get_algorithm_name() -> Union[str, None]:
         """
         Get the name of the algorithm.
 
         Returns
         -------
         str or None
         """
-        # Return the name of the algorithm
         return "Standard Preprocessor"
 
     @staticmethod
     def get_hdf5_group_name() -> Union[str, None]:
         """
         Return the name of the group in the HDF5 file
```

## patato/processing/preprocessing_algorithm.py

```diff
@@ -7,32 +7,46 @@
 
 import numpy as np
 
 from .processing_algorithm import TimeSeriesProcessingAlgorithm, ProcessingResult
 
 if TYPE_CHECKING:
     from ..io.msot_data import PAData
-    from ..core.image_structures.pa_raw_data import PARawData
 
 from ..core.image_structures.pa_time_data import PATimeSeries
 
 from scipy.fft import fft, ifft, fftshift, fftfreq
 
 from ..io.attribute_tags import PreprocessingAttributeTags
 
 from patato.unmixing.spectra import SPECTRA_NAMES
 
 
-class DefaultMSOTPreProcessor(TimeSeriesProcessingAlgorithm):
+class NumpyPreProcessor(TimeSeriesProcessingAlgorithm):
     @staticmethod
     def get_algorithm_name() -> str:
+        """
+        Get the name of the algorithm.
+
+        Returns
+        -------
+        str or None
+        """
         return "CPU Standard Preprocessor"
 
     @staticmethod
     def get_hdf5_group_name() -> Union[str, None]:
+        """
+        Return the name of the group in the HDF5 file
+
+        Returns
+        -------
+        str or None
+
+        """
         return None
 
     def __init__(self, time_factor=3, detector_factor=2,
                  irf=True, hilbert=True, lp_filter=None,
                  hp_filter=None, filter_window_size=512,
                  window: Union[str, None] = "hann", absolute: Union[bool, str] = None,
                  couplant_correction=None, couplant_path_length=0):
@@ -103,19 +117,21 @@
         extend = (slice(None, None),) * (time_series.raw_data.ndim - 1) + (None,)
 
         # Subtract mean
         raw_data = np.array(time_series.raw_data)
         time_series.raw_data = raw_data - np.mean(raw_data, axis=-1)[extend]
 
         # Apply a fourier domain filter.
-        time_series = time_series.to_fourier_domain()
-        time_series = self.apply_filter(time_series, ft_filter=ft_filter, absolute=self.absolute)
+        time_series_ft = fft(time_series.raw_data, axis=-1)
+        time_series_ft = self.apply_filter(time_series_ft, ft_filter=ft_filter)
 
         # Go back to the time domain.
-        time_series = time_series.to_time_domain()
+        operation = np.real if self.absolute == "real" or self.absolute is None else np.imag if self.absolute == "imag" else np.abs
+        time_series_td = operation(ifft(time_series_ft, axis=-1))
+        time_series.raw_data = time_series_td
 
         # Apply interpolation in time and detector domains.
         time_series, interp_params = self.interpolate(time_series, detectors)
         new_parameters.update(interp_params)
 
         # Apply energy correction factor
         extend = (slice(None, None),) * overall_correction_factor.ndim + (None, None)
@@ -161,21 +177,18 @@
         attributes = dict(time_series.da.attrs)
         attributes["fs"] *= self.time_factor
 
         new_data = PATimeSeries(signal.copy(), time_series.da.dims, coords, attributes=attributes)
         return new_data, {"geometry": detectors}
 
     @staticmethod
-    def apply_filter(pa_data: PARawData, ft_filter, absolute=False) -> PATimeSeries:
-        pa_fft = pa_data.to_fourier_domain()
-        extend = (None,) * (pa_fft.raw_data.ndim - 1) + (slice(None, None),)
-        pa_fft.raw_data *= ft_filter[extend]
-        operation = np.real if absolute == "real" or absolute is None else np.imag if absolute == "imag" else np.abs
-        pa_time = pa_fft.to_time_domain(operation)
-        return pa_time
+    def apply_filter(pa_data: np.ndarray, ft_filter) -> np.ndarray:
+        extend = (None,) * (pa_data.ndim - 1) + (slice(None, None),)
+        pa_data *= ft_filter[extend]
+        return pa_data
 
     @staticmethod
     def make_filter(n_samples, fs, irf,
                     hilbert, lp_filter,
                     hp_filter, rise=0.2,
                     n_filter=1024, window=None) -> np.ndarray:
         # at the moment, it looks like it is shifting the data a bit??
```

## patato/processing/preprocessing_types.py

```diff
@@ -1,15 +1,16 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 from typing import Sequence
 
 from .gpu_preprocessing_algorithm import GPUMSOTPreProcessor
-from .preprocessing_algorithm import DefaultMSOTPreProcessor
-from .jax_preprocessing_algorithm import MSOTPreProcessor
+from .preprocessing_algorithm import NumpyPreProcessor
+from .jax_preprocessing_algorithm import PreProcessor
+from .processing_algorithm import TimeSeriesProcessingAlgorithm
 
-# TODO: Change the type definition here (need to generalise the preprocessing method a bit better)
 
-PREPROCESSING_METHODS: Sequence[type(DefaultMSOTPreProcessor)] = [DefaultMSOTPreProcessor, GPUMSOTPreProcessor,
-                                                                  MSOTPreProcessor]
+PREPROCESSING_METHODS: Sequence[type(TimeSeriesProcessingAlgorithm)] = [NumpyPreProcessor,
+                                                                        GPUMSOTPreProcessor,
+                                                                        PreProcessor]
 
 PREPROCESSING_NAMES = {x.get_algorithm_name(): x for x in PREPROCESSING_METHODS}
```

## patato/recon/__init__.py

```diff
@@ -1,19 +1,28 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
+"""
+Reconstruction module
+============================
+
+This module provides functions for reconstructing photoacoustic data.
+"""
+
 from typing import Sequence
 
 from .backprojection_opencl import OpenCLBackprojection
 from .backprojection_reference import ReferenceBackprojection
 from .reconstruction_algorithm import ReconstructionAlgorithm
+from .numpy_backprojection.recon import SlowBackprojection
 from ..io.msot_data import PAData
 
 RECONSTRUCTION_METHODS: Sequence[type(ReconstructionAlgorithm)] = [OpenCLBackprojection,
-                                                                   ReferenceBackprojection]
+                                                                   ReferenceBackprojection,
+                                                                   SlowBackprojection]
 
 RECONSTRUCTION_NAMES = {x.get_algorithm_name(): x for x in RECONSTRUCTION_METHODS}
 
 
 def get_default_recon_preset(data: PAData):
     """
 
@@ -47,19 +56,7 @@
     axes = ""
     for i in range(3):
         if not np.all(np.isclose(data.get_scan_geometry()[:, i],  data.get_scan_geometry()[0, i])):
             axes += "xyz"[i]
 
     preset += "_" + axes
     return os.path.join(root_folder, preset + ".json")
-
-
-def get_default_unmixing_preset():
-    """
-
-    Returns
-    -------
-
-    """
-    import os
-    root_folder = os.path.join(os.path.dirname(os.path.realpath(__file__)), "../unmixing/unmix_presets")
-    return os.path.join(root_folder, "haemoglobin.json")
```

## patato/recon/backprojection_opencl.py

```diff
@@ -29,22 +29,24 @@
         signal = signal.copy()
         logging.warning("Warning: order of signal is not C_CONTIGUOUS, this might hinder performance.")
     if not (type(fs) == float or type(fs) in [np.float64, np.float32]):
         fs = float(fs)
     if not detectors.flags["C_CONTIGUOUS"]:
         detectors = detectors.copy()
     assert type(n_pixels[0]) in [int, np.int32]
-    assert type(field_of_view[0]) in [float, np.float32, np.float64]
-    if not (type(speed_of_sound) in [float, np.float32, np.float64]):
+    field_of_view = tuple(float(x) for x in field_of_view)
+    if type(speed_of_sound) not in [float, np.float32, np.float64]:
         speed_of_sound = float(speed_of_sound)
     return signal, fs, detectors, n_pixels, field_of_view, speed_of_sound
 
 
 class OpenCLBackprojection(ReconstructionAlgorithm):
     """
+    An OpenCL implemntation of the photoacoustic backprojection.
+
     Note: this class will be deprecated in future. It is maintained for backwards compatibility with non-nvidia
     GPUs.
     """
     def __init__(self,
                  n_pixels: Sequence[int],
                  field_of_view: Sequence[float],
                  **kwargs):
```

## patato/recon/backprojection_reference.py

```diff
@@ -7,15 +7,17 @@
 
 from .backprojection_implementation.jax_implementation import full_recon
 from .reconstruction_algorithm import ReconstructionAlgorithm
 
 try:
     import jax
 except ImportError:
-    print("WARNING: JAX must be installed to support the standard backprojection algorithm and filtering.")
+    print("""WARNING: JAX must be installed to support the standard backprojection algorithm and filtering.
+    Alternatively, try the Numpy implementations.
+    """)
     jax = None
 
 
 class ReferenceBackprojection(ReconstructionAlgorithm):
     """
     Reference backprojection: Uses JAX in the background.
     """
@@ -46,15 +48,14 @@
         # Get parameters:
         dl = speed_of_sound / fs
 
         # Reshape frames so that we can loop through to reconstruct
         original_shape = time_series.shape[:-2]
         frames = int(np.product(original_shape))
         signal = time_series.reshape((frames,) + time_series.shape[-2:])
-
         dx = field_of_view[0] / (n_pixels[0] - 1) if n_pixels[0] != 1 else 0
         dy = field_of_view[1] / (n_pixels[1] - 1) if n_pixels[1] != 1 else 0
         dz = field_of_view[2] / (n_pixels[2] - 1) if n_pixels[2] != 1 else 0
 
         recon_all = jax.vmap(full_recon, in_axes=(0,) + (None,) * 8, out_axes=0)
 
         output = recon_all(signal, geometry, dl, n_pixels[0], n_pixels[1], n_pixels[2],
```

## patato/recon/model_based/model_based.py

```diff
@@ -5,19 +5,22 @@
 
 import numpy as np
 import pylops
 from pylops.optimization.leastsquares import regularized_inversion
 from pylops.signalprocessing import Convolve1D, Convolve2D
 from scipy.sparse.linalg import LinearOperator as CPULinOp
 
+import warnings
+
 from .cuda_implementation import get_model as get_model_gpu_single_c
 from .cuda_implementation_refraction import get_model as get_model_gpu_double_c
-from .numpy_implementation import generate_model as get_model_cpu_single_c
+from .numpy_implementation import get_model as get_model_cpu_single_c
 from .. import ReconstructionAlgorithm
 from ...core.image_structures.pa_time_data import PATimeSeries
+from ... import PAData
 
 try:
     cuda_enabled = True
     from cupyx.scipy.sparse.linalg import LinearOperator as GPULinOp
     import cupy as cp
 except:
     cuda_enabled = False
@@ -48,15 +51,15 @@
         """
         if gpu:
             get_model_single_c = get_model_gpu_single_c
             get_model_double_c = get_model_gpu_double_c
             LinearOperator = GPULinOp
         else:
             get_model_double_c = get_model_cpu_single_c
-            get_model_single_c = get_model_gpu_single_c
+            get_model_single_c = get_model_cpu_single_c
             LinearOperator = CPULinOp
         model_type = self.custom_params.get("model_type", "single_sos")
         regulariser = self.custom_params.get("regulariser", self.custom_params.get("regularizer", None))
         if regulariser not in ["identity", "laplacian", "TV"]:
             raise ValueError("Invalid regulariser.")
         reg_lambda = self.custom_params.get("reg_lambda", 1)
         iter_lim = self.custom_params.get("iter_lim", 10)
@@ -75,19 +78,21 @@
                                               y_cutoff, dx, nx, x_0, nt, cache=cache)
         else:
             raise NotImplementedError(f"Model {model_type} is unavailable.")
         self._raw_model = model_matrix
         # Force dodgy duck typing to enable product with irf convolution.
         model_matrix.matvec = lambda x: None
 
-        irf = kwargs.get("irf_model", None) or self.custom_params.get("irf_model")
+        irf = kwargs.get("irf_model", None)
+        if irf is None:
+            irf = self.custom_params.get("irf_model", None)
 
         ndet = detx.shape[0]
         if irf is not None:
-            convolve_irf = Convolve1D(nt * ndet, irf, dims=(ndet, nt), dir=1, offset=nt // 2,
+            convolve_irf = Convolve1D((ndet, nt), irf, axis=1, offset=nt // 2,
                                       dtype=np.float32)
 
             def matvec(x):
                 return convolve_irf @ (model_matrix @ x)
 
             def rmatvec(x):
                 z = convolve_irf.H @ x
@@ -133,49 +138,60 @@
         if regulariser in ["identity", "laplacian"]:
             if gpu:
                 inv_args["niter"] = iter_lim
                 inv_args["tol"] = 1e-6
             else:
                 inv_args["iter_lim"] = iter_lim
             return lambda y: regularized_inversion(full_model, y,
-                                                   [reg], epsRs=[reg_lambda], show=True, **inv_args)[0]
+                                                   [reg], epsRs=[reg_lambda], show=False, **inv_args)[0]
         else:
             self._full_model = full_model
             self._reg = reg
             self._niter_outer = iter_lim[0]
             self._niter_inner = iter_lim[1]
             self._epsRL1s = [reg_lambda[0], reg_lambda[0]]
             self._inv_args = inv_args
             return lambda y: pylops.optimization.sparsity.splitbregman(
                 full_model,
                 y,
                 reg,
                 niter_outer=iter_lim[0],
                 niter_inner=iter_lim[1],
                 epsRL1s=[reg_lambda[0], reg_lambda[0]],
-                show=True, **inv_args
+                show=False, **inv_args
             )[0]
 
     def __init__(self,
                  n_pixels: Sequence[int],
                  field_of_view: Sequence[float],
                  kwargs_model=None,
+                 pa_example: "PAData"=None,
                  **kwargs):
+        if kwargs.get("regulariser", None) is None:
+            kwargs["regulariser"] = "identity"
         super().__init__(n_pixels, field_of_view, **kwargs)
         self._model_matrix = None
         self._raw_model = None
         if kwargs_model is None:
             kwargs_model = {}
+
+        if pa_example is not None:
+            kwargs["geometry"] = pa_example.get_scan_geometry()
+            kwargs["fs_model"] = pa_example.get_sampling_frequency()
+            kwargs["nt"] = pa_example.get_time_series().shape[-1]
+            kwargs_model["c"] = pa_example.get_speed_of_sound()
+            kwargs_model["irf_model"] = pa_example.get_impulse_response()[:]
+
         # Note that super init puts kwargs in self.custom_params
-        if "detectors" in kwargs:
+        if "geometry" in kwargs:
             # identify x and y:
-            detectors = kwargs["detectors"]
+            detectors = kwargs["geometry"]
             indices = []
             for i in range(3):
-                if np.all(kwargs["detectors"][:, i] != 0.):
+                if np.all(kwargs["geometry"][:, i] != 0.):
                     indices.append(i)
             self._indices = indices
 
             detx = detectors[:, indices[0]]
             dety = detectors[:, indices[1]]
 
             fs = kwargs["fs_model"]
@@ -195,14 +211,16 @@
         else:
             self._fs = None
             self._nx = None
             self._dx = None
             self._x_0 = None
             self._model = None
             self._indices = None
+        warnings.warn("This class is experimental. If you would like to contribute to further development of this "
+                      "approach, please get in touch.")
 
     def pre_prepare_data(self, x: PATimeSeries):
         """
 
         Parameters
         ----------
         x
@@ -240,16 +258,18 @@
             dx = self._dx
             x_0 = self._x_0
             indices = self._indices
         else:
             detectors = geometry
             indices = []
             for i in range(3):
-                if np.all(kwargs["detectors"][:, i] != 0.):
+                if np.all(kwargs["geometry"][:, i] != 0.):
                     indices.append(i)
+
+            assert len(indices) == 2
             detx = detectors[:, indices[0]]
             dety = detectors[:, indices[1]]
 
             do_irf = self.custom_params.get("do_irf", True)
             irf = kwargs["irf"] if do_irf else None
 
             nx = n_pixels[indices[0]]
@@ -265,27 +285,28 @@
             t = np.array(signal)
 
         or_shape = t.shape
 
         output_shape = [1, 1, 1]
         for i in indices:
             output_shape[i] = nx
-        output_shape = tuple(output_shape)
+        # Reverse output shape to be (z, y, x) order
+        output_shape = tuple(output_shape[::-1])
 
         t = t.reshape((np.product(t.shape[:-2]),) + t.shape[-2:])
         output = np.zeros((t.shape[0],) + output_shape)
 
         for i, t0 in enumerate(t):
             result = model(t0.flatten()).reshape(output_shape)
             if gpu:
                 output[i] = result.get()
             else:
                 output[i] = result
 
-        return output.reshape(or_shape[:2] + output.shape[-3:])
+        return output.reshape(or_shape[:-2] + output.shape[-3:])
 
     @staticmethod
     def get_algorithm_name() -> str:
         """
 
         Returns
         -------
```

## patato/recon/model_based/numpy_implementation.py

```diff
@@ -2,15 +2,15 @@
 #  License: MIT
 
 import numpy as np
 from scipy.sparse import csr_matrix, vstack
 
 from os.path import join, exists, dirname
 from .generate_model import calculate_element
-from tqdm import tqdm
+from tqdm.auto import tqdm
 
 
 def get_hash(*x):
     to_hash = []
     for y in x:
         if type(y) == np.ndarray:
             y = tuple(y.flatten())
```

## patato/unmixing/__init__.py

```diff
@@ -1,3 +1,22 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
+"""
+Unmixing module
+======================
+
+This module provides functions for commonly-used spectral analysis procedures in photoacoustic imaging.
+Additionally, the module provides commonly-used spectra for chromophores in biological tissue.
+"""
+
+
+def get_default_unmixing_preset():
+    """
+
+    Returns
+    -------
+
+    """
+    import os
+    root_folder = os.path.join(os.path.dirname(os.path.realpath(__file__)), "../unmixing/unmix_presets")
+    return os.path.join(root_folder, "haemoglobin.json")
```

## patato/useful_utilities/__init__.py

```diff
@@ -1,10 +1,18 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
+"""
+Useful utilities module
+==============================
+
+This module provides miscellaneous functions and classes that are useful for PATATO.
+They are largely independent of the other modules and minimally documented.
+"""
+
 from typing import Optional
 
 import numpy as np
 import pandas as pd
 
 from ..utils.process_study import get_hdf5_files
```

## patato/utils/__init__.py

```diff
@@ -1,10 +1,17 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
+"""
+Utility module
+=====================
+
+This module provides utility functions for PATATO that are used in several other modules.
+"""
+
 from os.path import split
 from typing import Tuple
 
 
 def sort_key(file: str) -> Tuple[int, str]:
     """
```

## patato/utils/roi_operations.py

```diff
@@ -4,20 +4,21 @@
 from collections import defaultdict
 from typing import TYPE_CHECKING, Tuple
 
 import numpy as np
 
 if TYPE_CHECKING:
     from ..io.msot_data import PAData
+    from .rois.roi_type import ROI
 
 from seaborn.palettes import color_palette
 
 
 def split_roi_left_right(data: "PAData", base_roi="", split_template="unnamed"):
-    from ..io.msot_data import ROI
+    from .rois.roi_type import ROI
     # Initial implementation - only supports one "dividing" roi.
     data_rois = data.get_rois()
 
     template_data = None
     names = None
     if (split_template + "_left", "0") in data_rois:
         template_data = data_rois[(split_template + "_left", "0")]
```

## Comparing `patato/recon/numpy/recon.py` & `patato/recon/numpy_backprojection/recon.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,21 +1,20 @@
 #  Copyright (c) Thomas Else 2023.
 #  License: MIT
 
 from typing import Sequence
 
-import matplotlib.pyplot as plt
 import numpy as np
-import patato as pat
-from patato.data import get_msot_time_series_example
+from .. import ReconstructionAlgorithm
 
 # Add a loading bar
-from tqdm.notebook import tqdm
+from tqdm.auto import tqdm
 
-class SlowBackprojection(pat.ReconstructionAlgorithm):
+
+class SlowBackprojection(ReconstructionAlgorithm):
     """
     Slow example backprojection.
     """
 
     def reconstruct(self, time_series: np.ndarray,
                     fs: float,
                     geometry: np.ndarray, n_pixels: Sequence[int],
@@ -53,18 +52,21 @@
         dl = speed_of_sound / fs
 
         # Reshape frames so that we can loop through to reconstruct
         original_shape = time_series.shape[:-2]
         frames = int(np.product(original_shape))
         signal = time_series.reshape((frames,) + time_series.shape[-2:])
 
-        xs, ys, zs = [np.linspace(-field_of_view[i]/2, field_of_view[i]/2, n_pixels[i]) if n_pixels[i] != 1 else np.array([0.]) for i in range(3)]
+        xs, ys, zs = [
+            np.linspace(-field_of_view[i] / 2, field_of_view[i] / 2, n_pixels[i]) if n_pixels[i] != 1 else np.array(
+                [0.]) for i in range(3)]
         Z, Y, X = np.meshgrid(zs, ys, xs, indexing='ij')
 
-        # Note that the reconstructions are stored in memory in the order z, y, x (i.e. the x axis is the fastest changing in memory)
+        # Note that the reconstructions are stored in memory in the order z, y, x (i.e. the x axis is the fastest
+        # changing in memory)
         output = np.zeros((frames,) + tuple(n_pixels)[::-1])
 
         for n_frame in tqdm(range(frames), desc="Looping through frames", position=0):
             for n_detector in tqdm(range(signal.shape[-2]), desc="Looping through detectors", position=1, leave=False):
                 detx, dety, detz = geometry[n_detector]
                 d = (np.sqrt((detx - X) ** 2 + (dety - Y) ** 2 + (detz - Z) ** 2) / dl).astype(np.int32)
                 output[n_frame] += signal[n_frame, n_detector, d]
@@ -75,8 +77,8 @@
         """
 
         Returns
         -------
         str
             Algorithm name.
         """
-        return "Bad Backprojection"
+        return "Slow Backprojection"
```

## Comparing `patato-0.4.0.dist-info/LICENSE.MD` & `patato-0.5.0.dist-info/LICENSE.MD`

 * *Files identical despite different names*

## Comparing `patato-0.4.0.dist-info/entry_points.txt` & `patato-0.5.0.dist-info/entry_points.txt`

 * *Files identical despite different names*

## Comparing `patato-0.4.0.dist-info/RECORD` & `patato-0.5.0.dist-info/RECORD`

 * *Files 21% similar despite different names*

```diff
@@ -1,140 +1,96 @@
-patato/__init__.py,sha256=2I_smAGU80Ypis2T0v0Trd5jMfJ-LA8238DN0XOVM70,2274
-patato/convenience_scripts/__init__.py,sha256=nt_tTwDSgnEQUsNCFuIzjF9yCoIEorzDl3tN34MyBQY,214
+patato/__init__.py,sha256=8paF8-iMpw-wH0bpgbHTozpCF_FtVkEnrxTwsPji2XQ,2183
+patato/convenience_scripts/__init__.py,sha256=28SLfpuZgBAWcyvacXx7LaExIATXvkjqt1sFNLE-uW8,216
 patato/convenience_scripts/convert_binary_to_hdf5.py,sha256=TDvi8mGlYEmpXN8d5VhxiOZ0ih36A7DuBOGpvilNLIE,1247
 patato/convenience_scripts/convert_simpa.py,sha256=x3TdI19zOASqDfc4JHp1xdj4bHrrtDp9VZ1QDGluXpY,1053
-patato/convenience_scripts/copy_rois.py,sha256=tkXnSP6AOfa1tJZPyIi4Qhc6pXDLQMKMU4UJ_hPZYqk,6631
-patato/convenience_scripts/draw_roi.py,sha256=gD52GVWWaxBtEWgz18UWpVYPqakO-iw0itL1EhDKxjo,20287
-patato/convenience_scripts/generate_core.py,sha256=nscz5X4Ckxdg-QLpQIWLhDA5FYEuEXe1BpfxmUG2Ii4,2148
+patato/convenience_scripts/copy_rois.py,sha256=8MtfqK2oHPA_o6eI0BmfXUcY-FX8jpho0KO8A_tONDI,6648
+patato/convenience_scripts/draw_roi.py,sha256=o2cQQnplYhqaxWXnmzWy1PtD9m-AVCs0J3ZirBrpZ84,20250
+patato/convenience_scripts/generate_core.py,sha256=mvLqkKPAwPiGmgwjEmVn-O7h5212dFe1nw7iXuVswpE,2153
 patato/convenience_scripts/import_clinical_data.py,sha256=zBGk3j7MNXC6NigQmLVDC1H7cH1vKzscGRvOrIpiPvg,1294
 patato/convenience_scripts/import_ithera_recons.py,sha256=ccA4e9Bs6nEYjRCfRAWZsBwC38--ElQvXCTaXRYgt_0,1666
-patato/convenience_scripts/print_speeds.py,sha256=N8fSYQeQDhVc9lsYLpFmnBWeohyJeX1FjXexj-7dnlE,1536
-patato/convenience_scripts/process_msot.py,sha256=8ktkP_UtJa-d5nk55NLs32jFlv-HL1SHHu1fu3Txpno,4649
+patato/convenience_scripts/print_speeds.py,sha256=pRpWGRYpCZFxBPdZIYpJ65nsHpymVgTw-TtvENq_tZw,1541
+patato/convenience_scripts/process_msot.py,sha256=w1nyri-WV-tq4rqGu40WdrqF75IJsBD2tlJP-v0Mvrs,4611
 patato/convenience_scripts/rename_scan.py,sha256=-a5Xo9h5j2HahnlwYYZTQO-YUIyZaczrjnRpBvyy9i8,962
-patato/convenience_scripts/scan_status.py,sha256=2j9iYdKbptpXkNGVuqbeEEzGu-w-IH1PaaQ4pCrRqhw,1890
-patato/convenience_scripts/split_rois.py,sha256=4Gs70sHgHdVMFOjRwtx7sYmxQuJKgqSGV0yetl3ZA-0,1788
-patato/convenience_scripts/tune_speed_of_sound.py,sha256=9IQud7y2tzEHVlViDJKRDQkJ318ur_c5mZ4v_S8GBII,8435
-patato/convenience_scripts/unmix.py,sha256=Jqrb6gDYYwnKI9QJftvcltLTUoWu5SrWe5QZKDxTUZA,2665
-patato/convenience_scripts/view.py,sha256=qCFgogr5Y3mhRpGQN-63iabYaVKWMoEGObCKHBgI2lk,4250
+patato/convenience_scripts/scan_status.py,sha256=M6UXlLUwI88tawkZJusactDN_dkp_kWpAn6Sbsti1yw,1895
+patato/convenience_scripts/split_rois.py,sha256=jWhd7hp_V7o4174PEl2qPE8lX-unZQBD0Ztn6WnbgDI,1793
+patato/convenience_scripts/tune_speed_of_sound.py,sha256=3FQQelbVxH1LX8f5H-jz1DN2ztbR19PqtgDEvb4Njng,8438
+patato/convenience_scripts/unmix.py,sha256=rtpkoWTYS4fEpsdrxc1EfduA8fbHF7c24VZGxp__A5Q,2663
+patato/convenience_scripts/view.py,sha256=ziE4iYdzN0FDJH0jLQcsyqDm1hFvK_1sgIaNy_JvWlw,4255
 patato/convenience_scripts/data_analysis/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
 patato/convenience_scripts/data_analysis/analyse_dce.py,sha256=yHHABzoXY6eDPeehP4R2LCinnt21ijip5IlWPDuGXMY,2617
 patato/convenience_scripts/data_analysis/analyse_gas_challenge.py,sha256=GSazs0ncV7ZZGFRKWlyYD2GlsAUdDMe4Fp2xWDh9Iek,2745
-patato/core/__init__.py,sha256=So14WQuRqk8hf-1WkuhVPOy64LiCQAIe-G6tEdU68Ig,87
+patato/core/__init__.py,sha256=OjPfgYBM0wSaYbXZWfZfTG8_P4K4vcPyh0vzEge3D5o,251
 patato/core/image_structures/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/core/image_structures/image_sequence.py,sha256=OuEW_JmNXFs8rc_R0tr-xP0lZyr_JWcTbiIFURfSkU0,12591
-patato/core/image_structures/image_structure_types.py,sha256=pCHZenHZ4L1IBJI13Vf9gGPfItmmvcHOLxExKhJbTF0,773
-patato/core/image_structures/pa_fourier_data.py,sha256=uexEQCCri351XMxuuxvGuvwR0UsA_4tbqsnUP_tJKCM,1275
-patato/core/image_structures/pa_raw_data.py,sha256=VIG5-VfFOGGyTI5KJvUez_Lcm9LPJxSlOzpM6HP0TS4,2035
-patato/core/image_structures/pa_time_data.py,sha256=E4_xC6pfhjF6BwXwqconCVs0odHKJR45BKIk0A0ny8Q,2054
-patato/core/image_structures/reconstruction_image.py,sha256=mso0nvBI6l0wRxkF7awQ2MubNIu7Bk0Fzr4ZGN5jTnA,1141
+patato/core/image_structures/image_sequence.py,sha256=jYn9a2IzzlY3Vg85hsYx-jYZg7_TPOL81EcUoqOuHYI,12588
+patato/core/image_structures/image_structure_types.py,sha256=0uNv4YbP_cSNE-h38o-Y51EGllhbl2TmysE_QU0eaT8,856
+patato/core/image_structures/pa_raw_data.py,sha256=sbaYLZAWdEncYjdPQyojglJVEiM2Sai4Kxb7gTvXIUk,1430
+patato/core/image_structures/pa_time_data.py,sha256=eyY5Asx5W7B-F7AcWJIkpw4EIetJhXk5HQCvDqqmGSQ,1331
+patato/core/image_structures/reconstruction_image.py,sha256=aaKnaFadxZD-2oJxwWfDRYO_V0PNSRHbUZp6frcOulY,851
 patato/core/image_structures/single_image.py,sha256=aPf3ca7-nX-_pInyNCamFyA0elmw0TZZ77He40cD8CQ,982
 patato/core/image_structures/single_parameter_data.py,sha256=P417UBbYBD18RRJPF8TpMIChyfG6ZlCLQ_YWZdd8UAI,1121
 patato/core/image_structures/unmixed_image.py,sha256=5MQ6TRWM7G7hUaamo6IAlETIFXpC39UoeEOLxhv1zcw,930
-patato/data/__init__.py,sha256=yz3YUmiwV7rCEO65-td42JhQA-3VufIYfBuOlLzleCI,371
-patato/data/get_example_datasets.py,sha256=_OIU0W5-weXr18t5KUUllz54VeJiltDzVS6y8ehlsbU,3890
+patato/data/__init__.py,sha256=2OJ6666fl6b25nIOy2kBWPNZmc_NBny8ZkMc6mx4a2c,701
+patato/data/get_example_datasets.py,sha256=Rys0Qt5sSyCHnFkEYDlImXH48fXS73ogY4Ls_foz1Fg,3676
 patato/data/simulated_datasets.py,sha256=evdordT0wTkeka8iRWN9YIH9Hs2MZJ45ub6qWM7AC1Y,2132
-patato/io/__init__.py,sha256=cfBNBtbxLn_o-06n9XXIAYRFzpRRuCs__V5jylppDxw,124
+patato/experimental/__init__.py,sha256=YOgAMTD0NMeFy3EMmlNMHSUljbls27_Opx1OGeDYt4g,53
+patato/experimental/simulation/__init__.py,sha256=UX_aj31lmD-S4RYpqitHkZBgdttftFVhaBmGsOCKMjg,57
+patato/io/__init__.py,sha256=fJcLCcifgHYhuiPEqmhB3FS86HC1Y4B8vLalXS_L6t4,194
 patato/io/attribute_tags.py,sha256=pIIavrBBhx3Choj6sESj98j5DCnyWNPUANRjyV2DIeA,2877
 patato/io/hdf5_converter.py,sha256=y3iZs9uCyFsiGu4gEZ9IdANynkyOERiuR52bVsAsOD8,3924
-patato/io/msot_data.py,sha256=EpnGhy07ZrnqHJmMchkb2727-L_qgSJzPaHbGdYHWQ8,23829
+patato/io/msot_data.py,sha256=yqPnLA3SKSIVwwHMtR_gZWKZaU-VM_Yt6PVrKRcFyA8,23221
 patato/io/hdf/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/hdf/fileimporter.py,sha256=0VhVEf7YywbviUw_xj_banAEut34NBL6W8jYQYcZMdc,12215
-patato/io/hdf/hdf5_interface.py,sha256=1yftvoqdGNayzIALKh8V3X05fdtoQJV6Jo5-kHU_ElE,17067
-patato/io/hdf/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/hdf/tests/test_ithera_import_clinical_new.py,sha256=pUVOxSsSbU4bfcinZnOu0jo5RUcMU2wAez4ZNBt6aO0,511
+patato/io/hdf/fileimporter.py,sha256=gHGWJQXgt2maSVcpC_cY4pBgOvSJDNJrVEx_7QxpKlE,12302
+patato/io/hdf/hdf5_interface.py,sha256=galHh-TA8lYhUTMMDFUlQnt0murWEVRnrEFeHJAVtzc,17073
 patato/io/ipasc/__init__.py,sha256=zJ6OdBZCqbvZpX8JUdirwTG2XGJ3iN4BW6JmqdSBetk,518
-patato/io/ipasc/ipasc_export.py,sha256=dqKUQrcm1Y5gMTtYqU0UUbwHihxLUcUH15VKPlMPXIk,2531
-patato/io/ipasc/read_ipasc.py,sha256=Pbb4xkUdpHj1-T9amUDMtueKGBQxDnYIdndo8bNp4-c,2834
+patato/io/ipasc/ipasc_export.py,sha256=GV86nWFTB1oeiBuLTAqpZoIgrrvmGOBXMp50vFawabs,2472
+patato/io/ipasc/read_ipasc.py,sha256=7srPE2r24hsFNbbfLlTKpoxB69IhUETIuOzk1y1VhH8,2840
 patato/io/ithera/__init__.py,sha256=VlJY4mKMJCbwVoySVT-0knMVSHfifFxMFkMPhEifmY0,245
 patato/io/ithera/read_ithera.py,sha256=3ny8aW2oHzxezxm_huAg3GqLmRJophOJF4B3qn6hKgI,13838
-patato/io/ithera/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/ithera/tests/ithera_tests.py,sha256=DjLZk3cBT-wO78t1qc-XER9ipaNEnMI5N1Us_JbtC3o,1749
 patato/io/json/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/json/json_reading.py,sha256=cT-u2F3c7IRPhgrwsT6uzd2VTBuzrUMg0kUUjjgUCbc,6898
-patato/io/json/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/json/tests/test_reconstruction_reading.py,sha256=JtorroVdXFFvjImgEPoDLEu8lN5FXcH3cClyYkPeYsA,1122
+patato/io/json/json_reading.py,sha256=21MrtFciotGmXOdjEoSNc0BTG05IUTFKUsNiqS7py4c,6868
 patato/io/simpa/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
 patato/io/simpa/read_simpa.py,sha256=xebVaC4u36rwDVEkNwstGEUFeXn1Q5qMDcN2XT0i9A8,5192
-patato/io/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/io/tests/test_msot_data.py,sha256=v5BKWAzx_xa3UYgf8YdsrjhEWX-bOYZE6AqZXr3AHHI,1456
-patato/processing/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/processing/gpu_preprocessing_algorithm.py,sha256=-SCVnYot1QfgDxGwOb0AGLa876VmrfmMEbEqTBb09iM,11809
-patato/processing/jax_preprocessing_algorithm.py,sha256=vBFfZ7ewNrhHSBk1T_8b75May81ocAH2D9U-bDv5dBI,12380
-patato/processing/preprocessing_algorithm.py,sha256=GOcKFCcS68-75N13lnrk2uJP1IdO121EPpdfUW-tChA,10136
-patato/processing/preprocessing_types.py,sha256=pcMvGPNK7Zkzkcjah82RSPA-MZ4tTT-GudryI6ZXFNQ,655
+patato/processing/__init__.py,sha256=bMJa3vD7qHHQUiPVHojIes7PuJF5gdXHiOxA3hWNvps,339
+patato/processing/gpu_preprocessing_algorithm.py,sha256=H32U1ia7L5Ul9DA2efunsT-K2NhUpRwlA4G4mxzT2UI,11603
+patato/processing/jax_preprocessing_algorithm.py,sha256=gl80RkLcuQRPSIksI0FbUk3lY68bb4O4oVs3pGCIz58,12332
+patato/processing/preprocessing_algorithm.py,sha256=nvgjnuJN_UaMBEcISh6-x5e59ktvYwOvenDLJDHZScA,10264
+patato/processing/preprocessing_types.py,sha256=bSmShY5fncrQpZf_XVTJBpxS81U9qUapIEeXnxqo2Lw,685
 patato/processing/processing_algorithm.py,sha256=Z8Xq9rjhuOfK6CuLoA4OFxi6FU6_Q2vcxHWG-4TdDTk,2259
-patato/processing/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/processing/tests/preprocessing_algorithm.py,sha256=rpwpWLQaQj76eNBYFya2mQUfs2l_QdqEn7547sViQaA,2466
-patato/recon/__init__.py,sha256=iiv5NWE7gNUBos5llvKIJkfHZUY3eti148VKSG9kE14,1878
-patato/recon/backprojection_opencl.py,sha256=YMK4fT3AqGGl08lr8pWQDHw_ebYnaLXLWrV9I-TCBVw,7281
-patato/recon/backprojection_reference.py,sha256=ClIf8lCfn0fj4Jb8LRIOZ_1uGhikQ2BTMRp8ueSiWFE,2078
+patato/recon/__init__.py,sha256=0PJGUjLl14aHkABOXI7dGYEiPRTRPoSJOasfRPBnZlE,1897
+patato/recon/backprojection_opencl.py,sha256=i7rLxfCM_DyI0oVGrnlxsFVpssD_m1Abd-VhdcqzO_E,7337
+patato/recon/backprojection_reference.py,sha256=4muSfD6vRDHQXnPF_ut9mluDrg5gyUz6MzN9mo9XPhU,2137
 patato/recon/reconstruction_algorithm.py,sha256=d1esso_QJUSbJ57t9H7Shcq8qqwo77BFV7v84ACuXJU,5070
 patato/recon/backprojection_implementation/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
 patato/recon/backprojection_implementation/jax_implementation.py,sha256=EpWS4b7EOmS784xKAo_VeAfuLP2GomJ_wq2ZIwEuYWw,1056
 patato/recon/model_based/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
 patato/recon/model_based/cuda_implementation.py,sha256=JKFVh4zHttgaanrHbBIRj45aGIVC-k1uOmBJJZZ8l24,3874
 patato/recon/model_based/cuda_implementation_refraction.py,sha256=iNqsujWa3iniIIy7gfFLWfmVrheSqvVP4l85TBI_KgQ,2806
 patato/recon/model_based/generate_model.cpp,sha256=L1WlOynj3t6HcsMxlVr4Zs7eOjNPPD_4UR4_WXpLKqo,6985
 patato/recon/model_based/generate_model.cu,sha256=vuE5DHDcc_5WAdmbqJBTsctOAKBCa9ykBhULkJCbGio,5999
-patato/recon/model_based/generate_model.pypy39-pp73-win_amd64.pyd,sha256=VjAr9gznDFWtpXhFTwjHFW-EAYb5K-sq-18Thohe4Uo,113152
+patato/recon/model_based/generate_model.pypy39-pp73-win_amd64.pyd,sha256=5SNgsxFeOyaHWEKjYzNbhYLYOBz33cjC1BPRqBidNhU,113152
 patato/recon/model_based/generate_model_refraction.cpp,sha256=Zb7q8PjlfcdAQvk8I3gll1SObeNAYUuCBUtxY0VVwnw,8080
 patato/recon/model_based/generate_model_refraction.cu,sha256=oK1YSGwJXqbOKpUtlLmyB7LVQoPKL_SaGHHyLQnANHc,7990
-patato/recon/model_based/generate_model_refraction.pypy39-pp73-win_amd64.pyd,sha256=DzHYQ8oFqdJVLs8D6cjbVmz_ApyaboycGAt_9CRRBNU,114176
-patato/recon/model_based/model_based.py,sha256=iKEJCYgBzQ1xLUjKnzSzJZXsUo2P_qnEr8MbuBc653k,10355
-patato/recon/model_based/numpy_implementation.py,sha256=7iYqFD8AOaWeUiqwVQma9EtbxIxpB-sMa82dxILotRE,2519
-patato/recon/numpy/__init__.py,sha256=KDStbS5_SDcnQKGweqQK8HLdhhHIC-a_MzmxkIJzAzo,94
-patato/recon/numpy/recon.py,sha256=2Y-c9LSCm5P6Jq0-vzgoC0vQfo_LfEkqNAH1n2H2BEs,3029
-patato/recon/opencl_code/dascl.cl,sha256=lRy2f_zCoMdZN3OncnUIG7XRuhb0yH69TuB9y3p6hsQ,1633
-patato/recon/opencl_code/dmascl.cl,sha256=ZoxMAQvG9-Ipo1a4A2Eq9qmwfF_fQjY7T6-GXyByS0o,1729
-patato/recon/recon_presets/backproject_clinical.json,sha256=B7aISD4M0tEPD2YvgRrwL0xu-aDs2O6yW82Y_4El8Hs,488
-patato/recon/recon_presets/backproject_clinical_xy.json,sha256=HhH8dzs5428_CG3g5Oz8tmudeV5a6kBxRcYxZZs77rg,488
-patato/recon/recon_presets/backproject_clinical_xz.json,sha256=B7aISD4M0tEPD2YvgRrwL0xu-aDs2O6yW82Y_4El8Hs,488
-patato/recon/recon_presets/backproject_clinical_yz.json,sha256=eJ8RTgEx6cB9gakK47yEMkBK8kBOYVE9i081gOO5Bbo,488
-patato/recon/recon_presets/backproject_janek.json,sha256=a5s-UqtVpjW4JhBPxKcphxAL3z_dqmctj8rsr9QfVfE,486
-patato/recon/recon_presets/backproject_janek_sos.json,sha256=2cyXwWOe6MHk-DtwInm81aLVGbs4QdjBsqzU1YmWWCw,486
-patato/recon/recon_presets/backproject_noirf.json,sha256=eANdy8hCy4NSmbUKTP4Aaj8GZBEXRraSLHzd9J4zoO4,485
-patato/recon/recon_presets/backproject_standard.json,sha256=2DohyJ-in4FGjUZfbWVJJThBCrqCTcYR6BZRMy7kdMI,491
-patato/recon/recon_presets/backproject_standard_sos.json,sha256=CrJKU5ZAWpsjvE3zpMcrxqqakCEK8XCbQzTP-4C3sK8,493
-patato/recon/recon_presets/backproject_standard_water_correction.json,sha256=3-A50alaDnxI_XjuavcxoWh2MeK5_7oY03HLIg-ce-o,557
-patato/recon/recon_presets/backproject_standard_water_correction_new_ithera.json,sha256=moF23mXe37xMbwxugmWfRc0Y4X9MIiFtFgbXtmwZ1fU,561
-patato/recon/recon_presets/backproject_standard_xy.json,sha256=2DohyJ-in4FGjUZfbWVJJThBCrqCTcYR6BZRMy7kdMI,491
-patato/recon/recon_presets/backproject_standard_xz.json,sha256=j25lEm2XrP0q2E5087DwDA9yp1PjOWF-0Zlg359goIc,491
-patato/recon/recon_presets/backproject_standard_yz.json,sha256=DrczBnNw4UEVeOkeByywWKBv50L84qODh3IHb6Glz7M,491
-patato/recon/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/recon/tests/backprojection_test.py,sha256=w_fZzEkXJwSEzN-QGVVsn6iwjTm_3tNuIXsVrIpmdTg,1873
-patato/recon/tests/model_based_test.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/unmixing/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
+patato/recon/model_based/generate_model_refraction.pypy39-pp73-win_amd64.pyd,sha256=Qr-QAZCZVuvBZbmr0L1O_sjY5G8y1p7JQDX8bhCM9DE,114176
+patato/recon/model_based/model_based.py,sha256=inaEDxRRU_XBdlxqshjALI5yI1q_8ArskWRKPUAyUy4,11229
+patato/recon/model_based/numpy_implementation.py,sha256=cz0y0eWx8VHutcicMYc7MMvD4w73XFYoLpn_VBbrSw4,2524
+patato/recon/numpy_backprojection/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
+patato/recon/numpy_backprojection/recon.py,sha256=p6HI7wPeKBMUM8ceQNQiN_Whzwmg950A_Eeyh3C2NjQ,3004
+patato/unmixing/__init__.py,sha256=okS9h1ZUJOBGV5nDvwxQ-wU-mHX9fdAakSWZA_UTrGw,576
 patato/unmixing/unmixer.py,sha256=u9bDg3rmpKNw3wNRneLzsR2XZMuGOarMUOYCXX4Cjaw,15954
 patato/unmixing/spectra/__init__.py,sha256=VRN9p1ZUI-oSzKjvyGVVwfmySZeVd6Udei5mpdE_vgA,4290
-patato/unmixing/spectra/spectra_files/ICG.csv,sha256=1NXytr15CvdUZNWqNnDv8FO_awoWvj36LfzdQnF6ISA,12113
-patato/unmixing/spectra/spectra_files/Melanin.csv,sha256=DA53s-aX4r7z56HNN9Y3T1h8tNrRL6fAja2kQkquf30,17760
-patato/unmixing/spectra/spectra_files/lipids.txt,sha256=Bp1wYboXlfzO1UV4vtMRA_urY71VPfS-kSXezw0Y2gk,7768
-patato/unmixing/spectra/spectra_files/prahl.txt,sha256=ETRMGQsMYqFOvFcKNa7njDx5EA8BQfes1oQF8cApsKE,6861
-patato/unmixing/spectra/spectra_files/water.txt,sha256=aGEStd5vEA4iWVn4VKcL8qJlCyJ9D8UEToN42kxmGrA,3710
-patato/unmixing/spectra/spectra_files/water_long.txt,sha256=Q5W7Nky4Si2kSO1SLuvyhYWpDaVnQuOj2DpUpDjrY9Y,8643
-patato/unmixing/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/unmixing/tests/unmixing_test.py,sha256=EvnVP7V7kiJTp9hxttpSesKcdD7KLvHsRZDBqrbZGAI,3404
-patato/unmixing/unmix_presets/haemoglobin.json,sha256=5m2KPYRdvppl6EHUqFeYzsKJRH4ej8rpYsByeGBcefc,120
-patato/unmixing/unmix_presets/haemoglobin_flow_phantom.json,sha256=SQF6r3J_MZrqZwS5OkulFMAjD6OOaOG5Evo-QI_WACQ,120
-patato/unmixing/unmix_presets/haemoglobin_flow_phantom_all_wl.json,sha256=W5ZaCxwtoYRrZTOc8sd2V36zHsyfufGRdRu2YIShY_o,121
-patato/unmixing/unmix_presets/haemoglobin_melanin.json,sha256=4m8wYijDfYxFKOO7EjnJMhLhGd_4qsaRXQG0-cKrueY,134
-patato/unmixing/unmix_presets/haemoglobin_mitox.json,sha256=lFfePFEDUupPfaYO8T7y-sIe4kJrxaXf5VdSPMpVt7s,183
-patato/unmixing/unmix_presets/hb_emma_water.json,sha256=1i5MhqIxYXx4MBbqT2JdTdtOTFR8dJTF-PNHIhqXx24,205
-patato/unmixing/unmix_presets/hb_icg.json,sha256=JIAtAVXwSvi6LMD5ntfXVCUaeJvBgehnj3xMy5rp4AI,132
-patato/useful_utilities/__init__.py,sha256=XkKeOobl8pMiGFeUu5VXuh5ql9aqHAnhVhqIN3mAYoo,9603
-patato/utils/__init__.py,sha256=gv-NHnkheUwgNV5nJyL3o0AN5JEW4nHmcxZGOTKE7ys,379
+patato/useful_utilities/__init__.py,sha256=shTgrA0Anbuh0oCoFrfvSHbsTzd3yo6Lb0QQdGnz53c,9837
+patato/utils/__init__.py,sha256=mMMPLCa79uMDAciVt-M6j8LIuZv4rGAxvIg5uunH8lM,523
 patato/utils/mask_operations.py,sha256=lQMbcclz4_AeS_r-94moi9IlbL-XuHjTFW5K1k0VnwM,4320
 patato/utils/plotting.py,sha256=Xu_DffkU_vryOwarX-lJ_l4I6LCn6I3mAoWJLGXXM-Q,1316
 patato/utils/process_study.py,sha256=xjmt_UeAHL-NhSP8fBD8eEGNlr7B--YcGiMMlnZwqQY,585
-patato/utils/roi_operations.py,sha256=YbaTDl2SmCXMaMOWGP6fRihUF28LqC6mFY5GQvspWHA,3534
+patato/utils/roi_operations.py,sha256=Yo6sYoDLX4e4zlFDNZO65NqdLjMRUL32PwYN7icjGOs,3570
 patato/utils/run_pipeline.py,sha256=wZQe9XNmmV2Q1O9IieW4Lcplp_Q6h0XM2CTlzc4NuYg,4262
 patato/utils/time_series_analysis.py,sha256=KIE7vKGVZ4s0dIk0UjK6xMbEMD6bE6haa6p4hjLFa8c,3025
 patato/utils/rois/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
 patato/utils/rois/roi_type.py,sha256=qYPiHd_ergfvQVnFet79oTgQJR17PGHKUgtcwZ_fQ5Y,3338
 patato/utils/tests/__init__.py,sha256=4nvs_RQQj5CLcNJyJNTg9MbQaMIc9hIA21CS92pdC3w,55
-patato/utils/tests/pipline_tests.py,sha256=B9-eOpf0DSUAPjgv0PzboBcZOwY0SvrZ2w5eY1YWuaE,1507
-patato-0.4.0.dist-info/LICENSE.MD,sha256=j44Ev7kbJ84JPxJCY57oPkpIN349hJKJZ3l37VEVqDQ,1087
-patato-0.4.0.dist-info/METADATA,sha256=MbZje4xG9ZqVLbt1H2KSZcZ1TUhVMXFfLicwXhBJtYc,3448
-patato-0.4.0.dist-info/WHEEL,sha256=QQY0XPJVcbNrDwRnZBTwtxGbMWJnHaWRpMJLfPEPCFM,107
-patato-0.4.0.dist-info/entry_points.txt,sha256=9kOo5kvzcgIhYy_AmIzDHBBl9FbY6TETSz7QNUrdWkE,590
-patato-0.4.0.dist-info/top_level.txt,sha256=5iGcyEUDu0xnFLYxVoto2fQydzOOVAnl498BCog-3CQ,7
-patato-0.4.0.dist-info/RECORD,,
+patato-0.5.0.dist-info/LICENSE.MD,sha256=j44Ev7kbJ84JPxJCY57oPkpIN349hJKJZ3l37VEVqDQ,1087
+patato-0.5.0.dist-info/METADATA,sha256=YhuSmzY0U5FUPhHpBgB41Bf3P0MgIt8JJ895KoBEt9w,4949
+patato-0.5.0.dist-info/WHEEL,sha256=QQY0XPJVcbNrDwRnZBTwtxGbMWJnHaWRpMJLfPEPCFM,107
+patato-0.5.0.dist-info/entry_points.txt,sha256=9kOo5kvzcgIhYy_AmIzDHBBl9FbY6TETSz7QNUrdWkE,590
+patato-0.5.0.dist-info/top_level.txt,sha256=5iGcyEUDu0xnFLYxVoto2fQydzOOVAnl498BCog-3CQ,7
+patato-0.5.0.dist-info/RECORD,,
```

